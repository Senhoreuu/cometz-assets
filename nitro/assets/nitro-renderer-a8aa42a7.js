var Yr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function mg(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}function C0(r){if(r.__esModule)return r;var t=r.default;if(typeof t=="function"){var e=function s(){return this instanceof s?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};e.prototype=t.prototype}else e={};return Object.defineProperty(e,"__esModule",{value:!0}),Object.keys(r).forEach(function(s){var i=Object.getOwnPropertyDescriptor(r,s);Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:function(){return r[s]}})}),e}/*!
 * @pixi/constants - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/constants is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var ai;(function(r){r[r.WEBGL_LEGACY=0]="WEBGL_LEGACY",r[r.WEBGL=1]="WEBGL",r[r.WEBGL2=2]="WEBGL2"})(ai||(ai={}));var Jo;(function(r){r[r.UNKNOWN=0]="UNKNOWN",r[r.WEBGL=1]="WEBGL",r[r.CANVAS=2]="CANVAS"})(Jo||(Jo={}));var ul;(function(r){r[r.COLOR=16384]="COLOR",r[r.DEPTH=256]="DEPTH",r[r.STENCIL=1024]="STENCIL"})(ul||(ul={}));var tt;(function(r){r[r.NORMAL=0]="NORMAL",r[r.ADD=1]="ADD",r[r.MULTIPLY=2]="MULTIPLY",r[r.SCREEN=3]="SCREEN",r[r.OVERLAY=4]="OVERLAY",r[r.DARKEN=5]="DARKEN",r[r.LIGHTEN=6]="LIGHTEN",r[r.COLOR_DODGE=7]="COLOR_DODGE",r[r.COLOR_BURN=8]="COLOR_BURN",r[r.HARD_LIGHT=9]="HARD_LIGHT",r[r.SOFT_LIGHT=10]="SOFT_LIGHT",r[r.DIFFERENCE=11]="DIFFERENCE",r[r.EXCLUSION=12]="EXCLUSION",r[r.HUE=13]="HUE",r[r.SATURATION=14]="SATURATION",r[r.COLOR=15]="COLOR",r[r.LUMINOSITY=16]="LUMINOSITY",r[r.NORMAL_NPM=17]="NORMAL_NPM",r[r.ADD_NPM=18]="ADD_NPM",r[r.SCREEN_NPM=19]="SCREEN_NPM",r[r.NONE=20]="NONE",r[r.SRC_OVER=0]="SRC_OVER",r[r.SRC_IN=21]="SRC_IN",r[r.SRC_OUT=22]="SRC_OUT",r[r.SRC_ATOP=23]="SRC_ATOP",r[r.DST_OVER=24]="DST_OVER",r[r.DST_IN=25]="DST_IN",r[r.DST_OUT=26]="DST_OUT",r[r.DST_ATOP=27]="DST_ATOP",r[r.ERASE=26]="ERASE",r[r.SUBTRACT=28]="SUBTRACT",r[r.XOR=29]="XOR"})(tt||(tt={}));var lr;(function(r){r[r.POINTS=0]="POINTS",r[r.LINES=1]="LINES",r[r.LINE_LOOP=2]="LINE_LOOP",r[r.LINE_STRIP=3]="LINE_STRIP",r[r.TRIANGLES=4]="TRIANGLES",r[r.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",r[r.TRIANGLE_FAN=6]="TRIANGLE_FAN"})(lr||(lr={}));var W;(function(r){r[r.RGBA=6408]="RGBA",r[r.RGB=6407]="RGB",r[r.RG=33319]="RG",r[r.RED=6403]="RED",r[r.RGBA_INTEGER=36249]="RGBA_INTEGER",r[r.RGB_INTEGER=36248]="RGB_INTEGER",r[r.RG_INTEGER=33320]="RG_INTEGER",r[r.RED_INTEGER=36244]="RED_INTEGER",r[r.ALPHA=6406]="ALPHA",r[r.LUMINANCE=6409]="LUMINANCE",r[r.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",r[r.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",r[r.DEPTH_STENCIL=34041]="DEPTH_STENCIL"})(W||(W={}));var An;(function(r){r[r.TEXTURE_2D=3553]="TEXTURE_2D",r[r.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",r[r.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",r[r.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",r[r.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",r[r.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",r[r.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",r[r.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z"})(An||(An={}));var xt;(function(r){r[r.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",r[r.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",r[r.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",r[r.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",r[r.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",r[r.UNSIGNED_INT=5125]="UNSIGNED_INT",r[r.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",r[r.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",r[r.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",r[r.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",r[r.BYTE=5120]="BYTE",r[r.SHORT=5122]="SHORT",r[r.INT=5124]="INT",r[r.FLOAT=5126]="FLOAT",r[r.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",r[r.HALF_FLOAT=36193]="HALF_FLOAT"})(xt||(xt={}));var ll;(function(r){r[r.FLOAT=0]="FLOAT",r[r.INT=1]="INT",r[r.UINT=2]="UINT"})(ll||(ll={}));var _s;(function(r){r[r.NEAREST=0]="NEAREST",r[r.LINEAR=1]="LINEAR"})(_s||(_s={}));var ri;(function(r){r[r.CLAMP=33071]="CLAMP",r[r.REPEAT=10497]="REPEAT",r[r.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT"})(ri||(ri={}));var Hi;(function(r){r[r.OFF=0]="OFF",r[r.POW2=1]="POW2",r[r.ON=2]="ON",r[r.ON_MANUAL=3]="ON_MANUAL"})(Hi||(Hi={}));var Vi;(function(r){r[r.NPM=0]="NPM",r[r.UNPACK=1]="UNPACK",r[r.PMA=2]="PMA",r[r.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",r[r.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",r[r.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",r[r.PREMULTIPLIED_ALPHA=2]="PREMULTIPLIED_ALPHA"})(Vi||(Vi={}));var Ri;(function(r){r[r.NO=0]="NO",r[r.YES=1]="YES",r[r.AUTO=2]="AUTO",r[r.BLEND=0]="BLEND",r[r.CLEAR=1]="CLEAR",r[r.BLIT=2]="BLIT"})(Ri||(Ri={}));var _l;(function(r){r[r.AUTO=0]="AUTO",r[r.MANUAL=1]="MANUAL"})(_l||(_l={}));var ms;(function(r){r.LOW="lowp",r.MEDIUM="mediump",r.HIGH="highp"})(ms||(ms={}));var Ie;(function(r){r[r.NONE=0]="NONE",r[r.SCISSOR=1]="SCISSOR",r[r.STENCIL=2]="STENCIL",r[r.SPRITE=3]="SPRITE",r[r.COLOR=4]="COLOR"})(Ie||(Ie={}));var zE;(function(r){r[r.RED=1]="RED",r[r.GREEN=2]="GREEN",r[r.BLUE=4]="BLUE",r[r.ALPHA=8]="ALPHA"})(zE||(zE={}));var ne;(function(r){r[r.NONE=0]="NONE",r[r.LOW=2]="LOW",r[r.MEDIUM=4]="MEDIUM",r[r.HIGH=8]="HIGH"})(ne||(ne={}));var gr;(function(r){r[r.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",r[r.ARRAY_BUFFER=34962]="ARRAY_BUFFER",r[r.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER"})(gr||(gr={}));/*!
 * @pixi/settings - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var N0={createCanvas:function(r,t){var e=document.createElement("canvas");return e.width=r,e.height=t,e},getWebGLRenderingContext:function(){return WebGLRenderingContext},getNavigator:function(){return navigator},getBaseUrl:function(){var r;return(r=document.baseURI)!==null&&r!==void 0?r:window.location.href},fetch:function(r,t){return fetch(r,t)}},Z_=/iPhone/i,YE=/iPod/i,WE=/iPad/i,XE=/\biOS-universal(?:.+)Mac\b/i,J_=/\bAndroid(?:.+)Mobile\b/i,KE=/Android/i,Zn=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,ou=/Silk/i,yr=/Windows Phone/i,qE=/\bWindows(?:.+)ARM\b/i,QE=/BlackBerry/i,ZE=/BB10/i,JE=/Opera Mini/i,$E=/\b(CriOS|Chrome)(?:.+)Mobile/i,tp=/Mobile(?:.+)Firefox\b/i,ep=function(r){return typeof r<"u"&&r.platform==="MacIntel"&&typeof r.maxTouchPoints=="number"&&r.maxTouchPoints>1&&typeof MSStream>"u"};function b0(r){return function(t){return t.test(r)}}function P0(r){var t={userAgent:"",platform:"",maxTouchPoints:0};!r&&typeof navigator<"u"?t={userAgent:navigator.userAgent,platform:navigator.platform,maxTouchPoints:navigator.maxTouchPoints||0}:typeof r=="string"?t.userAgent=r:r&&r.userAgent&&(t={userAgent:r.userAgent,platform:r.platform,maxTouchPoints:r.maxTouchPoints||0});var e=t.userAgent,s=e.split("[FBAN");typeof s[1]<"u"&&(e=s[0]),s=e.split("Twitter"),typeof s[1]<"u"&&(e=s[0]);var i=b0(e),n={apple:{phone:i(Z_)&&!i(yr),ipod:i(YE),tablet:!i(Z_)&&(i(WE)||ep(t))&&!i(yr),universal:i(XE),device:(i(Z_)||i(YE)||i(WE)||i(XE)||ep(t))&&!i(yr)},amazon:{phone:i(Zn),tablet:!i(Zn)&&i(ou),device:i(Zn)||i(ou)},android:{phone:!i(yr)&&i(Zn)||!i(yr)&&i(J_),tablet:!i(yr)&&!i(Zn)&&!i(J_)&&(i(ou)||i(KE)),device:!i(yr)&&(i(Zn)||i(ou)||i(J_)||i(KE))||i(/\bokhttp\b/i)},windows:{phone:i(yr),tablet:i(qE),device:i(yr)||i(qE)},other:{blackberry:i(QE),blackberry10:i(ZE),opera:i(JE),firefox:i(tp),chrome:i($E),device:i(QE)||i(ZE)||i(JE)||i(tp)||i($E)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}var En=P0(globalThis.navigator);function D0(){return!En.apple.device}function L0(r){var t=!0;if(En.tablet||En.phone){if(En.apple.device){var e=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(e){var s=parseInt(e[1],10);s<11&&(t=!1)}}if(En.android.device){var e=navigator.userAgent.match(/Android\s([0-9.]*)/);if(e){var s=parseInt(e[1],10);s<7&&(t=!1)}}}return t?r:4}var Z={ADAPTER:N0,MIPMAP_TEXTURES:Hi.POW2,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,FILTER_MULTISAMPLE:ne.NONE,SPRITE_MAX_TEXTURES:L0(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,width:800,height:600,autoDensity:!1,backgroundColor:0,backgroundAlpha:1,useContextAlpha:!0,clearBeforeRender:!0,antialias:!1,preserveDrawingBuffer:!1},GC_MODE:_l.AUTO,GC_MAX_IDLE:60*60,GC_MAX_CHECK_COUNT:60*10,WRAP_MODE:ri.CLAMP,SCALE_MODE:_s.LINEAR,PRECISION_VERTEX:ms.HIGH,PRECISION_FRAGMENT:En.apple.device?ms.HIGH:ms.MEDIUM,CAN_UPLOAD_SAME_BUFFER:D0(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},NI={exports:{}};(function(r){var t=Object.prototype.hasOwnProperty,e="~";function s(){}Object.create&&(s.prototype=Object.create(null),new s().__proto__||(e=!1));function i(h,u,c){this.fn=h,this.context=u,this.once=c||!1}function n(h,u,c,l,_){if(typeof c!="function")throw new TypeError("The listener must be a function");var d=new i(c,l||h,_),f=e?e+u:u;return h._events[f]?h._events[f].fn?h._events[f]=[h._events[f],d]:h._events[f].push(d):(h._events[f]=d,h._eventsCount++),h}function a(h,u){--h._eventsCount===0?h._events=new s:delete h._events[u]}function o(){this._events=new s,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,l;if(this._eventsCount===0)return u;for(l in c=this._events)t.call(c,l)&&u.push(e?l.slice(1):l);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=e?e+u:u,l=this._events[c];if(!l)return[];if(l.fn)return[l.fn];for(var _=0,d=l.length,f=new Array(d);_<d;_++)f[_]=l[_].fn;return f},o.prototype.listenerCount=function(u){var c=e?e+u:u,l=this._events[c];return l?l.fn?1:l.length:0},o.prototype.emit=function(u,c,l,_,d,f){var m=e?e+u:u;if(!this._events[m])return!1;var p=this._events[m],T=arguments.length,v,O;if(p.fn){switch(p.once&&this.removeListener(u,p.fn,void 0,!0),T){case 1:return p.fn.call(p.context),!0;case 2:return p.fn.call(p.context,c),!0;case 3:return p.fn.call(p.context,c,l),!0;case 4:return p.fn.call(p.context,c,l,_),!0;case 5:return p.fn.call(p.context,c,l,_,d),!0;case 6:return p.fn.call(p.context,c,l,_,d,f),!0}for(O=1,v=new Array(T-1);O<T;O++)v[O-1]=arguments[O];p.fn.apply(p.context,v)}else{var A=p.length,y;for(O=0;O<A;O++)switch(p[O].once&&this.removeListener(u,p[O].fn,void 0,!0),T){case 1:p[O].fn.call(p[O].context);break;case 2:p[O].fn.call(p[O].context,c);break;case 3:p[O].fn.call(p[O].context,c,l);break;case 4:p[O].fn.call(p[O].context,c,l,_);break;default:if(!v)for(y=1,v=new Array(T-1);y<T;y++)v[y-1]=arguments[y];p[O].fn.apply(p[O].context,v)}}return!0},o.prototype.on=function(u,c,l){return n(this,u,c,l,!1)},o.prototype.once=function(u,c,l){return n(this,u,c,l,!0)},o.prototype.removeListener=function(u,c,l,_){var d=e?e+u:u;if(!this._events[d])return this;if(!c)return a(this,d),this;var f=this._events[d];if(f.fn)f.fn===c&&(!_||f.once)&&(!l||f.context===l)&&a(this,d);else{for(var m=0,p=[],T=f.length;m<T;m++)(f[m].fn!==c||_&&!f[m].once||l&&f[m].context!==l)&&p.push(f[m]);p.length?this._events[d]=p.length===1?p[0]:p:a(this,d)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=e?e+u:u,this._events[c]&&a(this,c)):(this._events=new s,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=e,o.EventEmitter=o,r.exports=o})(NI);var U0=NI.exports;const Ah=mg(U0);var Ig={exports:{}};Ig.exports=Ql;Ig.exports.default=Ql;function Ql(r,t,e){e=e||2;var s=t&&t.length,i=s?t[0]*e:r.length,n=bI(r,0,i,e,!0),a=[];if(!n||n.next===n.prev)return a;var o,h,u,c,l,_,d;if(s&&(n=B0(r,t,n,e)),r.length>80*e){o=u=r[0],h=c=r[1];for(var f=e;f<i;f+=e)l=r[f],_=r[f+1],l<o&&(o=l),_<h&&(h=_),l>u&&(u=l),_>c&&(c=_);d=Math.max(u-o,c-h),d=d!==0?32767/d:0}return $o(n,a,e,o,h,d,0),a}function bI(r,t,e,s,i){var n,a;if(i===od(r,t,e,s)>0)for(n=t;n<e;n+=s)a=sp(n,r[n],r[n+1],a);else for(n=e-s;n>=t;n-=s)a=sp(n,r[n],r[n+1],a);return a&&Zl(a,a.next)&&(eh(a),a=a.next),a}function Pn(r,t){if(!r)return r;t||(t=r);var e=r,s;do if(s=!1,!e.steiner&&(Zl(e,e.next)||ae(e.prev,e,e.next)===0)){if(eh(e),e=t=e.prev,e===e.next)break;s=!0}else e=e.next;while(s||e!==t);return t}function $o(r,t,e,s,i,n,a){if(r){!a&&n&&z0(r,s,i,n);for(var o=r,h,u;r.prev!==r.next;){if(h=r.prev,u=r.next,n?F0(r,s,i,n):x0(r)){t.push(h.i/e|0),t.push(r.i/e|0),t.push(u.i/e|0),eh(r),r=u.next,o=u.next;continue}if(r=u,r===o){a?a===1?(r=w0(Pn(r),t,e),$o(r,t,e,s,i,n,2)):a===2&&G0(r,t,e,s,i,n):$o(Pn(r),t,e,s,i,n,1);break}}}}function x0(r){var t=r.prev,e=r,s=r.next;if(ae(t,e,s)>=0)return!1;for(var i=t.x,n=e.x,a=s.x,o=t.y,h=e.y,u=s.y,c=i<n?i<a?i:a:n<a?n:a,l=o<h?o<u?o:u:h<u?h:u,_=i>n?i>a?i:a:n>a?n:a,d=o>h?o>u?o:u:h>u?h:u,f=s.next;f!==t;){if(f.x>=c&&f.x<=_&&f.y>=l&&f.y<=d&&ga(i,o,n,h,a,u,f.x,f.y)&&ae(f.prev,f,f.next)>=0)return!1;f=f.next}return!0}function F0(r,t,e,s){var i=r.prev,n=r,a=r.next;if(ae(i,n,a)>=0)return!1;for(var o=i.x,h=n.x,u=a.x,c=i.y,l=n.y,_=a.y,d=o<h?o<u?o:u:h<u?h:u,f=c<l?c<_?c:_:l<_?l:_,m=o>h?o>u?o:u:h>u?h:u,p=c>l?c>_?c:_:l>_?l:_,T=nd(d,f,t,e,s),v=nd(m,p,t,e,s),O=r.prevZ,A=r.nextZ;O&&O.z>=T&&A&&A.z<=v;){if(O.x>=d&&O.x<=m&&O.y>=f&&O.y<=p&&O!==i&&O!==a&&ga(o,c,h,l,u,_,O.x,O.y)&&ae(O.prev,O,O.next)>=0||(O=O.prevZ,A.x>=d&&A.x<=m&&A.y>=f&&A.y<=p&&A!==i&&A!==a&&ga(o,c,h,l,u,_,A.x,A.y)&&ae(A.prev,A,A.next)>=0))return!1;A=A.nextZ}for(;O&&O.z>=T;){if(O.x>=d&&O.x<=m&&O.y>=f&&O.y<=p&&O!==i&&O!==a&&ga(o,c,h,l,u,_,O.x,O.y)&&ae(O.prev,O,O.next)>=0)return!1;O=O.prevZ}for(;A&&A.z<=v;){if(A.x>=d&&A.x<=m&&A.y>=f&&A.y<=p&&A!==i&&A!==a&&ga(o,c,h,l,u,_,A.x,A.y)&&ae(A.prev,A,A.next)>=0)return!1;A=A.nextZ}return!0}function w0(r,t,e){var s=r;do{var i=s.prev,n=s.next.next;!Zl(i,n)&&PI(i,s,s.next,n)&&th(i,n)&&th(n,i)&&(t.push(i.i/e|0),t.push(s.i/e|0),t.push(n.i/e|0),eh(s),eh(s.next),s=r=n),s=s.next}while(s!==r);return Pn(s)}function G0(r,t,e,s,i,n){var a=r;do{for(var o=a.next.next;o!==a.prev;){if(a.i!==o.i&&X0(a,o)){var h=DI(a,o);a=Pn(a,a.next),h=Pn(h,h.next),$o(a,t,e,s,i,n,0),$o(h,t,e,s,i,n,0);return}o=o.next}a=a.next}while(a!==r)}function B0(r,t,e,s){var i=[],n,a,o,h,u;for(n=0,a=t.length;n<a;n++)o=t[n]*s,h=n<a-1?t[n+1]*s:r.length,u=bI(r,o,h,s,!1),u===u.next&&(u.steiner=!0),i.push(W0(u));for(i.sort(H0),n=0;n<i.length;n++)e=V0(i[n],e);return e}function H0(r,t){return r.x-t.x}function V0(r,t){var e=k0(r,t);if(!e)return t;var s=DI(e,r);return Pn(s,s.next),Pn(e,e.next)}function k0(r,t){var e=t,s=r.x,i=r.y,n=-1/0,a;do{if(i<=e.y&&i>=e.next.y&&e.next.y!==e.y){var o=e.x+(i-e.y)*(e.next.x-e.x)/(e.next.y-e.y);if(o<=s&&o>n&&(n=o,a=e.x<e.next.x?e:e.next,o===s))return a}e=e.next}while(e!==t);if(!a)return null;var h=a,u=a.x,c=a.y,l=1/0,_;e=a;do s>=e.x&&e.x>=u&&s!==e.x&&ga(i<c?s:n,i,u,c,i<c?n:s,i,e.x,e.y)&&(_=Math.abs(i-e.y)/(s-e.x),th(e,r)&&(_<l||_===l&&(e.x>a.x||e.x===a.x&&j0(a,e)))&&(a=e,l=_)),e=e.next;while(e!==h);return a}function j0(r,t){return ae(r.prev,r,t.prev)<0&&ae(t.next,r,r.next)<0}function z0(r,t,e,s){var i=r;do i.z===0&&(i.z=nd(i.x,i.y,t,e,s)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==r);i.prevZ.nextZ=null,i.prevZ=null,Y0(i)}function Y0(r){var t,e,s,i,n,a,o,h,u=1;do{for(e=r,r=null,n=null,a=0;e;){for(a++,s=e,o=0,t=0;t<u&&(o++,s=s.nextZ,!!s);t++);for(h=u;o>0||h>0&&s;)o!==0&&(h===0||!s||e.z<=s.z)?(i=e,e=e.nextZ,o--):(i=s,s=s.nextZ,h--),n?n.nextZ=i:r=i,i.prevZ=n,n=i;e=s}n.nextZ=null,u*=2}while(a>1);return r}function nd(r,t,e,s,i){return r=(r-e)*i|0,t=(t-s)*i|0,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,r|t<<1}function W0(r){var t=r,e=r;do(t.x<e.x||t.x===e.x&&t.y<e.y)&&(e=t),t=t.next;while(t!==r);return e}function ga(r,t,e,s,i,n,a,o){return(i-a)*(t-o)>=(r-a)*(n-o)&&(r-a)*(s-o)>=(e-a)*(t-o)&&(e-a)*(n-o)>=(i-a)*(s-o)}function X0(r,t){return r.next.i!==t.i&&r.prev.i!==t.i&&!K0(r,t)&&(th(r,t)&&th(t,r)&&q0(r,t)&&(ae(r.prev,r,t.prev)||ae(r,t.prev,t))||Zl(r,t)&&ae(r.prev,r,r.next)>0&&ae(t.prev,t,t.next)>0)}function ae(r,t,e){return(t.y-r.y)*(e.x-t.x)-(t.x-r.x)*(e.y-t.y)}function Zl(r,t){return r.x===t.x&&r.y===t.y}function PI(r,t,e,s){var i=uu(ae(r,t,e)),n=uu(ae(r,t,s)),a=uu(ae(e,s,r)),o=uu(ae(e,s,t));return!!(i!==n&&a!==o||i===0&&hu(r,e,t)||n===0&&hu(r,s,t)||a===0&&hu(e,r,s)||o===0&&hu(e,t,s))}function hu(r,t,e){return t.x<=Math.max(r.x,e.x)&&t.x>=Math.min(r.x,e.x)&&t.y<=Math.max(r.y,e.y)&&t.y>=Math.min(r.y,e.y)}function uu(r){return r>0?1:r<0?-1:0}function K0(r,t){var e=r;do{if(e.i!==r.i&&e.next.i!==r.i&&e.i!==t.i&&e.next.i!==t.i&&PI(e,e.next,r,t))return!0;e=e.next}while(e!==r);return!1}function th(r,t){return ae(r.prev,r,r.next)<0?ae(r,t,r.next)>=0&&ae(r,r.prev,t)>=0:ae(r,t,r.prev)<0||ae(r,r.next,t)<0}function q0(r,t){var e=r,s=!1,i=(r.x+t.x)/2,n=(r.y+t.y)/2;do e.y>n!=e.next.y>n&&e.next.y!==e.y&&i<(e.next.x-e.x)*(n-e.y)/(e.next.y-e.y)+e.x&&(s=!s),e=e.next;while(e!==r);return s}function DI(r,t){var e=new ad(r.i,r.x,r.y),s=new ad(t.i,t.x,t.y),i=r.next,n=t.prev;return r.next=t,t.prev=r,e.next=i,i.prev=e,s.next=e,e.prev=s,n.next=s,s.prev=n,s}function sp(r,t,e,s){var i=new ad(r,t,e);return s?(i.next=s.next,i.prev=s,s.next.prev=i,s.next=i):(i.prev=i,i.next=i),i}function eh(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function ad(r,t,e){this.i=r,this.x=t,this.y=e,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}Ql.deviation=function(r,t,e,s){var i=t&&t.length,n=i?t[0]*e:r.length,a=Math.abs(od(r,0,n,e));if(i)for(var o=0,h=t.length;o<h;o++){var u=t[o]*e,c=o<h-1?t[o+1]*e:r.length;a-=Math.abs(od(r,u,c,e))}var l=0;for(o=0;o<s.length;o+=3){var _=s[o]*e,d=s[o+1]*e,f=s[o+2]*e;l+=Math.abs((r[_]-r[f])*(r[d+1]-r[_+1])-(r[_]-r[d])*(r[f+1]-r[_+1]))}return a===0&&l===0?0:Math.abs((l-a)/a)};function od(r,t,e,s){for(var i=0,n=t,a=e-s;n<e;n+=s)i+=(r[a]-r[n])*(r[n+1]+r[a+1]),a=n;return i}Ql.flatten=function(r){for(var t=r[0][0].length,e={vertices:[],holes:[],dimensions:t},s=0,i=0;i<r.length;i++){for(var n=0;n<r[i].length;n++)for(var a=0;a<t;a++)e.vertices.push(r[i][n][a]);i>0&&(s+=r[i-1].length,e.holes.push(s))}return e};var Q0=Ig.exports;const LI=mg(Q0);var cl={exports:{}};/*! https://mths.be/punycode v1.4.1 by @mathias */cl.exports;(function(r,t){(function(e){var s=t&&!t.nodeType&&t,i=r&&!r.nodeType&&r,n=typeof Yr=="object"&&Yr;(n.global===n||n.window===n||n.self===n)&&(e=n);var a,o=2147483647,h=36,u=1,c=26,l=38,_=700,d=72,f=128,m="-",p=/^xn--/,T=/[^\x20-\x7E]/,v=/[\x2E\u3002\uFF0E\uFF61]/g,O={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},A=h-u,y=Math.floor,M=String.fromCharCode,N;function P(K){throw new RangeError(O[K])}function b(K,rt){for(var Et=K.length,Lt=[];Et--;)Lt[Et]=rt(K[Et]);return Lt}function D(K,rt){var Et=K.split("@"),Lt="";Et.length>1&&(Lt=Et[0]+"@",K=Et[1]),K=K.replace(v,".");var Tt=K.split("."),bt=b(Tt,rt).join(".");return Lt+bt}function x(K){for(var rt=[],Et=0,Lt=K.length,Tt,bt;Et<Lt;)Tt=K.charCodeAt(Et++),Tt>=55296&&Tt<=56319&&Et<Lt?(bt=K.charCodeAt(Et++),(bt&64512)==56320?rt.push(((Tt&1023)<<10)+(bt&1023)+65536):(rt.push(Tt),Et--)):rt.push(Tt);return rt}function V(K){return b(K,function(rt){var Et="";return rt>65535&&(rt-=65536,Et+=M(rt>>>10&1023|55296),rt=56320|rt&1023),Et+=M(rt),Et}).join("")}function J(K){return K-48<10?K-22:K-65<26?K-65:K-97<26?K-97:h}function ct(K,rt){return K+22+75*(K<26)-((rt!=0)<<5)}function H(K,rt,Et){var Lt=0;for(K=Et?y(K/_):K>>1,K+=y(K/rt);K>A*c>>1;Lt+=h)K=y(K/A);return y(Lt+(A+1)*K/(K+l))}function z(K){var rt=[],Et=K.length,Lt,Tt=0,bt=f,Ft=d,Jt,ee,Ne,_e,se,me,Oe,er,sr;for(Jt=K.lastIndexOf(m),Jt<0&&(Jt=0),ee=0;ee<Jt;++ee)K.charCodeAt(ee)>=128&&P("not-basic"),rt.push(K.charCodeAt(ee));for(Ne=Jt>0?Jt+1:0;Ne<Et;){for(_e=Tt,se=1,me=h;Ne>=Et&&P("invalid-input"),Oe=J(K.charCodeAt(Ne++)),(Oe>=h||Oe>y((o-Tt)/se))&&P("overflow"),Tt+=Oe*se,er=me<=Ft?u:me>=Ft+c?c:me-Ft,!(Oe<er);me+=h)sr=h-er,se>y(o/sr)&&P("overflow"),se*=sr;Lt=rt.length+1,Ft=H(Tt-_e,Lt,_e==0),y(Tt/Lt)>o-bt&&P("overflow"),bt+=y(Tt/Lt),Tt%=Lt,rt.splice(Tt++,0,bt)}return V(rt)}function ht(K){var rt,Et,Lt,Tt,bt,Ft,Jt,ee,Ne,_e,se,me=[],Oe,er,sr,lo;for(K=x(K),Oe=K.length,rt=f,Et=0,bt=d,Ft=0;Ft<Oe;++Ft)se=K[Ft],se<128&&me.push(M(se));for(Lt=Tt=me.length,Tt&&me.push(m);Lt<Oe;){for(Jt=o,Ft=0;Ft<Oe;++Ft)se=K[Ft],se>=rt&&se<Jt&&(Jt=se);for(er=Lt+1,Jt-rt>y((o-Et)/er)&&P("overflow"),Et+=(Jt-rt)*er,rt=Jt,Ft=0;Ft<Oe;++Ft)if(se=K[Ft],se<rt&&++Et>o&&P("overflow"),se==rt){for(ee=Et,Ne=h;_e=Ne<=bt?u:Ne>=bt+c?c:Ne-bt,!(ee<_e);Ne+=h)lo=ee-_e,sr=h-_e,me.push(M(ct(_e+lo%sr,0))),ee=y(lo/sr);me.push(M(ct(ee,0))),bt=H(Et,er,Lt==Tt),Et=0,++Lt}++Et,++rt}return me.join("")}function Xe(K){return D(K,function(rt){return p.test(rt)?z(rt.slice(4).toLowerCase()):rt})}function Ge(K){return D(K,function(rt){return T.test(rt)?"xn--"+ht(rt):rt})}if(a={version:"1.4.1",ucs2:{decode:x,encode:V},decode:z,encode:ht,toASCII:Ge,toUnicode:Xe},s&&i)if(r.exports==s)i.exports=a;else for(N in a)a.hasOwnProperty(N)&&(s[N]=a[N]);else e.punycode=a})(Yr)})(cl,cl.exports);var Z0=cl.exports,J0=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var t={},e=Symbol("test"),s=Object(e);if(typeof e=="string"||Object.prototype.toString.call(e)!=="[object Symbol]"||Object.prototype.toString.call(s)!=="[object Symbol]")return!1;var i=42;t[e]=i;for(e in t)return!1;if(typeof Object.keys=="function"&&Object.keys(t).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(t).length!==0)return!1;var n=Object.getOwnPropertySymbols(t);if(n.length!==1||n[0]!==e||!Object.prototype.propertyIsEnumerable.call(t,e))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(t,e);if(a.value!==i||a.enumerable!==!0)return!1}return!0},rp=typeof Symbol<"u"&&Symbol,$0=J0,tM=function(){return typeof rp!="function"||typeof Symbol!="function"||typeof rp("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:$0()},ip={foo:{}},eM=Object,sM=function(){return{__proto__:ip}.foo===ip.foo&&!({__proto__:null}instanceof eM)},rM="Function.prototype.bind called on incompatible ",iM=Object.prototype.toString,nM=Math.max,aM="[object Function]",np=function(t,e){for(var s=[],i=0;i<t.length;i+=1)s[i]=t[i];for(var n=0;n<e.length;n+=1)s[n+t.length]=e[n];return s},oM=function(t,e){for(var s=[],i=e||0,n=0;i<t.length;i+=1,n+=1)s[n]=t[i];return s},hM=function(r,t){for(var e="",s=0;s<r.length;s+=1)e+=r[s],s+1<r.length&&(e+=t);return e},uM=function(t){var e=this;if(typeof e!="function"||iM.apply(e)!==aM)throw new TypeError(rM+e);for(var s=oM(arguments,1),i,n=function(){if(this instanceof i){var c=e.apply(this,np(s,arguments));return Object(c)===c?c:this}return e.apply(t,np(s,arguments))},a=nM(0,e.length-s.length),o=[],h=0;h<a;h++)o[h]="$"+h;if(i=Function("binder","return function ("+hM(o,",")+"){ return binder.apply(this,arguments); }")(n),e.prototype){var u=function(){};u.prototype=e.prototype,i.prototype=new u,u.prototype=null}return i},lM=uM,Tg=Function.prototype.bind||lM,_M=Function.prototype.call,cM=Object.prototype.hasOwnProperty,dM=Tg,fM=dM.call(_M,cM),vt,La=SyntaxError,UI=Function,ya=TypeError,$_=function(r){try{return UI('"use strict"; return ('+r+").constructor;")()}catch{}},Sn=Object.getOwnPropertyDescriptor;if(Sn)try{Sn({},"")}catch{Sn=null}var tc=function(){throw new ya},gM=Sn?function(){try{return arguments.callee,tc}catch{try{return Sn(arguments,"callee").get}catch{return tc}}}():tc,Jn=tM(),EM=sM(),Ue=Object.getPrototypeOf||(EM?function(r){return r.__proto__}:null),ia={},pM=typeof Uint8Array>"u"||!Ue?vt:Ue(Uint8Array),yn={"%AggregateError%":typeof AggregateError>"u"?vt:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?vt:ArrayBuffer,"%ArrayIteratorPrototype%":Jn&&Ue?Ue([][Symbol.iterator]()):vt,"%AsyncFromSyncIteratorPrototype%":vt,"%AsyncFunction%":ia,"%AsyncGenerator%":ia,"%AsyncGeneratorFunction%":ia,"%AsyncIteratorPrototype%":ia,"%Atomics%":typeof Atomics>"u"?vt:Atomics,"%BigInt%":typeof BigInt>"u"?vt:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?vt:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?vt:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?vt:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?vt:Float32Array,"%Float64Array%":typeof Float64Array>"u"?vt:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?vt:FinalizationRegistry,"%Function%":UI,"%GeneratorFunction%":ia,"%Int8Array%":typeof Int8Array>"u"?vt:Int8Array,"%Int16Array%":typeof Int16Array>"u"?vt:Int16Array,"%Int32Array%":typeof Int32Array>"u"?vt:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":Jn&&Ue?Ue(Ue([][Symbol.iterator]())):vt,"%JSON%":typeof JSON=="object"?JSON:vt,"%Map%":typeof Map>"u"?vt:Map,"%MapIteratorPrototype%":typeof Map>"u"||!Jn||!Ue?vt:Ue(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?vt:Promise,"%Proxy%":typeof Proxy>"u"?vt:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?vt:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?vt:Set,"%SetIteratorPrototype%":typeof Set>"u"||!Jn||!Ue?vt:Ue(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?vt:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":Jn&&Ue?Ue(""[Symbol.iterator]()):vt,"%Symbol%":Jn?Symbol:vt,"%SyntaxError%":La,"%ThrowTypeError%":gM,"%TypedArray%":pM,"%TypeError%":ya,"%Uint8Array%":typeof Uint8Array>"u"?vt:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?vt:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?vt:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?vt:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?vt:WeakMap,"%WeakRef%":typeof WeakRef>"u"?vt:WeakRef,"%WeakSet%":typeof WeakSet>"u"?vt:WeakSet};if(Ue)try{null.error}catch(r){var mM=Ue(Ue(r));yn["%Error.prototype%"]=mM}var IM=function r(t){var e;if(t==="%AsyncFunction%")e=$_("async function () {}");else if(t==="%GeneratorFunction%")e=$_("function* () {}");else if(t==="%AsyncGeneratorFunction%")e=$_("async function* () {}");else if(t==="%AsyncGenerator%"){var s=r("%AsyncGeneratorFunction%");s&&(e=s.prototype)}else if(t==="%AsyncIteratorPrototype%"){var i=r("%AsyncGenerator%");i&&Ue&&(e=Ue(i.prototype))}return yn[t]=e,e},ap={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},Sh=Tg,dl=fM,TM=Sh.call(Function.call,Array.prototype.concat),RM=Sh.call(Function.apply,Array.prototype.splice),op=Sh.call(Function.call,String.prototype.replace),fl=Sh.call(Function.call,String.prototype.slice),OM=Sh.call(Function.call,RegExp.prototype.exec),vM=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,AM=/\\(\\)?/g,SM=function(t){var e=fl(t,0,1),s=fl(t,-1);if(e==="%"&&s!=="%")throw new La("invalid intrinsic syntax, expected closing `%`");if(s==="%"&&e!=="%")throw new La("invalid intrinsic syntax, expected opening `%`");var i=[];return op(t,vM,function(n,a,o,h){i[i.length]=o?op(h,AM,"$1"):a||n}),i},yM=function(t,e){var s=t,i;if(dl(ap,s)&&(i=ap[s],s="%"+i[0]+"%"),dl(yn,s)){var n=yn[s];if(n===ia&&(n=IM(s)),typeof n>"u"&&!e)throw new ya("intrinsic "+t+" exists, but is not available. Please file an issue!");return{alias:i,name:s,value:n}}throw new La("intrinsic "+t+" does not exist!")},Fn=function(t,e){if(typeof t!="string"||t.length===0)throw new ya("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof e!="boolean")throw new ya('"allowMissing" argument must be a boolean');if(OM(/^%?[^%]*%?$/,t)===null)throw new La("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var s=SM(t),i=s.length>0?s[0]:"",n=yM("%"+i+"%",e),a=n.name,o=n.value,h=!1,u=n.alias;u&&(i=u[0],RM(s,TM([0,1],u)));for(var c=1,l=!0;c<s.length;c+=1){var _=s[c],d=fl(_,0,1),f=fl(_,-1);if((d==='"'||d==="'"||d==="`"||f==='"'||f==="'"||f==="`")&&d!==f)throw new La("property names with quotes must have matching quotes");if((_==="constructor"||!l)&&(h=!0),i+="."+_,a="%"+i+"%",dl(yn,a))o=yn[a];else if(o!=null){if(!(_ in o)){if(!e)throw new ya("base intrinsic for "+t+" exists, but the property is not available.");return}if(Sn&&c+1>=s.length){var m=Sn(o,_);l=!!m,l&&"get"in m&&!("originalValue"in m.get)?o=m.get:o=o[_]}else l=dl(o,_),o=o[_];l&&!h&&(yn[a]=o)}}return o},xI={exports:{}},MM=Fn,hd=MM("%Object.defineProperty%",!0),ud=function(){if(hd)try{return hd({},"a",{value:1}),!0}catch{return!1}return!1};ud.hasArrayLengthDefineBug=function(){if(!ud())return null;try{return hd([],"length",{value:1}).length!==1}catch{return!0}};var FI=ud,CM=Fn,Gu=CM("%Object.getOwnPropertyDescriptor%",!0);if(Gu)try{Gu([],"length")}catch{Gu=null}var wI=Gu,NM=FI(),Rg=Fn,Vo=NM&&Rg("%Object.defineProperty%",!0);if(Vo)try{Vo({},"a",{value:1})}catch{Vo=!1}var bM=Rg("%SyntaxError%"),$n=Rg("%TypeError%"),hp=wI,PM=function(t,e,s){if(!t||typeof t!="object"&&typeof t!="function")throw new $n("`obj` must be an object or a function`");if(typeof e!="string"&&typeof e!="symbol")throw new $n("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new $n("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new $n("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new $n("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new $n("`loose`, if provided, must be a boolean");var i=arguments.length>3?arguments[3]:null,n=arguments.length>4?arguments[4]:null,a=arguments.length>5?arguments[5]:null,o=arguments.length>6?arguments[6]:!1,h=!!hp&&hp(t,e);if(Vo)Vo(t,e,{configurable:a===null&&h?h.configurable:!a,enumerable:i===null&&h?h.enumerable:!i,value:s,writable:n===null&&h?h.writable:!n});else if(o||!i&&!n&&!a)t[e]=s;else throw new bM("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},GI=Fn,up=PM,DM=FI(),lp=wI,_p=GI("%TypeError%"),LM=GI("%Math.floor%"),UM=function(t,e){if(typeof t!="function")throw new _p("`fn` is not a function");if(typeof e!="number"||e<0||e>4294967295||LM(e)!==e)throw new _p("`length` must be a positive 32-bit integer");var s=arguments.length>2&&!!arguments[2],i=!0,n=!0;if("length"in t&&lp){var a=lp(t,"length");a&&!a.configurable&&(i=!1),a&&!a.writable&&(n=!1)}return(i||n||!s)&&(DM?up(t,"length",e,!0,!0):up(t,"length",e)),t};(function(r){var t=Tg,e=Fn,s=UM,i=e("%TypeError%"),n=e("%Function.prototype.apply%"),a=e("%Function.prototype.call%"),o=e("%Reflect.apply%",!0)||t.call(a,n),h=e("%Object.defineProperty%",!0),u=e("%Math.max%");if(h)try{h({},"a",{value:1})}catch{h=null}r.exports=function(_){if(typeof _!="function")throw new i("a function is required");var d=o(t,a,arguments);return s(d,1+u(0,_.length-(arguments.length-1)),!0)};var c=function(){return o(t,n,arguments)};h?h(r.exports,"apply",{value:c}):r.exports.apply=c})(xI);var xM=xI.exports,BI=Fn,HI=xM,FM=HI(BI("String.prototype.indexOf")),wM=function(t,e){var s=BI(t,!!e);return typeof s=="function"&&FM(t,".prototype.")>-1?HI(s):s};const GM={},BM=Object.freeze(Object.defineProperty({__proto__:null,default:GM},Symbol.toStringTag,{value:"Module"})),HM=C0(BM);var Og=typeof Map=="function"&&Map.prototype,ec=Object.getOwnPropertyDescriptor&&Og?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,gl=Og&&ec&&typeof ec.get=="function"?ec.get:null,cp=Og&&Map.prototype.forEach,vg=typeof Set=="function"&&Set.prototype,sc=Object.getOwnPropertyDescriptor&&vg?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,El=vg&&sc&&typeof sc.get=="function"?sc.get:null,dp=vg&&Set.prototype.forEach,VM=typeof WeakMap=="function"&&WeakMap.prototype,ko=VM?WeakMap.prototype.has:null,kM=typeof WeakSet=="function"&&WeakSet.prototype,jo=kM?WeakSet.prototype.has:null,jM=typeof WeakRef=="function"&&WeakRef.prototype,fp=jM?WeakRef.prototype.deref:null,zM=Boolean.prototype.valueOf,YM=Object.prototype.toString,WM=Function.prototype.toString,XM=String.prototype.match,Ag=String.prototype.slice,Ni=String.prototype.replace,KM=String.prototype.toUpperCase,gp=String.prototype.toLowerCase,VI=RegExp.prototype.test,Ep=Array.prototype.concat,or=Array.prototype.join,qM=Array.prototype.slice,pp=Math.floor,ld=typeof BigInt=="function"?BigInt.prototype.valueOf:null,rc=Object.getOwnPropertySymbols,_d=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,Ua=typeof Symbol=="function"&&typeof Symbol.iterator=="object",ts=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===Ua||"symbol")?Symbol.toStringTag:null,kI=Object.prototype.propertyIsEnumerable,mp=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(r){return r.__proto__}:null);function Ip(r,t){if(r===1/0||r===-1/0||r!==r||r&&r>-1e3&&r<1e3||VI.call(/e/,t))return t;var e=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof r=="number"){var s=r<0?-pp(-r):pp(r);if(s!==r){var i=String(s),n=Ag.call(t,i.length+1);return Ni.call(i,e,"$&_")+"."+Ni.call(Ni.call(n,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Ni.call(t,e,"$&_")}var cd=HM,Tp=cd.custom,Rp=zI(Tp)?Tp:null,QM=function r(t,e,s,i){var n=e||{};if(Oi(n,"quoteStyle")&&n.quoteStyle!=="single"&&n.quoteStyle!=="double")throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Oi(n,"maxStringLength")&&(typeof n.maxStringLength=="number"?n.maxStringLength<0&&n.maxStringLength!==1/0:n.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Oi(n,"customInspect")?n.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Oi(n,"indent")&&n.indent!==null&&n.indent!=="	"&&!(parseInt(n.indent,10)===n.indent&&n.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Oi(n,"numericSeparator")&&typeof n.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var o=n.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return WI(t,n);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var h=String(t);return o?Ip(t,h):h}if(typeof t=="bigint"){var u=String(t)+"n";return o?Ip(t,u):u}var c=typeof n.depth>"u"?5:n.depth;if(typeof s>"u"&&(s=0),s>=c&&c>0&&typeof t=="object")return dd(t)?"[Array]":"[Object]";var l=fC(n,s);if(typeof i>"u")i=[];else if(YI(i,t)>=0)return"[Circular]";function _(J,ct,H){if(ct&&(i=qM.call(i),i.push(ct)),H){var z={depth:n.depth};return Oi(n,"quoteStyle")&&(z.quoteStyle=n.quoteStyle),r(J,z,s+1,i)}return r(J,n,s+1,i)}if(typeof t=="function"&&!Op(t)){var d=nC(t),f=lu(t,_);return"[Function"+(d?": "+d:" (anonymous)")+"]"+(f.length>0?" { "+or.call(f,", ")+" }":"")}if(zI(t)){var m=Ua?Ni.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):_d.call(t);return typeof t=="object"&&!Ua?_o(m):m}if(_C(t)){for(var p="<"+gp.call(String(t.nodeName)),T=t.attributes||[],v=0;v<T.length;v++)p+=" "+T[v].name+"="+jI(ZM(T[v].value),"double",n);return p+=">",t.childNodes&&t.childNodes.length&&(p+="..."),p+="</"+gp.call(String(t.nodeName))+">",p}if(dd(t)){if(t.length===0)return"[]";var O=lu(t,_);return l&&!dC(O)?"["+fd(O,l)+"]":"[ "+or.call(O,", ")+" ]"}if($M(t)){var A=lu(t,_);return!("cause"in Error.prototype)&&"cause"in t&&!kI.call(t,"cause")?"{ ["+String(t)+"] "+or.call(Ep.call("[cause]: "+_(t.cause),A),", ")+" }":A.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+or.call(A,", ")+" }"}if(typeof t=="object"&&a){if(Rp&&typeof t[Rp]=="function"&&cd)return cd(t,{depth:c-s});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if(aC(t)){var y=[];return cp&&cp.call(t,function(J,ct){y.push(_(ct,t,!0)+" => "+_(J,t))}),vp("Map",gl.call(t),y,l)}if(uC(t)){var M=[];return dp&&dp.call(t,function(J){M.push(_(J,t))}),vp("Set",El.call(t),M,l)}if(oC(t))return ic("WeakMap");if(lC(t))return ic("WeakSet");if(hC(t))return ic("WeakRef");if(eC(t))return _o(_(Number(t)));if(rC(t))return _o(_(ld.call(t)));if(sC(t))return _o(zM.call(t));if(tC(t))return _o(_(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(t===Yr)return"{ [object globalThis] }";if(!JM(t)&&!Op(t)){var N=lu(t,_),P=mp?mp(t)===Object.prototype:t instanceof Object||t.constructor===Object,b=t instanceof Object?"":"null prototype",D=!P&&ts&&Object(t)===t&&ts in t?Ag.call(ji(t),8,-1):b?"Object":"",x=P||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",V=x+(D||b?"["+or.call(Ep.call([],D||[],b||[]),": ")+"] ":"");return N.length===0?V+"{}":l?V+"{"+fd(N,l)+"}":V+"{ "+or.call(N,", ")+" }"}return String(t)};function jI(r,t,e){var s=(e.quoteStyle||t)==="double"?'"':"'";return s+r+s}function ZM(r){return Ni.call(String(r),/"/g,"&quot;")}function dd(r){return ji(r)==="[object Array]"&&(!ts||!(typeof r=="object"&&ts in r))}function JM(r){return ji(r)==="[object Date]"&&(!ts||!(typeof r=="object"&&ts in r))}function Op(r){return ji(r)==="[object RegExp]"&&(!ts||!(typeof r=="object"&&ts in r))}function $M(r){return ji(r)==="[object Error]"&&(!ts||!(typeof r=="object"&&ts in r))}function tC(r){return ji(r)==="[object String]"&&(!ts||!(typeof r=="object"&&ts in r))}function eC(r){return ji(r)==="[object Number]"&&(!ts||!(typeof r=="object"&&ts in r))}function sC(r){return ji(r)==="[object Boolean]"&&(!ts||!(typeof r=="object"&&ts in r))}function zI(r){if(Ua)return r&&typeof r=="object"&&r instanceof Symbol;if(typeof r=="symbol")return!0;if(!r||typeof r!="object"||!_d)return!1;try{return _d.call(r),!0}catch{}return!1}function rC(r){if(!r||typeof r!="object"||!ld)return!1;try{return ld.call(r),!0}catch{}return!1}var iC=Object.prototype.hasOwnProperty||function(r){return r in this};function Oi(r,t){return iC.call(r,t)}function ji(r){return YM.call(r)}function nC(r){if(r.name)return r.name;var t=XM.call(WM.call(r),/^function\s*([\w$]+)/);return t?t[1]:null}function YI(r,t){if(r.indexOf)return r.indexOf(t);for(var e=0,s=r.length;e<s;e++)if(r[e]===t)return e;return-1}function aC(r){if(!gl||!r||typeof r!="object")return!1;try{gl.call(r);try{El.call(r)}catch{return!0}return r instanceof Map}catch{}return!1}function oC(r){if(!ko||!r||typeof r!="object")return!1;try{ko.call(r,ko);try{jo.call(r,jo)}catch{return!0}return r instanceof WeakMap}catch{}return!1}function hC(r){if(!fp||!r||typeof r!="object")return!1;try{return fp.call(r),!0}catch{}return!1}function uC(r){if(!El||!r||typeof r!="object")return!1;try{El.call(r);try{gl.call(r)}catch{return!0}return r instanceof Set}catch{}return!1}function lC(r){if(!jo||!r||typeof r!="object")return!1;try{jo.call(r,jo);try{ko.call(r,ko)}catch{return!0}return r instanceof WeakSet}catch{}return!1}function _C(r){return!r||typeof r!="object"?!1:typeof HTMLElement<"u"&&r instanceof HTMLElement?!0:typeof r.nodeName=="string"&&typeof r.getAttribute=="function"}function WI(r,t){if(r.length>t.maxStringLength){var e=r.length-t.maxStringLength,s="... "+e+" more character"+(e>1?"s":"");return WI(Ag.call(r,0,t.maxStringLength),t)+s}var i=Ni.call(Ni.call(r,/(['\\])/g,"\\$1"),/[\x00-\x1f]/g,cC);return jI(i,"single",t)}function cC(r){var t=r.charCodeAt(0),e={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return e?"\\"+e:"\\x"+(t<16?"0":"")+KM.call(t.toString(16))}function _o(r){return"Object("+r+")"}function ic(r){return r+" { ? }"}function vp(r,t,e,s){var i=s?fd(e,s):or.call(e,", ");return r+" ("+t+") {"+i+"}"}function dC(r){for(var t=0;t<r.length;t++)if(YI(r[t],`
`)>=0)return!1;return!0}function fC(r,t){var e;if(r.indent==="	")e="	";else if(typeof r.indent=="number"&&r.indent>0)e=or.call(Array(r.indent+1)," ");else return null;return{base:e,prev:or.call(Array(t+1),e)}}function fd(r,t){if(r.length===0)return"";var e=`
`+t.prev+t.base;return e+or.call(r,","+e)+`
`+t.prev}function lu(r,t){var e=dd(r),s=[];if(e){s.length=r.length;for(var i=0;i<r.length;i++)s[i]=Oi(r,i)?t(r[i],r):""}var n=typeof rc=="function"?rc(r):[],a;if(Ua){a={};for(var o=0;o<n.length;o++)a["$"+n[o]]=n[o]}for(var h in r)Oi(r,h)&&(e&&String(Number(h))===h&&h<r.length||Ua&&a["$"+h]instanceof Symbol||(VI.call(/[^\w$]/,h)?s.push(t(h,r)+": "+t(r[h],r)):s.push(h+": "+t(r[h],r))));if(typeof rc=="function")for(var u=0;u<n.length;u++)kI.call(r,n[u])&&s.push("["+t(n[u])+"]: "+t(r[n[u]],r));return s}var Sg=Fn,Ya=wM,gC=QM,EC=Sg("%TypeError%"),_u=Sg("%WeakMap%",!0),cu=Sg("%Map%",!0),pC=Ya("WeakMap.prototype.get",!0),mC=Ya("WeakMap.prototype.set",!0),IC=Ya("WeakMap.prototype.has",!0),TC=Ya("Map.prototype.get",!0),RC=Ya("Map.prototype.set",!0),OC=Ya("Map.prototype.has",!0),yg=function(r,t){for(var e=r,s;(s=e.next)!==null;e=s)if(s.key===t)return e.next=s.next,s.next=r.next,r.next=s,s},vC=function(r,t){var e=yg(r,t);return e&&e.value},AC=function(r,t,e){var s=yg(r,t);s?s.value=e:r.next={key:t,next:r.next,value:e}},SC=function(r,t){return!!yg(r,t)},yC=function(){var t,e,s,i={assert:function(n){if(!i.has(n))throw new EC("Side channel does not contain "+gC(n))},get:function(n){if(_u&&n&&(typeof n=="object"||typeof n=="function")){if(t)return pC(t,n)}else if(cu){if(e)return TC(e,n)}else if(s)return vC(s,n)},has:function(n){if(_u&&n&&(typeof n=="object"||typeof n=="function")){if(t)return IC(t,n)}else if(cu){if(e)return OC(e,n)}else if(s)return SC(s,n);return!1},set:function(n,a){_u&&n&&(typeof n=="object"||typeof n=="function")?(t||(t=new _u),mC(t,n,a)):cu?(e||(e=new cu),RC(e,n,a)):(s||(s={key:{},next:null}),AC(s,n,a))}};return i},MC=String.prototype.replace,CC=/%20/g,nc={RFC1738:"RFC1738",RFC3986:"RFC3986"},Mg={default:nc.RFC3986,formatters:{RFC1738:function(r){return MC.call(r,CC,"+")},RFC3986:function(r){return String(r)}},RFC1738:nc.RFC1738,RFC3986:nc.RFC3986},NC=Mg,ac=Object.prototype.hasOwnProperty,fn=Array.isArray,rr=function(){for(var r=[],t=0;t<256;++t)r.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return r}(),bC=function(t){for(;t.length>1;){var e=t.pop(),s=e.obj[e.prop];if(fn(s)){for(var i=[],n=0;n<s.length;++n)typeof s[n]<"u"&&i.push(s[n]);e.obj[e.prop]=i}}},XI=function(t,e){for(var s=e&&e.plainObjects?Object.create(null):{},i=0;i<t.length;++i)typeof t[i]<"u"&&(s[i]=t[i]);return s},PC=function r(t,e,s){if(!e)return t;if(typeof e!="object"){if(fn(t))t.push(e);else if(t&&typeof t=="object")(s&&(s.plainObjects||s.allowPrototypes)||!ac.call(Object.prototype,e))&&(t[e]=!0);else return[t,e];return t}if(!t||typeof t!="object")return[t].concat(e);var i=t;return fn(t)&&!fn(e)&&(i=XI(t,s)),fn(t)&&fn(e)?(e.forEach(function(n,a){if(ac.call(t,a)){var o=t[a];o&&typeof o=="object"&&n&&typeof n=="object"?t[a]=r(o,n,s):t.push(n)}else t[a]=n}),t):Object.keys(e).reduce(function(n,a){var o=e[a];return ac.call(n,a)?n[a]=r(n[a],o,s):n[a]=o,n},i)},DC=function(t,e){return Object.keys(e).reduce(function(s,i){return s[i]=e[i],s},t)},LC=function(r,t,e){var s=r.replace(/\+/g," ");if(e==="iso-8859-1")return s.replace(/%[0-9a-f]{2}/gi,unescape);try{return decodeURIComponent(s)}catch{return s}},UC=function(t,e,s,i,n){if(t.length===0)return t;var a=t;if(typeof t=="symbol"?a=Symbol.prototype.toString.call(t):typeof t!="string"&&(a=String(t)),s==="iso-8859-1")return escape(a).replace(/%u[0-9a-f]{4}/gi,function(c){return"%26%23"+parseInt(c.slice(2),16)+"%3B"});for(var o="",h=0;h<a.length;++h){var u=a.charCodeAt(h);if(u===45||u===46||u===95||u===126||u>=48&&u<=57||u>=65&&u<=90||u>=97&&u<=122||n===NC.RFC1738&&(u===40||u===41)){o+=a.charAt(h);continue}if(u<128){o=o+rr[u];continue}if(u<2048){o=o+(rr[192|u>>6]+rr[128|u&63]);continue}if(u<55296||u>=57344){o=o+(rr[224|u>>12]+rr[128|u>>6&63]+rr[128|u&63]);continue}h+=1,u=65536+((u&1023)<<10|a.charCodeAt(h)&1023),o+=rr[240|u>>18]+rr[128|u>>12&63]+rr[128|u>>6&63]+rr[128|u&63]}return o},xC=function(t){for(var e=[{obj:{o:t},prop:"o"}],s=[],i=0;i<e.length;++i)for(var n=e[i],a=n.obj[n.prop],o=Object.keys(a),h=0;h<o.length;++h){var u=o[h],c=a[u];typeof c=="object"&&c!==null&&s.indexOf(c)===-1&&(e.push({obj:a,prop:u}),s.push(c))}return bC(e),t},FC=function(t){return Object.prototype.toString.call(t)==="[object RegExp]"},wC=function(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))},GC=function(t,e){return[].concat(t,e)},BC=function(t,e){if(fn(t)){for(var s=[],i=0;i<t.length;i+=1)s.push(e(t[i]));return s}return e(t)},KI={arrayToObject:XI,assign:DC,combine:GC,compact:xC,decode:LC,encode:UC,isBuffer:wC,isRegExp:FC,maybeMap:BC,merge:PC},qI=yC,Bu=KI,zo=Mg,HC=Object.prototype.hasOwnProperty,Ap={brackets:function(t){return t+"[]"},comma:"comma",indices:function(t,e){return t+"["+e+"]"},repeat:function(t){return t}},Hr=Array.isArray,VC=Array.prototype.push,QI=function(r,t){VC.apply(r,Hr(t)?t:[t])},kC=Date.prototype.toISOString,Sp=zo.default,qe={addQueryPrefix:!1,allowDots:!1,charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encoder:Bu.encode,encodeValuesOnly:!1,format:Sp,formatter:zo.formatters[Sp],indices:!1,serializeDate:function(t){return kC.call(t)},skipNulls:!1,strictNullHandling:!1},jC=function(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"},oc={},zC=function r(t,e,s,i,n,a,o,h,u,c,l,_,d,f,m,p){for(var T=t,v=p,O=0,A=!1;(v=v.get(oc))!==void 0&&!A;){var y=v.get(t);if(O+=1,typeof y<"u"){if(y===O)throw new RangeError("Cyclic object value");A=!0}typeof v.get(oc)>"u"&&(O=0)}if(typeof h=="function"?T=h(e,T):T instanceof Date?T=l(T):s==="comma"&&Hr(T)&&(T=Bu.maybeMap(T,function(z){return z instanceof Date?l(z):z})),T===null){if(n)return o&&!f?o(e,qe.encoder,m,"key",_):e;T=""}if(jC(T)||Bu.isBuffer(T)){if(o){var M=f?e:o(e,qe.encoder,m,"key",_);return[d(M)+"="+d(o(T,qe.encoder,m,"value",_))]}return[d(e)+"="+d(String(T))]}var N=[];if(typeof T>"u")return N;var P;if(s==="comma"&&Hr(T))f&&o&&(T=Bu.maybeMap(T,o)),P=[{value:T.length>0?T.join(",")||null:void 0}];else if(Hr(h))P=h;else{var b=Object.keys(T);P=u?b.sort(u):b}for(var D=i&&Hr(T)&&T.length===1?e+"[]":e,x=0;x<P.length;++x){var V=P[x],J=typeof V=="object"&&typeof V.value<"u"?V.value:T[V];if(!(a&&J===null)){var ct=Hr(T)?typeof s=="function"?s(D,V):D:D+(c?"."+V:"["+V+"]");p.set(t,O);var H=qI();H.set(oc,p),QI(N,r(J,ct,s,i,n,a,s==="comma"&&f&&Hr(T)?null:o,h,u,c,l,_,d,f,m,H))}}return N},YC=function(t){if(!t)return qe;if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");var e=t.charset||qe.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var s=zo.default;if(typeof t.format<"u"){if(!HC.call(zo.formatters,t.format))throw new TypeError("Unknown format option provided.");s=t.format}var i=zo.formatters[s],n=qe.filter;return(typeof t.filter=="function"||Hr(t.filter))&&(n=t.filter),{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:qe.addQueryPrefix,allowDots:typeof t.allowDots>"u"?qe.allowDots:!!t.allowDots,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:qe.charsetSentinel,delimiter:typeof t.delimiter>"u"?qe.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:qe.encode,encoder:typeof t.encoder=="function"?t.encoder:qe.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:qe.encodeValuesOnly,filter:n,format:s,formatter:i,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:qe.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:qe.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:qe.strictNullHandling}},WC=function(r,t){var e=r,s=YC(t),i,n;typeof s.filter=="function"?(n=s.filter,e=n("",e)):Hr(s.filter)&&(n=s.filter,i=n);var a=[];if(typeof e!="object"||e===null)return"";var o;t&&t.arrayFormat in Ap?o=t.arrayFormat:t&&"indices"in t?o=t.indices?"indices":"repeat":o="indices";var h=Ap[o];if(t&&"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");var u=h==="comma"&&t&&t.commaRoundTrip;i||(i=Object.keys(e)),s.sort&&i.sort(s.sort);for(var c=qI(),l=0;l<i.length;++l){var _=i[l];s.skipNulls&&e[_]===null||QI(a,zC(e[_],_,h,u,s.strictNullHandling,s.skipNulls,s.encode?s.encoder:null,s.filter,s.sort,s.allowDots,s.serializeDate,s.format,s.formatter,s.encodeValuesOnly,s.charset,c))}var d=a.join(s.delimiter),f=s.addQueryPrefix===!0?"?":"";return s.charsetSentinel&&(s.charset==="iso-8859-1"?f+="utf8=%26%2310003%3B&":f+="utf8=%E2%9C%93&"),d.length>0?f+d:""},xa=KI,gd=Object.prototype.hasOwnProperty,XC=Array.isArray,De={allowDots:!1,allowPrototypes:!1,allowSparse:!1,arrayLimit:20,charset:"utf-8",charsetSentinel:!1,comma:!1,decoder:xa.decode,delimiter:"&",depth:5,ignoreQueryPrefix:!1,interpretNumericEntities:!1,parameterLimit:1e3,parseArrays:!0,plainObjects:!1,strictNullHandling:!1},KC=function(r){return r.replace(/&#(\d+);/g,function(t,e){return String.fromCharCode(parseInt(e,10))})},ZI=function(r,t){return r&&typeof r=="string"&&t.comma&&r.indexOf(",")>-1?r.split(","):r},qC="utf8=%26%2310003%3B",QC="utf8=%E2%9C%93",ZC=function(t,e){var s={__proto__:null},i=e.ignoreQueryPrefix?t.replace(/^\?/,""):t,n=e.parameterLimit===1/0?void 0:e.parameterLimit,a=i.split(e.delimiter,n),o=-1,h,u=e.charset;if(e.charsetSentinel)for(h=0;h<a.length;++h)a[h].indexOf("utf8=")===0&&(a[h]===QC?u="utf-8":a[h]===qC&&(u="iso-8859-1"),o=h,h=a.length);for(h=0;h<a.length;++h)if(h!==o){var c=a[h],l=c.indexOf("]="),_=l===-1?c.indexOf("="):l+1,d,f;_===-1?(d=e.decoder(c,De.decoder,u,"key"),f=e.strictNullHandling?null:""):(d=e.decoder(c.slice(0,_),De.decoder,u,"key"),f=xa.maybeMap(ZI(c.slice(_+1),e),function(m){return e.decoder(m,De.decoder,u,"value")})),f&&e.interpretNumericEntities&&u==="iso-8859-1"&&(f=KC(f)),c.indexOf("[]=")>-1&&(f=XC(f)?[f]:f),gd.call(s,d)?s[d]=xa.combine(s[d],f):s[d]=f}return s},JC=function(r,t,e,s){for(var i=s?t:ZI(t,e),n=r.length-1;n>=0;--n){var a,o=r[n];if(o==="[]"&&e.parseArrays)a=[].concat(i);else{a=e.plainObjects?Object.create(null):{};var h=o.charAt(0)==="["&&o.charAt(o.length-1)==="]"?o.slice(1,-1):o,u=parseInt(h,10);!e.parseArrays&&h===""?a={0:i}:!isNaN(u)&&o!==h&&String(u)===h&&u>=0&&e.parseArrays&&u<=e.arrayLimit?(a=[],a[u]=i):h!=="__proto__"&&(a[h]=i)}i=a}return i},$C=function(t,e,s,i){if(t){var n=s.allowDots?t.replace(/\.([^.[]+)/g,"[$1]"):t,a=/(\[[^[\]]*])/,o=/(\[[^[\]]*])/g,h=s.depth>0&&a.exec(n),u=h?n.slice(0,h.index):n,c=[];if(u){if(!s.plainObjects&&gd.call(Object.prototype,u)&&!s.allowPrototypes)return;c.push(u)}for(var l=0;s.depth>0&&(h=o.exec(n))!==null&&l<s.depth;){if(l+=1,!s.plainObjects&&gd.call(Object.prototype,h[1].slice(1,-1))&&!s.allowPrototypes)return;c.push(h[1])}return h&&c.push("["+n.slice(h.index)+"]"),JC(c,e,s,i)}},tN=function(t){if(!t)return De;if(t.decoder!==null&&t.decoder!==void 0&&typeof t.decoder!="function")throw new TypeError("Decoder has to be a function.");if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");var e=typeof t.charset>"u"?De.charset:t.charset;return{allowDots:typeof t.allowDots>"u"?De.allowDots:!!t.allowDots,allowPrototypes:typeof t.allowPrototypes=="boolean"?t.allowPrototypes:De.allowPrototypes,allowSparse:typeof t.allowSparse=="boolean"?t.allowSparse:De.allowSparse,arrayLimit:typeof t.arrayLimit=="number"?t.arrayLimit:De.arrayLimit,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:De.charsetSentinel,comma:typeof t.comma=="boolean"?t.comma:De.comma,decoder:typeof t.decoder=="function"?t.decoder:De.decoder,delimiter:typeof t.delimiter=="string"||xa.isRegExp(t.delimiter)?t.delimiter:De.delimiter,depth:typeof t.depth=="number"||t.depth===!1?+t.depth:De.depth,ignoreQueryPrefix:t.ignoreQueryPrefix===!0,interpretNumericEntities:typeof t.interpretNumericEntities=="boolean"?t.interpretNumericEntities:De.interpretNumericEntities,parameterLimit:typeof t.parameterLimit=="number"?t.parameterLimit:De.parameterLimit,parseArrays:t.parseArrays!==!1,plainObjects:typeof t.plainObjects=="boolean"?t.plainObjects:De.plainObjects,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:De.strictNullHandling}},eN=function(r,t){var e=tN(t);if(r===""||r===null||typeof r>"u")return e.plainObjects?Object.create(null):{};for(var s=typeof r=="string"?ZC(r,e):r,i=e.plainObjects?Object.create(null):{},n=Object.keys(s),a=0;a<n.length;++a){var o=n[a],h=$C(o,s[o],e,typeof r=="string");i=xa.merge(i,h,e)}return e.allowSparse===!0?i:xa.compact(i)},sN=WC,rN=eN,iN=Mg,nN={formats:iN,parse:rN,stringify:sN},aN=Z0;function Ws(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}var oN=/^([a-z0-9.+-]+:)/i,hN=/:[0-9]*$/,uN=/^(\/\/?(?!\/)[^?\s]*)(\?[^\s]*)?$/,lN=["<",">",'"',"`"," ","\r",`
`,"	"],_N=["{","}","|","\\","^","`"].concat(lN),Ed=["'"].concat(_N),yp=["%","/","?",";","#"].concat(Ed),Mp=["/","?","#"],cN=255,Cp=/^[+a-z0-9A-Z_-]{0,63}$/,dN=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,fN={javascript:!0,"javascript:":!0},pd={javascript:!0,"javascript:":!0},Ma={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},md=nN;function Jl(r,t,e){if(r&&typeof r=="object"&&r instanceof Ws)return r;var s=new Ws;return s.parse(r,t,e),s}Ws.prototype.parse=function(r,t,e){if(typeof r!="string")throw new TypeError("Parameter 'url' must be a string, not "+typeof r);var s=r.indexOf("?"),i=s!==-1&&s<r.indexOf("#")?"?":"#",n=r.split(i),a=/\\/g;n[0]=n[0].replace(a,"/"),r=n.join(i);var o=r;if(o=o.trim(),!e&&r.split("#").length===1){var h=uN.exec(o);if(h)return this.path=o,this.href=o,this.pathname=h[1],h[2]?(this.search=h[2],t?this.query=md.parse(this.search.substr(1)):this.query=this.search.substr(1)):t&&(this.search="",this.query={}),this}var u=oN.exec(o);if(u){u=u[0];var c=u.toLowerCase();this.protocol=c,o=o.substr(u.length)}if(e||u||o.match(/^\/\/[^@/]+@[^@/]+/)){var l=o.substr(0,2)==="//";l&&!(u&&pd[u])&&(o=o.substr(2),this.slashes=!0)}if(!pd[u]&&(l||u&&!Ma[u])){for(var _=-1,d=0;d<Mp.length;d++){var f=o.indexOf(Mp[d]);f!==-1&&(_===-1||f<_)&&(_=f)}var m,p;_===-1?p=o.lastIndexOf("@"):p=o.lastIndexOf("@",_),p!==-1&&(m=o.slice(0,p),o=o.slice(p+1),this.auth=decodeURIComponent(m)),_=-1;for(var d=0;d<yp.length;d++){var f=o.indexOf(yp[d]);f!==-1&&(_===-1||f<_)&&(_=f)}_===-1&&(_=o.length),this.host=o.slice(0,_),o=o.slice(_),this.parseHost(),this.hostname=this.hostname||"";var T=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!T)for(var v=this.hostname.split(/\./),d=0,O=v.length;d<O;d++){var A=v[d];if(A&&!A.match(Cp)){for(var y="",M=0,N=A.length;M<N;M++)A.charCodeAt(M)>127?y+="x":y+=A[M];if(!y.match(Cp)){var P=v.slice(0,d),b=v.slice(d+1),D=A.match(dN);D&&(P.push(D[1]),b.unshift(D[2])),b.length&&(o="/"+b.join(".")+o),this.hostname=P.join(".");break}}}this.hostname.length>cN?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=aN.toASCII(this.hostname));var x=this.port?":"+this.port:"",V=this.hostname||"";this.host=V+x,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),o[0]!=="/"&&(o="/"+o))}if(!fN[c])for(var d=0,O=Ed.length;d<O;d++){var J=Ed[d];if(o.indexOf(J)!==-1){var ct=encodeURIComponent(J);ct===J&&(ct=escape(J)),o=o.split(J).join(ct)}}var H=o.indexOf("#");H!==-1&&(this.hash=o.substr(H),o=o.slice(0,H));var z=o.indexOf("?");if(z!==-1?(this.search=o.substr(z),this.query=o.substr(z+1),t&&(this.query=md.parse(this.query)),o=o.slice(0,z)):t&&(this.search="",this.query={}),o&&(this.pathname=o),Ma[c]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var x=this.pathname||"",ht=this.search||"";this.path=x+ht}return this.href=this.format(),this};function gN(r){return typeof r=="string"&&(r=Jl(r)),r instanceof Ws?r.format():Ws.prototype.format.call(r)}Ws.prototype.format=function(){var r=this.auth||"";r&&(r=encodeURIComponent(r),r=r.replace(/%3A/i,":"),r+="@");var t=this.protocol||"",e=this.pathname||"",s=this.hash||"",i=!1,n="";this.host?i=r+this.host:this.hostname&&(i=r+(this.hostname.indexOf(":")===-1?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&typeof this.query=="object"&&Object.keys(this.query).length&&(n=md.stringify(this.query,{arrayFormat:"repeat",addQueryPrefix:!1}));var a=this.search||n&&"?"+n||"";return t&&t.substr(-1)!==":"&&(t+=":"),this.slashes||(!t||Ma[t])&&i!==!1?(i="//"+(i||""),e&&e.charAt(0)!=="/"&&(e="/"+e)):i||(i=""),s&&s.charAt(0)!=="#"&&(s="#"+s),a&&a.charAt(0)!=="?"&&(a="?"+a),e=e.replace(/[?#]/g,function(o){return encodeURIComponent(o)}),a=a.replace("#","%23"),t+i+e+a+s};function EN(r,t){return Jl(r,!1,!0).resolve(t)}Ws.prototype.resolve=function(r){return this.resolveObject(Jl(r,!1,!0)).format()};Ws.prototype.resolveObject=function(r){if(typeof r=="string"){var t=new Ws;t.parse(r,!1,!0),r=t}for(var e=new Ws,s=Object.keys(this),i=0;i<s.length;i++){var n=s[i];e[n]=this[n]}if(e.hash=r.hash,r.href==="")return e.href=e.format(),e;if(r.slashes&&!r.protocol){for(var a=Object.keys(r),o=0;o<a.length;o++){var h=a[o];h!=="protocol"&&(e[h]=r[h])}return Ma[e.protocol]&&e.hostname&&!e.pathname&&(e.pathname="/",e.path=e.pathname),e.href=e.format(),e}if(r.protocol&&r.protocol!==e.protocol){if(!Ma[r.protocol]){for(var u=Object.keys(r),c=0;c<u.length;c++){var l=u[c];e[l]=r[l]}return e.href=e.format(),e}if(e.protocol=r.protocol,!r.host&&!pd[r.protocol]){for(var O=(r.pathname||"").split("/");O.length&&!(r.host=O.shift()););r.host||(r.host=""),r.hostname||(r.hostname=""),O[0]!==""&&O.unshift(""),O.length<2&&O.unshift(""),e.pathname=O.join("/")}else e.pathname=r.pathname;if(e.search=r.search,e.query=r.query,e.host=r.host||"",e.auth=r.auth,e.hostname=r.hostname||r.host,e.port=r.port,e.pathname||e.search){var _=e.pathname||"",d=e.search||"";e.path=_+d}return e.slashes=e.slashes||r.slashes,e.href=e.format(),e}var f=e.pathname&&e.pathname.charAt(0)==="/",m=r.host||r.pathname&&r.pathname.charAt(0)==="/",p=m||f||e.host&&r.pathname,T=p,v=e.pathname&&e.pathname.split("/")||[],O=r.pathname&&r.pathname.split("/")||[],A=e.protocol&&!Ma[e.protocol];if(A&&(e.hostname="",e.port=null,e.host&&(v[0]===""?v[0]=e.host:v.unshift(e.host)),e.host="",r.protocol&&(r.hostname=null,r.port=null,r.host&&(O[0]===""?O[0]=r.host:O.unshift(r.host)),r.host=null),p=p&&(O[0]===""||v[0]==="")),m)e.host=r.host||r.host===""?r.host:e.host,e.hostname=r.hostname||r.hostname===""?r.hostname:e.hostname,e.search=r.search,e.query=r.query,v=O;else if(O.length)v||(v=[]),v.pop(),v=v.concat(O),e.search=r.search,e.query=r.query;else if(r.search!=null){if(A){e.host=v.shift(),e.hostname=e.host;var y=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;y&&(e.auth=y.shift(),e.hostname=y.shift(),e.host=e.hostname)}return e.search=r.search,e.query=r.query,(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.href=e.format(),e}if(!v.length)return e.pathname=null,e.search?e.path="/"+e.search:e.path=null,e.href=e.format(),e;for(var M=v.slice(-1)[0],N=(e.host||r.host||v.length>1)&&(M==="."||M==="..")||M==="",P=0,b=v.length;b>=0;b--)M=v[b],M==="."?v.splice(b,1):M===".."?(v.splice(b,1),P++):P&&(v.splice(b,1),P--);if(!p&&!T)for(;P--;P)v.unshift("..");p&&v[0]!==""&&(!v[0]||v[0].charAt(0)!=="/")&&v.unshift(""),N&&v.join("/").substr(-1)!=="/"&&v.push("");var D=v[0]===""||v[0]&&v[0].charAt(0)==="/";if(A){e.hostname=D?"":v.length?v.shift():"",e.host=e.hostname;var y=e.host&&e.host.indexOf("@")>0?e.host.split("@"):!1;y&&(e.auth=y.shift(),e.hostname=y.shift(),e.host=e.hostname)}return p=p||e.host&&v.length,p&&!D&&v.unshift(""),v.length>0?e.pathname=v.join("/"):(e.pathname=null,e.path=null),(e.pathname!==null||e.search!==null)&&(e.path=(e.pathname?e.pathname:"")+(e.search?e.search:"")),e.auth=r.auth||e.auth,e.slashes=e.slashes||r.slashes,e.href=e.format(),e};Ws.prototype.parseHost=function(){var r=this.host,t=hN.exec(r);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),r=r.substr(0,r.length-t.length)),r&&(this.hostname=r)};var pN=Jl,mN=EN,IN=gN;/*!
 * @pixi/utils - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Oo={parse:pN,format:IN,resolve:mN};Z.RETINA_PREFIX=/@([0-9\.]+)x/;Z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!1;var Np=!1,bp="6.5.10";function TN(r){var t;if(!Np){if(Z.ADAPTER.getNavigator().userAgent.toLowerCase().indexOf("chrome")>-1){var e=[`
 %c %c %c PixiJS `+bp+" - ✰ "+r+` ✰  %c  %c  http://www.pixijs.com/  %c %c ♥%c♥%c♥ 

`,"background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=globalThis.console).log.apply(t,e)}else globalThis.console&&globalThis.console.log("PixiJS "+bp+" - "+r+" - http://www.pixijs.com/");Np=!0}}var hc;function RN(){return typeof hc>"u"&&(hc=function(){var t={stencil:!0,failIfMajorPerformanceCaveat:Z.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!Z.ADAPTER.getWebGLRenderingContext())return!1;var e=Z.ADAPTER.createCanvas(),s=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),i=!!(s&&s.getContextAttributes().stencil);if(s){var n=s.getExtension("WEBGL_lose_context");n&&n.loseContext()}return s=null,i}catch{return!1}}()),hc}var ON="#f0f8ff",vN="#faebd7",AN="#00ffff",SN="#7fffd4",yN="#f0ffff",MN="#f5f5dc",CN="#ffe4c4",NN="#000000",bN="#ffebcd",PN="#0000ff",DN="#8a2be2",LN="#a52a2a",UN="#deb887",xN="#5f9ea0",FN="#7fff00",wN="#d2691e",GN="#ff7f50",BN="#6495ed",HN="#fff8dc",VN="#dc143c",kN="#00ffff",jN="#00008b",zN="#008b8b",YN="#b8860b",WN="#a9a9a9",XN="#006400",KN="#a9a9a9",qN="#bdb76b",QN="#8b008b",ZN="#556b2f",JN="#ff8c00",$N="#9932cc",tb="#8b0000",eb="#e9967a",sb="#8fbc8f",rb="#483d8b",ib="#2f4f4f",nb="#2f4f4f",ab="#00ced1",ob="#9400d3",hb="#ff1493",ub="#00bfff",lb="#696969",_b="#696969",cb="#1e90ff",db="#b22222",fb="#fffaf0",gb="#228b22",Eb="#ff00ff",pb="#dcdcdc",mb="#f8f8ff",Ib="#daa520",Tb="#ffd700",Rb="#808080",Ob="#008000",vb="#adff2f",Ab="#808080",Sb="#f0fff0",yb="#ff69b4",Mb="#cd5c5c",Cb="#4b0082",Nb="#fffff0",bb="#f0e68c",Pb="#fff0f5",Db="#e6e6fa",Lb="#7cfc00",Ub="#fffacd",xb="#add8e6",Fb="#f08080",wb="#e0ffff",Gb="#fafad2",Bb="#d3d3d3",Hb="#90ee90",Vb="#d3d3d3",kb="#ffb6c1",jb="#ffa07a",zb="#20b2aa",Yb="#87cefa",Wb="#778899",Xb="#778899",Kb="#b0c4de",qb="#ffffe0",Qb="#00ff00",Zb="#32cd32",Jb="#faf0e6",$b="#ff00ff",tP="#800000",eP="#66cdaa",sP="#0000cd",rP="#ba55d3",iP="#9370db",nP="#3cb371",aP="#7b68ee",oP="#00fa9a",hP="#48d1cc",uP="#c71585",lP="#191970",_P="#f5fffa",cP="#ffe4e1",dP="#ffe4b5",fP="#ffdead",gP="#000080",EP="#fdf5e6",pP="#808000",mP="#6b8e23",IP="#ffa500",TP="#ff4500",RP="#da70d6",OP="#eee8aa",vP="#98fb98",AP="#afeeee",SP="#db7093",yP="#ffefd5",MP="#ffdab9",CP="#cd853f",NP="#ffc0cb",bP="#dda0dd",PP="#b0e0e6",DP="#800080",LP="#663399",UP="#ff0000",xP="#bc8f8f",FP="#4169e1",wP="#8b4513",GP="#fa8072",BP="#f4a460",HP="#2e8b57",VP="#fff5ee",kP="#a0522d",jP="#c0c0c0",zP="#87ceeb",YP="#6a5acd",WP="#708090",XP="#708090",KP="#fffafa",qP="#00ff7f",QP="#4682b4",ZP="#d2b48c",JP="#008080",$P="#d8bfd8",tD="#ff6347",eD="#40e0d0",sD="#ee82ee",rD="#f5deb3",iD="#ffffff",nD="#f5f5f5",aD="#ffff00",oD="#9acd32",hD={aliceblue:ON,antiquewhite:vN,aqua:AN,aquamarine:SN,azure:yN,beige:MN,bisque:CN,black:NN,blanchedalmond:bN,blue:PN,blueviolet:DN,brown:LN,burlywood:UN,cadetblue:xN,chartreuse:FN,chocolate:wN,coral:GN,cornflowerblue:BN,cornsilk:HN,crimson:VN,cyan:kN,darkblue:jN,darkcyan:zN,darkgoldenrod:YN,darkgray:WN,darkgreen:XN,darkgrey:KN,darkkhaki:qN,darkmagenta:QN,darkolivegreen:ZN,darkorange:JN,darkorchid:$N,darkred:tb,darksalmon:eb,darkseagreen:sb,darkslateblue:rb,darkslategray:ib,darkslategrey:nb,darkturquoise:ab,darkviolet:ob,deeppink:hb,deepskyblue:ub,dimgray:lb,dimgrey:_b,dodgerblue:cb,firebrick:db,floralwhite:fb,forestgreen:gb,fuchsia:Eb,gainsboro:pb,ghostwhite:mb,goldenrod:Ib,gold:Tb,gray:Rb,green:Ob,greenyellow:vb,grey:Ab,honeydew:Sb,hotpink:yb,indianred:Mb,indigo:Cb,ivory:Nb,khaki:bb,lavenderblush:Pb,lavender:Db,lawngreen:Lb,lemonchiffon:Ub,lightblue:xb,lightcoral:Fb,lightcyan:wb,lightgoldenrodyellow:Gb,lightgray:Bb,lightgreen:Hb,lightgrey:Vb,lightpink:kb,lightsalmon:jb,lightseagreen:zb,lightskyblue:Yb,lightslategray:Wb,lightslategrey:Xb,lightsteelblue:Kb,lightyellow:qb,lime:Qb,limegreen:Zb,linen:Jb,magenta:$b,maroon:tP,mediumaquamarine:eP,mediumblue:sP,mediumorchid:rP,mediumpurple:iP,mediumseagreen:nP,mediumslateblue:aP,mediumspringgreen:oP,mediumturquoise:hP,mediumvioletred:uP,midnightblue:lP,mintcream:_P,mistyrose:cP,moccasin:dP,navajowhite:fP,navy:gP,oldlace:EP,olive:pP,olivedrab:mP,orange:IP,orangered:TP,orchid:RP,palegoldenrod:OP,palegreen:vP,paleturquoise:AP,palevioletred:SP,papayawhip:yP,peachpuff:MP,peru:CP,pink:NP,plum:bP,powderblue:PP,purple:DP,rebeccapurple:LP,red:UP,rosybrown:xP,royalblue:FP,saddlebrown:wP,salmon:GP,sandybrown:BP,seagreen:HP,seashell:VP,sienna:kP,silver:jP,skyblue:zP,slateblue:YP,slategray:WP,slategrey:XP,snow:KP,springgreen:qP,steelblue:QP,tan:ZP,teal:JP,thistle:$P,tomato:tD,turquoise:eD,violet:sD,wheat:rD,white:iD,whitesmoke:nD,yellow:aD,yellowgreen:oD};function pl(r,t){return t===void 0&&(t=[]),t[0]=(r>>16&255)/255,t[1]=(r>>8&255)/255,t[2]=(r&255)/255,t}function JI(r){var t=r.toString(16);return t="000000".substring(0,6-t.length)+t,"#"+t}function uD(r){return typeof r=="string"&&(r=hD[r.toLowerCase()]||r,r[0]==="#"&&(r=r.slice(1))),parseInt(r,16)}function lD(){for(var r=[],t=[],e=0;e<32;e++)r[e]=e,t[e]=e;r[tt.NORMAL_NPM]=tt.NORMAL,r[tt.ADD_NPM]=tt.ADD,r[tt.SCREEN_NPM]=tt.SCREEN,t[tt.NORMAL]=tt.NORMAL_NPM,t[tt.ADD]=tt.ADD_NPM,t[tt.SCREEN]=tt.SCREEN_NPM;var s=[];return s.push(t),s.push(r),s}var $I=lD();function _D(r,t){return $I[t?1:0][r]}function tT(r,t){if(t===1)return(t*255<<24)+r;if(t===0)return 0;var e=r>>16&255,s=r>>8&255,i=r&255;return e=e*t+.5|0,s=s*t+.5|0,i=i*t+.5|0,(t*255<<24)+(e<<16)+(s<<8)+i}function cD(r,t,e,s){return e=e||new Float32Array(4),e[0]=(r>>16&255)/255,e[1]=(r>>8&255)/255,e[2]=(r&255)/255,(s||s===void 0)&&(e[0]*=t,e[1]*=t,e[2]*=t),e[3]=t,e}function dD(r,t){t===void 0&&(t=null);var e=r*6;if(t=t||new Uint16Array(e),t.length!==e)throw new Error("Out buffer length is incorrect, got "+t.length+" and expected "+e);for(var s=0,i=0;s<e;s+=6,i+=4)t[s+0]=i+0,t[s+1]=i+1,t[s+2]=i+2,t[s+3]=i+0,t[s+4]=i+2,t[s+5]=i+3;return t}function eT(r){if(r.BYTES_PER_ELEMENT===4)return r instanceof Float32Array?"Float32Array":r instanceof Uint32Array?"Uint32Array":"Int32Array";if(r.BYTES_PER_ELEMENT===2){if(r instanceof Uint16Array)return"Uint16Array"}else if(r.BYTES_PER_ELEMENT===1&&r instanceof Uint8Array)return"Uint8Array";return null}function ml(r){return r+=r===0?1:0,--r,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r+1}function Pp(r){return!(r&r-1)&&!!r}function Dp(r){var t=(r>65535?1:0)<<4;r>>>=t;var e=(r>255?1:0)<<3;return r>>>=e,t|=e,e=(r>15?1:0)<<2,r>>>=e,t|=e,e=(r>3?1:0)<<1,r>>>=e,t|=e,t|r>>1}function Hu(r,t,e){var s=r.length,i;if(!(t>=s||e===0)){e=t+e>s?s-t:e;var n=s-e;for(i=t;i<n;++i)r[i]=r[i+e];r.length=n}}function Ea(r){return r===0?0:r<0?-1:1}var fD=0;function Dn(){return++fD}var Lp={};function Er(r,t,e){if(e===void 0&&(e=3),!Lp[t]){var s=new Error().stack;typeof s>"u"?console.warn("PixiJS Deprecation Warning: ",t+`
Deprecated since v`+r):(s=s.split(`
`).splice(e).join(`
`),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+`
Deprecated since v`+r),console.warn(s),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+`
Deprecated since v`+r),console.warn(s))),Lp[t]=!0}}var Up={},Cr=Object.create(null),qi=Object.create(null),xp=function(){function r(t,e,s){this.canvas=Z.ADAPTER.createCanvas(),this.context=this.canvas.getContext("2d"),this.resolution=s||Z.RESOLUTION,this.resize(t,e)}return r.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},r.prototype.resize=function(t,e){this.canvas.width=Math.round(t*this.resolution),this.canvas.height=Math.round(e*this.resolution)},r.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(r.prototype,"width",{get:function(){return this.canvas.width},set:function(t){this.canvas.width=Math.round(t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.canvas.height},set:function(t){this.canvas.height=Math.round(t)},enumerable:!1,configurable:!0}),r}();function gD(r){var t=r.width,e=r.height,s=r.getContext("2d",{willReadFrequently:!0}),i=s.getImageData(0,0,t,e),n=i.data,a=n.length,o={top:null,left:null,right:null,bottom:null},h=null,u,c,l;for(u=0;u<a;u+=4)n[u+3]!==0&&(c=u/4%t,l=~~(u/4/t),o.top===null&&(o.top=l),(o.left===null||c<o.left)&&(o.left=c),(o.right===null||o.right<c)&&(o.right=c+1),(o.bottom===null||o.bottom<l)&&(o.bottom=l));return o.top!==null&&(t=o.right-o.left,e=o.bottom-o.top+1,h=s.getImageData(o.left,o.top,t,e)),{height:e,width:t,data:h}}var du;function ED(r,t){if(t===void 0&&(t=globalThis.location),r.indexOf("data:")===0)return"";t=t||globalThis.location,du||(du=document.createElement("a")),du.href=r;var e=Oo.parse(du.href),s=!e.port&&t.port===""||e.port===t.port;return e.hostname!==t.hostname||!s||e.protocol!==t.protocol?"anonymous":""}function Id(r,t){var e=Z.RETINA_PREFIX.exec(r);return e?parseFloat(e[1]):t!==void 0?t:1}/*!
 * @pixi/extensions - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extensions is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Yo=function(){return Yo=Object.assign||function(t){for(var e=arguments,s,i=1,n=arguments.length;i<n;i++){s=e[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},Yo.apply(this,arguments)},Re;(function(r){r.Application="application",r.RendererPlugin="renderer-webgl-plugin",r.CanvasRendererPlugin="renderer-canvas-plugin",r.Loader="loader",r.LoadParser="load-parser",r.ResolveParser="resolve-parser",r.CacheParser="cache-parser",r.DetectionParser="detection-parser"})(Re||(Re={}));var Fp=function(r){if(typeof r=="function"||typeof r=="object"&&r.extension){if(!r.extension)throw new Error("Extension class must have an extension object");var t=typeof r.extension!="object"?{type:r.extension}:r.extension;r=Yo(Yo({},t),{ref:r})}if(typeof r=="object")r=Yo({},r);else throw new Error("Invalid extension type");return typeof r.type=="string"&&(r.type=[r.type]),r},hi={_addHandlers:null,_removeHandlers:null,_queue:{},remove:function(){for(var r=arguments,t=this,e=[],s=0;s<arguments.length;s++)e[s]=r[s];return e.map(Fp).forEach(function(i){i.type.forEach(function(n){var a,o;return(o=(a=t._removeHandlers)[n])===null||o===void 0?void 0:o.call(a,i)})}),this},add:function(){for(var r=arguments,t=this,e=[],s=0;s<arguments.length;s++)e[s]=r[s];return e.map(Fp).forEach(function(i){i.type.forEach(function(n){var a=t._addHandlers,o=t._queue;a[n]?a[n](i):(o[n]=o[n]||[],o[n].push(i))})}),this},handle:function(r,t,e){var s=this._addHandlers=this._addHandlers||{},i=this._removeHandlers=this._removeHandlers||{};if(s[r]||i[r])throw new Error("Extension type "+r+" already has a handler");s[r]=t,i[r]=e;var n=this._queue;return n[r]&&(n[r].forEach(function(a){return t(a)}),delete n[r]),this},handleByMap:function(r,t){return this.handle(r,function(e){t[e.name]=e.ref},function(e){delete t[e.name]})},handleByList:function(r,t){return this.handle(r,function(e){var s,i;t.includes(e.ref)||(t.push(e.ref),r===Re.Loader&&((i=(s=e.ref).add)===null||i===void 0||i.call(s)))},function(e){var s=t.indexOf(e.ref);s!==-1&&t.splice(s,1)})}};/*!
 * @pixi/runner - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/runner is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var je=function(){function r(t){this.items=[],this._name=t,this._aliasCount=0}return r.prototype.emit=function(t,e,s,i,n,a,o,h){if(arguments.length>8)throw new Error("max arguments reached");var u=this,c=u.name,l=u.items;this._aliasCount++;for(var _=0,d=l.length;_<d;_++)l[_][c](t,e,s,i,n,a,o,h);return l===this.items&&this._aliasCount--,this},r.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},r.prototype.add=function(t){return t[this._name]&&(this.ensureNonAliasedItems(),this.remove(t),this.items.push(t)),this},r.prototype.remove=function(t){var e=this.items.indexOf(t);return e!==-1&&(this.ensureNonAliasedItems(),this.items.splice(e,1)),this},r.prototype.contains=function(t){return this.items.indexOf(t)!==-1},r.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},r.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(r.prototype,"empty",{get:function(){return this.items.length===0},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),r}();Object.defineProperties(je.prototype,{dispatch:{value:je.prototype.emit},run:{value:je.prototype.emit}});/*!
 * @pixi/ticker - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Z.TARGET_FPMS=.06;var Fa;(function(r){r[r.INTERACTION=50]="INTERACTION",r[r.HIGH=25]="HIGH",r[r.NORMAL=0]="NORMAL",r[r.LOW=-25]="LOW",r[r.UTILITY=-50]="UTILITY"})(Fa||(Fa={}));var uc=function(){function r(t,e,s,i){e===void 0&&(e=null),s===void 0&&(s=0),i===void 0&&(i=!1),this.next=null,this.previous=null,this._destroyed=!1,this.fn=t,this.context=e,this.priority=s,this.once=i}return r.prototype.match=function(t,e){return e===void 0&&(e=null),this.fn===t&&this.context===e},r.prototype.emit=function(t){this.fn&&(this.context?this.fn.call(this.context,t):this.fn(t));var e=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),e},r.prototype.connect=function(t){this.previous=t,t.next&&(t.next.previous=this),this.next=t.next,t.next=this},r.prototype.destroy=function(t){t===void 0&&(t=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var e=this.next;return this.next=t?null:e,this.previous=null,e},r}(),hr=function(){function r(){var t=this;this.autoStart=!1,this.deltaTime=1,this.lastTime=-1,this.speed=1,this.started=!1,this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this._protected=!1,this._lastFrame=-1,this._head=new uc(null,null,1/0),this.deltaMS=1/Z.TARGET_FPMS,this.elapsedMS=1/Z.TARGET_FPMS,this._tick=function(e){t._requestId=null,t.started&&(t.update(e),t.started&&t._requestId===null&&t._head.next&&(t._requestId=requestAnimationFrame(t._tick)))}}return r.prototype._requestIfNeeded=function(){this._requestId===null&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},r.prototype._cancelIfNeeded=function(){this._requestId!==null&&(cancelAnimationFrame(this._requestId),this._requestId=null)},r.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},r.prototype.add=function(t,e,s){return s===void 0&&(s=Fa.NORMAL),this._addListener(new uc(t,e,s))},r.prototype.addOnce=function(t,e,s){return s===void 0&&(s=Fa.NORMAL),this._addListener(new uc(t,e,s,!0))},r.prototype._addListener=function(t){var e=this._head.next,s=this._head;if(!e)t.connect(s);else{for(;e;){if(t.priority>e.priority){t.connect(s);break}s=e,e=e.next}t.previous||t.connect(s)}return this._startIfPossible(),this},r.prototype.remove=function(t,e){for(var s=this._head.next;s;)s.match(t,e)?s=s.destroy():s=s.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(r.prototype,"count",{get:function(){if(!this._head)return 0;for(var t=0,e=this._head;e=e.next;)t++;return t},enumerable:!1,configurable:!0}),r.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},r.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},r.prototype.destroy=function(){if(!this._protected){this.stop();for(var t=this._head.next;t;)t=t.destroy(!0);this._head.destroy(),this._head=null}},r.prototype.update=function(t){t===void 0&&(t=performance.now());var e;if(t>this.lastTime){if(e=this.elapsedMS=t-this.lastTime,e>this._maxElapsedMS&&(e=this._maxElapsedMS),e*=this.speed,this._minElapsedMS){var s=t-this._lastFrame|0;if(s<this._minElapsedMS)return;this._lastFrame=t-s%this._minElapsedMS}this.deltaMS=e,this.deltaTime=this.deltaMS*Z.TARGET_FPMS;for(var i=this._head,n=i.next;n;)n=n.emit(this.deltaTime);i.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=t},Object.defineProperty(r.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(t){var e=Math.min(this.maxFPS,t),s=Math.min(Math.max(0,e)/1e3,Z.TARGET_FPMS);this._maxElapsedMS=1/s},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(t){if(t===0)this._minElapsedMS=0;else{var e=Math.max(this.minFPS,t);this._minElapsedMS=1/(e/1e3)}},enumerable:!1,configurable:!0}),Object.defineProperty(r,"shared",{get:function(){if(!r._shared){var t=r._shared=new r;t.autoStart=!0,t._protected=!0}return r._shared},enumerable:!1,configurable:!0}),Object.defineProperty(r,"system",{get:function(){if(!r._system){var t=r._system=new r;t.autoStart=!0,t._protected=!0}return r._system},enumerable:!1,configurable:!0}),r}(),pD=function(){function r(){}return r.init=function(t){var e=this;t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{set:function(s){this._ticker&&this._ticker.remove(this.render,this),this._ticker=s,s&&s.add(this.render,this,Fa.LOW)},get:function(){return this._ticker}}),this.stop=function(){e._ticker.stop()},this.start=function(){e._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?hr.shared:new hr,t.autoStart&&this.start()},r.destroy=function(){if(this._ticker){var t=this._ticker;this.ticker=null,t.destroy()}},r.extension=Re.Application,r}();/*!
 * @pixi/math - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var sh=Math.PI*2,mD=180/Math.PI,ID=Math.PI/180,Fe;(function(r){r[r.POLY=0]="POLY",r[r.RECT=1]="RECT",r[r.CIRC=2]="CIRC",r[r.ELIP=3]="ELIP",r[r.RREC=4]="RREC"})(Fe||(Fe={}));var B=function(){function r(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this.x=0,this.y=0,this.x=t,this.y=e}return r.prototype.clone=function(){return new r(this.x,this.y)},r.prototype.copyFrom=function(t){return this.set(t.x,t.y),this},r.prototype.copyTo=function(t){return t.set(this.x,this.y),t},r.prototype.equals=function(t){return t.x===this.x&&t.y===this.y},r.prototype.set=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x=t,this.y=e,this},r.prototype.toString=function(){return"[@pixi/math:Point x="+this.x+" y="+this.y+"]"},r}(),fu=[new B,new B,new B,new B],it=function(){function r(t,e,s,i){t===void 0&&(t=0),e===void 0&&(e=0),s===void 0&&(s=0),i===void 0&&(i=0),this.x=Number(t),this.y=Number(e),this.width=Number(s),this.height=Number(i),this.type=Fe.RECT}return Object.defineProperty(r.prototype,"left",{get:function(){return this.x},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"top",{get:function(){return this.y},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),Object.defineProperty(r,"EMPTY",{get:function(){return new r(0,0,0,0)},enumerable:!1,configurable:!0}),r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.copyFrom=function(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this},r.prototype.copyTo=function(t){return t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t},r.prototype.contains=function(t,e){return this.width<=0||this.height<=0?!1:t>=this.x&&t<this.x+this.width&&e>=this.y&&e<this.y+this.height},r.prototype.intersects=function(t,e){if(!e){var s=this.x<t.x?t.x:this.x,i=this.right>t.right?t.right:this.right;if(i<=s)return!1;var n=this.y<t.y?t.y:this.y,a=this.bottom>t.bottom?t.bottom:this.bottom;return a>n}var o=this.left,h=this.right,u=this.top,c=this.bottom;if(h<=o||c<=u)return!1;var l=fu[0].set(t.left,t.top),_=fu[1].set(t.left,t.bottom),d=fu[2].set(t.right,t.top),f=fu[3].set(t.right,t.bottom);if(d.x<=l.x||_.y<=l.y)return!1;var m=Math.sign(e.a*e.d-e.b*e.c);if(m===0||(e.apply(l,l),e.apply(_,_),e.apply(d,d),e.apply(f,f),Math.max(l.x,_.x,d.x,f.x)<=o||Math.min(l.x,_.x,d.x,f.x)>=h||Math.max(l.y,_.y,d.y,f.y)<=u||Math.min(l.y,_.y,d.y,f.y)>=c))return!1;var p=m*(_.y-l.y),T=m*(l.x-_.x),v=p*o+T*u,O=p*h+T*u,A=p*o+T*c,y=p*h+T*c;if(Math.max(v,O,A,y)<=p*l.x+T*l.y||Math.min(v,O,A,y)>=p*f.x+T*f.y)return!1;var M=m*(l.y-d.y),N=m*(d.x-l.x),P=M*o+N*u,b=M*h+N*u,D=M*o+N*c,x=M*h+N*c;return!(Math.max(P,b,D,x)<=M*l.x+N*l.y||Math.min(P,b,D,x)>=M*f.x+N*f.y)},r.prototype.pad=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),this.x-=t,this.y-=e,this.width+=t*2,this.height+=e*2,this},r.prototype.fit=function(t){var e=Math.max(this.x,t.x),s=Math.min(this.x+this.width,t.x+t.width),i=Math.max(this.y,t.y),n=Math.min(this.y+this.height,t.y+t.height);return this.x=e,this.width=Math.max(s-e,0),this.y=i,this.height=Math.max(n-i,0),this},r.prototype.ceil=function(t,e){t===void 0&&(t=1),e===void 0&&(e=.001);var s=Math.ceil((this.x+this.width-e)*t)/t,i=Math.ceil((this.y+this.height-e)*t)/t;return this.x=Math.floor((this.x+e)*t)/t,this.y=Math.floor((this.y+e)*t)/t,this.width=s-this.x,this.height=i-this.y,this},r.prototype.enlarge=function(t){var e=Math.min(this.x,t.x),s=Math.max(this.x+this.width,t.x+t.width),i=Math.min(this.y,t.y),n=Math.max(this.y+this.height,t.y+t.height);return this.x=e,this.width=s-e,this.y=i,this.height=n-i,this},r.prototype.toString=function(){return"[@pixi/math:Rectangle x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},r}(),TD=function(){function r(t,e,s){t===void 0&&(t=0),e===void 0&&(e=0),s===void 0&&(s=0),this.x=t,this.y=e,this.radius=s,this.type=Fe.CIRC}return r.prototype.clone=function(){return new r(this.x,this.y,this.radius)},r.prototype.contains=function(t,e){if(this.radius<=0)return!1;var s=this.radius*this.radius,i=this.x-t,n=this.y-e;return i*=i,n*=n,i+n<=s},r.prototype.getBounds=function(){return new it(this.x-this.radius,this.y-this.radius,this.radius*2,this.radius*2)},r.prototype.toString=function(){return"[@pixi/math:Circle x="+this.x+" y="+this.y+" radius="+this.radius+"]"},r}(),RD=function(){function r(t,e,s,i){t===void 0&&(t=0),e===void 0&&(e=0),s===void 0&&(s=0),i===void 0&&(i=0),this.x=t,this.y=e,this.width=s,this.height=i,this.type=Fe.ELIP}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height)},r.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;var s=(t-this.x)/this.width,i=(e-this.y)/this.height;return s*=s,i*=i,s+i<=1},r.prototype.getBounds=function(){return new it(this.x-this.width,this.y-this.height,this.width,this.height)},r.prototype.toString=function(){return"[@pixi/math:Ellipse x="+this.x+" y="+this.y+" width="+this.width+" height="+this.height+"]"},r}(),Vu=function(){function r(){for(var t=arguments,e=[],s=0;s<arguments.length;s++)e[s]=t[s];var i=Array.isArray(e[0])?e[0]:e;if(typeof i[0]!="number"){for(var n=[],a=0,o=i.length;a<o;a++)n.push(i[a].x,i[a].y);i=n}this.points=i,this.type=Fe.POLY,this.closeStroke=!0}return r.prototype.clone=function(){var t=this.points.slice(),e=new r(t);return e.closeStroke=this.closeStroke,e},r.prototype.contains=function(t,e){for(var s=!1,i=this.points.length/2,n=0,a=i-1;n<i;a=n++){var o=this.points[n*2],h=this.points[n*2+1],u=this.points[a*2],c=this.points[a*2+1],l=h>e!=c>e&&t<(u-o)*((e-h)/(c-h))+o;l&&(s=!s)}return s},r.prototype.toString=function(){return"[@pixi/math:Polygon"+("closeStroke="+this.closeStroke)+("points="+this.points.reduce(function(t,e){return t+", "+e},"")+"]")},r}(),OD=function(){function r(t,e,s,i,n){t===void 0&&(t=0),e===void 0&&(e=0),s===void 0&&(s=0),i===void 0&&(i=0),n===void 0&&(n=20),this.x=t,this.y=e,this.width=s,this.height=i,this.radius=n,this.type=Fe.RREC}return r.prototype.clone=function(){return new r(this.x,this.y,this.width,this.height,this.radius)},r.prototype.contains=function(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){var s=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+s&&e<=this.y+this.height-s||t>=this.x+s&&t<=this.x+this.width-s)return!0;var i=t-(this.x+s),n=e-(this.y+s),a=s*s;if(i*i+n*n<=a||(i=t-(this.x+this.width-s),i*i+n*n<=a)||(n=e-(this.y+this.height-s),i*i+n*n<=a)||(i=t-(this.x+s),i*i+n*n<=a))return!0}return!1},r.prototype.toString=function(){return"[@pixi/math:RoundedRectangle x="+this.x+" y="+this.y+("width="+this.width+" height="+this.height+" radius="+this.radius+"]")},r}(),pa=function(){function r(t,e,s,i){s===void 0&&(s=0),i===void 0&&(i=0),this._x=s,this._y=i,this.cb=t,this.scope=e}return r.prototype.clone=function(t,e){return t===void 0&&(t=this.cb),e===void 0&&(e=this.scope),new r(t,e,this._x,this._y)},r.prototype.set=function(t,e){return t===void 0&&(t=0),e===void 0&&(e=t),(this._x!==t||this._y!==e)&&(this._x=t,this._y=e,this.cb.call(this.scope)),this},r.prototype.copyFrom=function(t){return(this._x!==t.x||this._y!==t.y)&&(this._x=t.x,this._y=t.y,this.cb.call(this.scope)),this},r.prototype.copyTo=function(t){return t.set(this._x,this._y),t},r.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},r.prototype.toString=function(){return"[@pixi/math:ObservablePoint x=0 y=0 scope="+this.scope+"]"},Object.defineProperty(r.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.cb.call(this.scope))},enumerable:!1,configurable:!0}),r}(),Vt=function(){function r(t,e,s,i,n,a){t===void 0&&(t=1),e===void 0&&(e=0),s===void 0&&(s=0),i===void 0&&(i=1),n===void 0&&(n=0),a===void 0&&(a=0),this.array=null,this.a=t,this.b=e,this.c=s,this.d=i,this.tx=n,this.ty=a}return r.prototype.fromArray=function(t){this.a=t[0],this.b=t[1],this.c=t[3],this.d=t[4],this.tx=t[2],this.ty=t[5]},r.prototype.set=function(t,e,s,i,n,a){return this.a=t,this.b=e,this.c=s,this.d=i,this.tx=n,this.ty=a,this},r.prototype.toArray=function(t,e){this.array||(this.array=new Float32Array(9));var s=e||this.array;return t?(s[0]=this.a,s[1]=this.b,s[2]=0,s[3]=this.c,s[4]=this.d,s[5]=0,s[6]=this.tx,s[7]=this.ty,s[8]=1):(s[0]=this.a,s[1]=this.c,s[2]=this.tx,s[3]=this.b,s[4]=this.d,s[5]=this.ty,s[6]=0,s[7]=0,s[8]=1),s},r.prototype.apply=function(t,e){e=e||new B;var s=t.x,i=t.y;return e.x=this.a*s+this.c*i+this.tx,e.y=this.b*s+this.d*i+this.ty,e},r.prototype.applyInverse=function(t,e){e=e||new B;var s=1/(this.a*this.d+this.c*-this.b),i=t.x,n=t.y;return e.x=this.d*s*i+-this.c*s*n+(this.ty*this.c-this.tx*this.d)*s,e.y=this.a*s*n+-this.b*s*i+(-this.ty*this.a+this.tx*this.b)*s,e},r.prototype.translate=function(t,e){return this.tx+=t,this.ty+=e,this},r.prototype.scale=function(t,e){return this.a*=t,this.d*=e,this.c*=t,this.b*=e,this.tx*=t,this.ty*=e,this},r.prototype.rotate=function(t){var e=Math.cos(t),s=Math.sin(t),i=this.a,n=this.c,a=this.tx;return this.a=i*e-this.b*s,this.b=i*s+this.b*e,this.c=n*e-this.d*s,this.d=n*s+this.d*e,this.tx=a*e-this.ty*s,this.ty=a*s+this.ty*e,this},r.prototype.append=function(t){var e=this.a,s=this.b,i=this.c,n=this.d;return this.a=t.a*e+t.b*i,this.b=t.a*s+t.b*n,this.c=t.c*e+t.d*i,this.d=t.c*s+t.d*n,this.tx=t.tx*e+t.ty*i+this.tx,this.ty=t.tx*s+t.ty*n+this.ty,this},r.prototype.setTransform=function(t,e,s,i,n,a,o,h,u){return this.a=Math.cos(o+u)*n,this.b=Math.sin(o+u)*n,this.c=-Math.sin(o-h)*a,this.d=Math.cos(o-h)*a,this.tx=t-(s*this.a+i*this.c),this.ty=e-(s*this.b+i*this.d),this},r.prototype.prepend=function(t){var e=this.tx;if(t.a!==1||t.b!==0||t.c!==0||t.d!==1){var s=this.a,i=this.c;this.a=s*t.a+this.b*t.c,this.b=s*t.b+this.b*t.d,this.c=i*t.a+this.d*t.c,this.d=i*t.b+this.d*t.d}return this.tx=e*t.a+this.ty*t.c+t.tx,this.ty=e*t.b+this.ty*t.d+t.ty,this},r.prototype.decompose=function(t){var e=this.a,s=this.b,i=this.c,n=this.d,a=t.pivot,o=-Math.atan2(-i,n),h=Math.atan2(s,e),u=Math.abs(o+h);return u<1e-5||Math.abs(sh-u)<1e-5?(t.rotation=h,t.skew.x=t.skew.y=0):(t.rotation=0,t.skew.x=o,t.skew.y=h),t.scale.x=Math.sqrt(e*e+s*s),t.scale.y=Math.sqrt(i*i+n*n),t.position.x=this.tx+(a.x*e+a.y*i),t.position.y=this.ty+(a.x*s+a.y*n),t},r.prototype.invert=function(){var t=this.a,e=this.b,s=this.c,i=this.d,n=this.tx,a=t*i-e*s;return this.a=i/a,this.b=-e/a,this.c=-s/a,this.d=t/a,this.tx=(s*this.ty-i*n)/a,this.ty=-(t*this.ty-e*n)/a,this},r.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},r.prototype.clone=function(){var t=new r;return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r.prototype.copyTo=function(t){return t.a=this.a,t.b=this.b,t.c=this.c,t.d=this.d,t.tx=this.tx,t.ty=this.ty,t},r.prototype.copyFrom=function(t){return this.a=t.a,this.b=t.b,this.c=t.c,this.d=t.d,this.tx=t.tx,this.ty=t.ty,this},r.prototype.toString=function(){return"[@pixi/math:Matrix a="+this.a+" b="+this.b+" c="+this.c+" d="+this.d+" tx="+this.tx+" ty="+this.ty+"]"},Object.defineProperty(r,"IDENTITY",{get:function(){return new r},enumerable:!1,configurable:!0}),Object.defineProperty(r,"TEMP_MATRIX",{get:function(){return new r},enumerable:!1,configurable:!0}),r}(),tn=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],en=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],sn=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],rn=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],Td=[],sT=[],gu=Math.sign;function vD(){for(var r=0;r<16;r++){var t=[];Td.push(t);for(var e=0;e<16;e++)for(var s=gu(tn[r]*tn[e]+sn[r]*en[e]),i=gu(en[r]*tn[e]+rn[r]*en[e]),n=gu(tn[r]*sn[e]+sn[r]*rn[e]),a=gu(en[r]*sn[e]+rn[r]*rn[e]),o=0;o<16;o++)if(tn[o]===s&&en[o]===i&&sn[o]===n&&rn[o]===a){t.push(o);break}}for(var r=0;r<16;r++){var h=new Vt;h.set(tn[r],en[r],sn[r],rn[r],0,0),sT.push(h)}}vD();var St={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(r){return tn[r]},uY:function(r){return en[r]},vX:function(r){return sn[r]},vY:function(r){return rn[r]},inv:function(r){return r&8?r&15:-r&7},add:function(r,t){return Td[r][t]},sub:function(r,t){return Td[r][St.inv(t)]},rotate180:function(r){return r^4},isVertical:function(r){return(r&3)===2},byDirection:function(r,t){return Math.abs(r)*2<=Math.abs(t)?t>=0?St.S:St.N:Math.abs(t)*2<=Math.abs(r)?r>0?St.E:St.W:t>0?r>0?St.SE:St.SW:r>0?St.NE:St.NW},matrixAppendRotationInv:function(r,t,e,s){e===void 0&&(e=0),s===void 0&&(s=0);var i=sT[St.inv(t)];i.tx=e,i.ty=s,r.append(i)}},rT=function(){function r(){this.worldTransform=new Vt,this.localTransform=new Vt,this.position=new pa(this.onChange,this,0,0),this.scale=new pa(this.onChange,this,1,1),this.pivot=new pa(this.onChange,this,0,0),this.skew=new pa(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return r.prototype.onChange=function(){this._localID++},r.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},r.prototype.toString=function(){return"[@pixi/math:Transform "+("position=("+this.position.x+", "+this.position.y+") ")+("rotation="+this.rotation+" ")+("scale=("+this.scale.x+", "+this.scale.y+") ")+("skew=("+this.skew.x+", "+this.skew.y+") ")+"]"},r.prototype.updateLocalTransform=function(){var t=this.localTransform;this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1)},r.prototype.updateTransform=function(t){var e=this.localTransform;if(this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==t._worldID){var s=t.worldTransform,i=this.worldTransform;i.a=e.a*s.a+e.b*s.c,i.b=e.a*s.b+e.b*s.d,i.c=e.c*s.a+e.d*s.c,i.d=e.c*s.b+e.d*s.d,i.tx=e.tx*s.a+e.ty*s.c+s.tx,i.ty=e.tx*s.b+e.ty*s.d+s.ty,this._parentID=t._worldID,this._worldID++}},r.prototype.setFromMatrix=function(t){t.decompose(this),this._localID++},Object.defineProperty(r.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateSkew())},enumerable:!1,configurable:!0}),r.IDENTITY=new r,r}();/*!
 * @pixi/core - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Z.PREFER_ENV=En.any?ai.WEBGL:ai.WEBGL2;Z.STRICT_TEXTURE_CACHE=!1;var Rd=[];function iT(r,t){if(!r)return null;var e="";if(typeof r=="string"){var s=/\.(\w{3,4})(?:$|\?|#)/i.exec(r);s&&(e=s[1].toLowerCase())}for(var i=Rd.length-1;i>=0;--i){var n=Rd[i];if(n.test&&n.test(r,e))return new n(r,t)}throw new Error("Unrecognized source type to auto-detect Resource")}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Od=function(r,t){return Od=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},Od(r,t)};function $t(r,t){Od(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var vd=function(){return vd=Object.assign||function(t){for(var e=arguments,s,i=1,n=arguments.length;i<n;i++){s=e[i];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(t[a]=s[a])}return t},vd.apply(this,arguments)};function AD(r,t){var e={};for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&t.indexOf(s)<0&&(e[s]=r[s]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,s=Object.getOwnPropertySymbols(r);i<s.length;i++)t.indexOf(s[i])<0&&Object.prototype.propertyIsEnumerable.call(r,s[i])&&(e[s[i]]=r[s[i]]);return e}var rh=function(){function r(t,e){t===void 0&&(t=0),e===void 0&&(e=0),this._width=t,this._height=e,this.destroyed=!1,this.internal=!1,this.onResize=new je("setRealSize"),this.onUpdate=new je("update"),this.onError=new je("onError")}return r.prototype.bind=function(t){this.onResize.add(t),this.onUpdate.add(t),this.onError.add(t),(this._width||this._height)&&this.onResize.emit(this._width,this._height)},r.prototype.unbind=function(t){this.onResize.remove(t),this.onUpdate.remove(t),this.onError.remove(t)},r.prototype.resize=function(t,e){(t!==this._width||e!==this._height)&&(this._width=t,this._height=e,this.onResize.emit(t,e))},Object.defineProperty(r.prototype,"valid",{get:function(){return!!this._width&&!!this._height},enumerable:!1,configurable:!0}),r.prototype.update=function(){this.destroyed||this.onUpdate.emit()},r.prototype.load=function(){return Promise.resolve(this)},Object.defineProperty(r.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),r.prototype.style=function(t,e,s){return!1},r.prototype.dispose=function(){},r.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},r.test=function(t,e){return!1},r}(),Cg=function(r){$t(t,r);function t(e,s){var i=this,n=s||{},a=n.width,o=n.height;if(!a||!o)throw new Error("BufferResource width or height invalid");return i=r.call(this,a,o)||this,i.data=e,i}return t.prototype.upload=function(e,s,i){var n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Vi.UNPACK);var a=s.realWidth,o=s.realHeight;return i.width===a&&i.height===o?n.texSubImage2D(s.target,0,0,0,a,o,s.format,i.type,this.data):(i.width=a,i.height=o,n.texImage2D(s.target,0,i.internalFormat,a,o,0,s.format,i.type,this.data)),!0},t.prototype.dispose=function(){this.data=null},t.test=function(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},t}(rh),SD={scaleMode:_s.NEAREST,format:W.RGBA,alphaMode:Vi.NPM},Xt=function(r){$t(t,r);function t(e,s){e===void 0&&(e=null),s===void 0&&(s=null);var i=r.call(this)||this;s=s||{};var n=s.alphaMode,a=s.mipmap,o=s.anisotropicLevel,h=s.scaleMode,u=s.width,c=s.height,l=s.wrapMode,_=s.format,d=s.type,f=s.target,m=s.resolution,p=s.resourceOptions;return e&&!(e instanceof rh)&&(e=iT(e,p),e.internal=!0),i.resolution=m||Z.RESOLUTION,i.width=Math.round((u||0)*i.resolution)/i.resolution,i.height=Math.round((c||0)*i.resolution)/i.resolution,i._mipmap=a!==void 0?a:Z.MIPMAP_TEXTURES,i.anisotropicLevel=o!==void 0?o:Z.ANISOTROPIC_LEVEL,i._wrapMode=l||Z.WRAP_MODE,i._scaleMode=h!==void 0?h:Z.SCALE_MODE,i.format=_||W.RGBA,i.type=d||xt.UNSIGNED_BYTE,i.target=f||An.TEXTURE_2D,i.alphaMode=n!==void 0?n:Vi.UNPACK,i.uid=Dn(),i.touched=0,i.isPowerOfTwo=!1,i._refreshPOT(),i._glTextures={},i.dirtyId=0,i.dirtyStyleId=0,i.cacheId=null,i.valid=u>0&&c>0,i.textureCacheIds=[],i.destroyed=!1,i.resource=null,i._batchEnabled=0,i._batchLocation=0,i.parentTextureArray=null,i.setResource(e),i}return Object.defineProperty(t.prototype,"realWidth",{get:function(){return Math.round(this.width*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"realHeight",{get:function(){return Math.round(this.height*this.resolution)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mipmap",{get:function(){return this._mipmap},set:function(e){this._mipmap!==e&&(this._mipmap=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scaleMode",{get:function(){return this._scaleMode},set:function(e){this._scaleMode!==e&&(this._scaleMode=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wrapMode",{get:function(){return this._wrapMode},set:function(e){this._wrapMode!==e&&(this._wrapMode=e,this.dirtyStyleId++)},enumerable:!1,configurable:!0}),t.prototype.setStyle=function(e,s){var i;return e!==void 0&&e!==this.scaleMode&&(this.scaleMode=e,i=!0),s!==void 0&&s!==this.mipmap&&(this.mipmap=s,i=!0),i&&this.dirtyStyleId++,this},t.prototype.setSize=function(e,s,i){return i=i||this.resolution,this.setRealSize(e*i,s*i,i)},t.prototype.setRealSize=function(e,s,i){return this.resolution=i||this.resolution,this.width=Math.round(e)/this.resolution,this.height=Math.round(s)/this.resolution,this._refreshPOT(),this.update(),this},t.prototype._refreshPOT=function(){this.isPowerOfTwo=Pp(this.realWidth)&&Pp(this.realHeight)},t.prototype.setResolution=function(e){var s=this.resolution;return s===e?this:(this.resolution=e,this.valid&&(this.width=Math.round(this.width*s)/e,this.height=Math.round(this.height*s)/e,this.emit("update",this)),this._refreshPOT(),this)},t.prototype.setResource=function(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},t.prototype.update=function(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},t.prototype.onError=function(e){this.emit("error",this,e)},t.prototype.destroy=function(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete qi[this.cacheId],delete Cr[this.cacheId],this.cacheId=null),this.dispose(),t.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},t.prototype.dispose=function(){this.emit("dispose",this)},t.prototype.castToBaseTexture=function(){return this},t.from=function(e,s,i){i===void 0&&(i=Z.STRICT_TEXTURE_CACHE);var n=typeof e=="string",a=null;if(n)a=e;else{if(!e._pixiId){var o=s&&s.pixiIdPrefix||"pixiid";e._pixiId=o+"_"+Dn()}a=e._pixiId}var h=qi[a];if(n&&i&&!h)throw new Error('The cacheId "'+a+'" does not exist in BaseTextureCache.');return h||(h=new t(e,s),h.cacheId=a,t.addToCache(h,a)),h},t.fromBuffer=function(e,s,i,n){e=e||new Float32Array(s*i*4);var a=new Cg(e,{width:s,height:i}),o=e instanceof Float32Array?xt.FLOAT:xt.UNSIGNED_BYTE;return new t(a,Object.assign({},SD,n||{width:s,height:i,type:o}))},t.addToCache=function(e,s){s&&(e.textureCacheIds.indexOf(s)===-1&&e.textureCacheIds.push(s),qi[s]&&console.warn("BaseTexture added to the cache with an id ["+s+"] that already had an entry"),qi[s]=e)},t.removeFromCache=function(e){if(typeof e=="string"){var s=qi[e];if(s){var i=s.textureCacheIds.indexOf(e);return i>-1&&s.textureCacheIds.splice(i,1),delete qi[e],s}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)delete qi[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},t._globalBatch=0,t}(Ah),nT=function(r){$t(t,r);function t(e,s){var i=this,n=s||{},a=n.width,o=n.height;i=r.call(this,a,o)||this,i.items=[],i.itemDirtyIds=[];for(var h=0;h<e;h++){var u=new Xt;i.items.push(u),i.itemDirtyIds.push(-2)}return i.length=e,i._load=null,i.baseTexture=null,i}return t.prototype.initFromArray=function(e,s){for(var i=0;i<this.length;i++)e[i]&&(e[i].castToBaseTexture?this.addBaseTextureAt(e[i].castToBaseTexture(),i):e[i]instanceof rh?this.addResourceAt(e[i],i):this.addResourceAt(iT(e[i],s),i))},t.prototype.dispose=function(){for(var e=0,s=this.length;e<s;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},t.prototype.addResourceAt=function(e,s){if(!this.items[s])throw new Error("Index "+s+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[s].setResource(e),this},t.prototype.bind=function(e){if(this.baseTexture!==null)throw new Error("Only one base texture per TextureArray is allowed");r.prototype.bind.call(this,e);for(var s=0;s<this.length;s++)this.items[s].parentTextureArray=e,this.items[s].on("update",e.update,e)},t.prototype.unbind=function(e){r.prototype.unbind.call(this,e);for(var s=0;s<this.length;s++)this.items[s].parentTextureArray=null,this.items[s].off("update",e.update,e)},t.prototype.load=function(){var e=this;if(this._load)return this._load;var s=this.items.map(function(n){return n.resource}).filter(function(n){return n}),i=s.map(function(n){return n.load()});return this._load=Promise.all(i).then(function(){var n=e.items[0],a=n.realWidth,o=n.realHeight;return e.resize(a,o),Promise.resolve(e)}),this._load},t}(rh),yD=function(r){$t(t,r);function t(e,s){var i=this,n=s||{},a=n.width,o=n.height,h,u;return Array.isArray(e)?(h=e,u=e.length):u=e,i=r.call(this,u,{width:a,height:o})||this,h&&i.initFromArray(h,s),i}return t.prototype.addBaseTextureAt=function(e,s){if(e.resource)this.addResourceAt(e.resource,s);else throw new Error("ArrayResource does not support RenderTexture");return this},t.prototype.bind=function(e){r.prototype.bind.call(this,e),e.target=An.TEXTURE_2D_ARRAY},t.prototype.upload=function(e,s,i){var n=this,a=n.length,o=n.itemDirtyIds,h=n.items,u=e.gl;i.dirtyId<0&&u.texImage3D(u.TEXTURE_2D_ARRAY,0,i.internalFormat,this._width,this._height,a,0,s.format,i.type,null);for(var c=0;c<a;c++){var l=h[c];o[c]<l.dirtyId&&(o[c]=l.dirtyId,l.valid&&u.texSubImage3D(u.TEXTURE_2D_ARRAY,0,0,0,c,l.resource.width,l.resource.height,1,s.format,i.type,l.resource.source))}return!0},t}(nT),ki=function(r){$t(t,r);function t(e){var s=this,i=e,n=i.naturalWidth||i.videoWidth||i.width,a=i.naturalHeight||i.videoHeight||i.height;return s=r.call(this,n,a)||this,s.source=e,s.noSubImage=!1,s}return t.crossOrigin=function(e,s,i){i===void 0&&s.indexOf("data:")!==0?e.crossOrigin=ED(s):i!==!1&&(e.crossOrigin=typeof i=="string"?i:"anonymous")},t.prototype.upload=function(e,s,i,n){var a=e.gl,o=s.realWidth,h=s.realHeight;if(n=n||this.source,n instanceof HTMLImageElement){if(!n.complete||n.naturalWidth===0)return!1}else if(n instanceof HTMLVideoElement&&n.readyState<=1)return!1;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Vi.UNPACK),!this.noSubImage&&s.target===a.TEXTURE_2D&&i.width===o&&i.height===h?a.texSubImage2D(a.TEXTURE_2D,0,0,0,s.format,i.type,n):(i.width=o,i.height=h,a.texImage2D(s.target,0,i.internalFormat,s.format,i.type,n)),!0},t.prototype.update=function(){if(!this.destroyed){var e=this.source,s=e.naturalWidth||e.videoWidth||e.width,i=e.naturalHeight||e.videoHeight||e.height;this.resize(s,i),r.prototype.update.call(this)}},t.prototype.dispose=function(){this.source=null},t}(rh),MD=function(r){$t(t,r);function t(e){return r.call(this,e)||this}return t.test=function(e){var s=globalThis.OffscreenCanvas;return s&&e instanceof s?!0:globalThis.HTMLCanvasElement&&e instanceof HTMLCanvasElement},t}(ki),CD=function(r){$t(t,r);function t(e,s){var i=this,n=s||{},a=n.width,o=n.height,h=n.autoLoad,u=n.linkBaseTexture;if(e&&e.length!==t.SIDES)throw new Error("Invalid length. Got "+e.length+", expected 6");i=r.call(this,6,{width:a,height:o})||this;for(var c=0;c<t.SIDES;c++)i.items[c].target=An.TEXTURE_CUBE_MAP_POSITIVE_X+c;return i.linkBaseTexture=u!==!1,e&&i.initFromArray(e,s),h!==!1&&i.load(),i}return t.prototype.bind=function(e){r.prototype.bind.call(this,e),e.target=An.TEXTURE_CUBE_MAP},t.prototype.addBaseTextureAt=function(e,s,i){if(!this.items[s])throw new Error("Index "+s+" is out of bounds");if(!this.linkBaseTexture||e.parentTextureArray||Object.keys(e._glTextures).length>0)if(e.resource)this.addResourceAt(e.resource,s);else throw new Error("CubeResource does not support copying of renderTexture.");else e.target=An.TEXTURE_CUBE_MAP_POSITIVE_X+s,e.parentTextureArray=this.baseTexture,this.items[s]=e;return e.valid&&!this.valid&&this.resize(e.realWidth,e.realHeight),this.items[s]=e,this},t.prototype.upload=function(e,s,i){for(var n=this.itemDirtyIds,a=0;a<t.SIDES;a++){var o=this.items[a];(n[a]<o.dirtyId||i.dirtyId<s.dirtyId)&&(o.valid&&o.resource?(o.resource.upload(e,o,i),n[a]=o.dirtyId):n[a]<-1&&(e.gl.texImage2D(o.target,0,i.internalFormat,s.realWidth,s.realHeight,0,s.format,i.type,null),n[a]=-1))}return!0},t.test=function(e){return Array.isArray(e)&&e.length===t.SIDES},t.SIDES=6,t}(nT),aT=function(r){$t(t,r);function t(e,s){var i=this;if(s=s||{},!(e instanceof HTMLImageElement)){var n=new Image;ki.crossOrigin(n,e,s.crossorigin),n.src=e,e=n}return i=r.call(this,e)||this,!e.complete&&i._width&&i._height&&(i._width=0,i._height=0),i.url=e.src,i._process=null,i.preserveBitmap=!1,i.createBitmap=(s.createBitmap!==void 0?s.createBitmap:Z.CREATE_IMAGE_BITMAP)&&!!globalThis.createImageBitmap,i.alphaMode=typeof s.alphaMode=="number"?s.alphaMode:null,i.bitmap=null,i._load=null,s.autoLoad!==!1&&i.load(),i}return t.prototype.load=function(e){var s=this;return this._load?this._load:(e!==void 0&&(this.createBitmap=e),this._load=new Promise(function(i,n){var a=s.source;s.url=a.src;var o=function(){s.destroyed||(a.onload=null,a.onerror=null,s.resize(a.width,a.height),s._load=null,s.createBitmap?i(s.process()):i(s))};a.complete&&a.src?o():(a.onload=o,a.onerror=function(h){n(h),s.onError.emit(h)})}),this._load)},t.prototype.process=function(){var e=this,s=this.source;if(this._process!==null)return this._process;if(this.bitmap!==null||!globalThis.createImageBitmap)return Promise.resolve(this);var i=globalThis.createImageBitmap,n=!s.crossOrigin||s.crossOrigin==="anonymous";return this._process=fetch(s.src,{mode:n?"cors":"no-cors"}).then(function(a){return a.blob()}).then(function(a){return i(a,0,0,s.width,s.height,{premultiplyAlpha:e.alphaMode===null||e.alphaMode===Vi.UNPACK?"premultiply":"none"})}).then(function(a){return e.destroyed?Promise.reject():(e.bitmap=a,e.update(),e._process=null,Promise.resolve(e))}),this._process},t.prototype.upload=function(e,s,i){if(typeof this.alphaMode=="number"&&(s.alphaMode=this.alphaMode),!this.createBitmap)return r.prototype.upload.call(this,e,s,i);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(r.prototype.upload.call(this,e,s,i,this.bitmap),!this.preserveBitmap){var n=!0,a=s._glTextures;for(var o in a){var h=a[o];if(h!==i&&h.dirtyId!==s.dirtyId){n=!1;break}}n&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},t.prototype.dispose=function(){this.source.onload=null,this.source.onerror=null,r.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},t.test=function(e){return typeof e=="string"||e instanceof HTMLImageElement},t}(ki),ND=function(r){$t(t,r);function t(e,s){var i=this;return s=s||{},i=r.call(this,Z.ADAPTER.createCanvas())||this,i._width=0,i._height=0,i.svg=e,i.scale=s.scale||1,i._overrideWidth=s.width,i._overrideHeight=s.height,i._resolve=null,i._crossorigin=s.crossorigin,i._load=null,s.autoLoad!==!1&&i.load(),i}return t.prototype.load=function(){var e=this;return this._load?this._load:(this._load=new Promise(function(s){if(e._resolve=function(){e.resize(e.source.width,e.source.height),s(e)},t.SVG_XML.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}),this._load)},t.prototype._loadSvg=function(){var e=this,s=new Image;ki.crossOrigin(s,this.svg,this._crossorigin),s.src=this.svg,s.onerror=function(i){e._resolve&&(s.onerror=null,e.onError.emit(i))},s.onload=function(){if(e._resolve){var i=s.width,n=s.height;if(!i||!n)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var a=i*e.scale,o=n*e.scale;(e._overrideWidth||e._overrideHeight)&&(a=e._overrideWidth||e._overrideHeight/n*i,o=e._overrideHeight||e._overrideWidth/i*n),a=Math.round(a),o=Math.round(o);var h=e.source;h.width=a,h.height=o,h._pixiId="canvas_"+Dn(),h.getContext("2d").drawImage(s,0,0,i,n,0,0,a,o),e._resolve(),e._resolve=null}}},t.getSize=function(e){var s=t.SVG_SIZE.exec(e),i={};return s&&(i[s[1]]=Math.round(parseFloat(s[3])),i[s[5]]=Math.round(parseFloat(s[7]))),i},t.prototype.dispose=function(){r.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},t.test=function(e,s){return s==="svg"||typeof e=="string"&&e.startsWith("data:image/svg+xml")||typeof e=="string"&&t.SVG_XML.test(e)},t.SVG_XML=/^(<\?xml[^?]+\?>)?\s*(<!--[^(-->)]*-->)?\s*\<svg/m,t.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i,t}(ki),bD=function(r){$t(t,r);function t(e,s){var i=this;if(s=s||{},!(e instanceof HTMLVideoElement)){var n=document.createElement("video");n.setAttribute("preload","auto"),n.setAttribute("webkit-playsinline",""),n.setAttribute("playsinline",""),typeof e=="string"&&(e=[e]);var a=e[0].src||e[0];ki.crossOrigin(n,a,s.crossorigin);for(var o=0;o<e.length;++o){var h=document.createElement("source"),u=e[o],c=u.src,l=u.mime;c=c||e[o];var _=c.split("?").shift().toLowerCase(),d=_.slice(_.lastIndexOf(".")+1);l=l||t.MIME_TYPES[d]||"video/"+d,h.src=c,h.type=l,n.appendChild(h)}e=n}return i=r.call(this,e)||this,i.noSubImage=!0,i._autoUpdate=!0,i._isConnectedToTicker=!1,i._updateFPS=s.updateFPS||0,i._msToNextUpdate=0,i.autoPlay=s.autoPlay!==!1,i._load=null,i._resolve=null,i._onCanPlay=i._onCanPlay.bind(i),i._onError=i._onError.bind(i),s.autoLoad!==!1&&i.load(),i}return t.prototype.update=function(e){if(!this.destroyed){var s=hr.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-s),(!this._updateFPS||this._msToNextUpdate<=0)&&(r.prototype.update.call(this),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},t.prototype.load=function(){var e=this;if(this._load)return this._load;var s=this.source;return(s.readyState===s.HAVE_ENOUGH_DATA||s.readyState===s.HAVE_FUTURE_DATA)&&s.width&&s.height&&(s.complete=!0),s.addEventListener("play",this._onPlayStart.bind(this)),s.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(s.addEventListener("canplay",this._onCanPlay),s.addEventListener("canplaythrough",this._onCanPlay),s.addEventListener("error",this._onError,!0)),this._load=new Promise(function(i){e.valid?i(e):(e._resolve=i,s.load())}),this._load},t.prototype._onError=function(e){this.source.removeEventListener("error",this._onError,!0),this.onError.emit(e)},t.prototype._isSourcePlaying=function(){var e=this.source;return!e.paused&&!e.ended&&this._isSourceReady()},t.prototype._isSourceReady=function(){var e=this.source;return e.readyState>2},t.prototype._onPlayStart=function(){this.valid||this._onCanPlay(),this.autoUpdate&&!this._isConnectedToTicker&&(hr.shared.add(this.update,this),this._isConnectedToTicker=!0)},t.prototype._onPlayStop=function(){this._isConnectedToTicker&&(hr.shared.remove(this.update,this),this._isConnectedToTicker=!1)},t.prototype._onCanPlay=function(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var s=this.valid;this.resize(e.videoWidth,e.videoHeight),!s&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},t.prototype.dispose=function(){this._isConnectedToTicker&&(hr.shared.remove(this.update,this),this._isConnectedToTicker=!1);var e=this.source;e&&(e.removeEventListener("error",this._onError,!0),e.pause(),e.src="",e.load()),r.prototype.dispose.call(this)},Object.defineProperty(t.prototype,"autoUpdate",{get:function(){return this._autoUpdate},set:function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isConnectedToTicker?(hr.shared.remove(this.update,this),this._isConnectedToTicker=!1):this._autoUpdate&&!this._isConnectedToTicker&&this._isSourcePlaying()&&(hr.shared.add(this.update,this),this._isConnectedToTicker=!0))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"updateFPS",{get:function(){return this._updateFPS},set:function(e){e!==this._updateFPS&&(this._updateFPS=e)},enumerable:!1,configurable:!0}),t.test=function(e,s){return globalThis.HTMLVideoElement&&e instanceof HTMLVideoElement||t.TYPES.indexOf(s)>-1},t.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"],t.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t}(ki),PD=function(r){$t(t,r);function t(e){return r.call(this,e)||this}return t.test=function(e){return!!globalThis.createImageBitmap&&typeof ImageBitmap<"u"&&e instanceof ImageBitmap},t}(ki);Rd.push(aT,PD,MD,bD,ND,Cg,CD,yD);var DD=function(r){$t(t,r);function t(){return r!==null&&r.apply(this,arguments)||this}return t.prototype.upload=function(e,s,i){var n=e.gl;n.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s.alphaMode===Vi.UNPACK);var a=s.realWidth,o=s.realHeight;return i.width===a&&i.height===o?n.texSubImage2D(s.target,0,0,0,a,o,s.format,i.type,this.data):(i.width=a,i.height=o,n.texImage2D(s.target,0,i.internalFormat,a,o,0,s.format,i.type,this.data)),!0},t}(Cg),Ad=function(){function r(t,e){this.width=Math.round(t||100),this.height=Math.round(e||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new je("disposeFramebuffer"),this.multisample=ne.NONE}return Object.defineProperty(r.prototype,"colorTexture",{get:function(){return this.colorTextures[0]},enumerable:!1,configurable:!0}),r.prototype.addColorTexture=function(t,e){return t===void 0&&(t=0),this.colorTextures[t]=e||new Xt(null,{scaleMode:_s.NEAREST,resolution:1,mipmap:Hi.OFF,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},r.prototype.addDepthTexture=function(t){return this.depthTexture=t||new Xt(new DD(null,{width:this.width,height:this.height}),{scaleMode:_s.NEAREST,resolution:1,width:this.width,height:this.height,mipmap:Hi.OFF,format:W.DEPTH_COMPONENT,type:xt.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},r.prototype.enableDepth=function(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},r.prototype.enableStencil=function(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},r.prototype.resize=function(t,e){if(t=Math.round(t),e=Math.round(e),!(t===this.width&&e===this.height)){this.width=t,this.height=e,this.dirtyId++,this.dirtySize++;for(var s=0;s<this.colorTextures.length;s++){var i=this.colorTextures[s],n=i.resolution;i.setSize(t/n,e/n)}if(this.depthTexture){var n=this.depthTexture.resolution;this.depthTexture.setSize(t/n,e/n)}}},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroyDepthTexture=function(){this.depthTexture&&(this.depthTexture.destroy(),this.depthTexture=null,++this.dirtyId,++this.dirtyFormat)},r}(),oT=function(r){$t(t,r);function t(e){e===void 0&&(e={});var s=this;if(typeof e=="number"){var i=arguments[0],n=arguments[1],a=arguments[2],o=arguments[3];e={width:i,height:n,scaleMode:a,resolution:o}}return e.width=e.width||100,e.height=e.height||100,e.multisample=e.multisample!==void 0?e.multisample:ne.NONE,s=r.call(this,null,e)||this,s.mipmap=Hi.OFF,s.valid=!0,s.clearColor=[0,0,0,0],s.framebuffer=new Ad(s.realWidth,s.realHeight).addColorTexture(0,s),s.framebuffer.multisample=e.multisample,s.maskStack=[],s.filterStack=[{}],s}return t.prototype.resize=function(e,s){this.framebuffer.resize(e*this.resolution,s*this.resolution),this.setRealSize(this.framebuffer.width,this.framebuffer.height)},t.prototype.dispose=function(){this.framebuffer.dispose(),r.prototype.dispose.call(this)},t.prototype.destroy=function(){r.prototype.destroy.call(this),this.framebuffer.destroyDepthTexture(),this.framebuffer=null},t}(Xt),hT=function(){function r(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)}return r.prototype.set=function(t,e,s){var i=e.width,n=e.height;if(s){var a=t.width/2/i,o=t.height/2/n,h=t.x/i+a,u=t.y/n+o;s=St.add(s,St.NW),this.x0=h+a*St.uX(s),this.y0=u+o*St.uY(s),s=St.add(s,2),this.x1=h+a*St.uX(s),this.y1=u+o*St.uY(s),s=St.add(s,2),this.x2=h+a*St.uX(s),this.y2=u+o*St.uY(s),s=St.add(s,2),this.x3=h+a*St.uX(s),this.y3=u+o*St.uY(s)}else this.x0=t.x/i,this.y0=t.y/n,this.x1=(t.x+t.width)/i,this.y1=t.y/n,this.x2=(t.x+t.width)/i,this.y2=(t.y+t.height)/n,this.x3=t.x/i,this.y3=(t.y+t.height)/n;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3},r.prototype.toString=function(){return"[@pixi/core:TextureUvs "+("x0="+this.x0+" y0="+this.y0+" ")+("x1="+this.x1+" y1="+this.y1+" x2="+this.x2+" ")+("y2="+this.y2+" x3="+this.x3+" y3="+this.y3)+"]"},r}(),wp=new hT;function Eu(r){r.destroy=function(){},r.on=function(){},r.once=function(){},r.emit=function(){}}var _t=function(r){$t(t,r);function t(e,s,i,n,a,o){var h=r.call(this)||this;if(h.noFrame=!1,s||(h.noFrame=!0,s=new it(0,0,1,1)),e instanceof t&&(e=e.baseTexture),h.baseTexture=e,h._frame=s,h.trim=n,h.valid=!1,h._uvs=wp,h.uvMatrix=null,h.orig=i||s,h._rotate=Number(a||0),a===!0)h._rotate=2;else if(h._rotate%2!==0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");return h.defaultAnchor=o?new B(o.x,o.y):new B(0,0),h._updateID=0,h.textureCacheIds=[],e.valid?h.noFrame?e.valid&&h.onBaseTextureUpdated(e):h.frame=s:e.once("loaded",h.onBaseTextureUpdated,h),h.noFrame&&e.on("update",h.onBaseTextureUpdated,h),h}return t.prototype.update=function(){this.baseTexture.resource&&this.baseTexture.resource.update()},t.prototype.onBaseTextureUpdated=function(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},t.prototype.destroy=function(e){if(this.baseTexture){if(e){var s=this.baseTexture.resource;s&&s.url&&Cr[s.url]&&t.removeFromCache(s.url),this.baseTexture.destroy()}this.baseTexture.off("loaded",this.onBaseTextureUpdated,this),this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,t.removeFromCache(this),this.textureCacheIds=null},t.prototype.clone=function(){var e=this._frame.clone(),s=this._frame===this.orig?e:this.orig.clone(),i=new t(this.baseTexture,!this.noFrame&&e,s,this.trim&&this.trim.clone(),this.rotate,this.defaultAnchor);return this.noFrame&&(i._frame=e),i},t.prototype.updateUvs=function(){this._uvs===wp&&(this._uvs=new hT),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},t.from=function(e,s,i){s===void 0&&(s={}),i===void 0&&(i=Z.STRICT_TEXTURE_CACHE);var n=typeof e=="string",a=null;if(n)a=e;else if(e instanceof Xt){if(!e.cacheId){var o=s&&s.pixiIdPrefix||"pixiid";e.cacheId=o+"-"+Dn(),Xt.addToCache(e,e.cacheId)}a=e.cacheId}else{if(!e._pixiId){var o=s&&s.pixiIdPrefix||"pixiid";e._pixiId=o+"_"+Dn()}a=e._pixiId}var h=Cr[a];if(n&&i&&!h)throw new Error('The cacheId "'+a+'" does not exist in TextureCache.');return!h&&!(e instanceof Xt)?(s.resolution||(s.resolution=Id(e)),h=new t(new Xt(e,s)),h.baseTexture.cacheId=a,Xt.addToCache(h.baseTexture,a),t.addToCache(h,a)):!h&&e instanceof Xt&&(h=new t(e),t.addToCache(h,a)),h},t.fromURL=function(e,s){var i=Object.assign({autoLoad:!1},s==null?void 0:s.resourceOptions),n=t.from(e,Object.assign({resourceOptions:i},s),!1),a=n.baseTexture.resource;return n.baseTexture.valid?Promise.resolve(n):a.load().then(function(){return Promise.resolve(n)})},t.fromBuffer=function(e,s,i,n){return new t(Xt.fromBuffer(e,s,i,n))},t.fromLoader=function(e,s,i,n){var a=new Xt(e,Object.assign({scaleMode:Z.SCALE_MODE,resolution:Id(s)},n)),o=a.resource;o instanceof aT&&(o.url=s);var h=new t(a);return i||(i=s),Xt.addToCache(h.baseTexture,i),t.addToCache(h,i),i!==s&&(Xt.addToCache(h.baseTexture,s),t.addToCache(h,s)),h.baseTexture.valid?Promise.resolve(h):new Promise(function(u){h.baseTexture.once("loaded",function(){return u(h)})})},t.addToCache=function(e,s){s&&(e.textureCacheIds.indexOf(s)===-1&&e.textureCacheIds.push(s),Cr[s]&&console.warn("Texture added to the cache with an id ["+s+"] that already had an entry"),Cr[s]=e)},t.removeFromCache=function(e){if(typeof e=="string"){var s=Cr[e];if(s){var i=s.textureCacheIds.indexOf(e);return i>-1&&s.textureCacheIds.splice(i,1),delete Cr[e],s}}else if(e&&e.textureCacheIds){for(var n=0;n<e.textureCacheIds.length;++n)Cr[e.textureCacheIds[n]]===e&&delete Cr[e.textureCacheIds[n]];return e.textureCacheIds.length=0,e}return null},Object.defineProperty(t.prototype,"resolution",{get:function(){return this.baseTexture.resolution},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"frame",{get:function(){return this._frame},set:function(e){this._frame=e,this.noFrame=!1;var s=e.x,i=e.y,n=e.width,a=e.height,o=s+n>this.baseTexture.width,h=i+a>this.baseTexture.height;if(o||h){var u=o&&h?"and":"or",c="X: "+s+" + "+n+" = "+(s+n)+" > "+this.baseTexture.width,l="Y: "+i+" + "+a+" = "+(i+a)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+(c+" "+u+" "+l))}this.valid=n&&a&&this.baseTexture.valid,!this.trim&&!this.rotate&&(this.orig=e),this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotate",{get:function(){return this._rotate},set:function(e){this._rotate=e,this.valid&&this.updateUvs()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.orig.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.orig.height},enumerable:!1,configurable:!0}),t.prototype.castToBaseTexture=function(){return this.baseTexture},Object.defineProperty(t,"EMPTY",{get:function(){return t._EMPTY||(t._EMPTY=new t(new Xt),Eu(t._EMPTY),Eu(t._EMPTY.baseTexture)),t._EMPTY},enumerable:!1,configurable:!0}),Object.defineProperty(t,"WHITE",{get:function(){if(!t._WHITE){var e=Z.ADAPTER.createCanvas(16,16),s=e.getContext("2d");e.width=16,e.height=16,s.fillStyle="white",s.fillRect(0,0,16,16),t._WHITE=new t(Xt.from(e)),Eu(t._WHITE),Eu(t._WHITE.baseTexture)}return t._WHITE},enumerable:!1,configurable:!0}),t}(Ah),we=function(r){$t(t,r);function t(e,s){var i=r.call(this,e,s)||this;return i.valid=!0,i.filterFrame=null,i.filterPoolKey=null,i.updateUvs(),i}return Object.defineProperty(t.prototype,"framebuffer",{get:function(){return this.baseTexture.framebuffer},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"multisample",{get:function(){return this.framebuffer.multisample},set:function(e){this.framebuffer.multisample=e},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,s,i){i===void 0&&(i=!0);var n=this.baseTexture.resolution,a=Math.round(e*n)/n,o=Math.round(s*n)/n;this.valid=a>0&&o>0,this._frame.width=this.orig.width=a,this._frame.height=this.orig.height=o,i&&this.baseTexture.resize(a,o),this.updateUvs()},t.prototype.setResolution=function(e){var s=this.baseTexture;s.resolution!==e&&(s.setResolution(e),this.resize(s.width,s.height,!1))},t.create=function(e){for(var s=arguments,i=[],n=1;n<arguments.length;n++)i[n-1]=s[n];return typeof e=="number"&&(Er("6.0.0","Arguments (width, height, scaleMode, resolution) have been deprecated."),e={width:e,height:i[0],scaleMode:i[1],resolution:i[2]}),new t(new oT(e))},t}(_t),LD=function(){function r(t){this.texturePool={},this.textureOptions=t||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0}return r.prototype.createTexture=function(t,e,s){s===void 0&&(s=ne.NONE);var i=new oT(Object.assign({width:t,height:e,resolution:1,multisample:s},this.textureOptions));return new we(i)},r.prototype.getOptimalTexture=function(t,e,s,i){s===void 0&&(s=1),i===void 0&&(i=ne.NONE);var n;t=Math.ceil(t*s-1e-6),e=Math.ceil(e*s-1e-6),!this.enableFullScreen||t!==this._pixelsWidth||e!==this._pixelsHeight?(t=ml(t),e=ml(e),n=((t&65535)<<16|e&65535)>>>0,i>1&&(n+=i*4294967296)):n=i>1?-i:-1,this.texturePool[n]||(this.texturePool[n]=[]);var a=this.texturePool[n].pop();return a||(a=this.createTexture(t,e,i)),a.filterPoolKey=n,a.setResolution(s),a},r.prototype.getFilterTexture=function(t,e,s){var i=this.getOptimalTexture(t.width,t.height,e||t.resolution,s||ne.NONE);return i.filterFrame=t.filterFrame,i},r.prototype.returnTexture=function(t){var e=t.filterPoolKey;t.filterFrame=null,this.texturePool[e].push(t)},r.prototype.returnFilterTexture=function(t){this.returnTexture(t)},r.prototype.clear=function(t){if(t=t!==!1,t)for(var e in this.texturePool){var s=this.texturePool[e];if(s)for(var i=0;i<s.length;i++)s[i].destroy(!0)}this.texturePool={}},r.prototype.setScreenSize=function(t){if(!(t.width===this._pixelsWidth&&t.height===this._pixelsHeight)){this.enableFullScreen=t.width>0&&t.height>0;for(var e in this.texturePool)if(Number(e)<0){var s=this.texturePool[e];if(s)for(var i=0;i<s.length;i++)s[i].destroy(!0);this.texturePool[e]=[]}this._pixelsWidth=t.width,this._pixelsHeight=t.height}},r.SCREEN_KEY=-1,r}(),Gp=function(){function r(t,e,s,i,n,a,o){e===void 0&&(e=0),s===void 0&&(s=!1),i===void 0&&(i=xt.FLOAT),this.buffer=t,this.size=e,this.normalized=s,this.type=i,this.stride=n,this.start=a,this.instance=o}return r.prototype.destroy=function(){this.buffer=null},r.from=function(t,e,s,i,n){return new r(t,e,s,i,n)},r}(),UD=0,ns=function(){function r(t,e,s){e===void 0&&(e=!0),s===void 0&&(s=!1),this.data=t||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=s,this.static=e,this.id=UD++,this.disposeRunner=new je("disposeBuffer")}return r.prototype.update=function(t){t instanceof Array&&(t=new Float32Array(t)),this.data=t||this.data,this._updateID++},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroy=function(){this.dispose(),this.data=null},Object.defineProperty(r.prototype,"index",{get:function(){return this.type===gr.ELEMENT_ARRAY_BUFFER},set:function(t){this.type=t?gr.ELEMENT_ARRAY_BUFFER:gr.ARRAY_BUFFER},enumerable:!1,configurable:!0}),r.from=function(t){return t instanceof Array&&(t=new Float32Array(t)),new r(t)},r}(),xD={Float32Array,Uint32Array,Int32Array,Uint8Array};function FD(r,t){for(var e=0,s=0,i={},n=0;n<r.length;n++)s+=t[n],e+=r[n].length;for(var a=new ArrayBuffer(e*4),o=null,h=0,n=0;n<r.length;n++){var u=t[n],c=r[n],l=eT(c);i[l]||(i[l]=new xD[l](a)),o=i[l];for(var _=0;_<c.length;_++){var d=(_/u|0)*s+h,f=_%u;o[d+f]=c[_]}h+=u}return new Float32Array(a)}var Bp={5126:4,5123:2,5121:1},wD=0,GD={Float32Array,Uint32Array,Int32Array,Uint8Array,Uint16Array},$l=function(){function r(t,e){t===void 0&&(t=[]),e===void 0&&(e={}),this.buffers=t,this.indexBuffer=null,this.attributes=e,this.glVertexArrayObjects={},this.id=wD++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new je("disposeGeometry"),this.refCount=0}return r.prototype.addAttribute=function(t,e,s,i,n,a,o,h){if(s===void 0&&(s=0),i===void 0&&(i=!1),h===void 0&&(h=!1),!e)throw new Error("You must pass a buffer when creating an attribute");e instanceof ns||(e instanceof Array&&(e=new Float32Array(e)),e=new ns(e));var u=t.split("|");if(u.length>1){for(var c=0;c<u.length;c++)this.addAttribute(u[c],e,s,i,n);return this}var l=this.buffers.indexOf(e);return l===-1&&(this.buffers.push(e),l=this.buffers.length-1),this.attributes[t]=new Gp(l,s,i,n,a,o,h),this.instanced=this.instanced||h,this},r.prototype.getAttribute=function(t){return this.attributes[t]},r.prototype.getBuffer=function(t){return this.buffers[this.getAttribute(t).buffer]},r.prototype.addIndex=function(t){return t instanceof ns||(t instanceof Array&&(t=new Uint16Array(t)),t=new ns(t)),t.type=gr.ELEMENT_ARRAY_BUFFER,this.indexBuffer=t,this.buffers.indexOf(t)===-1&&this.buffers.push(t),this},r.prototype.getIndex=function(){return this.indexBuffer},r.prototype.interleave=function(){if(this.buffers.length===1||this.buffers.length===2&&this.indexBuffer)return this;var t=[],e=[],s=new ns,i;for(i in this.attributes){var n=this.attributes[i],a=this.buffers[n.buffer];t.push(a.data),e.push(n.size*Bp[n.type]/4),n.buffer=0}for(s.data=FD(t,e),i=0;i<this.buffers.length;i++)this.buffers[i]!==this.indexBuffer&&this.buffers[i].destroy();return this.buffers=[s],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},r.prototype.getSize=function(){for(var t in this.attributes){var e=this.attributes[t],s=this.buffers[e.buffer];return s.data.length/(e.stride/4||e.size)}return 0},r.prototype.dispose=function(){this.disposeRunner.emit(this,!1)},r.prototype.destroy=function(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},r.prototype.clone=function(){for(var t=new r,e=0;e<this.buffers.length;e++)t.buffers[e]=new ns(this.buffers[e].data.slice(0));for(var e in this.attributes){var s=this.attributes[e];t.attributes[e]=new Gp(s.buffer,s.size,s.normalized,s.type,s.stride,s.start,s.instance)}return this.indexBuffer&&(t.indexBuffer=t.buffers[this.buffers.indexOf(this.indexBuffer)],t.indexBuffer.type=gr.ELEMENT_ARRAY_BUFFER),t},r.merge=function(t){for(var e=new r,s=[],i=[],n=[],a,o=0;o<t.length;o++){a=t[o];for(var h=0;h<a.buffers.length;h++)i[h]=i[h]||0,i[h]+=a.buffers[h].data.length,n[h]=0}for(var o=0;o<a.buffers.length;o++)s[o]=new GD[eT(a.buffers[o].data)](i[o]),e.buffers[o]=new ns(s[o]);for(var o=0;o<t.length;o++){a=t[o];for(var h=0;h<a.buffers.length;h++)s[h].set(a.buffers[h].data,n[h]),n[h]+=a.buffers[h].data.length}if(e.attributes=a.attributes,a.indexBuffer){e.indexBuffer=e.buffers[a.buffers.indexOf(a.indexBuffer)],e.indexBuffer.type=gr.ELEMENT_ARRAY_BUFFER;for(var u=0,c=0,l=0,_=0,o=0;o<a.buffers.length;o++)if(a.buffers[o]!==a.indexBuffer){_=o;break}for(var o in a.attributes){var d=a.attributes[o];(d.buffer|0)===_&&(c+=d.size*Bp[d.type]/4)}for(var o=0;o<t.length;o++){for(var f=t[o].indexBuffer.data,h=0;h<f.length;h++)e.indexBuffer.data[h+l]+=u;u+=t[o].buffers[_].data.length/c,l+=f.length}}return e},r}(),BD=function(r){$t(t,r);function t(){var e=r.call(this)||this;return e.addAttribute("aVertexPosition",new Float32Array([0,0,1,0,1,1,0,1])).addIndex([0,1,3,2]),e}return t}($l),uT=function(r){$t(t,r);function t(){var e=r.call(this)||this;return e.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),e.uvs=new Float32Array([0,0,1,0,1,1,0,1]),e.vertexBuffer=new ns(e.vertices),e.uvBuffer=new ns(e.uvs),e.addAttribute("aVertexPosition",e.vertexBuffer).addAttribute("aTextureCoord",e.uvBuffer).addIndex([0,1,2,0,2,3]),e}return t.prototype.map=function(e,s){var i=0,n=0;return this.uvs[0]=i,this.uvs[1]=n,this.uvs[2]=i+s.width/e.width,this.uvs[3]=n,this.uvs[4]=i+s.width/e.width,this.uvs[5]=n+s.height/e.height,this.uvs[6]=i,this.uvs[7]=n+s.height/e.height,i=s.x,n=s.y,this.vertices[0]=i,this.vertices[1]=n,this.vertices[2]=i+s.width,this.vertices[3]=n,this.vertices[4]=i+s.width,this.vertices[5]=n+s.height,this.vertices[6]=i,this.vertices[7]=n+s.height,this.invalidate(),this},t.prototype.invalidate=function(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},t}($l),HD=0,Mn=function(){function r(t,e,s){this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=HD++,this.static=!!e,this.ubo=!!s,t instanceof ns?(this.buffer=t,this.buffer.type=gr.UNIFORM_BUFFER,this.autoManage=!1,this.ubo=!0):(this.uniforms=t,this.ubo&&(this.buffer=new ns(new Float32Array(1)),this.buffer.type=gr.UNIFORM_BUFFER,this.autoManage=!0))}return r.prototype.update=function(){this.dirtyId++,!this.autoManage&&this.buffer&&this.buffer.update()},r.prototype.add=function(t,e,s){if(!this.ubo)this.uniforms[t]=new r(e,s);else throw new Error("[UniformGroup] uniform groups in ubo mode cannot be modified, or have uniform groups nested in them")},r.from=function(t,e,s){return new r(t,e,s)},r.uboFrom=function(t,e){return new r(t,e??!0,!0)},r}(),VD=function(){function r(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.multisample=ne.NONE,this.sourceFrame=new it,this.destinationFrame=new it,this.bindingSourceFrame=new it,this.bindingDestinationFrame=new it,this.filters=[],this.transform=null}return r.prototype.clear=function(){this.target=null,this.filters=null,this.renderTexture=null},r}(),pu=[new B,new B,new B,new B],lc=new Vt,kD=function(){function r(t){this.renderer=t,this.defaultFilterStack=[{}],this.texturePool=new LD,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new BD,this.quadUv=new uT,this.tempRect=new it,this.activeState={},this.globalUniforms=new Mn({outputFrame:new it,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this.forceClear=!1,this.useMaxPadding=!1}return r.prototype.push=function(t,e){for(var s,i,n=this.renderer,a=this.defaultFilterStack,o=this.statePool.pop()||new VD,h=this.renderer.renderTexture,u=e[0].resolution,c=e[0].multisample,l=e[0].padding,_=e[0].autoFit,d=(s=e[0].legacy)!==null&&s!==void 0?s:!0,f=1;f<e.length;f++){var m=e[f];u=Math.min(u,m.resolution),c=Math.min(c,m.multisample),l=this.useMaxPadding?Math.max(l,m.padding):l+m.padding,_=_&&m.autoFit,d=d||((i=m.legacy)!==null&&i!==void 0?i:!0)}a.length===1&&(this.defaultFilterStack[0].renderTexture=h.current),a.push(o),o.resolution=u,o.multisample=c,o.legacy=d,o.target=t,o.sourceFrame.copyFrom(t.filterArea||t.getBounds(!0)),o.sourceFrame.pad(l);var p=this.tempRect.copyFrom(h.sourceFrame);n.projection.transform&&this.transformAABB(lc.copyFrom(n.projection.transform).invert(),p),_?(o.sourceFrame.fit(p),(o.sourceFrame.width<=0||o.sourceFrame.height<=0)&&(o.sourceFrame.width=0,o.sourceFrame.height=0)):o.sourceFrame.intersects(p)||(o.sourceFrame.width=0,o.sourceFrame.height=0),this.roundFrame(o.sourceFrame,h.current?h.current.resolution:n.resolution,h.sourceFrame,h.destinationFrame,n.projection.transform),o.renderTexture=this.getOptimalFilterTexture(o.sourceFrame.width,o.sourceFrame.height,u,c),o.filters=e,o.destinationFrame.width=o.renderTexture.width,o.destinationFrame.height=o.renderTexture.height;var T=this.tempRect;T.x=0,T.y=0,T.width=o.sourceFrame.width,T.height=o.sourceFrame.height,o.renderTexture.filterFrame=o.sourceFrame,o.bindingSourceFrame.copyFrom(h.sourceFrame),o.bindingDestinationFrame.copyFrom(h.destinationFrame),o.transform=n.projection.transform,n.projection.transform=null,h.bind(o.renderTexture,o.sourceFrame,T),n.framebuffer.clear(0,0,0,0)},r.prototype.pop=function(){var t=this.defaultFilterStack,e=t.pop(),s=e.filters;this.activeState=e;var i=this.globalUniforms.uniforms;i.outputFrame=e.sourceFrame,i.resolution=e.resolution;var n=i.inputSize,a=i.inputPixel,o=i.inputClamp;if(n[0]=e.destinationFrame.width,n[1]=e.destinationFrame.height,n[2]=1/n[0],n[3]=1/n[1],a[0]=Math.round(n[0]*e.resolution),a[1]=Math.round(n[1]*e.resolution),a[2]=1/a[0],a[3]=1/a[1],o[0]=.5*a[2],o[1]=.5*a[3],o[2]=e.sourceFrame.width*n[2]-.5*a[2],o[3]=e.sourceFrame.height*n[3]-.5*a[3],e.legacy){var h=i.filterArea;h[0]=e.destinationFrame.width,h[1]=e.destinationFrame.height,h[2]=e.sourceFrame.x,h[3]=e.sourceFrame.y,i.filterClamp=i.inputClamp}this.globalUniforms.update();var u=t[t.length-1];if(this.renderer.framebuffer.blit(),s.length===1)s[0].apply(this,e.renderTexture,u.renderTexture,Ri.BLEND,e),this.returnFilterTexture(e.renderTexture);else{var c=e.renderTexture,l=this.getOptimalFilterTexture(c.width,c.height,e.resolution);l.filterFrame=c.filterFrame;var _=0;for(_=0;_<s.length-1;++_){_===1&&e.multisample>1&&(l=this.getOptimalFilterTexture(c.width,c.height,e.resolution),l.filterFrame=c.filterFrame),s[_].apply(this,c,l,Ri.CLEAR,e);var d=c;c=l,l=d}s[_].apply(this,c,u.renderTexture,Ri.BLEND,e),_>1&&e.multisample>1&&this.returnFilterTexture(e.renderTexture),this.returnFilterTexture(c),this.returnFilterTexture(l)}e.clear(),this.statePool.push(e)},r.prototype.bindAndClear=function(t,e){e===void 0&&(e=Ri.CLEAR);var s=this.renderer,i=s.renderTexture,n=s.state;if(t===this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?this.renderer.projection.transform=this.activeState.transform:this.renderer.projection.transform=null,t&&t.filterFrame){var a=this.tempRect;a.x=0,a.y=0,a.width=t.filterFrame.width,a.height=t.filterFrame.height,i.bind(t,t.filterFrame,a)}else t!==this.defaultFilterStack[this.defaultFilterStack.length-1].renderTexture?i.bind(t):this.renderer.renderTexture.bind(t,this.activeState.bindingSourceFrame,this.activeState.bindingDestinationFrame);var o=n.stateId&1||this.forceClear;(e===Ri.CLEAR||e===Ri.BLIT&&o)&&this.renderer.framebuffer.clear(0,0,0,0)},r.prototype.applyFilter=function(t,e,s,i){var n=this.renderer;n.state.set(t.state),this.bindAndClear(s,i),t.uniforms.uSampler=e,t.uniforms.filterGlobals=this.globalUniforms,n.shader.bind(t),t.legacy=!!t.program.attributeData.aTextureCoord,t.legacy?(this.quadUv.map(e._frame,e.filterFrame),n.geometry.bind(this.quadUv),n.geometry.draw(lr.TRIANGLES)):(n.geometry.bind(this.quad),n.geometry.draw(lr.TRIANGLE_STRIP))},r.prototype.calculateSpriteMatrix=function(t,e){var s=this.activeState,i=s.sourceFrame,n=s.destinationFrame,a=e._texture.orig,o=t.set(n.width,0,0,n.height,i.x,i.y),h=e.worldTransform.copyTo(Vt.TEMP_MATRIX);return h.invert(),o.prepend(h),o.scale(1/a.width,1/a.height),o.translate(e.anchor.x,e.anchor.y),o},r.prototype.destroy=function(){this.renderer=null,this.texturePool.clear(!1)},r.prototype.getOptimalFilterTexture=function(t,e,s,i){return s===void 0&&(s=1),i===void 0&&(i=ne.NONE),this.texturePool.getOptimalTexture(t,e,s,i)},r.prototype.getFilterTexture=function(t,e,s){if(typeof t=="number"){var i=t;t=e,e=i}t=t||this.activeState.renderTexture;var n=this.texturePool.getOptimalTexture(t.width,t.height,e||t.resolution,s||ne.NONE);return n.filterFrame=t.filterFrame,n},r.prototype.returnFilterTexture=function(t){this.texturePool.returnTexture(t)},r.prototype.emptyPool=function(){this.texturePool.clear(!0)},r.prototype.resize=function(){this.texturePool.setScreenSize(this.renderer.view)},r.prototype.transformAABB=function(t,e){var s=pu[0],i=pu[1],n=pu[2],a=pu[3];s.set(e.left,e.top),i.set(e.left,e.bottom),n.set(e.right,e.top),a.set(e.right,e.bottom),t.apply(s,s),t.apply(i,i),t.apply(n,n),t.apply(a,a);var o=Math.min(s.x,i.x,n.x,a.x),h=Math.min(s.y,i.y,n.y,a.y),u=Math.max(s.x,i.x,n.x,a.x),c=Math.max(s.y,i.y,n.y,a.y);e.x=o,e.y=h,e.width=u-o,e.height=c-h},r.prototype.roundFrame=function(t,e,s,i,n){if(!(t.width<=0||t.height<=0||s.width<=0||s.height<=0)){if(n){var a=n.a,o=n.b,h=n.c,u=n.d;if((Math.abs(o)>1e-4||Math.abs(h)>1e-4)&&(Math.abs(a)>1e-4||Math.abs(u)>1e-4))return}n=n?lc.copyFrom(n):lc.identity(),n.translate(-s.x,-s.y).scale(i.width/s.width,i.height/s.height).translate(i.x,i.y),this.transformAABB(n,t),t.ceil(e),this.transformAABB(n.invert(),t)}},r}(),t_=function(){function r(t){this.renderer=t}return r.prototype.flush=function(){},r.prototype.destroy=function(){this.renderer=null},r.prototype.start=function(){},r.prototype.stop=function(){this.flush()},r.prototype.render=function(t){},r}(),jD=function(){function r(t){this.renderer=t,this.emptyRenderer=new t_(t),this.currentRenderer=this.emptyRenderer}return r.prototype.setObjectRenderer=function(t){this.currentRenderer!==t&&(this.currentRenderer.stop(),this.currentRenderer=t,this.currentRenderer.start())},r.prototype.flush=function(){this.setObjectRenderer(this.emptyRenderer)},r.prototype.reset=function(){this.setObjectRenderer(this.emptyRenderer)},r.prototype.copyBoundTextures=function(t,e){for(var s=this.renderer.texture.boundTextures,i=e-1;i>=0;--i)t[i]=s[i]||null,t[i]&&(t[i]._batchLocation=i)},r.prototype.boundArray=function(t,e,s,i){for(var n=t.elements,a=t.ids,o=t.count,h=0,u=0;u<o;u++){var c=n[u],l=c._batchLocation;if(l>=0&&l<i&&e[l]===c){a[u]=l;continue}for(;h<i;){var _=e[h];if(_&&_._batchEnabled===s&&_._batchLocation===h){h++;continue}a[u]=h,c._batchLocation=h,e[h]=c;break}}},r.prototype.destroy=function(){this.renderer=null},r}(),Hp=0,zD=function(){function r(t){this.renderer=t,this.webGLVersion=1,this.extensions={},this.supports={uint32Indices:!1},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}return Object.defineProperty(r.prototype,"isLost",{get:function(){return!this.gl||this.gl.isContextLost()},enumerable:!1,configurable:!0}),r.prototype.contextChange=function(t){this.gl=t,this.renderer.gl=t,this.renderer.CONTEXT_UID=Hp++},r.prototype.initFromContext=function(t){this.gl=t,this.validateContext(t),this.renderer.gl=t,this.renderer.CONTEXT_UID=Hp++,this.renderer.runners.contextChange.emit(t)},r.prototype.initFromOptions=function(t){var e=this.createContext(this.renderer.view,t);this.initFromContext(e)},r.prototype.createContext=function(t,e){var s;if(Z.PREFER_ENV>=ai.WEBGL2&&(s=t.getContext("webgl2",e)),s)this.webGLVersion=2;else if(this.webGLVersion=1,s=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),!s)throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=s,this.getExtensions(),this.gl},r.prototype.getExtensions=function(){var t=this.gl,e={loseContext:t.getExtension("WEBGL_lose_context"),anisotropicFiltering:t.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),s3tc:t.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:t.getExtension("WEBGL_compressed_texture_etc"),etc1:t.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:t.getExtension("WEBGL_compressed_texture_atc"),astc:t.getExtension("WEBGL_compressed_texture_astc")};this.webGLVersion===1?Object.assign(this.extensions,e,{drawBuffers:t.getExtension("WEBGL_draw_buffers"),depthTexture:t.getExtension("WEBGL_depth_texture"),vertexArrayObject:t.getExtension("OES_vertex_array_object")||t.getExtension("MOZ_OES_vertex_array_object")||t.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:t.getExtension("OES_element_index_uint"),floatTexture:t.getExtension("OES_texture_float"),floatTextureLinear:t.getExtension("OES_texture_float_linear"),textureHalfFloat:t.getExtension("OES_texture_half_float"),textureHalfFloatLinear:t.getExtension("OES_texture_half_float_linear")}):this.webGLVersion===2&&Object.assign(this.extensions,e,{colorBufferFloat:t.getExtension("EXT_color_buffer_float")})},r.prototype.handleContextLost=function(t){var e=this;t.preventDefault(),setTimeout(function(){e.gl.isContextLost()&&e.extensions.loseContext&&e.extensions.loseContext.restoreContext()},0)},r.prototype.handleContextRestored=function(){this.renderer.runners.contextChange.emit(this.gl)},r.prototype.destroy=function(){var t=this.renderer.view;this.renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},r.prototype.postrender=function(){this.renderer.renderingToScreen&&this.gl.flush()},r.prototype.validateContext=function(t){var e=t.getContextAttributes(),s="WebGL2RenderingContext"in globalThis&&t instanceof globalThis.WebGL2RenderingContext;s&&(this.webGLVersion=2),e&&!e.stencil&&console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly");var i=s||!!t.getExtension("OES_element_index_uint");this.supports.uint32Indices=i,i||console.warn("Provided WebGL context does not support 32 index buffer, complex graphics may not render correctly")},r}(),YD=function(){function r(t){this.framebuffer=t,this.stencil=null,this.dirtyId=-1,this.dirtyFormat=-1,this.dirtySize=-1,this.multisample=ne.NONE,this.msaaBuffer=null,this.blitFramebuffer=null,this.mipLevel=0}return r}(),WD=new it,XD=function(){function r(t){this.renderer=t,this.managedFramebuffers=[],this.unknownFramebuffer=new Ad(10,10),this.msaaSamples=null}return r.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new it,this.hasMRT=!0,this.writeDepthTexture=!0,this.renderer.context.webGLVersion===1){var e=this.renderer.context.extensions.drawBuffers,s=this.renderer.context.extensions.depthTexture;Z.PREFER_ENV===ai.WEBGL_LEGACY&&(e=null,s=null),e?t.drawBuffers=function(i){return e.drawBuffersWEBGL(i)}:(this.hasMRT=!1,t.drawBuffers=function(){}),s||(this.writeDepthTexture=!1)}else this.msaaSamples=t.getInternalformatParameter(t.RENDERBUFFER,t.RGBA8,t.SAMPLES)},r.prototype.bind=function(t,e,s){s===void 0&&(s=0);var i=this.gl;if(t){var n=t.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(t);this.current!==t&&(this.current=t,i.bindFramebuffer(i.FRAMEBUFFER,n.framebuffer)),n.mipLevel!==s&&(t.dirtyId++,t.dirtyFormat++,n.mipLevel=s),n.dirtyId!==t.dirtyId&&(n.dirtyId=t.dirtyId,n.dirtyFormat!==t.dirtyFormat?(n.dirtyFormat=t.dirtyFormat,n.dirtySize=t.dirtySize,this.updateFramebuffer(t,s)):n.dirtySize!==t.dirtySize&&(n.dirtySize=t.dirtySize,this.resizeFramebuffer(t)));for(var a=0;a<t.colorTextures.length;a++){var o=t.colorTextures[a];this.renderer.texture.unbind(o.parentTextureArray||o)}if(t.depthTexture&&this.renderer.texture.unbind(t.depthTexture),e){var h=e.width>>s,u=e.height>>s,c=h/e.width;this.setViewport(e.x*c,e.y*c,h,u)}else{var h=t.width>>s,u=t.height>>s;this.setViewport(0,0,h,u)}}else this.current&&(this.current=null,i.bindFramebuffer(i.FRAMEBUFFER,null)),e?this.setViewport(e.x,e.y,e.width,e.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},r.prototype.setViewport=function(t,e,s,i){var n=this.viewport;t=Math.round(t),e=Math.round(e),s=Math.round(s),i=Math.round(i),(n.width!==s||n.height!==i||n.x!==t||n.y!==e)&&(n.x=t,n.y=e,n.width=s,n.height=i,this.gl.viewport(t,e,s,i))},Object.defineProperty(r.prototype,"size",{get:function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},enumerable:!1,configurable:!0}),r.prototype.clear=function(t,e,s,i,n){n===void 0&&(n=ul.COLOR|ul.DEPTH);var a=this.gl;a.clearColor(t,e,s,i),a.clear(n)},r.prototype.initFramebuffer=function(t){var e=this.gl,s=new YD(e.createFramebuffer());return s.multisample=this.detectSamples(t.multisample),t.glFramebuffers[this.CONTEXT_UID]=s,this.managedFramebuffers.push(t),t.disposeRunner.add(this),s},r.prototype.resizeFramebuffer=function(t){var e=this.gl,s=t.glFramebuffers[this.CONTEXT_UID];s.msaaBuffer&&(e.bindRenderbuffer(e.RENDERBUFFER,s.msaaBuffer),e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,e.RGBA8,t.width,t.height)),s.stencil&&(e.bindRenderbuffer(e.RENDERBUFFER,s.stencil),s.msaaBuffer?e.renderbufferStorageMultisample(e.RENDERBUFFER,s.multisample,e.DEPTH24_STENCIL8,t.width,t.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,t.width,t.height));var i=t.colorTextures,n=i.length;e.drawBuffers||(n=Math.min(n,1));for(var a=0;a<n;a++){var o=i[a],h=o.parentTextureArray||o;this.renderer.texture.bind(h,0)}t.depthTexture&&this.writeDepthTexture&&this.renderer.texture.bind(t.depthTexture,0)},r.prototype.updateFramebuffer=function(t,e){var s=this.gl,i=t.glFramebuffers[this.CONTEXT_UID],n=t.colorTextures,a=n.length;s.drawBuffers||(a=Math.min(a,1)),i.multisample>1&&this.canMultisampleFramebuffer(t)?(i.msaaBuffer=i.msaaBuffer||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,i.msaaBuffer),s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,s.RGBA8,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0,s.RENDERBUFFER,i.msaaBuffer)):i.msaaBuffer&&(s.deleteRenderbuffer(i.msaaBuffer),i.msaaBuffer=null,i.blitFramebuffer&&(i.blitFramebuffer.dispose(),i.blitFramebuffer=null));for(var o=[],h=0;h<a;h++){var u=n[h],c=u.parentTextureArray||u;this.renderer.texture.bind(c,0),!(h===0&&i.msaaBuffer)&&(s.framebufferTexture2D(s.FRAMEBUFFER,s.COLOR_ATTACHMENT0+h,u.target,c._glTextures[this.CONTEXT_UID].texture,e),o.push(s.COLOR_ATTACHMENT0+h))}if(o.length>1&&s.drawBuffers(o),t.depthTexture){var l=this.writeDepthTexture;if(l){var _=t.depthTexture;this.renderer.texture.bind(_,0),s.framebufferTexture2D(s.FRAMEBUFFER,s.DEPTH_ATTACHMENT,s.TEXTURE_2D,_._glTextures[this.CONTEXT_UID].texture,e)}}(t.stencil||t.depth)&&!(t.depthTexture&&this.writeDepthTexture)?(i.stencil=i.stencil||s.createRenderbuffer(),s.bindRenderbuffer(s.RENDERBUFFER,i.stencil),i.msaaBuffer?s.renderbufferStorageMultisample(s.RENDERBUFFER,i.multisample,s.DEPTH24_STENCIL8,t.width,t.height):s.renderbufferStorage(s.RENDERBUFFER,s.DEPTH_STENCIL,t.width,t.height),s.framebufferRenderbuffer(s.FRAMEBUFFER,s.DEPTH_STENCIL_ATTACHMENT,s.RENDERBUFFER,i.stencil)):i.stencil&&(s.deleteRenderbuffer(i.stencil),i.stencil=null)},r.prototype.canMultisampleFramebuffer=function(t){return this.renderer.context.webGLVersion!==1&&t.colorTextures.length<=1&&!t.depthTexture},r.prototype.detectSamples=function(t){var e=this.msaaSamples,s=ne.NONE;if(t<=1||e===null)return s;for(var i=0;i<e.length;i++)if(e[i]<=t){s=e[i];break}return s===1&&(s=ne.NONE),s},r.prototype.blit=function(t,e,s){var i=this,n=i.current,a=i.renderer,o=i.gl,h=i.CONTEXT_UID;if(a.context.webGLVersion===2&&n){var u=n.glFramebuffers[h];if(u){if(!t){if(!u.msaaBuffer)return;var c=n.colorTextures[0];if(!c)return;u.blitFramebuffer||(u.blitFramebuffer=new Ad(n.width,n.height),u.blitFramebuffer.addColorTexture(0,c)),t=u.blitFramebuffer,t.colorTextures[0]!==c&&(t.colorTextures[0]=c,t.dirtyId++,t.dirtyFormat++),(t.width!==n.width||t.height!==n.height)&&(t.width=n.width,t.height=n.height,t.dirtyId++,t.dirtySize++)}e||(e=WD,e.width=n.width,e.height=n.height),s||(s=e);var l=e.width===s.width&&e.height===s.height;this.bind(t),o.bindFramebuffer(o.READ_FRAMEBUFFER,u.framebuffer),o.blitFramebuffer(e.left,e.top,e.right,e.bottom,s.left,s.top,s.right,s.bottom,o.COLOR_BUFFER_BIT,l?o.NEAREST:o.LINEAR)}}},r.prototype.disposeFramebuffer=function(t,e){var s=t.glFramebuffers[this.CONTEXT_UID],i=this.gl;if(s){delete t.glFramebuffers[this.CONTEXT_UID];var n=this.managedFramebuffers.indexOf(t);n>=0&&this.managedFramebuffers.splice(n,1),t.disposeRunner.remove(this),e||(i.deleteFramebuffer(s.framebuffer),s.msaaBuffer&&i.deleteRenderbuffer(s.msaaBuffer),s.stencil&&i.deleteRenderbuffer(s.stencil)),s.blitFramebuffer&&s.blitFramebuffer.dispose()}},r.prototype.disposeAll=function(t){var e=this.managedFramebuffers;this.managedFramebuffers=[];for(var s=0;s<e.length;s++)this.disposeFramebuffer(e[s],t)},r.prototype.forceStencil=function(){var t=this.current;if(t){var e=t.glFramebuffers[this.CONTEXT_UID];if(!(!e||e.stencil)){t.stencil=!0;var s=t.width,i=t.height,n=this.gl,a=n.createRenderbuffer();n.bindRenderbuffer(n.RENDERBUFFER,a),e.msaaBuffer?n.renderbufferStorageMultisample(n.RENDERBUFFER,e.multisample,n.DEPTH24_STENCIL8,s,i):n.renderbufferStorage(n.RENDERBUFFER,n.DEPTH_STENCIL,s,i),e.stencil=a,n.framebufferRenderbuffer(n.FRAMEBUFFER,n.DEPTH_STENCIL_ATTACHMENT,n.RENDERBUFFER,a)}}},r.prototype.reset=function(){this.current=this.unknownFramebuffer,this.viewport=new it},r.prototype.destroy=function(){this.renderer=null},r}(),_c={5126:4,5123:2,5121:1},KD=function(){function r(t){this.renderer=t,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.managedGeometries={}}return r.prototype.contextChange=function(){this.disposeAll(!0);var t=this.gl=this.renderer.gl,e=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,e.webGLVersion!==2){var s=this.renderer.context.extensions.vertexArrayObject;Z.PREFER_ENV===ai.WEBGL_LEGACY&&(s=null),s?(t.createVertexArray=function(){return s.createVertexArrayOES()},t.bindVertexArray=function(n){return s.bindVertexArrayOES(n)},t.deleteVertexArray=function(n){return s.deleteVertexArrayOES(n)}):(this.hasVao=!1,t.createVertexArray=function(){return null},t.bindVertexArray=function(){return null},t.deleteVertexArray=function(){return null})}if(e.webGLVersion!==2){var i=t.getExtension("ANGLE_instanced_arrays");i?(t.vertexAttribDivisor=function(n,a){return i.vertexAttribDivisorANGLE(n,a)},t.drawElementsInstanced=function(n,a,o,h,u){return i.drawElementsInstancedANGLE(n,a,o,h,u)},t.drawArraysInstanced=function(n,a,o,h){return i.drawArraysInstancedANGLE(n,a,o,h)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=e.webGLVersion===2||!!e.extensions.uint32ElementIndex},r.prototype.bind=function(t,e){e=e||this.renderer.shader.shader;var s=this.gl,i=t.glVertexArrayObjects[this.CONTEXT_UID],n=!1;i||(this.managedGeometries[t.id]=t,t.disposeRunner.add(this),t.glVertexArrayObjects[this.CONTEXT_UID]=i={},n=!0);var a=i[e.program.id]||this.initGeometryVao(t,e,n);this._activeGeometry=t,this._activeVao!==a&&(this._activeVao=a,this.hasVao?s.bindVertexArray(a):this.activateVao(t,e.program)),this.updateBuffers()},r.prototype.reset=function(){this.unbind()},r.prototype.updateBuffers=function(){for(var t=this._activeGeometry,e=this.renderer.buffer,s=0;s<t.buffers.length;s++){var i=t.buffers[s];e.update(i)}},r.prototype.checkCompatibility=function(t,e){var s=t.attributes,i=e.attributeData;for(var n in i)if(!s[n])throw new Error('shader and geometry incompatible, geometry missing the "'+n+'" attribute')},r.prototype.getSignature=function(t,e){var s=t.attributes,i=e.attributeData,n=["g",t.id];for(var a in s)i[a]&&n.push(a,i[a].location);return n.join("-")},r.prototype.initGeometryVao=function(t,e,s){s===void 0&&(s=!0);var i=this.gl,n=this.CONTEXT_UID,a=this.renderer.buffer,o=e.program;o.glPrograms[n]||this.renderer.shader.generateProgram(e),this.checkCompatibility(t,o);var h=this.getSignature(t,o),u=t.glVertexArrayObjects[this.CONTEXT_UID],c=u[h];if(c)return u[o.id]=c,c;var l=t.buffers,_=t.attributes,d={},f={};for(var m in l)d[m]=0,f[m]=0;for(var m in _)!_[m].size&&o.attributeData[m]?_[m].size=o.attributeData[m].size:_[m].size||console.warn("PIXI Geometry attribute '"+m+"' size cannot be determined (likely the bound shader does not have the attribute)"),d[_[m].buffer]+=_[m].size*_c[_[m].type];for(var m in _){var p=_[m],T=p.size;p.stride===void 0&&(d[p.buffer]===T*_c[p.type]?p.stride=0:p.stride=d[p.buffer]),p.start===void 0&&(p.start=f[p.buffer],f[p.buffer]+=T*_c[p.type])}c=i.createVertexArray(),i.bindVertexArray(c);for(var v=0;v<l.length;v++){var O=l[v];a.bind(O),s&&O._glBuffers[n].refCount++}return this.activateVao(t,o),this._activeVao=c,u[o.id]=c,u[h]=c,c},r.prototype.disposeGeometry=function(t,e){var s;if(this.managedGeometries[t.id]){delete this.managedGeometries[t.id];var i=t.glVertexArrayObjects[this.CONTEXT_UID],n=this.gl,a=t.buffers,o=(s=this.renderer)===null||s===void 0?void 0:s.buffer;if(t.disposeRunner.remove(this),!!i){if(o)for(var h=0;h<a.length;h++){var u=a[h]._glBuffers[this.CONTEXT_UID];u&&(u.refCount--,u.refCount===0&&!e&&o.dispose(a[h],e))}if(!e){for(var c in i)if(c[0]==="g"){var l=i[c];this._activeVao===l&&this.unbind(),n.deleteVertexArray(l)}}delete t.glVertexArrayObjects[this.CONTEXT_UID]}}},r.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedGeometries),s=0;s<e.length;s++)this.disposeGeometry(this.managedGeometries[e[s]],t)},r.prototype.activateVao=function(t,e){var s=this.gl,i=this.CONTEXT_UID,n=this.renderer.buffer,a=t.buffers,o=t.attributes;t.indexBuffer&&n.bind(t.indexBuffer);var h=null;for(var u in o){var c=o[u],l=a[c.buffer],_=l._glBuffers[i];if(e.attributeData[u]){h!==_&&(n.bind(l),h=_);var d=e.attributeData[u].location;if(s.enableVertexAttribArray(d),s.vertexAttribPointer(d,c.size,c.type||s.FLOAT,c.normalized,c.stride,c.start),c.instance)if(this.hasInstance)s.vertexAttribDivisor(d,1);else throw new Error("geometry error, GPU Instancing is not supported on this device")}}},r.prototype.draw=function(t,e,s,i){var n=this.gl,a=this._activeGeometry;if(a.indexBuffer){var o=a.indexBuffer.data.BYTES_PER_ELEMENT,h=o===2?n.UNSIGNED_SHORT:n.UNSIGNED_INT;o===2||o===4&&this.canUseUInt32ElementIndex?a.instanced?n.drawElementsInstanced(t,e||a.indexBuffer.data.length,h,(s||0)*o,i||1):n.drawElements(t,e||a.indexBuffer.data.length,h,(s||0)*o):console.warn("unsupported index buffer type: uint32")}else a.instanced?n.drawArraysInstanced(t,s,e||a.getSize(),i||1):n.drawArrays(t,s,e||a.getSize());return this},r.prototype.unbind=function(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},r.prototype.destroy=function(){this.renderer=null},r}(),qD=function(){function r(t){t===void 0&&(t=null),this.type=Ie.NONE,this.autoDetect=!0,this.maskObject=t||null,this.pooled=!1,this.isMaskData=!0,this.resolution=null,this.multisample=Z.FILTER_MULTISAMPLE,this.enabled=!0,this.colorMask=15,this._filters=null,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._scissorRectLocal=null,this._colorMask=15,this._target=null}return Object.defineProperty(r.prototype,"filter",{get:function(){return this._filters?this._filters[0]:null},set:function(t){t?this._filters?this._filters[0]=t:this._filters=[t]:this._filters=null},enumerable:!1,configurable:!0}),r.prototype.reset=function(){this.pooled&&(this.maskObject=null,this.type=Ie.NONE,this.autoDetect=!0),this._target=null,this._scissorRectLocal=null},r.prototype.copyCountersOrReset=function(t){t?(this._stencilCounter=t._stencilCounter,this._scissorCounter=t._scissorCounter,this._scissorRect=t._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)},r}();function Vp(r,t,e){var s=r.createShader(t);return r.shaderSource(s,e),r.compileShader(s),s}function kp(r,t){var e=r.getShaderSource(t).split(`
`).map(function(u,c){return c+": "+u}),s=r.getShaderInfoLog(t),i=s.split(`
`),n={},a=i.map(function(u){return parseFloat(u.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))}).filter(function(u){return u&&!n[u]?(n[u]=!0,!0):!1}),o=[""];a.forEach(function(u){e[u-1]="%c"+e[u-1]+"%c",o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});var h=e.join(`
`);o[0]=h,console.error(s),console.groupCollapsed("click to view full shader code"),console.warn.apply(console,o),console.groupEnd()}function QD(r,t,e,s){r.getProgramParameter(t,r.LINK_STATUS)||(r.getShaderParameter(e,r.COMPILE_STATUS)||kp(r,e),r.getShaderParameter(s,r.COMPILE_STATUS)||kp(r,s),console.error("PixiJS Error: Could not initialize shader."),r.getProgramInfoLog(t)!==""&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",r.getProgramInfoLog(t)))}function cc(r){for(var t=new Array(r),e=0;e<t.length;e++)t[e]=!1;return t}function lT(r,t){switch(r){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return cc(2*t);case"bvec3":return cc(3*t);case"bvec4":return cc(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}var _T={},co=_T;function ZD(){if(co===_T||co&&co.isContextLost()){var r=Z.ADAPTER.createCanvas(),t=void 0;Z.PREFER_ENV>=ai.WEBGL2&&(t=r.getContext("webgl2",{})),t||(t=r.getContext("webgl",{})||r.getContext("experimental-webgl",{}),t?t.getExtension("WEBGL_draw_buffers"):t=null),co=t}return co}var mu;function JD(){if(!mu){mu=ms.MEDIUM;var r=ZD();if(r&&r.getShaderPrecisionFormat){var t=r.getShaderPrecisionFormat(r.FRAGMENT_SHADER,r.HIGH_FLOAT);mu=t.precision?ms.HIGH:ms.MEDIUM}}return mu}function jp(r,t,e){if(r.substring(0,9)!=="precision"){var s=t;return t===ms.HIGH&&e!==ms.HIGH&&(s=ms.MEDIUM),"precision "+s+` float;
`+r}else if(e!==ms.HIGH&&r.substring(0,15)==="precision highp")return r.replace("precision highp","precision mediump");return r}var $D={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,uint:1,uvec2:2,uvec3:3,uvec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function cT(r){return $D[r]}var Iu=null,zp={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"};function dT(r,t){if(!Iu){var e=Object.keys(zp);Iu={};for(var s=0;s<e.length;++s){var i=e[s];Iu[r[i]]=zp[i]}}return Iu[t]}var Ca=[{test:function(r){return r.type==="float"&&r.size===1&&!r.isArray},code:function(r){return`
            if(uv["`+r+'"] !== ud["'+r+`"].value)
            {
                ud["`+r+'"].value = uv["'+r+`"]
                gl.uniform1f(ud["`+r+'"].location, uv["'+r+`"])
            }
            `}},{test:function(r,t){return(r.type==="sampler2D"||r.type==="samplerCube"||r.type==="sampler2DArray")&&r.size===1&&!r.isArray&&(t==null||t.castToBaseTexture!==void 0)},code:function(r){return`t = syncData.textureCount++;

            renderer.texture.bind(uv["`+r+`"], t);

            if(ud["`+r+`"].value !== t)
            {
                ud["`+r+`"].value = t;
                gl.uniform1i(ud["`+r+`"].location, t);
; // eslint-disable-line max-len
            }`}},{test:function(r,t){return r.type==="mat3"&&r.size===1&&!r.isArray&&t.a!==void 0},code:function(r){return`
            gl.uniformMatrix3fv(ud["`+r+'"].location, false, uv["'+r+`"].toArray(true));
            `},codeUbo:function(r){return`
                var `+r+"_matrix = uv."+r+`.toArray(true);

                data[offset] = `+r+`_matrix[0];
                data[offset+1] = `+r+`_matrix[1];
                data[offset+2] = `+r+`_matrix[2];
        
                data[offset + 4] = `+r+`_matrix[3];
                data[offset + 5] = `+r+`_matrix[4];
                data[offset + 6] = `+r+`_matrix[5];
        
                data[offset + 8] = `+r+`_matrix[6];
                data[offset + 9] = `+r+`_matrix[7];
                data[offset + 10] = `+r+`_matrix[8];
            `}},{test:function(r,t){return r.type==="vec2"&&r.size===1&&!r.isArray&&t.x!==void 0},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v.x || cv[1] !== v.y)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    gl.uniform2f(ud["`+r+`"].location, v.x, v.y);
                }`},codeUbo:function(r){return`
                v = uv.`+r+`;

                data[offset] = v.x;
                data[offset+1] = v.y;
            `}},{test:function(r){return r.type==="vec2"&&r.size===1&&!r.isArray},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    gl.uniform2f(ud["`+r+`"].location, v[0], v[1]);
                }
            `}},{test:function(r,t){return r.type==="vec4"&&r.size===1&&!r.isArray&&t.width!==void 0},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)
                {
                    cv[0] = v.x;
                    cv[1] = v.y;
                    cv[2] = v.width;
                    cv[3] = v.height;
                    gl.uniform4f(ud["`+r+`"].location, v.x, v.y, v.width, v.height)
                }`},codeUbo:function(r){return`
                    v = uv.`+r+`;

                    data[offset] = v.x;
                    data[offset+1] = v.y;
                    data[offset+2] = v.width;
                    data[offset+3] = v.height;
                `}},{test:function(r){return r.type==="vec4"&&r.size===1&&!r.isArray},code:function(r){return`
                cv = ud["`+r+`"].value;
                v = uv["`+r+`"];

                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
                {
                    cv[0] = v[0];
                    cv[1] = v[1];
                    cv[2] = v[2];
                    cv[3] = v[3];

                    gl.uniform4f(ud["`+r+`"].location, v[0], v[1], v[2], v[3])
                }`}}],tL={float:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1f(location, v);
    }`,vec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2f(location, v[0], v[1])
    }`,vec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3f(location, v[0], v[1], v[2])
    }`,vec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4f(location, v[0], v[1], v[2], v[3]);
    }`,int:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,ivec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,ivec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,ivec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,uint:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1ui(location, v);
    }`,uvec2:`
    if (cv[0] !== v[0] || cv[1] !== v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2ui(location, v[0], v[1]);
    }`,uvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3ui(location, v[0], v[1], v[2]);
    }`,uvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4ui(location, v[0], v[1], v[2], v[3]);
    }`,bool:`
    if (cv !== v)
    {
        cu.value = v;
        gl.uniform1i(location, v);
    }`,bvec2:`
    if (cv[0] != v[0] || cv[1] != v[1])
    {
        cv[0] = v[0];
        cv[1] = v[1];

        gl.uniform2i(location, v[0], v[1]);
    }`,bvec3:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];

        gl.uniform3i(location, v[0], v[1], v[2]);
    }`,bvec4:`
    if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])
    {
        cv[0] = v[0];
        cv[1] = v[1];
        cv[2] = v[2];
        cv[3] = v[3];

        gl.uniform4i(location, v[0], v[1], v[2], v[3]);
    }`,mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,samplerCube:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`,sampler2DArray:`
    if (cv !== v)
    {
        cu.value = v;

        gl.uniform1i(location, v);
    }`},eL={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",uint:"gl.uniform1uiv(location, v)",uvec2:"gl.uniform2uiv(location, v)",uvec3:"gl.uniform3uiv(location, v)",uvec4:"gl.uniform4uiv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};function sL(r,t){var e,s=[`
        var v = null;
        var cv = null;
        var cu = null;
        var t = 0;
        var gl = renderer.gl;
    `];for(var i in r.uniforms){var n=t[i];if(!n){!((e=r.uniforms[i])===null||e===void 0)&&e.group&&(r.uniforms[i].ubo?s.push(`
                        renderer.shader.syncUniformBufferGroup(uv.`+i+", '"+i+`');
                    `):s.push(`
                        renderer.shader.syncUniformGroup(uv.`+i+`, syncData);
                    `));continue}for(var a=r.uniforms[i],o=!1,h=0;h<Ca.length;h++)if(Ca[h].test(n,a)){s.push(Ca[h].code(i,a)),o=!0;break}if(!o){var u=n.size===1&&!n.isArray?tL:eL,c=u[n.type].replace("location",'ud["'+i+'"].location');s.push(`
            cu = ud["`+i+`"];
            cv = cu.value;
            v = uv["`+i+`"];
            `+c+";")}}return new Function("ud","uv","renderer","syncData",s.join(`
`))}var rL=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join(`
`);function iL(r){for(var t="",e=0;e<r;++e)e>0&&(t+=`
else `),e<r-1&&(t+="if(test == "+e+".0){}");return t}function nL(r,t){if(r===0)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var e=t.createShader(t.FRAGMENT_SHADER);;){var s=rL.replace(/%forloop%/gi,iL(r));if(t.shaderSource(e,s),t.compileShader(e),!t.getShaderParameter(e,t.COMPILE_STATUS))r=r/2|0;else break}return r}var fo;function aL(){if(typeof fo=="boolean")return fo;try{var r=new Function("param1","param2","param3","return param1[param2] === param3;");fo=r({a:"b"},"a","b")===!0}catch{fo=!1}return fo}var oL=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor *= texture2D(uSampler, vTextureCoord);
}`,hL=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void){
   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vTextureCoord = aTextureCoord;
}
`,uL=0,Tu={},e_=function(){function r(t,e,s){s===void 0&&(s="pixi-shader"),this.id=uL++,this.vertexSrc=t||r.defaultVertexSrc,this.fragmentSrc=e||r.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),this.vertexSrc.substring(0,8)!=="#version"&&(s=s.replace(/\s+/g,"-"),Tu[s]?(Tu[s]++,s+="-"+Tu[s]):Tu[s]=1,this.vertexSrc="#define SHADER_NAME "+s+`
`+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+s+`
`+this.fragmentSrc,this.vertexSrc=jp(this.vertexSrc,Z.PRECISION_VERTEX,ms.HIGH),this.fragmentSrc=jp(this.fragmentSrc,Z.PRECISION_FRAGMENT,JD())),this.glPrograms={},this.syncUniforms=null}return Object.defineProperty(r,"defaultVertexSrc",{get:function(){return hL},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentSrc",{get:function(){return oL},enumerable:!1,configurable:!0}),r.from=function(t,e,s){var i=t+e,n=Up[i];return n||(Up[i]=n=new r(t,e,s)),n},r}(),Cn=function(){function r(t,e){this.uniformBindCount=0,this.program=t,e?e instanceof Mn?this.uniformGroup=e:this.uniformGroup=new Mn(e):this.uniformGroup=new Mn({}),this.disposeRunner=new je("disposeShader")}return r.prototype.checkUniformExists=function(t,e){if(e.uniforms[t])return!0;for(var s in e.uniforms){var i=e.uniforms[s];if(i.group&&this.checkUniformExists(t,i))return!0}return!1},r.prototype.destroy=function(){this.uniformGroup=null,this.disposeRunner.emit(this),this.disposeRunner.destroy()},Object.defineProperty(r.prototype,"uniforms",{get:function(){return this.uniformGroup.uniforms},enumerable:!1,configurable:!0}),r.from=function(t,e,s){var i=e_.from(t,e);return new r(i,s)},r}(),dc=0,fc=1,gc=2,Ec=3,pc=4,mc=5,yh=function(){function r(){this.data=0,this.blendMode=tt.NORMAL,this.polygonOffset=0,this.blend=!0,this.depthMask=!0}return Object.defineProperty(r.prototype,"blend",{get:function(){return!!(this.data&1<<dc)},set:function(t){!!(this.data&1<<dc)!==t&&(this.data^=1<<dc)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"offsets",{get:function(){return!!(this.data&1<<fc)},set:function(t){!!(this.data&1<<fc)!==t&&(this.data^=1<<fc)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"culling",{get:function(){return!!(this.data&1<<gc)},set:function(t){!!(this.data&1<<gc)!==t&&(this.data^=1<<gc)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"depthTest",{get:function(){return!!(this.data&1<<Ec)},set:function(t){!!(this.data&1<<Ec)!==t&&(this.data^=1<<Ec)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"depthMask",{get:function(){return!!(this.data&1<<mc)},set:function(t){!!(this.data&1<<mc)!==t&&(this.data^=1<<mc)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"clockwiseFrontFace",{get:function(){return!!(this.data&1<<pc)},set:function(t){!!(this.data&1<<pc)!==t&&(this.data^=1<<pc)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"blendMode",{get:function(){return this._blendMode},set:function(t){this.blend=t!==tt.NONE,this._blendMode=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"polygonOffset",{get:function(){return this._polygonOffset},set:function(t){this.offsets=!!t,this._polygonOffset=t},enumerable:!1,configurable:!0}),r.prototype.toString=function(){return"[@pixi/core:State "+("blendMode="+this.blendMode+" ")+("clockwiseFrontFace="+this.clockwiseFrontFace+" ")+("culling="+this.culling+" ")+("depthMask="+this.depthMask+" ")+("polygonOffset="+this.polygonOffset)+"]"},r.for2d=function(){var t=new r;return t.depthTest=!1,t.blend=!0,t},r}(),lL=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;

void main(void){
   gl_FragColor = texture2D(uSampler, vTextureCoord);
}
`,_L=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,Wa=function(r){$t(t,r);function t(e,s,i){var n=this,a=e_.from(e||t.defaultVertexSrc,s||t.defaultFragmentSrc);return n=r.call(this,a,i)||this,n.padding=0,n.resolution=Z.FILTER_RESOLUTION,n.multisample=Z.FILTER_MULTISAMPLE,n.enabled=!0,n.autoFit=!0,n.state=new yh,n}return t.prototype.apply=function(e,s,i,n,a){e.applyFilter(this,s,i,n)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._resolution=e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultVertexSrc",{get:function(){return _L},enumerable:!1,configurable:!0}),Object.defineProperty(t,"defaultFragmentSrc",{get:function(){return lL},enumerable:!1,configurable:!0}),t}(Cn),cL=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 otherMatrix;

varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;
}
`,dL=`varying vec2 vMaskCoord;
varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform sampler2D mask;
uniform float alpha;
uniform float npmAlpha;
uniform vec4 maskClamp;

void main(void)
{
    float clip = step(3.5,
        step(maskClamp.x, vMaskCoord.x) +
        step(maskClamp.y, vMaskCoord.y) +
        step(vMaskCoord.x, maskClamp.z) +
        step(vMaskCoord.y, maskClamp.w));

    vec4 original = texture2D(uSampler, vTextureCoord);
    vec4 masky = texture2D(mask, vMaskCoord);
    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);

    original *= (alphaMul * masky.r * alpha * clip);

    gl_FragColor = original;
}
`,Yp=new Vt,fT=function(){function r(t,e){this._texture=t,this.mapCoord=new Vt,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._textureID=-1,this._updateID=0,this.clampOffset=0,this.clampMargin=typeof e>"u"?.5:e,this.isSimple=!1}return Object.defineProperty(r.prototype,"texture",{get:function(){return this._texture},set:function(t){this._texture=t,this._textureID=-1},enumerable:!1,configurable:!0}),r.prototype.multiplyUvs=function(t,e){e===void 0&&(e=t);for(var s=this.mapCoord,i=0;i<t.length;i+=2){var n=t[i],a=t[i+1];e[i]=n*s.a+a*s.c+s.tx,e[i+1]=n*s.b+a*s.d+s.ty}return e},r.prototype.update=function(t){var e=this._texture;if(!e||!e.valid||!t&&this._textureID===e._updateID)return!1;this._textureID=e._updateID,this._updateID++;var s=e._uvs;this.mapCoord.set(s.x1-s.x0,s.y1-s.y0,s.x3-s.x0,s.y3-s.y0,s.x0,s.y0);var i=e.orig,n=e.trim;n&&(Yp.set(i.width/n.width,0,0,i.height/n.height,-n.x/n.width,-n.y/n.height),this.mapCoord.append(Yp));var a=e.baseTexture,o=this.uClampFrame,h=this.clampMargin/a.resolution,u=this.clampOffset;return o[0]=(e._frame.x+h+u)/a.width,o[1]=(e._frame.y+h+u)/a.height,o[2]=(e._frame.x+e._frame.width-h+u)/a.width,o[3]=(e._frame.y+e._frame.height-h+u)/a.height,this.uClampOffset[0]=u/a.realWidth,this.uClampOffset[1]=u/a.realHeight,this.isSimple=e._frame.width===a.width&&e._frame.height===a.height&&e.rotate===0,!0},r}(),fL=function(r){$t(t,r);function t(e,s,i){var n=this,a=null;return typeof e!="string"&&s===void 0&&i===void 0&&(a=e,e=void 0,s=void 0,i=void 0),n=r.call(this,e||cL,s||dL,i)||this,n.maskSprite=a,n.maskMatrix=new Vt,n}return Object.defineProperty(t.prototype,"maskSprite",{get:function(){return this._maskSprite},set:function(e){this._maskSprite=e,this._maskSprite&&(this._maskSprite.renderable=!1)},enumerable:!1,configurable:!0}),t.prototype.apply=function(e,s,i,n){var a=this._maskSprite,o=a._texture;o.valid&&(o.uvMatrix||(o.uvMatrix=new fT(o,0)),o.uvMatrix.update(),this.uniforms.npmAlpha=o.baseTexture.alphaMode?0:1,this.uniforms.mask=o,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,a).prepend(o.uvMatrix.mapCoord),this.uniforms.alpha=a.worldAlpha,this.uniforms.maskClamp=o.uvMatrix.uClampFrame,e.applyFilter(this,s,i,n))},t}(Wa),gL=function(){function r(t){this.renderer=t,this.enableScissor=!0,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return r.prototype.setMaskStack=function(t){this.maskStack=t,this.renderer.scissor.setMaskStack(t),this.renderer.stencil.setMaskStack(t)},r.prototype.push=function(t,e){var s=e;if(!s.isMaskData){var i=this.maskDataPool.pop()||new qD;i.pooled=!0,i.maskObject=e,s=i}var n=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null;if(s.copyCountersOrReset(n),s._colorMask=n?n._colorMask:15,s.autoDetect&&this.detect(s),s._target=t,s.type!==Ie.SPRITE&&this.maskStack.push(s),s.enabled)switch(s.type){case Ie.SCISSOR:this.renderer.scissor.push(s);break;case Ie.STENCIL:this.renderer.stencil.push(s);break;case Ie.SPRITE:s.copyCountersOrReset(null),this.pushSpriteMask(s);break;case Ie.COLOR:this.pushColorMask(s);break}s.type===Ie.SPRITE&&this.maskStack.push(s)},r.prototype.pop=function(t){var e=this.maskStack.pop();if(!(!e||e._target!==t)){if(e.enabled)switch(e.type){case Ie.SCISSOR:this.renderer.scissor.pop(e);break;case Ie.STENCIL:this.renderer.stencil.pop(e.maskObject);break;case Ie.SPRITE:this.popSpriteMask(e);break;case Ie.COLOR:this.popColorMask(e);break}if(e.reset(),e.pooled&&this.maskDataPool.push(e),this.maskStack.length!==0){var s=this.maskStack[this.maskStack.length-1];s.type===Ie.SPRITE&&s._filters&&(s._filters[0].maskSprite=s.maskObject)}}},r.prototype.detect=function(t){var e=t.maskObject;e?e.isSprite?t.type=Ie.SPRITE:this.enableScissor&&this.renderer.scissor.testScissor(t)?t.type=Ie.SCISSOR:t.type=Ie.STENCIL:t.type=Ie.COLOR},r.prototype.pushSpriteMask=function(t){var e,s,i=t.maskObject,n=t._target,a=t._filters;a||(a=this.alphaMaskPool[this.alphaMaskIndex],a||(a=this.alphaMaskPool[this.alphaMaskIndex]=[new fL]));var o=this.renderer,h=o.renderTexture,u,c;if(h.current){var l=h.current;u=t.resolution||l.resolution,c=(e=t.multisample)!==null&&e!==void 0?e:l.multisample}else u=t.resolution||o.resolution,c=(s=t.multisample)!==null&&s!==void 0?s:o.multisample;a[0].resolution=u,a[0].multisample=c,a[0].maskSprite=i;var _=n.filterArea;n.filterArea=i.getBounds(!0),o.filter.push(n,a),n.filterArea=_,t._filters||this.alphaMaskIndex++},r.prototype.popSpriteMask=function(t){this.renderer.filter.pop(),t._filters?t._filters[0].maskSprite=null:(this.alphaMaskIndex--,this.alphaMaskPool[this.alphaMaskIndex][0].maskSprite=null)},r.prototype.pushColorMask=function(t){var e=t._colorMask,s=t._colorMask=e&t.colorMask;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)},r.prototype.popColorMask=function(t){var e=t._colorMask,s=this.maskStack.length>0?this.maskStack[this.maskStack.length-1]._colorMask:15;s!==e&&this.renderer.gl.colorMask((s&1)!==0,(s&2)!==0,(s&4)!==0,(s&8)!==0)},r.prototype.destroy=function(){this.renderer=null},r}(),gT=function(){function r(t){this.renderer=t,this.maskStack=[],this.glConst=0}return r.prototype.getStackLength=function(){return this.maskStack.length},r.prototype.setMaskStack=function(t){var e=this.renderer.gl,s=this.getStackLength();this.maskStack=t;var i=this.getStackLength();i!==s&&(i===0?e.disable(this.glConst):(e.enable(this.glConst),this._useCurrent()))},r.prototype._useCurrent=function(){},r.prototype.destroy=function(){this.renderer=null,this.maskStack=null},r}(),Wp=new Vt,Xp=[],EL=function(r){$t(t,r);function t(e){var s=r.call(this,e)||this;return s.glConst=Z.ADAPTER.getWebGLRenderingContext().SCISSOR_TEST,s}return t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},t.prototype.calcScissorRect=function(e){var s;if(!e._scissorRectLocal){var i=e._scissorRect,n=e.maskObject,a=this.renderer,o=a.renderTexture,h=n.getBounds(!0,(s=Xp.pop())!==null&&s!==void 0?s:new it);this.roundFrameToPixels(h,o.current?o.current.resolution:a.resolution,o.sourceFrame,o.destinationFrame,a.projection.transform),i&&h.fit(i),e._scissorRectLocal=h}},t.isMatrixRotated=function(e){if(!e)return!1;var s=e.a,i=e.b,n=e.c,a=e.d;return(Math.abs(i)>1e-4||Math.abs(n)>1e-4)&&(Math.abs(s)>1e-4||Math.abs(a)>1e-4)},t.prototype.testScissor=function(e){var s=e.maskObject;if(!s.isFastRect||!s.isFastRect()||t.isMatrixRotated(s.worldTransform)||t.isMatrixRotated(this.renderer.projection.transform))return!1;this.calcScissorRect(e);var i=e._scissorRectLocal;return i.width>0&&i.height>0},t.prototype.roundFrameToPixels=function(e,s,i,n,a){t.isMatrixRotated(a)||(a=a?Wp.copyFrom(a):Wp.identity(),a.translate(-i.x,-i.y).scale(n.width/i.width,n.height/i.height).translate(n.x,n.y),this.renderer.filter.transformAABB(a,e),e.fit(n),e.x=Math.round(e.x*s),e.y=Math.round(e.y*s),e.width=Math.round(e.width*s),e.height=Math.round(e.height*s))},t.prototype.push=function(e){e._scissorRectLocal||this.calcScissorRect(e);var s=this.renderer.gl;e._scissorRect||s.enable(s.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=e._scissorRectLocal,this._useCurrent()},t.prototype.pop=function(e){var s=this.renderer.gl;e&&Xp.push(e._scissorRectLocal),this.getStackLength()>0?this._useCurrent():s.disable(s.SCISSOR_TEST)},t.prototype._useCurrent=function(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,s;this.renderer.renderTexture.current?s=e.y:s=this.renderer.height-e.height-e.y,this.renderer.gl.scissor(e.x,s,e.width,e.height)},t}(gT),pL=function(r){$t(t,r);function t(e){var s=r.call(this,e)||this;return s.glConst=Z.ADAPTER.getWebGLRenderingContext().STENCIL_TEST,s}return t.prototype.getStackLength=function(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},t.prototype.push=function(e){var s=e.maskObject,i=this.renderer.gl,n=e._stencilCounter;n===0&&(this.renderer.framebuffer.forceStencil(),i.clearStencil(0),i.clear(i.STENCIL_BUFFER_BIT),i.enable(i.STENCIL_TEST)),e._stencilCounter++;var a=e._colorMask;a!==0&&(e._colorMask=0,i.colorMask(!1,!1,!1,!1)),i.stencilFunc(i.EQUAL,n,4294967295),i.stencilOp(i.KEEP,i.KEEP,i.INCR),s.renderable=!0,s.render(this.renderer),this.renderer.batch.flush(),s.renderable=!1,a!==0&&(e._colorMask=a,i.colorMask((a&1)!==0,(a&2)!==0,(a&4)!==0,(a&8)!==0)),this._useCurrent()},t.prototype.pop=function(e){var s=this.renderer.gl;if(this.getStackLength()===0)s.disable(s.STENCIL_TEST);else{var i=this.maskStack.length!==0?this.maskStack[this.maskStack.length-1]:null,n=i?i._colorMask:15;n!==0&&(i._colorMask=0,s.colorMask(!1,!1,!1,!1)),s.stencilOp(s.KEEP,s.KEEP,s.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,n!==0&&(i._colorMask=n,s.colorMask((n&1)!==0,(n&2)!==0,(n&4)!==0,(n&8)!==0)),this._useCurrent()}},t.prototype._useCurrent=function(){var e=this.renderer.gl;e.stencilFunc(e.EQUAL,this.getStackLength(),4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},t}(gT),mL=function(){function r(t){this.renderer=t,this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new Vt,this.transform=null}return r.prototype.update=function(t,e,s,i){this.destinationFrame=t||this.destinationFrame||this.defaultFrame,this.sourceFrame=e||this.sourceFrame||t,this.calculateProjection(this.destinationFrame,this.sourceFrame,s,i),this.transform&&this.projectionMatrix.append(this.transform);var n=this.renderer;n.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,n.globalUniforms.update(),n.shader.shader&&n.shader.syncUniformGroup(n.shader.shader.uniforms.globals)},r.prototype.calculateProjection=function(t,e,s,i){var n=this.projectionMatrix,a=i?-1:1;n.identity(),n.a=1/e.width*2,n.d=a*(1/e.height*2),n.tx=-1-e.x*n.a,n.ty=-a-e.y*n.d},r.prototype.setTransform=function(t){},r.prototype.destroy=function(){this.renderer=null},r}(),Qi=new it,go=new it,IL=function(){function r(t){this.renderer=t,this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new it,this.destinationFrame=new it,this.viewportFrame=new it}return r.prototype.bind=function(t,e,s){t===void 0&&(t=null);var i=this.renderer;this.current=t;var n,a,o;t?(n=t.baseTexture,o=n.resolution,e||(Qi.width=t.frame.width,Qi.height=t.frame.height,e=Qi),s||(go.x=t.frame.x,go.y=t.frame.y,go.width=e.width,go.height=e.height,s=go),a=n.framebuffer):(o=i.resolution,e||(Qi.width=i.screen.width,Qi.height=i.screen.height,e=Qi),s||(s=Qi,s.width=e.width,s.height=e.height));var h=this.viewportFrame;h.x=s.x*o,h.y=s.y*o,h.width=s.width*o,h.height=s.height*o,t||(h.y=i.view.height-(h.y+h.height)),h.ceil(),this.renderer.framebuffer.bind(a,h),this.renderer.projection.update(s,e,o,!a),t?this.renderer.mask.setMaskStack(n.maskStack):this.renderer.mask.setMaskStack(this.defaultMaskStack),this.sourceFrame.copyFrom(e),this.destinationFrame.copyFrom(s)},r.prototype.clear=function(t,e){this.current?t=t||this.current.baseTexture.clearColor:t=t||this.clearColor;var s=this.destinationFrame,i=this.current?this.current.baseTexture:this.renderer.screen,n=s.width!==i.width||s.height!==i.height;if(n){var a=this.viewportFrame,o=a.x,h=a.y,u=a.width,c=a.height;o=Math.round(o),h=Math.round(h),u=Math.round(u),c=Math.round(c),this.renderer.gl.enable(this.renderer.gl.SCISSOR_TEST),this.renderer.gl.scissor(o,h,u,c)}this.renderer.framebuffer.clear(t[0],t[1],t[2],t[3],e),n&&this.renderer.scissor.pop()},r.prototype.resize=function(){this.bind(null)},r.prototype.reset=function(){this.bind(null)},r.prototype.destroy=function(){this.renderer=null},r}();function TL(r,t,e,s,i){e.buffer.update(i)}var RL={float:`
        data[offset] = v;
    `,vec2:`
        data[offset] = v[0];
        data[offset+1] = v[1];
    `,vec3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

    `,vec4:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];
        data[offset+3] = v[3];
    `,mat2:`
        data[offset] = v[0];
        data[offset+1] = v[1];

        data[offset+4] = v[2];
        data[offset+5] = v[3];
    `,mat3:`
        data[offset] = v[0];
        data[offset+1] = v[1];
        data[offset+2] = v[2];

        data[offset + 4] = v[3];
        data[offset + 5] = v[4];
        data[offset + 6] = v[5];

        data[offset + 8] = v[6];
        data[offset + 9] = v[7];
        data[offset + 10] = v[8];
    `,mat4:`
        for(var i = 0; i < 16; i++)
        {
            data[offset + i] = v[i];
        }
    `},ET={float:4,vec2:8,vec3:12,vec4:16,int:4,ivec2:8,ivec3:12,ivec4:16,uint:4,uvec2:8,uvec3:12,uvec4:16,bool:4,bvec2:8,bvec3:12,bvec4:16,mat2:16*2,mat3:16*3,mat4:16*4};function OL(r){for(var t=r.map(function(h){return{data:h,offset:0,dataLen:0,dirty:0}}),e=0,s=0,i=0,n=0;n<t.length;n++){var a=t[n];if(e=ET[a.data.type],a.data.size>1&&(e=Math.max(e,16)*a.data.size),a.dataLen=e,s%e!==0&&s<16){var o=s%e%16;s+=o,i+=o}s+e>16?(i=Math.ceil(i/16)*16,a.offset=i,i+=e,s=e):(a.offset=i,s+=e,i+=e)}return i=Math.ceil(i/16)*16,{uboElements:t,size:i}}function vL(r,t){var e=[];for(var s in r)t[s]&&e.push(t[s]);return e.sort(function(i,n){return i.index-n.index}),e}function AL(r,t){if(!r.autoManage)return{size:0,syncFunc:TL};for(var e=vL(r.uniforms,t),s=OL(e),i=s.uboElements,n=s.size,a=[`
    var v = null;
    var v2 = null;
    var cv = null;
    var t = 0;
    var gl = renderer.gl
    var index = 0;
    var data = buffer.data;
    `],o=0;o<i.length;o++){for(var h=i[o],u=r.uniforms[h.data.name],c=h.data.name,l=!1,_=0;_<Ca.length;_++){var d=Ca[_];if(d.codeUbo&&d.test(h.data,u)){a.push("offset = "+h.offset/4+";",Ca[_].codeUbo(h.data.name,u)),l=!0;break}}if(!l)if(h.data.size>1){var f=cT(h.data.type),m=Math.max(ET[h.data.type]/16,1),p=f/m,T=(4-p%4)%4;a.push(`
                cv = ud.`+c+`.value;
                v = uv.`+c+`;
                offset = `+h.offset/4+`;

                t = 0;

                for(var i=0; i < `+h.data.size*m+`; i++)
                {
                    for(var j = 0; j < `+p+`; j++)
                    {
                        data[offset++] = v[t++];
                    }
                    offset += `+T+`;
                }

                `)}else{var v=RL[h.data.type];a.push(`
                cv = ud.`+c+`.value;
                v = uv.`+c+`;
                offset = `+h.offset/4+`;
                `+v+`;
                `)}}return a.push(`
       renderer.buffer.update(buffer);
    `),{size:n,syncFunc:new Function("ud","uv","renderer","syncData","buffer",a.join(`
`))}}var SL=function(){function r(t,e){this.program=t,this.uniformData=e,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBufferBindings={}}return r.prototype.destroy=function(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBufferBindings=null,this.program=null},r}();function yL(r,t){for(var e={},s=t.getProgramParameter(r,t.ACTIVE_ATTRIBUTES),i=0;i<s;i++){var n=t.getActiveAttrib(r,i);if(n.name.indexOf("gl_")!==0){var a=dT(t,n.type),o={type:a,name:n.name,size:cT(a),location:t.getAttribLocation(r,n.name)};e[n.name]=o}}return e}function ML(r,t){for(var e={},s=t.getProgramParameter(r,t.ACTIVE_UNIFORMS),i=0;i<s;i++){var n=t.getActiveUniform(r,i),a=n.name.replace(/\[.*?\]$/,""),o=!!n.name.match(/\[.*?\]$/),h=dT(t,n.type);e[a]={name:a,index:i,type:h,size:n.size,isArray:o,value:lT(h,n.size)}}return e}function CL(r,t){var e=Vp(r,r.VERTEX_SHADER,t.vertexSrc),s=Vp(r,r.FRAGMENT_SHADER,t.fragmentSrc),i=r.createProgram();if(r.attachShader(i,e),r.attachShader(i,s),r.linkProgram(i),r.getProgramParameter(i,r.LINK_STATUS)||QD(r,i,e,s),t.attributeData=yL(i,r),t.uniformData=ML(i,r),!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertexSrc)){var n=Object.keys(t.attributeData);n.sort(function(c,l){return c>l?1:-1});for(var a=0;a<n.length;a++)t.attributeData[n[a]].location=a,r.bindAttribLocation(i,a,n[a]);r.linkProgram(i)}r.deleteShader(e),r.deleteShader(s);var o={};for(var a in t.uniformData){var h=t.uniformData[a];o[a]={location:r.getUniformLocation(i,a),value:lT(h.type,h.size)}}var u=new SL(i,o);return u}var NL=0,Ru={textureCount:0,uboCount:0},bL=function(){function r(t){this.destroyed=!1,this.renderer=t,this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this._uboCache={},this.id=NL++}return r.prototype.systemCheck=function(){if(!aL())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},r.prototype.contextChange=function(t){this.gl=t,this.reset()},r.prototype.bind=function(t,e){t.disposeRunner.add(this),t.uniforms.globals=this.renderer.globalUniforms;var s=t.program,i=s.glPrograms[this.renderer.CONTEXT_UID]||this.generateProgram(t);return this.shader=t,this.program!==s&&(this.program=s,this.gl.useProgram(i.program)),e||(Ru.textureCount=0,Ru.uboCount=0,this.syncUniformGroup(t.uniformGroup,Ru)),i},r.prototype.setUniforms=function(t){var e=this.shader.program,s=e.glPrograms[this.renderer.CONTEXT_UID];e.syncUniforms(s.uniformData,t,this.renderer)},r.prototype.syncUniformGroup=function(t,e){var s=this.getGlProgram();(!t.static||t.dirtyId!==s.uniformDirtyGroups[t.id])&&(s.uniformDirtyGroups[t.id]=t.dirtyId,this.syncUniforms(t,s,e))},r.prototype.syncUniforms=function(t,e,s){var i=t.syncUniforms[this.shader.program.id]||this.createSyncGroups(t);i(e.uniformData,t.uniforms,this.renderer,s)},r.prototype.createSyncGroups=function(t){var e=this.getSignature(t,this.shader.program.uniformData,"u");return this.cache[e]||(this.cache[e]=sL(t,this.shader.program.uniformData)),t.syncUniforms[this.shader.program.id]=this.cache[e],t.syncUniforms[this.shader.program.id]},r.prototype.syncUniformBufferGroup=function(t,e){var s=this.getGlProgram();if(!t.static||t.dirtyId!==0||!s.uniformGroups[t.id]){t.dirtyId=0;var i=s.uniformGroups[t.id]||this.createSyncBufferGroup(t,s,e);t.buffer.update(),i(s.uniformData,t.uniforms,this.renderer,Ru,t.buffer)}this.renderer.buffer.bindBufferBase(t.buffer,s.uniformBufferBindings[e])},r.prototype.createSyncBufferGroup=function(t,e,s){var i=this.renderer.gl;this.renderer.buffer.bind(t.buffer);var n=this.gl.getUniformBlockIndex(e.program,s);e.uniformBufferBindings[s]=this.shader.uniformBindCount,i.uniformBlockBinding(e.program,n,this.shader.uniformBindCount),this.shader.uniformBindCount++;var a=this.getSignature(t,this.shader.program.uniformData,"ubo"),o=this._uboCache[a];if(o||(o=this._uboCache[a]=AL(t,this.shader.program.uniformData)),t.autoManage){var h=new Float32Array(o.size/4);t.buffer.update(h)}return e.uniformGroups[t.id]=o.syncFunc,e.uniformGroups[t.id]},r.prototype.getSignature=function(t,e,s){var i=t.uniforms,n=[s+"-"];for(var a in i)n.push(a),e[a]&&n.push(e[a].type);return n.join("-")},r.prototype.getGlProgram=function(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},r.prototype.generateProgram=function(t){var e=this.gl,s=t.program,i=CL(e,s);return s.glPrograms[this.renderer.CONTEXT_UID]=i,i},r.prototype.reset=function(){this.program=null,this.shader=null},r.prototype.disposeShader=function(t){this.shader===t&&(this.shader=null)},r.prototype.destroy=function(){this.renderer=null,this.destroyed=!0},r}();function PL(r,t){return t===void 0&&(t=[]),t[tt.NORMAL]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.ADD]=[r.ONE,r.ONE],t[tt.MULTIPLY]=[r.DST_COLOR,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.SCREEN]=[r.ONE,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.OVERLAY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.DARKEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.LIGHTEN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.COLOR_DODGE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.COLOR_BURN]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.HARD_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.SOFT_LIGHT]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.DIFFERENCE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.EXCLUSION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.HUE]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.SATURATION]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.COLOR]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.LUMINOSITY]=[r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.NONE]=[0,0],t[tt.NORMAL_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_ALPHA,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.ADD_NPM]=[r.SRC_ALPHA,r.ONE,r.ONE,r.ONE],t[tt.SCREEN_NPM]=[r.SRC_ALPHA,r.ONE_MINUS_SRC_COLOR,r.ONE,r.ONE_MINUS_SRC_ALPHA],t[tt.SRC_IN]=[r.DST_ALPHA,r.ZERO],t[tt.SRC_OUT]=[r.ONE_MINUS_DST_ALPHA,r.ZERO],t[tt.SRC_ATOP]=[r.DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[tt.DST_OVER]=[r.ONE_MINUS_DST_ALPHA,r.ONE],t[tt.DST_IN]=[r.ZERO,r.SRC_ALPHA],t[tt.DST_OUT]=[r.ZERO,r.ONE_MINUS_SRC_ALPHA],t[tt.DST_ATOP]=[r.ONE_MINUS_DST_ALPHA,r.SRC_ALPHA],t[tt.XOR]=[r.ONE_MINUS_DST_ALPHA,r.ONE_MINUS_SRC_ALPHA],t[tt.SUBTRACT]=[r.ONE,r.ONE,r.ONE,r.ONE,r.FUNC_REVERSE_SUBTRACT,r.FUNC_ADD],t}var DL=0,LL=1,UL=2,xL=3,FL=4,wL=5,GL=function(){function r(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=tt.NONE,this._blendEq=!1,this.map=[],this.map[DL]=this.setBlend,this.map[LL]=this.setOffset,this.map[UL]=this.setCullFace,this.map[xL]=this.setDepthTest,this.map[FL]=this.setFrontFace,this.map[wL]=this.setDepthMask,this.checks=[],this.defaultState=new yh,this.defaultState.blend=!0}return r.prototype.contextChange=function(t){this.gl=t,this.blendModes=PL(t),this.set(this.defaultState),this.reset()},r.prototype.set=function(t){if(t=t||this.defaultState,this.stateId!==t.data){for(var e=this.stateId^t.data,s=0;e;)e&1&&this.map[s].call(this,!!(t.data&1<<s)),e=e>>1,s++;this.stateId=t.data}for(var s=0;s<this.checks.length;s++)this.checks[s](this,t)},r.prototype.forceState=function(t){t=t||this.defaultState;for(var e=0;e<this.map.length;e++)this.map[e].call(this,!!(t.data&1<<e));for(var e=0;e<this.checks.length;e++)this.checks[e](this,t);this.stateId=t.data},r.prototype.setBlend=function(t){this.updateCheck(r.checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)},r.prototype.setOffset=function(t){this.updateCheck(r.checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},r.prototype.setDepthTest=function(t){this.gl[t?"enable":"disable"](this.gl.DEPTH_TEST)},r.prototype.setDepthMask=function(t){this.gl.depthMask(t)},r.prototype.setCullFace=function(t){this.gl[t?"enable":"disable"](this.gl.CULL_FACE)},r.prototype.setFrontFace=function(t){this.gl.frontFace(this.gl[t?"CW":"CCW"])},r.prototype.setBlendMode=function(t){if(t!==this.blendMode){this.blendMode=t;var e=this.blendModes[t],s=this.gl;e.length===2?s.blendFunc(e[0],e[1]):s.blendFuncSeparate(e[0],e[1],e[2],e[3]),e.length===6?(this._blendEq=!0,s.blendEquationSeparate(e[4],e[5])):this._blendEq&&(this._blendEq=!1,s.blendEquationSeparate(s.FUNC_ADD,s.FUNC_ADD))}},r.prototype.setPolygonOffset=function(t,e){this.gl.polygonOffset(t,e)},r.prototype.reset=function(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},r.prototype.updateCheck=function(t,e){var s=this.checks.indexOf(t);e&&s===-1?this.checks.push(t):!e&&s!==-1&&this.checks.splice(s,1)},r.checkBlendMode=function(t,e){t.setBlendMode(e.blendMode)},r.checkPolygonOffset=function(t,e){t.setPolygonOffset(1,e.polygonOffset)},r.prototype.destroy=function(){this.gl=null},r}(),BL=function(){function r(t){this.renderer=t,this.count=0,this.checkCount=0,this.maxIdle=Z.GC_MAX_IDLE,this.checkCountMax=Z.GC_MAX_CHECK_COUNT,this.mode=Z.GC_MODE}return r.prototype.postrender=function(){this.renderer.renderingToScreen&&(this.count++,this.mode!==_l.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},r.prototype.run=function(){for(var t=this.renderer.texture,e=t.managedTextures,s=!1,i=0;i<e.length;i++){var n=e[i];!n.framebuffer&&this.count-n.touched>this.maxIdle&&(t.destroyTexture(n,!0),e[i]=null,s=!0)}if(s){for(var a=0,i=0;i<e.length;i++)e[i]!==null&&(e[a++]=e[i]);e.length=a}},r.prototype.unload=function(t){var e=this.renderer.texture,s=t._texture;s&&!s.framebuffer&&e.destroyTexture(s);for(var i=t.children.length-1;i>=0;i--)this.unload(t.children[i])},r.prototype.destroy=function(){this.renderer=null},r}();function HL(r){var t,e,s,i,n,a,o,h,u,c,l,_,d,f,m,p,T,v,O,A,y,M,N;return"WebGL2RenderingContext"in globalThis&&r instanceof globalThis.WebGL2RenderingContext?N=(t={},t[xt.UNSIGNED_BYTE]=(e={},e[W.RGBA]=r.RGBA8,e[W.RGB]=r.RGB8,e[W.RG]=r.RG8,e[W.RED]=r.R8,e[W.RGBA_INTEGER]=r.RGBA8UI,e[W.RGB_INTEGER]=r.RGB8UI,e[W.RG_INTEGER]=r.RG8UI,e[W.RED_INTEGER]=r.R8UI,e[W.ALPHA]=r.ALPHA,e[W.LUMINANCE]=r.LUMINANCE,e[W.LUMINANCE_ALPHA]=r.LUMINANCE_ALPHA,e),t[xt.BYTE]=(s={},s[W.RGBA]=r.RGBA8_SNORM,s[W.RGB]=r.RGB8_SNORM,s[W.RG]=r.RG8_SNORM,s[W.RED]=r.R8_SNORM,s[W.RGBA_INTEGER]=r.RGBA8I,s[W.RGB_INTEGER]=r.RGB8I,s[W.RG_INTEGER]=r.RG8I,s[W.RED_INTEGER]=r.R8I,s),t[xt.UNSIGNED_SHORT]=(i={},i[W.RGBA_INTEGER]=r.RGBA16UI,i[W.RGB_INTEGER]=r.RGB16UI,i[W.RG_INTEGER]=r.RG16UI,i[W.RED_INTEGER]=r.R16UI,i[W.DEPTH_COMPONENT]=r.DEPTH_COMPONENT16,i),t[xt.SHORT]=(n={},n[W.RGBA_INTEGER]=r.RGBA16I,n[W.RGB_INTEGER]=r.RGB16I,n[W.RG_INTEGER]=r.RG16I,n[W.RED_INTEGER]=r.R16I,n),t[xt.UNSIGNED_INT]=(a={},a[W.RGBA_INTEGER]=r.RGBA32UI,a[W.RGB_INTEGER]=r.RGB32UI,a[W.RG_INTEGER]=r.RG32UI,a[W.RED_INTEGER]=r.R32UI,a[W.DEPTH_COMPONENT]=r.DEPTH_COMPONENT24,a),t[xt.INT]=(o={},o[W.RGBA_INTEGER]=r.RGBA32I,o[W.RGB_INTEGER]=r.RGB32I,o[W.RG_INTEGER]=r.RG32I,o[W.RED_INTEGER]=r.R32I,o),t[xt.FLOAT]=(h={},h[W.RGBA]=r.RGBA32F,h[W.RGB]=r.RGB32F,h[W.RG]=r.RG32F,h[W.RED]=r.R32F,h[W.DEPTH_COMPONENT]=r.DEPTH_COMPONENT32F,h),t[xt.HALF_FLOAT]=(u={},u[W.RGBA]=r.RGBA16F,u[W.RGB]=r.RGB16F,u[W.RG]=r.RG16F,u[W.RED]=r.R16F,u),t[xt.UNSIGNED_SHORT_5_6_5]=(c={},c[W.RGB]=r.RGB565,c),t[xt.UNSIGNED_SHORT_4_4_4_4]=(l={},l[W.RGBA]=r.RGBA4,l),t[xt.UNSIGNED_SHORT_5_5_5_1]=(_={},_[W.RGBA]=r.RGB5_A1,_),t[xt.UNSIGNED_INT_2_10_10_10_REV]=(d={},d[W.RGBA]=r.RGB10_A2,d[W.RGBA_INTEGER]=r.RGB10_A2UI,d),t[xt.UNSIGNED_INT_10F_11F_11F_REV]=(f={},f[W.RGB]=r.R11F_G11F_B10F,f),t[xt.UNSIGNED_INT_5_9_9_9_REV]=(m={},m[W.RGB]=r.RGB9_E5,m),t[xt.UNSIGNED_INT_24_8]=(p={},p[W.DEPTH_STENCIL]=r.DEPTH24_STENCIL8,p),t[xt.FLOAT_32_UNSIGNED_INT_24_8_REV]=(T={},T[W.DEPTH_STENCIL]=r.DEPTH32F_STENCIL8,T),t):N=(v={},v[xt.UNSIGNED_BYTE]=(O={},O[W.RGBA]=r.RGBA,O[W.RGB]=r.RGB,O[W.ALPHA]=r.ALPHA,O[W.LUMINANCE]=r.LUMINANCE,O[W.LUMINANCE_ALPHA]=r.LUMINANCE_ALPHA,O),v[xt.UNSIGNED_SHORT_5_6_5]=(A={},A[W.RGB]=r.RGB,A),v[xt.UNSIGNED_SHORT_4_4_4_4]=(y={},y[W.RGBA]=r.RGBA,y),v[xt.UNSIGNED_SHORT_5_5_5_1]=(M={},M[W.RGBA]=r.RGBA,M),v),N}var Ic=function(){function r(t){this.texture=t,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=xt.UNSIGNED_BYTE,this.internalFormat=W.RGBA,this.samplerType=0}return r}(),VL=function(){function r(t){this.renderer=t,this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Xt,this.hasIntegerTextures=!1}return r.prototype.contextChange=function(){var t=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion,this.internalFormats=HL(t);var e=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=e;for(var s=0;s<e;s++)this.boundTextures[s]=null;this.emptyTextures={};var i=new Ic(t.createTexture());t.bindTexture(t.TEXTURE_2D,i.texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[t.TEXTURE_2D]=i,this.emptyTextures[t.TEXTURE_CUBE_MAP]=new Ic(t.createTexture()),t.bindTexture(t.TEXTURE_CUBE_MAP,this.emptyTextures[t.TEXTURE_CUBE_MAP].texture);for(var s=0;s<6;s++)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+s,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,null);t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,t.LINEAR);for(var s=0;s<this.boundTextures.length;s++)this.bind(null,s)},r.prototype.bind=function(t,e){e===void 0&&(e=0);var s=this.gl;if(t=t==null?void 0:t.castToBaseTexture(),t&&t.valid&&!t.parentTextureArray){t.touched=this.renderer.textureGC.count;var i=t._glTextures[this.CONTEXT_UID]||this.initTexture(t);this.boundTextures[e]!==t&&(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(t.target,i.texture)),i.dirtyId!==t.dirtyId?(this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),this.updateTexture(t)):i.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(t),this.boundTextures[e]=t}else this.currentLocation!==e&&(this.currentLocation=e,s.activeTexture(s.TEXTURE0+e)),s.bindTexture(s.TEXTURE_2D,this.emptyTextures[s.TEXTURE_2D].texture),this.boundTextures[e]=null},r.prototype.reset=function(){this._unknownBoundTextures=!0,this.hasIntegerTextures=!1,this.currentLocation=-1;for(var t=0;t<this.boundTextures.length;t++)this.boundTextures[t]=this.unknownTexture},r.prototype.unbind=function(t){var e=this,s=e.gl,i=e.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var n=0;n<i.length;n++)i[n]===this.unknownTexture&&this.bind(null,n)}for(var n=0;n<i.length;n++)i[n]===t&&(this.currentLocation!==n&&(s.activeTexture(s.TEXTURE0+n),this.currentLocation=n),s.bindTexture(t.target,this.emptyTextures[t.target].texture),i[n]=null)},r.prototype.ensureSamplerType=function(t){var e=this,s=e.boundTextures,i=e.hasIntegerTextures,n=e.CONTEXT_UID;if(i)for(var a=t-1;a>=0;--a){var o=s[a];if(o){var h=o._glTextures[n];h.samplerType!==ll.FLOAT&&this.renderer.texture.unbind(o)}}},r.prototype.initTexture=function(t){var e=new Ic(this.gl.createTexture());return e.dirtyId=-1,t._glTextures[this.CONTEXT_UID]=e,this.managedTextures.push(t),t.on("dispose",this.destroyTexture,this),e},r.prototype.initTextureType=function(t,e){var s,i;e.internalFormat=(i=(s=this.internalFormats[t.type])===null||s===void 0?void 0:s[t.format])!==null&&i!==void 0?i:t.format,this.webGLVersion===2&&t.type===xt.HALF_FLOAT?e.type=this.gl.HALF_FLOAT:e.type=t.type},r.prototype.updateTexture=function(t){var e=t._glTextures[this.CONTEXT_UID];if(e){var s=this.renderer;if(this.initTextureType(t,e),t.resource&&t.resource.upload(s,t,e))e.samplerType!==ll.FLOAT&&(this.hasIntegerTextures=!0);else{var i=t.realWidth,n=t.realHeight,a=s.gl;(e.width!==i||e.height!==n||e.dirtyId<0)&&(e.width=i,e.height=n,a.texImage2D(t.target,0,e.internalFormat,i,n,0,t.format,e.type,null))}t.dirtyStyleId!==e.dirtyStyleId&&this.updateTextureStyle(t),e.dirtyId=t.dirtyId}},r.prototype.destroyTexture=function(t,e){var s=this.gl;if(t=t.castToBaseTexture(),t._glTextures[this.CONTEXT_UID]&&(this.unbind(t),s.deleteTexture(t._glTextures[this.CONTEXT_UID].texture),t.off("dispose",this.destroyTexture,this),delete t._glTextures[this.CONTEXT_UID],!e)){var i=this.managedTextures.indexOf(t);i!==-1&&Hu(this.managedTextures,i,1)}},r.prototype.updateTextureStyle=function(t){var e=t._glTextures[this.CONTEXT_UID];e&&((t.mipmap===Hi.POW2||this.webGLVersion!==2)&&!t.isPowerOfTwo?e.mipmap=!1:e.mipmap=t.mipmap>=1,this.webGLVersion!==2&&!t.isPowerOfTwo?e.wrapMode=ri.CLAMP:e.wrapMode=t.wrapMode,t.resource&&t.resource.style(this.renderer,t,e)||this.setStyle(t,e),e.dirtyStyleId=t.dirtyStyleId)},r.prototype.setStyle=function(t,e){var s=this.gl;if(e.mipmap&&t.mipmap!==Hi.ON_MANUAL&&s.generateMipmap(t.target),s.texParameteri(t.target,s.TEXTURE_WRAP_S,e.wrapMode),s.texParameteri(t.target,s.TEXTURE_WRAP_T,e.wrapMode),e.mipmap){s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===_s.LINEAR?s.LINEAR_MIPMAP_LINEAR:s.NEAREST_MIPMAP_NEAREST);var i=this.renderer.context.extensions.anisotropicFiltering;if(i&&t.anisotropicLevel>0&&t.scaleMode===_s.LINEAR){var n=Math.min(t.anisotropicLevel,s.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT));s.texParameterf(t.target,i.TEXTURE_MAX_ANISOTROPY_EXT,n)}}else s.texParameteri(t.target,s.TEXTURE_MIN_FILTER,t.scaleMode===_s.LINEAR?s.LINEAR:s.NEAREST);s.texParameteri(t.target,s.TEXTURE_MAG_FILTER,t.scaleMode===_s.LINEAR?s.LINEAR:s.NEAREST)},r.prototype.destroy=function(){this.renderer=null},r}(),Tc=new Vt,kL=function(r){$t(t,r);function t(e,s){e===void 0&&(e=Jo.UNKNOWN);var i=r.call(this)||this;return s=Object.assign({},Z.RENDER_OPTIONS,s),i.options=s,i.type=e,i.screen=new it(0,0,s.width,s.height),i.view=s.view||Z.ADAPTER.createCanvas(),i.resolution=s.resolution||Z.RESOLUTION,i.useContextAlpha=s.useContextAlpha,i.autoDensity=!!s.autoDensity,i.preserveDrawingBuffer=s.preserveDrawingBuffer,i.clearBeforeRender=s.clearBeforeRender,i._backgroundColor=0,i._backgroundColorRgba=[0,0,0,1],i._backgroundColorString="#000000",i.backgroundColor=s.backgroundColor||i._backgroundColor,i.backgroundAlpha=s.backgroundAlpha,s.transparent!==void 0&&(Er("6.0.0","Option transparent is deprecated, please use backgroundAlpha instead."),i.useContextAlpha=s.transparent,i.backgroundAlpha=s.transparent?0:1),i._lastObjectRendered=null,i.plugins={},i}return t.prototype.initPlugins=function(e){for(var s in e)this.plugins[s]=new e[s](this)},Object.defineProperty(t.prototype,"width",{get:function(){return this.view.width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.view.height},enumerable:!1,configurable:!0}),t.prototype.resize=function(e,s){this.view.width=Math.round(e*this.resolution),this.view.height=Math.round(s*this.resolution);var i=this.view.width/this.resolution,n=this.view.height/this.resolution;this.screen.width=i,this.screen.height=n,this.autoDensity&&(this.view.style.width=i+"px",this.view.style.height=n+"px"),this.emit("resize",i,n)},t.prototype.generateTexture=function(e,s,i,n){s===void 0&&(s={}),typeof s=="number"&&(Er("6.1.0","generateTexture options (scaleMode, resolution, region) are now object options."),s={scaleMode:s,resolution:i,region:n});var a=s.region,o=AD(s,["region"]);n=a||e.getLocalBounds(null,!0),n.width===0&&(n.width=1),n.height===0&&(n.height=1);var h=we.create(vd({width:n.width,height:n.height},o));return Tc.tx=-n.x,Tc.ty=-n.y,this.render(e,{renderTexture:h,clear:!1,transform:Tc,skipUpdateTransform:!!e.parent}),h},t.prototype.destroy=function(e){for(var s in this.plugins)this.plugins[s].destroy(),this.plugins[s]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view);var i=this;i.plugins=null,i.type=Jo.UNKNOWN,i.view=null,i.screen=null,i._tempDisplayObjectParent=null,i.options=null,this._backgroundColorRgba=null,this._backgroundColorString=null,this._lastObjectRendered=null},Object.defineProperty(t.prototype,"backgroundColor",{get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._backgroundColorString=JI(e),pl(e,this._backgroundColorRgba)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"backgroundAlpha",{get:function(){return this._backgroundColorRgba[3]},set:function(e){this._backgroundColorRgba[3]=e},enumerable:!1,configurable:!0}),t}(Ah),jL=function(){function r(t){this.buffer=t||null,this.updateID=-1,this.byteLength=-1,this.refCount=0}return r}(),zL=function(){function r(t){this.renderer=t,this.managedBuffers={},this.boundBufferBases={}}return r.prototype.destroy=function(){this.renderer=null},r.prototype.contextChange=function(){this.disposeAll(!0),this.gl=this.renderer.gl,this.CONTEXT_UID=this.renderer.CONTEXT_UID},r.prototype.bind=function(t){var e=this,s=e.gl,i=e.CONTEXT_UID,n=t._glBuffers[i]||this.createGLBuffer(t);s.bindBuffer(t.type,n.buffer)},r.prototype.bindBufferBase=function(t,e){var s=this,i=s.gl,n=s.CONTEXT_UID;if(this.boundBufferBases[e]!==t){var a=t._glBuffers[n]||this.createGLBuffer(t);this.boundBufferBases[e]=t,i.bindBufferBase(i.UNIFORM_BUFFER,e,a.buffer)}},r.prototype.bindBufferRange=function(t,e,s){var i=this,n=i.gl,a=i.CONTEXT_UID;s=s||0;var o=t._glBuffers[a]||this.createGLBuffer(t);n.bindBufferRange(n.UNIFORM_BUFFER,e||0,o.buffer,s*256,256)},r.prototype.update=function(t){var e=this,s=e.gl,i=e.CONTEXT_UID,n=t._glBuffers[i];if(t._updateID!==n.updateID)if(n.updateID=t._updateID,s.bindBuffer(t.type,n.buffer),n.byteLength>=t.data.byteLength)s.bufferSubData(t.type,0,t.data);else{var a=t.static?s.STATIC_DRAW:s.DYNAMIC_DRAW;n.byteLength=t.data.byteLength,s.bufferData(t.type,t.data,a)}},r.prototype.dispose=function(t,e){if(this.managedBuffers[t.id]){delete this.managedBuffers[t.id];var s=t._glBuffers[this.CONTEXT_UID],i=this.gl;t.disposeRunner.remove(this),s&&(e||i.deleteBuffer(s.buffer),delete t._glBuffers[this.CONTEXT_UID])}},r.prototype.disposeAll=function(t){for(var e=Object.keys(this.managedBuffers),s=0;s<e.length;s++)this.dispose(this.managedBuffers[e[s]],t)},r.prototype.createGLBuffer=function(t){var e=this,s=e.CONTEXT_UID,i=e.gl;return t._glBuffers[s]=new jL(i.createBuffer()),this.managedBuffers[t.id]=t,t.disposeRunner.add(this),t._glBuffers[s]},r}(),Ng=function(r){$t(t,r);function t(e){var s=r.call(this,Jo.WEBGL,e)||this;return e=s.options,s.gl=null,s.CONTEXT_UID=0,s.runners={destroy:new je("destroy"),contextChange:new je("contextChange"),reset:new je("reset"),update:new je("update"),postrender:new je("postrender"),prerender:new je("prerender"),resize:new je("resize")},s.runners.contextChange.add(s),s.globalUniforms=new Mn({projectionMatrix:new Vt},!0),s.addSystem(gL,"mask").addSystem(zD,"context").addSystem(GL,"state").addSystem(bL,"shader").addSystem(VL,"texture").addSystem(zL,"buffer").addSystem(KD,"geometry").addSystem(XD,"framebuffer").addSystem(EL,"scissor").addSystem(pL,"stencil").addSystem(mL,"projection").addSystem(BL,"textureGC").addSystem(kD,"filter").addSystem(IL,"renderTexture").addSystem(jD,"batch"),s.initPlugins(t.__plugins),s.multisample=void 0,e.context?s.context.initFromContext(e.context):s.context.initFromOptions({alpha:!!s.useContextAlpha,antialias:e.antialias,premultipliedAlpha:s.useContextAlpha&&s.useContextAlpha!=="notMultiplied",stencil:!0,preserveDrawingBuffer:e.preserveDrawingBuffer,powerPreference:s.options.powerPreference}),s.renderingToScreen=!0,TN(s.context.webGLVersion===2?"WebGL 2":"WebGL 1"),s.resize(s.options.width,s.options.height),s}return t.create=function(e){if(RN())return new t(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},t.prototype.contextChange=function(){var e=this.gl,s;if(this.context.webGLVersion===1){var i=e.getParameter(e.FRAMEBUFFER_BINDING);e.bindFramebuffer(e.FRAMEBUFFER,null),s=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.FRAMEBUFFER,i)}else{var i=e.getParameter(e.DRAW_FRAMEBUFFER_BINDING);e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),s=e.getParameter(e.SAMPLES),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,i)}s>=ne.HIGH?this.multisample=ne.HIGH:s>=ne.MEDIUM?this.multisample=ne.MEDIUM:s>=ne.LOW?this.multisample=ne.LOW:this.multisample=ne.NONE},t.prototype.addSystem=function(e,s){var i=new e(this);if(this[s])throw new Error('Whoops! The name "'+s+'" is already in use');this[s]=i;for(var n in this.runners)this.runners[n].add(i);return this},t.prototype.render=function(e,s){var i,n,a,o;if(s&&(s instanceof we?(Er("6.0.0","Renderer#render arguments changed, use options instead."),i=s,n=arguments[2],a=arguments[3],o=arguments[4]):(i=s.renderTexture,n=s.clear,a=s.transform,o=s.skipUpdateTransform)),this.renderingToScreen=!i,this.runners.prerender.emit(),this.emit("prerender"),this.projection.transform=a,!this.context.isLost){if(i||(this._lastObjectRendered=e),!o){var h=e.enableTempParent();e.updateTransform(),e.disableTempParent(h)}this.renderTexture.bind(i),this.batch.currentRenderer.start(),(n!==void 0?n:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),i&&i.baseTexture.update(),this.runners.postrender.emit(),this.projection.transform=null,this.emit("postrender")}},t.prototype.generateTexture=function(e,s,i,n){s===void 0&&(s={});var a=r.prototype.generateTexture.call(this,e,s,i,n);return this.framebuffer.blit(),a},t.prototype.resize=function(e,s){r.prototype.resize.call(this,e,s),this.runners.resize.emit(this.screen.height,this.screen.width)},t.prototype.reset=function(){return this.runners.reset.emit(),this},t.prototype.clear=function(){this.renderTexture.bind(),this.renderTexture.clear()},t.prototype.destroy=function(e){this.runners.destroy.emit();for(var s in this.runners)this.runners[s].destroy();r.prototype.destroy.call(this,e),this.gl=null},Object.defineProperty(t.prototype,"extract",{get:function(){return Er("6.0.0","Renderer#extract has been deprecated, please use Renderer#plugins.extract instead."),this.plugins.extract},enumerable:!1,configurable:!0}),t.registerPlugin=function(e,s){Er("6.5.0","Renderer.registerPlugin() has been deprecated, please use extensions.add() instead."),hi.add({name:e,type:Re.RendererPlugin,ref:s})},t.__plugins={},t}(kL);hi.handleByMap(Re.RendererPlugin,Ng.__plugins);function YL(r){return Ng.create(r)}var WL=`attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,XL=`attribute vec2 aVertexPosition;

uniform mat3 projectionMatrix;

varying vec2 vTextureCoord;

uniform vec4 inputSize;
uniform vec4 outputFrame;

vec4 filterVertexPosition( void )
{
    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;

    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);
}

vec2 filterTextureCoord( void )
{
    return aVertexPosition * (outputFrame.zw * inputSize.zw);
}

void main(void)
{
    gl_Position = filterVertexPosition();
    vTextureCoord = filterTextureCoord();
}
`,KL=WL,qL=XL,Sd=function(){function r(){this.texArray=null,this.blend=0,this.type=lr.TRIANGLES,this.start=0,this.size=0,this.data=null}return r}(),yd=function(){function r(){this.elements=[],this.ids=[],this.count=0}return r.prototype.clear=function(){for(var t=0;t<this.count;t++)this.elements[t]=null;this.count=0},r}(),QL=function(){function r(t){typeof t=="number"?this.rawBinaryData=new ArrayBuffer(t):t instanceof Uint8Array?this.rawBinaryData=t.buffer:this.rawBinaryData=t,this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)}return Object.defineProperty(r.prototype,"int8View",{get:function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uint8View",{get:function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"int16View",{get:function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"uint16View",{get:function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"int32View",{get:function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},enumerable:!1,configurable:!0}),r.prototype.view=function(t){return this[t+"View"]},r.prototype.destroy=function(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},r.sizeOf=function(t){switch(t){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(t+" isn't a valid view type")}},r}(),ZL=function(r){$t(t,r);function t(e){var s=r.call(this,e)||this;return s.shaderGenerator=null,s.geometryClass=null,s.vertexSize=null,s.state=yh.for2d(),s.size=Z.SPRITE_BATCH_SIZE*4,s._vertexCount=0,s._indexCount=0,s._bufferedElements=[],s._bufferedTextures=[],s._bufferSize=0,s._shader=null,s._packedGeometries=[],s._packedGeometryPoolSize=2,s._flushId=0,s._aBuffers={},s._iBuffers={},s.MAX_TEXTURES=1,s.renderer.on("prerender",s.onPrerender,s),e.runners.contextChange.add(s),s._dcIndex=0,s._aIndex=0,s._iIndex=0,s._attributeBuffer=null,s._indexBuffer=null,s._tempBoundTextures=[],s}return t.prototype.contextChange=function(){var e=this.renderer.gl;Z.PREFER_ENV===ai.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Z.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=nL(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var s=0;s<this._packedGeometryPoolSize;s++)this._packedGeometries[s]=new this.geometryClass;this.initFlushBuffers()},t.prototype.initFlushBuffers=function(){for(var e=t._drawCallPool,s=t._textureArrayPool,i=this.size/4,n=Math.floor(i/this.MAX_TEXTURES)+1;e.length<i;)e.push(new Sd);for(;s.length<n;)s.push(new yd);for(var a=0;a<this.MAX_TEXTURES;a++)this._tempBoundTextures[a]=null},t.prototype.onPrerender=function(){this._flushId=0},t.prototype.render=function(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},t.prototype.buildTexturesAndDrawCalls=function(){var e=this,s=e._bufferedTextures,i=e.MAX_TEXTURES,n=t._textureArrayPool,a=this.renderer.batch,o=this._tempBoundTextures,h=this.renderer.textureGC.count,u=++Xt._globalBatch,c=0,l=n[0],_=0;a.copyBoundTextures(o,i);for(var d=0;d<this._bufferSize;++d){var f=s[d];s[d]=null,f._batchEnabled!==u&&(l.count>=i&&(a.boundArray(l,o,u,i),this.buildDrawCalls(l,_,d),_=d,l=n[++c],++u),f._batchEnabled=u,f.touched=h,l.elements[l.count++]=f)}l.count>0&&(a.boundArray(l,o,u,i),this.buildDrawCalls(l,_,this._bufferSize),++c,++u);for(var d=0;d<o.length;d++)o[d]=null;Xt._globalBatch=u},t.prototype.buildDrawCalls=function(e,s,i){var n=this,a=n._bufferedElements,o=n._attributeBuffer,h=n._indexBuffer,u=n.vertexSize,c=t._drawCallPool,l=this._dcIndex,_=this._aIndex,d=this._iIndex,f=c[l];f.start=this._iIndex,f.texArray=e;for(var m=s;m<i;++m){var p=a[m],T=p._texture.baseTexture,v=$I[T.alphaMode?1:0][p.blendMode];a[m]=null,s<m&&f.blend!==v&&(f.size=d-f.start,s=m,f=c[++l],f.texArray=e,f.start=d),this.packInterleavedGeometry(p,o,h,_,d),_+=p.vertexData.length/2*u,d+=p.indices.length,f.blend=v}s<i&&(f.size=d-f.start,++l),this._dcIndex=l,this._aIndex=_,this._iIndex=d},t.prototype.bindAndClearTexArray=function(e){for(var s=this.renderer.texture,i=0;i<e.count;i++)s.bind(e.elements[i],e.ids[i]),e.elements[i]=null;e.count=0},t.prototype.updateGeometry=function(){var e=this,s=e._packedGeometries,i=e._attributeBuffer,n=e._indexBuffer;Z.CAN_UPLOAD_SAME_BUFFER?(s[this._flushId]._buffer.update(i.rawBinaryData),s[this._flushId]._indexBuffer.update(n),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,s[this._flushId]=new this.geometryClass),s[this._flushId]._buffer.update(i.rawBinaryData),s[this._flushId]._indexBuffer.update(n),this.renderer.geometry.bind(s[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},t.prototype.drawBatches=function(){for(var e=this._dcIndex,s=this.renderer,i=s.gl,n=s.state,a=t._drawCallPool,o=null,h=0;h<e;h++){var u=a[h],c=u.texArray,l=u.type,_=u.size,d=u.start,f=u.blend;o!==c&&(o=c,this.bindAndClearTexArray(c)),this.state.blendMode=f,n.set(this.state),i.drawElements(l,_,i.UNSIGNED_SHORT,d*2)}},t.prototype.flush=function(){this._vertexCount!==0&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},t.prototype.start=function(){this.renderer.state.set(this.state),this.renderer.texture.ensureSamplerType(this.MAX_TEXTURES),this.renderer.shader.bind(this._shader),Z.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},t.prototype.stop=function(){this.flush()},t.prototype.destroy=function(){for(var e=0;e<this._packedGeometryPoolSize;e++)this._packedGeometries[e]&&this._packedGeometries[e].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),r.prototype.destroy.call(this)},t.prototype.getAttributeBuffer=function(e){var s=ml(Math.ceil(e/8)),i=Dp(s),n=s*8;this._aBuffers.length<=i&&(this._iBuffers.length=i+1);var a=this._aBuffers[n];return a||(this._aBuffers[n]=a=new QL(n*this.vertexSize*4)),a},t.prototype.getIndexBuffer=function(e){var s=ml(Math.ceil(e/12)),i=Dp(s),n=s*12;this._iBuffers.length<=i&&(this._iBuffers.length=i+1);var a=this._iBuffers[i];return a||(this._iBuffers[i]=a=new Uint16Array(n)),a},t.prototype.packInterleavedGeometry=function(e,s,i,n,a){for(var o=s.uint32View,h=s.float32View,u=n/this.vertexSize,c=e.uvs,l=e.indices,_=e.vertexData,d=e._texture.baseTexture._batchLocation,f=Math.min(e.worldAlpha,1),m=f<1&&e._texture.baseTexture.alphaMode?tT(e._tintRGB,f):e._tintRGB+(f*255<<24),p=0;p<_.length;p+=2)h[n++]=_[p],h[n++]=_[p+1],h[n++]=c[p],h[n++]=c[p+1],o[n++]=m,h[n++]=d;for(var p=0;p<l.length;p++)i[a++]=u+l[p]},t._drawCallPool=[],t._textureArrayPool=[],t}(t_),JL=function(){function r(t,e){if(this.vertexSrc=t,this.fragTemplate=e,this.programCache={},this.defaultGroupCache={},e.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(e.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')}return r.prototype.generateShader=function(t){if(!this.programCache[t]){for(var e=new Int32Array(t),s=0;s<t;s++)e[s]=s;this.defaultGroupCache[t]=Mn.from({uSamplers:e},!0);var i=this.fragTemplate;i=i.replace(/%count%/gi,""+t),i=i.replace(/%forloop%/gi,this.generateSampleSrc(t)),this.programCache[t]=new e_(this.vertexSrc,i)}var n={tint:new Float32Array([1,1,1,1]),translationMatrix:new Vt,default:this.defaultGroupCache[t]};return new Cn(this.programCache[t],n)},r.prototype.generateSampleSrc=function(t){var e="";e+=`
`,e+=`
`;for(var s=0;s<t;s++)s>0&&(e+=`
else `),s<t-1&&(e+="if(vTextureId < "+s+".5)"),e+=`
{`,e+=`
	color = texture2D(uSamplers[`+s+"], vTextureCoord);",e+=`
}`;return e+=`
`,e+=`
`,e},r}(),pT=function(r){$t(t,r);function t(e){e===void 0&&(e=!1);var s=r.call(this)||this;return s._buffer=new ns(null,e,!1),s._indexBuffer=new ns(null,e,!0),s.addAttribute("aVertexPosition",s._buffer,2,!1,xt.FLOAT).addAttribute("aTextureCoord",s._buffer,2,!1,xt.FLOAT).addAttribute("aColor",s._buffer,4,!0,xt.UNSIGNED_BYTE).addAttribute("aTextureId",s._buffer,1,!0,xt.FLOAT).addIndex(s._indexBuffer),s}return t}($l),Kp=`precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aColor;
attribute float aTextureId;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform vec4 tint;

varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;

void main(void){
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = aTextureCoord;
    vTextureId = aTextureId;
    vColor = aColor * tint;
}
`,qp=`varying vec2 vTextureCoord;
varying vec4 vColor;
varying float vTextureId;
uniform sampler2D uSamplers[%count%];

void main(void){
    vec4 color;
    %forloop%
    gl_FragColor = color * vColor;
}
`,$L=function(){function r(){}return r.create=function(t){var e=Object.assign({vertex:Kp,fragment:qp,geometryClass:pT,vertexSize:6},t),s=e.vertex,i=e.fragment,n=e.vertexSize,a=e.geometryClass;return function(o){$t(h,o);function h(u){var c=o.call(this,u)||this;return c.shaderGenerator=new JL(s,i),c.geometryClass=a,c.vertexSize=n,c}return h}(ZL)},Object.defineProperty(r,"defaultVertexSrc",{get:function(){return Kp},enumerable:!1,configurable:!0}),Object.defineProperty(r,"defaultFragmentTemplate",{get:function(){return qp},enumerable:!1,configurable:!0}),r}(),mT=$L.create();Object.assign(mT,{extension:{name:"batch",type:Re.RendererPlugin}});/*!
 * @pixi/loaders - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/loaders is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Ou=function(){function r(t,e,s){e===void 0&&(e=!1),this._fn=t,this._once=e,this._thisArg=s,this._next=this._prev=this._owner=null}return r.prototype.detach=function(){return this._owner===null?!1:(this._owner.detach(this),!0)},r}();function Qp(r,t){return r._head?(r._tail._next=t,t._prev=r._tail,r._tail=t):(r._head=t,r._tail=t),t._owner=r,t}var Wr=function(){function r(){this._head=this._tail=void 0}return r.prototype.handlers=function(t){t===void 0&&(t=!1);var e=this._head;if(t)return!!e;for(var s=[];e;)s.push(e),e=e._next;return s},r.prototype.has=function(t){if(!(t instanceof Ou))throw new Error("MiniSignal#has(): First arg must be a SignalBinding object.");return t._owner===this},r.prototype.dispatch=function(){for(var t=arguments,e=[],s=0;s<arguments.length;s++)e[s]=t[s];var i=this._head;if(!i)return!1;for(;i;)i._once&&this.detach(i),i._fn.apply(i._thisArg,e),i=i._next;return!0},r.prototype.add=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#add(): First arg must be a Function.");return Qp(this,new Ou(t,!1,e))},r.prototype.once=function(t,e){if(e===void 0&&(e=null),typeof t!="function")throw new Error("MiniSignal#once(): First arg must be a Function.");return Qp(this,new Ou(t,!0,e))},r.prototype.detach=function(t){if(!(t instanceof Ou))throw new Error("MiniSignal#detach(): First arg must be a SignalBinding object.");return t._owner!==this?this:(t._prev&&(t._prev._next=t._next),t._next&&(t._next._prev=t._prev),t===this._head?(this._head=t._next,t._next===null&&(this._tail=null)):t===this._tail&&(this._tail=t._prev,this._tail._next=null),t._owner=null,this)},r.prototype.detachAll=function(){var t=this._head;if(!t)return this;for(this._head=this._tail=null;t;)t._owner=null,t=t._next;return this},r}();function IT(r,t){t=t||{};for(var e={key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}},s=e.parser[t.strictMode?"strict":"loose"].exec(r),i={},n=14;n--;)i[e.key[n]]=s[n]||"";return i[e.q.name]={},i[e.key[12]].replace(e.q.parser,function(a,o,h){o&&(i[e.q.name][o]=h)}),i}var Rc,vu=null,tU=0,Zp=200,eU=204,sU=1223,rU=2;function Jp(){}function $p(r,t,e){t&&t.indexOf(".")===0&&(t=t.substring(1)),t&&(r[t]=e)}function Oc(r){return r.toString().replace("object ","")}var ls=function(){function r(t,e,s){if(this._dequeue=Jp,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=null,this._boundOnError=null,this._boundOnProgress=null,this._boundOnTimeout=null,this._boundXhrOnError=null,this._boundXhrOnTimeout=null,this._boundXhrOnAbort=null,this._boundXhrOnLoad=null,typeof t!="string"||typeof e!="string")throw new Error("Both name and url are required for constructing a resource.");s=s||{},this._flags=0,this._setFlag(r.STATUS_FLAGS.DATA_URL,e.indexOf("data:")===0),this.name=t,this.url=e,this.extension=this._getExtension(),this.data=null,this.crossOrigin=s.crossOrigin===!0?"anonymous":s.crossOrigin,this.timeout=s.timeout||0,this.loadType=s.loadType||this._determineLoadType(),this.xhrType=s.xhrType,this.metadata=s.metadata||{},this.error=null,this.xhr=null,this.children=[],this.type=r.TYPE.UNKNOWN,this.progressChunk=0,this._dequeue=Jp,this._onLoadBinding=null,this._elementTimer=0,this._boundComplete=this.complete.bind(this),this._boundOnError=this._onError.bind(this),this._boundOnProgress=this._onProgress.bind(this),this._boundOnTimeout=this._onTimeout.bind(this),this._boundXhrOnError=this._xhrOnError.bind(this),this._boundXhrOnTimeout=this._xhrOnTimeout.bind(this),this._boundXhrOnAbort=this._xhrOnAbort.bind(this),this._boundXhrOnLoad=this._xhrOnLoad.bind(this),this.onStart=new Wr,this.onProgress=new Wr,this.onComplete=new Wr,this.onAfterMiddleware=new Wr}return r.setExtensionLoadType=function(t,e){$p(r._loadTypeMap,t,e)},r.setExtensionXhrType=function(t,e){$p(r._xhrTypeMap,t,e)},Object.defineProperty(r.prototype,"isDataUrl",{get:function(){return this._hasFlag(r.STATUS_FLAGS.DATA_URL)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isComplete",{get:function(){return this._hasFlag(r.STATUS_FLAGS.COMPLETE)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"isLoading",{get:function(){return this._hasFlag(r.STATUS_FLAGS.LOADING)},enumerable:!1,configurable:!0}),r.prototype.complete=function(){this._clearEvents(),this._finish()},r.prototype.abort=function(t){if(!this.error){if(this.error=new Error(t),this._clearEvents(),this.xhr)this.xhr.abort();else if(this.xdr)this.xdr.abort();else if(this.data)if(this.data.src)this.data.src=r.EMPTY_GIF;else for(;this.data.firstChild;)this.data.removeChild(this.data.firstChild);this._finish()}},r.prototype.load=function(t){var e=this;if(!this.isLoading){if(this.isComplete){t&&setTimeout(function(){return t(e)},1);return}else t&&this.onComplete.once(t);switch(this._setFlag(r.STATUS_FLAGS.LOADING,!0),this.onStart.dispatch(this),(this.crossOrigin===!1||typeof this.crossOrigin!="string")&&(this.crossOrigin=this._determineCrossOrigin(this.url)),this.loadType){case r.LOAD_TYPE.IMAGE:this.type=r.TYPE.IMAGE,this._loadElement("image");break;case r.LOAD_TYPE.AUDIO:this.type=r.TYPE.AUDIO,this._loadSourceElement("audio");break;case r.LOAD_TYPE.VIDEO:this.type=r.TYPE.VIDEO,this._loadSourceElement("video");break;case r.LOAD_TYPE.XHR:default:typeof Rc>"u"&&(Rc=!!(globalThis.XDomainRequest&&!("withCredentials"in new XMLHttpRequest))),Rc&&this.crossOrigin?this._loadXdr():this._loadXhr();break}}},r.prototype._hasFlag=function(t){return(this._flags&t)!==0},r.prototype._setFlag=function(t,e){this._flags=e?this._flags|t:this._flags&~t},r.prototype._clearEvents=function(){clearTimeout(this._elementTimer),this.data&&this.data.removeEventListener&&(this.data.removeEventListener("error",this._boundOnError,!1),this.data.removeEventListener("load",this._boundComplete,!1),this.data.removeEventListener("progress",this._boundOnProgress,!1),this.data.removeEventListener("canplaythrough",this._boundComplete,!1)),this.xhr&&(this.xhr.removeEventListener?(this.xhr.removeEventListener("error",this._boundXhrOnError,!1),this.xhr.removeEventListener("timeout",this._boundXhrOnTimeout,!1),this.xhr.removeEventListener("abort",this._boundXhrOnAbort,!1),this.xhr.removeEventListener("progress",this._boundOnProgress,!1),this.xhr.removeEventListener("load",this._boundXhrOnLoad,!1)):(this.xhr.onerror=null,this.xhr.ontimeout=null,this.xhr.onprogress=null,this.xhr.onload=null))},r.prototype._finish=function(){if(this.isComplete)throw new Error("Complete called again for an already completed resource.");this._setFlag(r.STATUS_FLAGS.COMPLETE,!0),this._setFlag(r.STATUS_FLAGS.LOADING,!1),this.onComplete.dispatch(this)},r.prototype._loadElement=function(t){this.metadata.loadElement?this.data=this.metadata.loadElement:t==="image"&&typeof globalThis.Image<"u"?this.data=new Image:this.data=document.createElement(t),this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),this.metadata.skipSource||(this.data.src=this.url),this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},r.prototype._loadSourceElement=function(t){if(this.metadata.loadElement?this.data=this.metadata.loadElement:t==="audio"&&typeof globalThis.Audio<"u"?this.data=new Audio:this.data=document.createElement(t),this.data===null){this.abort("Unsupported element: "+t);return}if(this.crossOrigin&&(this.data.crossOrigin=this.crossOrigin),!this.metadata.skipSource)if(navigator.isCocoonJS)this.data.src=Array.isArray(this.url)?this.url[0]:this.url;else if(Array.isArray(this.url))for(var e=this.metadata.mimeType,s=0;s<this.url.length;++s)this.data.appendChild(this._createSource(t,this.url[s],Array.isArray(e)?e[s]:e));else{var e=this.metadata.mimeType;this.data.appendChild(this._createSource(t,this.url,Array.isArray(e)?e[0]:e))}this.data.addEventListener("error",this._boundOnError,!1),this.data.addEventListener("load",this._boundComplete,!1),this.data.addEventListener("progress",this._boundOnProgress,!1),this.data.addEventListener("canplaythrough",this._boundComplete,!1),this.data.load(),this.timeout&&(this._elementTimer=setTimeout(this._boundOnTimeout,this.timeout))},r.prototype._loadXhr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new XMLHttpRequest;this.crossOrigin==="use-credentials"&&(t.withCredentials=!0),t.open("GET",this.url,!0),t.timeout=this.timeout,this.xhrType===r.XHR_RESPONSE_TYPE.JSON||this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT?t.responseType=r.XHR_RESPONSE_TYPE.TEXT:t.responseType=this.xhrType,t.addEventListener("error",this._boundXhrOnError,!1),t.addEventListener("timeout",this._boundXhrOnTimeout,!1),t.addEventListener("abort",this._boundXhrOnAbort,!1),t.addEventListener("progress",this._boundOnProgress,!1),t.addEventListener("load",this._boundXhrOnLoad,!1),t.send()},r.prototype._loadXdr=function(){typeof this.xhrType!="string"&&(this.xhrType=this._determineXhrType());var t=this.xhr=new globalThis.XDomainRequest;t.timeout=this.timeout||5e3,t.onerror=this._boundXhrOnError,t.ontimeout=this._boundXhrOnTimeout,t.onprogress=this._boundOnProgress,t.onload=this._boundXhrOnLoad,t.open("GET",this.url,!0),setTimeout(function(){return t.send()},1)},r.prototype._createSource=function(t,e,s){s||(s=t+"/"+this._getExtension(e));var i=document.createElement("source");return i.src=e,i.type=s,i},r.prototype._onError=function(t){this.abort("Failed to load element using: "+t.target.nodeName)},r.prototype._onProgress=function(t){t&&t.lengthComputable&&this.onProgress.dispatch(this,t.loaded/t.total)},r.prototype._onTimeout=function(){this.abort("Load timed out.")},r.prototype._xhrOnError=function(){var t=this.xhr;this.abort(Oc(t)+" Request failed. Status: "+t.status+', text: "'+t.statusText+'"')},r.prototype._xhrOnTimeout=function(){var t=this.xhr;this.abort(Oc(t)+" Request timed out.")},r.prototype._xhrOnAbort=function(){var t=this.xhr;this.abort(Oc(t)+" Request was aborted by the user.")},r.prototype._xhrOnLoad=function(){var t=this.xhr,e="",s=typeof t.status>"u"?Zp:t.status;(t.responseType===""||t.responseType==="text"||typeof t.responseType>"u")&&(e=t.responseText),s===tU&&(e.length>0||t.responseType===r.XHR_RESPONSE_TYPE.BUFFER)?s=Zp:s===sU&&(s=eU);var i=s/100|0;if(i===rU)if(this.xhrType===r.XHR_RESPONSE_TYPE.TEXT)this.data=e,this.type=r.TYPE.TEXT;else if(this.xhrType===r.XHR_RESPONSE_TYPE.JSON)try{this.data=JSON.parse(e),this.type=r.TYPE.JSON}catch(o){this.abort("Error trying to parse loaded json: "+o);return}else if(this.xhrType===r.XHR_RESPONSE_TYPE.DOCUMENT)try{if(globalThis.DOMParser){var n=new DOMParser;this.data=n.parseFromString(e,"text/xml")}else{var a=document.createElement("div");a.innerHTML=e,this.data=a}this.type=r.TYPE.XML}catch(o){this.abort("Error trying to parse loaded xml: "+o);return}else this.data=t.response||e;else{this.abort("["+t.status+"] "+t.statusText+": "+t.responseURL);return}this.complete()},r.prototype._determineCrossOrigin=function(t,e){if(t.indexOf("data:")===0)return"";if(globalThis.origin!==globalThis.location.origin)return"anonymous";e=e||globalThis.location,vu||(vu=document.createElement("a")),vu.href=t;var s=IT(vu.href,{strictMode:!0}),i=!s.port&&e.port===""||s.port===e.port,n=s.protocol?s.protocol+":":"";return s.host!==e.hostname||!i||n!==e.protocol?"anonymous":""},r.prototype._determineXhrType=function(){return r._xhrTypeMap[this.extension]||r.XHR_RESPONSE_TYPE.TEXT},r.prototype._determineLoadType=function(){return r._loadTypeMap[this.extension]||r.LOAD_TYPE.XHR},r.prototype._getExtension=function(t){t===void 0&&(t=this.url);var e="";if(this.isDataUrl){var s=t.indexOf("/");e=t.substring(s+1,t.indexOf(";",s))}else{var i=t.indexOf("?"),n=t.indexOf("#"),a=Math.min(i>-1?i:t.length,n>-1?n:t.length);t=t.substring(0,a),e=t.substring(t.lastIndexOf(".")+1)}return e.toLowerCase()},r.prototype._getMimeFromXhrType=function(t){switch(t){case r.XHR_RESPONSE_TYPE.BUFFER:return"application/octet-binary";case r.XHR_RESPONSE_TYPE.BLOB:return"application/blob";case r.XHR_RESPONSE_TYPE.DOCUMENT:return"application/xml";case r.XHR_RESPONSE_TYPE.JSON:return"application/json";case r.XHR_RESPONSE_TYPE.DEFAULT:case r.XHR_RESPONSE_TYPE.TEXT:default:return"text/plain"}},r}();(function(r){(function(t){t[t.NONE=0]="NONE",t[t.DATA_URL=1]="DATA_URL",t[t.COMPLETE=2]="COMPLETE",t[t.LOADING=4]="LOADING"})(r.STATUS_FLAGS||(r.STATUS_FLAGS={})),function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JSON=1]="JSON",t[t.XML=2]="XML",t[t.IMAGE=3]="IMAGE",t[t.AUDIO=4]="AUDIO",t[t.VIDEO=5]="VIDEO",t[t.TEXT=6]="TEXT"}(r.TYPE||(r.TYPE={})),function(t){t[t.XHR=1]="XHR",t[t.IMAGE=2]="IMAGE",t[t.AUDIO=3]="AUDIO",t[t.VIDEO=4]="VIDEO"}(r.LOAD_TYPE||(r.LOAD_TYPE={})),function(t){t.DEFAULT="text",t.BUFFER="arraybuffer",t.BLOB="blob",t.DOCUMENT="document",t.JSON="json",t.TEXT="text"}(r.XHR_RESPONSE_TYPE||(r.XHR_RESPONSE_TYPE={})),r._loadTypeMap={gif:r.LOAD_TYPE.IMAGE,png:r.LOAD_TYPE.IMAGE,bmp:r.LOAD_TYPE.IMAGE,jpg:r.LOAD_TYPE.IMAGE,jpeg:r.LOAD_TYPE.IMAGE,tif:r.LOAD_TYPE.IMAGE,tiff:r.LOAD_TYPE.IMAGE,webp:r.LOAD_TYPE.IMAGE,tga:r.LOAD_TYPE.IMAGE,avif:r.LOAD_TYPE.IMAGE,svg:r.LOAD_TYPE.IMAGE,"svg+xml":r.LOAD_TYPE.IMAGE,mp3:r.LOAD_TYPE.AUDIO,ogg:r.LOAD_TYPE.AUDIO,wav:r.LOAD_TYPE.AUDIO,mp4:r.LOAD_TYPE.VIDEO,webm:r.LOAD_TYPE.VIDEO},r._xhrTypeMap={xhtml:r.XHR_RESPONSE_TYPE.DOCUMENT,html:r.XHR_RESPONSE_TYPE.DOCUMENT,htm:r.XHR_RESPONSE_TYPE.DOCUMENT,xml:r.XHR_RESPONSE_TYPE.DOCUMENT,tmx:r.XHR_RESPONSE_TYPE.DOCUMENT,svg:r.XHR_RESPONSE_TYPE.DOCUMENT,tsx:r.XHR_RESPONSE_TYPE.DOCUMENT,gif:r.XHR_RESPONSE_TYPE.BLOB,png:r.XHR_RESPONSE_TYPE.BLOB,bmp:r.XHR_RESPONSE_TYPE.BLOB,jpg:r.XHR_RESPONSE_TYPE.BLOB,jpeg:r.XHR_RESPONSE_TYPE.BLOB,tif:r.XHR_RESPONSE_TYPE.BLOB,tiff:r.XHR_RESPONSE_TYPE.BLOB,webp:r.XHR_RESPONSE_TYPE.BLOB,tga:r.XHR_RESPONSE_TYPE.BLOB,avif:r.XHR_RESPONSE_TYPE.BLOB,json:r.XHR_RESPONSE_TYPE.JSON,text:r.XHR_RESPONSE_TYPE.TEXT,txt:r.XHR_RESPONSE_TYPE.TEXT,ttf:r.XHR_RESPONSE_TYPE.BUFFER,otf:r.XHR_RESPONSE_TYPE.BUFFER},r.EMPTY_GIF="data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw=="})(ls||(ls={}));function Zi(){}function iU(r){return function(){for(var e=arguments,s=[],i=0;i<arguments.length;i++)s[i]=e[i];if(r===null)throw new Error("Callback was already called.");var n=r;r=null,n.apply(this,s)}}var nU=function(){function r(t,e){this.data=t,this.callback=e}return r}(),vc=function(){function r(t,e){var s=this;if(e===void 0&&(e=1),this.workers=0,this.saturated=Zi,this.unsaturated=Zi,this.empty=Zi,this.drain=Zi,this.error=Zi,this.started=!1,this.paused=!1,this._tasks=[],this._insert=function(i,n,a){if(a&&typeof a!="function")throw new Error("task callback must be a function");if(s.started=!0,i==null&&s.idle()){setTimeout(function(){return s.drain()},1);return}var o=new nU(i,typeof a=="function"?a:Zi);n?s._tasks.unshift(o):s._tasks.push(o),setTimeout(s.process,1)},this.process=function(){for(;!s.paused&&s.workers<s.concurrency&&s._tasks.length;){var i=s._tasks.shift();s._tasks.length===0&&s.empty(),s.workers+=1,s.workers===s.concurrency&&s.saturated(),s._worker(i.data,iU(s._next(i)))}},this._worker=t,e===0)throw new Error("Concurrency must not be zero");this.concurrency=e,this.buffer=e/4}return r.prototype._next=function(t){var e=this;return function(){for(var s=arguments,i=[],n=0;n<arguments.length;n++)i[n]=s[n];e.workers-=1,t.callback.apply(t,i),i[0]!=null&&e.error(i[0],t.data),e.workers<=e.concurrency-e.buffer&&e.unsaturated(),e.idle()&&e.drain(),e.process()}},r.prototype.push=function(t,e){this._insert(t,!1,e)},r.prototype.kill=function(){this.workers=0,this.drain=Zi,this.started=!1,this._tasks=[]},r.prototype.unshift=function(t,e){this._insert(t,!0,e)},r.prototype.length=function(){return this._tasks.length},r.prototype.running=function(){return this.workers},r.prototype.idle=function(){return this._tasks.length+this.workers===0},r.prototype.pause=function(){this.paused!==!0&&(this.paused=!0)},r.prototype.resume=function(){if(this.paused!==!1){this.paused=!1;for(var t=1;t<=this.concurrency;t++)this.process()}},r.eachSeries=function(t,e,s,i){var n=0,a=t.length;function o(h){if(h||n===a){s&&s(h);return}i?setTimeout(function(){e(t[n++],o)},1):e(t[n++],o)}o()},r.queue=function(t,e){return new r(t,e)},r}(),Ac=100,aU=/(#[\w-]+)?$/,Il=function(){function r(t,e){var s=this;t===void 0&&(t=""),e===void 0&&(e=10),this.progress=0,this.loading=!1,this.defaultQueryString="",this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(h,u){return s._loadResource(h,u)},this.resources={},this.baseUrl=t,this._beforeMiddleware=[],this._afterMiddleware=[],this._resourcesParsing=[],this._boundLoadResource=function(h,u){return s._loadResource(h,u)},this._queue=vc.queue(this._boundLoadResource,e),this._queue.pause(),this.resources={},this.onProgress=new Wr,this.onError=new Wr,this.onLoad=new Wr,this.onStart=new Wr,this.onComplete=new Wr;for(var i=0;i<r._plugins.length;++i){var n=r._plugins[i],a=n.pre,o=n.use;a&&this.pre(a),o&&this.use(o)}this._protected=!1}return r.prototype._add=function(t,e,s,i){if(this.loading&&(!s||!s.parentResource))throw new Error("Cannot add resources while the loader is running.");if(this.resources[t])throw new Error('Resource named "'+t+'" already exists.');if(e=this._prepareUrl(e),this.resources[t]=new ls(t,e,s),typeof i=="function"&&this.resources[t].onAfterMiddleware.once(i),this.loading){for(var n=s.parentResource,a=[],o=0;o<n.children.length;++o)n.children[o].isComplete||a.push(n.children[o]);var h=n.progressChunk*(a.length+1),u=h/(a.length+2);n.children.push(this.resources[t]),n.progressChunk=u;for(var o=0;o<a.length;++o)a[o].progressChunk=u;this.resources[t].progressChunk=u}return this._queue.push(this.resources[t]),this},r.prototype.pre=function(t){return this._beforeMiddleware.push(t),this},r.prototype.use=function(t){return this._afterMiddleware.push(t),this},r.prototype.reset=function(){this.progress=0,this.loading=!1,this._queue.kill(),this._queue.pause();for(var t in this.resources){var e=this.resources[t];e._onLoadBinding&&e._onLoadBinding.detach(),e.isLoading&&e.abort("loader reset")}return this.resources={},this},r.prototype.load=function(t){if(Er("6.5.0","@pixi/loaders is being replaced with @pixi/assets in the next major release."),typeof t=="function"&&this.onComplete.once(t),this.loading)return this;if(this._queue.idle())this._onStart(),this._onComplete();else{for(var e=this._queue._tasks.length,s=Ac/e,i=0;i<this._queue._tasks.length;++i)this._queue._tasks[i].data.progressChunk=s;this._onStart(),this._queue.resume()}return this},Object.defineProperty(r.prototype,"concurrency",{get:function(){return this._queue.concurrency},set:function(t){this._queue.concurrency=t},enumerable:!1,configurable:!0}),r.prototype._prepareUrl=function(t){var e=IT(t,{strictMode:!0}),s;if(e.protocol||!e.path||t.indexOf("//")===0?s=t:this.baseUrl.length&&this.baseUrl.lastIndexOf("/")!==this.baseUrl.length-1&&t.charAt(0)!=="/"?s=this.baseUrl+"/"+t:s=this.baseUrl+t,this.defaultQueryString){var i=aU.exec(s)[0];s=s.slice(0,s.length-i.length),s.indexOf("?")!==-1?s+="&"+this.defaultQueryString:s+="?"+this.defaultQueryString,s+=i}return s},r.prototype._loadResource=function(t,e){var s=this;t._dequeue=e,vc.eachSeries(this._beforeMiddleware,function(i,n){i.call(s,t,function(){n(t.isComplete?{}:null)})},function(){t.isComplete?s._onLoad(t):(t._onLoadBinding=t.onComplete.once(s._onLoad,s),t.load())},!0)},r.prototype._onStart=function(){this.progress=0,this.loading=!0,this.onStart.dispatch(this)},r.prototype._onComplete=function(){this.progress=Ac,this.loading=!1,this.onComplete.dispatch(this,this.resources)},r.prototype._onLoad=function(t){var e=this;t._onLoadBinding=null,this._resourcesParsing.push(t),t._dequeue(),vc.eachSeries(this._afterMiddleware,function(s,i){s.call(e,t,i)},function(){t.onAfterMiddleware.dispatch(t),e.progress=Math.min(Ac,e.progress+t.progressChunk),e.onProgress.dispatch(e,t),t.error?e.onError.dispatch(t.error,e,t):e.onLoad.dispatch(e,t),e._resourcesParsing.splice(e._resourcesParsing.indexOf(t),1),e._queue.idle()&&e._resourcesParsing.length===0&&e._onComplete()},!0)},r.prototype.destroy=function(){this._protected||this.reset()},Object.defineProperty(r,"shared",{get:function(){var t=r._shared;return t||(t=new r,t._protected=!0,r._shared=t),t},enumerable:!1,configurable:!0}),r.registerPlugin=function(t){return Er("6.5.0","Loader.registerPlugin() is deprecated, use extensions.add() instead."),hi.add({type:Re.Loader,ref:t}),r},r._plugins=[],r}();hi.handleByList(Re.Loader,Il._plugins);Il.prototype.add=function(t,e,s,i){if(Array.isArray(t)){for(var n=0;n<t.length;++n)this.add(t[n]);return this}if(typeof t=="object"&&(s=t,i=e||s.callback||s.onComplete,e=s.url,t=s.name||s.key||s.url),typeof e!="string"&&(i=s,s=e,e=t),typeof e!="string")throw new Error("No url passed to add resource to loader.");return typeof s=="function"&&(i=s,s=null),this._add(t,e,s,i)};var oU=function(){function r(){}return r.init=function(t){t=Object.assign({sharedLoader:!1},t),this.loader=t.sharedLoader?Il.shared:new Il},r.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},r.extension=Re.Application,r}(),hU=function(){function r(){}return r.add=function(){ls.setExtensionLoadType("svg",ls.LOAD_TYPE.XHR),ls.setExtensionXhrType("svg",ls.XHR_RESPONSE_TYPE.TEXT)},r.use=function(t,e){if(t.data&&(t.type===ls.TYPE.IMAGE||t.extension==="svg")){var s=t.data,i=t.url,n=t.name,a=t.metadata;_t.fromLoader(s,i,n,a).then(function(o){t.texture=o,e()}).catch(e)}else e()},r.extension=Re.Loader,r}(),uU="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function lU(r){for(var t="",e=0;e<r.length;){for(var s=[0,0,0],i=[0,0,0,0],n=0;n<s.length;++n)e<r.length?s[n]=r.charCodeAt(e++)&255:s[n]=0;i[0]=s[0]>>2,i[1]=(s[0]&3)<<4|s[1]>>4,i[2]=(s[1]&15)<<2|s[2]>>6,i[3]=s[2]&63;var a=e-(r.length-1);switch(a){case 2:i[3]=64,i[2]=64;break;case 1:i[3]=64;break}for(var n=0;n<i.length;++n)t+=uU.charAt(i[n])}return t}function _U(r,t){if(!r.data){t();return}if(r.xhr&&r.xhrType===ls.XHR_RESPONSE_TYPE.BLOB){if(!self.Blob||typeof r.data=="string"){var e=r.xhr.getResponseHeader("content-type");if(e&&e.indexOf("image")===0){r.data=new Image,r.data.src="data:"+e+";base64,"+lU(r.xhr.responseText),r.type=ls.TYPE.IMAGE,r.data.onload=function(){r.data.onload=null,t()};return}}else if(r.data.type.indexOf("image")===0){var s=globalThis.URL||globalThis.webkitURL,i=s.createObjectURL(r.data);r.blob=r.data,r.data=new Image,r.data.src=i,r.type=ls.TYPE.IMAGE,r.data.onload=function(){s.revokeObjectURL(i),r.data.onload=null,t()};return}}t()}var cU=function(){function r(){}return r.extension=Re.Loader,r.use=_U,r}();hi.add(hU,cU);/*!
 * @pixi/spritesheet - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/spritesheet is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var bg=function(){function r(t,e,s){s===void 0&&(s=null),this.linkedSheets=[],this._texture=t instanceof _t?t:null,this.baseTexture=t instanceof Xt?t:this._texture.baseTexture,this.textures={},this.animations={},this.data=e;var i=this.baseTexture.resource;this.resolution=this._updateResolution(s||(i?i.url:null)),this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}return r.prototype._updateResolution=function(t){t===void 0&&(t=null);var e=this.data.meta.scale,s=Id(t,null);return s===null&&(s=e!==void 0?parseFloat(e):1),s!==1&&this.baseTexture.setResolution(s),s},r.prototype.parse=function(t){var e=this;return t&&Er("6.5.0","Spritesheet.parse callback is deprecated, use the return Promise instead."),new Promise(function(s){e._callback=function(i){t==null||t(i),s(i)},e._batchIndex=0,e._frameKeys.length<=r.BATCH_SIZE?(e._processFrames(0),e._processAnimations(),e._parseComplete()):e._nextBatch()})},r.prototype._processFrames=function(t){for(var e=t,s=r.BATCH_SIZE;e-t<s&&e<this._frameKeys.length;){var i=this._frameKeys[e],n=this._frames[i],a=n.frame;if(a){var o=null,h=null,u=n.trimmed!==!1&&n.sourceSize?n.sourceSize:n.frame,c=new it(0,0,Math.floor(u.w)/this.resolution,Math.floor(u.h)/this.resolution);n.rotated?o=new it(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.h)/this.resolution,Math.floor(a.w)/this.resolution):o=new it(Math.floor(a.x)/this.resolution,Math.floor(a.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution),n.trimmed!==!1&&n.spriteSourceSize&&(h=new it(Math.floor(n.spriteSourceSize.x)/this.resolution,Math.floor(n.spriteSourceSize.y)/this.resolution,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution)),this.textures[i]=new _t(this.baseTexture,o,c,h,n.rotated?2:0,n.anchor),_t.addToCache(this.textures[i],i)}e++}},r.prototype._processAnimations=function(){var t=this.data.animations||{};for(var e in t){this.animations[e]=[];for(var s=0;s<t[e].length;s++){var i=t[e][s];this.animations[e].push(this.textures[i])}}},r.prototype._parseComplete=function(){var t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)},r.prototype._nextBatch=function(){var t=this;this._processFrames(this._batchIndex*r.BATCH_SIZE),this._batchIndex++,setTimeout(function(){t._batchIndex*r.BATCH_SIZE<t._frameKeys.length?t._nextBatch():(t._processAnimations(),t._parseComplete())},0)},r.prototype.destroy=function(t){var e;t===void 0&&(t=!1);for(var s in this.textures)this.textures[s].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&((e=this._texture)===null||e===void 0||e.destroy(),this.baseTexture.destroy()),this._texture=null,this.baseTexture=null,this.linkedSheets=[]},r.BATCH_SIZE=1e3,r}(),dU=function(){function r(){}return r.use=function(t,e){var s,i,n=this,a=t.name+"_image";if(!t.data||t.type!==ls.TYPE.JSON||!t.data.frames||n.resources[a]){e();return}var o=(i=(s=t.data)===null||s===void 0?void 0:s.meta)===null||i===void 0?void 0:i.related_multi_packs;if(Array.isArray(o))for(var h=function(f){if(typeof f!="string")return"continue";var m=f.replace(".json",""),p=Oo.resolve(t.url.replace(n.baseUrl,""),f);if(n.resources[m]||Object.values(n.resources).some(function(v){return Oo.format(Oo.parse(v.url))===p}))return"continue";var T={crossOrigin:t.crossOrigin,loadType:ls.LOAD_TYPE.XHR,xhrType:ls.XHR_RESPONSE_TYPE.JSON,parentResource:t,metadata:t.metadata};n.add(m,p,T)},u=0,c=o;u<c.length;u++){var l=c[u];h(l)}var _={crossOrigin:t.crossOrigin,metadata:t.metadata.imageMetadata,parentResource:t},d=r.getResourcePath(t,n.baseUrl);n.add(a,d,_,function(m){if(m.error){e(m.error);return}var p=new bg(m.texture,t.data,t.url);p.parse().then(function(){t.spritesheet=p,t.textures=p.textures,e()})})},r.getResourcePath=function(t,e){return t.isDataUrl?t.data.meta.image:Oo.resolve(t.url.replace(e,""),t.data.meta.image)},r.extension=Re.Loader,r}();class Y{static log(...t){this.LOG_DEBUG&&console.log(this.logPrefix(),...t)}static warn(...t){this.LOG_WARN&&console.warn(this.logPrefix(),...t)}static error(...t){this.LOG_ERROR&&console.error(this.logPrefix(),...t)}static events(...t){this.LOG_EVENTS&&console.log(this.logPrefix(),...t)}static packets(...t){this.LOG_PACKETS&&console.log(this.logPrefix(),...t)}static logPrefix(){return"[Nitro]"}}Y.LOG_DEBUG=!1;Y.LOG_WARN=!1;Y.LOG_ERROR=!1;Y.LOG_EVENTS=!1;Y.LOG_PACKETS=!1;class de{constructor(t=null){if(this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],t)for(const[e,s]of t.entries())this.add(e,s)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._length=0,this._array=[],this._keys=[]}unshift(t,e){return this._dictionary.get(t)!==null?!1:(this._dictionary.set(t,e),this._array.unshift(e),this._keys.unshift(t),this._length++,!0)}add(t,e){return this._dictionary.get(t)!==void 0?!1:(this._dictionary.set(t,e),this._array[this._length]=e,this._keys[this._length]=t,this._length++,!0)}remove(t){const e=this._dictionary.get(t);if(!e)return null;const s=this._array.indexOf(e);return s>=0&&(this._array.splice(s,1),this._keys.splice(s,1),this._length--),this._dictionary.delete(t),e}getWithIndex(t){return t<0||t>=this._length?null:this._array[t]}getKey(t){return t<0||t>=this._length?null:this._keys[t]}getKeys(){return this._keys.slice()}hasKey(t){return this._keys.indexOf(t)>-1}getValue(t){return this._dictionary.get(t)}getValues(){return this._array.slice()}hasValue(t){return this._array.indexOf(t)>-1}indexOf(t){return this._array.indexOf(t)}concatenate(t){for(const e of t._keys)this.add(e,t.getValue(e))}clone(){const t=new de;return t.concatenate(this),t}}const TT=r=>{let t="";const e=new Uint8Array(r),s=e.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(e[i]);return window.btoa(t)};class s_{constructor(t){this._position=0,this._dataView=new DataView(t)}readBytes(t){const e=new s_(this._dataView.buffer.slice(this._position,this._position+t));return this._position+=t,e}readByte(){const t=this._dataView.getInt8(this._position);return this._position++,t}readShort(){const t=this._dataView.getInt16(this._position);return this._position+=2,t}readInt(){const t=this._dataView.getInt32(this._position);return this._position+=4,t}readFloat(){const t=this._dataView.getFloat32(this._position);return this._position+=4,t}readDouble(){const t=this._dataView.getFloat64(this._position);return this._position+=8,t}remaining(){return this._dataView.byteLength-this._position}toString(t){return new TextDecoder().decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class tm{constructor(){this._buffer=new Uint8Array,this._position=0}writeByte(t){const e=new Uint8Array(1);return e[0]=t,this.appendArray(e),this}writeBytes(t){const e=new Uint8Array(t);return this.appendArray(e),this}writeShort(t){const e=new Uint8Array(2);return e[0]=t>>8,e[1]=t&255,this.appendArray(e),this}writeInt(t){const e=new Uint8Array(4);return e[0]=t>>24,e[1]=t>>16,e[2]=t>>8,e[3]=t&255,this.appendArray(e),this}writeString(t,e=!0){const s=new TextEncoder().encode(t);return e?(this.writeShort(s.length),this.appendArray(s)):this.appendArray(s),this}appendArray(t){if(!t)return;const e=new Uint8Array(this.position+t.length>this._buffer.length?this.position+t.length:this._buffer.length);e.set(this._buffer),e.set(t,this.position),this._buffer=e,this.position+=t.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(t){this._position=t}toString(t){return new TextDecoder(t).decode(this._buffer)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const fU=4,em=0,sm=1,gU=2;function Xa(r){let t=r.length;for(;--t>=0;)r[t]=0}const EU=0,RT=1,pU=2,mU=3,IU=258,Pg=29,Mh=256,ih=Mh+1+Pg,Na=30,Dg=19,OT=2*ih+1,pn=15,Sc=16,TU=7,Lg=256,vT=16,AT=17,ST=18,Md=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),ku=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),RU=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),yT=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),OU=512,Vr=new Array((ih+2)*2);Xa(Vr);const Wo=new Array(Na*2);Xa(Wo);const nh=new Array(OU);Xa(nh);const ah=new Array(IU-mU+1);Xa(ah);const Ug=new Array(Pg);Xa(Ug);const Tl=new Array(Na);Xa(Tl);function yc(r,t,e,s,i){this.static_tree=r,this.extra_bits=t,this.extra_base=e,this.elems=s,this.max_length=i,this.has_stree=r&&r.length}let MT,CT,NT;function Mc(r,t){this.dyn_tree=r,this.max_code=0,this.stat_desc=t}const bT=r=>r<256?nh[r]:nh[256+(r>>>7)],oh=(r,t)=>{r.pending_buf[r.pending++]=t&255,r.pending_buf[r.pending++]=t>>>8&255},cs=(r,t,e)=>{r.bi_valid>Sc-e?(r.bi_buf|=t<<r.bi_valid&65535,oh(r,r.bi_buf),r.bi_buf=t>>Sc-r.bi_valid,r.bi_valid+=e-Sc):(r.bi_buf|=t<<r.bi_valid&65535,r.bi_valid+=e)},ur=(r,t,e)=>{cs(r,e[t*2],e[t*2+1])},PT=(r,t)=>{let e=0;do e|=r&1,r>>>=1,e<<=1;while(--t>0);return e>>>1},vU=r=>{r.bi_valid===16?(oh(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=r.bi_buf&255,r.bi_buf>>=8,r.bi_valid-=8)},AU=(r,t)=>{const e=t.dyn_tree,s=t.max_code,i=t.stat_desc.static_tree,n=t.stat_desc.has_stree,a=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,h=t.stat_desc.max_length;let u,c,l,_,d,f,m=0;for(_=0;_<=pn;_++)r.bl_count[_]=0;for(e[r.heap[r.heap_max]*2+1]=0,u=r.heap_max+1;u<OT;u++)c=r.heap[u],_=e[e[c*2+1]*2+1]+1,_>h&&(_=h,m++),e[c*2+1]=_,!(c>s)&&(r.bl_count[_]++,d=0,c>=o&&(d=a[c-o]),f=e[c*2],r.opt_len+=f*(_+d),n&&(r.static_len+=f*(i[c*2+1]+d)));if(m!==0){do{for(_=h-1;r.bl_count[_]===0;)_--;r.bl_count[_]--,r.bl_count[_+1]+=2,r.bl_count[h]--,m-=2}while(m>0);for(_=h;_!==0;_--)for(c=r.bl_count[_];c!==0;)l=r.heap[--u],!(l>s)&&(e[l*2+1]!==_&&(r.opt_len+=(_-e[l*2+1])*e[l*2],e[l*2+1]=_),c--)}},DT=(r,t,e)=>{const s=new Array(pn+1);let i=0,n,a;for(n=1;n<=pn;n++)i=i+e[n-1]<<1,s[n]=i;for(a=0;a<=t;a++){let o=r[a*2+1];o!==0&&(r[a*2]=PT(s[o]++,o))}},SU=()=>{let r,t,e,s,i;const n=new Array(pn+1);for(e=0,s=0;s<Pg-1;s++)for(Ug[s]=e,r=0;r<1<<Md[s];r++)ah[e++]=s;for(ah[e-1]=s,i=0,s=0;s<16;s++)for(Tl[s]=i,r=0;r<1<<ku[s];r++)nh[i++]=s;for(i>>=7;s<Na;s++)for(Tl[s]=i<<7,r=0;r<1<<ku[s]-7;r++)nh[256+i++]=s;for(t=0;t<=pn;t++)n[t]=0;for(r=0;r<=143;)Vr[r*2+1]=8,r++,n[8]++;for(;r<=255;)Vr[r*2+1]=9,r++,n[9]++;for(;r<=279;)Vr[r*2+1]=7,r++,n[7]++;for(;r<=287;)Vr[r*2+1]=8,r++,n[8]++;for(DT(Vr,ih+1,n),r=0;r<Na;r++)Wo[r*2+1]=5,Wo[r*2]=PT(r,5);MT=new yc(Vr,Md,Mh+1,ih,pn),CT=new yc(Wo,ku,0,Na,pn),NT=new yc(new Array(0),RU,0,Dg,TU)},LT=r=>{let t;for(t=0;t<ih;t++)r.dyn_ltree[t*2]=0;for(t=0;t<Na;t++)r.dyn_dtree[t*2]=0;for(t=0;t<Dg;t++)r.bl_tree[t*2]=0;r.dyn_ltree[Lg*2]=1,r.opt_len=r.static_len=0,r.sym_next=r.matches=0},UT=r=>{r.bi_valid>8?oh(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0},rm=(r,t,e,s)=>{const i=t*2,n=e*2;return r[i]<r[n]||r[i]===r[n]&&s[t]<=s[e]},Cc=(r,t,e)=>{const s=r.heap[e];let i=e<<1;for(;i<=r.heap_len&&(i<r.heap_len&&rm(t,r.heap[i+1],r.heap[i],r.depth)&&i++,!rm(t,s,r.heap[i],r.depth));)r.heap[e]=r.heap[i],e=i,i<<=1;r.heap[e]=s},im=(r,t,e)=>{let s,i,n=0,a,o;if(r.sym_next!==0)do s=r.pending_buf[r.sym_buf+n++]&255,s+=(r.pending_buf[r.sym_buf+n++]&255)<<8,i=r.pending_buf[r.sym_buf+n++],s===0?ur(r,i,t):(a=ah[i],ur(r,a+Mh+1,t),o=Md[a],o!==0&&(i-=Ug[a],cs(r,i,o)),s--,a=bT(s),ur(r,a,e),o=ku[a],o!==0&&(s-=Tl[a],cs(r,s,o)));while(n<r.sym_next);ur(r,Lg,t)},Cd=(r,t)=>{const e=t.dyn_tree,s=t.stat_desc.static_tree,i=t.stat_desc.has_stree,n=t.stat_desc.elems;let a,o,h=-1,u;for(r.heap_len=0,r.heap_max=OT,a=0;a<n;a++)e[a*2]!==0?(r.heap[++r.heap_len]=h=a,r.depth[a]=0):e[a*2+1]=0;for(;r.heap_len<2;)u=r.heap[++r.heap_len]=h<2?++h:0,e[u*2]=1,r.depth[u]=0,r.opt_len--,i&&(r.static_len-=s[u*2+1]);for(t.max_code=h,a=r.heap_len>>1;a>=1;a--)Cc(r,e,a);u=n;do a=r.heap[1],r.heap[1]=r.heap[r.heap_len--],Cc(r,e,1),o=r.heap[1],r.heap[--r.heap_max]=a,r.heap[--r.heap_max]=o,e[u*2]=e[a*2]+e[o*2],r.depth[u]=(r.depth[a]>=r.depth[o]?r.depth[a]:r.depth[o])+1,e[a*2+1]=e[o*2+1]=u,r.heap[1]=u++,Cc(r,e,1);while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],AU(r,t),DT(e,h,r.bl_count)},nm=(r,t,e)=>{let s,i=-1,n,a=t[0*2+1],o=0,h=7,u=4;for(a===0&&(h=138,u=3),t[(e+1)*2+1]=65535,s=0;s<=e;s++)n=a,a=t[(s+1)*2+1],!(++o<h&&n===a)&&(o<u?r.bl_tree[n*2]+=o:n!==0?(n!==i&&r.bl_tree[n*2]++,r.bl_tree[vT*2]++):o<=10?r.bl_tree[AT*2]++:r.bl_tree[ST*2]++,o=0,i=n,a===0?(h=138,u=3):n===a?(h=6,u=3):(h=7,u=4))},am=(r,t,e)=>{let s,i=-1,n,a=t[0*2+1],o=0,h=7,u=4;for(a===0&&(h=138,u=3),s=0;s<=e;s++)if(n=a,a=t[(s+1)*2+1],!(++o<h&&n===a)){if(o<u)do ur(r,n,r.bl_tree);while(--o!==0);else n!==0?(n!==i&&(ur(r,n,r.bl_tree),o--),ur(r,vT,r.bl_tree),cs(r,o-3,2)):o<=10?(ur(r,AT,r.bl_tree),cs(r,o-3,3)):(ur(r,ST,r.bl_tree),cs(r,o-11,7));o=0,i=n,a===0?(h=138,u=3):n===a?(h=6,u=3):(h=7,u=4)}},yU=r=>{let t;for(nm(r,r.dyn_ltree,r.l_desc.max_code),nm(r,r.dyn_dtree,r.d_desc.max_code),Cd(r,r.bl_desc),t=Dg-1;t>=3&&r.bl_tree[yT[t]*2+1]===0;t--);return r.opt_len+=3*(t+1)+5+5+4,t},MU=(r,t,e,s)=>{let i;for(cs(r,t-257,5),cs(r,e-1,5),cs(r,s-4,4),i=0;i<s;i++)cs(r,r.bl_tree[yT[i]*2+1],3);am(r,r.dyn_ltree,t-1),am(r,r.dyn_dtree,e-1)},CU=r=>{let t=4093624447,e;for(e=0;e<=31;e++,t>>>=1)if(t&1&&r.dyn_ltree[e*2]!==0)return em;if(r.dyn_ltree[9*2]!==0||r.dyn_ltree[10*2]!==0||r.dyn_ltree[13*2]!==0)return sm;for(e=32;e<Mh;e++)if(r.dyn_ltree[e*2]!==0)return sm;return em};let om=!1;const NU=r=>{om||(SU(),om=!0),r.l_desc=new Mc(r.dyn_ltree,MT),r.d_desc=new Mc(r.dyn_dtree,CT),r.bl_desc=new Mc(r.bl_tree,NT),r.bi_buf=0,r.bi_valid=0,LT(r)},xT=(r,t,e,s)=>{cs(r,(EU<<1)+(s?1:0),3),UT(r),oh(r,e),oh(r,~e),e&&r.pending_buf.set(r.window.subarray(t,t+e),r.pending),r.pending+=e},bU=r=>{cs(r,RT<<1,3),ur(r,Lg,Vr),vU(r)},PU=(r,t,e,s)=>{let i,n,a=0;r.level>0?(r.strm.data_type===gU&&(r.strm.data_type=CU(r)),Cd(r,r.l_desc),Cd(r,r.d_desc),a=yU(r),i=r.opt_len+3+7>>>3,n=r.static_len+3+7>>>3,n<=i&&(i=n)):i=n=e+5,e+4<=i&&t!==-1?xT(r,t,e,s):r.strategy===fU||n===i?(cs(r,(RT<<1)+(s?1:0),3),im(r,Vr,Wo)):(cs(r,(pU<<1)+(s?1:0),3),MU(r,r.l_desc.max_code+1,r.d_desc.max_code+1,a+1),im(r,r.dyn_ltree,r.dyn_dtree)),LT(r),s&&UT(r)},DU=(r,t,e)=>(r.pending_buf[r.sym_buf+r.sym_next++]=t,r.pending_buf[r.sym_buf+r.sym_next++]=t>>8,r.pending_buf[r.sym_buf+r.sym_next++]=e,t===0?r.dyn_ltree[e*2]++:(r.matches++,t--,r.dyn_ltree[(ah[e]+Mh+1)*2]++,r.dyn_dtree[bT(t)*2]++),r.sym_next===r.sym_end);var LU=NU,UU=xT,xU=PU,FU=DU,wU=bU,GU={_tr_init:LU,_tr_stored_block:UU,_tr_flush_block:xU,_tr_tally:FU,_tr_align:wU};const BU=(r,t,e,s)=>{let i=r&65535|0,n=r>>>16&65535|0,a=0;for(;e!==0;){a=e>2e3?2e3:e,e-=a;do i=i+t[s++]|0,n=n+i|0;while(--a);i%=65521,n%=65521}return i|n<<16|0};var hh=BU;const HU=()=>{let r,t=[];for(var e=0;e<256;e++){r=e;for(var s=0;s<8;s++)r=r&1?3988292384^r>>>1:r>>>1;t[e]=r}return t},VU=new Uint32Array(HU()),kU=(r,t,e,s)=>{const i=VU,n=s+e;r^=-1;for(let a=s;a<n;a++)r=r>>>8^i[(r^t[a])&255];return r^-1};var xe=kU,wa={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Ch={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:jU,_tr_stored_block:Nd,_tr_flush_block:zU,_tr_tally:Ui,_tr_align:YU}=GU,{Z_NO_FLUSH:xi,Z_PARTIAL_FLUSH:WU,Z_FULL_FLUSH:XU,Z_FINISH:Ms,Z_BLOCK:hm,Z_OK:Ve,Z_STREAM_END:um,Z_STREAM_ERROR:pr,Z_DATA_ERROR:KU,Z_BUF_ERROR:Nc,Z_DEFAULT_COMPRESSION:qU,Z_FILTERED:QU,Z_HUFFMAN_ONLY:Au,Z_RLE:ZU,Z_FIXED:JU,Z_DEFAULT_STRATEGY:$U,Z_UNKNOWN:tx,Z_DEFLATED:r_}=Ch,ex=9,sx=15,rx=8,ix=29,nx=256,bd=nx+1+ix,ax=30,ox=19,hx=2*bd+1,ux=15,Ct=3,bi=258,mr=bi+Ct+1,lx=32,Ga=42,xg=57,Pd=69,Dd=73,Ld=91,Ud=103,mn=113,vo=666,os=1,Ka=2,Ln=3,qa=4,_x=3,In=(r,t)=>(r.msg=wa[t],t),lm=r=>r*2-(r>4?9:0),Ai=r=>{let t=r.length;for(;--t>=0;)r[t]=0},cx=r=>{let t,e,s,i=r.w_size;t=r.hash_size,s=t;do e=r.head[--s],r.head[s]=e>=i?e-i:0;while(--t);t=i,s=t;do e=r.prev[--s],r.prev[s]=e>=i?e-i:0;while(--t)};let dx=(r,t,e)=>(t<<r.hash_shift^e)&r.hash_mask,Fi=dx;const ps=r=>{const t=r.state;let e=t.pending;e>r.avail_out&&(e=r.avail_out),e!==0&&(r.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),r.next_out),r.next_out+=e,t.pending_out+=e,r.total_out+=e,r.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},Is=(r,t)=>{zU(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,t),r.block_start=r.strstart,ps(r.strm)},kt=(r,t)=>{r.pending_buf[r.pending++]=t},Eo=(r,t)=>{r.pending_buf[r.pending++]=t>>>8&255,r.pending_buf[r.pending++]=t&255},xd=(r,t,e,s)=>{let i=r.avail_in;return i>s&&(i=s),i===0?0:(r.avail_in-=i,t.set(r.input.subarray(r.next_in,r.next_in+i),e),r.state.wrap===1?r.adler=hh(r.adler,t,i,e):r.state.wrap===2&&(r.adler=xe(r.adler,t,i,e)),r.next_in+=i,r.total_in+=i,i)},FT=(r,t)=>{let e=r.max_chain_length,s=r.strstart,i,n,a=r.prev_length,o=r.nice_match;const h=r.strstart>r.w_size-mr?r.strstart-(r.w_size-mr):0,u=r.window,c=r.w_mask,l=r.prev,_=r.strstart+bi;let d=u[s+a-1],f=u[s+a];r.prev_length>=r.good_match&&(e>>=2),o>r.lookahead&&(o=r.lookahead);do if(i=t,!(u[i+a]!==f||u[i+a-1]!==d||u[i]!==u[s]||u[++i]!==u[s+1])){s+=2,i++;do;while(u[++s]===u[++i]&&u[++s]===u[++i]&&u[++s]===u[++i]&&u[++s]===u[++i]&&u[++s]===u[++i]&&u[++s]===u[++i]&&u[++s]===u[++i]&&u[++s]===u[++i]&&s<_);if(n=bi-(_-s),s=_-bi,n>a){if(r.match_start=t,a=n,n>=o)break;d=u[s+a-1],f=u[s+a]}}while((t=l[t&c])>h&&--e!==0);return a<=r.lookahead?a:r.lookahead},Ba=r=>{const t=r.w_size;let e,s,i;do{if(s=r.window_size-r.lookahead-r.strstart,r.strstart>=t+(t-mr)&&(r.window.set(r.window.subarray(t,t+t-s),0),r.match_start-=t,r.strstart-=t,r.block_start-=t,r.insert>r.strstart&&(r.insert=r.strstart),cx(r),s+=t),r.strm.avail_in===0)break;if(e=xd(r.strm,r.window,r.strstart+r.lookahead,s),r.lookahead+=e,r.lookahead+r.insert>=Ct)for(i=r.strstart-r.insert,r.ins_h=r.window[i],r.ins_h=Fi(r,r.ins_h,r.window[i+1]);r.insert&&(r.ins_h=Fi(r,r.ins_h,r.window[i+Ct-1]),r.prev[i&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=i,i++,r.insert--,!(r.lookahead+r.insert<Ct)););}while(r.lookahead<mr&&r.strm.avail_in!==0)},wT=(r,t)=>{let e=r.pending_buf_size-5>r.w_size?r.w_size:r.pending_buf_size-5,s,i,n,a=0,o=r.strm.avail_in;do{if(s=65535,n=r.bi_valid+42>>3,r.strm.avail_out<n||(n=r.strm.avail_out-n,i=r.strstart-r.block_start,s>i+r.strm.avail_in&&(s=i+r.strm.avail_in),s>n&&(s=n),s<e&&(s===0&&t!==Ms||t===xi||s!==i+r.strm.avail_in)))break;a=t===Ms&&s===i+r.strm.avail_in?1:0,Nd(r,0,0,a),r.pending_buf[r.pending-4]=s,r.pending_buf[r.pending-3]=s>>8,r.pending_buf[r.pending-2]=~s,r.pending_buf[r.pending-1]=~s>>8,ps(r.strm),i&&(i>s&&(i=s),r.strm.output.set(r.window.subarray(r.block_start,r.block_start+i),r.strm.next_out),r.strm.next_out+=i,r.strm.avail_out-=i,r.strm.total_out+=i,r.block_start+=i,s-=i),s&&(xd(r.strm,r.strm.output,r.strm.next_out,s),r.strm.next_out+=s,r.strm.avail_out-=s,r.strm.total_out+=s)}while(a===0);return o-=r.strm.avail_in,o&&(o>=r.w_size?(r.matches=2,r.window.set(r.strm.input.subarray(r.strm.next_in-r.w_size,r.strm.next_in),0),r.strstart=r.w_size,r.insert=r.strstart):(r.window_size-r.strstart<=o&&(r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,r.insert>r.strstart&&(r.insert=r.strstart)),r.window.set(r.strm.input.subarray(r.strm.next_in-o,r.strm.next_in),r.strstart),r.strstart+=o,r.insert+=o>r.w_size-r.insert?r.w_size-r.insert:o),r.block_start=r.strstart),r.high_water<r.strstart&&(r.high_water=r.strstart),a?qa:t!==xi&&t!==Ms&&r.strm.avail_in===0&&r.strstart===r.block_start?Ka:(n=r.window_size-r.strstart,r.strm.avail_in>n&&r.block_start>=r.w_size&&(r.block_start-=r.w_size,r.strstart-=r.w_size,r.window.set(r.window.subarray(r.w_size,r.w_size+r.strstart),0),r.matches<2&&r.matches++,n+=r.w_size,r.insert>r.strstart&&(r.insert=r.strstart)),n>r.strm.avail_in&&(n=r.strm.avail_in),n&&(xd(r.strm,r.window,r.strstart,n),r.strstart+=n,r.insert+=n>r.w_size-r.insert?r.w_size-r.insert:n),r.high_water<r.strstart&&(r.high_water=r.strstart),n=r.bi_valid+42>>3,n=r.pending_buf_size-n>65535?65535:r.pending_buf_size-n,e=n>r.w_size?r.w_size:n,i=r.strstart-r.block_start,(i>=e||(i||t===Ms)&&t!==xi&&r.strm.avail_in===0&&i<=n)&&(s=i>n?n:i,a=t===Ms&&r.strm.avail_in===0&&s===i?1:0,Nd(r,r.block_start,s,a),r.block_start+=s,ps(r.strm)),a?Ln:os)},bc=(r,t)=>{let e,s;for(;;){if(r.lookahead<mr){if(Ba(r),r.lookahead<mr&&t===xi)return os;if(r.lookahead===0)break}if(e=0,r.lookahead>=Ct&&(r.ins_h=Fi(r,r.ins_h,r.window[r.strstart+Ct-1]),e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),e!==0&&r.strstart-e<=r.w_size-mr&&(r.match_length=FT(r,e)),r.match_length>=Ct)if(s=Ui(r,r.strstart-r.match_start,r.match_length-Ct),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=Ct){r.match_length--;do r.strstart++,r.ins_h=Fi(r,r.ins_h,r.window[r.strstart+Ct-1]),e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart;while(--r.match_length!==0);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=Fi(r,r.ins_h,r.window[r.strstart+1]);else s=Ui(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(s&&(Is(r,!1),r.strm.avail_out===0))return os}return r.insert=r.strstart<Ct-1?r.strstart:Ct-1,t===Ms?(Is(r,!0),r.strm.avail_out===0?Ln:qa):r.sym_next&&(Is(r,!1),r.strm.avail_out===0)?os:Ka},ta=(r,t)=>{let e,s,i;for(;;){if(r.lookahead<mr){if(Ba(r),r.lookahead<mr&&t===xi)return os;if(r.lookahead===0)break}if(e=0,r.lookahead>=Ct&&(r.ins_h=Fi(r,r.ins_h,r.window[r.strstart+Ct-1]),e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=Ct-1,e!==0&&r.prev_length<r.max_lazy_match&&r.strstart-e<=r.w_size-mr&&(r.match_length=FT(r,e),r.match_length<=5&&(r.strategy===QU||r.match_length===Ct&&r.strstart-r.match_start>4096)&&(r.match_length=Ct-1)),r.prev_length>=Ct&&r.match_length<=r.prev_length){i=r.strstart+r.lookahead-Ct,s=Ui(r,r.strstart-1-r.prev_match,r.prev_length-Ct),r.lookahead-=r.prev_length-1,r.prev_length-=2;do++r.strstart<=i&&(r.ins_h=Fi(r,r.ins_h,r.window[r.strstart+Ct-1]),e=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart);while(--r.prev_length!==0);if(r.match_available=0,r.match_length=Ct-1,r.strstart++,s&&(Is(r,!1),r.strm.avail_out===0))return os}else if(r.match_available){if(s=Ui(r,0,r.window[r.strstart-1]),s&&Is(r,!1),r.strstart++,r.lookahead--,r.strm.avail_out===0)return os}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(s=Ui(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<Ct-1?r.strstart:Ct-1,t===Ms?(Is(r,!0),r.strm.avail_out===0?Ln:qa):r.sym_next&&(Is(r,!1),r.strm.avail_out===0)?os:Ka},fx=(r,t)=>{let e,s,i,n;const a=r.window;for(;;){if(r.lookahead<=bi){if(Ba(r),r.lookahead<=bi&&t===xi)return os;if(r.lookahead===0)break}if(r.match_length=0,r.lookahead>=Ct&&r.strstart>0&&(i=r.strstart-1,s=a[i],s===a[++i]&&s===a[++i]&&s===a[++i])){n=r.strstart+bi;do;while(s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&s===a[++i]&&i<n);r.match_length=bi-(n-i),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=Ct?(e=Ui(r,1,r.match_length-Ct),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(e=Ui(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),e&&(Is(r,!1),r.strm.avail_out===0))return os}return r.insert=0,t===Ms?(Is(r,!0),r.strm.avail_out===0?Ln:qa):r.sym_next&&(Is(r,!1),r.strm.avail_out===0)?os:Ka},gx=(r,t)=>{let e;for(;;){if(r.lookahead===0&&(Ba(r),r.lookahead===0)){if(t===xi)return os;break}if(r.match_length=0,e=Ui(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,e&&(Is(r,!1),r.strm.avail_out===0))return os}return r.insert=0,t===Ms?(Is(r,!0),r.strm.avail_out===0?Ln:qa):r.sym_next&&(Is(r,!1),r.strm.avail_out===0)?os:Ka};function ir(r,t,e,s,i){this.good_length=r,this.max_lazy=t,this.nice_length=e,this.max_chain=s,this.func=i}const Ao=[new ir(0,0,0,0,wT),new ir(4,4,8,4,bc),new ir(4,5,16,8,bc),new ir(4,6,32,32,bc),new ir(4,4,16,16,ta),new ir(8,16,32,32,ta),new ir(8,16,128,128,ta),new ir(8,32,128,256,ta),new ir(32,128,258,1024,ta),new ir(32,258,258,4096,ta)],Ex=r=>{r.window_size=2*r.w_size,Ai(r.head),r.max_lazy_match=Ao[r.level].max_lazy,r.good_match=Ao[r.level].good_length,r.nice_match=Ao[r.level].nice_length,r.max_chain_length=Ao[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=Ct-1,r.match_available=0,r.ins_h=0};function px(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=r_,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(hx*2),this.dyn_dtree=new Uint16Array((2*ax+1)*2),this.bl_tree=new Uint16Array((2*ox+1)*2),Ai(this.dyn_ltree),Ai(this.dyn_dtree),Ai(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(ux+1),this.heap=new Uint16Array(2*bd+1),Ai(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*bd+1),Ai(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Nh=r=>{if(!r)return 1;const t=r.state;return!t||t.strm!==r||t.status!==Ga&&t.status!==xg&&t.status!==Pd&&t.status!==Dd&&t.status!==Ld&&t.status!==Ud&&t.status!==mn&&t.status!==vo?1:0},GT=r=>{if(Nh(r))return In(r,pr);r.total_in=r.total_out=0,r.data_type=tx;const t=r.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?xg:t.wrap?Ga:mn,r.adler=t.wrap===2?0:1,t.last_flush=-2,jU(t),Ve},BT=r=>{const t=GT(r);return t===Ve&&Ex(r.state),t},mx=(r,t)=>Nh(r)||r.state.wrap!==2?pr:(r.state.gzhead=t,Ve),HT=(r,t,e,s,i,n)=>{if(!r)return pr;let a=1;if(t===qU&&(t=6),s<0?(a=0,s=-s):s>15&&(a=2,s-=16),i<1||i>ex||e!==r_||s<8||s>15||t<0||t>9||n<0||n>JU||s===8&&a!==1)return In(r,pr);s===8&&(s=9);const o=new px;return r.state=o,o.strm=r,o.status=Ga,o.wrap=a,o.gzhead=null,o.w_bits=s,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Ct-1)/Ct),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=t,o.strategy=n,o.method=e,BT(r)},Ix=(r,t)=>HT(r,t,r_,sx,rx,$U),Tx=(r,t)=>{if(Nh(r)||t>hm||t<0)return r?In(r,pr):pr;const e=r.state;if(!r.output||r.avail_in!==0&&!r.input||e.status===vo&&t!==Ms)return In(r,r.avail_out===0?Nc:pr);const s=e.last_flush;if(e.last_flush=t,e.pending!==0){if(ps(r),r.avail_out===0)return e.last_flush=-1,Ve}else if(r.avail_in===0&&lm(t)<=lm(s)&&t!==Ms)return In(r,Nc);if(e.status===vo&&r.avail_in!==0)return In(r,Nc);if(e.status===Ga&&e.wrap===0&&(e.status=mn),e.status===Ga){let i=r_+(e.w_bits-8<<4)<<8,n=-1;if(e.strategy>=Au||e.level<2?n=0:e.level<6?n=1:e.level===6?n=2:n=3,i|=n<<6,e.strstart!==0&&(i|=lx),i+=31-i%31,Eo(e,i),e.strstart!==0&&(Eo(e,r.adler>>>16),Eo(e,r.adler&65535)),r.adler=1,e.status=mn,ps(r),e.pending!==0)return e.last_flush=-1,Ve}if(e.status===xg){if(r.adler=0,kt(e,31),kt(e,139),kt(e,8),e.gzhead)kt(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),kt(e,e.gzhead.time&255),kt(e,e.gzhead.time>>8&255),kt(e,e.gzhead.time>>16&255),kt(e,e.gzhead.time>>24&255),kt(e,e.level===9?2:e.strategy>=Au||e.level<2?4:0),kt(e,e.gzhead.os&255),e.gzhead.extra&&e.gzhead.extra.length&&(kt(e,e.gzhead.extra.length&255),kt(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(r.adler=xe(r.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=Pd;else if(kt(e,0),kt(e,0),kt(e,0),kt(e,0),kt(e,0),kt(e,e.level===9?2:e.strategy>=Au||e.level<2?4:0),kt(e,_x),e.status=mn,ps(r),e.pending!==0)return e.last_flush=-1,Ve}if(e.status===Pd){if(e.gzhead.extra){let i=e.pending,n=(e.gzhead.extra.length&65535)-e.gzindex;for(;e.pending+n>e.pending_buf_size;){let o=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>i&&(r.adler=xe(r.adler,e.pending_buf,e.pending-i,i)),e.gzindex+=o,ps(r),e.pending!==0)return e.last_flush=-1,Ve;i=0,n-=o}let a=new Uint8Array(e.gzhead.extra);e.pending_buf.set(a.subarray(e.gzindex,e.gzindex+n),e.pending),e.pending+=n,e.gzhead.hcrc&&e.pending>i&&(r.adler=xe(r.adler,e.pending_buf,e.pending-i,i)),e.gzindex=0}e.status=Dd}if(e.status===Dd){if(e.gzhead.name){let i=e.pending,n;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>i&&(r.adler=xe(r.adler,e.pending_buf,e.pending-i,i)),ps(r),e.pending!==0)return e.last_flush=-1,Ve;i=0}e.gzindex<e.gzhead.name.length?n=e.gzhead.name.charCodeAt(e.gzindex++)&255:n=0,kt(e,n)}while(n!==0);e.gzhead.hcrc&&e.pending>i&&(r.adler=xe(r.adler,e.pending_buf,e.pending-i,i)),e.gzindex=0}e.status=Ld}if(e.status===Ld){if(e.gzhead.comment){let i=e.pending,n;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>i&&(r.adler=xe(r.adler,e.pending_buf,e.pending-i,i)),ps(r),e.pending!==0)return e.last_flush=-1,Ve;i=0}e.gzindex<e.gzhead.comment.length?n=e.gzhead.comment.charCodeAt(e.gzindex++)&255:n=0,kt(e,n)}while(n!==0);e.gzhead.hcrc&&e.pending>i&&(r.adler=xe(r.adler,e.pending_buf,e.pending-i,i))}e.status=Ud}if(e.status===Ud){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(ps(r),e.pending!==0))return e.last_flush=-1,Ve;kt(e,r.adler&255),kt(e,r.adler>>8&255),r.adler=0}if(e.status=mn,ps(r),e.pending!==0)return e.last_flush=-1,Ve}if(r.avail_in!==0||e.lookahead!==0||t!==xi&&e.status!==vo){let i=e.level===0?wT(e,t):e.strategy===Au?gx(e,t):e.strategy===ZU?fx(e,t):Ao[e.level].func(e,t);if((i===Ln||i===qa)&&(e.status=vo),i===os||i===Ln)return r.avail_out===0&&(e.last_flush=-1),Ve;if(i===Ka&&(t===WU?YU(e):t!==hm&&(Nd(e,0,0,!1),t===XU&&(Ai(e.head),e.lookahead===0&&(e.strstart=0,e.block_start=0,e.insert=0))),ps(r),r.avail_out===0))return e.last_flush=-1,Ve}return t!==Ms?Ve:e.wrap<=0?um:(e.wrap===2?(kt(e,r.adler&255),kt(e,r.adler>>8&255),kt(e,r.adler>>16&255),kt(e,r.adler>>24&255),kt(e,r.total_in&255),kt(e,r.total_in>>8&255),kt(e,r.total_in>>16&255),kt(e,r.total_in>>24&255)):(Eo(e,r.adler>>>16),Eo(e,r.adler&65535)),ps(r),e.wrap>0&&(e.wrap=-e.wrap),e.pending!==0?Ve:um)},Rx=r=>{if(Nh(r))return pr;const t=r.state.status;return r.state=null,t===mn?In(r,KU):Ve},Ox=(r,t)=>{let e=t.length;if(Nh(r))return pr;const s=r.state,i=s.wrap;if(i===2||i===1&&s.status!==Ga||s.lookahead)return pr;if(i===1&&(r.adler=hh(r.adler,t,e,0)),s.wrap=0,e>=s.w_size){i===0&&(Ai(s.head),s.strstart=0,s.block_start=0,s.insert=0);let h=new Uint8Array(s.w_size);h.set(t.subarray(e-s.w_size,e),0),t=h,e=s.w_size}const n=r.avail_in,a=r.next_in,o=r.input;for(r.avail_in=e,r.next_in=0,r.input=t,Ba(s);s.lookahead>=Ct;){let h=s.strstart,u=s.lookahead-(Ct-1);do s.ins_h=Fi(s,s.ins_h,s.window[h+Ct-1]),s.prev[h&s.w_mask]=s.head[s.ins_h],s.head[s.ins_h]=h,h++;while(--u);s.strstart=h,s.lookahead=Ct-1,Ba(s)}return s.strstart+=s.lookahead,s.block_start=s.strstart,s.insert=s.lookahead,s.lookahead=0,s.match_length=s.prev_length=Ct-1,s.match_available=0,r.next_in=a,r.input=o,r.avail_in=n,s.wrap=i,Ve};var vx=Ix,Ax=HT,Sx=BT,yx=GT,Mx=mx,Cx=Tx,Nx=Rx,bx=Ox,Px="pako deflate (from Nodeca project)",Xo={deflateInit:vx,deflateInit2:Ax,deflateReset:Sx,deflateResetKeep:yx,deflateSetHeader:Mx,deflate:Cx,deflateEnd:Nx,deflateSetDictionary:bx,deflateInfo:Px};const Dx=(r,t)=>Object.prototype.hasOwnProperty.call(r,t);var Lx=function(r){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const s in e)Dx(e,s)&&(r[s]=e[s])}}return r},Ux=r=>{let t=0;for(let s=0,i=r.length;s<i;s++)t+=r[s].length;const e=new Uint8Array(t);for(let s=0,i=0,n=r.length;s<n;s++){let a=r[s];e.set(a,i),i+=a.length}return e},i_={assign:Lx,flattenChunks:Ux};let VT=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{VT=!1}const uh=new Uint8Array(256);for(let r=0;r<256;r++)uh[r]=r>=252?6:r>=248?5:r>=240?4:r>=224?3:r>=192?2:1;uh[254]=uh[254]=1;var xx=r=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(r);let t,e,s,i,n,a=r.length,o=0;for(i=0;i<a;i++)e=r.charCodeAt(i),(e&64512)===55296&&i+1<a&&(s=r.charCodeAt(i+1),(s&64512)===56320&&(e=65536+(e-55296<<10)+(s-56320),i++)),o+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(o),n=0,i=0;n<o;i++)e=r.charCodeAt(i),(e&64512)===55296&&i+1<a&&(s=r.charCodeAt(i+1),(s&64512)===56320&&(e=65536+(e-55296<<10)+(s-56320),i++)),e<128?t[n++]=e:e<2048?(t[n++]=192|e>>>6,t[n++]=128|e&63):e<65536?(t[n++]=224|e>>>12,t[n++]=128|e>>>6&63,t[n++]=128|e&63):(t[n++]=240|e>>>18,t[n++]=128|e>>>12&63,t[n++]=128|e>>>6&63,t[n++]=128|e&63);return t};const Fx=(r,t)=>{if(t<65534&&r.subarray&&VT)return String.fromCharCode.apply(null,r.length===t?r:r.subarray(0,t));let e="";for(let s=0;s<t;s++)e+=String.fromCharCode(r[s]);return e};var wx=(r,t)=>{const e=t||r.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(r.subarray(0,t));let s,i;const n=new Array(e*2);for(i=0,s=0;s<e;){let a=r[s++];if(a<128){n[i++]=a;continue}let o=uh[a];if(o>4){n[i++]=65533,s+=o-1;continue}for(a&=o===2?31:o===3?15:7;o>1&&s<e;)a=a<<6|r[s++]&63,o--;if(o>1){n[i++]=65533;continue}a<65536?n[i++]=a:(a-=65536,n[i++]=55296|a>>10&1023,n[i++]=56320|a&1023)}return Fx(n,i)},Gx=(r,t)=>{t=t||r.length,t>r.length&&(t=r.length);let e=t-1;for(;e>=0&&(r[e]&192)===128;)e--;return e<0||e===0?t:e+uh[r[e]]>t?e:t},lh={string2buf:xx,buf2string:wx,utf8border:Gx};function Bx(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var kT=Bx;const jT=Object.prototype.toString,{Z_NO_FLUSH:Hx,Z_SYNC_FLUSH:Vx,Z_FULL_FLUSH:kx,Z_FINISH:jx,Z_OK:Rl,Z_STREAM_END:zx,Z_DEFAULT_COMPRESSION:Yx,Z_DEFAULT_STRATEGY:Wx,Z_DEFLATED:Xx}=Ch;function Fg(r){this.options=i_.assign({level:Yx,method:Xx,chunkSize:16384,windowBits:15,memLevel:8,strategy:Wx},r||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kT,this.strm.avail_out=0;let e=Xo.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==Rl)throw new Error(wa[e]);if(t.header&&Xo.deflateSetHeader(this.strm,t.header),t.dictionary){let s;if(typeof t.dictionary=="string"?s=lh.string2buf(t.dictionary):jT.call(t.dictionary)==="[object ArrayBuffer]"?s=new Uint8Array(t.dictionary):s=t.dictionary,e=Xo.deflateSetDictionary(this.strm,s),e!==Rl)throw new Error(wa[e]);this._dict_set=!0}}Fg.prototype.push=function(r,t){const e=this.strm,s=this.options.chunkSize;let i,n;if(this.ended)return!1;for(t===~~t?n=t:n=t===!0?jx:Hx,typeof r=="string"?e.input=lh.string2buf(r):jT.call(r)==="[object ArrayBuffer]"?e.input=new Uint8Array(r):e.input=r,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(s),e.next_out=0,e.avail_out=s),(n===Vx||n===kx)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(i=Xo.deflate(e,n),i===zx)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),i=Xo.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Rl;if(e.avail_out===0){this.onData(e.output);continue}if(n>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0};Fg.prototype.onData=function(r){this.chunks.push(r)};Fg.prototype.onEnd=function(r){r===Rl&&(this.result=i_.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};const Su=16209,Kx=16191;var qx=function(t,e){let s,i,n,a,o,h,u,c,l,_,d,f,m,p,T,v,O,A,y,M,N,P,b,D;const x=t.state;s=t.next_in,b=t.input,i=s+(t.avail_in-5),n=t.next_out,D=t.output,a=n-(e-t.avail_out),o=n+(t.avail_out-257),h=x.dmax,u=x.wsize,c=x.whave,l=x.wnext,_=x.window,d=x.hold,f=x.bits,m=x.lencode,p=x.distcode,T=(1<<x.lenbits)-1,v=(1<<x.distbits)-1;t:do{f<15&&(d+=b[s++]<<f,f+=8,d+=b[s++]<<f,f+=8),O=m[d&T];e:for(;;){if(A=O>>>24,d>>>=A,f-=A,A=O>>>16&255,A===0)D[n++]=O&65535;else if(A&16){y=O&65535,A&=15,A&&(f<A&&(d+=b[s++]<<f,f+=8),y+=d&(1<<A)-1,d>>>=A,f-=A),f<15&&(d+=b[s++]<<f,f+=8,d+=b[s++]<<f,f+=8),O=p[d&v];s:for(;;){if(A=O>>>24,d>>>=A,f-=A,A=O>>>16&255,A&16){if(M=O&65535,A&=15,f<A&&(d+=b[s++]<<f,f+=8,f<A&&(d+=b[s++]<<f,f+=8)),M+=d&(1<<A)-1,M>h){t.msg="invalid distance too far back",x.mode=Su;break t}if(d>>>=A,f-=A,A=n-a,M>A){if(A=M-A,A>c&&x.sane){t.msg="invalid distance too far back",x.mode=Su;break t}if(N=0,P=_,l===0){if(N+=u-A,A<y){y-=A;do D[n++]=_[N++];while(--A);N=n-M,P=D}}else if(l<A){if(N+=u+l-A,A-=l,A<y){y-=A;do D[n++]=_[N++];while(--A);if(N=0,l<y){A=l,y-=A;do D[n++]=_[N++];while(--A);N=n-M,P=D}}}else if(N+=l-A,A<y){y-=A;do D[n++]=_[N++];while(--A);N=n-M,P=D}for(;y>2;)D[n++]=P[N++],D[n++]=P[N++],D[n++]=P[N++],y-=3;y&&(D[n++]=P[N++],y>1&&(D[n++]=P[N++]))}else{N=n-M;do D[n++]=D[N++],D[n++]=D[N++],D[n++]=D[N++],y-=3;while(y>2);y&&(D[n++]=D[N++],y>1&&(D[n++]=D[N++]))}}else if(A&64){t.msg="invalid distance code",x.mode=Su;break t}else{O=p[(O&65535)+(d&(1<<A)-1)];continue s}break}}else if(A&64)if(A&32){x.mode=Kx;break t}else{t.msg="invalid literal/length code",x.mode=Su;break t}else{O=m[(O&65535)+(d&(1<<A)-1)];continue e}break}}while(s<i&&n<o);y=f>>3,s-=y,f-=y<<3,d&=(1<<f)-1,t.next_in=s,t.next_out=n,t.avail_in=s<i?5+(i-s):5-(s-i),t.avail_out=n<o?257+(o-n):257-(n-o),x.hold=d,x.bits=f};const ea=15,_m=852,cm=592,dm=0,Pc=1,fm=2,Qx=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Zx=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Jx=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),$x=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),t1=(r,t,e,s,i,n,a,o)=>{const h=o.bits;let u=0,c=0,l=0,_=0,d=0,f=0,m=0,p=0,T=0,v=0,O,A,y,M,N,P=null,b;const D=new Uint16Array(ea+1),x=new Uint16Array(ea+1);let V=null,J,ct,H;for(u=0;u<=ea;u++)D[u]=0;for(c=0;c<s;c++)D[t[e+c]]++;for(d=h,_=ea;_>=1&&D[_]===0;_--);if(d>_&&(d=_),_===0)return i[n++]=1<<24|64<<16|0,i[n++]=1<<24|64<<16|0,o.bits=1,0;for(l=1;l<_&&D[l]===0;l++);for(d<l&&(d=l),p=1,u=1;u<=ea;u++)if(p<<=1,p-=D[u],p<0)return-1;if(p>0&&(r===dm||_!==1))return-1;for(x[1]=0,u=1;u<ea;u++)x[u+1]=x[u]+D[u];for(c=0;c<s;c++)t[e+c]!==0&&(a[x[t[e+c]]++]=c);if(r===dm?(P=V=a,b=20):r===Pc?(P=Qx,V=Zx,b=257):(P=Jx,V=$x,b=0),v=0,c=0,u=l,N=n,f=d,m=0,y=-1,T=1<<d,M=T-1,r===Pc&&T>_m||r===fm&&T>cm)return 1;for(;;){J=u-m,a[c]+1<b?(ct=0,H=a[c]):a[c]>=b?(ct=V[a[c]-b],H=P[a[c]-b]):(ct=32+64,H=0),O=1<<u-m,A=1<<f,l=A;do A-=O,i[N+(v>>m)+A]=J<<24|ct<<16|H|0;while(A!==0);for(O=1<<u-1;v&O;)O>>=1;if(O!==0?(v&=O-1,v+=O):v=0,c++,--D[u]===0){if(u===_)break;u=t[e+a[c]]}if(u>d&&(v&M)!==y){for(m===0&&(m=d),N+=l,f=u-m,p=1<<f;f+m<_&&(p-=D[f+m],!(p<=0));)f++,p<<=1;if(T+=1<<f,r===Pc&&T>_m||r===fm&&T>cm)return 1;y=v&M,i[y]=d<<24|f<<16|N-n|0}}return v!==0&&(i[N+v]=u-m<<24|64<<16|0),o.bits=d,0};var Ko=t1;const e1=0,zT=1,YT=2,{Z_FINISH:gm,Z_BLOCK:s1,Z_TREES:yu,Z_OK:Un,Z_STREAM_END:r1,Z_NEED_DICT:i1,Z_STREAM_ERROR:Ps,Z_DATA_ERROR:WT,Z_MEM_ERROR:XT,Z_BUF_ERROR:n1,Z_DEFLATED:Em}=Ch,n_=16180,pm=16181,mm=16182,Im=16183,Tm=16184,Rm=16185,Om=16186,vm=16187,Am=16188,Sm=16189,Ol=16190,Mr=16191,Dc=16192,ym=16193,Lc=16194,Mm=16195,Cm=16196,Nm=16197,bm=16198,Mu=16199,Cu=16200,Pm=16201,Dm=16202,Lm=16203,Um=16204,xm=16205,Uc=16206,Fm=16207,wm=16208,re=16209,KT=16210,qT=16211,a1=852,o1=592,h1=15,u1=h1,Gm=r=>(r>>>24&255)+(r>>>8&65280)+((r&65280)<<8)+((r&255)<<24);function l1(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const wn=r=>{if(!r)return 1;const t=r.state;return!t||t.strm!==r||t.mode<n_||t.mode>qT?1:0},QT=r=>{if(wn(r))return Ps;const t=r.state;return r.total_in=r.total_out=t.total=0,r.msg="",t.wrap&&(r.adler=t.wrap&1),t.mode=n_,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(a1),t.distcode=t.distdyn=new Int32Array(o1),t.sane=1,t.back=-1,Un},ZT=r=>{if(wn(r))return Ps;const t=r.state;return t.wsize=0,t.whave=0,t.wnext=0,QT(r)},JT=(r,t)=>{let e;if(wn(r))return Ps;const s=r.state;return t<0?(e=0,t=-t):(e=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ps:(s.window!==null&&s.wbits!==t&&(s.window=null),s.wrap=e,s.wbits=t,ZT(r))},$T=(r,t)=>{if(!r)return Ps;const e=new l1;r.state=e,e.strm=r,e.window=null,e.mode=n_;const s=JT(r,t);return s!==Un&&(r.state=null),s},_1=r=>$T(r,u1);let Bm=!0,xc,Fc;const c1=r=>{if(Bm){xc=new Int32Array(512),Fc=new Int32Array(32);let t=0;for(;t<144;)r.lens[t++]=8;for(;t<256;)r.lens[t++]=9;for(;t<280;)r.lens[t++]=7;for(;t<288;)r.lens[t++]=8;for(Ko(zT,r.lens,0,288,xc,0,r.work,{bits:9}),t=0;t<32;)r.lens[t++]=5;Ko(YT,r.lens,0,32,Fc,0,r.work,{bits:5}),Bm=!1}r.lencode=xc,r.lenbits=9,r.distcode=Fc,r.distbits=5},tR=(r,t,e,s)=>{let i;const n=r.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new Uint8Array(n.wsize)),s>=n.wsize?(n.window.set(t.subarray(e-n.wsize,e),0),n.wnext=0,n.whave=n.wsize):(i=n.wsize-n.wnext,i>s&&(i=s),n.window.set(t.subarray(e-s,e-s+i),n.wnext),s-=i,s?(n.window.set(t.subarray(e-s,e),0),n.wnext=s,n.whave=n.wsize):(n.wnext+=i,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=i))),0},d1=(r,t)=>{let e,s,i,n,a,o,h,u,c,l,_,d,f,m,p=0,T,v,O,A,y,M,N,P;const b=new Uint8Array(4);let D,x;const V=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(wn(r)||!r.output||!r.input&&r.avail_in!==0)return Ps;e=r.state,e.mode===Mr&&(e.mode=Dc),a=r.next_out,i=r.output,h=r.avail_out,n=r.next_in,s=r.input,o=r.avail_in,u=e.hold,c=e.bits,l=o,_=h,P=Un;t:for(;;)switch(e.mode){case n_:if(e.wrap===0){e.mode=Dc;break}for(;c<16;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(e.wrap&2&&u===35615){e.wbits===0&&(e.wbits=15),e.check=0,b[0]=u&255,b[1]=u>>>8&255,e.check=xe(e.check,b,2,0),u=0,c=0,e.mode=pm;break}if(e.head&&(e.head.done=!1),!(e.wrap&1)||(((u&255)<<8)+(u>>8))%31){r.msg="incorrect header check",e.mode=re;break}if((u&15)!==Em){r.msg="unknown compression method",e.mode=re;break}if(u>>>=4,c-=4,N=(u&15)+8,e.wbits===0&&(e.wbits=N),N>15||N>e.wbits){r.msg="invalid window size",e.mode=re;break}e.dmax=1<<e.wbits,e.flags=0,r.adler=e.check=1,e.mode=u&512?Sm:Mr,u=0,c=0;break;case pm:for(;c<16;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(e.flags=u,(e.flags&255)!==Em){r.msg="unknown compression method",e.mode=re;break}if(e.flags&57344){r.msg="unknown header flags set",e.mode=re;break}e.head&&(e.head.text=u>>8&1),e.flags&512&&e.wrap&4&&(b[0]=u&255,b[1]=u>>>8&255,e.check=xe(e.check,b,2,0)),u=0,c=0,e.mode=mm;case mm:for(;c<32;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}e.head&&(e.head.time=u),e.flags&512&&e.wrap&4&&(b[0]=u&255,b[1]=u>>>8&255,b[2]=u>>>16&255,b[3]=u>>>24&255,e.check=xe(e.check,b,4,0)),u=0,c=0,e.mode=Im;case Im:for(;c<16;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}e.head&&(e.head.xflags=u&255,e.head.os=u>>8),e.flags&512&&e.wrap&4&&(b[0]=u&255,b[1]=u>>>8&255,e.check=xe(e.check,b,2,0)),u=0,c=0,e.mode=Tm;case Tm:if(e.flags&1024){for(;c<16;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}e.length=u,e.head&&(e.head.extra_len=u),e.flags&512&&e.wrap&4&&(b[0]=u&255,b[1]=u>>>8&255,e.check=xe(e.check,b,2,0)),u=0,c=0}else e.head&&(e.head.extra=null);e.mode=Rm;case Rm:if(e.flags&1024&&(d=e.length,d>o&&(d=o),d&&(e.head&&(N=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(s.subarray(n,n+d),N)),e.flags&512&&e.wrap&4&&(e.check=xe(e.check,s,d,n)),o-=d,n+=d,e.length-=d),e.length))break t;e.length=0,e.mode=Om;case Om:if(e.flags&2048){if(o===0)break t;d=0;do N=s[n+d++],e.head&&N&&e.length<65536&&(e.head.name+=String.fromCharCode(N));while(N&&d<o);if(e.flags&512&&e.wrap&4&&(e.check=xe(e.check,s,d,n)),o-=d,n+=d,N)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=vm;case vm:if(e.flags&4096){if(o===0)break t;d=0;do N=s[n+d++],e.head&&N&&e.length<65536&&(e.head.comment+=String.fromCharCode(N));while(N&&d<o);if(e.flags&512&&e.wrap&4&&(e.check=xe(e.check,s,d,n)),o-=d,n+=d,N)break t}else e.head&&(e.head.comment=null);e.mode=Am;case Am:if(e.flags&512){for(;c<16;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(e.wrap&4&&u!==(e.check&65535)){r.msg="header crc mismatch",e.mode=re;break}u=0,c=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),r.adler=e.check=0,e.mode=Mr;break;case Sm:for(;c<32;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}r.adler=e.check=Gm(u),u=0,c=0,e.mode=Ol;case Ol:if(e.havedict===0)return r.next_out=a,r.avail_out=h,r.next_in=n,r.avail_in=o,e.hold=u,e.bits=c,i1;r.adler=e.check=1,e.mode=Mr;case Mr:if(t===s1||t===yu)break t;case Dc:if(e.last){u>>>=c&7,c-=c&7,e.mode=Uc;break}for(;c<3;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}switch(e.last=u&1,u>>>=1,c-=1,u&3){case 0:e.mode=ym;break;case 1:if(c1(e),e.mode=Mu,t===yu){u>>>=2,c-=2;break t}break;case 2:e.mode=Cm;break;case 3:r.msg="invalid block type",e.mode=re}u>>>=2,c-=2;break;case ym:for(u>>>=c&7,c-=c&7;c<32;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if((u&65535)!==(u>>>16^65535)){r.msg="invalid stored block lengths",e.mode=re;break}if(e.length=u&65535,u=0,c=0,e.mode=Lc,t===yu)break t;case Lc:e.mode=Mm;case Mm:if(d=e.length,d){if(d>o&&(d=o),d>h&&(d=h),d===0)break t;i.set(s.subarray(n,n+d),a),o-=d,n+=d,h-=d,a+=d,e.length-=d;break}e.mode=Mr;break;case Cm:for(;c<14;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(e.nlen=(u&31)+257,u>>>=5,c-=5,e.ndist=(u&31)+1,u>>>=5,c-=5,e.ncode=(u&15)+4,u>>>=4,c-=4,e.nlen>286||e.ndist>30){r.msg="too many length or distance symbols",e.mode=re;break}e.have=0,e.mode=Nm;case Nm:for(;e.have<e.ncode;){for(;c<3;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}e.lens[V[e.have++]]=u&7,u>>>=3,c-=3}for(;e.have<19;)e.lens[V[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,D={bits:e.lenbits},P=Ko(e1,e.lens,0,19,e.lencode,0,e.work,D),e.lenbits=D.bits,P){r.msg="invalid code lengths set",e.mode=re;break}e.have=0,e.mode=bm;case bm:for(;e.have<e.nlen+e.ndist;){for(;p=e.lencode[u&(1<<e.lenbits)-1],T=p>>>24,v=p>>>16&255,O=p&65535,!(T<=c);){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(O<16)u>>>=T,c-=T,e.lens[e.have++]=O;else{if(O===16){for(x=T+2;c<x;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(u>>>=T,c-=T,e.have===0){r.msg="invalid bit length repeat",e.mode=re;break}N=e.lens[e.have-1],d=3+(u&3),u>>>=2,c-=2}else if(O===17){for(x=T+3;c<x;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}u>>>=T,c-=T,N=0,d=3+(u&7),u>>>=3,c-=3}else{for(x=T+7;c<x;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}u>>>=T,c-=T,N=0,d=11+(u&127),u>>>=7,c-=7}if(e.have+d>e.nlen+e.ndist){r.msg="invalid bit length repeat",e.mode=re;break}for(;d--;)e.lens[e.have++]=N}}if(e.mode===re)break;if(e.lens[256]===0){r.msg="invalid code -- missing end-of-block",e.mode=re;break}if(e.lenbits=9,D={bits:e.lenbits},P=Ko(zT,e.lens,0,e.nlen,e.lencode,0,e.work,D),e.lenbits=D.bits,P){r.msg="invalid literal/lengths set",e.mode=re;break}if(e.distbits=6,e.distcode=e.distdyn,D={bits:e.distbits},P=Ko(YT,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,D),e.distbits=D.bits,P){r.msg="invalid distances set",e.mode=re;break}if(e.mode=Mu,t===yu)break t;case Mu:e.mode=Cu;case Cu:if(o>=6&&h>=258){r.next_out=a,r.avail_out=h,r.next_in=n,r.avail_in=o,e.hold=u,e.bits=c,qx(r,_),a=r.next_out,i=r.output,h=r.avail_out,n=r.next_in,s=r.input,o=r.avail_in,u=e.hold,c=e.bits,e.mode===Mr&&(e.back=-1);break}for(e.back=0;p=e.lencode[u&(1<<e.lenbits)-1],T=p>>>24,v=p>>>16&255,O=p&65535,!(T<=c);){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(v&&!(v&240)){for(A=T,y=v,M=O;p=e.lencode[M+((u&(1<<A+y)-1)>>A)],T=p>>>24,v=p>>>16&255,O=p&65535,!(A+T<=c);){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}u>>>=A,c-=A,e.back+=A}if(u>>>=T,c-=T,e.back+=T,e.length=O,v===0){e.mode=xm;break}if(v&32){e.back=-1,e.mode=Mr;break}if(v&64){r.msg="invalid literal/length code",e.mode=re;break}e.extra=v&15,e.mode=Pm;case Pm:if(e.extra){for(x=e.extra;c<x;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}e.length+=u&(1<<e.extra)-1,u>>>=e.extra,c-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=Dm;case Dm:for(;p=e.distcode[u&(1<<e.distbits)-1],T=p>>>24,v=p>>>16&255,O=p&65535,!(T<=c);){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(!(v&240)){for(A=T,y=v,M=O;p=e.distcode[M+((u&(1<<A+y)-1)>>A)],T=p>>>24,v=p>>>16&255,O=p&65535,!(A+T<=c);){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}u>>>=A,c-=A,e.back+=A}if(u>>>=T,c-=T,e.back+=T,v&64){r.msg="invalid distance code",e.mode=re;break}e.offset=O,e.extra=v&15,e.mode=Lm;case Lm:if(e.extra){for(x=e.extra;c<x;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}e.offset+=u&(1<<e.extra)-1,u>>>=e.extra,c-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){r.msg="invalid distance too far back",e.mode=re;break}e.mode=Um;case Um:if(h===0)break t;if(d=_-h,e.offset>d){if(d=e.offset-d,d>e.whave&&e.sane){r.msg="invalid distance too far back",e.mode=re;break}d>e.wnext?(d-=e.wnext,f=e.wsize-d):f=e.wnext-d,d>e.length&&(d=e.length),m=e.window}else m=i,f=a-e.offset,d=e.length;d>h&&(d=h),h-=d,e.length-=d;do i[a++]=m[f++];while(--d);e.length===0&&(e.mode=Cu);break;case xm:if(h===0)break t;i[a++]=e.length,h--,e.mode=Cu;break;case Uc:if(e.wrap){for(;c<32;){if(o===0)break t;o--,u|=s[n++]<<c,c+=8}if(_-=h,r.total_out+=_,e.total+=_,e.wrap&4&&_&&(r.adler=e.check=e.flags?xe(e.check,i,_,a-_):hh(e.check,i,_,a-_)),_=h,e.wrap&4&&(e.flags?u:Gm(u))!==e.check){r.msg="incorrect data check",e.mode=re;break}u=0,c=0}e.mode=Fm;case Fm:if(e.wrap&&e.flags){for(;c<32;){if(o===0)break t;o--,u+=s[n++]<<c,c+=8}if(e.wrap&4&&u!==(e.total&4294967295)){r.msg="incorrect length check",e.mode=re;break}u=0,c=0}e.mode=wm;case wm:P=r1;break t;case re:P=WT;break t;case KT:return XT;case qT:default:return Ps}return r.next_out=a,r.avail_out=h,r.next_in=n,r.avail_in=o,e.hold=u,e.bits=c,(e.wsize||_!==r.avail_out&&e.mode<re&&(e.mode<Uc||t!==gm))&&tR(r,r.output,r.next_out,_-r.avail_out),l-=r.avail_in,_-=r.avail_out,r.total_in+=l,r.total_out+=_,e.total+=_,e.wrap&4&&_&&(r.adler=e.check=e.flags?xe(e.check,i,_,r.next_out-_):hh(e.check,i,_,r.next_out-_)),r.data_type=e.bits+(e.last?64:0)+(e.mode===Mr?128:0)+(e.mode===Mu||e.mode===Lc?256:0),(l===0&&_===0||t===gm)&&P===Un&&(P=n1),P},f1=r=>{if(wn(r))return Ps;let t=r.state;return t.window&&(t.window=null),r.state=null,Un},g1=(r,t)=>{if(wn(r))return Ps;const e=r.state;return e.wrap&2?(e.head=t,t.done=!1,Un):Ps},E1=(r,t)=>{const e=t.length;let s,i,n;return wn(r)||(s=r.state,s.wrap!==0&&s.mode!==Ol)?Ps:s.mode===Ol&&(i=1,i=hh(i,t,e,0),i!==s.check)?WT:(n=tR(r,t,e,e),n?(s.mode=KT,XT):(s.havedict=1,Un))};var p1=ZT,m1=JT,I1=QT,T1=_1,R1=$T,O1=d1,v1=f1,A1=g1,S1=E1,y1="pako inflate (from Nodeca project)",kr={inflateReset:p1,inflateReset2:m1,inflateResetKeep:I1,inflateInit:T1,inflateInit2:R1,inflate:O1,inflateEnd:v1,inflateGetHeader:A1,inflateSetDictionary:S1,inflateInfo:y1};function M1(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var C1=M1;const eR=Object.prototype.toString,{Z_NO_FLUSH:N1,Z_FINISH:b1,Z_OK:_h,Z_STREAM_END:wc,Z_NEED_DICT:Gc,Z_STREAM_ERROR:P1,Z_DATA_ERROR:Hm,Z_MEM_ERROR:D1}=Ch;function bh(r){this.options=i_.assign({chunkSize:1024*64,windowBits:15,to:""},r||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(r&&r.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new kT,this.strm.avail_out=0;let e=kr.inflateInit2(this.strm,t.windowBits);if(e!==_h)throw new Error(wa[e]);if(this.header=new C1,kr.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=lh.string2buf(t.dictionary):eR.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=kr.inflateSetDictionary(this.strm,t.dictionary),e!==_h)))throw new Error(wa[e])}bh.prototype.push=function(r,t){const e=this.strm,s=this.options.chunkSize,i=this.options.dictionary;let n,a,o;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?b1:N1,eR.call(r)==="[object ArrayBuffer]"?e.input=new Uint8Array(r):e.input=r,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(s),e.next_out=0,e.avail_out=s),n=kr.inflate(e,a),n===Gc&&i&&(n=kr.inflateSetDictionary(e,i),n===_h?n=kr.inflate(e,a):n===Hm&&(n=Gc));e.avail_in>0&&n===wc&&e.state.wrap>0&&r[e.next_in]!==0;)kr.inflateReset(e),n=kr.inflate(e,a);switch(n){case P1:case Hm:case Gc:case D1:return this.onEnd(n),this.ended=!0,!1}if(o=e.avail_out,e.next_out&&(e.avail_out===0||n===wc))if(this.options.to==="string"){let h=lh.utf8border(e.output,e.next_out),u=e.next_out-h,c=lh.buf2string(e.output,h);e.next_out=u,e.avail_out=s-u,u&&e.output.set(e.output.subarray(h,h+u),0),this.onData(c)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(n===_h&&o===0)){if(n===wc)return n=kr.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,!0;if(e.avail_in===0)break}}return!0};bh.prototype.onData=function(r){this.chunks.push(r)};bh.prototype.onEnd=function(r){r===_h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=i_.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg};function wg(r,t){const e=new bh(t);if(e.push(r),e.err)throw e.msg||wa[e.err];return e.result}function L1(r,t){return t=t||{},t.raw=!0,wg(r,t)}var U1=bh,x1=wg,F1=L1,w1=wg,G1=Ch,B1={Inflate:U1,inflate:x1,inflateRaw:F1,ungzip:w1,constants:G1};const{Inflate:yst,inflate:H1,inflateRaw:Mst,ungzip:Cst}=B1;var Vm=H1;const sR=class rR{constructor(t){this._jsonFile=null,this._image=null,this._imageData=null,this._baseTexture=null,this.parse(t)}parse(t){const e=new s_(t);let s=e.readShort();for(;s>0;){const i=e.readShort(),n=e.readBytes(i).toString(),a=e.readInt(),o=e.readBytes(a);if(n.endsWith(".json")){const h=Vm(o.toArrayBuffer());this._jsonFile=JSON.parse(rR.TEXT_DECODER.decode(h))}else{const h=Vm(o.toArrayBuffer()),u=TT(h);this._baseTexture=new Xt("data:image/png;base64,"+u)}s--}}get jsonFile(){return this._jsonFile}get baseTexture(){return this._baseTexture}};sR.TEXT_DECODER=new TextDecoder("utf-8");let iR=sR;/*!
 * @pixi/display - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Z.SORTABLE_CHILDREN=!1;var ch=function(){function r(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null,this.updateID=-1}return r.prototype.isEmpty=function(){return this.minX>this.maxX||this.minY>this.maxY},r.prototype.clear=function(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},r.prototype.getRectangle=function(t){return this.minX>this.maxX||this.minY>this.maxY?it.EMPTY:(t=t||new it(0,0,1,1),t.x=this.minX,t.y=this.minY,t.width=this.maxX-this.minX,t.height=this.maxY-this.minY,t)},r.prototype.addPoint=function(t){this.minX=Math.min(this.minX,t.x),this.maxX=Math.max(this.maxX,t.x),this.minY=Math.min(this.minY,t.y),this.maxY=Math.max(this.maxY,t.y)},r.prototype.addPointMatrix=function(t,e){var s=t.a,i=t.b,n=t.c,a=t.d,o=t.tx,h=t.ty,u=s*e.x+n*e.y+o,c=i*e.x+a*e.y+h;this.minX=Math.min(this.minX,u),this.maxX=Math.max(this.maxX,u),this.minY=Math.min(this.minY,c),this.maxY=Math.max(this.maxY,c)},r.prototype.addQuad=function(t){var e=this.minX,s=this.minY,i=this.maxX,n=this.maxY,a=t[0],o=t[1];e=a<e?a:e,s=o<s?o:s,i=a>i?a:i,n=o>n?o:n,a=t[2],o=t[3],e=a<e?a:e,s=o<s?o:s,i=a>i?a:i,n=o>n?o:n,a=t[4],o=t[5],e=a<e?a:e,s=o<s?o:s,i=a>i?a:i,n=o>n?o:n,a=t[6],o=t[7],e=a<e?a:e,s=o<s?o:s,i=a>i?a:i,n=o>n?o:n,this.minX=e,this.minY=s,this.maxX=i,this.maxY=n},r.prototype.addFrame=function(t,e,s,i,n){this.addFrameMatrix(t.worldTransform,e,s,i,n)},r.prototype.addFrameMatrix=function(t,e,s,i,n){var a=t.a,o=t.b,h=t.c,u=t.d,c=t.tx,l=t.ty,_=this.minX,d=this.minY,f=this.maxX,m=this.maxY,p=a*e+h*s+c,T=o*e+u*s+l;_=p<_?p:_,d=T<d?T:d,f=p>f?p:f,m=T>m?T:m,p=a*i+h*s+c,T=o*i+u*s+l,_=p<_?p:_,d=T<d?T:d,f=p>f?p:f,m=T>m?T:m,p=a*e+h*n+c,T=o*e+u*n+l,_=p<_?p:_,d=T<d?T:d,f=p>f?p:f,m=T>m?T:m,p=a*i+h*n+c,T=o*i+u*n+l,_=p<_?p:_,d=T<d?T:d,f=p>f?p:f,m=T>m?T:m,this.minX=_,this.minY=d,this.maxX=f,this.maxY=m},r.prototype.addVertexData=function(t,e,s){for(var i=this.minX,n=this.minY,a=this.maxX,o=this.maxY,h=e;h<s;h+=2){var u=t[h],c=t[h+1];i=u<i?u:i,n=c<n?c:n,a=u>a?u:a,o=c>o?c:o}this.minX=i,this.minY=n,this.maxX=a,this.maxY=o},r.prototype.addVertices=function(t,e,s,i){this.addVerticesMatrix(t.worldTransform,e,s,i)},r.prototype.addVerticesMatrix=function(t,e,s,i,n,a){n===void 0&&(n=0),a===void 0&&(a=n);for(var o=t.a,h=t.b,u=t.c,c=t.d,l=t.tx,_=t.ty,d=this.minX,f=this.minY,m=this.maxX,p=this.maxY,T=s;T<i;T+=2){var v=e[T],O=e[T+1],A=o*v+u*O+l,y=c*O+h*v+_;d=Math.min(d,A-n),m=Math.max(m,A+n),f=Math.min(f,y-a),p=Math.max(p,y+a)}this.minX=d,this.minY=f,this.maxX=m,this.maxY=p},r.prototype.addBounds=function(t){var e=this.minX,s=this.minY,i=this.maxX,n=this.maxY;this.minX=t.minX<e?t.minX:e,this.minY=t.minY<s?t.minY:s,this.maxX=t.maxX>i?t.maxX:i,this.maxY=t.maxY>n?t.maxY:n},r.prototype.addBoundsMask=function(t,e){var s=t.minX>e.minX?t.minX:e.minX,i=t.minY>e.minY?t.minY:e.minY,n=t.maxX<e.maxX?t.maxX:e.maxX,a=t.maxY<e.maxY?t.maxY:e.maxY;if(s<=n&&i<=a){var o=this.minX,h=this.minY,u=this.maxX,c=this.maxY;this.minX=s<o?s:o,this.minY=i<h?i:h,this.maxX=n>u?n:u,this.maxY=a>c?a:c}},r.prototype.addBoundsMatrix=function(t,e){this.addFrameMatrix(e,t.minX,t.minY,t.maxX,t.maxY)},r.prototype.addBoundsArea=function(t,e){var s=t.minX>e.x?t.minX:e.x,i=t.minY>e.y?t.minY:e.y,n=t.maxX<e.x+e.width?t.maxX:e.x+e.width,a=t.maxY<e.y+e.height?t.maxY:e.y+e.height;if(s<=n&&i<=a){var o=this.minX,h=this.minY,u=this.maxX,c=this.maxY;this.minX=s<o?s:o,this.minY=i<h?i:h,this.maxX=n>u?n:u,this.maxY=a>c?a:c}},r.prototype.pad=function(t,e){t===void 0&&(t=0),e===void 0&&(e=t),this.isEmpty()||(this.minX-=t,this.maxX+=t,this.minY-=e,this.maxY+=e)},r.prototype.addFramePad=function(t,e,s,i,n,a){t-=n,e-=a,s+=n,i+=a,this.minX=this.minX<t?this.minX:t,this.maxX=this.maxX>s?this.maxX:s,this.minY=this.minY<e?this.minY:e,this.maxY=this.maxY>i?this.maxY:i},r}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Fd=function(r,t){return Fd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},Fd(r,t)};function Gg(r,t){Fd(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var fe=function(r){Gg(t,r);function t(){var e=r.call(this)||this;return e.tempDisplayObjectParent=null,e.transform=new rT,e.alpha=1,e.visible=!0,e.renderable=!0,e.cullable=!1,e.cullArea=null,e.parent=null,e.worldAlpha=1,e._lastSortedIndex=0,e._zIndex=0,e.filterArea=null,e.filters=null,e._enabledFilters=null,e._bounds=new ch,e._localBounds=null,e._boundsID=0,e._boundsRect=null,e._localBoundsRect=null,e._mask=null,e._maskRefCount=0,e._destroyed=!1,e.isSprite=!1,e.isMask=!1,e}return t.mixin=function(e){for(var s=Object.keys(e),i=0;i<s.length;++i){var n=s[i];Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(e,n))}},Object.defineProperty(t.prototype,"destroyed",{get:function(){return this._destroyed},enumerable:!1,configurable:!0}),t.prototype._recursivePostUpdateTransform=function(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},t.prototype.updateTransform=function(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},t.prototype.getBounds=function(e,s){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._bounds.updateID!==this._boundsID&&(this.calculateBounds(),this._bounds.updateID=this._boundsID),s||(this._boundsRect||(this._boundsRect=new it),s=this._boundsRect),this._bounds.getRectangle(s)},t.prototype.getLocalBounds=function(e){e||(this._localBoundsRect||(this._localBoundsRect=new it),e=this._localBoundsRect),this._localBounds||(this._localBounds=new ch);var s=this.transform,i=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform;var n=this._bounds,a=this._boundsID;this._bounds=this._localBounds;var o=this.getBounds(!1,e);return this.parent=i,this.transform=s,this._bounds=n,this._bounds.updateID+=this._boundsID-a,o},t.prototype.toGlobal=function(e,s,i){return i===void 0&&(i=!1),i||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,s)},t.prototype.toLocal=function(e,s,i,n){return s&&(e=s.toGlobal(e,i,n)),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,i)},t.prototype.setParent=function(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},t.prototype.setTransform=function(e,s,i,n,a,o,h,u,c){return e===void 0&&(e=0),s===void 0&&(s=0),i===void 0&&(i=1),n===void 0&&(n=1),a===void 0&&(a=0),o===void 0&&(o=0),h===void 0&&(h=0),u===void 0&&(u=0),c===void 0&&(c=0),this.position.x=e,this.position.y=s,this.scale.x=i||1,this.scale.y=n||1,this.rotation=a,this.skew.x=o,this.skew.y=h,this.pivot.x=u,this.pivot.y=c,this},t.prototype.destroy=function(e){this.parent&&this.parent.removeChild(this),this._destroyed=!0,this.transform=null,this.parent=null,this._bounds=null,this.mask=null,this.cullArea=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this.emit("destroyed"),this.removeAllListeners()},Object.defineProperty(t.prototype,"_tempDisplayObjectParent",{get:function(){return this.tempDisplayObjectParent===null&&(this.tempDisplayObjectParent=new nR),this.tempDisplayObjectParent},enumerable:!1,configurable:!0}),t.prototype.enableTempParent=function(){var e=this.parent;return this.parent=this._tempDisplayObjectParent,e},t.prototype.disableTempParent=function(e){this.parent=e},Object.defineProperty(t.prototype,"x",{get:function(){return this.position.x},set:function(e){this.transform.position.x=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.position.y},set:function(e){this.transform.position.y=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldTransform",{get:function(){return this.transform.worldTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"localTransform",{get:function(){return this.transform.localTransform},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.transform.position},set:function(e){this.transform.position.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.transform.scale},set:function(e){this.transform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pivot",{get:function(){return this.transform.pivot},set:function(e){this.transform.pivot.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"skew",{get:function(){return this.transform.skew},set:function(e){this.transform.skew.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this.transform.rotation},set:function(e){this.transform.rotation=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"angle",{get:function(){return this.transform.rotation*mD},set:function(e){this.transform.rotation=e*ID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"zIndex",{get:function(){return this._zIndex},set:function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"worldVisible",{get:function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(e){if(this._mask!==e){if(this._mask){var s=this._mask.isMaskData?this._mask.maskObject:this._mask;s&&(s._maskRefCount--,s._maskRefCount===0&&(s.renderable=!0,s.isMask=!1))}if(this._mask=e,this._mask){var s=this._mask.isMaskData?this._mask.maskObject:this._mask;s&&(s._maskRefCount===0&&(s.renderable=!1,s.isMask=!0),s._maskRefCount++)}}},enumerable:!1,configurable:!0}),t}(Ah),nR=function(r){Gg(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.sortDirty=null,e}return t}(fe);fe.prototype.displayObjectUpdateTransform=fe.prototype.updateTransform;function V1(r,t){return r.zIndex===t.zIndex?r._lastSortedIndex-t._lastSortedIndex:r.zIndex-t.zIndex}var Tr=function(r){Gg(t,r);function t(){var e=r.call(this)||this;return e.children=[],e.sortableChildren=Z.SORTABLE_CHILDREN,e.sortDirty=!1,e}return t.prototype.onChildrenChange=function(e){},t.prototype.addChild=function(){for(var e=arguments,s=[],i=0;i<arguments.length;i++)s[i]=e[i];if(s.length>1)for(var n=0;n<s.length;n++)this.addChild(s[n]);else{var a=s[0];a.parent&&a.parent.removeChild(a),a.parent=this,this.sortDirty=!0,a.transform._parentID=-1,this.children.push(a),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",a,this,this.children.length-1),a.emit("added",this)}return s[0]},t.prototype.addChildAt=function(e,s){if(s<0||s>this.children.length)throw new Error(e+"addChildAt: The index "+s+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(s,0,e),this._boundsID++,this.onChildrenChange(s),e.emit("added",this),this.emit("childAdded",e,this,s),e},t.prototype.swapChildren=function(e,s){if(e!==s){var i=this.getChildIndex(e),n=this.getChildIndex(s);this.children[i]=s,this.children[n]=e,this.onChildrenChange(i<n?i:n)}},t.prototype.getChildIndex=function(e){var s=this.children.indexOf(e);if(s===-1)throw new Error("The supplied DisplayObject must be a child of the caller");return s},t.prototype.setChildIndex=function(e,s){if(s<0||s>=this.children.length)throw new Error("The index "+s+" supplied is out of bounds "+this.children.length);var i=this.getChildIndex(e);Hu(this.children,i,1),this.children.splice(s,0,e),this.onChildrenChange(s)},t.prototype.getChildAt=function(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},t.prototype.removeChild=function(){for(var e=arguments,s=[],i=0;i<arguments.length;i++)s[i]=e[i];if(s.length>1)for(var n=0;n<s.length;n++)this.removeChild(s[n]);else{var a=s[0],o=this.children.indexOf(a);if(o===-1)return null;a.parent=null,a.transform._parentID=-1,Hu(this.children,o,1),this._boundsID++,this.onChildrenChange(o),a.emit("removed",this),this.emit("childRemoved",a,this,o)}return s[0]},t.prototype.removeChildAt=function(e){var s=this.getChildAt(e);return s.parent=null,s.transform._parentID=-1,Hu(this.children,e,1),this._boundsID++,this.onChildrenChange(e),s.emit("removed",this),this.emit("childRemoved",s,this,e),s},t.prototype.removeChildren=function(e,s){e===void 0&&(e=0),s===void 0&&(s=this.children.length);var i=e,n=s,a=n-i,o;if(a>0&&a<=n){o=this.children.splice(i,a);for(var h=0;h<o.length;++h)o[h].parent=null,o[h].transform&&(o[h].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var h=0;h<o.length;++h)o[h].emit("removed",this),this.emit("childRemoved",o[h],this,h);return o}else if(a===0&&this.children.length===0)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},t.prototype.sortChildren=function(){for(var e=!1,s=0,i=this.children.length;s<i;++s){var n=this.children[s];n._lastSortedIndex=s,!e&&n.zIndex!==0&&(e=!0)}e&&this.children.length>1&&this.children.sort(V1),this.sortDirty=!1},t.prototype.updateTransform=function(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,s=this.children.length;e<s;++e){var i=this.children[e];i.visible&&i.updateTransform()}},t.prototype.calculateBounds=function(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var s=this.children[e];if(!(!s.visible||!s.renderable))if(s.calculateBounds(),s._mask){var i=s._mask.isMaskData?s._mask.maskObject:s._mask;i?(i.calculateBounds(),this._bounds.addBoundsMask(s._bounds,i._bounds)):this._bounds.addBounds(s._bounds)}else s.filterArea?this._bounds.addBoundsArea(s._bounds,s.filterArea):this._bounds.addBounds(s._bounds)}this._bounds.updateID=this._boundsID},t.prototype.getLocalBounds=function(e,s){s===void 0&&(s=!1);var i=r.prototype.getLocalBounds.call(this,e);if(!s)for(var n=0,a=this.children.length;n<a;++n){var o=this.children[n];o.visible&&o.updateTransform()}return i},t.prototype._calculateBounds=function(){},t.prototype._renderWithCulling=function(e){var s=e.renderTexture.sourceFrame;if(s.width>0&&s.height>0){var i,n;if(this.cullArea?(i=this.cullArea,n=this.worldTransform):this._render!==t.prototype._render&&(i=this.getBounds(!0)),i&&s.intersects(i,n))this._render(e);else if(this.cullArea)return;for(var a=0,o=this.children.length;a<o;++a){var h=this.children[a],u=h.cullable;h.cullable=u||!this.cullArea,h.render(e),h.cullable=u}}},t.prototype.render=function(e){if(!(!this.visible||this.worldAlpha<=0||!this.renderable))if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else if(this.cullable)this._renderWithCulling(e);else{this._render(e);for(var s=0,i=this.children.length;s<i;++s)this.children[s].render(e)}},t.prototype.renderAdvanced=function(e){var s=this.filters,i=this._mask;if(s){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var n=0;n<s.length;n++)s[n].enabled&&this._enabledFilters.push(s[n])}var a=s&&this._enabledFilters&&this._enabledFilters.length||i&&(!i.isMaskData||i.enabled&&(i.autoDetect||i.type!==Ie.NONE));if(a&&e.batch.flush(),s&&this._enabledFilters&&this._enabledFilters.length&&e.filter.push(this,this._enabledFilters),i&&e.mask.push(this,this._mask),this.cullable)this._renderWithCulling(e);else{this._render(e);for(var n=0,o=this.children.length;n<o;++n)this.children[n].render(e)}a&&e.batch.flush(),i&&e.mask.pop(this),s&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},t.prototype._render=function(e){},t.prototype.destroy=function(e){r.prototype.destroy.call(this),this.sortDirty=!1;var s=typeof e=="boolean"?e:e&&e.children,i=this.removeChildren(0,this.children.length);if(s)for(var n=0;n<i.length;++n)i[n].destroy(e)},Object.defineProperty(t.prototype,"width",{get:function(){return this.scale.x*this.getLocalBounds().width},set:function(e){var s=this.getLocalBounds().width;s!==0?this.scale.x=e/s:this.scale.x=1,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.scale.y*this.getLocalBounds().height},set:function(e){var s=this.getLocalBounds().height;s!==0?this.scale.y=e/s:this.scale.y=1,this._height=e},enumerable:!1,configurable:!0}),t}(fe);Tr.prototype.containerUpdateTransform=Tr.prototype.updateTransform;class qo{__init(){this.tileAnim=[0,0]}__init2(){this.dontUseTransform=!1}constructor(t){qo.prototype.__init.call(this),qo.prototype.__init2.call(this),this.renderer=t,this.tileAnim=[0,0]}static getInstance(t){return t.plugins.tilemap||(t.plugins.tilemap=new qo(t)),t.plugins.tilemap}}const Bc={TEXTURES_PER_TILEMAP:16,TEXTILE_DIMEN:1024,TEXTILE_UNITS:1,TEXTILE_SCALE_MODE:_s.LINEAR,use32bitIndex:!1,DO_CLEAR:!0,get maxTextures(){return this.MAX_TEXTURES},set maxTextures(r){this.MAX_TEXTURES=r},get boundSize(){return this.TEXTURE_TILE_DIMEN},set boundSize(r){this.TILE_TEXTURE_DIMEN=r},get boundCountPerBuffer(){return this.TEXTILE_UNITS},set boundCountPerBuffer(r){this.TEXTILE_UNITS=r}};function Nu(r,t){return r??t()}var Pt;(function(r){r[r.U=0]="U";const e=0+1;r[r.V=e]="V";const s=e+1;r[r.X=s]="X";const i=s+1;r[r.Y=i]="Y";const n=i+1;r[r.TILE_WIDTH=n]="TILE_WIDTH";const a=n+1;r[r.TILE_HEIGHT=a]="TILE_HEIGHT";const o=a+1;r[r.ROTATE=o]="ROTATE";const h=o+1;r[r.ANIM_X=h]="ANIM_X";const u=h+1;r[r.ANIM_Y=u]="ANIM_Y";const c=u+1;r[r.TEXTURE_INDEX=c]="TEXTURE_INDEX";const l=c+1;r[r.ANIM_COUNT_X=l]="ANIM_COUNT_X";const _=l+1;r[r.ANIM_COUNT_Y=_]="ANIM_COUNT_Y";const d=_+1;r[r.ANIM_DIVISOR=d]="ANIM_DIVISOR";const f=d+1;r[r.ALPHA=f]="ALPHA"})(Pt||(Pt={}));const nr=Object.keys(Pt).length/2;class Pe extends Tr{__init(){this.shadowColor=new Float32Array([0,0,0,.5])}__init2(){this._globalMat=null}__init3(){this.tileAnim=null}__init4(){this.modificationMarker=0}__init5(){this.offsetX=0}__init6(){this.offsetY=0}__init7(){this.compositeParent=!1}__init8(){this.tilemapBounds=new ch}__init9(){this.hasAnimatedTile=!1}__init10(){this.pointsBuf=[]}constructor(t){super(),Pe.prototype.__init.call(this),Pe.prototype.__init2.call(this),Pe.prototype.__init3.call(this),Pe.prototype.__init4.call(this),Pe.prototype.__init5.call(this),Pe.prototype.__init6.call(this),Pe.prototype.__init7.call(this),Pe.prototype.__init8.call(this),Pe.prototype.__init9.call(this),Pe.prototype.__init10.call(this),Pe.prototype.__init11.call(this),Pe.prototype.__init12.call(this),Pe.prototype.__init13.call(this),Pe.prototype.__init14.call(this),Pe.prototype.__init15.call(this),Pe.prototype.__init16.call(this),this.setTileset(t)}getTileset(){return this.tileset}setTileset(t=[]){Array.isArray(t)||(t=[t]);for(let e=0;e<t.length;e++)t[e].baseTexture&&(t[e]=t[e].baseTexture);return this.tileset=t,this}clear(){return this.pointsBuf.length=0,this.modificationMarker=0,this.tilemapBounds.clear(),this.hasAnimatedTile=!1,this}tile(t,e,s,i={}){let n,a=-1;if(typeof t=="number")a=t,n=this.tileset[a];else{let O;typeof t=="string"?O=_t.from(t):O=t;const A=this.tileset;for(let y=0;y<A.length;y++)if(A[y]===O.castToBaseTexture()){a=y;break}"baseTexture"in O&&(i.u=Nu(i.u,()=>O.frame.x),i.v=Nu(i.v,()=>O.frame.y),i.tileWidth=Nu(i.tileWidth,()=>O.orig.width),i.tileHeight=Nu(i.tileHeight,()=>O.orig.height)),n=O.castToBaseTexture()}if(!n||a<0)return console.error("The tile texture was not found in the tilemap tileset."),this;const{u:o=0,v:h=0,tileWidth:u=n.realWidth,tileHeight:c=n.realHeight,animX:l=0,animY:_=0,rotate:d=0,animCountX:f=1024,animCountY:m=1024,animDivisor:p=1,alpha:T=1}=i,v=this.pointsBuf;return this.hasAnimatedTile=this.hasAnimatedTile||l>0||_>0,v.push(o),v.push(h),v.push(e),v.push(s),v.push(u),v.push(c),v.push(d),v.push(l|0),v.push(_|0),v.push(a),v.push(f),v.push(m),v.push(p),v.push(T),this.tilemapBounds.addFramePad(e,s,e+u,s+c,0,0),this}tileRotate(t){const e=this.pointsBuf;e[e.length-(nr-Pt.TEXTURE_INDEX)]=t}tileAnimX(t,e){const s=this.pointsBuf;s[s.length-(nr-Pt.ANIM_X)]=t,s[s.length-(nr-Pt.ANIM_COUNT_X)]=e}tileAnimY(t,e){const s=this.pointsBuf;s[s.length-(nr-Pt.ANIM_Y)]=t,s[s.length-(nr-Pt.ANIM_COUNT_Y)]=e}tileAnimDivisor(t){const e=this.pointsBuf;e[e.length-(nr-Pt.ANIM_DIVISOR)]=t}tileAlpha(t){const e=this.pointsBuf;e[e.length-(nr-Pt.ALPHA)]=t}__init11(){this.renderCanvas=t=>{const e=qo.getInstance(t);if(e&&!e.dontUseTransform){const s=this.worldTransform;t.context.setTransform(s.a,s.b,s.c,s.d,s.tx*t.resolution,s.ty*t.resolution)}this.renderCanvasCore(t)}}renderCanvasCore(t){if(this.tileset.length===0)return;const e=this.pointsBuf,s=this.tileAnim||t.plugins.tilemap&&t.plugins.tilemap.tileAnim;t.context.fillStyle="#000000";for(let i=0,n=e.length;i<n;i+=nr){let a=e[i+Pt.U],o=e[i+Pt.V];const h=e[i+Pt.X],u=e[i+Pt.Y],c=e[i+Pt.TILE_WIDTH],l=e[i+Pt.TILE_HEIGHT];a+=e[i+Pt.ANIM_X]*s[0],o+=e[i+Pt.ANIM_Y]*s[1];const _=e[i+Pt.TEXTURE_INDEX],d=e[i+Pt.ALPHA];_>=0&&this.tileset[_]?(t.context.globalAlpha=d,t.context.drawImage(this.tileset[_].getDrawableSource(),a,o,c,l,h,u,c,l)):(t.context.globalAlpha=.5,t.context.fillRect(h,u,c,l)),t.context.globalAlpha=1}}__init12(){this.vbId=0}__init13(){this.vb=null}__init14(){this.vbBuffer=null}__init15(){this.vbArray=null}__init16(){this.vbInts=null}destroyVb(){this.vb&&(this.vb.destroy(),this.vb=null)}render(t){const e=t.plugins.tilemap,s=e.getShader();t.batch.setObjectRenderer(e),this._globalMat=s.uniforms.projTransMatrix,t.globalUniforms.uniforms.projectionMatrix.copyTo(this._globalMat).append(this.worldTransform),s.uniforms.shadowColor=this.shadowColor,s.uniforms.animationFrame=this.tileAnim||e.tileAnim,this.renderWebGLCore(t,e)}renderWebGLCore(t,e){const s=this.pointsBuf;if(s.length===0)return;const i=s.length/nr,n=e.getShader(),a=this.tileset;if(a.length===0)return;e.bindTileTextures(t,a),t.shader.bind(n,!1);let o=this.vb;o||(o=e.createVb(),this.vb=o,this.vbId=o.id,this.vbBuffer=null,this.modificationMarker=0),e.checkIndexBuffer(i,o);const h=o.getBuffer("aVertexPosition"),u=i*o.vertPerQuad;if(u!==0){if(this.modificationMarker!==u){this.modificationMarker=u;const c=o.stride*u;if(!this.vbBuffer||this.vbBuffer.byteLength<c){let p=o.stride;for(;p<c;)p*=2;this.vbBuffer=new ArrayBuffer(p),this.vbArray=new Float32Array(this.vbBuffer),this.vbInts=new Uint32Array(this.vbBuffer),h.update(this.vbBuffer)}const l=this.vbArray;let _=0,d=0,f=this.offsetX,m=this.offsetY;for(let p=0;p<s.length;p+=nr){this.compositeParent&&(d=s[p+Pt.TEXTURE_INDEX],f=0,m=0);const v=s[p+Pt.X],O=s[p+Pt.Y],A=s[p+Pt.TILE_WIDTH],y=s[p+Pt.TILE_HEIGHT],M=s[p+Pt.U]+f,N=s[p+Pt.V]+m;let P=s[p+Pt.ROTATE];const b=s[p+Pt.ANIM_X],D=s[p+Pt.ANIM_Y],x=s[p+Pt.ANIM_COUNT_X]||1024,V=s[p+Pt.ANIM_COUNT_Y]||1024,J=b+x*2048,ct=D+V*2048,H=s[p+Pt.ANIM_DIVISOR],z=s[p+Pt.ALPHA];let ht,Xe,Ge,K,rt,Et,Lt,Tt;if(P===0)ht=M,Xe=N,Ge=M+A,K=N,rt=M+A,Et=N+y,Lt=M,Tt=N+y;else{let bt=A/2,Ft=y/2;P%4!==0&&(bt=y/2,Ft=A/2);const Jt=M+bt,ee=N+Ft;P=St.add(P,St.NW),ht=Jt+bt*St.uX(P),Xe=ee+Ft*St.uY(P),P=St.add(P,2),Ge=Jt+bt*St.uX(P),K=ee+Ft*St.uY(P),P=St.add(P,2),rt=Jt+bt*St.uX(P),Et=ee+Ft*St.uY(P),P=St.add(P,2),Lt=Jt+bt*St.uX(P),Tt=ee+Ft*St.uY(P)}l[_++]=v,l[_++]=O,l[_++]=ht,l[_++]=Xe,l[_++]=M+.5,l[_++]=N+.5,l[_++]=M+A-.5,l[_++]=N+y-.5,l[_++]=J,l[_++]=ct,l[_++]=d,l[_++]=H,l[_++]=z,l[_++]=v+A,l[_++]=O,l[_++]=Ge,l[_++]=K,l[_++]=M+.5,l[_++]=N+.5,l[_++]=M+A-.5,l[_++]=N+y-.5,l[_++]=J,l[_++]=ct,l[_++]=d,l[_++]=H,l[_++]=z,l[_++]=v+A,l[_++]=O+y,l[_++]=rt,l[_++]=Et,l[_++]=M+.5,l[_++]=N+.5,l[_++]=M+A-.5,l[_++]=N+y-.5,l[_++]=J,l[_++]=ct,l[_++]=d,l[_++]=H,l[_++]=z,l[_++]=v,l[_++]=O+y,l[_++]=Lt,l[_++]=Tt,l[_++]=M+.5,l[_++]=N+.5,l[_++]=M+A-.5,l[_++]=N+y-.5,l[_++]=J,l[_++]=ct,l[_++]=d,l[_++]=H,l[_++]=z}h.update(l)}t.geometry.bind(o,n),t.geometry.draw(lr.TRIANGLES,i*6,0)}}isModified(t){return!!(this.modificationMarker!==this.pointsBuf.length||t&&this.hasAnimatedTile)}clearModify(){this.modificationMarker=this.pointsBuf.length}_calculateBounds(){const{minX:t,minY:e,maxX:s,maxY:i}=this.tilemapBounds;this._bounds.addFrame(this.transform,t,e,s,i)}getLocalBounds(t){return this.children.length===0?this.tilemapBounds.getRectangle(t):super.getLocalBounds.call(this,t)}destroy(t){super.destroy(t),this.destroyVb()}addFrame(t,e,s,i,n){return this.tile(t,e,s,{animX:i,animY:n}),!0}addRect(t,e,s,i,n,a,o,h=0,u=0,c=0,l=1024,_=1024,d=1,f=1){return this.tile(t,i,n,{u:e,v:s,tileWidth:a,tileHeight:o,animX:h,animY:u,rotate:c,animCountX:l,animCountY:_,animDivisor:d,alpha:f})}}function k1(r){let t="";t+=`
`,t+=`
`,t+="if(vTextureId <= -1.0) {",t+=`
	color = shadowColor;`,t+=`
}`;for(let e=0;e<r;e++)t+=`
else `,e<r-1&&(t+=`if(textureId == ${e}.0)`),t+=`
{`,t+=`
	color = texture2D(uSamplers[${e}], textureCoord * uSamplerSize[${e}]);`,t+=`
}`;return t+=`
`,t+=`
`,t}function j1(r,t){const e=[];for(let i=0;i<t;i++)e[i]=i;r.uniforms.uSamplers=e;const s=[];for(let i=0;i<t;i++)s.push(1/2048),s.push(1/2048);r.uniforms.uSamplerSize=s}function z1(r,t){return t.replace(/%count%/gi,`${r}`).replace(/%forloop%/gi,k1(r))}const Y1=`#version 100
precision highp float;
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
attribute vec4 aFrame;
attribute vec2 aAnim;
attribute float aAnimDivisor;
attribute float aTextureId;
attribute float aAlpha;

uniform mat3 projTransMatrix;
uniform vec2 animationFrame;

varying vec2 vTextureCoord;
varying float vTextureId;
varying vec4 vFrame;
varying float vAlpha;

void main(void)
{
   gl_Position = vec4((projTransMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
   vec2 animCount = floor((aAnim + 0.5) / 2048.0);
   vec2 animFrameOffset = aAnim - animCount * 2048.0;
   vec2 currentFrame = floor(animationFrame / aAnimDivisor);
   vec2 animOffset = animFrameOffset * floor(mod(currentFrame + 0.5, animCount));

   vTextureCoord = aTextureCoord + animOffset;
   vFrame = aFrame + vec4(animOffset, animOffset);
   vTextureId = aTextureId;
   vAlpha = aAlpha;
}
`,W1=`#version 100
#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
varying vec2 vTextureCoord;
varying vec4 vFrame;
varying float vTextureId;
varying float vAlpha;
uniform vec4 shadowColor;
uniform sampler2D uSamplers[%count%];
uniform vec2 uSamplerSize[%count%];

void main(void)
{
   vec2 textureCoord = clamp(vTextureCoord, vFrame.xy, vFrame.zw);
   float textureId = floor(vTextureId + 0.5);

   vec4 color;
   %forloop%
   gl_FragColor = color * vAlpha;
}
`;class Bg extends Cn{__init(){this.maxTextures=0}constructor(t){super(new e_(Y1,z1(t,W1)),{animationFrame:new Float32Array(2),uSamplers:[],uSamplerSize:[],projTransMatrix:new Vt}),Bg.prototype.__init.call(this),this.maxTextures=t,j1(this,this.maxTextures)}}class ma extends $l{__init2(){this.vertSize=13}__init3(){this.vertPerQuad=4}__init4(){this.stride=this.vertSize*4}__init5(){this.lastTimeAccess=0}constructor(){super(),ma.prototype.__init2.call(this),ma.prototype.__init3.call(this),ma.prototype.__init4.call(this),ma.prototype.__init5.call(this);const t=this.buf=new ns(new Float32Array(2),!0,!1);this.addAttribute("aVertexPosition",t,0,!1,0,this.stride,0).addAttribute("aTextureCoord",t,0,!1,0,this.stride,2*4).addAttribute("aFrame",t,0,!1,0,this.stride,4*4).addAttribute("aAnim",t,0,!1,0,this.stride,8*4).addAttribute("aTextureId",t,0,!1,0,this.stride,10*4).addAttribute("aAnimDivisor",t,0,!1,0,this.stride,11*4).addAttribute("aAlpha",t,0,!1,0,this.stride,12*4)}}class Ia extends t_{__init(){this.tileAnim=[0,0]}__init2(){this.ibLen=0}__init3(){this.indexBuffer=null}__init4(){this.textiles=[]}constructor(t){super(t),Ia.prototype.__init.call(this),Ia.prototype.__init2.call(this),Ia.prototype.__init3.call(this),Ia.prototype.__init4.call(this),this.shader=new Bg(Bc.TEXTURES_PER_TILEMAP),this.indexBuffer=new ns(void 0,!0,!0),this.checkIndexBuffer(2e3),this.makeTextiles()}bindTileTextures(t,e){const s=e.length,i=this.shader,n=Bc.TEXTURES_PER_TILEMAP,a=i.uniforms.uSamplerSize;if(!(s>Bc.TEXTILE_UNITS*n)){for(let o=0;o<e.length;o++){const h=e[o];if(!h||!h.valid)return;t.texture.bind(e[o],o),a[o*2]=1/e[o].realWidth,a[o*2+1]=1/e[o].realHeight}i.uniforms.uSamplerSize=a}}start(){}createVb(){const t=new ma;return t.addIndex(this.indexBuffer),t.lastTimeAccess=Date.now(),t}getShader(){return this.shader}destroy(){super.destroy(),this.shader=null}checkIndexBuffer(t,e=null){const s=t*6;s<=this.ibLen||(this.ibLen=s,this.indexBuffer.update(dD(t,void 0)))}makeTextiles(){}}Ng.registerPlugin("tilemap",Ia);class X1 extends Wa{constructor(t){super(`attribute vec2 aVertexPosition;
            attribute vec2 aTextureCoord;
            
            uniform mat3 projectionMatrix;
            
            varying vec2 vTextureCoord;
            
            void main(void)
            {
                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
                vTextureCoord = aTextureCoord;
            }`,`varying vec2 vTextureCoord;
            uniform sampler2D uSampler;
            
            uniform float gamma;
            uniform float contrast;
            uniform float saturation;
            uniform float brightness;
            uniform float red;
            uniform float green;
            uniform float blue;
            uniform float alpha;
            
            void main(void)
            {
                vec4 c = texture2D(uSampler, vTextureCoord);
            
                if (c.a > 0.0) {
                    c.rgb /= c.a;
            
                    vec3 rgb = pow(c.rgb, vec3(1. / gamma));
                    rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
                    rgb.r *= red;
                    rgb.g *= green;
                    rgb.b *= blue;
                    c.rgb = rgb * brightness;
            
                    c.rgb *= c.a;
                }
            
                gl_FragColor = c * alpha;
            }`),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,t)}apply(t,e,s,i){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,s,i)}}const K1=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,q1=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D mask;
uniform int fromChannel;
uniform int toChannel;

void main(void) {
    vec4 maskColor = texture2D(mask, vTextureCoord);
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(maskColor.r == 0.0 && maskColor.g == 0.0 && maskColor.b == 0.0)
    {
        adjusted.a = 0.0;
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, adjusted.a);
}`;class a_ extends Wa{constructor(t,e,s){super(K1,q1,{mask:t.castToBaseTexture(),fromChannel:e,toChannel:s})}}a_.CHANNEL_RED=0;a_.CHANNEL_GREEN=1;a_.CHANNEL_BLUE=2;a_.CHANNEL_ALPHA=3;/*!
 * @pixi/app - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/app is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Q1=function(){function r(){}return r.init=function(t){var e=this;Object.defineProperty(this,"resizeTo",{set:function(s){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=s,s&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get:function(){return this._resizeTo}}),this.queueResize=function(){e._resizeTo&&(e.cancelResize(),e._resizeId=requestAnimationFrame(function(){return e.resize()}))},this.cancelResize=function(){e._resizeId&&(cancelAnimationFrame(e._resizeId),e._resizeId=null)},this.resize=function(){if(e._resizeTo){e.cancelResize();var s,i;if(e._resizeTo===globalThis.window)s=globalThis.innerWidth,i=globalThis.innerHeight;else{var n=e._resizeTo,a=n.clientWidth,o=n.clientHeight;s=a,i=o}e.renderer.resize(s,i)}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null},r.destroy=function(){globalThis.removeEventListener("resize",this.queueResize),this.cancelResize(),this.cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null},r.extension=Re.Application,r}(),aR=function(){function r(t){var e=this;this.stage=new Tr,t=Object.assign({forceCanvas:!1},t),this.renderer=YL(t),r._plugins.forEach(function(s){s.init.call(e,t)})}return r.registerPlugin=function(t){Er("6.5.0","Application.registerPlugin() is deprecated, use extensions.add()"),hi.add({type:Re.Application,ref:t})},r.prototype.render=function(){this.renderer.render(this.stage)},Object.defineProperty(r.prototype,"view",{get:function(){return this.renderer.view},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"screen",{get:function(){return this.renderer.screen},enumerable:!1,configurable:!0}),r.prototype.destroy=function(t,e){var s=this,i=r._plugins.slice(0);i.reverse(),i.forEach(function(n){n.destroy.call(s)}),this.stage.destroy(e),this.stage=null,this.renderer.destroy(t),this.renderer=null},r._plugins=[],r}();hi.handleByList(Re.Application,aR._plugins);hi.add(Q1);const oR=class wd extends aR{constructor(t){super(t),wd.INSTANCE||(wd.INSTANCE=this)}static get instance(){return this.INSTANCE||null}};oR.INSTANCE=null;let Me=oR;const Xr=()=>{var r;return((r=Me.instance)==null?void 0:r.ticker)||null},Z1=()=>{var r;return((r=Xr())==null?void 0:r.FPS)||0},ft=()=>{var r;return((r=Xr())==null?void 0:r.lastTime)||0};/*!
 * @pixi/filter-alpha - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-alpha is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Gd=function(r,t){return Gd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},Gd(r,t)};function J1(r,t){Gd(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var $1=`varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform float uAlpha;

void main(void)
{
   gl_FragColor = texture2D(uSampler, vTextureCoord) * uAlpha;
}
`,Bd=function(r){J1(t,r);function t(e){e===void 0&&(e=1);var s=r.call(this,KL,$1,{uAlpha:1})||this;return s.alpha=e,s}return Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(Wa);class Nst extends Bd{}class tF extends Xt{}class zs extends Tr{}class eF extends Wa{}class vl extends B{}class bst extends it{}/*!
 * @pixi/sprite - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Hd=function(r,t){return Hd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},Hd(r,t)};function sF(r,t){Hd(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var po=new B,rF=new Uint16Array([0,1,2,0,2,3]),Kt=function(r){sF(t,r);function t(e){var s=r.call(this)||this;return s._anchor=new pa(s._onAnchorUpdate,s,e?e.defaultAnchor.x:0,e?e.defaultAnchor.y:0),s._texture=null,s._width=0,s._height=0,s._tint=null,s._tintRGB=null,s.tint=16777215,s.blendMode=tt.NORMAL,s._cachedTint=16777215,s.uvs=null,s.texture=e||_t.EMPTY,s.vertexData=new Float32Array(8),s.vertexTrimmedData=null,s._transformID=-1,s._textureID=-1,s._transformTrimmedID=-1,s._textureTrimmedID=-1,s.indices=rF,s.pluginName="batch",s.isSprite=!0,s._roundPixels=Z.ROUND_PIXELS,s}return t.prototype._onTextureUpdate=function(){this._textureID=-1,this._textureTrimmedID=-1,this._cachedTint=16777215,this._width&&(this.scale.x=Ea(this.scale.x)*this._width/this._texture.orig.width),this._height&&(this.scale.y=Ea(this.scale.y)*this._height/this._texture.orig.height)},t.prototype._onAnchorUpdate=function(){this._transformID=-1,this._transformTrimmedID=-1},t.prototype.calculateVertices=function(){var e=this._texture;if(!(this._transformID===this.transform._worldID&&this._textureID===e._updateID)){this._textureID!==e._updateID&&(this.uvs=this._texture._uvs.uvsFloat32),this._transformID=this.transform._worldID,this._textureID=e._updateID;var s=this.transform.worldTransform,i=s.a,n=s.b,a=s.c,o=s.d,h=s.tx,u=s.ty,c=this.vertexData,l=e.trim,_=e.orig,d=this._anchor,f=0,m=0,p=0,T=0;if(l?(m=l.x-d._x*_.width,f=m+l.width,T=l.y-d._y*_.height,p=T+l.height):(m=-d._x*_.width,f=m+_.width,T=-d._y*_.height,p=T+_.height),c[0]=i*m+a*T+h,c[1]=o*T+n*m+u,c[2]=i*f+a*T+h,c[3]=o*T+n*f+u,c[4]=i*f+a*p+h,c[5]=o*p+n*f+u,c[6]=i*m+a*p+h,c[7]=o*p+n*m+u,this._roundPixels)for(var v=Z.RESOLUTION,O=0;O<c.length;++O)c[O]=Math.round((c[O]*v|0)/v)}},t.prototype.calculateTrimmedVertices=function(){if(!this.vertexTrimmedData)this.vertexTrimmedData=new Float32Array(8);else if(this._transformTrimmedID===this.transform._worldID&&this._textureTrimmedID===this._texture._updateID)return;this._transformTrimmedID=this.transform._worldID,this._textureTrimmedID=this._texture._updateID;var e=this._texture,s=this.vertexTrimmedData,i=e.orig,n=this._anchor,a=this.transform.worldTransform,o=a.a,h=a.b,u=a.c,c=a.d,l=a.tx,_=a.ty,d=-n._x*i.width,f=d+i.width,m=-n._y*i.height,p=m+i.height;s[0]=o*d+u*m+l,s[1]=c*m+h*d+_,s[2]=o*f+u*m+l,s[3]=c*m+h*f+_,s[4]=o*f+u*p+l,s[5]=c*p+h*f+_,s[6]=o*d+u*p+l,s[7]=c*p+h*d+_},t.prototype._render=function(e){this.calculateVertices(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this)},t.prototype._calculateBounds=function(){var e=this._texture.trim,s=this._texture.orig;!e||e.width===s.width&&e.height===s.height?(this.calculateVertices(),this._bounds.addQuad(this.vertexData)):(this.calculateTrimmedVertices(),this._bounds.addQuad(this.vertexTrimmedData))},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._localBounds||(this._localBounds=new ch),this._localBounds.minX=this._texture.orig.width*-this._anchor._x,this._localBounds.minY=this._texture.orig.height*-this._anchor._y,this._localBounds.maxX=this._texture.orig.width*(1-this._anchor._x),this._localBounds.maxY=this._texture.orig.height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new it),e=this._localBoundsRect),this._localBounds.getRectangle(e)):r.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,po);var s=this._texture.orig.width,i=this._texture.orig.height,n=-s*this.anchor.x,a=0;return po.x>=n&&po.x<n+s&&(a=-i*this.anchor.y,po.y>=a&&po.y<a+i)},t.prototype.destroy=function(e){r.prototype.destroy.call(this,e),this._texture.off("update",this._onTextureUpdate,this),this._anchor=null;var s=typeof e=="boolean"?e:e&&e.texture;if(s){var i=typeof e=="boolean"?e:e&&e.baseTexture;this._texture.destroy(!!i)}this._texture=null},t.from=function(e,s){var i=e instanceof _t?e:_t.from(e,s);return new t(i)},Object.defineProperty(t.prototype,"roundPixels",{get:function(){return this._roundPixels},set:function(e){this._roundPixels!==e&&(this._transformID=-1),this._roundPixels=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){var s=Ea(this.scale.x)||1;this.scale.x=s*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){var s=Ea(this.scale.y)||1;this.scale.y=s*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"anchor",{get:function(){return this._anchor},set:function(e){this._anchor.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e,this._tintRGB=(e>>16)+(e&65280)+((e&255)<<16)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"texture",{get:function(){return this._texture},set:function(e){this._texture!==e&&(this._texture&&this._texture.off("update",this._onTextureUpdate,this),this._texture=e||_t.EMPTY,this._cachedTint=16777215,this._textureID=-1,this._textureTrimmedID=-1,e&&(e.baseTexture.valid?this._onTextureUpdate():e.once("update",this._onTextureUpdate,this)))},enumerable:!1,configurable:!0}),t}(Tr);class te extends Kt{}class hR extends _t{}class Pst extends Pe{}const iF=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,nF=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D lut;
uniform int channel;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(currentColor.a > 0.0)
    {
        if(channel == 0)
        {
            adjusted = texture2D(lut, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 1) {
            adjusted = texture2D(lut, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 2) {
            adjusted = texture2D(lut, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 3) {
            adjusted = texture2D(lut, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));
        }
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);
}`,Ph=class na extends eF{constructor(t,e=na.CHANNEL_RED){super(iF,nF),this._channel=e;let s=[];s=this.getLutForPalette(t),this._lut=tF.fromBuffer(Uint8Array.from(s),s.length/4,1,{mipmap:0,scaleMode:0}),this.uniforms.lut=this._lut,this.uniforms.channel=this._channel}getLutForPalette(t){const e=[];for(let s=0;s<t.length;s++)e[s*4+na.CHANNEL_RED]=t[s]>>16&255,e[s*4+na.CHANNEL_GREEN]=t[s]>>8&255,e[s*4+na.CHANNEL_BLUE]=t[s]&255,e[s*4+na.CHANNEL_ALPHA]=t[s]>>24&255;return e}get lut(){return this._lut}get channel(){return this._channel}};Ph.CHANNEL_RED=0;Ph.CHANNEL_GREEN=1;Ph.CHANNEL_BLUE=2;Ph.CHANNEL_ALPHA=3;let km=Ph;/*!
 * @pixi/interaction - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/interaction is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var jm=function(){function r(){this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0,this.global=new B,this.target=null,this.originalEvent=null,this.identifier=null,this.isPrimary=!1,this.button=0,this.buttons=0,this.width=0,this.height=0,this.tiltX=0,this.tiltY=0,this.pointerType=null,this.pressure=0,this.rotationAngle=0,this.twist=0,this.tangentialPressure=0}return Object.defineProperty(r.prototype,"pointerId",{get:function(){return this.identifier},enumerable:!1,configurable:!0}),r.prototype.getLocalPosition=function(t,e,s){return t.worldTransform.applyInverse(s||this.global,e)},r.prototype.copyEvent=function(t){"isPrimary"in t&&t.isPrimary&&(this.isPrimary=!0),this.button="button"in t&&t.button;var e="buttons"in t&&t.buttons;this.buttons=Number.isInteger(e)?e:"which"in t&&t.which,this.width="width"in t&&t.width,this.height="height"in t&&t.height,this.tiltX="tiltX"in t&&t.tiltX,this.tiltY="tiltY"in t&&t.tiltY,this.pointerType="pointerType"in t&&t.pointerType,this.pressure="pressure"in t&&t.pressure,this.rotationAngle="rotationAngle"in t&&t.rotationAngle,this.twist="twist"in t&&t.twist||0,this.tangentialPressure="tangentialPressure"in t&&t.tangentialPressure||0},r.prototype.reset=function(){this.isPrimary=!1},r}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Vd=function(r,t){return Vd=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},Vd(r,t)};function aF(r,t){Vd(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var oF=function(){function r(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.target=null,this.currentTarget=null,this.type=null,this.data=null}return r.prototype.stopPropagation=function(){this.stopped=!0,this.stopPropagationHint=!0,this.stopsPropagatingAt=this.currentTarget},r.prototype.reset=function(){this.stopped=!1,this.stopsPropagatingAt=null,this.stopPropagationHint=!1,this.currentTarget=null,this.target=null},r}(),Hc=function(){function r(t){this._pointerId=t,this._flags=r.FLAGS.NONE}return r.prototype._doSet=function(t,e){e?this._flags=this._flags|t:this._flags=this._flags&~t},Object.defineProperty(r.prototype,"pointerId",{get:function(){return this._pointerId},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"flags",{get:function(){return this._flags},set:function(t){this._flags=t},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"none",{get:function(){return this._flags===r.FLAGS.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"over",{get:function(){return(this._flags&r.FLAGS.OVER)!==0},set:function(t){this._doSet(r.FLAGS.OVER,t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"rightDown",{get:function(){return(this._flags&r.FLAGS.RIGHT_DOWN)!==0},set:function(t){this._doSet(r.FLAGS.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"leftDown",{get:function(){return(this._flags&r.FLAGS.LEFT_DOWN)!==0},set:function(t){this._doSet(r.FLAGS.LEFT_DOWN,t)},enumerable:!1,configurable:!0}),r.FLAGS=Object.freeze({NONE:0,OVER:1,LEFT_DOWN:2,RIGHT_DOWN:4}),r}(),hF=function(){function r(){this._tempPoint=new B}return r.prototype.recursiveFindHit=function(t,e,s,i,n){var a;if(!e||!e.visible)return!1;var o=t.data.global;n=e.interactive||n;var h=!1,u=n,c=!0;if(e.hitArea)i&&(e.worldTransform.applyInverse(o,this._tempPoint),e.hitArea.contains(this._tempPoint.x,this._tempPoint.y)?h=!0:(i=!1,c=!1)),u=!1;else if(e._mask&&i){var l=e._mask.isMaskData?e._mask.maskObject:e._mask;l&&!(!((a=l.containsPoint)===null||a===void 0)&&a.call(l,o))&&(i=!1)}if(c&&e.interactiveChildren&&e.children)for(var _=e.children,d=_.length-1;d>=0;d--){var f=_[d],m=this.recursiveFindHit(t,f,s,i,u);if(m){if(!f.parent)continue;u=!1,m&&(t.target&&(i=!1),h=!0)}}return n&&(i&&!t.target&&!e.hitArea&&e.containsPoint&&e.containsPoint(o)&&(h=!0),e.interactive&&(h&&!t.target&&(t.target=e),s&&s(t,e,!!h))),h},r.prototype.findHit=function(t,e,s,i){this.recursiveFindHit(t,e,s,i,!1)},r}(),uF={interactive:!1,interactiveChildren:!0,hitArea:null,get buttonMode(){return this.cursor==="pointer"},set buttonMode(r){r?this.cursor="pointer":this.cursor==="pointer"&&(this.cursor=null)},cursor:null,get trackedPointers(){return this._trackedPointers===void 0&&(this._trackedPointers={}),this._trackedPointers},_trackedPointers:void 0};fe.mixin(uF);var bu=1,Pu={target:null,data:{global:null}},lF=function(r){aF(t,r);function t(e,s){var i=r.call(this)||this;return s=s||{},i.renderer=e,i.autoPreventDefault=s.autoPreventDefault!==void 0?s.autoPreventDefault:!0,i.interactionFrequency=s.interactionFrequency||10,i.mouse=new jm,i.mouse.identifier=bu,i.mouse.global.set(-999999),i.activeInteractionData={},i.activeInteractionData[bu]=i.mouse,i.interactionDataPool=[],i.eventData=new oF,i.interactionDOMElement=null,i.moveWhenInside=!1,i.eventsAdded=!1,i.tickerAdded=!1,i.mouseOverRenderer=!("PointerEvent"in globalThis),i.supportsTouchEvents="ontouchstart"in globalThis,i.supportsPointerEvents=!!globalThis.PointerEvent,i.onPointerUp=i.onPointerUp.bind(i),i.processPointerUp=i.processPointerUp.bind(i),i.onPointerCancel=i.onPointerCancel.bind(i),i.processPointerCancel=i.processPointerCancel.bind(i),i.onPointerDown=i.onPointerDown.bind(i),i.processPointerDown=i.processPointerDown.bind(i),i.onPointerMove=i.onPointerMove.bind(i),i.processPointerMove=i.processPointerMove.bind(i),i.onPointerOut=i.onPointerOut.bind(i),i.processPointerOverOut=i.processPointerOverOut.bind(i),i.onPointerOver=i.onPointerOver.bind(i),i.cursorStyles={default:"inherit",pointer:"pointer"},i.currentCursorMode=null,i.cursor=null,i.resolution=1,i.delayedEvents=[],i.search=new hF,i._tempDisplayObject=new nR,i._eventListenerOptions={capture:!0,passive:!1},i._useSystemTicker=s.useSystemTicker!==void 0?s.useSystemTicker:!0,i.setTargetElement(i.renderer.view,i.renderer.resolution),i}return Object.defineProperty(t.prototype,"useSystemTicker",{get:function(){return this._useSystemTicker},set:function(e){this._useSystemTicker=e,e?this.addTickerListener():this.removeTickerListener()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastObjectRendered",{get:function(){return this.renderer._lastObjectRendered||this._tempDisplayObject},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(e,s){return Pu.target=null,Pu.data.global=e,s||(s=this.lastObjectRendered),this.processInteractive(Pu,s,null,!0),Pu.target},t.prototype.setTargetElement=function(e,s){s===void 0&&(s=1),this.removeTickerListener(),this.removeEvents(),this.interactionDOMElement=e,this.resolution=s,this.addEvents(),this.addTickerListener()},t.prototype.addTickerListener=function(){this.tickerAdded||!this.interactionDOMElement||!this._useSystemTicker||(hr.system.add(this.tickerUpdate,this,Fa.INTERACTION),this.tickerAdded=!0)},t.prototype.removeTickerListener=function(){this.tickerAdded&&(hr.system.remove(this.tickerUpdate,this),this.tickerAdded=!1)},t.prototype.addEvents=function(){if(!(this.eventsAdded||!this.interactionDOMElement)){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="none",e.msTouchAction="none"):this.supportsPointerEvents&&(e.touchAction="none"),this.supportsPointerEvents?(globalThis.document.addEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.addEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.addEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.addEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.addEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.addEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.addEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.eventsAdded=!0}},t.prototype.removeEvents=function(){if(!(!this.eventsAdded||!this.interactionDOMElement)){var e=this.interactionDOMElement.style;globalThis.navigator.msPointerEnabled?(e.msContentZooming="",e.msTouchAction=""):this.supportsPointerEvents&&(e.touchAction=""),this.supportsPointerEvents?(globalThis.document.removeEventListener("pointermove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerdown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerleave",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("pointerover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("pointercancel",this.onPointerCancel,this._eventListenerOptions),globalThis.removeEventListener("pointerup",this.onPointerUp,this._eventListenerOptions)):(globalThis.document.removeEventListener("mousemove",this.onPointerMove,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mousedown",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseout",this.onPointerOut,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("mouseover",this.onPointerOver,this._eventListenerOptions),globalThis.removeEventListener("mouseup",this.onPointerUp,this._eventListenerOptions)),this.supportsTouchEvents&&(this.interactionDOMElement.removeEventListener("touchstart",this.onPointerDown,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchcancel",this.onPointerCancel,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchend",this.onPointerUp,this._eventListenerOptions),this.interactionDOMElement.removeEventListener("touchmove",this.onPointerMove,this._eventListenerOptions)),this.interactionDOMElement=null,this.eventsAdded=!1}},t.prototype.tickerUpdate=function(e){this._deltaTime+=e,!(this._deltaTime<this.interactionFrequency)&&(this._deltaTime=0,this.update())},t.prototype.update=function(){if(this.interactionDOMElement){if(this._didMove){this._didMove=!1;return}this.cursor=null;for(var e in this.activeInteractionData)if(this.activeInteractionData.hasOwnProperty(e)){var s=this.activeInteractionData[e];if(s.originalEvent&&s.pointerType!=="touch"){var i=this.configureInteractionEventForDOMEvent(this.eventData,s.originalEvent,s);this.processInteractive(i,this.lastObjectRendered,this.processPointerOverOut,!0)}}this.setCursorMode(this.cursor)}},t.prototype.setCursorMode=function(e){e=e||"default";var s=!0;if(globalThis.OffscreenCanvas&&this.interactionDOMElement instanceof OffscreenCanvas&&(s=!1),this.currentCursorMode!==e){this.currentCursorMode=e;var i=this.cursorStyles[e];if(i)switch(typeof i){case"string":s&&(this.interactionDOMElement.style.cursor=i);break;case"function":i(e);break;case"object":s&&Object.assign(this.interactionDOMElement.style,i);break}else s&&typeof e=="string"&&!Object.prototype.hasOwnProperty.call(this.cursorStyles,e)&&(this.interactionDOMElement.style.cursor=e)}},t.prototype.dispatchEvent=function(e,s,i){(!i.stopPropagationHint||e===i.stopsPropagatingAt)&&(i.currentTarget=e,i.type=s,e.emit(s,i),e[s]&&e[s](i))},t.prototype.delayDispatchEvent=function(e,s,i){this.delayedEvents.push({displayObject:e,eventString:s,eventData:i})},t.prototype.mapPositionToPoint=function(e,s,i){var n;this.interactionDOMElement.parentElement?n=this.interactionDOMElement.getBoundingClientRect():n={x:0,y:0,width:this.interactionDOMElement.width,height:this.interactionDOMElement.height,left:0,top:0};var a=1/this.resolution;e.x=(s-n.left)*(this.interactionDOMElement.width/n.width)*a,e.y=(i-n.top)*(this.interactionDOMElement.height/n.height)*a},t.prototype.processInteractive=function(e,s,i,n){var a=this.search.findHit(e,s,i,n),o=this.delayedEvents;if(!o.length)return a;e.stopPropagationHint=!1;var h=o.length;this.delayedEvents=[];for(var u=0;u<h;u++){var c=o[u],l=c.displayObject,_=c.eventString,d=c.eventData;d.stopsPropagatingAt===l&&(d.stopPropagationHint=!0),this.dispatchEvent(l,_,d)}return a},t.prototype.onPointerDown=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var s=this.normalizeToPointerData(e);if(this.autoPreventDefault&&s[0].isNormalized){var i=e.cancelable||!("cancelable"in e);i&&e.preventDefault()}for(var n=s.length,a=0;a<n;a++){var o=s[a],h=this.getInteractionDataForPointerId(o),u=this.configureInteractionEventForDOMEvent(this.eventData,o,h);if(u.data.originalEvent=e,this.processInteractive(u,this.lastObjectRendered,this.processPointerDown,!0),this.emit("pointerdown",u),o.pointerType==="touch")this.emit("touchstart",u);else if(o.pointerType==="mouse"||o.pointerType==="pen"){var c=o.button===2;this.emit(c?"rightdown":"mousedown",this.eventData)}}}},t.prototype.processPointerDown=function(e,s,i){var n=e.data,a=e.data.identifier;if(i){if(s.trackedPointers[a]||(s.trackedPointers[a]=new Hc(a)),this.dispatchEvent(s,"pointerdown",e),n.pointerType==="touch")this.dispatchEvent(s,"touchstart",e);else if(n.pointerType==="mouse"||n.pointerType==="pen"){var o=n.button===2;o?s.trackedPointers[a].rightDown=!0:s.trackedPointers[a].leftDown=!0,this.dispatchEvent(s,o?"rightdown":"mousedown",e)}}},t.prototype.onPointerComplete=function(e,s,i){var n=this.normalizeToPointerData(e),a=n.length,o=e.target;e.composedPath&&e.composedPath().length>0&&(o=e.composedPath()[0]);for(var h=o!==this.interactionDOMElement?"outside":"",u=0;u<a;u++){var c=n[u],l=this.getInteractionDataForPointerId(c),_=this.configureInteractionEventForDOMEvent(this.eventData,c,l);if(_.data.originalEvent=e,this.processInteractive(_,this.lastObjectRendered,i,s||!h),this.emit(s?"pointercancel":"pointerup"+h,_),c.pointerType==="mouse"||c.pointerType==="pen"){var d=c.button===2;this.emit(d?"rightup"+h:"mouseup"+h,_)}else c.pointerType==="touch"&&(this.emit(s?"touchcancel":"touchend"+h,_),this.releaseInteractionDataForPointerId(c.pointerId))}},t.prototype.onPointerCancel=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!0,this.processPointerCancel)},t.prototype.processPointerCancel=function(e,s){var i=e.data,n=e.data.identifier;s.trackedPointers[n]!==void 0&&(delete s.trackedPointers[n],this.dispatchEvent(s,"pointercancel",e),i.pointerType==="touch"&&this.dispatchEvent(s,"touchcancel",e))},t.prototype.onPointerUp=function(e){this.supportsTouchEvents&&e.pointerType==="touch"||this.onPointerComplete(e,!1,this.processPointerUp)},t.prototype.processPointerUp=function(e,s,i){var n=e.data,a=e.data.identifier,o=s.trackedPointers[a],h=n.pointerType==="touch",u=n.pointerType==="mouse"||n.pointerType==="pen",c=!1;if(u){var l=n.button===2,_=Hc.FLAGS,d=l?_.RIGHT_DOWN:_.LEFT_DOWN,f=o!==void 0&&o.flags&d;i?(this.dispatchEvent(s,l?"rightup":"mouseup",e),f&&(this.dispatchEvent(s,l?"rightclick":"click",e),c=!0)):f&&this.dispatchEvent(s,l?"rightupoutside":"mouseupoutside",e),o&&(l?o.rightDown=!1:o.leftDown=!1)}i?(this.dispatchEvent(s,"pointerup",e),h&&this.dispatchEvent(s,"touchend",e),o&&((!u||c)&&this.dispatchEvent(s,"pointertap",e),h&&(this.dispatchEvent(s,"tap",e),o.over=!1))):o&&(this.dispatchEvent(s,"pointerupoutside",e),h&&this.dispatchEvent(s,"touchendoutside",e)),o&&o.none&&delete s.trackedPointers[a]},t.prototype.onPointerMove=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var s=this.normalizeToPointerData(e);(s[0].pointerType==="mouse"||s[0].pointerType==="pen")&&(this._didMove=!0,this.cursor=null);for(var i=s.length,n=0;n<i;n++){var a=s[n],o=this.getInteractionDataForPointerId(a),h=this.configureInteractionEventForDOMEvent(this.eventData,a,o);h.data.originalEvent=e,this.processInteractive(h,this.lastObjectRendered,this.processPointerMove,!0),this.emit("pointermove",h),a.pointerType==="touch"&&this.emit("touchmove",h),(a.pointerType==="mouse"||a.pointerType==="pen")&&this.emit("mousemove",h)}s[0].pointerType==="mouse"&&this.setCursorMode(this.cursor)}},t.prototype.processPointerMove=function(e,s,i){var n=e.data,a=n.pointerType==="touch",o=n.pointerType==="mouse"||n.pointerType==="pen";o&&this.processPointerOverOut(e,s,i),(!this.moveWhenInside||i)&&(this.dispatchEvent(s,"pointermove",e),a&&this.dispatchEvent(s,"touchmove",e),o&&this.dispatchEvent(s,"mousemove",e))},t.prototype.onPointerOut=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var s=this.normalizeToPointerData(e),i=s[0];i.pointerType==="mouse"&&(this.mouseOverRenderer=!1,this.setCursorMode(null));var n=this.getInteractionDataForPointerId(i),a=this.configureInteractionEventForDOMEvent(this.eventData,i,n);a.data.originalEvent=i,this.processInteractive(a,this.lastObjectRendered,this.processPointerOverOut,!1),this.emit("pointerout",a),i.pointerType==="mouse"||i.pointerType==="pen"?this.emit("mouseout",a):this.releaseInteractionDataForPointerId(n.identifier)}},t.prototype.processPointerOverOut=function(e,s,i){var n=e.data,a=e.data.identifier,o=n.pointerType==="mouse"||n.pointerType==="pen",h=s.trackedPointers[a];i&&!h&&(h=s.trackedPointers[a]=new Hc(a)),h!==void 0&&(i&&this.mouseOverRenderer?(h.over||(h.over=!0,this.delayDispatchEvent(s,"pointerover",e),o&&this.delayDispatchEvent(s,"mouseover",e)),o&&this.cursor===null&&(this.cursor=s.cursor)):h.over&&(h.over=!1,this.dispatchEvent(s,"pointerout",this.eventData),o&&this.dispatchEvent(s,"mouseout",e),h.none&&delete s.trackedPointers[a]))},t.prototype.onPointerOver=function(e){if(!(this.supportsTouchEvents&&e.pointerType==="touch")){var s=this.normalizeToPointerData(e),i=s[0],n=this.getInteractionDataForPointerId(i),a=this.configureInteractionEventForDOMEvent(this.eventData,i,n);a.data.originalEvent=i,i.pointerType==="mouse"&&(this.mouseOverRenderer=!0),this.emit("pointerover",a),(i.pointerType==="mouse"||i.pointerType==="pen")&&this.emit("mouseover",a)}},t.prototype.getInteractionDataForPointerId=function(e){var s=e.pointerId,i;return s===bu||e.pointerType==="mouse"?i=this.mouse:this.activeInteractionData[s]?i=this.activeInteractionData[s]:(i=this.interactionDataPool.pop()||new jm,i.identifier=s,this.activeInteractionData[s]=i),i.copyEvent(e),i},t.prototype.releaseInteractionDataForPointerId=function(e){var s=this.activeInteractionData[e];s&&(delete this.activeInteractionData[e],s.reset(),this.interactionDataPool.push(s))},t.prototype.configureInteractionEventForDOMEvent=function(e,s,i){return e.data=i,this.mapPositionToPoint(i.global,s.clientX,s.clientY),s.pointerType==="touch"&&(s.globalX=i.global.x,s.globalY=i.global.y),i.originalEvent=s,e.reset(),e},t.prototype.normalizeToPointerData=function(e){var s=[];if(this.supportsTouchEvents&&e instanceof TouchEvent)for(var i=0,n=e.changedTouches.length;i<n;i++){var a=e.changedTouches[i];typeof a.button>"u"&&(a.button=e.touches.length?1:0),typeof a.buttons>"u"&&(a.buttons=e.touches.length?1:0),typeof a.isPrimary>"u"&&(a.isPrimary=e.touches.length===1&&e.type==="touchstart"),typeof a.width>"u"&&(a.width=a.radiusX||1),typeof a.height>"u"&&(a.height=a.radiusY||1),typeof a.tiltX>"u"&&(a.tiltX=0),typeof a.tiltY>"u"&&(a.tiltY=0),typeof a.pointerType>"u"&&(a.pointerType="touch"),typeof a.pointerId>"u"&&(a.pointerId=a.identifier||0),typeof a.pressure>"u"&&(a.pressure=a.force||.5),typeof a.twist>"u"&&(a.twist=0),typeof a.tangentialPressure>"u"&&(a.tangentialPressure=0),typeof a.layerX>"u"&&(a.layerX=a.offsetX=a.clientX),typeof a.layerY>"u"&&(a.layerY=a.offsetY=a.clientY),a.isNormalized=!0,s.push(a)}else if(!globalThis.MouseEvent||e instanceof MouseEvent&&(!this.supportsPointerEvents||!(e instanceof globalThis.PointerEvent))){var o=e;typeof o.isPrimary>"u"&&(o.isPrimary=!0),typeof o.width>"u"&&(o.width=1),typeof o.height>"u"&&(o.height=1),typeof o.tiltX>"u"&&(o.tiltX=0),typeof o.tiltY>"u"&&(o.tiltY=0),typeof o.pointerType>"u"&&(o.pointerType="mouse"),typeof o.pointerId>"u"&&(o.pointerId=bu),typeof o.pressure>"u"&&(o.pressure=.5),typeof o.twist>"u"&&(o.twist=0),typeof o.tangentialPressure>"u"&&(o.tangentialPressure=0),o.isNormalized=!0,s.push(o)}else s.push(e);return s},t.prototype.destroy=function(){this.removeEvents(),this.removeTickerListener(),this.removeAllListeners(),this.renderer=null,this.mouse=null,this.eventData=null,this.interactionDOMElement=null,this.onPointerDown=null,this.processPointerDown=null,this.onPointerUp=null,this.processPointerUp=null,this.onPointerCancel=null,this.processPointerCancel=null,this.onPointerMove=null,this.processPointerMove=null,this.onPointerOut=null,this.processPointerOverOut=null,this.onPointerOver=null,this.search=null},t.extension={name:"interaction",type:[Re.RendererPlugin,Re.CanvasRendererPlugin]},t}(Ah);const uR=class lR{constructor(){this.RENDER_TEXTURE_POOL=new Map,this.RENDER_TEXTURE_CACHE=[]}clearCache(){this.RENDER_TEXTURE_POOL.forEach(t=>t==null?void 0:t.destroy(!0)),this.RENDER_TEXTURE_POOL.clear(),this.RENDER_TEXTURE_CACHE=[]}clearRenderTexture(t){return t?this.writeToRenderTexture(new Kt(_t.EMPTY),t):null}getTextureIdentifier(t,e,s){return`${s??lR.DEFAULT_PLANE_ID}:${t}:${e}`}createRenderTexture(t,e,s=null){if(t<0||e<0)return null;if(!s){const n=we.create({width:t,height:e});return this.RENDER_TEXTURE_CACHE.push(n),n}s=this.getTextureIdentifier(t,e,s);let i=this.RENDER_TEXTURE_POOL.get(s);return i||(i=we.create({width:t,height:e}),this.RENDER_TEXTURE_CACHE.push(i),this.RENDER_TEXTURE_POOL.set(s,i)),i}createAndFillRenderTexture(t,e,s=null,i=16777215){if(t<0||e<0)return null;const n=this.createRenderTexture(t,e,s);return this.clearAndFillRenderTexture(n,i)}createAndWriteRenderTexture(t,e,s,i=null,n=null){if(t<0||e<0)return null;const a=this.createRenderTexture(t,e,i);return this.writeToRenderTexture(s,a,!0,n)}clearAndFillRenderTexture(t,e=16777215){if(!t)return null;const s=new Kt(_t.WHITE);return s.tint=e,s.width=t.width,s.height=t.height,this.writeToRenderTexture(s,t)}writeToRenderTexture(t,e,s=!0,i=null){return!t||!e?null:(this.getRenderer().render(t,{renderTexture:e,clear:s,transform:i}),e)}getPixels(t,e=null){return this.getExtractor().pixels(t)}getRenderer(){return Me.instance.renderer}getExtractor(){return this.getRenderer().plugins.extract}};uR.DEFAULT_PLANE_ID="DEFAULT";let _F=uR;class Qt{static generateTexture(t,e=null,s=null,i=1){return t?(s===null&&(s=Z.SCALE_MODE),this.getRenderer().generateTexture(t,{scaleMode:s,resolution:i,region:e})):null}static generateTextureFromImage(t){return t?_t.from(t):null}static generateImage(t){return t?this.getExtractor().image(t):null}static generateImageUrl(t){return t?this.getExtractor().base64(t):null}static generateCanvas(t){return t?this.getExtractor().canvas(t):null}static clearRenderTexture(t){return t?this.writeToRenderTexture(new Kt(_t.EMPTY),t):null}static createRenderTexture(t,e){return t<0||e<0?null:we.create({width:t,height:e})}static createAndFillRenderTexture(t,e,s=16777215){if(t<0||e<0)return null;const i=this.createRenderTexture(t,e);return this.clearAndFillRenderTexture(i,s)}static createAndWriteRenderTexture(t,e,s,i=null){if(t<0||e<0)return null;const n=this.createRenderTexture(t,e);return this.writeToRenderTexture(s,n,!0,i)}static clearAndFillRenderTexture(t,e=16777215){if(!t)return null;const s=new Kt(_t.WHITE);return s.tint=e,s.width=t.width,s.height=t.height,this.writeToRenderTexture(s,t)}static writeToRenderTexture(t,e,s=!0,i=null){return!t||!e?null:(this.getRenderer().render(t,{renderTexture:e,clear:s,transform:i}),e)}static getPixels(t,e=null){return this.getExtractor().pixels(t)}static getRenderer(){return Me.instance.renderer}static getExtractor(){return this.getRenderer().plugins.extract}}const _R=class So{static createAsset(t,e,s,i,n,a=!1,o=!1,h=!1){const u=So.GRAPHIC_POOL.length?So.GRAPHIC_POOL.pop():new So;return u._name=t,u._source=e||null,s?(u._texture=s,u._initialized=!1):(u._texture=null,u._initialized=!0),u._usesPalette=h,u._x=i,u._y=n,u._flipH=a,u._flipV=o,u._rectangle=null,u}recycle(){this._texture=null,So.GRAPHIC_POOL.push(this)}initialize(){this._initialized||!this._texture||(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}getImageUrl(){return Qt.generateImageUrl(new Kt(this._texture))}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new it(0,0,this.width,this.height)),this._rectangle}};_R.GRAPHIC_POOL=[];let cF=_R;class dF{constructor(t,e,s){for(this._palette=t;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=e,this._secondaryColor=s}dispose(){}applyPalette(t){var a,o;const e=Qt.createAndWriteRenderTexture(t.width,t.height,new Kt(t)),s=Qt.getPixels(e);for(let h=0;h<s.length;h+=4){let u=this._palette[s[h+1]];u===void 0&&(u=[0,0,0]),s[h]=u[0],s[h+1]=u[1],s[h+2]=u[2]}const i=(a=e.baseTexture._glTextures[1])==null?void 0:a.texture,n=(o=Me.instance.renderer)==null?void 0:o.gl;return n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,e.width,e.height,0,n.RGBA,n.UNSIGNED_BYTE,s),n.bindTexture(n.TEXTURE_2D,null),e}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}const cR=class kd{constructor(t,e){if(!t)throw new Error("invalid_collection");this._name=t.name,this._baseTexture=e&&e.baseTexture||null,this._data=t,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],e&&this.addLibraryAsset(e.textures),this.define(t)}static removeFileExtension(t){return t.substring(0,t.lastIndexOf("."))||t}dispose(){if(this._palettes){for(const t of this._palettes.values())t.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const t of this._assets.values())t.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=ft()}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=ft(),this.disposePaletteAssets(!1))}define(t){const e=t.assets,s=t.palettes;e&&this.defineAssets(e),s&&this.definePalettes(s)}defineAssets(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=-s.x||0,n=-s.y||0;let a=!1;const o=!1,h=s.usesPalette||!1;let u=s.source||"";s.flipH&&u.length&&(a=!0),u.length||(u=e);const c=this.getLibraryAsset(u);if(!c)continue;let l=this.createAsset(e,u,c,a,o,i,n,h);if(!l){const _=this.getAsset(e);_&&_.name!==_.source&&(l=this.replaceAsset(e,u,c,a,o,i,n,h))}}}definePalettes(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id.toString();if(this._palettes.get(i))continue;let n=16777215,a=16777215,o=s.color1;o&&o.length>0&&(n=parseInt(o,16)),o=s.color2,o&&o.length>0&&(a=parseInt(o,16)),this._palettes.set(i,new dF(s.rgb,n,a))}}createAsset(t,e,s,i,n,a,o,h){if(this._assets.get(t))return!1;const u=cF.createAsset(t,e,s,a,o,i,n,h);return this._assets.set(t,u),!0}replaceAsset(t,e,s,i,n,a,o,h){const u=this._assets.get(t);return u&&(this._assets.delete(t),u.recycle()),this.createAsset(t,e,s,i,n,a,o,h)}getAsset(t){if(!t)return null;const e=this._assets.get(t);return e||null}getAssetWithPalette(t,e){const s=t+"@"+e;let i=this.getAsset(s);if(!i){if(i=this.getAsset(t),!i||!i.usesPalette)return i;const n=this.getPalette(e);if(n){const a=n.applyPalette(i.texture);a&&(this._paletteAssetNames.push(s),this.createAsset(s,i.source+"@"+e,a,i.flipH,i.flipV,i.x,i.y,!1),i=this.getAsset(s))}}return i}getTexture(t){return this._textures.get(t)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(t){const e=this.getPalette(t);return e?[e.primaryColor,e.secondaryColor]:null}getPalette(t){if(!t)return null;const e=this._palettes.get(t);return e||null}addAsset(t,e,s,i=0,n=0,a=!1,o=!1){if(!t||!e)return!1;const h=this.getLibraryAsset(t);return h?s?(h.baseTexture=e.baseTexture,h.frame=e.frame,h.trim=e.trim,h.updateUvs(),!0):!1:(this._textures.set(t,e),this.createAsset(t,t,e,a,o,i,n,!1))}disposeAsset(t){const e=this._assets.get(t);if(!e)return;this._assets.delete(t);const s=this.getLibraryAsset(e.source);s&&(this._textures.delete(e.source),s.destroy(!0)),e.recycle()}getLibraryAsset(t){if(!t)return null;t=this._name+"_"+t;const e=this._textures.get(t);return e||null}addLibraryAsset(t){if(t)for(const e in t){const s=t[e];s&&this._textures.set(kd.removeFileExtension(e),s)}}disposePaletteAssets(t=!0){if(this._paletteAssetNames&&(t||this._paletteAssetNames.length>kd.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const e of this._paletteAssetNames)this.disposeAsset(e);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get baseTexture(){return this._baseTexture}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}};cR.PALETTE_ASSET_DISPOSE_THRESHOLD=10;let dR=cR;const jd=class{constructor(){this._textures=new Map,this._collections=new Map}getTexture(t){if(!t)return null;const e=this._textures.get(t);return e||null}setTexture(t,e){!t||!e||this._textures.set(t,e)}getAsset(t){if(!t)return null;for(const e of this._collections.values()){if(!e)continue;const s=e.getAsset(t);if(s)return s}return null}getCollection(t){if(!t)return null;const e=this._collections.get(t);return e||null}createCollection(t,e){if(!t)return null;const s=new dR(t,e);if(s){for(const[i,n]of s.textures.entries())this.setTexture(i,n);this._collections.set(s.name,s)}return s}async downloadAsset(t){return await this.downloadAssets([t])}async downloadAssets(t){if(!t||!t.length)return Promise.resolve(!0);try{for(const e of t){const s=await fetch(e);if(s.status!==200)continue;let i="application/octet-stream";switch(s.headers.has("Content-Type")&&(i=s.headers.get("Content-Type")),i){case"application/octet-stream":{const n=await s.arrayBuffer(),a=new iR(n);await this.processAsset(a.baseTexture,a.jsonFile);break}case"image/png":case"image/jpeg":case"image/gif":{const n=await s.arrayBuffer(),a=TT(n),o=Xt.from(`data:${i};base64,${a}`),h=async()=>{const u=new _t(o);this.setTexture(e,u)};o.valid?await h():await new Promise((u,c)=>{o.once("update",async()=>(await h(),u()))});break}}}return Promise.resolve(!0)}catch(e){return Y.error(e),Promise.resolve(!1)}}async processAsset(t,e){const s=e.spritesheet;if(!t||!s||!Object.keys(s).length){this.createCollection(e,null);return}const i=async()=>{const n=new bg(t,s);await n.parse(),this.createCollection(e,n)};t.valid?await i():await new Promise((n,a)=>{t.once("update",async()=>(await i(),n()))})}get collections(){return this._collections}};jd._INSTANCE=new jd;let fF=jd;const Cs=()=>fF._INSTANCE;class gF{constructor(t,e,s){this.name=t,this.textures=e,this.durations=s}}class Hg{}Hg.UNKNOWN=0;Hg.BROWSER=1;class o_{}o_.UNKNOWN=0;o_.FLASH=1;o_.HTML5=2;class ys{}ys.CONNECTION_OPENED="open";ys.CONNECTION_CLOSED="close";ys.CONNECTION_ERROR="error";ys.CONNECTION_MESSAGE="message";class at{static parseConfiguration(t,e=!1){if(!t)return!1;try{const s=new RegExp(/\${(.*?)}/g);for(const i in t){let n=t[i];typeof n=="string"&&(n=this.interpolate(n,s)),this._definitions.has(i)?e&&this.setValue(i,n):this.setValue(i,n)}return!0}catch(s){return Y.error(s.stack),!1}}static interpolate(t,e=null){e||(e=new RegExp(/\${(.*?)}/g));const s=t.match(e);if(s&&s.length)for(const i of s){const n=this._definitions.get(this.removeInterpolateKey(i));n&&(t=t.replace(i,n))}return t}static removeInterpolateKey(t){return t.replace("${","").replace("}","")}static getValue(t,e=null){let s=this._definitions.get(t);if(s===void 0){if(this._missingKeys.indexOf(t)>=0)return e;this._missingKeys.push(t),Y.warn(`Missing configuration key: ${t}`),s=e}return s}static setValue(t,e){const s=t.split(".");let i=this._config;for(let n=0;n<s.length;n++){const a=s[n].toString();if(n!==s.length-1){i[a]||(i[a]={}),i=i[a];continue}i[a]=e}this._definitions.set(t,e)}static get definitions(){return this._definitions}}at._definitions=new Map;at._config={};at._missingKeys=[];const X=class nn{static getExpressionTimeout(t){switch(t=parseInt(t),t){case 1:return 5e3;case 2:return 1400;case 3:return 2e3;case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:return 1500;case 9:return 1500;case 10:return 1500;default:return 0}}static getExpressionId(t){return nn.EXPRESSION_MAP.indexOf(t)}static getExpression(t){return t>nn.EXPRESSION_MAP.length?null:nn.EXPRESSION_MAP[t]}static getGestureId(t){return nn.GESTURE_MAP.indexOf(t)}static getGesture(t){return t>nn.GESTURE_MAP.length?null:nn.GESTURE_MAP[t]}static idToAvatarActionState(t){return t==="Lay"?"lay":t==="Float"?"float":t==="Swim"?"swim":t==="Sit"?"sit":t==="Respect"?"respect":t==="Wave"?"wave":t==="Idle"?"idle":t==="Dance"?"dance":t==="UseItem"?"usei":t==="CarryItem"?"cri":t==="Talk"?"talk":t==="Sleep"?"Sleep":t==="Move"?"mv":"std"}};X.CARRY_OBJECT="cri";X.DANCE="dance";X.EFFECT="fx";X.EXPRESSION="expression";X.EXPRESSION_BLOW_A_KISS="blow";X.EXPRESSION_CRY="cry";X.EXPRESSION_IDLE="idle";X.EXPRESSION_LAUGH="laugh";X.EXPRESSION_RESPECT="respect";X.EXPRESSION_RIDE_JUMP="ridejump";X.EXPRESSION_SNOWBOARD_OLLIE="sbollie";X.EXPRESSION_SNOWBORD_360="sb360";X.EXPRESSION_WAVE="wave";X.GESTURE="gest";X.GESTURE_AGGRAVATED="agr";X.GESTURE_SAD="sad";X.GESTURE_SMILE="sml";X.GESTURE_SURPRISED="srp";X.GUIDE_STATUS="guide";X.MUTED="muted";X.PET_GESTURE_BLINK="eyb";X.PET_GESTURE_CRAZY="crz";X.PET_GESTURE_JOY="joy";X.PET_GESTURE_MISERABLE="mis";X.PET_GESTURE_PUZZLED="puz";X.PET_GESTURE_TONGUE="tng";X.PLAYING_GAME="playing_game";X.POSTURE="posture";X.POSTURE_FLOAT="float";X.POSTURE_LAY="lay";X.POSTURE_SIT="sit";X.POSTURE_STAND="std";X.POSTURE_SWIM="swim";X.POSTURE_WALK="mv";X.SIGN="sign";X.SLEEP="sleep";X.SNOWWAR_DIE_BACK="swdieback";X.SNOWWAR_DIE_FRONT="swdiefront";X.SNOWWAR_PICK="swpick";X.SNOWWAR_RUN="swrun";X.SNOWWAR_THROW="swthrow";X.TALK="talk";X.BLINK="blink";X.TYPING="typing";X.USE_OBJECT="usei";X.VOTE="vote";X.GESTURE_MAP=["",X.GESTURE_SMILE,X.GESTURE_AGGRAVATED,X.GESTURE_SURPRISED,X.GESTURE_SAD,X.PET_GESTURE_JOY,X.PET_GESTURE_CRAZY,X.PET_GESTURE_TONGUE,X.PET_GESTURE_BLINK,X.PET_GESTURE_MISERABLE,X.PET_GESTURE_PUZZLED];X.EXPRESSION_MAP=["",X.EXPRESSION_WAVE,X.EXPRESSION_BLOW_A_KISS,X.EXPRESSION_LAUGH,X.EXPRESSION_CRY,X.EXPRESSION_IDLE,X.DANCE,X.EXPRESSION_RESPECT,X.EXPRESSION_SNOWBOARD_OLLIE,X.EXPRESSION_SNOWBORD_360,X.EXPRESSION_RIDE_JUMP];let q=X;class _r{}_r.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0];_r.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1];_r.MIN_DIRECTION=0;_r.MAX_DIRECTION=7;class Gn{}Gn.GENERIC="hd";Gn.HEAD="head";Gn.TORSO="torso";Gn.LEGS="legs";Gn.HOTLOOKS="hotlooks";Gn.WARDROBE="wardrobe";Gn.EFFECTS="effects";const gt=class{};gt.BODY="bd";gt.SHOES="sh";gt.LEGS="lg";gt.CHEST="ch";gt.WAIST_ACCESSORY="wa";gt.CHEST_ACCESSORY="ca";gt.HEAD="hd";gt.HAIR="hr";gt.FACE_ACCESSORY="fa";gt.EYE_ACCESSORY="ea";gt.HEAD_ACCESSORY="ha";gt.HEAD_ACCESSORY_EXTRA="he";gt.COAT_CHEST="cc";gt.CHEST_PRINT="cp";gt.LEFT_HAND_ITEM="li";gt.LEFT_HAND="lh";gt.LEFT_SLEEVE="ls";gt.RIGHT_HAND="rh";gt.RIGHT_SLEEVE="rs";gt.FACE="fc";gt.EYES="ey";gt.HAIR_BIG="hrb";gt.RIGHT_HAND_ITEM="ri";gt.LEFT_COAT_SLEEVE="lc";gt.RIGHT_COAT_SLEEVE="rc";gt.FIGURE_SETS=[gt.SHOES,gt.LEGS,gt.CHEST,gt.WAIST_ACCESSORY,gt.CHEST_ACCESSORY,gt.HEAD,gt.HAIR,gt.FACE_ACCESSORY,gt.EYE_ACCESSORY,gt.HEAD_ACCESSORY,gt.HEAD_ACCESSORY_EXTRA,gt.COAT_CHEST,gt.CHEST_PRINT];let As=gt;class ks{}ks.NONE=0;ks.GUIDE=1;ks.REQUESTER=2;class cr{}cr.LARGE="h";cr.SMALL="sh";class Je{}Je.FULL="full";Je.HEAD="head";Je.BODY="body";class js{}js.VERTICAL="vertical";js.SITTING="sitting";js.HORIZONTAL="horizontal";js.SWIM="swim";js.SNOWWARS_HORIZONTAL="swhorizontal";class Rt{}Rt.DOG=0;Rt.CAT=1;Rt.CROCODILE=2;Rt.TERRIER=3;Rt.BEAR=4;Rt.PIG=5;Rt.LION=6;Rt.RHINO=7;Rt.SPIDER=8;Rt.TURTLE=9;Rt.CHICKEN=10;Rt.FROG=11;Rt.DRAGON=12;Rt.MONSTER=13;Rt.MONKEY=14;Rt.HORSE=15;Rt.MONSTERPLANT=16;Rt.BUNNY=17;Rt.BUNNYEVIL=18;Rt.BUNNYDEPRESSED=19;Rt.BUNNYLOVE=20;Rt.PIGEONGOOD=21;Rt.PIGEONEVIL=22;Rt.DEMONMONKEY=23;Rt.BABYBEAR=24;Rt.BABYTERRIER=25;Rt.GNOME=26;Rt.LEPRECHAUN=27;Rt.KITTENBABY=28;Rt.PUPPYBABY=29;Rt.PIGLETNBABY=30;Rt.HALOOMPA=31;Rt.FOOLS=32;Rt.PTEROSAUR=33;Rt.VELOCIRAPTOR=34;class Bn{}Bn.NONE=0;Bn.HEART=1;Bn.SMILE=2;Bn.BOBBA=3;Bn.RELATIONSHIP_TYPES=[0,1,2,3];Bn.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"];class oi{}oi.HOTEL_VIEW="hotel_view";oi.HOME_ROOM="home_room";oi.NAVIGATOR="navigator";oi.CATALOG="catalog";oi.INVENTORY="inventory";oi.ME_MENU="me_menu";oi.FRIEND_LIST="friendlist";class Hn{}Hn.LOVE_LOCK=0;Hn.CARVE_A_TREE=1;Hn.FRIENDS_PORTRAIT=2;Hn.WILD_WEST_WANTED=3;Hn.HABBOWEEN=4;class Vg{}Vg.CATALOG="catalog";Vg.INVENTORY="inventory";class I{}I.OBJECT_ROOM_ID="object_room_id";I.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value";I.TILE_CURSOR_HEIGHT="tile_cursor_height";I.FIGURE="figure";I.GENDER="gender";I.OWN_USER="own_user";I.FIGURE_CAN_STAND_UP="figure_can_stand_up";I.FIGURE_VERTICAL_OFFSET="figure_vertical_offset";I.FIGURE_TALK="figure_talk";I.FIGURE_DANCE="figure_dance";I.FIGURE_SLEEP="figure_sleep";I.FIGURE_BLINK="figure_blink";I.FIGURE_EFFECT="figure_effect";I.FIGURE_CARRY_OBJECT="figure_carry_object";I.FIGURE_USE_OBJECT="figure_use_object";I.FIGURE_GESTURE="figure_gesture";I.FIGURE_POSTURE="figure_posture";I.FIGURE_POSTURE_PARAMETER="figure_posture_parameter";I.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable";I.FIGURE_HIGHLIGHT="figure_highlight";I.FURNITURE_PURCHASER_NAME="furniture_purchaser_name";I.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure";I.STD="std";I.FIGURE_SIGN="figure_sign";I.FIGURE_FLAT_CONTROL="figure_flat_control";I.FIGURE_IS_TYPING="figure_is_typing";I.FIGURE_IS_MUTED="figure_is_muted";I.FIGURE_GAINED_EXPERIENCE="figure_gained_experience";I.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp";I.FIGURE_NUMBER_VALUE="figure_number_value";I.FIGURE_IS_PLAYING_GAME="figure_is_playing_game";I.FIGURE_GUIDE_STATUS="figure_guide_status";I.FIGURE_EXPRESSION="figure_expression";I.HEAD_DIRECTION="head_direction";I.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables";I.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index";I.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable";I.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation";I.FURNITURE_DATA_FORMAT="furniture_data_format";I.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number";I.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size";I.FURNITURE_CRACKABLE_STATE="furniture_crackable_state";I.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits";I.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target";I.FURNITURE_CREDIT_VALUE="furniture_credit_value";I.FURNITURE_DATA="furniture_data";I.FURNITURE_ITEMDATA="furniture_itemdata";I.FURNITURE_COLOR="furniture_color";I.FURNITURE_LIFT_AMOUNT="furniure_lift_amount";I.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id";I.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name";I.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1";I.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2";I.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time";I.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled";I.FURNITURE_SIZE_X="furniture_size_x";I.FURNITURE_SIZE_Y="furniture_size_y";I.FURNITURE_SIZE_Z="furniture_size_z";I.FURNITURE_CENTER_X="furniture_center_x";I.FURNITURE_CENTER_Y="furniture_center_y";I.FURNITURE_CENTER_Z="furniture_center_z";I.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions";I.FURNITURE_AD_URL="furniture_ad_url";I.FURNITURE_TYPE_ID="furniture_type_id";I.FURNITURE_EXTRAS="furniture_extras";I.FURNITURE_EXPIRY_TIME="furniture_expiry_time";I.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp";I.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object";I.FURNITURE_IS_STICKIE="furniture_is_stickie";I.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status";I.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url";I.FURNITURE_BRANDING_URL="furniture_branding_url";I.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x";I.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y";I.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z";I.FURNITURE_BRANDING_IS_ANIMATED="furniture_branding_is_animated";I.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status";I.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name";I.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state";I.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier";I.FURNITURE_USAGE_POLICY="furniture_usage_policy";I.FURNITURE_OWNER_ID="furniture_owner_id";I.FURNITURE_OWNER_NAME="furniture_owner_name";I.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue";I.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation";I.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness";I.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask";I.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type";I.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height";I.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result";I.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count";I.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed";I.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name";I.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender";I.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure";I.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type";I.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type";I.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count";I.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_";I.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_";I.FURNITURE_INTERNAL_LINK="furniture_internal_link";I.FURNITURE_CLOTHING_BOY="furniture_clothing_boy";I.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl";I.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data";I.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data";I.PET_PALETTE_INDEX="pet_palette_index";I.PET_COLOR="pet_color";I.PET_HEAD_ONLY="pet_head_only";I.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids";I.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids";I.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids";I.PET_IS_RIDING="pet_is_riding";I.PET_TYPE="pet_type";I.PET_ALLOWED_DIRECTIONS="pet_allowed_directions";I.RACE="race";I.ROOM_MAP_DATA="room_map_data";I.ROOM_PLANE_MASK_XML="room_plane_mask_xml";I.ROOM_FLOOR_TYPE="room_floor_type";I.ROOM_WALL_TYPE="room_wall_type";I.ROOM_LANDSCAPE_TYPE="room_landscape_type";I.ROOM_WALL_THICKNESS="room_wall_thickness";I.ROOM_FLOOR_THICKNESS="room_floor_thickness";I.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time";I.ROOM_FLOOR_VISIBILITY="room_floor_visibility";I.ROOM_WALL_VISIBILITY="room_wall_visibility";I.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility";I.ROOM_DOOR_X="room_door_x";I.ROOM_DOOR_Y="room_door_y";I.ROOM_DOOR_Z="room_door_z";I.ROOM_DOOR_DIR="room_door_dir";I.ROOM_BACKGROUND_COLOR="room_background_color";I.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only";I.ROOM_RANDOM_SEED="room_random_seed";I.ROOM_WORLD_TYPE="room_world_type";I.ROOM_SELECTED_X="room_selected_x";I.ROOM_SELECTED_Y="room_selected_y";I.ROOM_SELECTED_Z="room_selected_z";I.ROOM_SELECTED_PLANE="room_selected_plane";I.IMAGE_QUERY_SCALE="image_query_scale";I.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type";I.SESSION_URL_PREFIX="session_url_prefix";I.SESSION_CURRENT_USER_ID="session_current_user_id";class fR{}fR.UNIQUE_SET=256;class zi{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(t){(this._flags&fR.UNIQUE_SET)>0&&(this._uniqueNumber=t.readInt(),this._uniqueSeries=t.readInt())}initializeFromRoomObjectModel(t){this._uniqueNumber=t.getValue(I.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=t.getValue(I.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(t){t&&(t.setValue(I.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),t.setValue(I.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(t){return!1}get state(){const t=parseInt(this.getLegacyString());return isNaN(t)?0:t}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(t){this._uniqueNumber=t}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(t){this._uniqueSeries=t}get rarityLevel(){return-1}get flags(){return this._flags}set flags(t){this._flags=t}}class es{}es.LEGACY_KEY=0;es.MAP_KEY=1;es.STRING_KEY=2;es.VOTE_KEY=3;es.EMPTY_KEY=4;es.NUMBER_KEY=5;es.HIGHSCORE_KEY=6;es.CRACKABLE_KEY=7;const gR=class ER extends zi{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(t){t&&(this._state=t.readString(),this._hits=t.readInt(),this._target=t.readInt(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._state=t.getValue(I.FURNITURE_CRACKABLE_STATE),this._hits=t.getValue(I.FURNITURE_CRACKABLE_HITS),this._target=t.getValue(I.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(I.FURNITURE_DATA_FORMAT,ER.FORMAT_KEY),t.setValue(I.FURNITURE_CRACKABLE_STATE,this._state),t.setValue(I.FURNITURE_CRACKABLE_HITS,this._hits),t.setValue(I.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(t){return!0}get hits(){return this._hits}get target(){return this._target}};gR.FORMAT_KEY=es.CRACKABLE_KEY;let zm=gR;const pR=class mR extends zi{parseWrapper(t){t&&(this._state="",super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(I.FURNITURE_DATA_FORMAT,mR.FORMAT_KEY)}getLegacyString(){return this._state}compare(t){return super.compare(t)}};pR.FORMAT_KEY=es.EMPTY_KEY;let Ym=pR;class Wm{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(t){this._score=t}get users(){return this._users}set users(t){this._users=t}addUsername(t){this._users.push(t)}}const IR=class TR extends zi{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(t){if(!t)return;this._state=t.readString(),this._scoreType=t.readInt(),this._clearType=t.readInt();let e=t.readInt();for(;e>0;){const s=new Wm;s.score=t.readInt();let i=t.readInt();for(;i>0;)s.addUsername(t.readString()),i--;this._entries.push(s),e--}super.parseWrapper(t)}initializeFromRoomObjectModel(t){this._scoreType=t.getValue(I.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=t.getValue(I.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const e=t.getValue(I.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let s=0;for(;s<e;){const i=new Wm;i.score=t.getValue(I.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+s),i.users=t.getValue(I.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+s),this._entries.push(i),s++}super.initializeFromRoomObjectModel(t)}writeRoomObjectModel(t){if(super.writeRoomObjectModel(t),t.setValue(I.FURNITURE_DATA_FORMAT,TR.FORMAT_KEY),t.setValue(I.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),t.setValue(I.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){t.setValue(I.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let e=0;for(;e<this._entries.length;){const s=this._entries[e];t.setValue(I.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+e,s.score),t.setValue(I.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+e,s.users),e++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}};IR.FORMAT_KEY=es.HIGHSCORE_KEY;let Xm=IR;const RR=class OR extends zi{constructor(){super(),this._data=""}parseWrapper(t){t&&(this._data=t.readString(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(I.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(I.FURNITURE_DATA_FORMAT,OR.FORMAT_KEY),t.setValue(I.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(t){return this._data===t.getLegacyString()}setString(t){this._data=t}};RR.FORMAT_KEY=es.LEGACY_KEY;let Rs=RR;const h_=class ju extends zi{constructor(){super(),this._data={}}parseWrapper(t){if(!t)return;this._data={};const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data[t.readString()]=t.readString();super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(I.FURNITURE_DATA)||{}}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(I.FURNITURE_DATA_FORMAT,ju.FORMAT_KEY),t.setValue(I.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const t=this._data[ju.STATE];return t??""}compare(t){return!1}getValue(t){return this._data[t]}get rarityLevel(){if(!this._data)return-1;const t=this._data[ju.RARITY];return t==null?-1:parseInt(t)}get data(){return this._data}};h_.FORMAT_KEY=es.MAP_KEY;h_.STATE="state";h_.RARITY="rarity";let dh=h_;const kg=class zu extends zi{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readInt());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(I.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(I.FURNITURE_DATA_FORMAT,zu.FORMAT_KEY),t.setValue(I.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[zu.STATE].toString()}compare(t){if(!(t instanceof zu))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==t.getValue(e))return!1}e++}return!0}getValue(t){if(!this._data||!this._data.length)return-1;const e=this._data[t];return e??-1}};kg.FORMAT_KEY=es.NUMBER_KEY;kg.STATE=0;let zd=kg;const jg=class Yu extends zi{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readString());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(I.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(I.FURNITURE_DATA_FORMAT,Yu.FORMAT_KEY),t.setValue(I.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[Yu.STATE]}compare(t){if(!(t instanceof Yu))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==t.getValue(e))return!1}e++}return!0}getValue(t){return this._data[t]||""}setValue(t){this._data=t}};jg.FORMAT_KEY=es.STRING_KEY;jg.STATE=0;let Al=jg;const vR=class AR extends zi{constructor(){super(),this._state="",this._result=0}parseWrapper(t){t&&(this._state=t.readString(),this._result=t.readInt(),super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(I.FURNITURE_DATA_FORMAT,AR.FORMAT_KEY);const e={};e.S=this._state,e.R=this._result.toString(),t.setValue(I.FURNITURE_DATA,e)}getLegacyString(){return this._state}compare(t){return!0}setString(t){this._state=t}get result(){return this._result}};vR.FORMAT_KEY=es.VOTE_KEY;let Yd=vR;class Pi{static getData(t){let e=null;switch(t&255){case zm.FORMAT_KEY:e=new zm;break;case Ym.FORMAT_KEY:e=new Ym;break;case Xm.FORMAT_KEY:e=new Xm;break;case Rs.FORMAT_KEY:e=new Rs;break;case dh.FORMAT_KEY:e=new dh;break;case zd.FORMAT_KEY:e=new zd;break;case Al.FORMAT_KEY:e=new Al;break;case Yd.FORMAT_KEY:e=new Yd;break}return e?(e.flags=t&65280,e):null}}class L{}L.MINIMUM=-2;L.ROOM=0;L.FLOOR=10;L.WALL=20;L.UNIT=100;L.CURSOR=200;class U{}U.FURNITURE_BASIC="furniture_basic";U.FURNITURE_MULTISTATE="furniture_multistate";U.FURNITURE_MULTIHEIGHT="furniture_multiheight";U.FURNITURE_RANDOMSTATE="furniture_randomstate";U.FURNITURE_PLACEHOLDER="furniture_placeholder";U.FURNITURE_CREDIT="furniture_credit";U.FURNITURE_STICKIE="furniture_stickie";U.FURNITURE_PRESENT="furniture_present";U.FURNITURE_TROPHY="furniture_trophy";U.FURNITURE_ECOTRON_BOX="furniture_ecotron_box";U.FURNITURE_DICE="furniture_dice";U.FURNITURE_HOCKEY_SCORE="furniture_hockey_score";U.FURNITURE_HABBOWHEEL="furniture_habbowheel";U.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door";U.FURNITURE_PLANET_SYSTEM="furniture_planet_system";U.FURNITURE_WINDOW="furniture_window";U.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem";U.FURNITURE_ROOMDIMMER="furniture_roomdimmer";U.FURNITURE_SOUND_MACHINE="furniture_sound_machine";U.FURNITURE_JUKEBOX="furniture_jukebox";U.FURNITURE_CRACKABLE="furniture_crackable";U.FURNITURE_PUSHABLE="furniture_pushable";U.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change";U.FURNITURE_COUNTER_CLOCK="furniture_counter_clock";U.FURNITURE_SCORE="furniture_score";U.FURNITURE_ES="furniture_es";U.FURNITURE_FIREWORKS="furniture_fireworks";U.FURNITURE_SONG_DISK="furniture_song_disk";U.FURNITURE_BB="furniture_bb";U.FURNITURE_BG="furniture_bg";U.FURNITURE_WELCOME_GIFT="furniture_welcome_gift";U.FURNITURE_FLOOR_HOLE="furniture_floor_hole";U.FURNITURE_MANNEQUIN="furniture_mannequin";U.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized";U.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal";U.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization";U.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock";U.FURNITURE_VOTE_COUNTER="furniture_vote_counter";U.FURNITURE_VOTE_MAJORITY="furniture_vote_majority";U.FURNITURE_SOUNDBLOCK="furniture_soundblock";U.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport";U.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed";U.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing";U.FURNITURE_BACKGROUND_COLOR="furniture_background_color";U.FURNITURE_MYSTERYBOX="furniture_mysterybox";U.FURNITURE_EFFECTBOX="furniture_effectbox";U.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy";U.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution";U.FURNITURE_LOVELOCK="furniture_lovelock";U.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted";U.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock";U.FURNITURE_BADGE_DISPLAY="furniture_badge_display";U.FURNITURE_HIGH_SCORE="furniture_high_score";U.FURNITURE_INTERNAL_LINK="furniture_internal_link";U.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height";U.FURNITURE_YOUTUBE="furniture_youtube";U.FURNITURE_RENTABLE_SPACE="furniture_rentable_space";U.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on";U.FURNITURE_VIMEO="furniture_vimeo";U.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link";U.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link";U.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo";U.ROOM="room";U.USER="user";U.BOT="bot";U.RENTABLE_BOT="rentable_bot";U.PET="pet";U.TILE_CURSOR="tile_cursor";U.SELECTION_ARROW="selection_arrow";U.GAME_SNOWBALL="game_snowball";U.GAME_SNOWSPLASH="game_snowsplash";class ut{}ut.OBJECT_UNDEFINED="OBJECT_UNDEFINED";ut.OBJECT_MOVE="OBJECT_MOVE";ut.OBJECT_PLACE="OBJECT_PLACE";ut.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE";ut.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE";ut.OBJECT_MOVE_TO="OBJECT_MOVE_TO";ut.OBJECT_PLACE_TO="OBJECT_PLACE_TO";ut.OBJECT_PICKUP="OBJECT_PICKUP";ut.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT";ut.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET";ut.OBJECT_EJECT="OBJECT_EJECT";ut.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";class Ys{}Ys.USER=1;Ys.PET=2;Ys.BOT=3;Ys.RENTABLE_BOT=4;const Vn=class an{static getTypeNumber(t){return an.AVATAR_TYPES[t]}static getTypeString(t){for(const e in an.AVATAR_TYPES)if(e&&an.AVATAR_TYPES[e]===t)return e;return null}static getRealType(t){switch(t){case an.BOT:case an.RENTABLE_BOT:return an.USER;default:return t}}};Vn.USER="user";Vn.PET="pet";Vn.BOT="bot";Vn.RENTABLE_BOT="rentable_bot";Vn.MONSTER_PLANT="monsterplant";Vn.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};let Dt=Vn;class F{}F.FURNITURE_STATIC="furniture_static";F.FURNITURE_ANIMATED="furniture_animated";F.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated";F.FURNITURE_POSTER="furniture_poster";F.FURNITURE_EXTERNAL_IMAGE="furniture_external_image";F.FURNITURE_HABBOWHEEL="furniture_habbowheel";F.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer";F.FURNITURE_BOTTLE="furniture_bottle";F.FURNITURE_PLANET_SYSTEM="furniture_planet_system";F.FURNITURE_QUEUE_TILE="furniture_queue_tile";F.FURNITURE_PARTY_BEAMER="furniture_party_beamer";F.FURNITURE_CUBOID="furniture_cuboid";F.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped";F.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks";F.FURNITURE_COUNTER_CLOCK="furniture_counter_clock";F.FURNITURE_WATER_AREA="furniture_water_area";F.FURNITURE_SCORE_BOARD="furniture_score_board";F.FURNITURE_FIREWORKS="furniture_fireworks";F.FURNITURE_BB="furniture_bb";F.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb";F.FURNITURE_BG="furniture_bg";F.FURNITURE_STICKIE="furniture_stickie";F.FURNITURE_MANNEQUIN="furniture_mannequin";F.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized";F.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge";F.FURNITURE_VOTE_COUNTER="furniture_vote_counter";F.FURNITURE_VOTE_MAJORITY="furniture_vote_majority";F.FURNITURE_SOUNDBLOCK="furniture_soundblock";F.FURNITURE_BADGE_DISPLAY="furniture_badge_display";F.FURNITURE_YOUTUBE="furniture_youtube";F.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder";F.ROOM="room";F.USER="user";F.PET_ANIMATED="pet_animated";F.BOT="bot";F.RENTABLE_BOT="rentable_bot";F.TILE_CURSOR="tile_cursor";class Kr{constructor(t,e,s,i=null){this._id=t,this._location=e,this._targetLocation=s,this._movementType=i}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}}Kr.MOVE="mv";Kr.SLIDE="sld";class zg{}zg.KICKED_OUT_OF_ROOM=4008;zg.STRIP_LOCKED_FOR_TRADING=-13001;class ba{}ba.OLD_IDENTITY=0;ba.NEW_IDENTITY=1;ba.REAL_NOOB=2;class Ts{}Ts.NONE=0;Ts.GUEST=1;Ts.GUILD_MEMBER=2;Ts.GUILD_ADMIN=3;Ts.ROOM_OWNER=4;Ts.MODERATOR=5;const u_=class Wu{static getLocalizationKey(t){switch(t){case Wu.FREE_TRADING:return"${trading.mode.free}";case Wu.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case Wu.NO_TRADING:return"${trading.mode.not.allowed}"}return""}};u_.NO_TRADING=0;u_.ROOM_CONTROLLER_REQUIRED=1;u_.FREE_TRADING=2;let EF=u_;class qs{}qs.SUPER_USER=9;qs.ADMINISTRATOR=8;qs.COMMUNITY=7;qs.PLAYER_SUPPORT=6;qs.MODERATOR=5;qs.EMPLOYEE=4;qs.BUS_PARTNER=3;qs.PARTNER=2;qs.CELEBRITY=1;qs.NONE=0;var Tn=(r=>(r.FLOOR="S",r.WALL="I",r.EFFECT="E",r.BADGE="B",r.ROBOT="R",r.HABBO_CLUB="H",r.PET="P",r))(Tn||{});class bs{}bs.MATCH_ALL_PIXELS=-1;bs.MATCH_OPAQUE_PIXELS=128;bs.MATCH_NOTHING=256;class as{}as.DEFAULT=1;as.ROOM_PLANE=2;as.AVATAR=3;as.AVATAR_OWN=4;class SR{}class S{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s,this._length=NaN}static sum(t,e){return!t||!e?null:new S(t.x+e.x,t.y+e.y,t.z+e.z)}static dif(t,e){return!t||!e?null:new S(t.x-e.x,t.y-e.y,t.z-e.z)}static product(t,e){return t?new S(t.x*e,t.y*e,t.z*e):null}static dotProduct(t,e){return!t||!e?0:t.x*e.x+t.y*e.y+t.z*e.z}static crossProduct(t,e){return!t||!e?null:new S(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static scalarProjection(t,e){if(!t||!e)return-1;const s=e.length;return s>0?(t.x*e.x+t.y*e.y+t.z*e.z)/s:-1}static cosAngle(t,e){if(!t||!e)return 0;const s=t.length*e.length;return s?S.dotProduct(t,e)/s:0}static isEqual(t,e){return!(!t||!e||t.x!==e.x||t.y!==e.y||t.z!==e.z)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(t){t&&(this._x+=t.x,this._y+=t.y,this._z+=t.z,this._length=NaN)}subtract(t){t&&(this._x-=t.x,this._y-=t.y,this._z-=t.z,this._length=NaN)}multiply(t){this._x*=t,this._y*=t,this._z*=t,this._length=NaN}divide(t){t&&(this._x/=t,this._y/=t,this._z/=t,this._length=NaN)}assign(t){t&&(this._x=t.x,this._y=t.y,this._z=t.z,this._length=NaN)}get x(){return this._x}set x(t){this._x=t,this._length=NaN}get y(){return this._y}set y(t){this._y=t,this._length=NaN}get z(){return this._z}set z(t){this._z=t,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}class k{}k.MOUSE_CLICK="click";k.DOUBLE_CLICK="double_click";k.MOUSE_MOVE="mousemove";k.MOUSE_DOWN="mousedown";k.MOUSE_DOWN_LONG="mousedown_long";k.MOUSE_UP="mouseup";k.ROLL_OVER="mouseover";k.ROLL_OUT="mouseout";k.RIGHT_CLICK="contextmenu";class Dh{}Dh.TOUCH_START="touchstart";Dh.TOUCH_MOVE="touchmove";Dh.TOUCH_CANCEL="touchcancel";Dh.TOUCH_END="touchend";Dh.TOUCH_LONG="touchlong";const Ye=class{constructor(t){this._ordinal=t}get ordinal(){return this._ordinal}equals(t){return t&&t._ordinal==this._ordinal}};Ye.NONE=new Ye(0);Ye.WAVE=new Ye(1);Ye.BLOW=new Ye(2);Ye.LAUGH=new Ye(3);Ye.CRY=new Ye(4);Ye.IDLE=new Ye(5);Ye.JUMP=new Ye(6);Ye.RESPECT=new Ye(7);let xst=Ye;class We{}We.DUMMY="DUMMY";We.FRIEND_FURNITURE="FRIEND_FURNITURE";We.MONSTERPLANT_SEED="MONSTERPLANT_SEED";We.MYSTERY_BOX="MYSTERY_BOX";We.EFFECT_BOX="EFFECT_BOX";We.MYSTERY_TROPHY="MYSTERY_TROPHY";We.RANDOM_TELEPORT="RANDOM_TELEPORT";We.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING";We.GENERIC_USABLE="GENERIC_USABLE";class st{}st.CHAT_WIDGET="RWE_CHAT_WIDGET";st.INFOSTAND="RWE_INFOSTAND";st.ME_MENU="RWE_ME_MENU";st.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET";st.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER";st.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET";st.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET";st.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET";st.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET";st.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET";st.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET";st.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET";st.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET";st.DOORBELL="RWE_DOORBELL";st.LOADINGBAR="RWE_LOADINGBAR";st.ROOM_QUEUE="RWE_ROOM_QUEUE";st.ROOM_POLL="RWE_ROOM_POLL";st.ROOM_VOTE="RWE_ROOM_VOTE";st.USER_CHOOSER="RWE_USER_CHOOSER";st.FURNI_CHOOSER="RWE_FURNI_CHOOSER";st.ROOM_DIMMER="RWE_ROOM_DIMMER";st.FRIEND_REQUEST="RWE_FRIEND_REQUEST";st.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE";st.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING";st.USER_NOTIFICATION="RWE_USER_NOTIFICATION";st.FRIENDS_BAR="RWE_FRIENDS_BAR";st.PURSE_WIDGET="RWE_PURSE_WIDGET";st.AVATAR_INFO="RWE_AVATAR_INFO";st.WELCOME_GIFT="RWE_WELCOME_GIFT";st.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET";st.EFFECTS="RWE_EFFECTS";st.MANNEQUIN="RWE_MANNEQUIN";st.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU";st.LOCATION_WIDGET="RWE_LOCATION_WIDGET";st.CAMERA="RWE_CAMERA";st.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA";st.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR";st.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION";st.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING";st.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM";st.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING";st.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY";st.INTERNAL_LINK="RWE_INTERNAL_LINK";st.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT";st.YOUTUBE="RWE_YOUTUBE";st.RENTABLESPACE="RWE_RENTABLESPACE";st.VIMEO="RWE_VIMEO";st.ROOM_TOOLS="RWE_ROOM_TOOLS";st.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE";st.WORD_QUIZZ="RWE_WORD_QUIZZ";st.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE";st.ROOM_LINK="RWE_ROOM_LINK";st.CRAFTING="RWE_CRAFTING";st.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS";class Ce{}Ce.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM";Ce.JUKEBOX="RWEIEP_JUKEBOX";Ce.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT";Ce.SONGDISK="RWEIEP_SONGDISK";Ce.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI";Ce.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS";Ce.USABLE="RWEIEP_USABLE";class Yg{}Yg.NOBODY=0;Yg.CONTROLLER=1;Yg.EVERYBODY=2;class Si{}Si.NORMAL=0;Si.GENERIC=1;Si.BOT=2;class ds{constructor(){this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}class vs extends ds{constructor(){super(),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(!s){this._listeners.set(t,[e]);return}s.push(e)}removeEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(!(!s||!s.length)){for(const[i,n]of s.entries())if(!(!n||n!==e)){s.splice(i,1),s.length||this._listeners.delete(t);return}}}dispatchEvent(t){return t?(Y.events("Dispatched Event",t.type),this.processEvent(t),!0):!1}processEvent(t){const e=this._listeners.get(t.type);if(!e||!e.length)return;const s=[];for(const i of e)i&&s.push(i);for(;s.length;){const i=s.shift();try{i(t)}catch(n){Y.error(n.stack);return}}}removeAllListeners(){this._listeners.clear()}}class Rr extends ds{constructor(){super(),this._events=new vs,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class pF{constructor(t){this._value=t}get value(){return this._value}}class mF{constructor(t,e){this._header=t,this._buffer=e}readBytes(t){return this._buffer?this._buffer.readBytes(t):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return this.readByte()===1}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const t=this.readShort();return this._buffer.readBytes(t).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class IF{constructor(t){this._value=t}get value(){return this._value}}class TF{encode(t,e){const s=new tm;s.writeShort(t);for(const n of e){let a=typeof n;switch(a==="object"&&(n===null?a="null":n instanceof pF?a="byte":n instanceof IF?a="short":n instanceof ArrayBuffer&&(a="arraybuffer")),a){case"undefined":case"null":s.writeShort(0);break;case"byte":s.writeByte(n.value);break;case"short":s.writeShort(n.value);break;case"number":s.writeInt(n);break;case"boolean":s.writeByte(n?1:0);break;case"string":n?s.writeString(n,!0):s.writeShort(0);break;case"arraybuffer":s.writeBytes(n);break}}const i=s.getBuffer();return i?new tm().writeInt(i.byteLength).writeBytes(i):null}decode(t){if(!t||!t.dataBuffer||!t.dataBuffer.byteLength)return null;const e=[];for(;t.dataBuffer.byteLength&&!(t.dataBuffer.byteLength<4);){const s=new s_(t.dataBuffer),i=s.readInt();if(i>t.dataBuffer.byteLength-4)break;const n=s.readBytes(i);e.push(new mF(n.readShort(),n)),t.dataBuffer=t.dataBuffer.slice(i+4)}return e}}class R{constructor(t,e){this._callBack=t,this._parserClass=e,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(t){this._parser=t}get connection(){return this._connection}set connection(t){this._connection=t}}class It{constructor(t){this._type=t}get type(){return this._type}}class Te extends It{constructor(t,e,s){super(t),this._connection=e,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}}Te.CONNECTION_OPENED="SCE_OPEN";Te.CONNECTION_CLOSED="SCE_CLOSED";Te.CONNECTION_ERROR="SCE_ERROR";Te.CONNECTION_MESSAGE="SCE_MESSAGE";class Ta extends It{constructor(t,e){super(t),this._library=e}get library(){return this._library}}Ta.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";class l_{}l_.AVATAR_RENDER_READY="AVATAR_RENDER_READY";class Ra extends It{constructor(t,e){super(t),this._library=e}get library(){return this._library}}Ra.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";class Wd extends It{constructor(t){super(t)}}Wd.INITIALIZED="RCWM_INITIALIZED";class ke extends It{constructor(t,e){super(t),this._connection=e}get connection(){return this._connection}}ke.CONNECTION_ESTABLISHED="NCE_ESTABLISHED";ke.CONNECTION_CLOSED="NCE_CLOSED";ke.CONNECTION_ERROR="NCE_ERROR";ke.CONNECTION_HANDSHAKING="NCE_HANDSHAKING";ke.CONNECTION_HANDSHAKED="NCE_HANDSHAKED";ke.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED";ke.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";class Oa extends It{constructor(t){super(t)}}Oa.LOADED="NLE_LOADED";Oa.FAILED="NLE_FAILED";const yR=class Xd extends It{constructor(){super(Xd.SETTINGS_UPDATED)}clone(){const t=new Xd;return t._volumeSystem=this._volumeSystem,t._volumeFurni=this._volumeFurni,t._volumeTrax=this._volumeTrax,t._oldChat=this._oldChat,t._roomInvites=this._roomInvites,t._cameraFollow=this._cameraFollow,t._flags=this._flags,t._chatType=this._chatType,t}get volumeSystem(){return this._volumeSystem}set volumeSystem(t){this._volumeSystem=t}get volumeFurni(){return this._volumeFurni}set volumeFurni(t){this._volumeFurni=t}get volumeTrax(){return this._volumeTrax}set volumeTrax(t){this._volumeTrax=t}get oldChat(){return this._oldChat}set oldChat(t){this._oldChat=t}get roomInvites(){return this._roomInvites}set roomInvites(t){this._roomInvites=t}get cameraFollow(){return this._cameraFollow}set cameraFollow(t){this._cameraFollow=t}get flags(){return this._flags}set flags(t){this._flags=t}get chatType(){return this._chatType}set chatType(t){this._chatType=t}};yR.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";let Qo=yR;class Xu extends It{constructor(t,e){super(t),this._sampleCode=e}get sampleCode(){return this._sampleCode}}Xu.PLAY_SOUND="NSOE_PLAY_SOUND";class Wg extends It{constructor(t){super(t)}get iconId(){return this._iconId}set iconId(t){this._iconId=t}get iconName(){return this._iconName}set iconName(t){this._iconName=t}}Wg.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK";Wg.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";const MR=class CR extends Wg{constructor(t,e,s){super(CR.ANIMATE_ICON),this._image=t,this._x=e,this._y=s}get image(){return this._image}get x(){return this._x}get y(){return this._y}};MR.ANIMATE_ICON="NTAIE_ANIMATE_ICON";let Km=MR;class At extends It{constructor(t,e){super(t),this._roomId=e}get roomId(){return this._roomId}}At.INITIALIZED="REE_INITIALIZED";At.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED";At.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED";At.NORMAL_MODE="REE_NORMAL_MODE";At.GAME_MODE="REE_GAME_MODE";At.ROOM_ZOOMED="REE_ROOM_ZOOMED";At.DISPOSED="REE_DISPOSED";const NR=class bR extends At{constructor(t,e,s,i){super(bR.ROOM_COLOR,t),this._color=e,this._brightness=s,this._bgOnly=i}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}};NR.ROOM_COLOR="REE_ROOM_COLOR";let RF=NR;class dr extends It{constructor(t,e){super(t),this._contentType=e}get contentType(){return this._contentType}}dr.RCLE_SUCCESS="RCLE_SUCCESS";dr.RCLE_FAILURE="RCLE_FAILURE";dr.RCLE_CANCEL="RCLE_CANCEL";const PR=class DR extends At{constructor(t,e,s){super(DR.ROOM_DRAG,t),this._offsetX=e,this._offsetY=s}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}};PR.ROOM_DRAG="RDE_ROOM_DRAG";let OF=PR;const LR=class UR extends At{constructor(t,e,s,i,n,a){super(UR.ROOM_COLOR,t),this._state=e,this._presetId=s,this._effectId=i,this._color=n,this._brightness=a}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};LR.ROOM_COLOR="REDSE_ROOM_COLOR";let vF=LR;class $ extends At{constructor(t,e,s,i){super(t,e),this._objectId=s,this._category=i}get objectId(){return this._objectId}get category(){return this._category}}$.SELECTED="REOE_SELECTED";$.DESELECTED="REOE_DESELECTED";$.ADDED="REOE_ADDED";$.REMOVED="REOE_REMOVED";$.PLACED="REOE_PLACED";$.PLACED_ON_USER="REOE_PLACED_ON_USER";$.CONTENT_UPDATED="REOE_CONTENT_UPDATED";$.REQUEST_MOVE="REOE_REQUEST_MOVE";$.REQUEST_ROTATE="REOE_REQUEST_ROTATE";$.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION";$.MOUSE_ENTER="REOE_MOUSE_ENTER";$.MOUSE_LEAVE="REOE_MOUSE_LEAVE";$.DOUBLE_CLICK="REOE_DOUBLE_CLICK";class AF extends ${constructor(t,e,s,i,n,a,o,h,u,c,l,_,d){super(t,e,s,i),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=n,this._x=a,this._y=o,this._z=h,this._direction=u,this._placedInRoom=c,this._placedOnFloor=l,this._placedOnWall=_,this._instanceData=d}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}}class SF extends ${constructor(t,e,s,i,n,a){super(t,e,s,i),this._droppedObjectId=n,this._droppedObjectCategory=a}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}class va extends ${constructor(t,e,s,i,n,a=1){super(t,e,s,i),this._soundId=n,this._pitch=a}get soundId(){return this._soundId}get pitch(){return this._pitch}}va.PLAY_SOUND="REOPSE_PLAY_SOUND";va.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";class Di extends ${}Di.FURNI_CLICK="RERAE_FURNI_CLICK";Di.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK";Di.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW";Di.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";class is extends ${constructor(t,e,s,i,n,a=1){super(t,e,s,i),this._sampleId=n,this._pitch=a}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}is.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED";is.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED";is.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE";is.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class G extends ${constructor(t,e,s,i,n=null){super(t,e,s,i),this._widget=n}get widget(){return this._widget}get contextMenu(){return this._widget}}G.OPEN_WIDGET="RETWE_OPEN_WIDGET";G.CLOSE_WIDGET="RETWE_CLOSE_WIDGET";G.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU";G.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU";G.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER";G.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI";G.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT";G.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE";G.REQUEST_STICKIE="RETWE_REQUEST_STICKIE";G.REQUEST_PRESENT="RETWE_REQUEST_PRESENT";G.REQUEST_TROPHY="RETWE_REQUEST_TROPHY";G.REQUEST_TEASER="RETWE_REQUEST_TEASER";G.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX";G.REQUEST_DIMMER="RETWE_REQUEST_DIMMER";G.REMOVE_DIMMER="RETWE_REMOVE_DIMMER";G.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE";G.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR";G.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN";G.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG";G.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG";G.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR";G.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG";G.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG";G.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG";G.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING";G.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED";G.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM";G.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING";G.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING";G.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY";G.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY";G.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK";G.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK";G.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE";class Sl extends ${constructor(t,e,s,i,n=-1,a=-1){super(t,e,s,i),this._inventoryStripId=n,this._furnitureTypeId=a}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}}Sl.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM";Sl.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";class Us extends It{constructor(t,e){super(t),this._object=e}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}class Ir extends Us{constructor(t,e,s,i=!0){super(t,e),this._badgeId=s,this._groupBadge=i}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}}Ir.LOAD_BADGE="ROBAE_LOAD_BADGE";class Ns extends Us{constructor(t,e){super(t,e)}}Ns.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID";Ns.RODRE_URL_PREFIX="RODRE_URL_PREFIX";const xR=class FR extends Us{constructor(t,e,s,i,n,a){super(FR.DIMMER_STATE,t),this._state=e,this._presetId=s,this._effectId=i,this._color=n,this._brightness=a}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};xR.DIMMER_STATE="RODSUE_DIMMER_STATE";let Zo=xR;class Qe extends Us{constructor(t,e){super(t,e)}}Qe.ADD_HOLE="ROFHO_ADD_HOLE";Qe.REMOVE_HOLE="ROFHO_REMOVE_HOLE";class w extends Us{}w.DICE_OFF="ROFCAE_DICE_OFF";w.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE";w.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL";w.STICKIE="ROFCAE_STICKIE";w.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR";w.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT";w.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START";w.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP";w.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE";w.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT";w.JUKEBOX_START="ROFCAE_JUKEBOX_START";w.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP";w.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE";w.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON";w.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";class Kd extends At{constructor(t,e,s,i,n,a){super(t,e),this._enable=s,this._hue=i,this._saturation=n,this._lightness=a}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}Kd.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class yi extends Us{constructor(t,e,s,i,n,a){super(t,e),this._enable=s,this._hue=i,this._saturation=n,this._lightness=a}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}yi.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class et extends Us{constructor(t,e,s,i=!1,n=!1,a=!1,o=!1){super(t,e),this._eventId="",this._eventId=s,this._altKey=i,this._ctrlKey=n,this._shiftKey=a,this._buttonDown=o}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(t){this._localX=t}get localY(){return this._localY}set localY(t){this._localY=t}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}et.CLICK="ROE_MOUSE_CLICK";et.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK";et.MOUSE_MOVE="ROE_MOUSE_MOVE";et.MOUSE_DOWN="ROE_MOUSE_DOWN";et.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG";et.MOUSE_UP="ROE_MOUSE_UP";et.MOUSE_ENTER="ROE_MOUSE_ENTER";et.MOUSE_LEAVE="ROE_MOUSE_LEAVE";class $e extends Us{constructor(t,e){super(t,e)}}$e.POSITION_CHANGED="ROME_POSITION_CHANGED";$e.OBJECT_REMOVED="ROME_OBJECT_REMOVED";class Qr extends w{constructor(t,e,s,i=1){super(t,e),this._soundId=s,this._pitch=i}get soundId(){return this._soundId}get pitch(){return this._pitch}}Qr.PLAY_SOUND="ROPSIE_PLAY_SOUND";Qr.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";class Yt extends Us{constructor(t,e,s="",i=""){super(t,e),this._imageUrl="",this._clickUrl="",this._imageUrl=s,this._clickUrl=i}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}}Yt.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE";Yt.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK";Yt.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK";Yt.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW";Yt.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";class ie extends Us{constructor(t,e,s,i=1){super(t,e),this._sampleId=s,this._pitch=i}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}ie.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED";ie.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED";ie.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE";ie.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class Gt extends ${}Gt.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT";Gt.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON";Gt.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF";Gt.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE";Gt.JUKEBOX_INIT="ROSM_JUKEBOX_INIT";Gt.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON";Gt.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF";Gt.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";class mt extends Us{constructor(t,e,s=0){super(t,e),this._state=s}get state(){return this._state}}mt.STATE_CHANGE="ROSCE_STATE_CHANGE";mt.STATE_RANDOM="ROSCE_STATE_RANDOM";class Nr extends et{constructor(t,e,s,i,n,a,o=!1,h=!1,u=!1,c=!1){super(t,e,s,o,h,u,c),this._tileX=i,this._tileY=n,this._tileZ=a}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class aa extends et{constructor(t,e,s,i,n,a,o,h,u,c=!1,l=!1,_=!1,d=!1){super(t,e,s,c,l,_,d),this._wallLocation=new S,this._wallWd=new S,this._wallHt=new S,this._wallLocation.assign(i),this._wallWd.assign(n),this._wallHt.assign(a),this._x=o,this._y=h,this._direction=u}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class C extends Us{constructor(t,e){super(t,e)}}C.OPEN_WIDGET="ROWRE_OPEN_WIDGET";C.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET";C.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU";C.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU";C.PLACEHOLDER="ROWRE_PLACEHOLDER";C.CREDITFURNI="ROWRE_CREDITFURNI";C.STACK_HEIGHT="ROWRE_STACK_HEIGHT";C.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE";C.STICKIE="ROWRE_STICKIE";C.PRESENT="ROWRE_PRESENT";C.TROPHY="ROWRE_TROPHY";C.TEASER="ROWRE_TEASER";C.ECOTRONBOX="ROWRE_ECOTRONBOX";C.DIMMER="ROWRE_DIMMER";C.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER";C.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE";C.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR";C.MANNEQUIN="ROWRE_MANNEQUIN";C.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU";C.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU";C.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG";C.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG";C.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR";C.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG";C.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG";C.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG";C.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN";C.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING";C.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED";C.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM";C.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING";C.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING";C.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY";C.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY";C.INERNAL_LINK="ROWRE_INTERNAL_LINK";C.ROOM_LINK="ROWRE_ROOM_LINK";C.YOUTUBE="ROWRE_YOUTUBE";class yF{constructor(t,e,s,i,n,a,o=0,h=0,u=!1,c=!1,l=!1,_=!1){this._type=t,this._eventId=e,this._canvasId=s,this._spriteTag=i,this._screenX=n,this._screenY=a,this._localX=o,this._localY=h,this._ctrlKey=u,this._altKey=c,this._shiftKey=l,this._buttonDown=_,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}class MF extends It{constructor(t){super(t)}}class fh extends MF{constructor(t,e){super(t),this._targetLocation=e}get targetLocation(){return this._targetLocation}}fh.ROAME_MOVE_TO="ROAME_MOVE_TO";const wR=class GR extends At{constructor(t,e,s=!1,i=!1){super(GR.ROOM_ZOOM,t),this._level=e,this._forceFlip=s,this._asDelta=i}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}};wR.ROOM_ZOOM="REE_ROOM_ZOOM";let Fst=wR;const BR=class HR extends It{constructor(t,e){super(HR.IMAGE_READY),this._badgeId=t,this._image=e}get badgeId(){return this._badgeId}get image(){return this._image}};BR.IMAGE_READY="BIME_BADGE_IMAGE_READY";let yl=BR;const VR=class kR extends It{constructor(t,e){super(kR.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=t,this._keyColor=e}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}};VR.MYSTERY_BOX_KEYS_UPDATE="mbke_update";let CF=VR;const NF=class jR extends It{constructor(){super(jR.PERKS_UPDATED)}};NF.PERKS_UPDATED="PUE_perks_updated";class ot extends It{constructor(t,e,s=!0){super(t),this._session=e,this._openLandingView=s}get session(){return this._session}get openLandingView(){return this._openLandingView}}ot.CREATED="RSE_CREATED";ot.STARTED="RSE_STARTED";ot.ENDED="RSE_ENDED";ot.ROOM_DATA="RSE_ROOM_DATA";class pt extends ot{constructor(t,e,s,i,n,a=0,o=null,h=-1){super(t,e),this._objectId=s,this._message=i,this._chatType=n,this._links=o,this._extraParam=h,this._style=a}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}}pt.CHAT_EVENT="RSCE_CHAT_EVENT";pt.FLOOD_EVENT="RSCE_FLOOD_EVENT";pt.CHAT_TYPE_SPEAK=0;pt.CHAT_TYPE_WHISPER=1;pt.CHAT_TYPE_SHOUT=2;pt.CHAT_TYPE_RESPECT=3;pt.CHAT_TYPE_PETRESPECT=4;pt.CHAT_TYPE_HAND_ITEM_RECEIVED=5;pt.CHAT_TYPE_PETTREAT=6;pt.CHAT_TYPE_PETREVIVE=7;pt.CHAT_TYPE_PET_REBREED_FERTILIZE=8;pt.CHAT_TYPE_PET_SPEED_FERTILIZE=9;pt.CHAT_TYPE_MUTE_REMAINING=10;const zR=class YR extends ot{constructor(t,e,s,i,n,a){super(YR.CONFIRM_PET_BREEDING,t),this._nestId=e,this._pet1=s,this._pet2=i,this._rarityCategories=n,this._resultPetTypeId=a}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetTypeId(){return this._resultPetTypeId}};zR.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";let bF=zR;const WR=class XR extends ot{constructor(t,e,s){super(XR.RSPFUE_CONFIRM_PET_BREEDING_RESULT,t),this._breedingNestStuffId=e,this._result=s}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}};WR.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";let PF=WR;const KR=class qR extends ot{constructor(t,e,s){super(qR.RSDE_DANCE,t),this._roomIndex=e,this._danceId=s}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}};KR.RSDE_DANCE="RSDE_DANCE";let DF=KR;class LF{constructor(t,e,s,i){this._id=t,this._type=e,this._color=s,this._brightness=i}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}class qd extends ot{constructor(t,e){super(t,e),this._selectedPresetId=0,this._presets=[]}storePreset(t,e,s,i){this._presets[t-1]=new LF(t,e,s,i)}getPreset(t){return t<0||t>=this._presets.length?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(t){this._selectedPresetId=t}}qd.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";class Zr extends ot{constructor(t,e,s){super(t,e),this._userName="",this._userName=s}get userName(){return this._userName}}Zr.DOORBELL="RSDE_DOORBELL";Zr.RSDE_REJECTED="RSDE_REJECTED";Zr.RSDE_ACCEPTED="RSDE_ACCEPTED";class Zt extends ot{constructor(t,e,s=null){super(t,e),this._message=s}get message(){return this._message}}Zt.RSEME_KICKED="RSEME_KICKED";Zt.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL";Zt.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT";Zt.RSEME_MAX_PETS="RSEME_MAX_PETS";Zt.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS";Zt.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET";Zt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET";Zt.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL";Zt.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT";Zt.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED";Zt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT";Zt.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";const QR=class ZR extends ot{constructor(t,e,s,i,n){super(ZR.FAVOURITE_GROUP_UPDATE,t),this._roomIndex=e,this._habboGroupId=s,this._habboGroupName=n,this._status=i}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}};QR.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";let UF=QR;const JR=class $R extends ot{constructor(t,e,s,i){super($R.RSFRE_FRIEND_REQUEST,t),this._requestId=0,this._userId=0,this._requestId=e,this._userId=s,this._userName=i}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}};JR.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";let xF=JR;const tO=class eO extends ot{constructor(t,e,s){super(eO.NEST_BREEDING_SUCCESS,t),this._petId=e,this._rarityCategory=s}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}};tO.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";let FF=tO;const sO=class rO extends ot{constructor(t,e,s,i){super(rO.PET_BREEDING,t),this._state=e,this._ownPetId=s,this._otherPetId=i}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};sO.PET_BREEDING="RSPFUE_PET_BREEDING";let wF=sO;const iO=class nO extends ot{constructor(t,e,s){super(nO.PET_BREEDING_RESULT,t),this._resultData=e,this._otherResultData=s}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}};iO.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";let GF=iO;const BF=class aO extends ot{constructor(t,e,s,i){super(aO.PET_COMMANDS,t),this._petId=e,this._allCommandIds=s,this._enabledCommandIds=i}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}};BF.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";const oO=class hO extends ot{constructor(t,e,s){super(hO.PET_FIGURE_UPDATE,t),this._petId=e,this._figure=s}get id(){return this._petId}get figure(){return this._figure}};oO.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";let HF=oO;const uO=class lO extends ot{constructor(t,e){super(lO.PET_INFO,t),this._petInfo=e}get petInfo(){return this._petInfo}};uO.PET_INFO="RSPIUE_PET_INFO";let VF=uO;const _O=class cO extends ot{constructor(t,e,s){super(cO.PET_LEVEL_UPDATE,t),this._petId=e,this._level=s}get petId(){return this._petId}get level(){return this._level}};_O.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";let kF=_O;class Aa extends ot{constructor(t,e,s,i,n,a){super(t,e),this._objectId=-1,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=s,this._figureData=i,this._nameValidationStatus=n,this._nameValidationInfo=a}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}Aa.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED";Aa.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";const dO=class fO extends ot{constructor(t,e,s,i,n,a){super(fO.PET_STATUS_UPDATE,t),this._petId=e,this._canBreed=s,this._canHarvest=i,this._canRevive=n,this._hasBreedingPermission=a}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}};dO.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";let jF=dO;class jr extends ot{constructor(t,e,s){super(t,e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=s}get id(){return this._id}get headline(){return this._headline}set headline(t){this._headline=t}get summary(){return this._summary}set summary(t){this._summary=t}get numQuestions(){return this._numQuestions}set numQuestions(t){this._numQuestions=t}get startMessage(){return this._startMessage}set startMessage(t){this._startMessage=t}get endMessage(){return this._endMessage}set endMessage(t){this._endMessage=t}get questionArray(){return this._questionArray}set questionArray(t){this._questionArray=t}get npsPoll(){return this._npsPoll}set npsPoll(t){this._npsPoll=t}}jr.OFFER="RSPE_POLL_OFFER";jr.ERROR="RSPE_POLL_ERROR";jr.CONTENT="RSPE_POLL_CONTENT";class Qd extends ot{constructor(t,e,s,i,n,a,o,h,u){super(t,e),this._classId=0,this._itemType="",this._placedItemId=0,this._placedItemType="",this._classId=s,this._itemType=i,this._productCode=n,this._placedItemId=a,this._placedItemType=o,this._placedInRoom=h,this._petFigureString=u}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}}Qd.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";class Zd extends ot{constructor(t,e){super(t,e)}}Zd.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";const Lh=class gO extends ot{constructor(t,e,s,i=!1){super(gO.QUEUE_STATUS,t),this._name=e,this._target=s,this._queues=new Map,this._isActive=i}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(t){return this._queues.get(t)}addQueue(t,e){this._queues.set(t,e)}};Lh.QUEUE_STATUS="RSQE_QUEUE_STATUS";Lh.QUEUE_TYPE_CLUB="c";Lh.QUEUE_TYPE_NORMAL="d";Lh.QUEUE_TARGET_VISITOR=2;Lh.QUEUE_TARGET_SPECTATOR=1;class Jd extends ot{constructor(t,e){super(t,e)}}Jd.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";const EO=class pO extends ot{constructor(t,e,s){super(pO.RSUBE_BADGES,t),this._userId=0,this._badges=[],this._userId=e,this._badges=s}get userId(){return this._userId}get badges(){return this._badges}};EO.RSUBE_BADGES="RSUBE_BADGES";let zF=EO;const mO=class IO extends ot{constructor(t,e){super(IO.USER_DATA_UPDATED,t),this._addedUsers=e}get addedUsers(){return this._addedUsers}};mO.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";let YF=mO;const TO=class RO extends ot{constructor(t,e,s,i,n,a){super(RO.USER_FIGURE,t),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._roomIndex=e,this._figure=s,this._gender=i,this._customInfo=n,this._achievementScore=a}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}};TO.USER_FIGURE="RSUBE_FIGURE";let WF=TO;const XF=class OO extends It{constructor(t,e){super(OO.UTRE_USER_TAGS_RECEIVED),this._userId=t,this._tags=e}get userId(){return this._userId}get tags(){return this._tags}};XF.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";class vO extends ot{constructor(t,e,s,i,n=null,a=0){super(t,e),this._question="",this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=s,this._choices=i,this._SafeStr_7651=n,this._SafeStr_7651==null&&(this._SafeStr_7651=[]),this._SafeStr_7654=a}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}}vO.VOTE_QUESTION="RSPE_VOTE_QUESTION";vO.VOTE_RESULT="RSPE_VOTE_RESULT";class zr extends ot{constructor(t,e,s=-1){super(t,e),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._id=s}get id(){return this._id}get pollType(){return this._pollType}set pollType(t){this._pollType=t}get pollId(){return this._pollId}set pollId(t){this._pollId=t}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get duration(){return this._duration}set duration(t){this._duration=t}get question(){return this._question}set question(t){this._question=t}get userId(){return this._userId}set userId(t){this._userId=t}get value(){return this._value}set value(t){this._value=t}get answerCounts(){return this._answerCounts}set answerCounts(t){this._answerCounts=t}}zr.QUESTION="RWPUW_NEW_QUESTION";zr.FINISHED="RWPUW_QUESION_FINSIHED";zr.ANSWERED="RWPUW_QUESTION_ANSWERED";const AO=class SO extends It{constructor(t){super(SO.UPDATED),this._uiFlags=t}get uiFlags(){return this._uiFlags}};AO.UPDATED="APUE_UPDATED";let KF=AO;const yO=class MO extends It{constructor(t){super(MO.UNUE_NAME_UPDATED),this._name=t}get name(){return this._name}};yO.UNUE_NAME_UPDATED="unue_name_updated";let qm=yO;class qF{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(t){for(const[e,s]of t.events)this.registerMessageEventClass(e,s);for(const[e,s]of t.composers)this.registerMessageComposerClass(e,s)}registerMessageEventClass(t,e){!t||!e||this._messageIdByEvent.set(e,t)}registerMessageComposerClass(t,e){!t||!e||this._messageIdByComposer.set(e,t)}registerMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;let s=this._messageInstancesById.get(e);(!s||!s.length)&&(s=[],this._messageInstancesById.set(e,s)),s.push(t)}removeMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;const s=this._messageInstancesById.get(e);if(s){for(const[i,n]of s.entries())if(n&&n===t){s.splice(i,1),s.length===0&&this._messageInstancesById.delete(e),n.dispose();return}}}getEvents(t){if(!t)return;const e=this._messageInstancesById.get(t);if(e)return e}getEventId(t){if(!t)return-1;const e=t instanceof R?t.constructor:t,s=this._messageIdByEvent.get(e);return s||-1}getComposerId(t){if(!t)return-1;const e=this._messageIdByComposer.get(t.constructor);return e||-1}}class QF extends vs{constructor(t,e){super(),this._communicationManager=t,this._stateListener=e,this._socket=null,this._messages=new qF,this._codec=new TF,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(t){this._stateListener&&this._stateListener.connectionInit(t),this.createSocket(t)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(t){t&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(t),this._socket.addEventListener(ys.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(ys.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(ys.CONNECTION_ERROR,this.onError),this._socket.addEventListener(ys.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(ys.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(ys.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(ys.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(ys.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(t){this.dispatchConnectionEvent(Te.CONNECTION_OPENED,t)}onClose(t){this.dispatchConnectionEvent(Te.CONNECTION_CLOSED,t)}onError(t){this.dispatchConnectionEvent(Te.CONNECTION_ERROR,t)}onMessage(t){if(!t)return;const e=new FileReader;e.readAsArrayBuffer(t.data),e.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,e.result),this.processReceivedData()}}dispatchConnectionEvent(t,e){this.dispatchEvent(new Te(t,this,e))}authenticated(){this._isAuthenticated=!0}send(...t){if(this.disposed||!t)return!1;if(t=[...t],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...t),!1;for(const e of t){if(!e)continue;const s=this._messages.getComposerId(e);if(s===-1){Y.packets("Unknown Composer",e.constructor.name);continue}const i=e.getMessageArray(),n=this._codec.encode(s,i);if(!n){Y.packets("Encoding Failed",e.constructor.name);continue}Y.packets("OutgoingComposer",s,e.constructor.name,i),this.write(n.getBuffer())}return!0}write(t){this._socket.readyState===WebSocket.OPEN&&this._socket.send(t)}processReceivedData(){try{this.processData()}catch(t){Y.error(t)}}processData(){const t=this.splitReceivedMessages();if(!(!t||!t.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...t);return}this.processWrappers(...t)}}processWrappers(...t){if(!(!t||!t.length))for(const e of t){if(!e)continue;const s=this.getMessagesForWrapper(e);!s||!s.length||(Y.packets("IncomingMessage",e.header,s[0].constructor.name,s[0].parser),this.handleMessages(...s))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(t,e){const s=new Uint8Array(t.byteLength+e.byteLength);return s.set(new Uint8Array(t),0),s.set(new Uint8Array(e),t.byteLength),s.buffer}getMessagesForWrapper(t){if(!t)return null;const e=this._messages.getEvents(t.header);if(!e||!e.length){Y.packets("IncomingMessage",t.header,"UNREGISTERED",t);return}try{const s=new e[0].parserClass;if(!s||!s.flush()||!s.parse(t))return null;for(const i of e)i.parser=s}catch(s){return Y.error("Error parsing message",s,e[0].constructor.name),null}return e}handleMessages(...t){t=[...t];for(const e of t)e&&(e.connection=this,e.callBack&&e.callBack(e))}registerMessages(t){t&&this._messages.registerMessages(t)}addMessageEvent(t){!t||!this._messages||this._messages.registerMessageEvent(t)}removeMessageEvent(t){!t||!this._messages||this._messages.removeMessageEvent(t)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(t){this._dataBuffer=t}}class ZF extends ds{constructor(){super(),this._connections=[]}onDispose(){if(!(!this._connections||!this._connections.length))for(const t of this._connections.values())t&&t.dispose()}createConnection(t=null){const e=new QF(this,t);if(e)return this._connections.push(e),e}update(t){let e=0;for(;e<this._connections.length;){const s=this._connections[e];if(s.processReceivedData(),this.disposed)return;s.disposed?this._connections.splice(e,1):e++}}}class Mi extends It{constructor(t){super(t)}}Mi.LOADED="NCE_LOADED";Mi.FAILED="NCE_FAILED";class JF extends Rr{constructor(){super(),this._definitions=new Map,this._config=[],this._pendingUrls=[],this._missingKeys=[],this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){at.parseConfiguration(this.getDefaultConfig(),!0),this._pendingUrls=at.getValue("config.urls").slice(),this.loadNextConfiguration()}loadNextConfiguration(){if(!this._pendingUrls.length){this.dispatchConfigurationEvent(Mi.LOADED);return}this.loadConfigurationFromUrl(this._pendingUrls[0])}loadConfigurationFromUrl(t){if(!t||t===""){this.dispatchConfigurationEvent(Mi.FAILED);return}fetch(t).then(e=>e.json()).then(e=>this.onConfigurationLoaded(e,t)).catch(e=>this.onConfigurationFailed(e))}onConfigurationLoaded(t,e){if(t){if(at.parseConfiguration(t)){const s=this._pendingUrls.indexOf(e);s>=0&&this._pendingUrls.splice(s,1),this.loadNextConfiguration();return}this.dispatchConfigurationEvent(Mi.FAILED)}}onConfigurationFailed(t){this.dispatchConfigurationEvent(Mi.FAILED)}dispatchConfigurationEvent(t){this.events&&this.events.dispatchEvent(new Mi(t))}getDefaultConfig(){return NitroConfig}}const Xg=class yo{static sayHello(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const t=[`
 %c %c %c Nitro ${yo.UI_VERSION} - Renderer ${yo.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c 

`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...t)}else self.console&&self.console.log(`Nitro ${yo.UI_VERSION} - Renderer ${yo.RENDERER_VERSION} `)}};Xg.RENDERER_VERSION="1.6.6";Xg.UI_VERSION="";let CO=Xg;class $F extends ds{constructor(){super(),CO.sayHello(),this._configuration=new JF,this._communication=new ZF}onDispose(){this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}}class tw{constructor(t){this._id=parseInt(t.id),this._value=parseInt(t.id),this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._isAnimated=!0,t.animated!==void 0&&t.animated===!1&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class ew{constructor(t){if(this._id=t.id,this._state=t.state,this._precedence=t.precedence,this._activePartSet=t.activePartSet,this._assetPartDefinition=t.assetPartDefinition,this._lay=t.lay,this._geometryType=t.geometryType,this._isMain=t.main||!1,this._isDefault=t.isDefault||!1,this._isAnimation=t.animation||!1,this._startFromFrameZero=t.startFromFrameZero||!1,this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,t.params&&t.params.length>0)for(const e of t.params)e&&(e.id==="default"?this._defaultParameterValue=e.value:this._params.set(e.id,e.value));if(t.types&&t.types.length>0)for(const e of t.types){if(!e)continue;const s=new tw(e);this._types.set(s.id,s)}}setOffsets(t,e,s){this._canvasOffsets||(this._canvasOffsets=new Map);let i=this._canvasOffsets.get(t);i||(i=new Map,this._canvasOffsets.set(t,i)),i.set(e,s)}getOffsets(t,e){if(!this._canvasOffsets)return null;const s=this._canvasOffsets.get(t);return s?s.get(e):null}getType(t){if(!t)return null;const e=this._types.get(parseInt(t));return e||null}getParameterValue(t){if(!t)return"";const e=this._params.get(t);return e||this._defaultParameterValue}getPrevents(t){return this._prevents.concat(this.getTypePrevents(t))}getTypePrevents(t){if(!t)return[];const e=this._types.get(parseInt(t));return e?e.prevents:[]}getPreventHeadTurn(t){if(!t)return this._preventHeadTurn;const e=this.getType(t);return e?e.preventHeadTurn:this._preventHeadTurn}isAnimated(t){if(!t)return!0;const e=this.getType(t);return e?e.isAnimated:!0}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class $d{constructor(t,e="",s=0){this._actionType=t||"",this._actionParameter=e||"",this._definition=null,this._startFrame=s||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(t){this._actionParameter=t}get definition(){return this._definition}set definition(t){this._definition=t}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(t){this._overridingAction=t}}class sw{constructor(t,e){this._assets=t,this._actions=new Map,this._defaultAction=null,this.updateActions(e)}updateActions(t){if(t){for(const e of t.actions){if(!e||!e.state)continue;const s=new ew(e);this._actions.set(s.state,s)}t.actionOffsets&&this.parseActionOffsets(t.actionOffsets)}}parseActionOffsets(t){if(!(!t||!t.length))for(const e of t){const s=this._actions.get(e.action);if(s)for(const i of e.offsets){const n=i.size||"",a=i.direction;if(n===""||a===void 0)continue;const o=i.x||0,h=i.y||0,u=i.z||0;s.setOffsets(n,a,[o,h,u])}}}getActionDefinition(t){if(!t)return null;for(const e of this._actions.values())if(!(!e||e.id!==t))return e;return null}getActionDefinitionWithState(t){const e=this._actions.get(t);return e||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const t of this._actions.values())if(!(!t||!t.isDefault))return this._defaultAction=t,t;return null}getCanvasOffsets(t,e,s){let i=[];for(const n of t){if(!n)continue;const a=this._actions.get(n.actionType),o=a&&a.getOffsets(e,s);o&&(i=o)}return i}sortActions(t){if(!t)return null;t=this.filterActions(t);const e=[];for(const s of t){if(!s)continue;const i=this._actions.get(s.actionType);i&&(s.definition=i,e.push(s))}return e.sort(this.sortByPrecedence),e}filterActions(t){let e=[];const s=[];for(const i of t){if(!i)continue;const n=this._actions.get(i.actionType);n&&(e=e.concat(n.getPrevents(i.actionParameter)))}for(const i of t){if(!i)continue;let n=i.actionType;i.actionType==="fx"&&(n=n+("."+i.actionParameter)),!(e.indexOf(n)>=0)&&s.push(i)}return s}sortByPrecedence(t,e){if(!t||!e)return 0;const s=t.definition.precedence,i=e.definition.precedence;return s<i?1:s>i?-1:0}}class rw{constructor(t,e){this._name=t,this._link=e.link,this._flipH=e.flipH,this._flipV=e.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class iw{constructor(t,e){this._avatarRenderManager=t,this._aliases=new Map,this._assets=e,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const t of this._assets.collections.values()){if(!t)continue;const e=t.data&&t.data.aliases;if(e)for(const s in e){const i=e[s];i&&this._aliases.set(s,new rw(s,i))}}}hasAlias(t){return!!this._aliases.get(t)}getAssetName(t){let e=t,s=5;for(;this.hasAlias(e)&&s>=0;)e=this._aliases.get(e).link,s--;return e}getAsset(t){if(!this._assets)return null;t=this.getAssetName(t);const e=this._assets.getAsset(t);return e||null}}class nw{constructor(t){this._id=t.id||"",this._align=t.align||"",this._base=t.base||"",this._ink=t.ink||0,this._blend=0;const e=t.blend;e&&e.length>0&&(this._blend=parseInt(e),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return this._blend!==1}}class Vs{constructor(t,e,s){if(this._id=t.id,this._animationFrame=t.frame||0,this._dx=t.dx||0,this._dy=t.dy||0,this._dz=t.dz||0,this._directionOffset=t.dd||0,this._type=e,this._base=t.base||"",this._items=new Map,t.items)for(const i of t.items)this._items.set(i.id,i.base);this._base!==""&&this.baseAsInt().toString(),s&&(this._action=new $d(s.state,this.base),this._action.definition=s)}get items(){return this._items}baseAsInt(){let t=0,e=0;for(;e<this._base.length;)t=t+this._base.charCodeAt(e),e++;return t}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}}Vs.BODYPART="bodypart";Vs.FX="fx";class aw{constructor(t){this._ink=t.ink;let e=t.foreground,s=t.background;e=e.replace("#",""),s=s.replace("#",""),this._foreGround=parseInt(e,16),this._backGround=parseInt(s,16),this._colorTransform=null,this._rgb=parseInt(e,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,this._ink===37&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new X1({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(t,e){const s=t>>24&255,i=t>>16&255,n=t>>8&255,a=t>>0&255,o=e>>24&255,h=e>>16&255,u=e>>8&255,c=e>>0&255,l=(o-s)/255,_=(h-i)/255,d=(u-n)/255,f=(c-a)/255,m=new Map,p=[],T=[],v=[];let O=s,A=i,y=n,M=a;for(let N=0;N<256;N++)A==i&&y==n&&M==a&&(O=0),O=O+l,A=A+_,y=y+d,M=M+f,p.push(O<<24|A<<16|y<<8|M),T.push(O<<24|A<<16|y<<8|M),v.push(O<<24|A<<16|y<<8|M);return m.set("alphas",p),m.set("reds",p),m.set("greens",T),m.set("blues",v),m}}class ow{constructor(t){this._offset=t.offset}get offset(){return this._offset}}class hw{constructor(t,e){this._animation=t,this._id=e.id,this._ink=e.ink,this._member=e.member,this._hasStaticY=!!e.staticY,this._hasDirections=!!e.directions,this._dx=[],this._dy=[],this._dz=[];const s=e.directionList;if(s&&s.length)for(const i of s){const n=i.id;n!==void 0&&(this._dx[n]=i.dx||0,this._dy[n]=i.dy||0,this._dz[n]=i.dz||0)}}getDirectionOffsetX(t){return t<this._dx.length?this._dx[t]:0}getDirectionOffsetY(t){return t<this._dy.length?this._dy[t]:0}getDirectionOffsetZ(t){return t<this._dz.length?this._dz[t]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}const NO=class Ku{constructor(t,e){if(this._id=e.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=e.resetOnToggle||!1,e.sprites&&e.sprites.length){this._spriteData=[];for(const s of e.sprites)this._spriteData.push(new hw(this,s))}if(e.avatars&&e.avatars.length&&(this._avatarData=new aw(e.avatars[0])),e.directions&&e.directions.length&&(this._directionData=new ow(e.directions[0])),e.removes&&e.removes.length){this._removeData=[];for(const s of e.removes)this._removeData.push(s.id)}if(e.adds&&e.adds.length){this._addData=[];for(const s of e.adds)this._addData.push(new nw(s))}if(e.overrides&&e.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const s of e.overrides){const i=s.name,n=s.override;this._overriddenActions.set(n,i);const a=[];this.parseFrames(a,s.frames,t),this._overrideFrames.set(i,a)}}this.parseFrames(this._frames,e.frames,t)}parseFrames(t,e,s){if(!(!e||!e.length))for(const i of e){let n=1;i.repeats&&i.repeats>1&&(n=i.repeats);let a=0;for(;a<n;){const o=[];if(i.bodyparts&&i.bodyparts.length)for(const h of i.bodyparts){const u=s.getActionDefinition(h.action),c=new Vs(h,Vs.BODYPART,u);o.push(c)}if(i.fxs&&i.fxs.length)for(const h of i.fxs){const u=s.getActionDefinition(h.action),c=new Vs(h,Vs.FX,u);o.push(c)}t.push(o),a++}}}frameCount(t=null){if(!t)return this._frames.length;if(this._overrideFrames){const e=this._overrideFrames.get(t);if(e)return e.length}return 0}hasOverriddenActions(){return this._overriddenActions?this._overriddenActions.size>0:!1}overriddenActionNames(){if(!this._overriddenActions)return null;const t=[];for(const e of this._overriddenActions.keys())t.push(e);return t}overridingAction(t){return this._overriddenActions?this._overriddenActions.get(t):null}getFrame(t,e=null){t<0&&(t=0);let s=[];if(!e)this._frames.length>0&&(s=this._frames[t%this._frames.length]);else{const i=this._overrideFrames.get(e);i&&i.length>0&&(s=i[t%i.length])}return s}getAnimatedBodyPartIds(t,e=null){const s=[];for(const i of this.getFrame(t,e))if(i.type===Vs.BODYPART)s.push(i.id);else if(i.type===Vs.FX&&this._addData&&this._addData.length)for(const n of this._addData)n.id===i.id&&s.push(n.align);return s}getLayerData(t,e,s=null){for(const i of this.getFrame(t,s)){if(i.id===e)return i;if(i.type===Vs.FX&&this._addData&&this._addData.length){for(const n of this._addData)if(n.align===e&&n.id===i.id)return i}}return null}hasAvatarData(){return this._avatarData!==null}hasDirectionData(){return this._directionData!==null}hasAddData(){return this._addData!==null}getAddData(t){if(this._addData){for(const e of this._addData)if(e.id===t)return e}return null}get id(){return this._id}get spriteData(){return this._spriteData||Ku.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||Ku.EMPTY_ARRAY}get addData(){return this._addData||Ku.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}};NO.EMPTY_ARRAY=[];let uw=NO;class lw{constructor(){this._animations=new Map}registerAnimation(t,e){if(!e)return!1;const s=e[Object.keys(e)[0]],i=new uw(t,s);return this._animations.set(s.name,i),!0}getAnimation(t){const e=this._animations.get(t);return e||null}getLayerData(t,e,s){const i=this.getAnimation(t);return i?i.getLayerData(e,s):null}get animations(){return this._animations}}const Uh=class br extends vs{constructor(t,e,s,i){super(),this._state=br.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=i,this._assets=s,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=br.LOADED)}async downloadAsset(){if(!this._assets||this._state===br.LOADING||this._state===br.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=br.LOADED,this.dispatchEvent(new Ra(Ra.DOWNLOAD_COMPLETE,this));return}this._state=br.LOADING,await this._assets.downloadAsset(this._downloadUrl)&&(this._state=br.LOADED,this.dispatchEvent(new Ra(Ra.DOWNLOAD_COMPLETE,this)))}get libraryName(){return this._libraryName}get isLoaded(){return this._state===br.LOADED}};Uh.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE";Uh.NOT_LOADED=0;Uh.LOADING=1;Uh.LOADED=2;let _w=Uh;const __=class tf extends vs{constructor(t,e){super(),this._assets=t,this._structure=e,this._missingMandatoryLibs=at.getValue("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(l_.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const t=new XMLHttpRequest;try{t.open("GET",at.getValue("avatar.figuremap.url")),t.send(),t.onloadend=e=>{if(t.responseText){const s=JSON.parse(t.responseText);this.processFigureMap(s.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new It(tf.DOWNLOADER_READY))}},t.onerror=e=>{throw new Error("invalid_avatar_figure_map")}}catch(e){Y.error(e)}}processFigureMap(t){if(t)for(const e of t){if(!e)continue;const s=e.id,i=e.revision||"";if(this._libraryNames.indexOf(s)>=0)continue;this._libraryNames.push(s);const n=new _w(s,i,this._assets,at.getValue("avatar.asset.url"));n.addEventListener(Ra.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const a of e.parts){const o=a.id,u=a.type+":"+o;let c=this._figureMap.get(u);c||(c=[]),c.push(n),this._figureMap.set(u,c)}}}onAvatarRenderReady(t){if(t){for(const[e,s]of this._pendingContainers)this.downloadAvatarFigure(e,s);this._pendingContainers=[]}}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];for(const[i,n]of this._incompleteFigures.entries()){let a=!0;for(const o of n)if(!(!o||o.isLoaded)){a=!1;break}if(a){e.push(i);const o=this._figureListeners.get(i);if(o)for(const h of o)!h||h.disposed||h.resetFigure(i);this._figureListeners.delete(i),this.dispatchEvent(new It(tf.LIBRARY_LOADED))}}for(const i of e)i&&this._incompleteFigures.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const s=this._figureMap.get(e);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarFigureContainerReady(t){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarFigurePendingLibraries(t).length}getAvatarFigurePendingLibraries(t){const e=[];if(!t||!this._structure)return e;const s=this._structure.figureData;if(!s)return e;const i=t.getPartTypeIds();for(const n of i){const a=s.getSetType(n);if(!a)continue;const o=a.getPartSet(t.getPartSetId(n));if(o)for(const h of o.parts){if(!h)continue;const u=h.type+":"+h.id,c=this._figureMap.get(u);if(c!==void 0)for(const l of c)!l||l.isLoaded||e.indexOf(l)>=0||e.push(l)}}return e}downloadAvatarFigure(t,e){if(!this._isReady||!this._structure.renderManager.isReady){this._pendingContainers.push([t,e]);return}const s=t.getFigureString(),i=this.getAvatarFigurePendingLibraries(t);if(i&&i.length){if(e&&!e.disposed){let n=this._figureListeners.get(s);n||(n=[],this._figureListeners.set(s,n)),n.push(e)}this._incompleteFigures.set(s,i);for(const n of i)n&&this.downloadLibrary(n)}else e&&!e.disposed&&e.resetFigure(s)}downloadLibrary(t){!t||t.isLoaded||this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};__.DOWNLOADER_READY="AADM_DOWNLOADER_READY";__.LIBRARY_LOADED="AADM_LIBRARY_LOADED";__.MAX_DOWNLOADS=2;let mo=__;class qu{constructor(t){this._parts=new Map,this.parseFigure(t)}getPartTypeIds(){return this.partSets().keys()}hasPartType(t){return!!this.partSets().get(t)}getPartSetId(t){const e=this.partSets().get(t);return e?e.get("setid"):0}getPartColorIds(t){const e=this.partSets().get(t);return e?e.get("colorids"):null}updatePart(t,e,s){const i=new Map;i.set("type",t),i.set("setid",e),i.set("colorids",s);const n=this.partSets();n.delete(t),n.set(t,i)}removePart(t){this.partSets().delete(t)}getFigureString(){const t=[];for(const e of this.partSets().keys()){if(!e)continue;let s=[];s.push(e),s.push(this.getPartSetId(e)),s=s.concat(this.getPartColorIds(e)),t.push(s.join("-"))}return t.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(t){t||(t="");for(const e of t.split(".")){const s=e.split("-");if(s.length>=2){const i=s[0],n=parseInt(s[1]),a=[];let o=2;for(;o<s.length;)a.push(parseInt(s[o])),o++;this.updatePart(i,n,a)}}}}/*!
 * @pixi/filter-color-matrix - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/filter-color-matrix is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ef=function(r,t){return ef=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},ef(r,t)};function cw(r,t){ef(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var dw=`varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform float m[20];
uniform float uAlpha;

void main(void)
{
    vec4 c = texture2D(uSampler, vTextureCoord);

    if (uAlpha == 0.0) {
        gl_FragColor = c;
        return;
    }

    // Un-premultiply alpha before applying the color matrix. See issue #3539.
    if (c.a > 0.0) {
      c.rgb /= c.a;
    }

    vec4 result;

    result.r = (m[0] * c.r);
        result.r += (m[1] * c.g);
        result.r += (m[2] * c.b);
        result.r += (m[3] * c.a);
        result.r += m[4];

    result.g = (m[5] * c.r);
        result.g += (m[6] * c.g);
        result.g += (m[7] * c.b);
        result.g += (m[8] * c.a);
        result.g += m[9];

    result.b = (m[10] * c.r);
       result.b += (m[11] * c.g);
       result.b += (m[12] * c.b);
       result.b += (m[13] * c.a);
       result.b += m[14];

    result.a = (m[15] * c.r);
       result.a += (m[16] * c.g);
       result.a += (m[17] * c.b);
       result.a += (m[18] * c.a);
       result.a += m[19];

    vec3 rgb = mix(c.rgb, result.rgb, uAlpha);

    // Premultiply alpha again.
    rgb *= result.a;

    gl_FragColor = vec4(rgb, result.a);
}
`,Ml=function(r){cw(t,r);function t(){var e=this,s={m:new Float32Array([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0]),uAlpha:1};return e=r.call(this,qL,dw,s)||this,e.alpha=1,e}return t.prototype._loadMatrix=function(e,s){s===void 0&&(s=!1);var i=e;s&&(this._multiply(i,this.uniforms.m,e),i=this._colorMatrix(i)),this.uniforms.m=i},t.prototype._multiply=function(e,s,i){return e[0]=s[0]*i[0]+s[1]*i[5]+s[2]*i[10]+s[3]*i[15],e[1]=s[0]*i[1]+s[1]*i[6]+s[2]*i[11]+s[3]*i[16],e[2]=s[0]*i[2]+s[1]*i[7]+s[2]*i[12]+s[3]*i[17],e[3]=s[0]*i[3]+s[1]*i[8]+s[2]*i[13]+s[3]*i[18],e[4]=s[0]*i[4]+s[1]*i[9]+s[2]*i[14]+s[3]*i[19]+s[4],e[5]=s[5]*i[0]+s[6]*i[5]+s[7]*i[10]+s[8]*i[15],e[6]=s[5]*i[1]+s[6]*i[6]+s[7]*i[11]+s[8]*i[16],e[7]=s[5]*i[2]+s[6]*i[7]+s[7]*i[12]+s[8]*i[17],e[8]=s[5]*i[3]+s[6]*i[8]+s[7]*i[13]+s[8]*i[18],e[9]=s[5]*i[4]+s[6]*i[9]+s[7]*i[14]+s[8]*i[19]+s[9],e[10]=s[10]*i[0]+s[11]*i[5]+s[12]*i[10]+s[13]*i[15],e[11]=s[10]*i[1]+s[11]*i[6]+s[12]*i[11]+s[13]*i[16],e[12]=s[10]*i[2]+s[11]*i[7]+s[12]*i[12]+s[13]*i[17],e[13]=s[10]*i[3]+s[11]*i[8]+s[12]*i[13]+s[13]*i[18],e[14]=s[10]*i[4]+s[11]*i[9]+s[12]*i[14]+s[13]*i[19]+s[14],e[15]=s[15]*i[0]+s[16]*i[5]+s[17]*i[10]+s[18]*i[15],e[16]=s[15]*i[1]+s[16]*i[6]+s[17]*i[11]+s[18]*i[16],e[17]=s[15]*i[2]+s[16]*i[7]+s[17]*i[12]+s[18]*i[17],e[18]=s[15]*i[3]+s[16]*i[8]+s[17]*i[13]+s[18]*i[18],e[19]=s[15]*i[4]+s[16]*i[9]+s[17]*i[14]+s[18]*i[19]+s[19],e},t.prototype._colorMatrix=function(e){var s=new Float32Array(e);return s[4]/=255,s[9]/=255,s[14]/=255,s[19]/=255,s},t.prototype.brightness=function(e,s){var i=[e,0,0,0,0,0,e,0,0,0,0,0,e,0,0,0,0,0,1,0];this._loadMatrix(i,s)},t.prototype.tint=function(e,s){var i=e>>16&255,n=e>>8&255,a=e&255,o=[i/255,0,0,0,0,0,n/255,0,0,0,0,0,a/255,0,0,0,0,0,1,0];this._loadMatrix(o,s)},t.prototype.greyscale=function(e,s){var i=[e,e,e,0,0,e,e,e,0,0,e,e,e,0,0,0,0,0,1,0];this._loadMatrix(i,s)},t.prototype.blackAndWhite=function(e){var s=[.3,.6,.1,0,0,.3,.6,.1,0,0,.3,.6,.1,0,0,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.hue=function(e,s){e=(e||0)/180*Math.PI;var i=Math.cos(e),n=Math.sin(e),a=Math.sqrt,o=1/3,h=a(o),u=i+(1-i)*o,c=o*(1-i)-h*n,l=o*(1-i)+h*n,_=o*(1-i)+h*n,d=i+o*(1-i),f=o*(1-i)-h*n,m=o*(1-i)-h*n,p=o*(1-i)+h*n,T=i+o*(1-i),v=[u,c,l,0,0,_,d,f,0,0,m,p,T,0,0,0,0,0,1,0];this._loadMatrix(v,s)},t.prototype.contrast=function(e,s){var i=(e||0)+1,n=-.5*(i-1),a=[i,0,0,0,n,0,i,0,0,n,0,0,i,0,n,0,0,0,1,0];this._loadMatrix(a,s)},t.prototype.saturate=function(e,s){e===void 0&&(e=0);var i=e*2/3+1,n=(i-1)*-.5,a=[i,n,n,0,0,n,i,n,0,0,n,n,i,0,0,0,0,0,1,0];this._loadMatrix(a,s)},t.prototype.desaturate=function(){this.saturate(-1)},t.prototype.negative=function(e){var s=[-1,0,0,1,0,0,-1,0,1,0,0,0,-1,1,0,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.sepia=function(e){var s=[.393,.7689999,.18899999,0,0,.349,.6859999,.16799999,0,0,.272,.5339999,.13099999,0,0,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.technicolor=function(e){var s=[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,11.793603434377337,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-70.35205161461398,-.231103377548616,-.7501899197440212,1.847597816108189,0,30.950940869491138,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.polaroid=function(e){var s=[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.toBGR=function(e){var s=[0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.kodachrome=function(e){var s=[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,63.72958762196502,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,24.732407896706203,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,35.62982807460946,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.browni=function(e){var s=[.5997023498159715,.34553243048391263,-.2708298674538042,0,47.43192855600873,-.037703249837783157,.8609577587992641,.15059552388459913,0,-36.96841498319127,.24113635128153335,-.07441037908422492,.44972182064877153,0,-7.562075277591283,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.vintage=function(e){var s=[.6279345635605994,.3202183420819367,-.03965408211312453,0,9.651285835294123,.02578397704808868,.6441188644374771,.03259127616149294,0,7.462829176470591,.0466055556782719,-.0851232987247891,.5241648018700465,0,5.159190588235296,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.colorTone=function(e,s,i,n,a){e=e||.2,s=s||.15,i=i||16770432,n=n||3375104;var o=(i>>16&255)/255,h=(i>>8&255)/255,u=(i&255)/255,c=(n>>16&255)/255,l=(n>>8&255)/255,_=(n&255)/255,d=[.3,.59,.11,0,0,o,h,u,e,0,c,l,_,s,0,o-c,h-l,u-_,0,0];this._loadMatrix(d,a)},t.prototype.night=function(e,s){e=e||.1;var i=[e*-2,-e,0,0,0,-e,0,e,0,0,0,e,e*2,0,0,0,0,0,1,0];this._loadMatrix(i,s)},t.prototype.predator=function(e,s){var i=[11.224130630493164*e,-4.794486999511719*e,-2.8746118545532227*e,0*e,.40342438220977783*e,-3.6330697536468506*e,9.193157196044922*e,-2.951810836791992*e,0*e,-1.316135048866272*e,-3.2184197902679443*e,-4.2375030517578125*e,7.476448059082031*e,0*e,.8044459223747253*e,0,0,0,1,0];this._loadMatrix(i,s)},t.prototype.lsd=function(e){var s=[2,-.4,.5,0,0,-.5,2,-.4,0,0,-.4,-.5,3,0,0,0,0,0,1,0];this._loadMatrix(s,e)},t.prototype.reset=function(){var e=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0];this._loadMatrix(e,!1)},Object.defineProperty(t.prototype,"matrix",{get:function(){return this.uniforms.m},set:function(e){this.uniforms.m=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.uniforms.uAlpha},set:function(e){this.uniforms.uAlpha=e},enumerable:!1,configurable:!0}),t}(Wa);Ml.prototype.grayscale=Ml.prototype.greyscale;class fw{constructor(){this._cache=new Map,this.setLastAccessTime(ft())}dispose(){if(this.debugInfo("[dispose]"),!!this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache.clear()}}getDirectionCache(t){const e=this._cache.get(t.toString());return e||null}updateDirectionCache(t,e){this._cache.set(t.toString(),e)}setLastAccessTime(t){this._lastAccessTime=t}getLastAccessTime(){return this._lastAccessTime}debugInfo(t){}}class Qm{constructor(){this._cache=new Map}setAction(t,e){this._currentAction||(this._currentAction=t);const s=this.getActionCache(this._currentAction);s&&s.setLastAccessTime(e),this._currentAction=t}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(t,e){if(!(!this._cache||this._disposed))for(const[s,i]of this._cache.entries()){if(!i)continue;const n=i.getLastAccessTime();e-n>=t&&(i.dispose(),this._cache.delete(s))}}getAction(){return this._currentAction}setDirection(t){this._currentDirection=t}getDirection(){return this._currentDirection}getActionCache(t=null){return this._currentAction?(t||(t=this._currentAction),t.overridingAction?this._cache.get(t.overridingAction):this._cache.get(t.id)):null}updateActionCache(t,e){t.overridingAction?this._cache.set(t.overridingAction,e):this._cache.set(t.id,e)}debugInfo(t){}}class gw{constructor(t,e,s){this._image=t,this._regPoint=e,this._offset=new B(0,0),this._regPoint=e,this._isCacheable=s,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(t){this._regPoint=t,this.cleanPoints()}get image(){return this._image}set image(t){this._image&&this._image!==t&&this._image.destroy({children:!0}),this._image=t}get regPoint(){const t=this._regPoint.clone();return t.x+=this._offset.x,t.y+=this._offset.y,t}set offset(t){this._offset=t,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class Ew{constructor(t){this._partList=t,this._images=new Map}dispose(){for(const t of this._images.values())t&&t.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(t){const e=this._images.get(this.getCacheKey(t));return e||null}updateImageContainer(t,e){const s=this.getCacheKey(e),i=this._images.get(s);i&&i.dispose(),this._images.set(s,t)}getCacheKey(t){let e="";for(const s of this._partList)e+=s.getCacheableKey(t)+"/";return e}debugInfo(t){}}class Zm{constructor(t,e,s,i,n,a=null){this._texture=t,this._container=a,this._rect=e,this._regPoint=s,this._flipH=i,this._colorTransform=n,i&&(this._regPoint.x=-this._regPoint.x+e.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new it(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}class bO{constructor(t,e,s,i){this._structure=t,this._avatar=e,this._assets=s,this._scale=i,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new Vt,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache=null}if(this._unionImages){for(const t of this._unionImages)t&&t.dispose();this._unionImages=[]}}}disposeInactiveActions(t=6e4){const e=ft();if(this._cache)for(const s of this._cache.values())s&&s.disposeActions(t,e)}resetBodyPartCache(t){if(this._cache)for(const e of this._cache.values())e&&e.setAction(t,0)}setDirection(t,e){const s=this._structure.getBodyPartsUnordered(t);if(s)for(const i of s){const n=this.getBodyPartCache(i);n&&n.setDirection(e)}}setAction(t,e){const s=this._structure.getActiveBodyPartIds(t,this._avatar);for(const i of s){const n=this.getBodyPartCache(i);n&&n.setAction(t,e)}}setGeometryType(t){if(this._geometryType!==t){if(this._geometryType===js.SITTING&&t===js.VERTICAL||this._geometryType===js.VERTICAL&&t===js.SITTING||this._geometryType===js.SNOWWARS_HORIZONTAL&&(t=js.SNOWWARS_HORIZONTAL)){this._geometryType=t,this._canvas=null;return}this.disposeInactiveActions(0),this._geometryType=t,this._canvas=null}}getImageContainer(t,e,s=!1){let i=this.getBodyPartCache(t);i||(i=new Qm,this._cache.set(t,i));let n=i.getDirection(),a=i.getAction(),o=e;a.definition.startFromFrameZero&&(o-=a.startFrame);let h=a,u=[],c=new Map;const l=new B;if(!(!a||!a.definition)&&a.definition.isAnimation){let p=n;const T=this._structure.getAnimation(a.definition.state+"."+a.actionParameter),v=e-a.startFrame;if(T){const O=T.getLayerData(v,t,a.overridingAction);O&&(p=n+O.dd,O.dd<0?p<0?p=8+p:p>7&&(p=8-p):p<0?p=p+8:p>7&&(p=p-8),this._scale===cr.LARGE?(l.x=O.dx,l.y=O.dy):(l.x=O.dx/2,l.y=O.dy/2),o=O.animationFrame,O.action&&(a=O.action),O.type===Vs.BODYPART?(O.action!=null&&(h=O.action),n=p):O.type===Vs.FX&&(n=p),c=O.items),u=T.removeData}}let _=i.getActionCache(h);(!_||s)&&(_=new fw,i.updateActionCache(h,_));let d=_.getDirectionCache(n);if(!d||s){const p=this._structure.getParts(t,this._avatar.getFigure(),h,this._geometryType,n,u,this._avatar,c);d=new Ew(p),_.updateDirectionCache(n,d)}let f=d.getImageContainer(o);if(!f||s){const p=d.getPartList();if(f=this.renderBodyPart(n,p,o,a,s),f&&!s)f.isCacheable&&d.updateImageContainer(f,o);else return null}const m=this._structure.getFrameBodyPartOffset(h,n,o,t);return l.x+=m.x,l.y+=m.y,f.offset=l,f}getServerRenderData(){return this._serverRenderData=[],this._serverRenderData}getBodyPartCache(t){let e=this._cache.get(t);return e||(e=new Qm,this._cache.set(t,e)),e}renderBodyPart(t,e,s,i,n=!1){if(!e||!e.length||!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const a=_r.DIRECTION_IS_FLIPPED[t]||!1;let o=i.definition.assetPartDefinition,h=!0,u=e.length-1;for(;u>=0;){const f=e[u];let m=16777215;if(!(t==7&&(f.partType==="fc"||f.partType==="ey"))&&!(f.partType==="ri"&&!f.partId)){const p=f.partId,T=f.getFrameDefinition(s);let v=f.partType,O=0;T?(O=T.number,T.assetPartDefinition&&T.assetPartDefinition!==""&&(o=T.assetPartDefinition)):O=f.getFrameIndex(s);let A=t,y=!1;a&&(o==="wav"&&(v===As.LEFT_HAND||v===As.LEFT_SLEEVE||v===As.LEFT_COAT_SLEEVE)||o==="drk"&&(v===As.RIGHT_HAND||v===As.RIGHT_SLEEVE||v===As.RIGHT_COAT_SLEEVE)||o==="blw"&&v===As.RIGHT_HAND||o==="sig"&&v===As.LEFT_HAND||o==="respect"&&v===As.LEFT_HAND||v===As.RIGHT_HAND_ITEM||v===As.LEFT_HAND_ITEM||v===As.CHEST_PRINT?y=!0:(t===4?A=2:t===5?A=1:t===6&&(A=0),f.flippedPartType!==v&&(v=f.flippedPartType)));let M=this._scale+"_"+o+"_"+v+"_"+p+"_"+A+"_"+O,N=this._assets.getAsset(M);if(N||(M=this._scale+"_std_"+v+"_"+p+"_"+A+"_0",N=this._assets.getAsset(M)),N){const P=N.texture;if(!P||!P.valid||!P.baseTexture)h=!1;else{f.isColorable&&f.color&&(m=f.color.rgb);const b=new B(-N.x,-N.y);if(y&&(b.x=b.x+(this._scale===cr.LARGE?65:31)),n){const D=new SR;D.name=this._assets.getAssetName(M),D.x=-b.x-33,D.y=-b.y,D.z=this._serverRenderData.length*-1e-4,D.width=N.rectangle.width,D.height=N.rectangle.height,D.flipH=y,o==="lay"&&(D.x=D.x+53),a&&(D.flipH=!D.flipH,D.flipH?D.x=-D.x-P.width:D.x=D.x+65),f.isColorable&&(D.color=`${m}`),this._serverRenderData.push(D)}this._unionImages.push(new Zm(P,N.rectangle,b,y,m))}}}u--}if(!this._unionImages.length)return null;const c=this.createUnionImage(this._unionImages,a),l=this._scale===cr.LARGE?this._canvas.height-16:this._canvas.height-8,_=new B(-c.regPoint.x,l-c.regPoint.y);a&&o!=="lay"&&(_.x=_.x+(this._scale===cr.LARGE?67:31));let d=this._unionImages.length-1;for(;d>=0;){const f=this._unionImages.pop();f&&f.dispose(),d--}return new gw(c.container,_,h)}convertColorToHex(t){let e=(t*255).toString(16);return e.length<2&&(e="0"+e),e}createUnionImage(t,e){const s=new it;for(const o of t)o&&s.enlarge(o.offsetRect);const i=new B(-s.x,-s.y),n=new zs,a=new te(_t.EMPTY);a.width=s.width,a.height=s.height,n.addChild(a);for(const o of t){if(!o)continue;const h=o.texture,u=o.colorTransform,c=!(e&&o.flipH)&&(e||o.flipH),l=i.clone();l.x-=o.regPoint.x,l.y-=o.regPoint.y,e&&(l.x=n.width-(l.x+o.rect.width)),c?(this._matrix.a=-1,this._matrix.tx=o.rect.x+o.rect.width+l.x,this._matrix.ty=l.y-o.rect.y):(this._matrix.a=1,this._matrix.tx=l.x-o.rect.x,this._matrix.ty=l.y-o.rect.y);const _=new te(h);_.tint=u,_.transform.setFromMatrix(this._matrix),n.addChild(_)}return new Zm(null,n.getLocalBounds(),i,e,null,n)}}bO.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;const Or=class Pr{constructor(t,e,s,i,n,a=null){this._frameCounter=0,this._directionOffset=0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._fullImageCacheSize=5,this._isCachedImage=!1,this._useFullImageCache=!1,this._effectIdInUse=-1,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=n,this._structure=t,this._assets=e,this._scale=i,this._effectListener=a,this._scale==null&&(this._scale=cr.LARGE),s==null&&(s=new qu("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=s,this._cache=new bO(this._structure,this,this._assets,this._scale),this.setDirection(Pr.DEFAULT_AVATAR_SET,Pr.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new $d(q.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition(Pr.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new de,this._animationFrameCount=0}getServerRenderData(){return this.getAvatarPartsForCamera(Je.FULL),this._cache.getServerRenderData()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const t of this._fullImageCache.getValues())t&&t.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(t){return this._structure.getPartColor(this._figure,t)}setDirection(t,e){e=e+this._directionOffset,e<_r.MIN_DIRECTION&&(e=_r.MAX_DIRECTION+(e+1)),e>_r.MAX_DIRECTION&&(e=e-(_r.MAX_DIRECTION+1)),this._structure.isMainAvatarSet(t)&&(this._mainDirection=e),(t===Je.HEAD||t===Je.FULL)&&(t===Je.HEAD&&this.isHeadTurnPreventedByAction()&&(e=this._mainDirection),this._headDirection=e),this._cache.setDirection(t,e),this._changes=!0}setDirectionAngle(t,e){this.setDirection(t,Math.floor(e/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(t){return this._structure.getBodyPartData(t.animation.id,this._frameCounter,t.id)}updateAnimationByFrames(t=1){this._frameCounter+=t,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(this._sortedActions.length==1&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(this._sortedActions.length==2)for(const t of this._sortedActions){if(t.actionType=="fx"&&(t.actionParameter=="33"||t.actionParameter=="34"||t.actionParameter=="35"||t.actionParameter=="36"))return this._mainDirection+this._currentActionsString+0;if(t.actionType=="fx"&&(t.actionParameter=="38"||t.actionParameter=="39"))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if(t.actionType==="dance"&&(t.actionParameter==="1"||t.actionParameter==="2"||t.actionParameter==="3"||t.actionParameter==="4")){let e=this._frameCounter%8;return t.actionParameter==="3"&&(e=this._frameCounter%10),t.actionParameter==="4"&&(e=this._frameCounter%16),this._mainDirection+t.actionType+t.actionParameter+e}}return null}getBodyParts(t,e,s){return(s!=this._cachedBodyPartsDirection||e!=this._cachedBodyPartsGeometryType||t!=this._cachedBodyPartsAvatarSet)&&(this._cachedBodyPartsDirection=s,this._cachedBodyPartsGeometryType=e,this._cachedBodyPartsAvatarSet=t,this._cachedBodyParts=this._structure.getBodyParts(t,e,s)),this._cachedBodyParts}getAvatarPartsForCamera(t){let e;if(this._mainAction==null||this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType)==null)return;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection);let n=i.length-1;for(;n>=0;)e=i[n],this._cache.getImageContainer(e,this._frameCounter,!0),n--}getImage(t,e,s=1,i=!0){if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const n=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!n)return null;this._image&&(this._image.width!==n.width||this._image.height!==n.height)&&(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const a=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection);this._image=null;const o=new zs;let h=!0,u=a.length-1;for(;u>=0;){const c=a[u],l=this._cache.getImageContainer(c,this._frameCounter);if(l){const _=l.image;if(!_)return o.destroy({children:!0}),null;h=h&&l.isCacheable;const d=l.regPoint.clone();if(d){d.x+=n.offset.x,d.y+=n.offset.y,d.x+=n.regPoint.x,d.y+=n.regPoint.y;const f=new zs;f.addChild(_),f&&(f.position.set(d.x,d.y),o.addChild(f))}}u--}return this._avatarSpriteData&&(o.filters||(o.filters=[]),this._avatarSpriteData.colorTransform&&o.filters.push(this._avatarSpriteData.colorTransform),this._avatarSpriteData.paletteIsGrayscale&&(this.convertToGrayscale(o),o.filters.push(new km(this._avatarSpriteData.reds,km.CHANNEL_RED)))),i?(this._reusableTexture?(Me.instance.renderer.render(o,{renderTexture:this._reusableTexture,clear:!0}),this._reusableTexture.baseTexture.hitMap=null):this._reusableTexture=Qt.generateTexture(o,new it(0,0,n.width,n.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):Qt.generateTexture(o,new it(0,0,n.width,n.height))}applyPalette(t,e=[],s=[],i=[]){const n=Qt.generateCanvas(t),a=n.getContext("2d"),o=a.getImageData(0,0,n.width,n.height),h=o.data;for(let c=0;c<h.length;c+=4){if(e.length==256){let l=e[h[c]];l===void 0&&(l=0),h[c]=l>>16&255,h[c+1]=l>>8&255,h[c+2]=l&255}if(s.length==256){let l=s[h[c+1]];l===void 0&&(l=0),h[c]=l>>16&255,h[c+1]=l>>8&255,h[c+2]=l&255}if(i.length==256){let l=s[h[c+2]];l===void 0&&(l=0),h[c]=l>>16&255,h[c+1]=l>>8&255,h[c+2]=l&255}}a.putImageData(o,0,0);const u=new Kt(_t.from(n));return Me.instance.renderer.render(u,{renderTexture:t,clear:!0}),t}getImageAsSprite(t,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection),n=new te,a=new te(_t.EMPTY);a.width=s.width,a.height=s.height,n.addChild(a);let o=i.length-1;for(;o>=0;){const h=i[o],u=this._cache.getImageContainer(h,this._frameCounter);if(u){const c=u.image;if(!c)return n.destroy({children:!0}),null;const l=u.regPoint.clone();if(l){l.x+=s.offset.x,l.y+=s.offset.y,l.x+=s.regPoint.x,l.y+=s.regPoint.y;const _=new zs;_.addChild(c),_.position.set(l.x,l.y),n.addChild(_)}}o--}return n}getCroppedImage(t,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection),n=new zs;let a=i.length-1;for(;a>=0;){const u=i[a],c=this._cache.getImageContainer(u,this._frameCounter);if(c){const l=c.image;if(!l)return n.destroy({children:!0}),null;const _=c.regPoint.clone();if(_){_.x+=s.offset.x,_.y+=s.offset.y,_.x+=s.regPoint.x,_.y+=s.regPoint.y;const d=new zs;d.addChild(l),d&&(d.position.set(_.x,_.y),n.addChild(d))}}a--}const o=Qt.generateTexture(n,new it(0,0,s.width,s.height)),h=Qt.generateImage(o);return h||null}getFullImage(t){const e=this._fullImageCache.getValue(t);return e?(e.valid||(this._fullImageCache.remove(t),e.destroy(!0)),e):null}cacheFullImage(t,e){const s=this._fullImageCache.getValue(t);if(s&&(this._fullImageCache.remove(t),s.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const i=this._fullImageCache.getKey(0);i&&this._fullImageCache.remove(i).destroy(!0)}this._fullImageCache.add(t,e)}getAsset(t){return this._assets.getAsset(t)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const t of this._sortedActions)t.actionType===q.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(t.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(t.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(t,...e){let s="";switch(this._actionsSorted=!1,e&&e.length>0&&(s=e[0]),s!=null&&(s=s.toString()),t){case q.POSTURE:switch(s){case q.POSTURE_LAY:case q.POSTURE_WALK:case q.POSTURE_STAND:case q.POSTURE_SWIM:case q.POSTURE_FLOAT:case q.POSTURE_SIT:case q.SNOWWAR_RUN:case q.SNOWWAR_DIE_FRONT:case q.SNOWWAR_DIE_BACK:case q.SNOWWAR_PICK:case q.SNOWWAR_THROW:(s===q.POSTURE_LAY||s===q.POSTURE_LAY||s===q.POSTURE_LAY)&&(s===q.POSTURE_LAY&&(this._mainDirection==0?this.setDirection(Je.FULL,4):this.setDirection(Je.FULL,2)),this._useFullImageCache=!0,this._useFullImageCache=!0),this.addActionData(s);break}break;case q.GESTURE:switch(s){case q.GESTURE_AGGRAVATED:case q.GESTURE_SAD:case q.GESTURE_SMILE:case q.GESTURE_SURPRISED:this.addActionData(s);break}break;case q.EFFECT:case q.DANCE:case q.TALK:case q.EXPRESSION_WAVE:case q.SLEEP:case q.SIGN:case q.EXPRESSION_RESPECT:case q.EXPRESSION_BLOW_A_KISS:case q.EXPRESSION_LAUGH:case q.EXPRESSION_CRY:case q.EXPRESSION_IDLE:case q.EXPRESSION_SNOWBOARD_OLLIE:case q.EXPRESSION_SNOWBORD_360:case q.EXPRESSION_RIDE_JUMP:s===q.EFFECT&&(s==="33"||s==="34"||s==="35"||s==="36"||s==="38"||s==="39")&&(this._useFullImageCache=!0),this.addActionData(t,s);break;case q.CARRY_OBJECT:case q.USE_OBJECT:{const i=this._structure.getActionDefinitionWithState(t);i&&(s=i.getParameterValue(s)),this.addActionData(t,s);break}}return!0}addActionData(t,e=""){let s;this._actions||(this._actions=[]);let i=0;for(;i<this._actions.length;){if(s=this._actions[i],s.actionType==t&&s.actionParameter==e)return;i++}this._actions.push(new $d(t,e,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let t,e;if(this._sortedActions==null)return!1;for(const s of this._sortedActions)t=this._structure.getActionDefinitionWithState(s.actionType),t!=null&&t.getPreventHeadTurn(s.actionParameter)&&(e=!0);return e}sortActions(){let t,e,s;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),!this._sortedActions)this._canvasOffsets=[0,0,0],this._lastActionsString!==""&&(s=!0,this._lastActionsString="");else{this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const i of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(i.actionType+i.actionParameter),i.actionType===q.EFFECT){const n=parseInt(i.actionParameter);this._effectIdInUse!==n&&(t=!0),this._effectIdInUse=n,e=!0}e||(this._effectIdInUse>-1&&(t=!0),this._effectIdInUse=-1),t&&this._cache.disposeInactiveActions(0),this._lastActionsString!=this._currentActionsString&&(s=!0,this._lastActionsString=this._currentActionsString)}return this._actionsSorted=!0,s}setActionsToParts(){if(!this._sortedActions==null)return;const t=ft(),e=[];for(const s of this._sortedActions)e.push(s.actionType);for(const s of this._sortedActions)if(s&&s.definition&&s.definition.isAnimation){const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);if(i&&i.hasOverriddenActions()){const n=i.overriddenActionNames();if(n)for(const a of n)e.indexOf(a)>=0&&(s.overridingAction=i.overridingAction(a))}i&&i.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const s of this._sortedActions)if(!(!s||!s.definition)&&(s.definition.isAnimation&&s.actionParameter===""&&(s.actionParameter="1"),this.setActionToParts(s,t),s.definition.isAnimation)){this._isAnimating=s.definition.isAnimated(s.actionParameter);const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);i&&(this._sprites=this._sprites.concat(i.spriteData),i.hasDirectionData()&&(this._directionOffset=i.directionData.offset),i.hasAvatarData()&&(this._avatarSpriteData=i.avatarData))}}setActionToParts(t,e){t==null||t.definition==null||t.definition.assetPartDefinition!=""&&(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.setAction(t,e),this._changes=!0)}resetBodyPartCache(t){t&&t.definition.assetPartDefinition!==""&&(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.resetBodyPartCache(t),this._changes=!0)}get avatarSpriteData(){return this._avatarSpriteData}convertToGrayscale(t,e="CHANNELS_EQUAL"){let s=.33,i=.33,n=.33;switch(e){case Pr.CHANNELS_UNIQUE:s=.3,i=.59,n=.11;break;case Pr.CHANNELS_RED:s=1,i=0,n=0;break;case Pr.CHANNELS_GREEN:s=0,i=1,n=0;break;case Pr.CHANNELS_BLUE:s=0,i=0,n=1;break;case Pr.CHANNELS_DESATURATED:s=.3086,i=.6094,n=.082;break}const a=new Ml;return a.matrix=[s,i,n,0,0,s,i,n,0,0,s,i,n,0,0,0,0,0,1,0],t.filters.push(a),t}errorThis(t){}logThis(t){}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}get mainAction(){return this._mainAction.actionType}resetEffect(t){t===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(t))}};Or.CHANNELS_EQUAL="CHANNELS_EQUAL";Or.CHANNELS_UNIQUE="CHANNELS_UNIQUE";Or.CHANNELS_RED="CHANNELS_RED";Or.CHANNELS_GREEN="CHANNELS_GREEN";Or.CHANNELS_BLUE="CHANNELS_BLUE";Or.CHANNELS_DESATURATED="CHANNELS_DESATURATED";Or.DEFAULT_ACTION="Default";Or.DEFAULT_DIRECTION=2;Or.DEFAULT_AVATAR_SET=Je.FULL;let PO=Or;class Qu{constructor(t){this._number=t.number,this._assetPartDefinition=t.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class pw{constructor(t){if(this._frames=[],t.frames&&t.frames.length>0)for(const e of t.frames){if(!e)continue;this._frames.push(new Qu(e));let s=e.repeats||0;if(s>1)for(;--s>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}const DO=class Zu{constructor(t){if(this._id=t.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],t.parts&&t.parts.length>0)for(const e of t.parts){if(!e)continue;const s=new pw(e);this._actionParts.set(e.setType,s),this._frameCount=Math.max(this._frameCount,s.frames.length)}if(t.offsets&&t.offsets.frames&&t.offsets.frames.length>0)for(const e of t.offsets.frames){if(!e)continue;const s=e.id;this._frameCount=Math.max(this._frameCount,s);const i=new Map;if(this._bodyPartOffsets.set(s,i),e.directions&&e.directions.length>0)for(const n of e.directions){if(!n)continue;const a=n.id,o=new Map;if(i.set(a,o),n.bodyParts&&n.bodyParts.length>0)for(const h of n.bodyParts){if(!h)continue;const u=h.id;let c=0,l=0;h.dx!==void 0&&(c=h.dx),h.dy!==void 0&&(l=h.dy),o.set(u,new B(c,l))}}if(this._frameIndexes.push(s),e.repeats!==void 0){let n=e.repeats||0;if(n>1)for(;--n>0;)this._frameIndexes.push(s)}}}getPart(t){if(!t)return null;const e=this._actionParts.get(t);return e||null}getFrameBodyPartOffset(t,e,s){const i=e%this._frameIndexes.length,n=this._frameIndexes[i],a=this._bodyPartOffsets.get(n);if(!a)return Zu.DEFAULT_OFFSET;const o=a.get(t);if(!o)return Zu.DEFAULT_OFFSET;const h=o.get(s);return h||Zu.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}};DO.DEFAULT_OFFSET=new B(0,0);let sf=DO;class mw{constructor(){this._actions=new Map}parse(t){if(t&&t.length>0)for(const e of t){if(!e)continue;const s=new sf(e);this._actions.set(s.id,s)}return!0}appendJSON(t){for(const e of t.action)this._actions.set(e.id,new sf(e));return!0}getAction(t){const e=this._actions.get(t.id);return e||null}getFrameCount(t){const e=this.getAction(t);return e?e.frameCount:0}}class Iw{constructor(t,e){this._id=t.id,this._width=t.width,this._height=t.height,this._offset=new B(t.dx,t.dy),e==cr.LARGE?this._regPoint=new B((this._width-64)/2,0):this._regPoint=new B((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}const LO=class UO extends vs{constructor(t,e){super(),this._dataReceiver=e,this.download(t)}download(t){const e=new XMLHttpRequest;try{e.open("GET",t),e.send(),e.onloadend=s=>{const i=e.responseText;if(!i||!i.length)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver.appendJSON(JSON.parse(i)),this.dispatchEvent(new It(UO.AVATAR_STRUCTURE_DONE))},e.onerror=s=>{throw new Error("invalid_avatar_figure_data")}}catch(s){Y.error(s)}}};LO.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE";let Jm=LO;class Tw{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._type=t.type,this._index=t.index,this._colorLayerIndex=t.colorindex,this._paletteMapId=-1,this._breed=-1}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class Rw{constructor(t,e){if(!t||!e)throw new Error("invalid_data");this._id=e.id,this._type=t,this._gender=e.gender,this._clubLevel=e.club,this._isColorable=e.colorable,this._isSelectable=e.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=e.preselectable,this._isSellable=e.sellable;for(const s of e.parts){const i=new Tw(s),n=this.getPartIndex(i);n!==-1?this._parts.splice(n,0,i):this._parts.push(i)}if(e.hiddenLayers)for(const s of e.hiddenLayers)this._hiddenLayers.push(s.partType)}dispose(){for(const t of this._parts)t.dispose();this._parts=null,this._hiddenLayers=null}getPartIndex(t){const e=this._parts.length;if(!e)return-1;for(let s=0;s<e;s++){const i=this._parts[s];if(i&&!(i.type!==t.type||i.index>t.index))return s}return-1}getPart(t,e){for(const s of this._parts)if(!(s.type!==t||s.id!==e))return s;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class Ow{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._index=t.index,this._clubLevel=t.club||0,this._isSelectable=t.selectable,this._rgb=parseInt("0x"+t.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class $m{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._colors=new de,this.append(t)}append(t){for(const e of t.colors){const s=new Ow(e);this._colors.add(e.id.toString(),s)}}getColor(t){return t===void 0||t<0?null:this._colors.getValue(t.toString())||null}get id(){return this._id}get colors(){return this._colors}}class Vc{constructor(t){if(!t)throw new Error("invalid_data");this._type=t.type,this._paletteId=t.paletteId,this._isMandatory={},this._isMandatory.F=[t.mandatory_f_0,t.mandatory_f_1],this._isMandatory.M=[t.mandatory_m_0,t.mandatory_m_1],this._partSets=new de,this.append(t)}dispose(){for(const t of this._partSets.getValues())t.dispose();this._partSets=null}cleanUp(t){for(const e of t.sets){const s=e.id.toString(),i=this._partSets.getValue(s);i&&(i.dispose(),this._partSets.remove(s))}}append(t){if(!(!t||!t.sets))for(const e of t.sets)this._partSets.add(e.id.toString(),new Rw(this._type,e))}getDefaultPartSet(t){for(const e of this._partSets.getValues())if(e&&e.clubLevel===0&&(e.gender===t||e.gender==="U"))return e;return null}getPartSet(t){return this._partSets.getValue(t.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(t,e){return this._isMandatory[t.toUpperCase()][Math.min(e,1)]}optionalFromClubLevel(t){return this._isMandatory[t.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class vw{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(t){if(!t)return!1;for(const e of t.palettes){const s=new $m(e);s&&this._palettes.set(s.id.toString(),s)}for(const e of t.setTypes){const s=new Vc(e);s&&this._setTypes.set(s.type,s)}return!0}injectJSON(t){for(const e of t.setTypes){const s=this._setTypes.get(e.type);s?s.cleanUp(e):this._setTypes.set(e.type,new Vc(e))}this.appendJSON(t)}appendJSON(t){if(!t)return!1;for(const e of t.palettes){const s=e.id.toString(),i=this._palettes.get(s);i?i.append(e):this._palettes.set(s,new $m(e))}for(const e of t.setTypes){const s=e.type,i=this._setTypes.get(s);i?i.append(e):this._setTypes.set(s,new Vc(e))}return!1}getMandatorySetTypeIds(t,e){const s=[];for(const i of this._setTypes.values())!i||!i.isMandatory(t,e)||s.push(i.type);return s}getDefaultPartSet(t,e){const s=this._setTypes.get(t);return s?s.getDefaultPartSet(e):null}getSetType(t){return this._setTypes.get(t)||null}getPalette(t){return this._palettes.get(t.toString())||null}getFigurePartSet(t){for(const e of this._setTypes.values()){const s=e.getPartSet(t);if(s)return s}return null}}class tI{constructor(t){if(this._id=t.id,this._parts=[],t.activeParts&&t.activeParts.length>0)for(const e of t.activeParts)e&&this._parts.push(e.setType)}get parts(){return this._parts}}class kc{constructor(t){if(!t)throw new Error("invalid_data");this._setType=t.setType,this._flippedSetType=t.flippedSetType||null,this._removeSetType=t.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(t){this._staticId=t}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(t){this._flippedSetType=t}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(t){this._appendToFigure=t}}class Aw{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new kc(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new tI(e));return!0}appendJSON(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new kc(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new tI(e));return!1}getActiveParts(t){const e=this._activePartSets.get(t.activePartSet);return e?e.parts:[]}getPartDefinition(t){const e=this._parts.get(t);return e||null}addPartDefinition(t){const e=t.setType;let s=this._parts.get(e);return s||(s=new kc(t),this._parts.set(e,s)),s}getActivePartSet(t){const e=this._activePartSets.get(t.activePartSet);return e||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class jc{constructor(t,e,s,i,n,a,o,h,u="",c=!1,l=1){this._bodyPartId=t,this._partType=e,this._partId=s,this._color=i,this._frames=n,this._action=a,this._isColorable=o,this._paletteMapId=h,this._flippedPartType=u,this._isBlendable=c,this._blendTransform=null,this._partType==="ey"&&(this._isColorable=!1)}getFrameIndex(t){if(!this._frames||!this._frames.length)return 0;const e=t%this._frames.length;return this._frames[e]instanceof Qu?this._frames[e].number:e}getFrameDefinition(t){const e=t%this._frames.length;return this._frames&&this._frames.length>e&&this._frames[e]instanceof Qu?this._frames[e]:null}getCacheableKey(t){const e=t%this._frames.length;if(this._frames&&this._frames.length>e&&this._frames[e]instanceof Qu){const s=this._frames[e];return this.partId+":"+s.assetPartDefinition+":"+s.number}return this.partId+":"+e}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(t){this._isColorable=t}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}const Ee=class Wt{constructor(){this._gender="M",this._avatarEffectType=-1}loadAvatarData(t,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(t)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}parseFigureString(t){if(t)for(const e of t.split(".")){const s=e.split("-");if(s.length>0){const i=s[0],n=parseInt(s[1]),a=[];let o=2;for(;o<s.length;)a.push(parseInt(s[o])),o++;a.length||a.push(0),this.savePartSetId(i,n,!1),this.savePartSetColourId(i,a,!1)}}}hasSetType(t){return!!this._data.get(t)}getPartSetId(t){return this.hasSetType(t)?this._data.get(t):-1}getColourIds(t){return this._colors.get(t)?this._colors.get(t):[]}getFigureString(){let t="";const e=[];for(const[i,n]of this._data.entries()){let a=i+"-"+n;const o=this._colors.get(i);if(o)for(const h of o)a=a+("-"+h);e.push(a)}let s=0;for(;s<e.length;)t=t+e[s],s<e.length-1&&(t=t+"."),s++;return t}savePartData(t,e,s,i=!1){this.savePartSetId(t,e,i),this.savePartSetColourId(t,s,i)}savePartSetId(t,e,s=!0){switch(t){case Wt.HD:case Wt.HAIR:case Wt.HAT:case Wt.HEAD_ACCESSORIES:case Wt.EYE_ACCESSORIES:case Wt.FACE_ACCESSORIES:case Wt.SHIRT:case Wt.JACKET:case Wt.CHEST_ACCESSORIES:case Wt.CHEST_PRINTS:case Wt.TROUSERS:case Wt.SHOES:case Wt.TROUSER_ACCESSORIES:e>=0?this._data.set(t,e):this._data.delete(t)}}savePartSetColourId(t,e,s=!0){switch(t){case Wt.HD:case Wt.HAIR:case Wt.HAT:case Wt.HEAD_ACCESSORIES:case Wt.EYE_ACCESSORIES:case Wt.FACE_ACCESSORIES:case Wt.SHIRT:case Wt.JACKET:case Wt.CHEST_ACCESSORIES:case Wt.CHEST_PRINTS:case Wt.TROUSERS:case Wt.SHOES:case Wt.TROUSER_ACCESSORIES:this._colors.set(t,e);return}}getFigureStringWithFace(t){const e=[Wt.HD];let s="";const i=[];for(const a of e){const o=this._colors.get(a);if(o){let h=this._data.get(a);a===Wt.HD&&(h=t);let u=a+"-"+h;if(h>=0){let c=0;for(;c<o.length;)u=u+("-"+o[c]),c++}i.push(u)}}let n=0;for(;n<i.length;)s=s+i[n],n<i.length-1&&(s=s+"."),n++;return s}get gender(){return this._gender}};Ee.MALE="M";Ee.FEMALE="F";Ee.UNISEX="U";Ee.SCALE="h";Ee.STD="std";Ee.DEFAULT_FRAME="0";Ee.HD="hd";Ee.HAIR="hr";Ee.HAT="ha";Ee.HEAD_ACCESSORIES="he";Ee.EYE_ACCESSORIES="ea";Ee.FACE_ACCESSORIES="fa";Ee.JACKET="cc";Ee.SHIRT="ch";Ee.CHEST_ACCESSORIES="ca";Ee.CHEST_PRINTS="cp";Ee.TROUSERS="lg";Ee.SHOES="sh";Ee.TROUSER_ACCESSORIES="wa";Ee.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];let Sw=Ee;class wst{constructor(t){this._data=[],this._maxSize=t,this._index=0}reset(){this._data=[],this._index=0}addValue(t){this._data.length<this._maxSize?this._data.push(t):this._data[this._index]=t,this._index=(this._index+1)%this._maxSize}getMax(){let t=Number.MIN_VALUE,e=0;for(;e<this._maxSize;)this._data[e]>t&&(t=this._data[e]),e++;return t}getMin(){let t=Number.MAX_VALUE,e=0;for(;e<this._maxSize;)this._data[e]<t&&(t=this._data[e]),e++;return t}}class ge{constructor(t,e){this._location=t,this._direction=e}get location(){return this._location}get direction(){return this._direction}}class c_ extends ds{constructor(){super(),this._object=null,this._events=null,this._time=0}initialize(t){}onDispose(){this._object=null}update(t){this._time=t}processUpdateMessage(t){!t||!this._object||(this._object.setLocation(t.location),this._object.setDirection(t.direction))}getEventTypes(){return[]}mergeTypes(t,e){const s=t.concat();for(const i of e)!i||s.indexOf(i)>=0||s.push(i);return s}mouseEvent(t,e){}useObject(){}setObject(t){if(this._object!==t){if(this._object&&this._object.setLogic(null),!t){this.dispose(),this._object=null;return}this._object=t,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(t){this._events=t}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}class xO{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(t){return this._map.get(t)}setValue(t,e){this._map.has(t)&&this._map.get(t)===e||(this._map.set(t,e),this._updateCounter++)}removeKey(t){t&&(this._map.delete(t),this._updateCounter++)}get updateCounter(){return this._updateCounter}}const FO=class wO extends ds{constructor(t,e,s){super(),this._id=t,this._instanceId=wO.OBJECT_COUNTER++,this._type=s,this._model=new xO,this._location=new S,this._direction=new S,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let i=e-1;for(;i>=0;)this._states[i]=0,i--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(t){t&&(t.x===this._location.x&&t.y===this._location.y&&t.z===this._location.z||(this._location.x=t.x,this._location.y=t.y,this._location.z=t.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(t){t&&(t.x===this._direction.x&&t.y===this._direction.y&&t.z===this._direction.z||(this._direction.x=(t.x%360+360)%360,this._direction.y=(t.y%360+360)%360,this._direction.z=(t.z%360+360)%360,this._updateCounter++))}getState(t=0){return t>=0&&t<this._states.length?this._states[t]:-1}setState(t,e=0){return e>=0&&e<this._states.length?(this._states[e]!==t&&(this._states[e]=t,this._updateCounter++),!0):!1}setVisualization(t){this._visualization!==t&&(this._visualization&&this._visualization.dispose(),this._visualization=t,this._visualization&&(this._visualization.object=this))}setLogic(t){if(this._logic===t)return;const e=this._logic;if(e&&(this._logic=null,e.setObject(null)),this._logic=t,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const s=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(s)}}processUpdateMessage(t){if(this._logic)return this._logic.processUpdateMessage(t);this._pendingLogicMessages.push(t)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(t){this._updateCounter=t}get isReady(){return this._isReady}set isReady(t){this._isReady=t}};FO.OBJECT_COUNTER=0;let yw=FO;const GO=class BO{constructor(){this._id=BO.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=as.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=tt.NORMAL,this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=bs.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0,this._updateContainer=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name!==t&&(this._name=t,this._updateCounter++)}get type(){return this._type}set type(t){this._type=t}get spriteType(){return this._spriteType}set spriteType(t){this._spriteType=t}get texture(){return this._texture}set texture(t){this._texture!==t&&(t&&(this._width=t.width,this._height=t.height),this._texture=t,this._updateCounter++)}get container(){return this._container}set container(t){this._container!==t&&(this.texture=_t.EMPTY,t&&(this._width=t.width,this._height=t.height),this._container=t,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX!==t&&(this._offsetX=t,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY!==t&&(this._offsetY=t,this._updateCounter++)}get flipH(){return this._flipH}set flipH(t){this._flipH!==t&&(this._flipH=t,this._updateCounter++)}get flipV(){return this._flipV}set flipV(t){this._flipV!==t&&(this._flipV=t,this._updateCounter++)}get direction(){return this._direction}set direction(t){this._direction=t}get alpha(){return this._alpha}set alpha(t){t=t&255,this._alpha!==t&&(this._alpha=t,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode!==t&&(this._blendMode=t,this._updateCounter++)}get color(){return this._color}set color(t){t=t&16777215,this._color!==t&&(this._color=t,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth!==t&&(this._relativeDepth=t,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){t!==this._varyingDepth&&(this._varyingDepth=t,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(t){this._libraryAssetName=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateCounter++)}get tag(){return this._tag}set tag(t){this._tag!==t&&(this._tag=t,this._updateCounter++)}get posture(){return this._posture}set posture(t){this._posture!==t&&(this._posture=t,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance!==t&&(this._alphaTolerance=t,this._updateCounter++)}get filters(){return this._filters}set filters(t){this._filters=t,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(t){this._updateContainer=t}};GO.SPRITE_COUNTER=0;let eI=GO;const HO=class VO{constructor(){this._id=VO.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(t){return!1}update(t,e,s,i){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const t=this._sprites[0];t&&t.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(t){return t>=0&&t<this._sprites.length?this._sprites[t]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(t){const e=new eI;return t>=this._sprites.length?this._sprites.push(e):this._sprites.splice(t,0,e),e}createSprites(t){for(;this._sprites.length>t;){const e=this._sprites[this._sprites.length-1];e&&e.dispose(),this._sprites.pop()}for(;this._sprites.length<t;)this._sprites.push(new eI)}get image(){return this.getImage(0,-1)}getImage(t,e){const s=this.getBoundingRectangle();if(s.width*s.height===0)return null;const i=this.totalSprites,n=[];let a=0;for(;a<i;){const u=this.getSprite(a);u&&u.visible&&u.texture&&n.push(u),a++}n.sort((u,c)=>c.relativeDepth-u.relativeDepth);const o=new zs;for(a=0;a<n.length;){const u=n[a],c=u.texture;if(c){const l=new te(c);l.alpha=u.alpha/255,l.tint=u.color,l.x=u.offsetX,l.y=u.offsetY,l.blendMode=u.blendMode,l.filters=u.filters,u.flipH&&(l.scale.x=-1),u.flipV&&(l.scale.y=-1),o.addChild(l)}a++}const h=Qt.generateTexture(o);return h||null}getBoundingRectangle(){const t=this.totalSprites,e=new it;let s=0;for(;s<t;){const i=this.getSprite(s);if(i&&i.texture&&i.visible){const n=i.flipH?-i.width+i.offsetX:i.offsetX,a=i.flipV?-i.height+i.offsetY:i.offsetY,o=new B(n,a);s===0?(e.x=o.x,e.y=o.y,e.width=i.width,e.height=i.height):(o.x<e.x&&(e.x=o.x),o.y<e.y&&(e.y=o.y),o.x+i.width>e.right&&(e.width=o.x+i.width-e.x),o.y+i.height>e.bottom&&(e.height=o.y+i.height-e.y))}s++}return e}get instanceId(){return this._id}get object(){return this._object}set object(t){this._object=t}get asset(){return this._asset}set asset(t){this._asset&&this._asset.removeReference(),this._asset=t,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(t){this._updateObjectCounter=t}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(t){this._updateModelCounter=t}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(t){this._updateSpriteCounter=t}get spriteCount(){return this._sprites.length}};HO.VISUALIZATION_COUNTER=0;let d_=HO;class Mw{constructor(t){this._roomObjectVariableAccurateZ=t||"",this._location=new S,this._screenLocation=new S,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(t,e){if(!t||!e)return null;let s=!1;const i=t.getLocation();if((e.updateId!==this._geometryUpdateId||t.updateCounter!==this._objectUpdateId)&&(this._objectUpdateId=t.updateCounter,(e.updateId!==this._geometryUpdateId||i.x!==this._location.x||i.y!==this._location.y||i.z!==this._location.z)&&(this._geometryUpdateId=e.updateId,this._location.assign(i),s=!0)),this._locationChanged=s,this._locationChanged){const n=e.getScreenPosition(i);if(!n)return null;const a=t.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(a)||a===0){const o=new S(Math.round(i.x),Math.round(i.y),i.z);if(o.x!==i.x||o.y!==i.y){const h=e.getScreenPosition(o);this._screenLocation.assign(n),h&&(this._screenLocation.z=h.z)}else this._screenLocation.assign(n)}else this._screenLocation.assign(n);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class Cw{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this.setSpriteCount(0)}addSprite(t){this._sprites.push(t)}getSprite(t){return this._sprites[t]}get sprites(){return this._sprites}needsUpdate(t,e){return t===this._updateId1&&e===this._updateId2?!1:(this._updateId1=t,this._updateId2=e,!0)}setSpriteCount(t){if(t<this._sprites.length){let e=t;for(;e<this._sprites.length;){const s=this._sprites[e];s&&s.dispose(),e++}this._sprites.splice(t,this._sprites.length-t)}this._isEmpty=!this._sprites.length}}class Nw{constructor(t){this._location=new Mw(t),this._sprites=new Cw}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(t){this._objectId=t}}const kO=class rf{constructor(t){this._data=new Map,this._roomObjectVariableAccurateZ=t}dispose(){if(this._data){for(const[t,e]of this._data.entries())e&&(this._data.delete(t),e.dispose());this._data=null}}getObjectCache(t){let e=this._data.get(t);return e||(e=new Nw(this._roomObjectVariableAccurateZ),this._data.set(t,e)),e}removeObjectCache(t){const e=this._data.get(t);e&&(this._data.delete(t),e.dispose())}getSortableSpriteList(){const t=[];for(const e of this._data.values()){if(!e)continue;const s=e.sprites&&e.sprites.sprites;if(!(!s||!s.length)){for(const i of s)if(i&&i.sprite.spriteType!==as.ROOM_PLANE&&i.sprite.name!==""){const n=new SR;n.objectId=e.objectId,n.x=i.x,n.y=i.y,n.z=i.z,n.name=i.sprite.name||"",n.flipH=i.sprite.flipH,n.alpha=i.sprite.alpha,n.color=i.sprite.color.toString(),n.blendMode=i.sprite.blendMode.toString(),n.width=i.sprite.width,n.height=i.sprite.height,n.type=i.sprite.type,n.posture=i.sprite.posture;const a=this.isSkewedSprite(i.sprite);a&&(n.skew=i.sprite.direction%4===0?-.5:.5),(a||i.name.indexOf("%image.library.url%")>=0||i.name.indexOf("%group.badge.url%")>=0)&&n.width<=rf.MAX_SIZE_FOR_AVG_COLOR&&n.height<=rf.MAX_SIZE_FOR_AVG_COLOR&&i.sprite.name.indexOf("external_image_wallitem")===0&&(n.frame=!0),t.push(n)}}}return!t||!t.length?null:t}isSkewedSprite(t){return t.type?t.type.indexOf("external_image_wallitem")===0&&t.tag==="THUMBNAIL"||t.type.indexOf("guild_forum")===0&&t.tag==="THUMBNAIL":!1}getPlaneSortableSprites(){const t=[];for(const e of this._data.values())for(const s of e.sprites.sprites)s.sprite.spriteType===as.ROOM_PLANE&&t.push(s);return t}};kO.MAX_SIZE_FOR_AVG_COLOR=200;let bw=kO;/*!
 * @pixi/graphics - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/graphics is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var qr;(function(r){r.MITER="miter",r.BEVEL="bevel",r.ROUND="round"})(qr||(qr={}));var Li;(function(r){r.BUTT="butt",r.ROUND="round",r.SQUARE="square"})(Li||(Li={}));var gh={adaptive:!0,maxLength:10,minSegments:8,maxSegments:2048,epsilon:1e-4,_segmentsCount:function(r,t){if(t===void 0&&(t=20),!this.adaptive||!r||isNaN(r))return t;var e=Math.ceil(r/this.maxLength);return e<this.minSegments?e=this.minSegments:e>this.maxSegments&&(e=this.maxSegments),e}},jO=function(){function r(){this.color=16777215,this.alpha=1,this.texture=_t.WHITE,this.matrix=null,this.visible=!1,this.reset()}return r.prototype.clone=function(){var t=new r;return t.color=this.color,t.alpha=this.alpha,t.texture=this.texture,t.matrix=this.matrix,t.visible=this.visible,t},r.prototype.reset=function(){this.color=16777215,this.alpha=1,this.texture=_t.WHITE,this.matrix=null,this.visible=!1},r.prototype.destroy=function(){this.texture=null,this.matrix=null},r}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var nf=function(r,t){return nf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},nf(r,t)};function Kg(r,t){nf(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}function sI(r,t){var e,s;t===void 0&&(t=!1);var i=r.length;if(!(i<6)){for(var n=0,a=0,o=r[i-2],h=r[i-1];a<i;a+=2){var u=r[a],c=r[a+1];n+=(u-o)*(c+h),o=u,h=c}if(!t&&n>0||t&&n<=0)for(var l=i/2,a=l+l%2;a<i;a+=2){var _=i-a-2,d=i-a-1,f=a,m=a+1;e=[r[f],r[_]],r[_]=e[0],r[f]=e[1],s=[r[m],r[d]],r[d]=s[0],r[m]=s[1]}}}var zO={build:function(r){r.points=r.shape.points.slice()},triangulate:function(r,t){var e=r.points,s=r.holes,i=t.points,n=t.indices;if(e.length>=6){sI(e,!1);for(var a=[],o=0;o<s.length;o++){var h=s[o];sI(h.points,!0),a.push(e.length/2),e=e.concat(h.points)}var u=LI(e,a,2);if(!u)return;for(var c=i.length/2,o=0;o<u.length;o+=3)n.push(u[o]+c),n.push(u[o+1]+c),n.push(u[o+2]+c);for(var o=0;o<e.length;o++)i.push(e[o])}}},Cl={build:function(r){var t=r.points,e,s,i,n,a,o;if(r.type===Fe.CIRC){var h=r.shape;e=h.x,s=h.y,a=o=h.radius,i=n=0}else if(r.type===Fe.ELIP){var u=r.shape;e=u.x,s=u.y,a=u.width,o=u.height,i=n=0}else{var c=r.shape,l=c.width/2,_=c.height/2;e=c.x+l,s=c.y+_,a=o=Math.max(0,Math.min(c.radius,Math.min(l,_))),i=l-a,n=_-o}if(!(a>=0&&o>=0&&i>=0&&n>=0)){t.length=0;return}var d=Math.ceil(2.3*Math.sqrt(a+o)),f=d*8+(i?4:0)+(n?4:0);if(t.length=f,f!==0){if(d===0){t.length=8,t[0]=t[6]=e+i,t[1]=t[3]=s+n,t[2]=t[4]=e-i,t[5]=t[7]=s-n;return}var m=0,p=d*4+(i?2:0)+2,T=p,v=f;{var O=i+a,A=n,y=e+O,M=e-O,N=s+A;if(t[m++]=y,t[m++]=N,t[--p]=N,t[--p]=M,n){var P=s-A;t[T++]=M,t[T++]=P,t[--v]=P,t[--v]=y}}for(var b=1;b<d;b++){var D=Math.PI/2*(b/d),O=i+Math.cos(D)*a,A=n+Math.sin(D)*o,y=e+O,M=e-O,N=s+A,P=s-A;t[m++]=y,t[m++]=N,t[--p]=N,t[--p]=M,t[T++]=M,t[T++]=P,t[--v]=P,t[--v]=y}{var O=i,A=n+o,y=e+O,M=e-O,N=s+A,P=s-A;t[m++]=y,t[m++]=N,t[--v]=P,t[--v]=y,i&&(t[m++]=M,t[m++]=N,t[--v]=P,t[--v]=M)}}},triangulate:function(r,t){var e=r.points,s=t.points,i=t.indices;if(e.length!==0){var n=s.length/2,a=n,o,h;if(r.type!==Fe.RREC){var u=r.shape;o=u.x,h=u.y}else{var c=r.shape;o=c.x+c.width/2,h=c.y+c.height/2}var l=r.matrix;s.push(r.matrix?l.a*o+l.c*h+l.tx:o,r.matrix?l.b*o+l.d*h+l.ty:h),n++,s.push(e[0],e[1]);for(var _=2;_<e.length;_+=2)s.push(e[_],e[_+1]),i.push(n++,a,n);i.push(a+1,a,n)}}},Pw={build:function(r){var t=r.shape,e=t.x,s=t.y,i=t.width,n=t.height,a=r.points;a.length=0,a.push(e,s,e+i,s,e+i,s+n,e,s+n)},triangulate:function(r,t){var e=r.points,s=t.points,i=s.length/2;s.push(e[0],e[1],e[2],e[3],e[6],e[7],e[4],e[5]),t.indices.push(i,i+1,i+2,i+1,i+2,i+3)}};function sa(r,t,e){var s=t-r;return r+s*e}function Du(r,t,e,s,i,n,a){a===void 0&&(a=[]);for(var o=20,h=a,u=0,c=0,l=0,_=0,d=0,f=0,m=0,p=0;m<=o;++m)p=m/o,u=sa(r,e,p),c=sa(t,s,p),l=sa(e,i,p),_=sa(s,n,p),d=sa(u,l,p),f=sa(c,_,p),!(m===0&&h[h.length-2]===d&&h[h.length-1]===f)&&h.push(d,f);return h}var Dw={build:function(r){if(Ha.nextRoundedRectBehavior){Cl.build(r);return}var t=r.shape,e=r.points,s=t.x,i=t.y,n=t.width,a=t.height,o=Math.max(0,Math.min(t.radius,Math.min(n,a)/2));e.length=0,o?(Du(s,i+o,s,i,s+o,i,e),Du(s+n-o,i,s+n,i,s+n,i+o,e),Du(s+n,i+a-o,s+n,i+a,s+n-o,i+a,e),Du(s+o,i+a,s,i+a,s,i+a-o,e)):e.push(s,i,s+n,i,s+n,i+a,s,i+a)},triangulate:function(r,t){if(Ha.nextRoundedRectBehavior){Cl.triangulate(r,t);return}for(var e=r.points,s=t.points,i=t.indices,n=s.length/2,a=LI(e,null,2),o=0,h=a.length;o<h;o+=3)i.push(a[o]+n),i.push(a[o+1]+n),i.push(a[o+2]+n);for(var o=0,h=e.length;o<h;o++)s.push(e[o],e[++o])}};function rI(r,t,e,s,i,n,a,o){var h=r-e*i,u=t-s*i,c=r+e*n,l=t+s*n,_,d;a?(_=s,d=-e):(_=-s,d=e);var f=h+_,m=u+d,p=c+_,T=l+d;return o.push(f,m),o.push(p,T),2}function Ji(r,t,e,s,i,n,a,o){var h=e-r,u=s-t,c=Math.atan2(h,u),l=Math.atan2(i-r,n-t);o&&c<l?c+=Math.PI*2:!o&&c>l&&(l+=Math.PI*2);var _=c,d=l-c,f=Math.abs(d),m=Math.sqrt(h*h+u*u),p=(15*f*Math.sqrt(m)/Math.PI>>0)+1,T=d/p;if(_+=T,o){a.push(r,t),a.push(e,s);for(var v=1,O=_;v<p;v++,O+=T)a.push(r,t),a.push(r+Math.sin(O)*m,t+Math.cos(O)*m);a.push(r,t),a.push(i,n)}else{a.push(e,s),a.push(r,t);for(var v=1,O=_;v<p;v++,O+=T)a.push(r+Math.sin(O)*m,t+Math.cos(O)*m),a.push(r,t);a.push(i,n),a.push(r,t)}return p*2}function Lw(r,t){var e=r.shape,s=r.points||e.points.slice(),i=t.closePointEps;if(s.length!==0){var n=r.lineStyle,a=new B(s[0],s[1]),o=new B(s[s.length-2],s[s.length-1]),h=e.type!==Fe.POLY||e.closeStroke,u=Math.abs(a.x-o.x)<i&&Math.abs(a.y-o.y)<i;if(h){s=s.slice(),u&&(s.pop(),s.pop(),o.set(s[s.length-2],s[s.length-1]));var c=(a.x+o.x)*.5,l=(o.y+a.y)*.5;s.unshift(c,l),s.push(c,l)}var _=t.points,d=s.length/2,f=s.length,m=_.length/2,p=n.width/2,T=p*p,v=n.miterLimit*n.miterLimit,O=s[0],A=s[1],y=s[2],M=s[3],N=0,P=0,b=-(A-M),D=O-y,x=0,V=0,J=Math.sqrt(b*b+D*D);b/=J,D/=J,b*=p,D*=p;var ct=n.alignment,H=(1-ct)*2,z=ct*2;h||(n.cap===Li.ROUND?f+=Ji(O-b*(H-z)*.5,A-D*(H-z)*.5,O-b*H,A-D*H,O+b*z,A+D*z,_,!0)+2:n.cap===Li.SQUARE&&(f+=rI(O,A,b,D,H,z,!0,_))),_.push(O-b*H,A-D*H),_.push(O+b*z,A+D*z);for(var ht=1;ht<d-1;++ht){O=s[(ht-1)*2],A=s[(ht-1)*2+1],y=s[ht*2],M=s[ht*2+1],N=s[(ht+1)*2],P=s[(ht+1)*2+1],b=-(A-M),D=O-y,J=Math.sqrt(b*b+D*D),b/=J,D/=J,b*=p,D*=p,x=-(M-P),V=y-N,J=Math.sqrt(x*x+V*V),x/=J,V/=J,x*=p,V*=p;var Xe=y-O,Ge=A-M,K=y-N,rt=P-M,Et=Xe*K+Ge*rt,Lt=Ge*K-rt*Xe,Tt=Lt<0;if(Math.abs(Lt)<.001*Math.abs(Et)){_.push(y-b*H,M-D*H),_.push(y+b*z,M+D*z),Et>=0&&(n.join===qr.ROUND?f+=Ji(y,M,y-b*H,M-D*H,y-x*H,M-V*H,_,!1)+4:f+=2,_.push(y-x*z,M-V*z),_.push(y+x*H,M+V*H));continue}var bt=(-b+O)*(-D+M)-(-b+y)*(-D+A),Ft=(-x+N)*(-V+M)-(-x+y)*(-V+P),Jt=(Xe*Ft-K*bt)/Lt,ee=(rt*bt-Ge*Ft)/Lt,Ne=(Jt-y)*(Jt-y)+(ee-M)*(ee-M),_e=y+(Jt-y)*H,se=M+(ee-M)*H,me=y-(Jt-y)*z,Oe=M-(ee-M)*z,er=Math.min(Xe*Xe+Ge*Ge,K*K+rt*rt),sr=Tt?H:z,lo=er+sr*sr*T,S0=Ne<=lo;S0?n.join===qr.BEVEL||Ne/T>v?(Tt?(_.push(_e,se),_.push(y+b*z,M+D*z),_.push(_e,se),_.push(y+x*z,M+V*z)):(_.push(y-b*H,M-D*H),_.push(me,Oe),_.push(y-x*H,M-V*H),_.push(me,Oe)),f+=2):n.join===qr.ROUND?Tt?(_.push(_e,se),_.push(y+b*z,M+D*z),f+=Ji(y,M,y+b*z,M+D*z,y+x*z,M+V*z,_,!0)+4,_.push(_e,se),_.push(y+x*z,M+V*z)):(_.push(y-b*H,M-D*H),_.push(me,Oe),f+=Ji(y,M,y-b*H,M-D*H,y-x*H,M-V*H,_,!1)+4,_.push(y-x*H,M-V*H),_.push(me,Oe)):(_.push(_e,se),_.push(me,Oe)):(_.push(y-b*H,M-D*H),_.push(y+b*z,M+D*z),n.join===qr.ROUND?Tt?f+=Ji(y,M,y+b*z,M+D*z,y+x*z,M+V*z,_,!0)+2:f+=Ji(y,M,y-b*H,M-D*H,y-x*H,M-V*H,_,!1)+2:n.join===qr.MITER&&Ne/T<=v&&(Tt?(_.push(me,Oe),_.push(me,Oe)):(_.push(_e,se),_.push(_e,se)),f+=2),_.push(y-x*H,M-V*H),_.push(y+x*z,M+V*z),f+=2)}O=s[(d-2)*2],A=s[(d-2)*2+1],y=s[(d-1)*2],M=s[(d-1)*2+1],b=-(A-M),D=O-y,J=Math.sqrt(b*b+D*D),b/=J,D/=J,b*=p,D*=p,_.push(y-b*H,M-D*H),_.push(y+b*z,M+D*z),h||(n.cap===Li.ROUND?f+=Ji(y-b*(H-z)*.5,M-D*(H-z)*.5,y-b*H,M-D*H,y+b*z,M+D*z,_,!1)+2:n.cap===Li.SQUARE&&(f+=rI(y,M,b,D,H,z,!1,_)));for(var y0=t.indices,M0=gh.epsilon*gh.epsilon,ht=m;ht<f+m-2;++ht)O=_[ht*2],A=_[ht*2+1],y=_[(ht+1)*2],M=_[(ht+1)*2+1],N=_[(ht+2)*2],P=_[(ht+2)*2+1],!(Math.abs(O*(M-P)+y*(P-A)+N*(A-M))<M0)&&y0.push(ht,ht+1,ht+2)}}function Uw(r,t){var e=0,s=r.shape,i=r.points||s.points,n=s.type!==Fe.POLY||s.closeStroke;if(i.length!==0){var a=t.points,o=t.indices,h=i.length/2,u=a.length/2,c=u;for(a.push(i[0],i[1]),e=1;e<h;e++)a.push(i[e*2],i[e*2+1]),o.push(c,c+1),c++;n&&o.push(c,u)}}function iI(r,t){r.lineStyle.native?Uw(r,t):Lw(r,t)}var nI=function(){function r(){}return r.curveTo=function(t,e,s,i,n,a){var o=a[a.length-2],h=a[a.length-1],u=h-e,c=o-t,l=i-e,_=s-t,d=Math.abs(u*_-c*l);if(d<1e-8||n===0)return(a[a.length-2]!==t||a[a.length-1]!==e)&&a.push(t,e),null;var f=u*u+c*c,m=l*l+_*_,p=u*l+c*_,T=n*Math.sqrt(f)/d,v=n*Math.sqrt(m)/d,O=T*p/f,A=v*p/m,y=T*_+v*c,M=T*l+v*u,N=c*(v+O),P=u*(v+O),b=_*(T+A),D=l*(T+A),x=Math.atan2(P-M,N-y),V=Math.atan2(D-M,b-y);return{cx:y+t,cy:M+e,radius:n,startAngle:x,endAngle:V,anticlockwise:c*l>_*u}},r.arc=function(t,e,s,i,n,a,o,h,u){for(var c=o-a,l=gh._segmentsCount(Math.abs(c)*n,Math.ceil(Math.abs(c)/sh)*40),_=c/(l*2),d=_*2,f=Math.cos(_),m=Math.sin(_),p=l-1,T=p%1/p,v=0;v<=p;++v){var O=v+T*v,A=_+a+d*O,y=Math.cos(A),M=-Math.sin(A);u.push((f*y+m*M)*n+s,(f*-M+m*y)*n+i)}},r}(),xw=function(){function r(){}return r.curveLength=function(t,e,s,i,n,a,o,h){for(var u=10,c=0,l=0,_=0,d=0,f=0,m=0,p=0,T=0,v=0,O=0,A=0,y=t,M=e,N=1;N<=u;++N)l=N/u,_=l*l,d=_*l,f=1-l,m=f*f,p=m*f,T=p*t+3*m*l*s+3*f*_*n+d*o,v=p*e+3*m*l*i+3*f*_*a+d*h,O=y-T,A=M-v,y=T,M=v,c+=Math.sqrt(O*O+A*A);return c},r.curveTo=function(t,e,s,i,n,a,o){var h=o[o.length-2],u=o[o.length-1];o.length-=2;var c=gh._segmentsCount(r.curveLength(h,u,t,e,s,i,n,a)),l=0,_=0,d=0,f=0,m=0;o.push(h,u);for(var p=1,T=0;p<=c;++p)T=p/c,l=1-T,_=l*l,d=_*l,f=T*T,m=f*T,o.push(d*h+3*_*T*t+3*l*f*s+m*n,d*u+3*_*T*e+3*l*f*i+m*a)},r}(),Fw=function(){function r(){}return r.curveLength=function(t,e,s,i,n,a){var o=t-2*s+n,h=e-2*i+a,u=2*s-2*t,c=2*i-2*e,l=4*(o*o+h*h),_=4*(o*u+h*c),d=u*u+c*c,f=2*Math.sqrt(l+_+d),m=Math.sqrt(l),p=2*l*m,T=2*Math.sqrt(d),v=_/m;return(p*f+m*_*(f-T)+(4*d*l-_*_)*Math.log((2*m+v+f)/(v+T)))/(4*p)},r.curveTo=function(t,e,s,i,n){for(var a=n[n.length-2],o=n[n.length-1],h=gh._segmentsCount(r.curveLength(a,o,t,e,s,i)),u=0,c=0,l=1;l<=h;++l){var _=l/h;u=a+(t-a)*_,c=o+(e-o)*_,n.push(u+(t+(s-t)*_-u)*_,c+(e+(i-e)*_-c)*_)}},r}(),ww=function(){function r(){this.reset()}return r.prototype.begin=function(t,e,s){this.reset(),this.style=t,this.start=e,this.attribStart=s},r.prototype.end=function(t,e){this.attribSize=e-this.attribStart,this.size=t-this.start},r.prototype.reset=function(){this.style=null,this.size=0,this.start=0,this.attribStart=0,this.attribSize=0},r}(),$i,zc=($i={},$i[Fe.POLY]=zO,$i[Fe.CIRC]=Cl,$i[Fe.ELIP]=Cl,$i[Fe.RECT]=Pw,$i[Fe.RREC]=Dw,$i),aI=[],Lu=[],oI=function(){function r(t,e,s,i){e===void 0&&(e=null),s===void 0&&(s=null),i===void 0&&(i=null),this.points=[],this.holes=[],this.shape=t,this.lineStyle=s,this.fillStyle=e,this.matrix=i,this.type=t.type}return r.prototype.clone=function(){return new r(this.shape,this.fillStyle,this.lineStyle,this.matrix)},r.prototype.destroy=function(){this.shape=null,this.holes.length=0,this.holes=null,this.points.length=0,this.points=null,this.lineStyle=null,this.fillStyle=null},r}(),ra=new B,Gw=function(r){Kg(t,r);function t(){var e=r.call(this)||this;return e.closePointEps=1e-4,e.boundsPadding=0,e.uvsFloat32=null,e.indicesUint16=null,e.batchable=!1,e.points=[],e.colors=[],e.uvs=[],e.indices=[],e.textureIds=[],e.graphicsData=[],e.drawCalls=[],e.batchDirty=-1,e.batches=[],e.dirty=0,e.cacheDirty=-1,e.clearDirty=0,e.shapeIndex=0,e._bounds=new ch,e.boundsDirty=-1,e}return Object.defineProperty(t.prototype,"bounds",{get:function(){return this.updateBatches(),this.boundsDirty!==this.dirty&&(this.boundsDirty=this.dirty,this.calculateBounds()),this._bounds},enumerable:!1,configurable:!0}),t.prototype.invalidate=function(){this.boundsDirty=-1,this.dirty++,this.batchDirty++,this.shapeIndex=0,this.points.length=0,this.colors.length=0,this.uvs.length=0,this.indices.length=0,this.textureIds.length=0;for(var e=0;e<this.drawCalls.length;e++)this.drawCalls[e].texArray.clear(),Lu.push(this.drawCalls[e]);this.drawCalls.length=0;for(var e=0;e<this.batches.length;e++){var s=this.batches[e];s.reset(),aI.push(s)}this.batches.length=0},t.prototype.clear=function(){return this.graphicsData.length>0&&(this.invalidate(),this.clearDirty++,this.graphicsData.length=0),this},t.prototype.drawShape=function(e,s,i,n){s===void 0&&(s=null),i===void 0&&(i=null),n===void 0&&(n=null);var a=new oI(e,s,i,n);return this.graphicsData.push(a),this.dirty++,this},t.prototype.drawHole=function(e,s){if(s===void 0&&(s=null),!this.graphicsData.length)return null;var i=new oI(e,null,null,s),n=this.graphicsData[this.graphicsData.length-1];return i.lineStyle=n.lineStyle,n.holes.push(i),this.dirty++,this},t.prototype.destroy=function(){r.prototype.destroy.call(this);for(var e=0;e<this.graphicsData.length;++e)this.graphicsData[e].destroy();this.points.length=0,this.points=null,this.colors.length=0,this.colors=null,this.uvs.length=0,this.uvs=null,this.indices.length=0,this.indices=null,this.indexBuffer.destroy(),this.indexBuffer=null,this.graphicsData.length=0,this.graphicsData=null,this.drawCalls.length=0,this.drawCalls=null,this.batches.length=0,this.batches=null,this._bounds=null},t.prototype.containsPoint=function(e){for(var s=this.graphicsData,i=0;i<s.length;++i){var n=s[i];if(n.fillStyle.visible&&n.shape&&(n.matrix?n.matrix.applyInverse(e,ra):ra.copyFrom(e),n.shape.contains(ra.x,ra.y))){var a=!1;if(n.holes)for(var o=0;o<n.holes.length;o++){var h=n.holes[o];if(h.shape.contains(ra.x,ra.y)){a=!0;break}}if(!a)return!0}}return!1},t.prototype.updateBatches=function(){if(!this.graphicsData.length){this.batchable=!0;return}if(this.validateBatching()){this.cacheDirty=this.dirty;var e=this.uvs,s=this.graphicsData,i=null,n=null;this.batches.length>0&&(i=this.batches[this.batches.length-1],n=i.style);for(var a=this.shapeIndex;a<s.length;a++){this.shapeIndex++;var o=s[a],h=o.fillStyle,u=o.lineStyle,c=zc[o.type];c.build(o),o.matrix&&this.transformPoints(o.points,o.matrix),(h.visible||u.visible)&&this.processHoles(o.holes);for(var l=0;l<2;l++){var _=l===0?h:u;if(_.visible){var d=_.texture.baseTexture,f=this.indices.length,m=this.points.length/2;d.wrapMode=ri.REPEAT,l===0?this.processFill(o):this.processLine(o);var p=this.points.length/2-m;p!==0&&(i&&!this._compareStyles(n,_)&&(i.end(f,m),i=null),i||(i=aI.pop()||new ww,i.begin(_,f,m),this.batches.push(i),n=_),this.addUvs(this.points,e,_.texture,m,p,_.matrix))}}}var T=this.indices.length,v=this.points.length/2;if(i&&i.end(T,v),this.batches.length===0){this.batchable=!0;return}var O=v>65535;this.indicesUint16&&this.indices.length===this.indicesUint16.length&&O===this.indicesUint16.BYTES_PER_ELEMENT>2?this.indicesUint16.set(this.indices):this.indicesUint16=O?new Uint32Array(this.indices):new Uint16Array(this.indices),this.batchable=this.isBatchable(),this.batchable?this.packBatches():this.buildDrawCalls()}},t.prototype._compareStyles=function(e,s){return!(!e||!s||e.texture.baseTexture!==s.texture.baseTexture||e.color+e.alpha!==s.color+s.alpha||!!e.native!=!!s.native)},t.prototype.validateBatching=function(){if(this.dirty===this.cacheDirty||!this.graphicsData.length)return!1;for(var e=0,s=this.graphicsData.length;e<s;e++){var i=this.graphicsData[e],n=i.fillStyle,a=i.lineStyle;if(n&&!n.texture.baseTexture.valid||a&&!a.texture.baseTexture.valid)return!1}return!0},t.prototype.packBatches=function(){this.batchDirty++,this.uvsFloat32=new Float32Array(this.uvs);for(var e=this.batches,s=0,i=e.length;s<i;s++)for(var n=e[s],a=0;a<n.size;a++){var o=n.start+a;this.indicesUint16[o]=this.indicesUint16[o]-n.attribStart}},t.prototype.isBatchable=function(){if(this.points.length>65535*2)return!1;for(var e=this.batches,s=0;s<e.length;s++)if(e[s].style.native)return!1;return this.points.length<t.BATCHABLE_SIZE*2},t.prototype.buildDrawCalls=function(){for(var e=++Xt._globalBatch,s=0;s<this.drawCalls.length;s++)this.drawCalls[s].texArray.clear(),Lu.push(this.drawCalls[s]);this.drawCalls.length=0;var i=this.colors,n=this.textureIds,a=Lu.pop();a||(a=new Sd,a.texArray=new yd),a.texArray.count=0,a.start=0,a.size=0,a.type=lr.TRIANGLES;var o=0,h=null,u=0,c=!1,l=lr.TRIANGLES,_=0;this.drawCalls.push(a);for(var s=0;s<this.batches.length;s++){var d=this.batches[s],f=8,m=d.style,p=m.texture.baseTexture;c!==!!m.native&&(c=!!m.native,l=c?lr.LINES:lr.TRIANGLES,h=null,o=f,e++),h!==p&&(h=p,p._batchEnabled!==e&&(o===f&&(e++,o=0,a.size>0&&(a=Lu.pop(),a||(a=new Sd,a.texArray=new yd),this.drawCalls.push(a)),a.start=_,a.size=0,a.texArray.count=0,a.type=l),p.touched=1,p._batchEnabled=e,p._batchLocation=o,p.wrapMode=ri.REPEAT,a.texArray.elements[a.texArray.count++]=p,o++)),a.size+=d.size,_+=d.size,u=p._batchLocation,this.addColors(i,m.color,m.alpha,d.attribSize,d.attribStart),this.addTextureIds(n,u,d.attribSize,d.attribStart)}Xt._globalBatch=e,this.packAttributes()},t.prototype.packAttributes=function(){for(var e=this.points,s=this.uvs,i=this.colors,n=this.textureIds,a=new ArrayBuffer(e.length*3*4),o=new Float32Array(a),h=new Uint32Array(a),u=0,c=0;c<e.length/2;c++)o[u++]=e[c*2],o[u++]=e[c*2+1],o[u++]=s[c*2],o[u++]=s[c*2+1],h[u++]=i[c],o[u++]=n[c];this._buffer.update(a),this._indexBuffer.update(this.indicesUint16)},t.prototype.processFill=function(e){if(e.holes.length)zO.triangulate(e,this);else{var s=zc[e.type];s.triangulate(e,this)}},t.prototype.processLine=function(e){iI(e,this);for(var s=0;s<e.holes.length;s++)iI(e.holes[s],this)},t.prototype.processHoles=function(e){for(var s=0;s<e.length;s++){var i=e[s],n=zc[i.type];n.build(i),i.matrix&&this.transformPoints(i.points,i.matrix)}},t.prototype.calculateBounds=function(){var e=this._bounds;e.clear(),e.addVertexData(this.points,0,this.points.length),e.pad(this.boundsPadding,this.boundsPadding)},t.prototype.transformPoints=function(e,s){for(var i=0;i<e.length/2;i++){var n=e[i*2],a=e[i*2+1];e[i*2]=s.a*n+s.c*a+s.tx,e[i*2+1]=s.b*n+s.d*a+s.ty}},t.prototype.addColors=function(e,s,i,n,a){a===void 0&&(a=0);var o=(s>>16)+(s&65280)+((s&255)<<16),h=tT(o,i);e.length=Math.max(e.length,a+n);for(var u=0;u<n;u++)e[a+u]=h},t.prototype.addTextureIds=function(e,s,i,n){n===void 0&&(n=0),e.length=Math.max(e.length,n+i);for(var a=0;a<i;a++)e[n+a]=s},t.prototype.addUvs=function(e,s,i,n,a,o){o===void 0&&(o=null);for(var h=0,u=s.length,c=i.frame;h<a;){var l=e[(n+h)*2],_=e[(n+h)*2+1];if(o){var d=o.a*l+o.c*_+o.tx;_=o.b*l+o.d*_+o.ty,l=d}h++,s.push(l/c.width,_/c.height)}var f=i.baseTexture;(c.width<f.width||c.height<f.height)&&this.adjustUvs(s,i,u,a)},t.prototype.adjustUvs=function(e,s,i,n){for(var a=s.baseTexture,o=1e-6,h=i+n*2,u=s.frame,c=u.width/a.width,l=u.height/a.height,_=u.x/u.width,d=u.y/u.height,f=Math.floor(e[i]+o),m=Math.floor(e[i+1]+o),p=i+2;p<h;p+=2)f=Math.min(f,Math.floor(e[p]+o)),m=Math.min(m,Math.floor(e[p+1]+o));_-=f,d-=m;for(var p=i;p<h;p+=2)e[p]=(e[p]+_)*c,e[p+1]=(e[p+1]+d)*l},t.BATCHABLE_SIZE=100,t}(pT),Bw=function(r){Kg(t,r);function t(){var e=r!==null&&r.apply(this,arguments)||this;return e.width=0,e.alignment=.5,e.native=!1,e.cap=Li.BUTT,e.join=qr.MITER,e.miterLimit=10,e}return t.prototype.clone=function(){var e=new t;return e.color=this.color,e.alpha=this.alpha,e.texture=this.texture,e.matrix=this.matrix,e.visible=this.visible,e.width=this.width,e.alignment=this.alignment,e.native=this.native,e.cap=this.cap,e.join=this.join,e.miterLimit=this.miterLimit,e},t.prototype.reset=function(){r.prototype.reset.call(this),this.color=0,this.alignment=.5,this.width=0,this.native=!1},t}(jO),Hw=new Float32Array(3),Yc={},Ha=function(r){Kg(t,r);function t(e){e===void 0&&(e=null);var s=r.call(this)||this;return s.shader=null,s.pluginName="batch",s.currentPath=null,s.batches=[],s.batchTint=-1,s.batchDirty=-1,s.vertexData=null,s._fillStyle=new jO,s._lineStyle=new Bw,s._matrix=null,s._holeMode=!1,s.state=yh.for2d(),s._geometry=e||new Gw,s._geometry.refCount++,s._transformID=-1,s.tint=16777215,s.blendMode=tt.NORMAL,s}return Object.defineProperty(t.prototype,"geometry",{get:function(){return this._geometry},enumerable:!1,configurable:!0}),t.prototype.clone=function(){return this.finishPoly(),new t(this._geometry)},Object.defineProperty(t.prototype,"blendMode",{get:function(){return this.state.blendMode},set:function(e){this.state.blendMode=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._tint},set:function(e){this._tint=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this._fillStyle},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"line",{get:function(){return this._lineStyle},enumerable:!1,configurable:!0}),t.prototype.lineStyle=function(e,s,i,n,a){return e===void 0&&(e=null),s===void 0&&(s=0),i===void 0&&(i=1),n===void 0&&(n=.5),a===void 0&&(a=!1),typeof e=="number"&&(e={width:e,color:s,alpha:i,alignment:n,native:a}),this.lineTextureStyle(e)},t.prototype.lineTextureStyle=function(e){e=Object.assign({width:0,texture:_t.WHITE,color:e&&e.texture?16777215:0,alpha:1,matrix:null,alignment:.5,native:!1,cap:Li.BUTT,join:qr.MITER,miterLimit:10},e),this.currentPath&&this.startPoly();var s=e.width>0&&e.alpha>0;return s?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._lineStyle,{visible:s},e)):this._lineStyle.reset(),this},t.prototype.startPoly=function(){if(this.currentPath){var e=this.currentPath.points,s=this.currentPath.points.length;s>2&&(this.drawShape(this.currentPath),this.currentPath=new Vu,this.currentPath.closeStroke=!1,this.currentPath.points.push(e[s-2],e[s-1]))}else this.currentPath=new Vu,this.currentPath.closeStroke=!1},t.prototype.finishPoly=function(){this.currentPath&&(this.currentPath.points.length>2?(this.drawShape(this.currentPath),this.currentPath=null):this.currentPath.points.length=0)},t.prototype.moveTo=function(e,s){return this.startPoly(),this.currentPath.points[0]=e,this.currentPath.points[1]=s,this},t.prototype.lineTo=function(e,s){this.currentPath||this.moveTo(0,0);var i=this.currentPath.points,n=i[i.length-2],a=i[i.length-1];return(n!==e||a!==s)&&i.push(e,s),this},t.prototype._initCurve=function(e,s){e===void 0&&(e=0),s===void 0&&(s=0),this.currentPath?this.currentPath.points.length===0&&(this.currentPath.points=[e,s]):this.moveTo(e,s)},t.prototype.quadraticCurveTo=function(e,s,i,n){this._initCurve();var a=this.currentPath.points;return a.length===0&&this.moveTo(0,0),Fw.curveTo(e,s,i,n,a),this},t.prototype.bezierCurveTo=function(e,s,i,n,a,o){return this._initCurve(),xw.curveTo(e,s,i,n,a,o,this.currentPath.points),this},t.prototype.arcTo=function(e,s,i,n,a){this._initCurve(e,s);var o=this.currentPath.points,h=nI.curveTo(e,s,i,n,a,o);if(h){var u=h.cx,c=h.cy,l=h.radius,_=h.startAngle,d=h.endAngle,f=h.anticlockwise;this.arc(u,c,l,_,d,f)}return this},t.prototype.arc=function(e,s,i,n,a,o){if(o===void 0&&(o=!1),n===a)return this;!o&&a<=n?a+=sh:o&&n<=a&&(n+=sh);var h=a-n;if(h===0)return this;var u=e+Math.cos(n)*i,c=s+Math.sin(n)*i,l=this._geometry.closePointEps,_=this.currentPath?this.currentPath.points:null;if(_){var d=Math.abs(_[_.length-2]-u),f=Math.abs(_[_.length-1]-c);d<l&&f<l||_.push(u,c)}else this.moveTo(u,c),_=this.currentPath.points;return nI.arc(u,c,e,s,i,n,a,o,_),this},t.prototype.beginFill=function(e,s){return e===void 0&&(e=0),s===void 0&&(s=1),this.beginTextureFill({texture:_t.WHITE,color:e,alpha:s})},t.prototype.beginTextureFill=function(e){e=Object.assign({texture:_t.WHITE,color:16777215,alpha:1,matrix:null},e),this.currentPath&&this.startPoly();var s=e.alpha>0;return s?(e.matrix&&(e.matrix=e.matrix.clone(),e.matrix.invert()),Object.assign(this._fillStyle,{visible:s},e)):this._fillStyle.reset(),this},t.prototype.endFill=function(){return this.finishPoly(),this._fillStyle.reset(),this},t.prototype.drawRect=function(e,s,i,n){return this.drawShape(new it(e,s,i,n))},t.prototype.drawRoundedRect=function(e,s,i,n,a){return this.drawShape(new OD(e,s,i,n,a))},t.prototype.drawCircle=function(e,s,i){return this.drawShape(new TD(e,s,i))},t.prototype.drawEllipse=function(e,s,i,n){return this.drawShape(new RD(e,s,i,n))},t.prototype.drawPolygon=function(){for(var e=arguments,s=[],i=0;i<arguments.length;i++)s[i]=e[i];var n,a=!0,o=s[0];o.points?(a=o.closeStroke,n=o.points):Array.isArray(s[0])?n=s[0]:n=s;var h=new Vu(n);return h.closeStroke=a,this.drawShape(h),this},t.prototype.drawShape=function(e){return this._holeMode?this._geometry.drawHole(e,this._matrix):this._geometry.drawShape(e,this._fillStyle.clone(),this._lineStyle.clone(),this._matrix),this},t.prototype.clear=function(){return this._geometry.clear(),this._lineStyle.reset(),this._fillStyle.reset(),this._boundsID++,this._matrix=null,this._holeMode=!1,this.currentPath=null,this},t.prototype.isFastRect=function(){var e=this._geometry.graphicsData;return e.length===1&&e[0].shape.type===Fe.RECT&&!e[0].matrix&&!e[0].holes.length&&!(e[0].lineStyle.visible&&e[0].lineStyle.width)},t.prototype._render=function(e){this.finishPoly();var s=this._geometry;s.updateBatches(),s.batchable?(this.batchDirty!==s.batchDirty&&this._populateBatches(),this._renderBatched(e)):(e.batch.flush(),this._renderDirect(e))},t.prototype._populateBatches=function(){var e=this._geometry,s=this.blendMode,i=e.batches.length;this.batchTint=-1,this._transformID=-1,this.batchDirty=e.batchDirty,this.batches.length=i,this.vertexData=new Float32Array(e.points);for(var n=0;n<i;n++){var a=e.batches[n],o=a.style.color,h=new Float32Array(this.vertexData.buffer,a.attribStart*4*2,a.attribSize*2),u=new Float32Array(e.uvsFloat32.buffer,a.attribStart*4*2,a.attribSize*2),c=new Uint16Array(e.indicesUint16.buffer,a.start*2,a.size),l={vertexData:h,blendMode:s,indices:c,uvs:u,_batchRGB:pl(o),_tintRGB:o,_texture:a.style.texture,alpha:a.style.alpha,worldAlpha:1};this.batches[n]=l}},t.prototype._renderBatched=function(e){if(this.batches.length){e.batch.setObjectRenderer(e.plugins[this.pluginName]),this.calculateVertices(),this.calculateTints();for(var s=0,i=this.batches.length;s<i;s++){var n=this.batches[s];n.worldAlpha=this.worldAlpha*n.alpha,e.plugins[this.pluginName].render(n)}}},t.prototype._renderDirect=function(e){var s=this._resolveDirectShader(e),i=this._geometry,n=this.tint,a=this.worldAlpha,o=s.uniforms,h=i.drawCalls;o.translationMatrix=this.transform.worldTransform,o.tint[0]=(n>>16&255)/255*a,o.tint[1]=(n>>8&255)/255*a,o.tint[2]=(n&255)/255*a,o.tint[3]=a,e.shader.bind(s),e.geometry.bind(i,s),e.state.set(this.state);for(var u=0,c=h.length;u<c;u++)this._renderDrawCallDirect(e,i.drawCalls[u])},t.prototype._renderDrawCallDirect=function(e,s){for(var i=s.texArray,n=s.type,a=s.size,o=s.start,h=i.count,u=0;u<h;u++)e.texture.bind(i.elements[u],u);e.geometry.draw(n,a,o)},t.prototype._resolveDirectShader=function(e){var s=this.shader,i=this.pluginName;if(!s){if(!Yc[i]){for(var n=e.plugins[i].MAX_TEXTURES,a=new Int32Array(n),o=0;o<n;o++)a[o]=o;var h={tint:new Float32Array([1,1,1,1]),translationMatrix:new Vt,default:Mn.from({uSamplers:a},!0)},u=e.plugins[i]._shader.program;Yc[i]=new Cn(u,h)}s=Yc[i]}return s},t.prototype._calculateBounds=function(){this.finishPoly();var e=this._geometry;if(e.graphicsData.length){var s=e.bounds,i=s.minX,n=s.minY,a=s.maxX,o=s.maxY;this._bounds.addFrame(this.transform,i,n,a,o)}},t.prototype.containsPoint=function(e){return this.worldTransform.applyInverse(e,t._TEMP_POINT),this._geometry.containsPoint(t._TEMP_POINT)},t.prototype.calculateTints=function(){if(this.batchTint!==this.tint){this.batchTint=this.tint;for(var e=pl(this.tint,Hw),s=0;s<this.batches.length;s++){var i=this.batches[s],n=i._batchRGB,a=e[0]*n[0]*255,o=e[1]*n[1]*255,h=e[2]*n[2]*255,u=(a<<16)+(o<<8)+(h|0);i._tintRGB=(u>>16)+(u&65280)+((u&255)<<16)}}},t.prototype.calculateVertices=function(){var e=this.transform._worldID;if(this._transformID!==e){this._transformID=e;for(var s=this.transform.worldTransform,i=s.a,n=s.b,a=s.c,o=s.d,h=s.tx,u=s.ty,c=this._geometry.points,l=this.vertexData,_=0,d=0;d<c.length;d+=2){var f=c[d],m=c[d+1];l[_++]=i*f+a*m+h,l[_++]=o*m+n*f+u}}},t.prototype.closePath=function(){var e=this.currentPath;return e&&(e.closeStroke=!0,this.finishPoly()),this},t.prototype.setMatrix=function(e){return this._matrix=e,this},t.prototype.beginHole=function(){return this.finishPoly(),this._holeMode=!0,this},t.prototype.endHole=function(){return this.finishPoly(),this._holeMode=!1,this},t.prototype.destroy=function(e){this._geometry.refCount--,this._geometry.refCount===0&&this._geometry.dispose(),this._matrix=null,this.currentPath=null,this._lineStyle.destroy(),this._lineStyle=null,this._fillStyle.destroy(),this._fillStyle=null,this._geometry=null,this.shader=null,this.vertexData=null,this.batches.length=0,this.batches=null,r.prototype.destroy.call(this,e)},t.nextRoundedRectBehavior=!1,t._TEMP_POINT=new B,t}(Tr);const YO=class ci{static hex2rgb(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e}static hex2rgba(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e[3]=t&255,e}static rgb2hex(t){return(t[0]*255<<16)+(t[1]*255<<8)+(t[2]*255|0)}static rgba2hex(t){return(t[0]*255<<16)+(t[1]*255<<8)+(t[2]*255|0)+(t[3]|0)}static rgbStringToHex(t){const e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+ci.getHex(e[1])+ci.getHex(e[2])+ci.getHex(e[3])}static getHex(t){return isNaN(t)?"00":ci.HEX_DIGITS[(t-t%16)/16]+ci.HEX_DIGITS[t%16]}static int2rgb(t){t>>>=0;const e=t&255,s=(t&65280)>>>8;return"rgba("+[(t&16711680)>>>16,s,e,1].join(",")+")"}static rgbToHSL(t){const e=(t>>16&255)/255,s=(t>>8&255)/255,i=(t&255)/255,n=Math.max(e,s,i),a=Math.min(e,s,i),o=n-a;let h=0,u=0,c=0;o==0?h=0:n==e?s>i?h=60*(s-i)/o:h=60*(s-i)/o+360:n==s?h=60*(i-e)/o+120:n==i&&(h=60*(e-s)/o+240),u=.5*(n+a),o==0?c=0:u<=.5?c=o/u*.5:c=o/(1-u)*.5;const l=Math.round(h/360*255),_=Math.round(c*255),d=Math.round(u*255);return(l<<16)+(_<<8)+d}static hslToRGB(t){let e,s,i,n,a;const o=(t>>16&255)/255,h=(t>>8&255)/255,u=(t&255)/255;let c=0,l=0,_=0;h>0?(e=0,s=0,u<.5?e=u*(1+h):e=u+h-u*h,s=2*u-e,i=o+1/3,n=o,a=o-1/3,i<0?i=i+1:i>1&&i--,n<0?n=n+1:n>1&&n--,a<0?a=a+1:a>1&&a--,i*6<1?c=s+(e-s)*6*i:i*2<1?c=e:i*3<2?c=s+(e-s)*6*(2/3-i):c=s,n*6<1?l=s+(e-s)*6*n:n*2<1?l=e:n*3<2?l=s+(e-s)*6*(2/3-n):l=s,a*6<1?_=s+(e-s)*6*a:a*2<1?_=e:a*3<2?_=s+(e-s)*6*(2/3-a):_=s):(c=u,l=u,_=u);const d=Math.round(c*255),f=Math.round(l*255),m=Math.round(_*255);return(d<<16)+(f<<8)+m}static rgb2xyz(t){let e=(t>>16&255)/255,s=(t>>8&255)/255,i=(t>>0&255)/255;return e>.04045?e=Math.pow((e+.055)/1.055,2.4):e=e/12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s=s/12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i=i/12.92,e=e*100,s=s*100,i=i*100,new S(e*.4124+s*.3576+i*.1805,e*.2126+s*.7152+i*.0722,e*.0193+s*.1192+i*.9505)}static xyz2CieLab(t){let e=t.x/95.047,s=t.y/100,i=t.z/108.883;return e>.008856?e=Math.pow(e,1/3):e=7.787*e+16/116,s>.008856?s=Math.pow(s,1/3):s=7.787*s+16/116,i>.008856?i=Math.pow(i,1/3):i=7.787*i+16/116,new S(116*s-16,500*(e-s),200*(s-i))}static rgb2CieLab(t){return ci.xyz2CieLab(ci.rgb2xyz(t))}static colorize(t,e){if(e===4294967295)return t;let s=e>>16&255,i=e>>8&255,n=e&255;return s=(t>>16&255)*s/255,i=(t>>8&255)*i/255,n=(t&255)*n/255,(t&&4278190080)|s<<16|i<<8|n}};YO.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];let af=YO;class hI{constructor(t){t<0&&(t=0),this._reservedNumbers=[],this._freeNumbers=[];let e=0;for(;e<t;)this._freeNumbers.push(e),e++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const t=this._freeNumbers.pop();return this._reservedNumbers.push(t),t}return-1}freeNumber(t){const e=this._reservedNumbers.indexOf(t);e>=0&&(this._reservedNumbers.splice(e,1),this._freeNumbers.push(t))}}class Vw{static getFlipHBitmapData(t){if(!t)return null;const e=Qt.createRenderTexture(t.width,t.height),s=new Vt;return s.scale(-1,1),s.translate(t.width,0),Me.instance.renderer.render(new Kt(t),{renderTexture:e,clear:!0,transform:s}),e}static getFlipVBitmapData(t){if(!t)return null;const e=new Vt;e.scale(1,-1),e.translate(0,t.height);const s=new Ha;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),Qt.generateTexture(s)}static getFlipHVBitmapData(t){if(!t)return null;const e=new Vt;e.scale(-1,-1),e.translate(t.width,t.height);const s=new Ha;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),Qt.generateTexture(s)}}const Ds=class yt{static init(t,e){yt._currentDelta=0,yt._startDelayMs=t,yt._effectDurationMs=e,yt._initializationTimeMs=ft(),yt._state=yt.STATE_START_DELAY}static turnVisualizationOn(){if(yt._state===yt.STATE_NOT_INITIALIZED||yt._state===yt.STATE_OVER)return;const t=ft()-yt._initializationTimeMs;if(t>yt._startDelayMs+yt._effectDurationMs){yt._state=yt.STATE_OVER;return}if(yt._visualizationOn=!0,t<yt._startDelayMs){yt._state=yt.STATE_START_DELAY;return}yt._state=yt.STATE_RUNNING,yt._currentDelta=(t-yt._startDelayMs)/yt._effectDurationMs}static turnVisualizationOff(){yt._visualizationOn=!1}static isVisualizationOn(){return yt._visualizationOn&&yt.isRunning()}static isRunning(){return yt._state===yt.STATE_START_DELAY||yt._state===yt.STATE_RUNNING}static getDelta(t=0,e=1){return Math.min(Math.max(yt._currentDelta,t),e)}static get totalRunningTime(){return yt._startDelayMs+yt._effectDurationMs}};Ds.STATE_NOT_INITIALIZED=0;Ds.STATE_START_DELAY=1;Ds.STATE_RUNNING=2;Ds.STATE_OVER=3;Ds._state=Ds.STATE_NOT_INITIALIZED;Ds._visualizationOn=!1;Ds._currentDelta=0;Ds._initializationTimeMs=0;Ds._startDelayMs=20*1e3;Ds._effectDurationMs=2e3;let Ci=Ds;const qg=class on{constructor(t,e,s,i=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=t,this._x=new S,this._y=new S,this._z=new S,this._directionAxis=new S,this._location=new S,this._direction=new S,this._depth=new S,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(1/2)/Math.sqrt(3/4),this.z_scale=1,this.location=new S(s.x,s.y,s.z),this.direction=new S(e.x,e.y,e.z),i!=null?this.setDepthVector(i):this.setDepthVector(e),this._displacements=new Map}static getIntersectionVector(t,e,s,i){const n=S.dotProduct(e,i);if(Math.abs(n)<1e-5)return null;const a=S.dif(t,s),o=-S.dotProduct(i,a)/n;return S.sum(t,S.product(e,o))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(t){t<=1&&(t=1),t=t*Math.sqrt(.5),t!=this._scale&&(this._scale=t,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(t){if(t==null)return;this._loc==null&&(this._loc=new S);const e=this._loc.x,s=this._loc.y,i=this._loc.z;this._loc.assign(t),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,(this._loc.x!=e||this._loc.y!=s||this._loc.z!=i)&&this._updateId++}get direction(){return this._direction}set direction(t){let e,s,i,n,a;if(t==null)return;this._dir==null&&(this._dir=new S);const o=this._dir.x,h=this._dir.y,u=this._dir.z;this._dir.assign(t),this._direction.assign(t),(this._dir.x!=o||this._dir.y!=h||this._dir.z!=u)&&this._updateId++;const c=new S(0,1,0),l=new S(0,0,1),_=new S(1,0,0),d=t.x/180*Math.PI,f=t.y/180*Math.PI,m=t.z/180*Math.PI,p=Math.cos(d),T=Math.sin(d),v=S.sum(S.product(c,p),S.product(_,-T)),O=new S(l.x,l.y,l.z),A=S.sum(S.product(c,T),S.product(_,p)),y=Math.cos(f),M=Math.sin(f),N=new S(v.x,v.y,v.z),P=S.sum(S.product(O,y),S.product(A,M)),b=S.sum(S.product(O,-M),S.product(A,y));m!=0?(e=Math.cos(m),s=Math.sin(m),i=S.sum(S.product(N,e),S.product(P,s)),n=S.sum(S.product(N,-s),S.product(P,e)),a=new S(b.x,b.y,b.z),this._x.assign(i),this._y.assign(n),this._z.assign(a),this._directionAxis.assign(this._z)):(this._x.assign(N),this._y.assign(P),this._z.assign(b),this._directionAxis.assign(this._z))}set x_scale(t){this._x_scale!=t*this._x_scale_internal&&(this._x_scale=t*this._x_scale_internal,this._updateId++)}set y_scale(t){this._y_scale!=t*this._y_scale_internal&&(this._y_scale=t*this._y_scale_internal,this._updateId++)}set z_scale(t){this._z_scale!=t*this._z_scale_internal&&(this._z_scale=t*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,this._displacements!=null&&(this._displacements.clear(),this._displacements=null)}setDisplacement(t,e){let s,i;t==null||e==null||this._displacements!=null&&(s=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.delete(s),i=new S,i.assign(e),this._displacements.set(s,i),this._updateId++)}getDisplacenent(t){let e;return this._displacements!=null?(e=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.get(e)):null}setDepthVector(t){let e,s,i;const n=new S(0,1,0),a=new S(0,0,1),o=new S(1,0,0),h=t.x/180*Math.PI,u=t.y/180*Math.PI,c=t.z/180*Math.PI,l=Math.cos(h),_=Math.sin(h),d=S.sum(S.product(n,l),S.product(o,-_)),f=new S(a.x,a.y,a.z),m=S.sum(S.product(n,_),S.product(o,l)),p=Math.cos(u),T=Math.sin(u),v=new S(d.x,d.y,d.z),O=S.sum(S.product(f,p),S.product(m,T)),A=S.sum(S.product(f,-T),S.product(m,p));c!=0?(e=Math.cos(c),s=Math.sin(c),S.sum(S.product(v,e),S.product(O,s)),S.sum(S.product(v,-s),S.product(O,e)),i=new S(A.x,A.y,A.z),this._depth.assign(i)):this._depth.assign(A),this._updateId++}adjustLocation(t,e){if(t==null||this._z==null)return;const s=S.product(this._z,-e),i=new S(t.x+s.x,t.y+s.y,t.z+s.z);this.location=i}getCoordinatePosition(t){if(t==null)return null;const e=S.scalarProjection(t,this._x),s=S.scalarProjection(t,this._y),i=S.scalarProjection(t,this._z);return new S(e,s,i)}getScreenPosition(t){let e=S.dif(t,this._loc);e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale;let s=S.scalarProjection(e,this._depth);if(s<this._clipNear||s>this._clipFar)return null;let i=S.scalarProjection(e,this._x),n=-S.scalarProjection(e,this._y);i=i*this._scale,n=n*this._scale;const a=this.getDisplacenent(t);return a!=null&&(e=S.dif(t,this._loc),e.add(a),e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale,s=S.scalarProjection(e,this._depth)),e.x=i,e.y=n,e.z=s,e}getScreenPoint(t){const e=this.getScreenPosition(t);return e==null?null:new B(e.x,e.y)}getPlanePosition(t,e,s,i){let n,a;const o=t.x/this._scale,h=-t.y/this._scale,u=S.product(this._x,o);u.add(S.product(this._y,h));const c=new S(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);c.add(u);const l=this._z,_=new S(e.x*this._x_scale,e.y*this._y_scale,e.z*this._z_scale),d=new S(s.x*this._x_scale,s.y*this._y_scale,s.z*this._z_scale),f=new S(i.x*this._x_scale,i.y*this._y_scale,i.z*this._z_scale),m=S.crossProduct(d,f),p=new S;return p.assign(on.getIntersectionVector(c,l,_,m)),p!=null?(p.subtract(_),n=S.scalarProjection(p,s)/d.length*s.length,a=S.scalarProjection(p,i)/f.length*i.length,new B(n,a)):null}performZoom(){this.isZoomedIn()?this.scale=on.SCALE_ZOOMED_OUT:this.scale=on.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==on.SCALE_ZOOMED_IN}performZoomOut(){this.scale=on.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=on.SCALE_ZOOMED_IN}};qg.SCALE_ZOOMED_IN=64;qg.SCALE_ZOOMED_OUT=32;let Eh=qg;const WO=class of{static makeRoomPreviewerId(t){return(t&65535)+of.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(t){return t>=of.PREVIEW_ROOM_ID_BASE}};WO.PREVIEW_ROOM_ID_BASE=2147418112;let XO=WO;class Qs{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=ft(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=ft()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}Qs.STATE_NOT_INITIALIZED=0;Qs.STATE_START_DELAY=1;Qs.STATE_RUNNING=2;Qs.STATE_OVER=3;Qs._SafeStr_448=0;Qs._SafeStr_4512=!1;Qs._SafeStr_4513=0;Qs._SafeStr_4514=0;Qs._SafeStr_4515=2e4;Qs._SafeStr_4516=5e3;class Xs{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=ft(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=ft()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}Xs.STATE_NOT_INITIALIZED=0;Xs.STATE_START_DELAY=1;Xs.STATE_RUNNING=2;Xs.STATE_OVER=3;Xs._SafeStr_448=0;Xs._SafeStr_4512=!1;Xs._SafeStr_4514=0;Xs._SafeStr_4515=2e4;Xs._SafeStr_4516=5e3;class kw{static hex2int(t){return parseInt(t,16)}static inkToBlendMode(t){return t=="ADD"||t==33?tt.ADD:t=="SUBTRACT"?tt.SUBTRACT:t=="DARKEN"?tt.DARKEN:tt.NORMAL}}class Nl extends Kt{constructor(t=null){super(t),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._varyingDepth=!1,this._clickHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(t,e){return this._pairedSpriteId===t&&this._pairedSpriteUpdateCounter===e?!1:(this._pairedSpriteId=t,this._pairedSpriteUpdateCounter=e,!0)}calculateVertices(){this.texture.orig&&super.calculateVertices()}setTexture(t){t||(t=_t.EMPTY),t!==this.texture&&(t===_t.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=t)}containsPoint(t){return Nl.containsPoint(this,t)}static containsPoint(t,e){if(!t||!e||t.alphaTolerance>255||!(t instanceof Kt))return!1;if(t.texture===_t.EMPTY||t.blendMode!==tt.NORMAL)return;const s=t.texture,i=s.baseTexture;if(!s||!i||!i.valid)return!1;const n=e.x*t.scale.x,a=e.y*t.scale.y;if(!t.getLocalBounds().contains(n,a)||!i.hitMap&&!Nl.generateHitMap(i))return!1;const o=i.hitMap;let h=n+s.frame.x,u=a+s.frame.y;s.trim&&(h-=s.trim.x,u-=s.trim.y),h=Math.round(h)*i.resolution,u=Math.round(u)*i.resolution;const c=h+u*i.realWidth,l=c%32,_=c/32|0;return(o[_]&1<<l)!==0}static generateHitMap(t){if(!t)return!1;const e=new _t(t),s=new Kt(e),i=Qt.getPixels(s),n=t.width,a=t.height,o=new Uint32Array(Math.ceil(n*a/32)),h=bs.MATCH_OPAQUE_PIXELS;for(let u=0;u<n*a;u++){const c=u%32,l=u/32|0;i[u*4+3]>=h&&(o[l]=o[l]|1<<c)}return t.hitMap=o,s.destroy(),e.destroy(),!0}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get tag(){return this._tag}set tag(t){this._tag=t}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance=t}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){this._varyingDepth=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}}class jw{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(t){this._objectId=t}get spriteTag(){return this._spriteTag}set spriteTag(t){this._spriteTag=t}}const KO=class qO{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-qO.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(t){this._name=t}get sprite(){return this._sprite}set sprite(t){this._sprite=t}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}};KO.Z_INFINITY=1e8;let zw=KO;class Yw{constructor(t,e,s,i,n){this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._SafeStr_795=0,this._id=e,this._container=t,this._geometry=new Eh(n,new S(-135,30,0),new S(11,11,5),new S(-135,.5,0)),this._animationFPS=Q.instance.getConfiguration("system.fps.animation",24),this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new B,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new bw(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(s,i)}setupCanvas(){if(this._master||(this._master=new te,this._master.interactiveChildren=!1),!this._display){const t=new zs;this._master.addChild(t),this._display=t}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const t of this._spritePool)this.cleanSprite(t,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(t,e){if(t=t<1?1:t,e=e<1?1:e,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,t,e).endFill():(this._mask=new Ha().beginFill(16711680).drawRect(0,0,t,e).endFill(),this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const s=this._master.hitArea;s.width=t,s.height=e}else this._master.hitArea=new it(0,0,t,e);if(this._master.filterArea){const s=this._master.filterArea;s.width=t,s.height=e}else this._master.filterArea=new it(0,0,t,e)}this._width=t,this._height=e}setMask(t){t&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!t&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(t,e=null,s=null,i=!1,n=!1){!this._master||!this._display||this._restrictsScaling&&!i||(e||(e=new B(this._width/2,this._height/2)),s||(s=e),e=this._display.toLocal(e),n?this._scale*=t:this._scale=t,this.screenOffsetX=s.x-e.x*this._scale,this.screenOffsetY=s.y-e.y*this._scale)}render(t,e=!1){if(this._canvasUpdated=!1,this._totalTimeRunning+=Xr().deltaTime,this._totalTimeRunning===this._renderTimestamp||(t===-1&&(t=this._renderTimestamp+1),!this._container||!this._geometry))return;(this._width!==this._renderedWidth||this._height!==this._renderedHeight)&&(e=!0),(this._display.x!==this._screenOffsetX||this._display.y!==this._screenOffsetY)&&(this._display.position.set(this._screenOffsetX,this._screenOffsetY),e=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),e=!0),this.doMagic();const s=Math.round(this._totalTimeRunning/(60/this._animationFPS));let i=!1;s!==this._lastFrame&&(this._lastFrame=s,i=!0);let n=0;const a=this._container.objects;if(a.size)for(const h of a.values())h&&(n=n+this.renderObject(h,h.instanceId.toString(),t,e,i,n));this._sortableSprites.sort((h,u)=>u.z-h.z),n<this._sortableSprites.length&&this._sortableSprites.splice(n);let o=0;for(;o<n;){const h=this._sortableSprites[o];h&&h.sprite&&this.renderSprite(o,h),o++}this.cleanSprites(n),(e||i)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(t){this._objectCache.removeObjectCache(t)}renderObject(t,e,s,i,n,a){if(!t)return 0;const o=t.visualization;if(!o)return this.removeFromCache(e),0;const h=this.getCacheItem(e);h.objectId=t.instanceId;const u=h.location,c=h.sprites,l=u.updateLocation(t,this._geometry);if(!l)return this.removeFromCache(e),0;if(n&&o.update(this._geometry,s,!c.isEmpty||i,this._skipObjectUpdate&&this._runningSlow),u.locationChanged&&(i=!0),!c.needsUpdate(o.instanceId,o.updateSpriteCounter)&&!i)return c.spriteCount;let _=l.x,d=l.y,f=l.z;_>0?f=f+_*12e-8:f=f+-_*12e-8,_=_+Math.trunc(this._width/2),d=d+Math.trunc(this._height/2);let m=0;for(const p of o.sprites.values()){if(!p||!p.visible)continue;const T=p.texture,v=T&&T.baseTexture;if(!T||!v)continue;const O=_+p.offsetX+this._screenOffsetX,A=d+p.offsetY+this._screenOffsetY;if(p.flipH){const M=_+-(T.width+-p.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(M,A,T.width,T.height))continue}else if(p.flipV){const M=d+-(T.height+-p.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(O,M,T.width,T.height))continue}else if(!this.isSpriteVisible(O,A,T.width,T.height))continue;let y=c.getSprite(m);y||(y=new zw,c.addSprite(y),this._sortableSprites.push(y),y.name=e),y.sprite=p,(p.spriteType===as.AVATAR||p.spriteType===as.AVATAR_OWN)&&(y.sprite.libraryAssetName="avatar_"+t.id),y.x=O-this._screenOffsetX,y.y=A-this._screenOffsetY,y.z=f+p.relativeDepth+37e-12*a,m++,a++}return c.setSpriteCount(m),this._canvasUpdated=!0,m}getExtendedSprite(t){if(t<0||t>=this._spriteCount)return null;const e=this._display.getChildAt(t);return e||null}getExtendedSpriteIdentifier(t){return t?t.name:""}renderSprite(t,e){if(t>=this._spriteCount)return this.createAndAddSprite(e),!0;if(!e)return!1;const s=e.sprite,i=this.getExtendedSprite(t);if(!s||!i)return!1;if(i.varyingDepth!==s.varyingDepth)return i.varyingDepth&&!s.varyingDepth?(this._display.removeChildAt(t),this._spritePool.push(i),this.renderSprite(t,e)):(this.createAndAddSprite(e,t),!0);if(i.needsUpdate(s.id,s.updateCounter)||Ci.isVisualizationOn()){i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.name=e.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.filters=s.filters;const n=s.alpha/255;i.alpha!==n&&(i.alpha=n),i.tint!==s.color&&(i.tint=s.color),i.blendMode!==s.blendMode&&(i.blendMode=s.blendMode),i.texture!==s.texture&&i.setTexture(s.texture),s.updateContainer&&(i.children.length===1&&i.removeChildAt(0),i.addChild(s.container),s.updateContainer=!1),s.flipH?i.scale.x!==-1&&(i.scale.x=-1):i.scale.x!==1&&(i.scale.x=1),s.flipV?i.scale.y!==-1&&(i.scale.y=-1):i.scale.y!==1&&(i.scale.y=1),this.updateEnterRoomEffect(i,s)}return i.x!==e.x&&(i.x=e.x),i.y!==e.y&&(i.y=e.y),i.offsetX=s.offsetX,i.offsetY=s.offsetY,!0}createAndAddSprite(t,e=-1){const s=t.sprite;if(!s)return;let i=null;this._spritePool.length>0&&(i=this._spritePool.pop()),i||(i=new Nl),i.children.length&&i.removeChildren(),i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.alpha=s.alpha/255,i.tint=s.color,i.x=t.x,i.y=t.y,i.offsetX=s.offsetX,i.offsetY=s.offsetY,i.name=s.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.blendMode=s.blendMode,i.filters=s.filters,i.setTexture(s.texture),s.updateContainer&&(i.addChild(s.container),s.updateContainer=!1),s.flipH&&(i.scale.x=-1),s.flipV&&(i.scale.y=-1),this.updateEnterRoomEffect(i,s),e<0||e>=this._spriteCount?(this._display.addChild(i),this._spriteCount++):this._display.addChildAt(i,e),this._activeSpriteCount++}cleanSprites(t,e=!1){if(this._display){if(t<0&&(t=0),t<this._activeSpriteCount||!this._activeSpriteCount){let s=this._spriteCount-1;for(;s>=t;)this.cleanSprite(this.getExtendedSprite(s),e),s--}this._activeSpriteCount=t}}updateEnterRoomEffect(t,e){if(!(!Ci.isVisualizationOn()||!e))switch(e.spriteType){case as.AVATAR_OWN:return;case as.ROOM_PLANE:t.alpha=Ci.getDelta(.9);return;case as.AVATAR:t.alpha=Ci.getDelta(.5);return;default:t.alpha=Ci.getDelta(.1)}}cleanSprite(t,e){t&&(e?(t.parent&&t.parent.removeChild(t),t.destroy({children:!0})):t.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(t){this._mouseListener=t}getCacheItem(t){return this._objectCache.getObjectCache(t)}isSpriteVisible(t,e,s,i){return!!(this._noSpriteVisibilityChecking||(t=(t-this._screenOffsetX)*this._scale+this._screenOffsetX,e=(e-this._screenOffsetY)*this._scale+this._screenOffsetY,s=s*this._scale,i=i*this._scale,t<this._width&&t+s>=0&&e<this._height&&e+i>=0&&!this._usesExclusionRectangles))}handleMouseEvent(t,e,s,i,n,a,o){return t=t-this._screenOffsetX,e=e-this._screenOffsetY,this._mouseLocation.x=t/this._scale,this._mouseLocation.y=e/this._scale,this._mouseCheckCount>0&&s==k.MOUSE_MOVE?this._mouseSpriteWasHit:(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(t/this._scale),Math.trunc(e/this._scale),s,i,n,a,o),this._mouseCheckCount++,this._mouseSpriteWasHit)}checkMouseHits(t,e,s,i=!1,n=!1,a=!1,o=!1){const h=[];let u=!1,c=null,l=this._activeSpriteCount-1;for(;l>=0;){const f=this.getExtendedSprite(l);if(f&&f.containsPoint(new B(t-f.x,e-f.y))&&!(f.clickHandling&&(s===k.MOUSE_CLICK||s===k.DOUBLE_CLICK))){const m=this.getExtendedSpriteIdentifier(f);if(h.indexOf(m)===-1){const p=f.tag;let T=this._mouseActiveObjects.get(m);T&&T.spriteTag!==p&&(c=this.createMouseEvent(0,0,0,0,k.ROLL_OUT,T.spriteTag,i,n,a,o),this.bufferMouseEvent(c,m)),s===k.MOUSE_MOVE&&(!T||T.spriteTag!==p)?c=this.createMouseEvent(t,e,t-f.x,e-f.y,k.ROLL_OVER,p,i,n,a,o):(c=this.createMouseEvent(t,e,t-f.x,e-f.y,s,p,i,n,a,o),c.spriteOffsetX=f.offsetX,c.spriteOffsetY=f.offsetY),T||(T=new jw,T.objectId=m,this._mouseActiveObjects.set(m,T)),T.spriteTag=p,(s!==k.MOUSE_MOVE||t!==this._mouseOldX||e!==this._mouseOldY)&&this.bufferMouseEvent(c,m),h.push(m)}u=!0}l--}const _=[];for(const f of this._mouseActiveObjects.keys())f&&_.push(f);let d=0;for(;d<_.length;){const f=_[d];h.indexOf(f)>=0&&(_[d]=null),d++}for(d=0;d<_.length;){const f=_[d];if(f!==null){const m=this._mouseActiveObjects.get(f);m&&this._mouseActiveObjects.delete(f);const p=this.createMouseEvent(0,0,0,0,k.ROLL_OUT,m.spriteTag,i,n,a,o);this.bufferMouseEvent(p,f)}d++}return this.processMouseEvents(),this._mouseOldX=t,this._mouseOldY=e,u}createMouseEvent(t,e,s,i,n,a,o,h,u,c){const l=t-this._width/2,_=e-this._height/2,d=`canvas_${this._id}`;return new yF(n,d+"_"+this._eventId,d,a,l,_,s,i,h,o,u,c)}bufferMouseEvent(t,e){!t||!this._eventCache||(this._eventCache.delete(e),this._eventCache.set(e,t))}processMouseEvents(){if(!(!this._container||!this._eventCache)){for(const[t,e]of this._eventCache.entries()){if(!this._eventCache)return;if(!e)continue;const s=this._container.getRoomObject(parseInt(t));if(s)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(e,s,this._geometry);else{const i=s.mouseHandler;i&&i.mouseEvent(e,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const t=this._scale,e=this._screenOffsetX,s=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const i=this._display.getBounds(),n=we.create({width:this._display.width,height:this._display.height});return Me.instance.renderer.render(this._display,{renderTexture:n,clear:!0,transform:new Vt(1,0,0,1,-i.x,-i.y)}),this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(t,null,null,!0),this._screenOffsetX=e,this._screenOffsetY=s,n}doMagic(){const t=this.geometry;if(this._rotation!==0){let e=this._effectDirection;t.direction=new S(e.x+this._rotation,e.y,e.z),e=t.direction,t.setDepthVector(new S(e.x,e.y,5));const s=new S;s.assign(this._rotationOrigin),s.x=s.x+this._rotationRodLength*Math.cos((e.x+180)/180*3.14159265358979)*Math.cos(e.y/180*3.14159265358979),s.y=s.y+this._rotationRodLength*Math.sin((e.x+180)/180*3.14159265358979)*Math.cos(e.y/180*3.14159265358979),s.z=s.z+this._rotationRodLength*Math.sin(e.y/180*3.14159265358979),t.location=s,this._effectLocation=new S,this._effectLocation.assign(s),this._effectDirection=new S,this._effectDirection.assign(t.direction)}if(Xs.isVisualizationOn()&&!this._SafeStr_4507?this.changeShaking():!Xs.isVisualizationOn()&&this._SafeStr_4507&&this.changeShaking(),Qs.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const e=this._effectDirection,s=S.sum(e,new S(Math.sin(this._SafeStr_795*5/180*3.14159265358979)*2,Math.sin(this._SafeStr_795/180*3.14159265358979)*5,Math.sin(this._SafeStr_795*10/180*3.14159265358979)*2));t.direction=s}else this._SafeStr_795=0,t.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const t=this.geometry.direction;this._effectDirection=new S(t.x,t.y,t.z)}}changeRotation(){if(this._SafeStr_4507)return;const t=this.geometry;if(t){if(this._rotation===0){const e=t.location,s=t.directionAxis;this._effectLocation=new S,this._effectLocation.assign(e),this._effectDirection=new S,this._effectDirection.assign(t.direction);const i=Eh.getIntersectionVector(e,s,new S(0,0,0),new S(0,0,1));i!==null&&(this._rotationOrigin=new S(i.x,i.y,i.z),this._rotationRodLength=S.dif(i,e).length,this._rotation=1);return}this._rotation=0,t.location=this._effectLocation,t.direction=this._effectDirection,t.setDepthVector(new S(this._effectDirection.x,this._effectDirection.y,5))}}moveLeft(){if(this._rotation!==0){this._rotation===1?this._rotation=-1:this._rotation=this._rotation-1;return}const t=this.geometry,e=(t.direction.x-90)/180*3.14159265358979;t.location=S.sum(t.location,new S(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveRight(){if(this._rotation!==0){this._rotation===-1?this._rotation=1:this._rotation=this._rotation+1;return}const t=this.geometry,e=(t.direction.x+90)/180*3.14159265358979;t.location=S.sum(t.location,new S(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveUp(){if(this._rotation!==0)return;const t=this.geometry,e=t.direction.x/180*3.14159265358979;t.location=S.sum(t.location,new S(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveDown(){if(this._rotation!==0)return;const t=this.geometry,e=(t.direction.x+180)/180*3.14159265358979;t.location=S.sum(t.location,new S(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(t){t=Math.trunc(t),this._mouseLocation.x=this._mouseLocation.x-(t-this._screenOffsetX),this._screenOffsetX=t}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(t){t=Math.trunc(t),this._mouseLocation.y=this._mouseLocation.y-(t-this._screenOffsetY),this._screenOffsetY=t}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(t){this._canvasUpdated=t}}class Ww{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[t,e]of this._canvases.entries())this._canvases.delete(t),e&&e.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(t){return t?t.instanceId:-1}getRoomObject(t){return this._objects.get(t)}addObject(t){t&&this._objects.set(this.getInstanceId(t),t)}removeObject(t){const e=this.getInstanceId(t);this._objects.delete(e);for(const s of this._canvases.values()){if(!s)continue;s.removeFromCache(e.toString())}}render(t,e=!1){if(!(!this._canvases||!this._canvases.size))for(const s of this._canvases.values())s&&s.render(t,e)}update(t,e=!1){if(!(!this._canvases||!this._canvases.size)){this.render(t,e);for(const s of this._canvases.values())s&&s.update()}}getCanvas(t){const e=this._canvases.get(t);return e||null}createCanvas(t,e,s,i){const n=this._canvases.get(t);if(n)return n.initialize(e,s),n.geometry&&(n.geometry.scale=i),n;const a=this.createSpriteCanvas(t,e,s,i);if(a)return this._canvases.set(t,a),a}createSpriteCanvas(t,e,s,i){return new Yw(this,t,e,s,i)}removeCanvas(t){const e=this._canvases.get(t);e&&(this._canvases.delete(t),e.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(t){this._roomObjectVariableAccurateZ=t}}class Xw{createRenderer(){return new Ww}}class Kw extends ds{constructor(t,e){super(),this._id=t,this._container=e,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new xO}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(t){if(t!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=t,!!this._renderer&&(this._renderer.reset(),this._managers.size)))for(const e of this._managers.values()){if(!e)continue;const s=e.objects;if(s.length)for(const i of s.getValues())i&&this._renderer.addObject(i)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(t){const e=this._managers.get(t);return e||null}getManagerOrCreate(t){let e=this.getManager(t);return e||(e=this._container.createRoomObjectManager(t),e?(this._managers.set(t,e),e):null)}getTotalObjectsForManager(t){const e=this.getManager(t);return e?e.totalObjects:0}getRoomObject(t,e){const s=this.getManager(e);if(!s)return null;const i=s.getObject(t);return i||null}getRoomObjectsForCategory(t){const e=this.getManager(t);return e?e.objects.getValues():[]}getRoomObjectByIndex(t,e){const s=this.getManager(e);if(!s)return null;const i=s.getObjectByIndex(t);return i||null}createRoomObject(t,e,s,i){const n=this.getManagerOrCreate(i);if(!n)return null;const a=n.createObject(t,e,s);return a?(this._renderer&&this._renderer.addObject(a),a):null}createRoomObjectAndInitalize(t,e,s){return this._container?this._container.createRoomObjectAndInitalize(this._id,t,e,s):null}removeRoomObject(t,e){const s=this.getManager(e);if(!s)return;const i=s.getObject(t);i&&(i.tearDown(),this._renderer&&this._renderer.removeObject(i),s.removeObject(t))}removeAllManagers(){for(const t of this._managers.values())if(t){if(this._renderer){const e=t.objects;if(e.length)for(const s of e.getValues())s&&this._renderer.removeObject(s)}t.dispose()}this._managers.clear()}addUpdateCategory(t){this._updateCategories.indexOf(t)>=0||this._updateCategories.push(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);e!==-1&&this._updateCategories.splice(e,1)}update(t,e=!1){for(const s of this._updateCategories){const i=this.getManager(s);if(!i)continue;const n=i.objects;if(n.length)for(const a of n.getValues()){if(!a)continue;const o=a.logic;o&&o.update(t)}}this._renderer&&this._renderer.update(t,e)}hasUninitializedObjects(){for(const t of this._managers.values())if(t){for(const e of t.objects.getValues())if(e&&!e.isReady)return!0}return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}const QO=class hf{constructor(t,e,s,i,n,a,o){this._layerTags=[],this._primaryColor=t&16777215,this._secondaryColor=e&16777215,this._breed=s,this._tag=i>-1&&i<hf.COLOR_TAGS.length?hf.COLOR_TAGS[i]:"",this._id=n,this._isMaster=a,this._layerTags=o}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}};QO.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];let qw=QO;const ze=class ve{constructor(){this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._gifCollections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[],this._dataInitialized=!1}initialize(t){this._stateEvents=t,this.setFurnitureData();for(const[e,s]of at.getValue("pet.types").entries())this._pets[s]=e}dispose(){}setSessionDataManager(t){this._sessionDataManager=t,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager){this._waitingForSessionDataManager=!0;return}const t=this._sessionDataManager.getAllFurnitureData(this);t&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(t),this._stateEvents.dispatchEvent(new It(ve.LOADER_READY)))}processFurnitureData(t){if(t)for(const e of t){if(!e)continue;const s=e.id;let i=e.className;e.hasIndexedColor&&(i=i+"*"+e.colorIndex);const n=e.revision,a=e.adUrl;a&&a.length>0&&this._objectTypeAdUrls.set(i,a);let o=e.className;e.type===Tn.FLOOR?(this._activeObjectTypes.set(s,i),this._activeObjectTypeIds.set(i,s),this._activeObjects[o]||(this._activeObjects[o]=1)):e.type===Tn.WALL&&(o==="post.it"&&(i="post_it",o="post_it"),o==="post.it.vd"&&(i="post_it_vd",o="post_id_vd"),this._wallItemTypes.set(s,i),this._wallItemTypeIds.set(i,s),this._wallItems[o]||(this._wallItems[o]=1));const h=this._furniRevisions.get(o);n>h&&(this._furniRevisions.delete(o),this._furniRevisions.set(o,n))}}getFurnitureFloorNameForTypeId(t){const e=this._activeObjectTypes.get(t);return this.removeColorIndex(e)}getFurnitureWallNameForTypeId(t,e=null){let s=this._wallItemTypes.get(t);return s==="poster"&&e!==null&&(s=s+e),this.removeColorIndex(s)}getFurnitureFloorColorIndex(t){const e=this._activeObjectTypes.get(t);return e?this.getColorIndexFromName(e):-1}getFurnitureWallColorIndex(t){const e=this._wallItemTypes.get(t);return e?this.getColorIndexFromName(e):-1}getColorIndexFromName(t){if(!t)return-1;const e=t.indexOf("*");return e===-1?0:parseInt(t.substr(e+1))}removeColorIndex(t){if(!t)return null;const e=t.indexOf("*");return e===-1?t:t.substr(0,e)}getRoomObjectAdUrl(t){const e=this._objectTypeAdUrls.get(t);return e||""}getPetColorResult(t,e){const s=this._petColors.get(t);return s?s.get(e):null}getPetColorResultsForTag(t,e){const s=this._petColors.get(t),i=[];if(s)for(const n of s.values())n.tag===e&&i.push(n);return i}getCollection(t){if(!t)return null;const e=this._collections.get(t);if(!e){const s=Cs().getCollection(t);return s?(this._collections.set(t,s),s):null}return e}getGifCollection(t){return t&&this._gifCollections.get(t)||null}getImage(t){if(!t)return null;const e=this._images.get(t);if(!e)return null;const s=new Image;return s.src=e.src,s}addAssetToCollection(t,e,s,i=!0){const n=this.getCollection(t);return n?n.addAsset(e,s,i,0,0,!1,!1):!1}createGifCollection(t,e,s){if(!t||!e||!s)return null;const i=new gF(t,e,s);return this._gifCollections.set(t,i),i}createCollection(t,e){if(!t||!e)return null;const s=new dR(t,e);this._collections.set(s.name,s);const i=this._pets[s.name];if(i!==void 0){const n=s.getPaletteNames(),a=new Map;for(const o of n){const h=s.getPalette(o),u=t.palettes[o],c=h.primaryColor,l=h.secondaryColor,_=u.breed!==void 0?u.breed:0,d=u.colorTag!==void 0?u.colorTag:-1,f=u.master!==void 0?u.master:!1,m=u.tags!==void 0?u.tags:[];a.set(parseInt(o),new qw(c,l,_,d,o,f,m))}this._petColors.set(i,a)}}getPlaceholderName(t){switch(this.getCategoryForType(t)){case L.FLOOR:return ve.PLACE_HOLDER;case L.WALL:return ve.PLACE_HOLDER_WALL;default:return this._pets[t]!==void 0?ve.PLACE_HOLDER_PET:ve.PLACE_HOLDER_DEFAULT}}getCategoryForType(t){return t?this._activeObjects[t]!==void 0?L.FLOOR:this._wallItems[t]!==void 0?L.WALL:this._pets[t]!==void 0?L.UNIT:t.indexOf("poster")===0?L.WALL:t==="room"?L.ROOM:t===Dt.USER||t===Dt.PET||t===Dt.BOT||t===Dt.RENTABLE_BOT?L.UNIT:t===ve.TILE_CURSOR||t===ve.SELECTION_ARROW?L.CURSOR:L.MINIMUM:L.MINIMUM}getPetNameForType(t){return at.getValue("pet.types")[t]||null}isLoaderType(t){return t=Dt.getRealType(t),t!==F.USER}downloadImage(t,e,s,i=null){let n=null,a=[];if(e&&e.indexOf(",")>=0&&(n=e,e=n.split(",")[0]),n?a=this.getAssetUrls(n,s,!0):a=this.getAssetUrls(e,s,!0),a&&a.length){const o=a[0],h=new Image;return h.src=o,h.onload=()=>{h.onerror=null,this._images.set([e,s].join("_"),h),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!0)},h.onerror=()=>{h.onload=null,Y.error("Failed to download asset",o),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!1)},!0}return!1}async downloadAsset(t,e){var i;const s=(i=this.getAssetUrls(t))==null?void 0:i[0];if(!(!s||!s.length)&&!(this._pendingContentTypes.indexOf(t)>=0||this.getOrRemoveEventDispatcher(t))){this._pendingContentTypes.push(t),this._events.set(t,e);try{const n=await fetch(s);let a="application/octet-stream";switch(n.headers.has("Content-Type")&&(a=n.headers.get("Content-Type")),a){case"application/octet-stream":{const o=new iR(await n.arrayBuffer());await this.processAsset(o.baseTexture,o.jsonFile);const h=this._events.get(t);if(!h)return;h.dispatchEvent(new dr(dr.RCLE_SUCCESS,t));break}default:throw new Error}}catch{e.dispatchEvent(new dr(dr.RCLE_FAILURE,t))}}}async processAsset(t,e){const s=e.spritesheet;if(!t||!s||!Object.keys(s).length){this.createCollection(e,null);return}const i=async()=>{const n=new bg(t,s);await n.parse(),this.createCollection(e,n)};t.valid?await i():await new Promise((n,a)=>{t.once("update",async()=>(await i(),n()))})}setAssetAliasName(t,e){this._objectAliases.set(t,e),this._objectOriginalNames.set(e,t)}getAssetAliasName(t){const e=this._objectAliases.get(t);return e||t}getAssetOriginalName(t){const e=this._objectOriginalNames.get(t);return e||t}getAssetUrls(t,e=null,s=!1){switch(t){case ve.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(ve.PLACE_HOLDER)];case ve.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(ve.PLACE_HOLDER_WALL)];case ve.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(ve.PLACE_HOLDER_PET)];case ve.ROOM:return[this.getAssetUrlWithGenericBase("room")];case ve.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(ve.TILE_CURSOR)];case ve.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(ve.SELECTION_ARROW)];default:{const i=this.getCategoryForType(t);if(i===L.FLOOR||i===L.WALL){const n=this.getAssetAliasName(t);let a=s?this.getAssetUrlWithFurniIconBase(n):this.getAssetUrlWithFurniBase(t);if(s){const o=e&&e!==""&&this._activeObjectTypeIds.has(n+"*"+e);a=a.replace(/%param%/gi,o?"_"+e:"")}return[a]}return i===L.UNIT?[this.getAssetUrlWithPetBase(t)]:null}}}getAssetIconUrl(t,e){let s=null,i=[];return t&&t.indexOf(",")>=0&&(s=t,t=s.split(",")[0]),s?i=this.getAssetUrls(s,e,!0):i=this.getAssetUrls(t,e,!0),i&&i.length?i[0]:null}getAssetUrlWithGenericBase(t){return at.getValue("generic.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniBase(t){return at.getValue("furni.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniIconBase(t){return at.getValue("furni.asset.icon.url").replace(/%libname%/gi,t)}getAssetUrlWithPetBase(t){return at.getValue("pet.asset.url").replace(/%libname%/gi,t)}setRoomObjectRoomId(t,e){const s=t&&t.model;s&&s.setValue(I.OBJECT_ROOM_ID,e)}getOrRemoveEventDispatcher(t,e=!1){const s=this._events.get(t);return e&&this._events.delete(t),s}setIconListener(t){this._iconListener=t}};ze.PLACE_HOLDER="place_holder";ze.PLACE_HOLDER_WALL="place_holder_wall";ze.PLACE_HOLDER_PET="place_holder_pet";ze.PLACE_HOLDER_DEFAULT=ze.PLACE_HOLDER;ze.ROOM="room";ze.TILE_CURSOR="tile_cursor";ze.SELECTION_ARROW="selection_arrow";ze.LOADER_READY="RCL_LOADER_READY";ze.MANDATORY_LIBRARIES=[ze.PLACE_HOLDER,ze.PLACE_HOLDER_WALL,ze.PLACE_HOLDER_PET,ze.ROOM,ze.TILE_CURSOR,ze.SELECTION_ARROW];let Ju=ze;class Qw{constructor(){this._objects=new de,this._objectsPerType=new de}dispose(){this.removeAllObjects()}getObject(t){const e=this._objects.getValue(t);return e||null}getObjectByIndex(t){const e=this._objects.getWithIndex(t);return e||null}createObject(t,e,s){const i=new yw(t,e,s);return this.addObject(t,s,i)}addObject(t,e,s){if(this._objects.getValue(t))return s.dispose(),null;this._objects.add(t,s);const i=this.getTypeMap(e);return i&&i.add(t,s),s}removeObject(t){const e=this._objects.remove(t);if(e){const s=this.getTypeMap(e.type);s&&s.remove(e.id),e.dispose()}}removeAllObjects(){let t=0;for(;t<this._objects.length;){const e=this._objects.getWithIndex(t);e&&e.dispose(),t++}for(this._objects.reset(),t=0;t<this._objectsPerType.length;){const e=this._objectsPerType.getWithIndex(t);e&&e.dispose(),t++}this._objectsPerType.reset()}getTypeMap(t,e=!0){let s=this._objectsPerType.getValue(t);return!s&&e&&(s=new de,this._objectsPerType.add(t,s)),s}get objects(){return this._objects}get totalObjects(){return this._objects.length}}const kn=class di extends Rr{constructor(t,e,s){super(),this._state=di.ROOM_MANAGER_LOADED,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=t,this._visualizationFactory=e,this._logicFactory=s,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener(dr.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener(dr.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener(dr.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=di.ROOM_MANAGER_INITIALIZING||!this._contentLoader)return;const t=Ju.MANDATORY_LIBRARIES;for(const e of t)e&&this._initialLoadList.indexOf(e)===-1&&(this._contentLoader.downloadAsset(e,this.events),this._initialLoadList.push(e));this._state=di.ROOM_MANAGER_INITIALIZING}getRoomInstance(t){const e=this._rooms.get(t);return e||null}createRoomInstance(t){if(this._rooms.get(t))return null;const e=new Kw(t,this);if(this._rooms.set(e.id,e),this._updateCategories.length)for(const s of this._updateCategories)e.addUpdateCategory(s);return e}removeRoomInstance(t){const e=this._rooms.get(t);return e?(this._rooms.delete(t),e.dispose(),!0):!1}createRoomObjectAndInitalize(t,e,s,i){const n=this.getRoomInstance(t);if(!n)return null;let a=s,o=s,h=s,u=null,c=!1;if(this._contentLoader.isLoaderType(s)){if(u=this._contentLoader.getCollection(s),!u&&(c=!0,this._contentLoader.downloadAsset(s,this.events),h=this._contentLoader.getPlaceholderName(s),u=this._contentLoader.getCollection(h),!u))return null;a=u.data.visualizationType,o=u.data.logicType}const l=n.createRoomObject(e,1,s,i);if(!l)return null;if(this._visualizationFactory){const _=this._visualizationFactory.getVisualization(a);if(!_)return n.removeRoomObject(e,i),null;_.asset=u;const d=this._visualizationFactory.getVisualizationData(h,a,u&&u.data||null);if(!d||!_.initialize(d))return n.removeRoomObject(e,i),null;l.setVisualization(_)}if(this._logicFactory){const _=this._logicFactory.getLogic(o);l.setLogic(_),_&&_.initialize(u&&u.data||null)}return c||(l.isReady=!0),this._contentLoader.setRoomObjectRoomId(l,t),l}reinitializeRoomObjectsByType(t){if(!t||!this._contentLoader||!this._visualizationFactory||!this._logicFactory)return;const e=this._contentLoader.getCollection(t);if(!e)return;const s=e.data.visualizationType,i=e.data.logicType,n=this._visualizationFactory.getVisualizationData(t,s,e.data);for(const a of this._rooms.values())if(a){for(const[o,h]of a.managers.entries())if(h)for(const u of h.objects.getValues()){if(!u||u.type!==t)continue;const c=this._visualizationFactory.getVisualization(s);if(c)if(c.asset=e,!n||!c.initialize(n))h.removeObject(u.id);else{u.setVisualization(c);const l=this._logicFactory.getLogic(i);u.setLogic(l),l&&l.initialize(e.data),u.isReady=!0,this._listener&&this._listener.objectInitialized(a.id,u.id,o)}else h.removeObject(u.id)}}}addUpdateCategory(t){if(!(this._updateCategories.indexOf(t)>=0)&&(this._updateCategories.push(t),!!this._rooms.size))for(const s of this._rooms.values())s&&s.addUpdateCategory(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);if(e!==-1&&(this._updateCategories.splice(e,1),!!this._rooms.size))for(const s of this._rooms.values())s&&s.removeUpdateCategory(t)}setContentLoader(t){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=t}processPendingContentTypes(t){if(this._skipContentProcessing){this._skipContentProcessing=!1;return}for(;this._pendingContentTypes.length;){const e=this._pendingContentTypes.shift();if(!this._contentLoader.getCollection(e)){this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!1),Y.log("Invalid Collection",e);continue}this.reinitializeRoomObjectsByType(e),this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(e)}}removeFromInitialLoad(t){if(!(!t||this._state===di.ROOM_MANAGER_ERROR))if(this._contentLoader||(this._state=di.ROOM_MANAGER_ERROR),this._contentLoader.getCollection(t)){const e=this._initialLoadList.indexOf(t);e>=0&&this._initialLoadList.splice(e,1),this._initialLoadList.length||(this._state=di.ROOM_MANAGER_INITIALIZED,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=di.ROOM_MANAGER_ERROR,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(t){if(!this._contentLoader)return;const e=t.contentType;this._pendingContentTypes.indexOf(e)>=0||this._pendingContentTypes.push(e)}update(t,e=!1){if(this.processPendingContentTypes(t),!!this._rooms.size)for(const s of this._rooms.values())s&&s.update(t,e)}createRoomObjectManager(t){return new Qw}get rooms(){return this._rooms}get disposed(){return this._disposed}};kn.ROOM_MANAGER_ERROR=-1;kn.ROOM_MANAGER_LOADING=0;kn.ROOM_MANAGER_LOADED=1;kn.ROOM_MANAGER_INITIALIZING=2;kn.ROOM_MANAGER_INITIALIZED=3;kn.CONTENT_PROCESSING_TIME_LIMIT_MILLISECONDS=40;let Zw=kn;class Jw{constructor(t,e=-1,s=null,i=null,n=null){this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=t,this._minLevel=e,this._texture=s,this._colorMatrix=i,this._blendMode=n}get name(){return this._name}get texture(){return this._texture}set texture(t){this._texture=t}get colorMatrix(){return this._colorMatrix}set colorMatrix(t){this._colorMatrix=t}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode=t}get minLevel(){return this._minLevel}}class $w{constructor(){this._effects=new Map,this._events=new vs,this._isLoaded=!1}init(){if(this._isLoaded)return;this._isLoaded=!0;const t=at.getValue("image.library.url")+"Habbo-Stories/",e=at.getValue("camera.available.effects");for(const s of e){if(!s.enabled)continue;const i=new Jw(s.name,s.minLevel);s.colorMatrix.length?i.colorMatrix=s.colorMatrix:(i.texture=_t.from(t+s.name+".png"),i.blendMode=s.blendMode),this._effects.set(i.name,i)}this.events.dispatchEvent(new Wd(Wd.INITIALIZED))}applyEffects(t,e,s){const i=new zs,n=new te(t);i.addChild(n),s&&n.scale.set(2);for(const a of e){const o=a.effect;if(o)if(o.colorMatrix){const h=new Ml;h.matrix=o.colorMatrix,h.alpha=a.alpha,n.filters||(n.filters=[]),n.filters.push(h)}else{const h=new te(o.texture);h.alpha=a.alpha,h.blendMode=o.blendMode,i.addChild(h)}}return Qt.generateImage(i)}get effects(){return this._effects}get events(){return this._events}get isLoaded(){return this._isLoaded}}class Gst{constructor(t,e){this._effect=t,this._alpha=e}get effect(){return this._effect}get alpha(){return this._alpha}}class tG{flush(){return this._canShowInterstitial=!1,!0}parse(t){return t?(this._canShowInterstitial=t.readBoolean(),!0):!1}get canShowInterstitial(){return this._canShowInterstitial}}class eG{flush(){return this._errorCode=0,this._filteredText=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._filteredText=t.readString(),!0):!1}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class sG{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(t){return t?(this._isOpen=t.readBoolean(),this._onShutdown=t.readBoolean(),t.bytesAvailable&&(this._isAuthenticUser=t.readBoolean()),!0):!1}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class rG{flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(t){return t?(this._isOpen=t.readInt()>0,this._minutesUntilChange=t.readInt(),!0):!1}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class iG{flush(){return this._openHour=0,this._openMinute=0,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class nG{flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),this._userThrownOutAtClose=t.readBoolean(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class aG{flush(){return this._minutes=0,!0}parse(t){return t?(this._minutes=t.readInt(),!0):!1}get openMinute(){return this._minutes}}class oG{flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(t){return t?(this._isInMaintenance=t.readBoolean(),this._minutesUntilMaintenance=t.readInt(),t.bytesAvailable&&(this._duration=t.readInt()),!0):!1}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class hG{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class uG{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class lG{flush(){return this._figure="",this._gender="",!0}parse(t){return t?(this._figure=t.readString(),this._gender=t.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class _G{constructor(t){this._slotId=t.readInt(),this._figureString=t.readString(),this._gender=t.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class cG{flush(){return this._state=0,this._outfits=[],!0}parse(t){if(!t)return!1;this._state=t.readInt();let e=t.readInt();for(;e>0;)this._outfits.push(new _G(t)),e--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class Qg{constructor(t){if(!t)throw new Error("invalid_parser");this._id=t.readInt(),this._name=t.readString(),this._motto=t.readString(),this._gender=t.readString(),this._figure=t.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class dG{flush(){return this._item=null,this._openInventory=!1,!0}parse(t){return t?(this._item=new Qg(t),this._openInventory=t.readBoolean(),!0):!1}get item(){return this._item}openInventory(){return this._openInventory}}class fG{flush(){return this._items=null,!0}parse(t){this._items=new Map;let e=t.readInt();for(;e>0;){const s=new Qg(t);this._items.set(s.id,s),e--}return!0}get items(){return this._items}}class gG{flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(t){return t?(this._boughtAsGift=t.readBoolean(),this._item=new Qg(t),!0):!1}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class EG{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class pG{constructor(t){this._name=t.readString(),this._id=t.readInt(),this._consequence=t.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class mG{constructor(t){this._topics=[],this._name=t.readString();let e=t.readInt();for(;e>0;)this._topics.push(new pG(t)),e--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class IG{constructor(t){this._tradeLockInfo="",this._machineBanInfo="",this._name=t.readString(),this._sanctionLengthInHours=t.readInt(),this._probationDays=t.readInt(),this._avatarOnly=t.readBoolean(),t.bytesAvailable&&(this._tradeLockInfo=t.readString()),t.bytesAvailable&&(this._machineBanInfo=t.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class TG{flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(t){return t?(this._issueId=t.readInt(),this._accountId=t.readInt(),this._sanctionType=new IG(t),!0):!1}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class RG{flush(){return this._callForHelpCategories=null,!0}parse(t){if(!t)return!1;this._callForHelpCategories=[];let e=t.readInt();for(;e>0;)this._callForHelpCategories.push(new mG(t)),e--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class OG{flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(t){return t?(this._isSanctionNew=t.readBoolean(),this._isSanctionActive=t.readBoolean(),this._sanctionName=t.readString(),this._sanctionLengthHours=t.readInt(),t.readInt(),this._sanctionReason=t.readString(),this._sanctionCreationTime=t.readString(),this._probationHoursLeft=t.readInt(),this._nextSanctionName=t.readString(),this._nextSanctionLengthHours=t.readInt(),t.readInt(),this._hasCustomMute=t.readBoolean(),t.bytesAvailable&&(this._tradeLockExpiryTime=t.readString()),!0):!1}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class vG{constructor(){this._ok=!1,this._secondsToWait=0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._secondsToWait=t.readInt(),this._ok&&t.bytesAvailable&&(this._extraDataId=t.readString()),!0):!1}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class AG{flush(){return!0}parse(t){return!!t}}class SG{flush(){return this._url="",!0}parse(t){return t?(this._url=t.readString(),!0):!1}get url(){return this._url}}class yG{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._errorReason=t.readString(),!0):!1}get ok(){return this._ok}get errorReason(){return this._errorReason}}class MG{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(t){return t?(this._creditPrice=t.readInt(),this._ducketPrice=t.readInt(),t.bytesAvailable&&(this._publishDucketPrice=t.readInt()),!0):!1}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class CG{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(t){return t?(t.bytesAvailable&&(this._ok=t.readBoolean(),this._renderLimitHit=t.readBoolean()),!0):!1}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class Zg{parse(t){if(!t)return!1;this._campaignName=t.readString(),this._campaignImage=t.readString(),this._currentDay=t.readInt(),this._campaignDays=t.readInt(),this._openedDays=[];let e=t.readInt();for(let s=0;s<e;s++)this._openedDays.push(t.readInt());this._missedDays=[],e=t.readInt();for(let s=0;s<e;s++)this._missedDays.push(t.readInt());return!0}clone(){const t=new Zg;return t.campaignDays=this._campaignDays,t.campaignImage=this._campaignImage,t.campaignName=this._campaignName,t.currentDay=this._currentDay,t.missedDays=this._missedDays,t.openedDays=this._openedDays,t}get campaignName(){return this._campaignName}set campaignName(t){this._campaignName=t}get campaignImage(){return this._campaignImage}set campaignImage(t){this._campaignImage=t}get currentDay(){return this._currentDay}set currentDay(t){this._currentDay=t}get campaignDays(){return this._campaignDays}set campaignDays(t){this._campaignDays=t}get openedDays(){return this._openedDays}set openedDays(t){this._openedDays=t}get missedDays(){return this._missedDays}set missedDays(t){this._missedDays=t}}class NG{flush(){return this._calendarData=null,!0}parse(t){return t?(this._calendarData=new Zg,this._calendarData.parse(t),!0):!1}get calendarData(){return this._calendarData}}class bG{flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,!0}parse(t){return t?(this._doorOpened=t.readBoolean(),this._productName=t.readString(),this._customImage=t.readString(),this._furnitureClassName=t.readString(),!0):!1}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class PG{flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(t){return t?(this._productType=t.readString(),this._productClassId=t.readInt(),this._totalCoinsForBonus=t.readInt(),this._coinsStillRequiredToBuy=t.readInt(),!0):!1}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class DG{flush(){return this._furniCount=0,!0}parse(t){return t?(this._furniCount=t.readInt(),!0):!1}get furniCount(){return this._furniCount}}class LG{flush(){return this._secondsLeft=0,this._furniLimit=0,this._maxFurniLimit=0,this._secondsLeftWithGrace=0,!0}parse(t){return t?(this._secondsLeft=t.readInt(),this._furniLimit=t.readInt(),this._maxFurniLimit=t.readInt(),t.bytesAvailable?this._secondsLeftWithGrace=t.readInt():this._secondsLeftWithGrace=this._secondsLeft,!0):!1}get secondsLeft(){return this._secondsLeft}get furniLimit(){return this._furniLimit}get maxFurniLimit(){return this._maxFurniLimit}get secondsLeftWithGrace(){return this._secondsLeftWithGrace}}class UG{constructor(t){this._maxPurchaseSize=t.readInt(),this._bundleSize=t.readInt(),this._bundleDiscountSize=t.readInt(),this._bonusThreshold=t.readInt(),this._additionalBonusDiscountThresholdQuantities=[];let e=t.readInt();for(;e>0;)this._additionalBonusDiscountThresholdQuantities.push(t.readInt()),e--}get maxPurchaseSize(){return this._maxPurchaseSize}get bundleSize(){return this._bundleSize}get bundleDiscountSize(){return this._bundleDiscountSize}get bonusThreshold(){return this._bonusThreshold}get additionalBonusDiscountThresholdQuantities(){return this._additionalBonusDiscountThresholdQuantities}}class xG{flush(){return this._bundleDiscountRuleset=null,!0}parse(t){return t?(this._bundleDiscountRuleset=new UG(t),!0):!1}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class Jg{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(t){if(!t)return!1;this._visible=t.readBoolean(),this._icon=t.readInt(),this._pageId=t.readInt(),this._pageName=t.readString(),this._localization=t.readString();let e=t.readInt();for(;e>0;)this._offerIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._children.push(new Jg(t)),s--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class FG{flush(){return this._root=null,!0}parse(t){return t?(this._root=new Jg(t),this._newAdditionsAvailable=t.readBoolean(),this._catalogType=t.readString(),!0):!1}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class wG{constructor(t){this._images=[],this._texts=[];let e=t.readInt();for(;e>0;)this._images.push(t.readString()),e--;let s=t.readInt();for(;s>0;)this._texts.push(t.readString()),s--}get images(){return this._images}get texts(){return this._texts}}class GG{flush(){return this._pageName=null,this._pageId=0,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get pageId(){return this._pageId}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}const xh=class ZO{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(t){switch(this._productType=t.readString(),this._productType){case ZO.B:return this._extraParam=t.readString(),this._productCount=1,!0;default:return this._furniClassId=t.readInt(),this._extraParam=t.readString(),this._productCount=t.readInt(),this._uniqueLimitedItem=t.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=t.readInt(),this._uniqueLimitedItemsLeft=t.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}};xh.I="i";xh.S="s";xh.E="e";xh.B="b";let f_=xh;class g_{constructor(t){this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean(),this._products=[];let e=t.readInt();for(;e>0;)this._products.push(new f_(t)),e--;this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),this._isPet=t.readBoolean(),this._previewImage=t.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}const E_=class $u{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(t){if(!t)return!1;switch(this._position=t.readInt(),this._itemName=t.readString(),this._itemPromoImage=t.readString(),this._type=t.readInt(),this._type){case $u.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=t.readString();break;case $u.ITEM_PRODUCT_OFFER:this._productOfferId=t.readInt();break;case $u.ITEM_IAP:this._productCode=t.readString();break}const e=t.readInt();return this._expirationTime=e>0?e*1e3+ft():0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}};E_.ITEM_CATALOGUE_PAGE=0;E_.ITEM_PRODUCT_OFFER=1;E_.ITEM_IAP=2;let BG=E_;class HG{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(t){if(!t)return!1;this._pageId=t.readInt(),this._catalogType=t.readString(),this._layoutCode=t.readString(),this._localization=new wG(t);let e=t.readInt();for(;e>0;)this._offers.push(new g_(t)),e--;if(this._offerId=t.readInt(),this._acceptSeasonCurrencyAsCredits=t.readBoolean(),t.bytesAvailable){let s=t.readInt();for(;s>0;)this._frontPageItems.push(new BG(t)),s--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class VG{flush(){return this._pageName=null,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class kG{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(t){return t?(this._instantlyRefreshCatalogue=t.readBoolean(),t.bytesAvailable&&(this._newFurniDataHash=t.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class jG{constructor(t){this._offerId=t.readInt(),this._isVip=t.readBoolean(),this._daysRequired=t.readInt(),this._isSelectable=t.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class zG{flush(){return!0}parse(t){if(!t)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=t.readInt(),this._giftsAvailable=t.readInt();const e=t.readInt();for(let i=0;i<e;i++)this._offers.push(new g_(t));const s=t.readInt();for(let i=0;i<s;i++){const n=new jG(t);this._giftData.set(n.offerId,n)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(t){this._giftsAvailable=t}getOfferExtraData(t){return t?this._giftData.get(t):null}get giftData(){return this._giftData}}class YG{flush(){return this._productCode=null,this._products=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._products.push(new f_(t)),e--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class JO{constructor(t){if(!t)throw new Error("invalid_wrapper");this._offerId=t.readInt(),this._productCode=t.readString(),t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._vip=t.readBoolean(),this._months=t.readInt(),this._extraDays=t.readInt(),this._giftable=t.readBoolean(),this._daysLeftAfterPurchase=t.readInt(),this._year=t.readInt(),this._month=t.readInt(),this._day=t.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class WG extends JO{constructor(t){super(t),this._originalPrice=t.readInt(),this._originalActivityPointPrice=t.readInt(),this._originalActivityPointType=t.readInt(),this._subscriptionDaysLeft=t.readInt()}get originalPrice(){return this._originalPrice*this.months}get originalActivityPointPrice(){return this._originalActivityPointPrice*this.months}get originalActivityPointType(){return this._originalActivityPointType}get discountCreditAmount(){return this._originalPrice*this.months-this.priceCredits}get discountActivityPointAmount(){return this.originalActivityPointPrice*this.months-this.priceActivityPoints}get subscriptionDaysLeft(){return this._subscriptionDaysLeft}}class XG{flush(){return this._available=!1,this._pricePointUrl=null,this._market=null,this._lengthInDays=0,!0}parse(t){return t?(this._pricePointUrl=t.readString(),this._pricePointUrl!==""&&(this._available=!0),this._market=t.readString(),this._lengthInDays=t.readInt(),!0):!1}get available(){return this._available}get pricePointUrl(){return this._pricePointUrl}get market(){return this._market}get lengthInDays(){return this._lengthInDays}}class KG{flush(){return!0}parse(t){return!!t}}class qG{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(t){if(!t)return!1;const e=[],s=[],i=[],n=[];this._isEnabled=t.readBoolean(),this._price=t.readInt();let a=t.readInt(),o=0;for(;o<a;)e.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)s.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)i.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)n.push(t.readInt()),o++;return this._giftWrappers=e,this._ribbonTypes=i,this._giftFurnis=n,this._boxTypes=s,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class QG{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new WG(t),!0):!1}get offer(){return this._offer}}class ZG{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._offers.push(new JO(t)),e--;return!0}get offers(){return this._offers}}class JG{flush(){return this._offerId=0,this._isGiftable=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._isGiftable=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get isGiftable(){return this._isGiftable}}class $G{flush(){return!0}parse(t){return!!t}}class tB{flush(){return this._appearsInSeconds=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(t){return t?(this._appearsInSeconds=t.readInt(),this._pageId=t.readInt(),this._offerId=t.readInt(),this._productType=t.readString(),!0):!1}get appearsInSeconds(){return this._appearsInSeconds}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class eB{constructor(){this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0}flush(){return this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0,!0}parse(t){return t?(this._notEnoughCredits=t.readBoolean(),this._notEnoughActivityPoints=t.readBoolean(),t.bytesAvailable&&(this._activityPointType=t.readInt()),!0):!1}get notEnoughCredits(){return this._notEnoughCredits}get notEnoughActivityPoints(){return this._notEnoughActivityPoints}get activityPointType(){return this._activityPointType}}class sB{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new g_(t),!0):!1}get offer(){return this._offer}}class rB{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class iB{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class nB{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(t){if(!t)return!1;this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean();let e=t.readInt();for(;e>0;)this._products.push(new f_(t)),e--;return this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class aB{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new nB(t),!0):!1}get offer(){return this._offer}}class oB{flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(t){return t?(this._clubLevel=t.readInt(),this._securityLevel=t.readInt(),this._isAmbassador=t.readBoolean(),!0):!1}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}class p_{flush(){return!0}parse(t){return t?(this._status=t.readInt(),!0):!1}get status(){return this._status}}p_.SAFETY_LOCK_STATUS_LOCKED=0;p_.SAFETY_LOCK_STATUS_UNLOCKED=1;class hB{flush(){return this._result=-1,this._validationInfo="",!0}parse(t){return t?(this._result=t.readInt(),this._validationInfo=t.readString(),!0):!1}get result(){return this._result}get validationInfo(){return this._validationInfo}}class $O{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}$O.EMAIL_STATUS_OK=0;class uB{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._relationshipStatusType=Bn.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendName=null,!0}parse(t){return t?(this._relationshipStatusType=t.readInt(),this._friendCount=t.readInt(),this._randomFriendId=t.readInt(),this._randomFriendName=t.readString(),this._randomFriendFigure=t.readString(),!0):!1}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}}class lB{flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(t){if(!t)return!1;this._userId=t.readInt(),this._relationshipStatusMap=new de;const e=t.readInt();for(let s=0;s<e;s++){const i=new uB(t);this._relationshipStatusMap.add(i.relationshipStatusType,i)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class _B{flush(){return this._userId=null,this._badges=[],!0}parse(t){if(!t)return!1;this._userId=t.readInt();let e=t.readInt();for(;e>0;){t.readInt();const s=t.readString();this._badges.push(s),e--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class cB{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._motto=t.readString(),this._realName=t.readString(),this._directMail=t.readBoolean(),this._respectsReceived=t.readInt(),this._respectsRemaining=t.readInt(),this._respectsPetRemaining=t.readInt(),this._streamPublishingAllowed=t.readBoolean(),this._lastAccessDate=t.readString(),this._canChangeName=t.readBoolean(),this._safetyLocked=t.readBoolean(),!0):!1}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class dB{flush(){return this._userInfo=null,!0}parse(t){return!(!t||(this._userInfo=new cB(t),!this._userInfo))}get userInfo(){return this._userInfo}}class fB{flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(t){return t?(this._webId=t.readInt(),this._id=t.readInt(),this._newName=t.readString(),!0):!1}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class tv{constructor(t){this._groupId=t.readInt(),this._groupName=t.readString(),this._badgeCode=t.readString(),this._colorA=t.readString(),this._colorB=t.readString(),this._favourite=t.readBoolean(),this._ownerId=t.readInt(),this._hasForum=t.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class gB{flush(){return this._id=0,this._username=null,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._openProfileWindow=!1,!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._motto=t.readString(),this._registration=t.readString(),this._achievementPoints=t.readInt(),this._friendsCount=t.readInt(),this._isMyFriend=t.readBoolean(),this._requestSent=t.readBoolean(),this._isOnline=t.readBoolean();const e=t.readInt();for(let s=0;s<e;s++)this._groups.push(new tv(t));return this._secondsSinceLastVisit=t.readInt(),this._openProfileWindow=t.readBoolean(),!0}get id(){return this._id}get username(){return this._username}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get openProfileWindow(){return this._openProfileWindow}}class EB{flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,!0}parse(t){return t?(this._volumeSystem=t.readInt(),this._volumeFurni=t.readInt(),this._volumeTrax=t.readInt(),this._oldChat=t.readBoolean(),this._roomInvites=t.readBoolean(),this._cameraFollow=t.readBoolean(),this._flags=t.readInt(),this._chatType=t.readInt(),!0):!1}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}}class pB{flush(){return this._roomUnitId=-1,this._tags=[],!0}parse(t){if(!t)return!1;this._roomUnitId=t.readInt();let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}get roomUnitId(){return this._roomUnitId}get tags(){return this._tags}}class mB{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}}class IB{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class TB{flush(){return this._groupId=-1,!0}parse(t){return t?(this._groupId=t.readInt(),!0):!1}get groupId(){return this._groupId}}class RB{flush(){return this._groupId=-1,this._requester=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._requester=new m8(t),!0):!1}get groupId(){return this._groupId}get requester(){return this._requester}}class ev{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}ev.INSUFFICIENT_SUBSCRIPTION_LEVEL=2;class OB{flush(){return this._guildId=-1,this._reason=-1,!0}parse(t){return t?(this._guildId=t.readInt(),this._reason=t.readInt(),!0):!1}get guildId(){return this._guildId}get reason(){return this._reason}}class vB{flush(){return this._groups=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._groups.push(new tv(t)),e--;return!0}get groups(){return this._groups}}class AB{flush(){return this._badges=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._badges.set(s,i),e--}return!0}get badges(){return this._badges}}class sv{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}sv.INSUFFICIENT_SUBSCRIPTION_LEVEL=4;class SB{flush(){return this._ignoredUsers=[],!0}parse(t){if(!t)return!1;this._ignoredUsers=[];let e=t.readInt();for(;e>0;)this._ignoredUsers.push(t.readString()),e--;return!0}get ignoredUsers(){return this._ignoredUsers}}class yB{flush(){return this._result=-1,this._name=null,!0}parse(t){return t?(this._result=t.readInt(),this._name=t.readString(),!0):!1}get result(){return this._result}get name(){return this._name}}class MB{flush(){return this._link=null,!0}parse(t){return t?(this._link=t.readString(),!0):!1}get link(){return this._link}}class CB{flush(){return this._credits=null,!0}parse(t){return t?(this._credits=t.readString(),!0):!1}get credits(){return this._credits}}class NB{flush(){return this._currencies=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._currencies.set(t.readInt(),t.readInt()),e--;return!0}get currencies(){return this._currencies}}class Fh{flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(t){return t?(this._productName=t.readString(),this._daysToPeriodEnd=t.readInt(),this._memberPeriods=t.readInt(),this._periodsSubscribedAhead=t.readInt(),this._responseType=t.readInt(),this._hasEverBeenMember=t.readBoolean(),this._isVip=t.readBoolean(),this._pastClubDays=t.readInt(),this._pastVipDays=t.readInt(),this._minutesUntilExpiration=t.readInt(),t.bytesAvailable&&(this._minutesSinceLastModified=t.readInt()),!0):!1}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}}Fh.RESPONSE_TYPE_LOGIN=1;Fh.RESPONSE_TYPE_PURCHASE=2;Fh.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3;Fh.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;class Qa{constructor(t){if(this._unseen=0,!t)throw new Error("invalid_parser");this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._scoreAtStartOfLevel=t.readInt(),this._scoreLimit=Math.max(1,t.readInt()),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._currentPoints=t.readInt(),this._finalLevel=t.readBoolean(),this._category=t.readString(),this._subCategory=t.readString(),this._levelCount=t.readInt(),this._displayMethod=t.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(t){this._unseen=t}get unseen(){return this._unseen}reset(t){this._achievementId=t._achievementId,this._level=t._level,this._badgeId=t._badgeId,this._scoreAtStartOfLevel=t._scoreAtStartOfLevel,this._scoreLimit=t._scoreLimit,this._levelRewardPoints=t._levelRewardPoints,this._levelRewardPointType=t._levelRewardPointType,this._currentPoints=t._currentPoints,this._finalLevel=t._finalLevel,this._category=t.category,this._subCategory=t._subCategory,this._levelCount=t._levelCount,this._displayMethod=t._displayMethod}}Qa.DISPLAY_METHOD_OBSOLETE=-1;Qa.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0;Qa.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1;Qa.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;class bB{flush(){return this._achievement=null,!0}parse(t){return t?(this._achievement=new Qa(t),!0):!1}get achievement(){return this._achievement}}const rv=class iv{constructor(t){this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._requiredLevel=t.readInt(),this._state=t.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===iv.STATE_SELECTABLE}get state(){return this._state}};rv.STATE_SELECTABLE=0;let PB=rv;class DB{flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(t){if(!t)return!1;this._achievements=[];let e=t.readInt();for(;e>0;)this._achievements.push(new Qa(t)),e--;return this._defaultCategory=t.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class LB{flush(){return this._score=0,!0}parse(t){return t?(this._score=t.readInt(),!0):!1}get score(){return this._score}}class UB{get type(){return this._type}set type(t){this._type=t}get subType(){return this._subType}set subType(t){this._subType=t}get duration(){return this._duration}set duration(t){this._duration=t}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(t){this._inactiveEffectsInInventory=t}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(t){this._secondsLeftIfActive=t}get isPermanent(){return this._permanent}set isPermanent(t){this._permanent=t}}class xB{flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._duration=t.readInt(),this._isPermanent=t.readBoolean(),!0):!1}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class FB{flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._subType=t.readInt(),this._duration=t.readInt(),this._permanent=t.readBoolean(),!0):!1}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class wB{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class GB{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class BB{flush(){return this._effects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=new UB;s.type=t.readInt(),s.subType=t.readInt(),s.duration=t.readInt(),s.inactiveEffectsInInventory=t.readInt(),s.secondsLeftIfActive=t.readInt(),s.isPermanent=t.readBoolean(),this._effects.push(s),e--}return!0}get effects(){return this._effects}}class HB{constructor(t,e){if(!e)throw new Error("invalid_parser");this._badgeId="ACH_"+t+e.readInt(),this._limit=e.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class VB{flush(){return this._data=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readString(),i=t.readInt();let n=0;for(;n<i;)this._data.push(new HB(s,t)),n++;e--}return!0}get data(){return this._data}}class kB{flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(t){return t?(this._badgeId=t.readInt(),this._badgeCode=t.readString(),!0):!1}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class jB{flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._badgeIds=null,!0}parse(t){if(!t)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=[],this._badgeIds=new de;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._badgeIds.add(i,s),this._allBadgeCodes.push(i),e--}for(e=t.readInt();e>0;){t.readInt();const s=t.readString();this._activeBadgeCodes.push(s),e--}return!0}getBadgeId(t){return this._badgeIds.getValue(t)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes}}class zB{flush(){return!0}parse(t){return t?(this._requestCode=t.readString(),this._fulfilled=t.readBoolean(),!0):!1}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class YB{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._figureSetIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._boundFurnitureNames.push(t.readString()),s--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}class wh{flush(){return this._reason=0,this._parameter="",!0}parse(t){return t?(this._reason=t.readInt(),this._parameter=t.readString(),!0):!1}get reason(){return this._reason}get parameter(){return this._parameter}}wh.REASON_FULL=1;wh.REASON_CLOSED=2;wh.REASON_QUEUE_ERROR=3;wh.REASON_BANNED=4;class WB{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class XB{flush(){return!0}parse(t){return!!t}}class KB{flush(){return!0}parse(t){return!!t}}class qB{flush(){return this._controllerLevel=Ts.NONE,!0}parse(t){return t?(this._controllerLevel=t.readInt(),!0):!1}get controllerLevel(){return this._controllerLevel}}class QB{flush(){return!0}parse(t){return!!t}}class ZB{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class JB{flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(t){return t?(this._botId=t.readInt(),this._commandId=t.readInt(),this._data=t.readString(),!0):!1}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class $B{flush(){return this._botId=-1,!0}parse(t){return t?(this._botId=t.readInt(),!0):!1}get botId(){return this._botId}}class t2{constructor(t){this._id=t.readInt(),this._data=t.readString()}get id(){return this._id}get data(){return this._data}}class e2{flush(){return this._botId=-1,this._skillList=[],!0}parse(t){if(!t)return!1;this._botId=t.readInt();let e=t.readInt();for(;e>0;)this._skillList.push(new t2(t)),e--;return!0}get botId(){return this._botId}get skillList(){return this._skillList}}class s2{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}}class r2{flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;)this._bannedUsers.push(new s2(t)),e--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class i2{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(t){this._selected=t}}class n2{flush(){return this._roomId=0,this._data=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._data=new i2(t),!0):!1}get roomId(){return this._roomId}get data(){return this._data}}class a2{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class o2{flush(){return this._roomId=0,this._users=new Map,!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._users.set(s,i),e--}return!0}get roomId(){return this._roomId}get users(){return this._users}}class h2{flush(){return!0}parse(t){return t?(this._isMuted=t.readBoolean(),!0):!1}get isMuted(){return this._isMuted}}class u2{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class fs{constructor(t){if(!t)throw new Error("invalid_wrapper");this._mode=t.readInt(),this._weight=t.readInt(),this._speed=t.readInt(),this._distance=t.readInt(),this._protection=t.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}}fs.CHAT_MODE_FREE_FLOW=0;fs.CHAT_MODE_LINE_BY_LINE=1;fs.CHAT_BUBBLE_WIDTH_WIDE=0;fs.CHAT_BUBBLE_WIDTH_NORMAL=1;fs.CHAT_BUBBLE_WIDTH_THIN=2;fs.CHAT_SCROLL_SPEED_FAST=0;fs.CHAT_SCROLL_SPEED_NORMAL=1;fs.CHAT_SCROLL_SPEED_SLOW=2;fs.FLOOD_FILTER_STRICT=0;fs.FLOOD_FILTER_NORMAL=1;fs.FLOOD_FILTER_LOOSE=2;class Gh{constructor(t){this._allowMute=t.readInt(),this._allowKick=t.readInt(),this._allowBan=t.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}}Gh.MODERATION_LEVEL_NONE=0;Gh.MODERATION_LEVEL_USER_WITH_RIGHTS=1;Gh.MODERATION_LEVEL_ALL=2;const ui=class Dr{constructor(){this._roomId=-1,this._name=null,this._description=null,this._doorMode=Dr.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=Dr.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1}static from(t){const e=new Dr;return e._roomId=t._roomId,e._name=t._name,e._description=t._description,e._doorMode=t._doorMode,e._categoryId=t._categoryId,e._maximumVisitors=t._maximumVisitors,e._maximumVisitorsLimit=t._maximumVisitorsLimit,e._tags=t._tags,e._tradeMode=t._tradeMode,e._allowPets=t._allowPets,e._allowFoodConsume=t._allowFoodConsume,e._allowWalkThrough=t._allowWalkThrough,e._hideWalls=t._hideWalls,e._wallThickness=t._wallThickness,e._floorThickness=t._floorThickness,e._controllersById=t._controllersById,e._controllerList=t._controllerList,e._highlightedUserId=t._highlightedUserId,e._bannedUsersById=t._bannedUsersById,e._bannedUsersList=t._bannedUsersList,e._roomModerationSettings=t._roomModerationSettings,e._chatSettings=t._chatSettings,e._allowNavigatorDynamicCats=t._allowNavigatorDynamicCats,e}static getDoorModeLocalizationKey(t){switch(t){case Dr.DOORMODE_OPEN:return"${navigator.door.mode.open}";case Dr.DOORMODE_CLOSED:return"${navigator.door.mode.closed}";case Dr.DOORMODE_PASSWORD:return"${navigator.door.mode.password}";case Dr.DOORMODE_INVISIBLE:return"${navigator.door.mode.invisible}";case Dr.DOORMODE_NOOBS_ONLY:return"${navigator.door.mode.noobs_only}"}return""}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(t){this._allowFoodConsume=t}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(t){this._allowWalkThrough=t}get hideWalls(){return this._hideWalls}set hideWalls(t){this._hideWalls=t}get wallThickness(){return this._wallThickness}set wallThickness(t){this._wallThickness=t}get floorThickness(){return this._floorThickness}set floorThickness(t){this._floorThickness=t}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get name(){return this._name}set name(t){this._name=t}get description(){return this._description}set description(t){this._description=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get categoryId(){return this._categoryId}set categoryId(t){this._categoryId=t}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(t){this._maximumVisitors=t}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(t){this._maximumVisitorsLimit=t}get tags(){return this._tags}set tags(t){this._tags=t}setFlatController(t,e){this._controllersById.set(t,e),this._controllerList=null,this._highlightedUserId=t}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(t){this._roomModerationSettings=t}get controllersById(){return this._controllersById}set controllersById(t){this._controllersById=t}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const t of this._controllersById.values())this._controllerList.push(t);this._controllerList.sort((t,e)=>t.userName.localeCompare(e.userName))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}setBannedUser(t,e){this._bannedUsersById.set(t,e),this._bannedUsersList=null}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const t of this._bannedUsersById.values())this._bannedUsersList.push(t);this._bannedUsersList.sort((t,e)=>t.userName.localeCompare(e.userName))}return this._bannedUsersList}get chatSettings(){return this._chatSettings}set chatSettings(t){this._chatSettings=t}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(t){this._allowNavigatorDynamicCats=t}};ui.DOORMODE_OPEN=0;ui.DOORMODE_CLOSED=1;ui.DOORMODE_PASSWORD=2;ui.DOORMODE_INVISIBLE=3;ui.DOORMODE_NOOBS_ONLY=4;ui.TRADEMODE_NOT_ALLOWED=0;ui.TRADEMODE_WITH_CONTROLLER=1;ui.TRADEMODE_ALLOWED=2;let l2=ui;class _2{flush(){return this._roomSettingsData=null,!0}parse(t){if(!t)return!1;this._roomSettingsData=new l2,this._roomSettingsData.roomId=t.readInt(),this._roomSettingsData.name=t.readString(),this._roomSettingsData.description=t.readString(),this._roomSettingsData.doorMode=t.readInt(),this._roomSettingsData.categoryId=t.readInt(),this._roomSettingsData.maximumVisitors=t.readInt(),this._roomSettingsData.maximumVisitorsLimit=t.readInt(),this._roomSettingsData.tags=[];let e=t.readInt();for(;e>0;)this._roomSettingsData.tags.push(t.readString()),e--;return this._roomSettingsData.tradeMode=t.readInt(),this._roomSettingsData.allowPets=t.readInt()===1,this._roomSettingsData.allowFoodConsume=t.readInt()===1,this._roomSettingsData.allowWalkThrough=t.readInt()===1,this._roomSettingsData.hideWalls=t.readInt()===1,this._roomSettingsData.wallThickness=t.readInt(),this._roomSettingsData.floorThickness=t.readInt(),this._roomSettingsData.chatSettings=new fs(t),this._roomSettingsData.allowNavigatorDynamicCats=t.readBoolean(),this._roomSettingsData.roomModerationSettings=new Gh(t),!0}get data(){return this._roomSettingsData}}class c2{flush(){return this._roomId=0,this._code=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}}class d2{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class gs{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),this._message=t.readString(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}}gs.ERROR_ROOM_NOT_FOUND=1;gs.ERROR_NOT_OWNER=2;gs.ERROR_INVALID_DOOR_MODE=3;gs.ERROR_INVALID_USER_LIMIT=4;gs.ERROR_INVALID_PASSWORD=5;gs.ERROR_INVALID_CATEGORY=6;gs.ERROR_INVALID_NAME=7;gs.ERROR_UNACCEPTABLE_NAME=8;gs.ERROR_INVALID_DESCRIPTION=9;gs.ERROR_UNACCEPTABLE_DESCRIPTION=10;gs.ERROR_INVALID_TAG=11;gs.ERROR_NON_USER_CHOOSABLE_TAG=12;gs.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;class f2{flush(){return this._selectionType=0,!0}parse(t){return t?(this._selectionType=t.readInt(),!0):!1}get selectionType(){return this._selectionType}}class g2{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class E2{flush(){return this._chat=null,!0}parse(t){return t?(this._chat=new fs(t),!0):!1}get chat(){return this._chat}}const xs=class hn{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._doorMode=t.readInt(),this._userCount=t.readInt(),this._maxUserCount=t.readInt(),this._description=t.readString(),this._tradeMode=t.readInt(),this._score=t.readInt(),this._ranking=t.readInt(),this._categoryId=t.readInt(),this.parseTags(t),this.parseBitMask(t),!0):!1}parseTags(t){if(!t)return!1;this._tags=[];let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}parseBitMask(t){return t?(this._bitMask=t.readInt(),this._bitMask&hn.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=t.readString()),this._bitMask&hn.GROUPDATA_BITMASK&&(this._groupId=t.readInt(),this._groupName=t.readString(),this._groupBadge=t.readString()),this._bitMask&hn.ROOMAD_BITMASK&&(this._adName=t.readString(),this._adDescription=t.readString(),this._adExpiresIn=t.readInt()),this._showOwner=(this._bitMask&hn.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&hn.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&hn.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(t){this._roomName=t}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(t){this._canMute=t}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(t){this._allInRoomMuted=t}};xs.THUMBNAIL_BITMASK=1;xs.GROUPDATA_BITMASK=2;xs.ROOMAD_BITMASK=4;xs.SHOWOWNER_BITMASK=8;xs.ALLOW_PETS_BITMASK=16;xs.DISPLAY_ROOMAD_BITMASK=32;xs.OPEN_STATE=0;xs.DOORBELL_STATE=1;xs.PASSWORD_STATE=2;xs.INVISIBLE_STATE=3;xs.NOOB_STATE=4;let m_=xs;class p2{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(t){return t?(this._roomId=t.readInt(),this._isOwner=t.readBoolean(),!0):!1}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class m2{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(t){return t?(this._totalLikes=t.readInt(),this._canLike=t.readBoolean(),!0):!1}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class I2{flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._groupId=t.readInt(),this._status=t.readInt(),this._groupName=t.readString(),!0):!1}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class T2{constructor(t,e,s){this._id=0,this._state=0,this._id=t,this._state=e,this._data=s}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class R2{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get count(){return this._code}}class O2{flush(){return this._itemId=0,this._value=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._value=t.readInt(),!0):!1}get itemId(){return this._itemId}get value(){return this._value}}class Yi{flush(){return this._itemId=0,this._data=null,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=Yi.parseObjectData(t),!0):!1}static parseObjectData(t){if(!t)return null;const e=Pi.getData(t.readInt());return e?(e.parseWrapper(t),e):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class $g{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,!0}parse(t){return t?(this._itemId=t.readInt(),this._spriteId=t.readInt(),this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt()%8*45,this._z=parseFloat(t.readString()),this._stackHeight=parseFloat(t.readString()),this._extra=t.readInt(),this._data=Yi.parseObjectData(t),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=t.readString()),!0):!1}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get spriteName(){return this._spriteName}set spriteName(t){this._spriteName=t}}class v2{flush(){return this._item=null,!0}parse(t){return t?(this._item=new $g(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class A2{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new $g(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class S2{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._isExpired=t.readBoolean(),this._userId=t.readInt(),this._delay=t.readInt(),!0):!1}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class y2{flush(){return this._item=null,!0}parse(t){return t?(this._item=new $g(t),!0):!1}get item(){return this._item}}class M2{flush(){return this._isWallItem=!1,this._furniTypeName=null,this._buyout=!1,this._priceInCredits=-1,this._priceInActivityPoints=-1,this._activityPointType=-1,!0}parse(t){return t?(this._isWallItem=t.readBoolean(),this._furniTypeName=t.readString(),this._buyout=t.readBoolean(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),!0):!1}get isWallItem(){return this._isWallItem}get furniTypeName(){return this._furniTypeName}get buyout(){return this._buyout}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}}class C2{flush(){return this._aliases=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._aliases.set(t.readString(),t.readString()),e--;return!0}get aliases(){return this._aliases}}class N2{flush(){return this._furniId=-1,this._height=0,!0}parse(t){return t?(this._furniId=t.readInt(),this._height=t.readInt()/100,!0):!1}get furniId(){return this._furniId}get height(){return this._height}}class b2{flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(t){return t?(this._objectId=t.readInt(),this._guildId=t.readInt(),this._guildName=t.readString(),this._guildHomeRoomId=t.readInt(),this._userIsMember=t.readBoolean(),this._guildHasReadableForum=t.readBoolean(),!0):!1}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class P2{flush(){return this._itemId=0,this._data="",!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=t.readString(),!0):!1}get furnitureId(){return this._itemId}get data(){return this._data}}class D2{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class L2{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class U2{get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(t){return this._furniId=t.readInt(),this._start=t.readBoolean(),!0}}class x2{flush(){return this._itemId=0,this._state=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._state=t.readInt(),!0):!1}get itemId(){return this._itemId}get state(){return this._state}}class F2{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class w2{flush(){return!0}parse(t){return t?(this._expiryTime=t.readInt(),!0):!1}get expiryTime(){return this._expiryTime}}class G2{flush(){return this._rented=!1,this._renterId=-1,this._renterName=null,this._canRent=!1,this._canRentErrorCode=-1,this._timeRemaining=-1,this._price=-1,!0}parse(t){return t?(this._rented=t.readBoolean(),this._canRentErrorCode=t.readInt(),this._canRent=this._canRentErrorCode===0,this._renterId=t.readInt(),this._renterName=t.readString(),this._timeRemaining=t.readInt(),this._price=t.readInt(),this._rented||(this._renterId=-1,this._renterName=""),!0):!1}get rented(){return this._rented}get renterId(){return this._renterId}get renterName(){return this._renterName}get canRent(){return this._canRent}get price(){return this._price}get timeRemaining(){return this._timeRemaining}get canRentErrorCode(){return this._canRentErrorCode}}class B2{flush(){return this._itemId=-1,this._location="",!0}parse(t){return t?(this._itemId=t.readInt(),this._location=t.readString(),!0):!1}get itemId(){return this._itemId}get location(){return this._location}}class H2{constructor(t,e,s,i){this.id=t,this.type=e,this.color=s,this.brightness=i}}class V2{constructor(){this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(t){const e=t.readInt();this._selectedPresetId=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt(),a=parseInt(t.readString().substr(1),16),o=t.readInt();this._presets.push(new H2(i,n,a,o))}return!0}getPreset(t){return t<0||t>=this.presetCount?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class k2{flush(){return this._roomId=-1,this._roomName=null,this._messageCount=-1,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._messageCount=t.readInt(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}get messageCount(){return this._messageCount}}class tE{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,!0}parse(t){if(!t)return!1;this._itemId=parseInt(t.readString()),this._spriteId=t.readInt(),this._location=t.readString(),this._stuffData=t.readString(),this._secondsToExpiration=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null;const e=parseFloat(this._stuffData);if(isNaN(e)||(this._state=Math.trunc(e)),this._location.indexOf(":")===0){this._isOldFormat=!1;let s=this._location.split(" ");if(s.length>=3){let i=s[0],n=s[1];const a=s[2];if(i.length>3&&n.length>2&&(i=i.substr(3),n=n.substr(2),s=i.split(","),s.length>=2)){const o=parseInt(s[0]),h=parseInt(s[1]);if(s=n.split(","),s.length>=2){const u=parseInt(s[0]),c=parseInt(s[1]);this._width=o,this._height=h,this._localX=u,this._localY=c,this._direction=a}}}}else this._isOldFormat=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}}class j2{flush(){return this._item=null,!0}parse(t){return t?(this._item=new tE(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class z2{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new tE(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class Y2{flush(){return this._itemId=0,this._userId=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._userId=t.readInt(),!0):!1}get itemId(){return this._itemId}get userId(){return this._userId}}class W2{flush(){return this._item=null,!0}parse(t){return t?(this._item=new tE(t),!0):!1}get item(){return this._item}}class X2{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,this._furniId=-1,this._requestedByUser=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),this._furniId=t.readInt(),this._requestedByUser=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}get furniId(){return this._furniId}get requestedByUser(){return this._requestedByUser}}class K2{parse(t){return this._furniId=t.readInt(),this._commandId=t.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class q2{constructor(t,e,s){this._video=t,this._title=e,this._description=s}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class Q2{flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(t){this._furniId=t.readInt();const e=t.readInt();this._playlists=[];for(let s=0;s<e;s++)this._playlists.push(new q2(t.readString(),t.readString(),t.readString()));return this._selectedPlaylistId=t.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class Z2{flush(){return!0}parse(t){return this._furniId=t.readInt(),this._videoId=t.readString(),this._startAtSeconds=t.readInt(),this._endAtSeconds=t.readInt(),this._state=t.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class J2{flush(){return this._objects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=Yi.parseObjectData(t),n=parseFloat(i.getLegacyString());this._objects.push(new T2(s,n,i)),e--}return!0}get objects(){return this._objects}}class $2{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(t){if(!t)return!1;const e=t.readInt(),s=t.readInt(),i=t.readInt(),n=t.readInt();let a=t.readInt();for(;a>0;){const l=t.readInt(),_=parseFloat(t.readString()),d=parseFloat(t.readString()),f=new Kr(l,new S(e,s,_),new S(i,n,d));this._itemsRolling.push(f),a--}if(this._rollerId=t.readInt(),!t.bytesAvailable)return!0;const o=t.readInt(),h=t.readInt(),u=parseFloat(t.readString()),c=parseFloat(t.readString());switch(o){case 0:break;case 1:this._unitRolling=new Kr(h,new S(e,s,u),new S(i,n,c),Kr.MOVE);break;case 2:this._unitRolling=new Kr(h,new S(e,s,u),new S(i,n,c),Kr.SLIDE);break}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}const nv=class uf{flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(t){if(!t)return!1;const e=t.readBoolean(),s=t.readInt(),i=t.readString();return this.parseExplicitly(i,s,e)}parseModel(t,e,s=!0){return this.parseExplicitly(t,e,s)}parseExplicitly(t,e,s=!0){this._scale=s?32:64,this._wallHeight=e,this._model=t;const i=this._model.split("\r"),n=i.length;let a=0,o=0;for(;o<n;){const h=i[o];h.length>a&&(a=h.length),o++}for(this._heightMap=[],o=0;o<n;){const h=[];let u=0;for(;u<a;)h.push(uf.TILE_BLOCKED),u++;this._heightMap.push(h),o++}for(this._width=a,this._height=n,o=0;o<n;){const h=this._heightMap[o],u=i[o];if(u.length>0){let c=0;for(;c<u.length;){const l=u.charAt(c);let _=uf.TILE_BLOCKED;l!=="x"&&l!=="X"&&(_=parseInt(l,36)),h[c]=_,c++}}o++}return!0}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return-110;const s=this._heightMap[e];if(s===void 0)return-110;const i=s[t];return i===void 0?-110:i}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}};nv.TILE_BLOCKED=-110;let av=nv;class tH{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(t){return t?(this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt(),!0):!1}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class wi{static decodeTileHeight(t){return t<0?-1:(t&16383)/256}static decodeIsStackingBlocked(t){return!!(t&16384)}static decodeIsRoomTile(t){return t>=0}getTileHeight(t,e){return t<0||t>=this._width||e<0||e>=this._height?-1:wi.decodeTileHeight(this._heights[e*this._width+t])}getStackingBlocked(t,e){return t<0||t>=this._width||e<0||e>=this._height?!0:wi.decodeIsStackingBlocked(this._heights[e*this._width+t])}isRoomTile(t,e){return t<0||t>=this._width||e<0||e>=this._height?!1:wi.decodeIsRoomTile(this._heights[e*this._width+t])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(t){if(!t)return!1;this._width=t.readInt();const e=t.readInt();this._height=e/this._width;let s=0;for(;s<e;)this._heights[s]=t.readShort(),s++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class eH{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return wi.decodeTileHeight(this._value)}isStackingBlocked(){return wi.decodeIsStackingBlocked(this._value)}isRoomTile(){return wi.decodeIsRoomTile(this._value)}next(){return this._count?(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0):!1}parse(t){return t?(this._wrapper=t,this._count=t.readByte(),!0):!1}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class sH{flush(){return this._blockedTilesMap=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readInt();this._blockedTilesMap[i]||(this._blockedTilesMap[i]=[]),this._blockedTilesMap[i][s]=!0,e--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class rH{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(t){if(!t)return!1;const e=t.readString(),s=t.readString();switch(e){case"floor":this._floorType=s;break;case"wallpaper":this._wallType=s;break;case"landscape":this._landscapeType=s;break;case"landscapeanim":this._landscapeAnimation=s;break}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class iH{flush(){return this._name=null,this._roomId=0,!0}parse(t){return t?(this._name=t.readString(),this._roomId=t.readInt(),!0):!1}get name(){return this._name}get roomId(){return this._roomId}}class nH{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(t){if(!t)return!1;this._hideWalls=t.readBoolean();let e=t.readInt(),s=t.readInt();return e=e<-2?-2:e>1?1:e,s=s<-2?-2:s>1?1:s,this._thicknessWall=Math.pow(2,e),this._thicknessFloor=Math.pow(2,s),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class uI{constructor(t){if(!t)throw new Error("invalid_wrapper");this._webId=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._figure=t.readString(),this._owner=t.readString()}dispose(){this._webId=0,this._name="",this._level=0,this._figure="",this._owner=""}get webId(){return this._webId}get name(){return this._name}get level(){return this._level}get figure(){return this._figure}get owner(){return this._owner}}class lI{constructor(t){this._stuffId=t.readInt(),this._classId=t.readInt(),this._productCode=t.readString(),this._userId=t.readInt(),this._userName=t.readString(),this._rarityLevel=t.readInt(),this._hasMutation=t.readBoolean()}get stuffId(){return this._stuffId}get classId(){return this._classId}get productCode(){return this._productCode}get userId(){return this._userId}get userName(){return this._userName}get rarityLevel(){return this._rarityLevel}get hasMutation(){return this._hasMutation}}class aH{flush(){return this._resultData=null,this._otherResultData=null,!0}parse(t){return t?(this._resultData=new lI(t),this._otherResultData=new lI(t),!0):!1}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}class oH{flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(t){return t?(this._petId=t.readInt(),this._roomIndex=t.readInt(),this._gainedExperience=t.readInt(),!0):!1}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class hH{flush(){return!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._figureData=new rE(t),this._hasSaddle=t.readBoolean(),this._isRiding=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class uH{flush(){return this._id=-1,this._skillThresholds=[],!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._maximumLevel=t.readInt(),this._experience=t.readInt(),this._levelExperienceGoal=t.readInt(),this._energy=t.readInt(),this._maximumEnergy=t.readInt(),this._happyness=t.readInt(),this._maximumHappyness=t.readInt(),this._respect=t.readInt(),this._ownerId=t.readInt(),this._age=t.readInt(),this._ownerName=t.readString(),this._rarityLevel=t.readInt(),this._saddle=t.readBoolean(),this._rider=t.readBoolean();let e=t.readInt();for(;e>0;)this._skillThresholds.push(t.readInt()),e--;return this._skillThresholds.sort(),this._publiclyRideable=t.readInt(),this._breedable=t.readBoolean(),this._fullyGrown=t.readBoolean(),this._dead=t.readBoolean(),this._unknownRarity=t.readInt(),this._maximumTimeToLive=t.readInt(),this._remainingTimeToLive=t.readInt(),this._remainingGrowTime=t.readInt(),this._publiclyBreedable=t.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class lH{flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._canBreed=t.readBoolean(),this._canHarvest=t.readBoolean(),this._canRevive=t.readBoolean(),this._hasBreedingPermission=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class _H{constructor(t){if(!t)throw new Error("invalid_wrapper");this._chance=t.readInt(),this._breeds=[];let e=t.readInt();for(;e>0;)this._breeds.push(t.readInt()),e--}dispose(){this._chance=-1,this._breeds=[]}get chance(){return this._chance}get breeds(){return this._breeds}}class cH{flush(){return this._isPlaying=!1,!0}parse(t){return t?(this._isPlaying=t.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class dH{flush(){return!0}parse(t){return!0}}class fH{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class gH{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class eE{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._message=t.readString(),this._gesture=t.readInt(),this._bubble=t.readInt(),this.parseUrls(t),this._messageLength=t.readInt(),!0):!1}parseUrls(t){if(!t)return!1;this._urls=[];let e=t.readInt();for(;e>0;)this._urls.push(t.readString()),e--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}}class EH{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isTyping=t.readInt()===1,!0):!1}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class pH{flush(){return this._unitId=null,this._danceId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._danceId=t.readInt(),!0):!1}get unitId(){return this._unitId}get danceId(){return this._danceId}}class mH{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._effectId=t.readInt(),this._delay=t.readInt(),!0):!1}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class IH{flush(){return this._unitId=null,this._expression=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._expression=t.readInt(),!0):!1}get unitId(){return this._unitId}get expression(){return this._expression}}class TH{flush(){return this._unitId=null,this._handId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._handId=t.readInt(),!0):!1}get unitId(){return this._unitId}get handId(){return this._handId}}class RH{flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(t){return t?(this._giverUserId=t.readInt(),this._handItemType=t.readInt(),!0):!1}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class OH{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isIdle=t.readBoolean(),!0):!1}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class vH{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._figure=t.readString(),this._gender=t.readString().toLocaleUpperCase(),this._motto=t.readString(),this._achievementScore=t.readInt(),!0):!1}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class AH{flush(){return this._unitId=null,this._value=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._value=t.readInt(),!0):!1}get unitId(){return this._unitId}get value(){return this._value}}class Sa{constructor(t){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=t}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(t){this._isReadOnly||(this._x=t)}get y(){return this._y}set y(t){this._isReadOnly||(this._y=t)}get z(){return this._z}set z(t){this._isReadOnly||(this._z=t)}get dir(){return this._dir}set dir(t){this._isReadOnly||(this._dir=t)}get name(){return this._name}set name(t){this._isReadOnly||(this._name=t)}get userType(){return this._userType}set userType(t){this._isReadOnly||(this._userType=t)}get sex(){return this._sex}set sex(t){this._isReadOnly||(this._sex=t)}get figure(){return this._figure}set figure(t){this._isReadOnly||(this._figure=t)}get custom(){return this._custom}set custom(t){this._isReadOnly||(this._custom=t)}get activityPoints(){return this._activityPoints}set activityPoints(t){this._isReadOnly||(this._activityPoints=t)}get webID(){return this._webID}set webID(t){this._isReadOnly||(this._webID=t)}get groupID(){return this._groupID}set groupID(t){this._isReadOnly||(this._groupID=t)}get groupName(){return this._groupName}set groupName(t){this._isReadOnly||(this._groupName=t)}get groupStatus(){return this._groupStatus}set groupStatus(t){this._isReadOnly||(this._groupStatus=t)}get subType(){return this._subType}set subType(t){this._isReadOnly||(this._subType=t)}get ownerId(){return this._ownerId}set ownerId(t){this._isReadOnly||(this._ownerId=t)}get ownerName(){return this._ownerName}set ownerName(t){this._isReadOnly||(this._ownerName=t)}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._isReadOnly||(this._rarityLevel=t)}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._isReadOnly||(this._hasSaddle=t)}get isRiding(){return this._isRiding}set isRiding(t){this._isReadOnly||(this._isRiding=t)}get canBreed(){return this._canBreed}set canBreed(t){this._isReadOnly||(this._canBreed=t)}get canHarvest(){return this._canHarvest}set canHarvest(t){this._isReadOnly||(this._canHarvest=t)}get canRevive(){return this._canRevive}set canRevive(t){this._isReadOnly||(this._canRevive=t)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._isReadOnly||(this._hasBreedingPermission=t)}get petLevel(){return this._petLevel}set petLevel(t){this._isReadOnly||(this._petLevel=t)}get petPosture(){return this._petPosture}set petPosture(t){this._isReadOnly||(this._petPosture=t)}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isReadOnly||(this._isModerator=t)}}Sa.M="M";Sa.F="F";class SH{flush(){return this._users=[],!0}parse(t){if(!t)return!1;this._users=[];const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),n=t.readString(),a=t.readString();let o=t.readString();const h=t.readInt(),u=t.readInt(),c=t.readInt(),l=parseFloat(t.readString()),_=t.readInt(),d=t.readInt(),f=new Sa(h);if(f.dir=_,f.name=n,f.custom=a,f.x=u,f.y=c,f.z=l,this._users.push(f),d===1){f.webID=i,f.userType=Ys.USER,f.sex=this.resolveSex(t.readString()),f.groupID=t.readInt(),f.groupStatus=t.readInt(),f.groupName=t.readString();const m=t.readString();m!==""&&(o=this.convertSwimFigure(m,o,f.sex)),f.figure=o,f.activityPoints=t.readInt(),f.isModerator=t.readBoolean()}else if(d===2)f.userType=Ys.PET,f.figure=o,f.webID=i,f.subType=t.readInt().toString(),f.ownerId=t.readInt(),f.ownerName=t.readString(),f.rarityLevel=t.readInt(),f.hasSaddle=t.readBoolean(),f.isRiding=t.readBoolean(),f.canBreed=t.readBoolean(),f.canHarvest=t.readBoolean(),f.canRevive=t.readBoolean(),f.hasBreedingPermission=t.readBoolean(),f.petLevel=t.readInt(),f.petPosture=t.readString();else if(d===3)f.userType=Ys.BOT,f.webID=h*-1,o.indexOf("/")===-1?f.figure=o:f.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",f.sex=Sa.M;else if(d===4){f.userType=Ys.RENTABLE_BOT,f.webID=i,f.sex=this.resolveSex(t.readString()),f.figure=o,f.ownerId=t.readInt(),f.ownerName=t.readString();const m=t.readInt();if(m){const p=[];let T=0;for(;T<m;)p.push(t.readShort()),T++;f.botSkills=p}}s++}return!0}resolveSex(t){return t.substr(0,1).toLowerCase()==="f"?Sa.F:Sa.M}convertSwimFigure(t,e,s){const i=e.split(".");let n=1,a=1,o=1;const h=1e4;let u=0;for(;u<i.length;){const d=i[u].split("-");d.length>2&&d[0]==="hd"&&(n=parseInt(d[2])),u++}const c=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],l=t.split("=");if(l.length>1){const _=l[1].split("/");_[0];const d=_[1];s==="F"?o=10010:o=10011;const f=c.indexOf(d);a=h+f+1}return e+(".bds-10001-"+n+".ss-"+o+"-"+a)}get users(){return this._users}}class yH{flush(){return this._unitId=null,!0}parse(t){return t?(this._unitId=parseInt(t.readString()),!0):!1}get unitId(){return this._unitId}}class MH{constructor(t,e){this._action=t,this._value=e}get action(){return this._action}get value(){return this._value}}class CH{constructor(t,e,s,i,n,a,o,h=0,u=0,c=0,l,_,d){this._id=t,this._x=e,this._y=s,this._z=i,this._height=n,this._headDirection=a,this._direction=o,this._targetX=h,this._targetY=u,this._targetZ=c,this._didMove=l,this._canStandUp=_,this._actions=d||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}}class NH{flush(){return this._statuses=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=this.parseStatus(t);if(!s){e--;continue}this._statuses.push(s),e--}return!0}parseStatus(t){if(!t)return null;const e=t.readInt(),s=t.readInt(),i=t.readInt(),n=parseFloat(t.readString()),a=t.readInt()%8*45,o=t.readInt()%8*45,h=t.readString();let u=0,c=0,l=0,_=0,d=!1,f=!1;if(h){const m=h.split("/"),p=[];for(const T of m){const v=T.split(" ");if(v[0]!==""&&v.length>=2){switch(v[0]){case"mv":{const O=v[1].split(",");O.length>=3&&(u=parseInt(O[0]),c=parseInt(O[1]),l=parseFloat(O[2]),f=!0);break}case"sit":{const O=parseFloat(v[1]);v.length>=3&&(d=v[2]==="1"),_=O;break}case"lay":{const O=parseFloat(v[1]);_=Math.abs(O);break}}p.push(new MH(v[0],v[1]))}}this._statuses.push(new CH(e,s,i,n,_,a,o,u,c,l,f,d,p))}}get statuses(){return this._statuses}}const sE=class lf{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(t){return t?(this._itemId=t.readInt(),this._furniType=t.readString(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._stuffData=Yi.parseObjectData(t),this._isRecyclable=t.readBoolean(),this._tradable=t.readBoolean(),this._isGroupable=t.readBoolean(),this._sellable=t.readBoolean(),this._secondsToExpiration=t.readInt(),this._expirationTimeStamp=ft(),this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=t.readBoolean(),this._flatId=t.readInt(),this._isWallItem=this._furniType===lf.WALL_ITEM,this._furniType===lf.FLOOR_ITEM&&(this._slotId=t.readString(),this._extra=t.readInt()),!0):!1}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}};sE.WALL_ITEM="I";sE.FLOOR_ITEM="S";let ov=sE;class bH{flush(){return this._items=[],!0}parse(t){return t?(this._items.push(new ov(t)),!0):!1}get items(){return this._items}}class PH{flush(){return!0}parse(t){return!!t}}class DH{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;){const s=new ov(t);s&&this._fragment.set(s.itemId,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class LH{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class UH{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._itemsLeft=t.readInt(),!0):!1}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class xH{flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(t){return t?(this._itemType=t.readString(),this._classId=t.readInt(),this._productCode=t.readString(),this._placedItemId=t.readInt(),this._placedItemType=t.readString(),this._placedInRoom=t.readBoolean(),this._petFigureString=t.readString(),!0):!1}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class FH{flush(){this._nestId=0,this._pet1&&(this._pet1.dispose(),this._pet1=null),this._pet2&&(this._pet2.dispose(),this._pet2=null);for(const t of this._rarityCategories)t&&t.dispose();return this._rarityCategories=[],!0}parse(t){if(!t)return!1;this._nestId=t.readInt(),this._pet1=new uI(t),this._pet2=new uI(t);let e=t.readInt();for(;e>0;)this._rarityCategories.push(new _H(t)),e--;return this._resultPetType=t.readInt(),!0}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetType(){return this._resultPetType}}class wH{flush(){return this._breedingNestStuffId=0,this._result=0,!0}parse(t){return t?(this._breedingNestStuffId=t.readInt(),this._result=t.readInt(),!0):!1}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}class GH{flush(){return this._petId=-1,this._rarityCategory=-1,!0}parse(t){return this._petId=t.readInt(),this._rarityCategory=t.readInt(),!0}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}class rE{constructor(t){this._typeId=t.readInt(),this._paletteId=t.readInt(),this._color=t.readString(),this._breedId=t.readInt(),this._customParts=[],this._customPartCount=t.readInt();let e=0;for(;e<this._customPartCount;)this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),e++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let t=this.typeId+" "+this.paletteId+" "+this.color;t=t+(" "+this.custompartCount);for(const e of this.customParts)t=t+(" "+e);return t}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class I_{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._figureData=new rE(t),this._level=t.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.custompartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class BH{flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(t){return this._pet=new I_(t),this._boughtAsGift=t.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}class T_{flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(t){return t?(this._state=t.readInt(),this._ownPetId=t.readInt(),this._otherPetId=t.readInt(),!0):!1}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}}T_.STATE_CANCEL=1;T_.STATE_ACCEPT=2;T_.STATE_REQUEST=3;class HH{flush(){return this._fragment=null,!0}parse(t){this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(this._fragment=new Map;e>0;){const s=new I_(t);this._fragment.set(s.id,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class VH{flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(t){return this._boughtAsGift=t.readBoolean(),this._pet=new I_(t),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class kH{flush(){return!0}parse(t){return t?(this._petId=t.readInt(),!0):!1}get petId(){return this._petId}}class jH{constructor(t){this._itemId=t.readInt(),this._furniType=t.readString().toUpperCase(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._isGroupable=t.readBoolean(),this._stuffData=Yi.parseObjectData(t),this._secondsToExpiration=-1,this._expirationTimeStamp=ft(),this._hasRentPeriodStarted=!1,this._creationDay=t.readInt(),this._creationMonth=t.readInt(),this._creationYear=t.readInt(),this._extra=this.furniType==="S"?t.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem=this._furniType==="I"}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}class zH{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(t){return t?(this._userID=t.readInt(),this._userAccepts=t.readInt()>0,!0):!1}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}class hv{flush(){return!0}parse(t){return t?(this._userId=t.readInt(),this._reason=t.readInt(),!0):!1}get userID(){return this._userId}get reason(){return this._reason}}hv.ERROR_WHILE_COMMIT=1;class YH{flush(){return!0}parse(t){return!!t}}class WH{flush(){return!0}parse(t){return!!t}}class XH{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(t){return!t||(this._firstUserID=t.readInt(),this._firstUserItemArray=[],!this.parseItems(t,this._firstUserItemArray))||(this._firstUserNumItems=t.readInt(),this._firstUserNumCredits=t.readInt(),this._secondUserID=t.readInt(),this._secondUserItemArray=[],!this.parseItems(t,this._secondUserItemArray))?!1:(this._secondUserNumItems=t.readInt(),this._secondUserNumCredits=t.readInt(),!0)}parseItems(t,e){let s=t.readInt();for(;s>0;)e.push(new jH(t)),s--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class KH{flush(){return!0}parse(t){return!!t}}class qH{flush(){return!0}parse(t){return!!t}}class iE{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),this._otherUserName=t.readString(),!0):!1}get reason(){return this._reason}get otherUserName(){return this._otherUserName}}iE.REASON_YOU_ARE_ALREADY_TRADING=7;iE.REASON_OTHER_USER_ALREADY_TRADING=8;class QH{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._userCanTrade=t.readInt()===1,this._otherUserId=t.readInt(),this._otherUserCanTrade=t.readInt()===1,!0):!1}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class ZH{flush(){return!0}parse(t){return!!t}}class JH{flush(){return!0}parse(t){return!!t}}class $H{flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(t){return t?(this._respect=t.readInt(),this._petOwnerId=t.readInt(),this._petData=new I_(t),!0):!1}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===Rt.MONSTERPLANT}}class tV{flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(t){return t?(this._petId=t.readInt(),this._userId=t.readInt(),this._supplementType=t.readInt(),!0):!1}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}class Gi{}Gi.WATER=0;Gi.LIGHT=1;Gi.REVIVE=2;Gi.REBREED_FERTILIZER=3;Gi.SPEED_FERTILIZER=4;class eV{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(t){return t?(this._userId=t.readInt(),this._respectsReceived=t.readInt(),!0):!1}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class sV{constructor(t,e,s){this._hasControllers=!1,this._roomId=t,this._roomName=e,this._hasControllers=s}get roomId(){return this._roomId}get roomName(){return this._roomName}get hasControllers(){return this._hasControllers}}class rV{constructor(t){this._currentHcStreak=t.readInt(),this._firstSubscriptionDate=t.readString(),this._kickbackPercentage=t.readDouble(),this._totalCreditsMissed=t.readInt(),this._totalCreditsRewarded=t.readInt(),this._totalCreditsSpent=t.readInt(),this._creditRewardForStreakBonus=t.readInt(),this._creditRewardForMonthlySpent=t.readInt(),this._timeUntilPayday=t.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class iV{flush(){return this._data=null,!0}parse(t){return this._data=new rV(t),!0}get data(){return this._data}}class nV{flush(){return this._looks=new Map,!0}parse(t){if(!t)return!1;t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString(),n=t.readString();this._looks.set(s,[i,n]),e--}return!0}get looks(){return this._looks}}class aV{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class oV{flush(){return this._isVip=!1,this._rooms=[],!0}parse(t){if(!t)return!1;this._isVip=t.readBoolean();let e=t.readInt();for(;e>0;)this._rooms.push(new sV(t.readInt(),t.readString(),t.readBoolean())),e--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class hV{flush(){return this._pageId=-1,this._data=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._data=new g_(t),!0):!1}get pageId(){return this._pageId}get data(){return this._data}}class uV{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(t){return t?(this._type=t.readInt(),this._breedId=t.readInt(),this._paletteId=t.readInt(),this._sellable=t.readBoolean(),this._rare=t.readBoolean(),!0):!1}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class lV{flush(){return this._productCode="",this._palettes=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._palettes.push(new uV(t)),e--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class _V{constructor(t){this._trackingState=t.readInt(),this._id=t.readInt(),this._identifier=t.readString(),this._productCode=t.readString(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),this._purchaseLimit=t.readInt();const e=t.readInt();this._expirationTime=e>0?e*1e3+Date.now():0,this._title=t.readString(),this._description=t.readString(),this._imageUrl=t.readString(),this._iconImageUrl=t.readString(),this._type=t.readInt(),this._subProductCodes=[];let s=t.readInt();for(;s>0;)this._subProductCodes.push(t.readString()),s--;return this}populate(t){t&&(this._id=t.id,this._identifier=t.identifier,this._type=t.type,this._title=t.title,this._description=t.description,this._imageUrl=t.imageUrl,this._iconImageUrl=t.iconImageUrl,this._productCode=t.productCode,this._purchaseLimit=t.purchaseLimit,this._expirationTime=t.expirationTime,this._priceInCredits=t.priceInCredits,this._priceInActivityPoints=t.priceInActivityPoints,this._activityPointType=t.activityPointType,this._subProductCodes=t.subProductCodes,this._trackingState=t.trackingState)}purchase(t){this._purchaseLimit=this._purchaseLimit-t}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._description}get imageUrl(){return this._imageUrl}get iconImageUrl(){return this._iconImageUrl}get productCode(){return this._productCode}get purchaseLimit(){return this._purchaseLimit}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get subProductCodes(){return this._subProductCodes}get trackingState(){return this._trackingState}}class cV{flush(){return!0}parse(t){return!!t}}class dV{flush(){return this._data=null,!0}parse(t){return t?(this._data=new _V(t),!0):!1}get data(){return this._data}}class fV{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(t){return t?(this._errorCode=t.readString(),!0):!1}get errorCode(){return this._errorCode}}class gV{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(t){return t?(this._productDescription=t.readString(),this._productName=t.readString(),!0):!1}get productName(){return this._productName}get productDescription(){return this._productDescription}}class EV{flush(){return!0}parse(t){return!!t}}class Wi{flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(t){this._goalId=t.readInt(),this._goalCode=t.readString(),this._result=t.readInt(),this._requiredFurnis=[];let e=t.readInt();for(;e>0;)this._requiredFurnis.push(t.readString()),e--;for(e=t.readInt();e>0;)this._missingFurnis[t.readString()]="",e--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(t){return!!this._missingFurnis[t]}}Wi.SUBMITTED=0;Wi.ASK_FOR_SUBMIT=1;Wi.ASK_FOR_CONFIRM=2;Wi.PREREQUISITES_NOT_MET=3;Wi.ROOM_DOOR_NOT_OPEN=4;Wi.ROOM_TOO_OLD=5;Wi.ASK_FOR_ACCEPT_RULES=6;class R_{}R_.ALLOWED=0;R_.REQUIRED_PERK_MISSING=1;R_.REQUIRED_BADGE_MISSING=2;class pV{flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(t){return this._goalId=t.readInt(),this._goalCode=t.readString(),this._resultCode=t.readInt(),this._votesRemaining=t.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===R_.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class mV{flush(){return this._schedulingStr=null,this._code=null,!0}parse(t){return this._schedulingStr=t.readString(),this._code=t.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class IV{flush(){return this._isPartOf=!1,this._targetId=0,!0}parse(t){return this._isPartOf=t.readBoolean(),this._targetId=t.readInt(),!0}get isPartOf(){return this._isPartOf}get targetId(){return this._targetId}}class TV{flush(){return!0}parse(t){return!0}}class RV{flush(){return this._timeStr=null,this._secondsUntil=0,!0}parse(t){return this._timeStr=t.readString(),this._secondsUntil=t.readInt(),!0}get timeStr(){return this._timeStr}get secondsUntil(){return this._secondsUntil}}class uv{constructor(t){this._recipeName=t.readString(),this._itemName=t.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class OV{constructor(){this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let i=0;i<e;i++)this._recipes.push(new uv(t));const s=t.readInt();for(let i=0;i<s;i++)this._ingredients.push(t.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class vV{constructor(t){this._count=t.readInt(),this._itemName=t.readString()}get count(){return this._count}get itemName(){return this._itemName}}class AV{constructor(){this._ingredients=[]}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._ingredients.push(new vV(t));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class SV{parse(t){return t?(this._count=t.readInt(),this._hasRecipes=t.readBoolean(),!0):!1}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class yV{parse(t){return t?(this._success=t.readBoolean(),this._success&&(this._result=new uv(t)),!0):!1}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class MV{flush(){return!0}parse(t){return!!t}}class CV{constructor(t){if(!t)throw new Error("invalid_wrapper");this._senderId=t.readInt(),this._errorCode=t.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class NV{flush(){return this._failuers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._failuers.push(new CV(t)),e--;return!0}get failures(){return this._failuers}}class bV{flush(){return this._success=!1,!0}parse(t){return t?(this._success=t.readBoolean(),!0):!1}get success(){return this._success}}class PV{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class lv{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString()}get id(){return this._id}get name(){return this._name}}class _f{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._gender=t.readInt(),this._online=t.readBoolean(),this._followingAllowed=t.readBoolean(),this._figure=t.readString(),this._categoryId=t.readInt(),this._motto=t.readString(),this._realName=t.readString(),this._lastAccess=t.readString(),this._persistedMessageUser=t.readBoolean(),this._vipMember=t.readBoolean(),this._pocketHabboUser=t.readBoolean(),this._relationshipStatus=t.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class DV{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;)this._fragment.push(new _f(t)),e--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class LV{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new lv(t)),e--;let s=t.readInt();for(;s>0;){const i=t.readInt();i===-1?this._removedFriendIds.push(t.readInt()):i===0?this._updatedFriends.push(new _f(t)):i===1&&this._addedFriends.push(new _f(t)),s--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class UV{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(t){return t?(this._typeCode=t.readInt(),this._avatarId=t.readInt(),this._message=t.readString(),!0):!1}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class _v{constructor(t){if(!t)throw new Error("invalid_wrapper");this._requestId=t.readInt(),this._requesterName=t.readString(),this._figureString=t.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class xV{flush(){return this._totalRequests=0,this._requests=[],!0}parse(t){if(!t)return!1;this._totalRequests=t.readInt();let e=t.readInt();for(;e>0;)this._requests.push(new _v(t)),e--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class _I{constructor(t){if(!t)throw new Error("invalid_wrapper");this._avatarId=t.readInt(),this._avatarName=t.readString(),this._avatarMotto=t.readString(),this._isAvatarOnline=t.readBoolean(),this._canFollow=t.readBoolean(),this._lastOnlineData=t.readString(),this._avatarGender=t.readInt(),this._avatarFigure=t.readString(),this._realName=t.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class FV{flush(){return this._friends=[],this._others=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._friends.push(new _I(t)),e--;let s=t.readInt();for(;s>0;)this._others.push(new _I(t)),s--;return!0}get friends(){return this._friends}get others(){return this._others}}class wV{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._userId=t.readInt(),this._message=t.readString(),!0):!1}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class GV{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(t){return t?(this._clientMessageId=t.readInt(),this._errorCode=t.readInt(),!0):!1}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class BV{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(t){if(!t)return!1;this._userFriendLimit=t.readInt(),this._normalFriendLimit=t.readInt(),this._extendedFriendLimit=t.readInt();let e=t.readInt();for(;e>0;)this._categories.push(new lv(t)),e--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class HV{flush(){return!0}parse(t){return!!t}}class VV{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class kV{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),this._secondsSinceSent=t.readInt(),t.bytesAvailable&&(this._extraData=t.readString()),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class jV{flush(){return this._request=null,!0}parse(t){return t?(this._request=new _v(t),!0):!1}get request(){return this._request}}class zV{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(t){if(!t)return!1;this._errorCode=t.readInt();let e=t.readInt();for(;e>0;)this._failedRecipients.push(t.readInt()),e--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class YV{flush(){return this._senderId=0,this._messageText=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}}class WV{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._freeGamesLeft=t.readInt(),this._gamesPlayedTotal=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get freeGamesLeft(){return this._freeGamesLeft}get gamesPlayedTotal(){return this._gamesPlayedTotal}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}class Bh{flush(){return this._status=-1,this._blockLength=-1,this._gamesPlayed=-1,this._freeGamesLeft=-1,!0}parse(t){return t?(this._status=t.readInt(),this._blockLength=t.readInt(),this._gamesPlayed=t.readInt(),this._freeGamesLeft=t.readInt(),!0):!1}get status(){return this._status}get blockLength(){return this._blockLength}get gamesPlayed(){return this._gamesPlayed}get freeGamesLeft(){return this._freeGamesLeft}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}Bh.STATUS_OK=0;Bh.STATUS_FAILED_REASON_UNKNOWN=1;Bh.STATUS_FAILED_REASON_GAME_DIRECTORY_IS_NOT_AVAILABLE=2;Bh.STATUS_FAILED_REASON_HOTEL_IS_CLOSED=3;class XV{flush(){return this._position=-1,!0}parse(t){return t?(this._position=t.readInt(),!0):!1}get position(){return this._position}}class li{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}li.KICKED=1;li.DUPLICATE_MACHINEID=2;li.INVITATION_REQUIRED=3;li.NO_SPACE_IN_TEAM=4;li.TEAM_NOT_FOUND=5;li.USER_HAS_ACTIVE_INSTANCE=6;li.USER_HAS_PENDING_INSTANCE_REQUEST=7;li.USER_HAS_NO_FREE_GAMES_LEFT=8;class nE{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}nE.NOT_ENOUGH_PLAYERS=1;nE.GAME_HAS_NO_OWNER=2;class KV{flush(){return!0}parse(t){return!!t}}class qV{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class QV{flush(){return!0}parse(t){return t?(this._stuffCode=t.readString(),this._badgeCode=t.readString(),!0):!1}get stuffCode(){return this._stuffCode}get badgeCode(){return this._badgeCode}}class ZV{flush(){return this._stuffId=-1,this._achievementId=0,this._requiredLevelBadgeCode="",this._userProgress=0,this._totalProgress=0,this._endTime=0,!0}parse(t){return t?(this._stuffId=t.readInt(),this._achievementId=t.readInt(),this._requiredLevelBadgeCode=t.readString(),this._userProgress=t.readInt(),this._totalProgress=t.readInt(),this._endTime=t.readInt(),!0):!1}get stuffId(){return this._stuffId}get achievementId(){return this._achievementId}get requiredLevelBadgeCode(){return this._requiredLevelBadgeCode}get userProgress(){return this._userProgress}get totalProgress(){return this._totalProgress}get endTime(){return this._endTime}}class JV{flush(){return!0}parse(t){if(!t)return!1;this._stuffId=t.readInt();const e=t.readInt();let s=0;for(;s<e;)this._achievements.push(new PB(t)),s++;return this._endTime=t.readInt(),!0}get stuffId(){return this._stuffId}get achievements(){return this._achievements}get endTime(){return this._endTime}}class $V{constructor(t,e,s,i){this._gameTypeId=t,this._achievementId=e,this._achievementName=s,this._levels=i}get gameTypeId(){return this._gameTypeId}get achievementId(){return this._achievementId}get achievementName(){return this._achievementName}get levels(){return this._levels}}class tk{flush(){return!0}parse(t){if(!t)return!1;this._achievements=[];const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),n=t.readInt();let a=0;for(;a<n;){const o=t.readInt(),h=t.readString(),u=t.readInt();this._achievements.push(new $V(i,o,h,u)),a++}s++}return!0}get achievements(){return this._achievements}}class ek{constructor(t,e,s,i,n,a){this._gameId=t,this._gameNameId=e,this._bgColor=s,this._textColor=i,this._assetUrl=n,this._supportUrl=a}get gameId(){return this._gameId}get gameNameId(){return this._gameNameId}get bgColor(){return this._bgColor}get textColor(){return this._textColor}get assetUrl(){return this._assetUrl}get supportUrl(){return this._supportUrl}}class sk{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._inviterId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get inviterId(){return this._inviterId}}class rk{flush(){return!0}parse(t){if(!t)return!1;this._games=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readString(),a=t.readString();let o=parseInt(a,16);o=o|4278190080;const h=t.readString();let u=parseInt(h,16);u=u|4278190080;const c=t.readString(),l=t.readString();this._games.push(new ek(i,n,o,u,c,l))}return!0}get games(){return this._games}}const aE=class cf{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._status=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get isOk(){return this._status==cf.OK}get isInMaintenance(){return this._status==cf.MAINTENANCE}};aE.OK=0;aE.MAINTENANCE=1;let ik=aE;class nk{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class cv{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._reason=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get reason(){return this._reason}}cv.DUPLICATE_MACHINEID=1;class ak{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class ok{flush(){return!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),this._quality=t.readString(),this._scaleMode=t.readString(),this._frameRate=t.readInt(),this._minMajorVersion=t.readInt(),this._minMinorVersion=t.readInt(),this._params=new Map;const e=t.readInt();let s=0;for(;s<e;)this._params.set(t.readString(),t.readString()),s++;return!0}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get quality(){return this._quality}get scaleMode(){return this._scaleMode}get frameRate(){return this._frameRate}get minMajorVersion(){return this._minMajorVersion}get minMinorVersion(){return this._minMinorVersion}get params(){return this._params}get gameClientId(){return this._gameClientId}}class hk{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class uk{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get gameClientId(){return this._gameClientId}}class lk{flush(){return!0}parse(t){return!!t}}class O_{flush(){return this._year=-1,this._week=-1,this._maxOffset=-1,this._currentOffset=-1,this._minutesUntilReset=-1,!0}parse(t){return t?(this._year=t.readInt(),this._week=t.readInt(),this._maxOffset=t.readInt(),this._currentOffset=t.readInt(),this._minutesUntilReset=t.readInt(),!0):!1}get year(){return this._year}get week(){return this._week}get maxOffset(){return this._maxOffset}get currentOffset(){return this._currentOffset}get minutesUntilReset(){return this._minutesUntilReset}}class _k{constructor(t){this._name=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._rank=t.readInt(),this._score=t.readInt()}get name(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get rank(){return this._rank}get score(){return this._score}}class ck{flush(){return this._gameTypeId=-1,this._products=[],this._minutesUntilNextWeek=0,this._rewardingOn=!0,!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let e=t.readInt();for(;e>0;)this._products.push(new f_(t)),e--;return this._minutesUntilNextWeek=t.readInt(),this._rewardingOn=t.readBoolean(),!0}get gameTypeId(){return this._gameTypeId}get products(){return this._products}get minutesUntilNextWeek(){return this._minutesUntilNextWeek}get rewardingOn(){return this._rewardingOn}}class dk{flush(){return this._gameTypeId=-1,this._winners=[],!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let e=t.readInt();for(;e>0;)this._winners.push(new _k(t)),e--;return!0}get gameTypeId(){return this._gameTypeId}get winners(){return this._winners}}class fk{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class gk{flush(){return this._phoneStatusCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._phoneStatusCode=t.readInt(),this._collectionStatusCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get phoneStatusCode(){return this._phoneStatusCode}get collectionStatusCode(){return this._collectionStatusCode}get millisecondsToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class Ek{flush(){return this._resultCode=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisToAllowProcessReset}}class pk{flush(){return this._resultCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class mk{flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const o=t.readInt(),h=t.readString(),u=t.readString();this._bases.set(o,[h,u]),e--}let s=t.readInt();for(;s>0;){const o=t.readInt(),h=t.readString(),u=t.readString();this._symbols.set(o,[h,u]),s--}let i=t.readInt();for(;i>0;){const o=t.readInt(),h=t.readString();this._partColors.set(o,h),i--}let n=t.readInt();for(;n>0;){const o=t.readInt(),h=t.readString();this._colorsA.set(o,h),n--}let a=t.readInt();for(;a>0;){const o=t.readInt(),h=t.readString();this._colorsB.set(o,h),a--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class Ik{flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(t){if(!t)return!1;this._groupCost=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();t.readBoolean(),this._availableRooms.set(s,i),e--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class Tk{flush(){return this._userId=0,this._furnitureCount=0,!0}parse(t){return t?(this._userId=t.readInt(),this._furnitureCount=t.readInt(),!0):!1}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class Rk{flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,!0}parse(t){return t?(this._id=t.readInt(),t.readBoolean(),this._type=t.readInt(),this._title=t.readString(),this._description=t.readString(),this._badge=t.readString(),this._roomId=t.readInt(),this._roomName=t.readString(),this._membershipType=t.readInt(),this._membersCount=t.readInt(),this._isFavorite=t.readBoolean(),this._createdAt=t.readString(),this._isOwner=t.readBoolean(),this._isAdmin=t.readBoolean(),this._ownerName=t.readString(),this._flag=t.readBoolean(),this._canMembersDecorate=t.readBoolean(),this._pendingRequestsCount=t.readInt(),!0):!1}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}}class Ok{constructor(t){this.isBase=t,this.key=0,this.color=0,this.position=4}get code(){return this.key===0?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}class Hh{}Hh.OWNER=0;Hh.ADMIN=1;Hh.MEMBER=2;Hh.REQUESTED=3;Hh.DELETED=4;class vk{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(t){return t?(this._rank=t.readInt(),this._id=t.readInt(),this._name=t.readString(),this._figure=t.readString(),this._joinedAt=t.readString(),!0):!1}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class Ak{flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._groupTitle=t.readString(),this._roomId=t.readInt(),this._badge=t.readString(),this._totalMembersCount=t.readInt();let e=t.readInt();for(;e>0;)this._result.push(new vk(t)),e--;return this._admin=t.readBoolean(),this._pageSize=t.readInt(),this._pageIndex=t.readInt(),this._level=t.readInt(),this._query=t.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class Sk{flush(){return this._roomId=0,this._groupId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._groupId=t.readInt(),!0):!1}get roomId(){return this._roomId}get guildId(){return this._groupId}}class yk{flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(t){if(!t)return!1;t.readInt()===1&&(this._roomId=t.readInt(),this._roomName=t.readString(),t.readBoolean()),t.readBoolean(),this._id=t.readInt(),this._title=t.readString(),this._description=t.readString(),t.readInt(),this._colorA=t.readInt(),this._colorB=t.readInt(),this._state=t.readInt(),this._canMembersDecorate=t.readInt()===0,t.readBoolean(),t.readString();const s=t.readInt();for(let i=0;i<s;i++){const n=new Ok(i===0);n.key=t.readInt(),n.color=t.readInt(),n.position=t.readInt(),n.key===0&&(n.position=4),this._badgeParts.set(i,n)}return this._badgeCode=t.readString(),this._membersCount=t.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class Mk{flush(){return!0}parse(t){return this._groupId=t.readInt(),!0}get groupId(){return this._groupId}}class ph{static parse(t){return this.fillFromMessage(new ph,t)}static fillFromMessage(t,e){return t._groupId=e.readInt(),t._name=e.readString(),t._description=e.readString(),t._icon=e.readString(),t._totalThreads=e.readInt(),t._leaderboardScore=e.readInt(),t._totalMessages=e.readInt(),t._unreadMessages=e.readInt(),t._lastMessageId=e.readInt(),t._lastMessageAuthorId=e.readInt(),t._lastMessageAuthorName=e.readString(),t._lastMessageTimeAsSecondsAgo=e.readInt(),t}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}updateFrom(t){this._totalThreads=t._totalThreads,this._totalMessages=t._totalMessages,this._unreadMessages=t._unreadMessages,this._lastMessageAuthorId=t._lastMessageAuthorId,this._lastMessageAuthorName=t._lastMessageAuthorName,this._lastMessageId=t._lastMessageId,this._lastMessageTimeAsSecondsAgo=t._lastMessageTimeAsSecondsAgo}get lastReadMessageId(){return this._totalMessages-this._unreadMessages}set lastReadMessageId(t){this._unreadMessages=this._totalMessages-t,this._unreadMessages<0&&(this._unreadMessages=0)}addNewThread(t){this._lastMessageAuthorId=t.lastUserId,this._lastMessageAuthorName=t.lastUserName,this._lastMessageId=t.lastMessageId,this._lastMessageTimeAsSecondsAgo=t.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class oE extends ph{static parse(t){const e=new oE;return ph.fillFromMessage(e,t),e._readPermissions=t.readInt(),e._postMessagePermissions=t.readInt(),e._postThreadPermissions=t.readInt(),e._moderatePermissions=t.readInt(),e._readPermissionError=t.readString(),e._postMessagePermissionError=t.readString(),e._postThreadPermissionError=t.readString(),e._moderatePermissionError=t.readString(),e._reportPermissionError=t.readString(),e._canChangeSettings=t.readBoolean(),e._isStaff=t.readBoolean(),e}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return this._readPermissionError.length===0}get canReport(){return!0}get hasPostMessagePermissionError(){return this._postMessagePermissionError.length===0}get hasPostThreadPermissionError(){return this._postThreadPermissionError.length===0}get hasModeratePermissionError(){return this._moderatePermissionError.length===0}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class Ck{flush(){return this._extendedForumData=null,!0}parse(t){return t?(this._extendedForumData=oE.parse(t),!0):!1}get extendedForumData(){return this._extendedForumData}}class Nk{flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(t){if(!t)return!1;this._listCode=t.readInt(),this._totalAmount=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._forums=[];let e=0;for(;e<this._amount;)this._forums.push(ph.parse(t)),e++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class Vh{static parse(t){const e=new Vh;return e._threadId=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._header=t.readString(),e._isPinned=t.readBoolean(),e._isLocked=t.readBoolean(),e._creationTimeAsSecondsAgo=t.readInt(),e._totalMessages=t.readInt(),e._unreadMessagesCount=t.readInt(),e._lastMessageId=t.readInt(),e._lastUserId=t.readInt(),e._lastUserName=t.readString(),e._lastCommentTime=t.readInt(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSecondsAgo=t.readInt(),e}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(t){this._adminOperationTimeAsSecondsAgo=t}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(t){this._lastCommentTime=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(t){this._creationTimeAsSecondsAgo=t}get header(){return this._header}set header(t){this._header=t}get lastMessageId(){return this._lastMessageId}set lastMessageId(t){this._lastMessageId=t}get lastUserId(){return this._lastUserId}set lastUserId(t){this._lastUserId=t}get lastUserName(){return this._lastUserName}set lastUserName(t){this._lastUserName=t}get totalMessages(){return this._totalMessages}set totalMessages(t){this._totalMessages=t}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(t){this._unreadMessagesCount=t}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get isPinned(){return this._isPinned}set isPinned(t){this._isPinned=t}get isLocked(){return this._isLocked}set isLocked(t){this._isLocked=t}}class bk{flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._threads=[];let e=0;for(;e<this._amount;)this._threads.push(Vh.parse(t)),e++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class kh{static parse(t){const e=new kh;return e._messageId=t.readInt(),e._messageIndex=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._authorFigure=t.readString(),e._creationTime=t.readInt(),e._messageText=t.readString(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSeccondsAgo=t.readInt(),e._authorPostCount=t.readInt(),e}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(t){this._adminOperationTimeAsSeccondsAgo=t}get messageId(){return this._messageId}set messageId(t){this._messageId=t}get creationTime(){return this._creationTime}set creationTime(t){this._creationTime=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get authorFigure(){return this._authorFigure}set authorFigure(t){this._authorFigure=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get messageIndex(){return this._messageIndex}set messageIndex(t){this._messageIndex=t}set groupID(t){this._groupId=t}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get messageText(){return this._messageText}set messageText(t){this._messageText=t}get authorPostCount(){return this._authorPostCount}set authorPostCount(t){this._authorPostCount=t}}class Pk{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=kh.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class Dk{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=Vh.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class Lk{flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._threadId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._messages=[];let e=0;for(;e<this._amount;){const s=kh.parse(t);s.groupID=this._groupId,s.threadId=this._threadId,this._messages.push(s),e++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class Uk{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class xk{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=kh.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class Fk{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=Vh.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class wk{constructor(){this._encryptedPublicKey=null,this._serverClientEncryption=!1}flush(){return!0}parse(t){return t?(this._encryptedPublicKey=t.readString(),t.bytesAvailable&&(this._serverClientEncryption=t.readBoolean()),!0):!1}get encryptedPublicKey(){return this._encryptedPublicKey}get serverClientEncryption(){return this._serverClientEncryption}}class Gk{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=0,t.bytesAvailable&&(this._reason=t.readInt()),!0):!1}get reason(){return this._reason}}class Bk{flush(){return this._accounts&&(this._accounts=new Map),!0}parse(t){if(!t)return!1;this._accounts=new Map;let e=t.readInt();for(;e>0;)this._accounts.set(t.readInt(),t.readString()),e--;return!0}get accounts(){return this._accounts}}class Hk{flush(){return!0}parse(t){return t?(this._encryptedPrime=t.readString(),this._encryptedGenerator=t.readString(),!0):!1}get encryptedPrime(){return this._encryptedPrime}get encryptedGenerator(){return this._encryptedGenerator}}class Vk{flush(){return this._noobnessLevel=0,!0}parse(t){return t?(this._noobnessLevel=t.readInt(),!0):!1}get noobnessLevel(){return this._noobnessLevel}}class kk{flush(){return!0}parse(t){return t?(this._infoUrl=t.readString(),!0):!1}get infoUrl(){return this._infoUrl}}class jk{flush(){return!0}parse(t){return!0}}class zk{flush(){return this._calls=[],!0}parse(t){this._calls=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),n=t.readString(),a=t.readString();this._calls.push({callId:i,timeStamp:n,message:a})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class Yk{flush(){return this._message=null,!0}parse(t){return this._message=t.readString(),!0}get message(){return this._message}}class Wk{flush(){return this._resultType=0,this._messageText=null,!0}parse(t){return t?(this._resultType=t.readInt(),this._messageText=t.readString(),!0):!1}get resultType(){return this._resultType}get messageText(){return this._messageText}}class Xk{flush(){return!0}parse(t){return!0}}class Kk{flush(){return this._acceptanceTimeout=-1,!0}parse(t){return this._acceptanceTimeout=t.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class qk{flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(t){this._finalStatus=[],this._winningVoteCode=t.readInt(),this._ownVoteCode=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._finalStatus.push(t.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class Qk{flush(){return!0}parse(t){return this._votingTimeout=t.readInt(),this._chatRecord=t.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}class jn{flush(){return this._status=null,!0}parse(t){this._status=[];const e=t.readInt();for(let s=0;s<e;s++)this._status.push(t.readInt());return!0}get status(){return this._status}}jn.AWAITING_VOTE=0;jn.VOTED_OK=1;jn.VOTED_BAD=2;jn.VOTED_VERY_BAD=3;jn.NO_VOTE=4;jn.FINDING_NEW_VOTER=5;class Zk{flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(t){return t?(this._onDuty=t.readBoolean(),this._guidesOnDuty=t.readInt(),this._helpersOnDuty=t.readInt(),this._guardiansOnDuty=t.readInt(),!0):!1}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class Jk{constructor(t,e,s,i,n,a,o){this._type=t,this._secondsAgo=e,this._isGuide=s,this._otherPartyName=i,this._otherPartyFigure=n,this._description=a,this._roomName=o}get type(){return this._type}set type(t){this._type=t}get secondsAgo(){return this._secondsAgo}set secondsAgo(t){this._secondsAgo=t}get isGuide(){return this._isGuide}set isGuide(t){this._isGuide=t}get otherPartyName(){return this._otherPartyName}set otherPartyName(t){this._otherPartyName=t}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(t){this._otherPartyFigure=t}get description(){return this._description}set description(t){this._description=t}get roomName(){return this._roomName}set roomName(t){this._roomName=t}}class jh{flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(t){return t?(this._statusCode=t.readInt(),this._pendingTicket=new Jk(t.readInt(),t.readInt(),t.readBoolean(),t.readString(),t.readString(),t.readString(),t.readString()),!0):!1}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}}jh.GUIDE_REPORTING_STATUS_OK=0;jh.GUIDE_REPORTING_STATUS_PENDING_TICKET=1;jh.GUIDE_REPORTING_STATUS_ABUSIVE=2;jh.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;class $k{flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(t){return t?(this._asGuide=t.readBoolean(),this._helpRequestType=t.readInt(),this._helpRequestDescription=t.readString(),this._roleSpecificWaitTime=t.readInt(),!0):!1}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class tj{flush(){return!0}parse(t){return!!t}}class ej{flush(){return this._endReason=0,!0}parse(t){return t?(this._endReason=t.readInt(),!0):!1}get endReason(){return this._endReason}}class Za{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}Za.ERROR_GENERIC=0;Za.ERROR_GUIDES_REJECT=1;Za.ERROR_NOT_ENOUGH_GUIDES=2;Za.ERROR_NOT_ENOUGH_VOTES=3;Za.ERROR_NO_CHATLOG_FOUND=4;class sj{flush(){return this._roomId=0,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class rj{flush(){return this._chatMessage=null,this._senderId=0,!0}parse(t){return t?(this._chatMessage=t.readString(),this._senderId=t.readInt(),!0):!1}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class ij{flush(){return this._isTyping=!1,!0}parse(t){return t?(this._isTyping=t.readBoolean(),!0):!1}get isTyping(){return this._isTyping}}class nj{flush(){return this._requesterRoomId=0,!0}parse(t){return t?(this._requesterRoomId=t.readInt(),!0):!1}get requesterRoomId(){return this._requesterRoomId}}class aj{flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(t){return t?(this._requesterUserId=t.readInt(),this._requesterName=t.readString(),this._requesterFigure=t.readString(),this._guideUserId=t.readInt(),this._guideName=t.readString(),this._guideFigure=t.readString(),!0):!1}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}class zh{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}zh.CREATION_RESULT_OK=0;zh.CREATION_RESULT_UNABLE_TO_REPORT=1;zh.CREATION_RESULT_NO_CHATLOG_FOUND=2;zh.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;class v_{flush(){return this._resolution=0,!0}parse(t){return t?(this._resolution=t.readInt(),!0):!1}get resolution(){return this._resolution}}v_.RESOLUTION_GUARDIANS_TOOK_ACTION=0;v_.RESOLUTION_FORWARDED_TO_MODERATORS=1;v_.RESOLUTION_REPORTER_IS_ABUSIVE=2;class oj{flush(){return!0}parse(t){return!!t}}class hj{flush(){return this._closeReason=0,this._messageText="",!0}parse(t){return t?(this._closeReason=t.readInt(),this._messageText=t.readString(),!0):!1}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class uj{flush(){return this._quizCode=null,this._questionIds=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIds=[];for(let s=0;s<e;s++)this._questionIds.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class lj{flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIdsForWrongAnswers=[];for(let s=0;s<e;s++)this._questionIdsForWrongAnswers.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}class A_{constructor(t){this._id=t.readInt(),this._title=t.readString(),this._bodyText=t.readString(),this._buttonText=t.readString(),this._linkType=t.readInt(),this._linkContent=t.readString(),this._imageUrl=t.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}}A_.LINK_TYPE_URL=0;A_.LINK_TYPE_INTERNAL=1;A_.LINK_TYPE_NO_LINK=2;class _j{flush(){return this._articles=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._articles.push(new A_(t));return!0}get articles(){return this._articles}}class cj{flush(){return!0}parse(t){return t?(this._acknowledged=t.readBoolean(),!0):!1}get acknowledged(){return this._acknowledged}}class dj{flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(t){return t?(this._result=t.readInt(),this._newOfferId=t.readInt(),this._newPrice=t.readInt(),this._requestedOfferId=t.readInt(),!0):!1}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class fj{flush(){return this._offerId=0,this._success=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._success=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get success(){return this._success}}class gj{flush(){return this._tokenCount=0,this._result=0,!0}parse(t){return t?(this._result=t.readInt(),this._tokenCount=t.readInt(),!0):!1}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class Ej{flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(t){return t?(this._enabled=t.readBoolean(),this._commission=t.readInt(),this._credits=t.readInt(),this._advertisements=t.readInt(),this._minimumPrice=t.readInt(),this._maximumPrice=t.readInt(),this._offerTime=t.readInt(),this._displayTime=t.readInt(),!0):!1}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class pj{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class mj{flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(t){if(!t)return!1;this._averagePrice=t.readInt(),this._currentOfferCount=t.readInt(),this._historyLength=t.readInt();let e=t.readInt();for(;e>0;)this._dayOffsets.push(t.readInt()),this._averagePrices.push(t.readInt()),this._soldAmounts.push(t.readInt()),e--;return this._furniCategoryId=t.readInt(),this._furniTypeId=t.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class dv{constructor(t,e,s,i,n,a,o,h,u,c=-1){this._timeLeftMinutes=-1,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=i,this._stuffData=n,this._price=a,this._status=o,this._timeLeftMinutes=h,this._averagePrice=u,this._offerCount=c}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return this.stuffData!=null&&this.stuffData.uniqueSeries>0}}const S_=class Mo{constructor(){this.MAX_LIST_LENGTH=500}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(t){if(!t)return!1;const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),n=t.readInt();let a=t.readInt(),o=-1,h="",u=null;a===Mo.FURNITYPE_STUFF?(o=t.readInt(),u=Yi.parseObjectData(t)):a===Mo.FURNITYPE_WALL?(o=t.readInt(),h=t.readString()):a==Mo.FAKE_FURNITYPE_UNIQUE&&(o=t.readInt(),u=Pi.getData(Rs.FORMAT_KEY),u.uniqueNumber=t.readInt(),u.uniqueSeries=t.readInt(),a=Mo.FURNITYPE_STUFF);const c=t.readInt(),l=t.readInt(),_=t.readInt(),d=t.readInt(),f=new dv(i,o,a,h,u,c,n,l,_,d);s<this.MAX_LIST_LENGTH&&this._offers.push(f),s++}return this._totalItemsFound=t.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}};S_.FURNITYPE_STUFF=1;S_.FURNITYPE_WALL=2;S_.FAKE_FURNITYPE_UNIQUE=3;let Ij=S_;const fv=class gv{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;this._offers=[],this._creditsWaiting=t.readInt();const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt();let a=t.readInt(),o,h,u;a==1?(o=t.readInt(),u=this.getStuffData(t)):a==2?(o=t.readInt(),h=t.readString()):a==3&&(o=t.readInt(),u=Pi.getData(Rs.FORMAT_KEY),u.uniqueNumber=t.readInt(),u.uniqueSeries=t.readInt(),a=1);const c=t.readInt(),l=t.readInt(),_=t.readInt(),d=new dv(i,o,a,h,u,c,n,l,_);s<gv.MAX_LIST_LENGTH&&this._offers.push(d)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(t){const e=t.readInt(),s=Pi.getData(e);return s.parseWrapper(t),s}};fv.MAX_LIST_LENGTH=500;let Tj=fv;class Rj{constructor(t,e,s,i,n){this._timestamp=t,this._habboId=e,this._username=s,this._message=i,this._hasHighlighting=n}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}class vr{constructor(t){this._context=new Map,this._chatlog=[],this._recordType=t.readByte();const e=t.readShort();for(let i=0;i<e;i++){const n=t.readString(),a=t.readByte();switch(a){case 0:this._context.set(n,t.readBoolean());break;case 1:this._context.set(n,t.readInt());break;case 2:this._context.set(n,t.readString());break;default:throw new Error("Unknown data type "+a)}}const s=t.readShort();for(let i=0;i<s;i++){const n=t.readString(),a=t.readInt(),o=t.readString(),h=t.readString(),u=t.readBoolean();this._chatlog.push(new Rj(n,a,o,h,u))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(t){const e=this._context.get(t);return e||0}}vr.TYPE_SIMPLE=0;vr.TYPE_ROOM_CHAT=1;vr.TYPE_IM_SESSION=2;vr.TYPE_DISCUSSION_THREAD=3;vr.TYPE_DISCUSSION_MESSAGE=4;vr.TYPE_SELFIE=5;vr.TYPE_PHOTO=6;class Oj{constructor(t){this._issueId=t.readInt(),this._callerUserId=t.readInt(),this._reportedUserId=t.readInt(),this._chatRecordId=t.readInt(),this._chatRecord=new vr(t)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class vj{flush(){return this._data=null,!0}parse(t){return t?(this._data=new Oj(t),!0):!1}get data(){return this._data}}class Aj{flush(){return!0}parse(t){return this._issueId=parseInt(t.readString()),!0}get issueId(){return this._issueId}}class Yh{constructor(t,e,s,i,n,a,o,h,u,c,l,_,d,f,m,p){this._disposed=!1,this._issueId=t,this._state=e,this._categoryId=s,this._reportedCategoryId=i,this._issueAgeInMilliseconds=n,this._priority=a,this._groupingId=o,this._reporterUserId=h,this._reporterUserName=u,this._reportedUserId=c,this._reportedUserName=l,this._pickerUserId=_,this._pickerUserName=d,this._message=f,this._chatRecordId=m,this._patterns=p,this._creationTimeInMilliseconds=ft()}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const t of this._patterns)t.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(t){const s=(this._issueAgeInMilliseconds+t-this._creationTimeInMilliseconds)/1e3/60,i=s%60,n=s/60,a=(i<10?"0":"")+i;return(n<10?"0":"")+n+":"+a}}Yh.STATE_OPEN=1;Yh.STATE_PICKED=2;Yh.STATE_CLOSED=3;class Sj{constructor(t){this._disposed=!1,this._pattern=t.readString(),this._startIndex=t.readInt(),this._endIndex=t.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class Ev{get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(t){const e=t.readInt(),s=t.readInt(),i=t.readInt(),n=t.readInt(),a=t.readInt(),o=t.readInt(),h=t.readInt(),u=t.readInt(),c=t.readString(),l=t.readInt(),_=t.readString(),d=t.readInt(),f=t.readString(),m=t.readString(),p=t.readInt(),T=t.readInt(),v=[];for(let O=0;O<T;O++)v.push(new Sj(t));return this._issueData=new Yh(e,s,i,n,a,o,h,u,c,l,_,d,f,m,p,v),!0}}class yj{flush(){return this._issues=null,!0}parse(t){this._issues=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt(),a=t.readString(),o=new Yh(i,0,0,0,0,0,0,0,null,0,null,n,a,null,0,[]);this._issues.push(o)}return this._retryEnabled=t.readBoolean(),this._retryCount=t.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class Mj{flush(){return this._message="",this._url=null,!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class Cj{flush(){return this._userId=-1,this._success=!1,!0}parse(t){return this._userId=t.readInt(),this._success=t.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class Nj{constructor(t){this._disposed=!1;const e=new Ev;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let s=t.readInt(),i=0;for(;i<s;)e.parse(t)&&this._issues.push(e.issueData),i++;for(s=t.readInt(),i=0;i<s;)this._messageTemplates.push(t.readString()),i++;for(s=t.readInt(),i=0;i<s;)t.readString(),i++;for(this._cfhPermission=t.readBoolean(),this._chatlogsPermission=t.readBoolean(),this._alertPermission=t.readBoolean(),this._kickPermission=t.readBoolean(),this._banPermission=t.readBoolean(),this._roomAlertPermission=t.readBoolean(),this._roomKickPermission=t.readBoolean(),s=t.readInt(),i=0;i<s;)this._roomMessageTemplates.push(t.readString()),i++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class bj{constructor(){this._data=null}flush(){return this._data=null,!0}parse(t){return this._data=new Nj(t),!0}get data(){return this._data}}class Pj{flush(){return this._message="",this._url="",!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class Dj{constructor(t){if(this._tags=[],this._exists=t.readBoolean(),!this.exists)return;this._name=t.readString(),this._desc=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._tags.push(t.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class Lj{constructor(t){this._flatId=t.readInt(),this._userCount=t.readInt(),this._ownerInRoom=t.readBoolean(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._room=new Dj(t)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._room!=null&&(this._room.dispose(),this._room=null))}}class Uj{flush(){return this._data=null,!0}parse(t){return t?(this._data=new Lj(t),!0):!1}get data(){return this._data}}class xj{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(t){return this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class Fj{constructor(t){this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._registrationAgeInMinutes=t.readInt(),this._minutesSinceLastLogin=t.readInt(),this._online=t.readBoolean(),this._cfhCount=t.readInt(),this._abusiveCfhCount=t.readInt(),this._cautionCount=t.readInt(),this._banCount=t.readInt(),this._tradingLockCount=t.readInt(),this._tradingExpiryDate=t.readString(),this._lastPurchaseDate=t.readString(),this._identityId=t.readInt(),this._identityRelatedBanCount=t.readInt(),this._primaryEmailAddress=t.readString(),this._userClassification=t.readString(),t.bytesAvailable&&(this._lastSanctionTime=t.readString(),this._sanctionAgeHours=t.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class wj{flush(){return this._data=null,!0}parse(t){return t?(this._data=new Fj(t),!0):!1}get data(){return this._data}}class Gj{flush(){return this._data=null,!0}parse(t){return t?(this._data=new vr(t),!0):!1}get data(){return this._data}}class Bj{constructor(t){this._roomId=t.readInt(),this._roomName=t.readString(),this._enterHour=t.readInt(),this._enterMinute=t.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class Hj{constructor(t){this._rooms=[],this._userId=t.readInt(),this._userName=t.readString();const e=t.readInt();let s=0;for(;s<e;)this._rooms.push(new Bj(t)),s++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class Vj{flush(){return!0}parse(t){return this._data=new Hj(t),!0}get data(){return this._data}}class kj{flush(){return this._message="",!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class jj{constructor(t){this._roomChatlogs=[],this._userId=t.readInt(),this._username=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._roomChatlogs.push(new vr(t))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class zj{flush(){return this._data=null,!0}parse(t){return t?(this._data=new jj(t),!0):!1}get data(){return this._data}}class Yj{flush(){return!0}parse(t){return!!t}}class Wj{flush(){return!0}parse(t){return t?(this._contentType=t.readString(),this._classId=t.readInt(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}}class Xj{flush(){return this._boxColor=null,this._keyColor=null,!0}parse(t){return t?(this._boxColor=t.readString(),this._keyColor=t.readString(),!0):!1}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class Kj{flush(){return!0}parse(t){return!!t}}class qj{flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(t){return t?(this._canCreate=t.readBoolean(),this._errorCode=t.readInt(),!0):!1}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}class hE{flush(){return!0}parse(t){return t?(this._resultCode=t.readInt(),this._roomLimit=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}}hE.CREATION_ALLOWED=0;hE.ROOM_LIMIT_REACHED=1;class Qj{constructor(t){this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt(),a=t.readInt();this._categoryToCurrentUserCountMap.set(i,n),this._categoryToMaxUserCountMap.set(i,a)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class Zj{constructor(t,e=0,s=0){this._goalId=e,this._pageIndex=s,t&&(this._goalId=t.readInt(),this._pageIndex=t.readInt(),this._pageCount=t.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}const y_=class Co{constructor(t){this._index=t.readInt(),this._popupCaption=t.readString(),this._popupDesc=t.readString(),this._showDetails=t.readInt()==1,this._picText=t.readString(),this._picRef=t.readString(),this._folderId=t.readInt(),this._userCount=t.readInt(),this._type=t.readInt(),this._type==Co.TYPE_TAG?this._tag=t.readString():this._type==Co.TYPE_GUEST_ROOM?this._guestRoomData=new m_(t):this._open=t.readBoolean()}dispose(){this._disposed||(this._disposed=!0,this._guestRoomData!=null&&(this._guestRoomData.flush(),this._guestRoomData=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get popupCaption(){return this._popupCaption}get popupDesc(){return this._popupDesc}get showDetails(){return this._showDetails}get picText(){return this._picText}get picRef(){return this._picRef}get folderId(){return this._folderId}get tag(){return this._tag}get userCount(){return this._userCount}get guestRoomData(){return this._guestRoomData}get open(){return this._open}toggleOpen(){this._open=!this._open}get maxUsers(){return this.type==Co.TYPE_TAG?0:this.type==Co.TYPE_GUEST_ROOM?this._guestRoomData.maxUserCount:0}};y_.TYPE_TAG=1;y_.TYPE_GUEST_ROOM=2;y_.TYPE_FOLDER=4;let Jj=y_;class $j{constructor(t){this._rooms=[],this._searchType=t.readInt(),this._searchParam=t.readString();const e=t.readInt();for(let i=0;i<e;i++)this._rooms.push(new m_(t));t.readBoolean()&&(this._ad=new Jj(t))}dispose(){if(!this._disposed){if(this._disposed=!0,this._rooms!=null)for(const t of this._rooms)t.flush();this._ad!=null&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get searchParam(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class pv{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(t){return t?(this._id=t.readInt(),this._code=t.readString(),this._filter=t.readString(),this._localization=t.readString(),!0):!1}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class t3{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString(),this._action=t.readInt(),this._closed=t.readBoolean(),this._mode=t.readInt();let e=t.readInt();for(;e>0;)this._rooms.push(new m_(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class e3{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString();let e=t.readInt();for(;e>0;)this._results.push(new t3(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class s3{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._savedSearches=[],!0}parse(t){if(!t)return!1;this._code=t.readString();let e=t.readInt();for(;e>0;)this._savedSearches.push(new pv(t)),e--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class r3{constructor(t){this._adId=t.readInt(),this._ownerAvatarId=t.readInt(),this._ownerAvatarName=t.readString(),this._flatId=t.readInt(),this._eventType=t.readInt(),this._eventName=t.readString(),this._eventDescription=t.readString();const e=t.readInt(),s=t.readInt(),i=new Date;let n=i.getTime();const a=e*60*1e3;n=n-a;const o=new Date(n);this._creationTime=o.getDate()+"-"+o.getMonth()+"-"+o.getFullYear()+" "+o.getHours()+":"+o.getMinutes();let h=i.getTime();const u=s*60*1e3;h=h+u,this._expirationDate=new Date(h),this._categoryId=t.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class i3{flush(){return!0}parse(t){return t?(this._data=new Qj(t),!0):!1}get data(){return this._data}}class n3{flush(){return!0}parse(t){return t?(this._data=new Zj(t),!0):!1}get data(){return this._data}}class a3{flush(){return!0}parse(t){return t?(this._globalId=t.readString(),this._convertedId=t.readInt(),!0):!1}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class o3{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class h3{flush(){return!0}parse(t){return t?(this._flatId=t.readInt(),this._added=t.readBoolean(),!0):!1}get flatId(){return this._flatId}get added(){return this._added}}class u3{flush(){return!0}parse(t){if(!t)return!1;this._favouriteRoomIds=[],this._limit=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._favouriteRoomIds.push(t.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class l3{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class _3{flush(){return this._roomId=-1,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class c3{flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isWelcomeRoom=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(t){return t?(this._roomEnter=t.readBoolean(),this._data=new m_(t),this._roomForward=t.readBoolean(),this._staffPick=t.readBoolean(),this._isWelcomeRoom=t.readBoolean(),this._isGroupMember=t.readBoolean(),this.data.allInRoomMuted=t.readBoolean(),this._moderation=new Gh(t),this.data.canMute=t.readBoolean(),this._chat=new fs(t),!0):!1}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isWelcomeRoom(){return this._isWelcomeRoom}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class d3{flush(){return!0}parse(t){return t?(this._data=new $j(t),!0):!1}get data(){return this._data}}class f3{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),this._automatic=t.readBoolean(),this._automaticCategoryKey=t.readString(),this._globalCategoryKey=t.readString(),this._staffOnly=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class g3{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(t.readString()),e--;return!0}get categories(){return this._categories}}class E3{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class p3{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(t){return t?(this._homeRoomId=t.readInt(),this._roomIdToEnter=t.readInt(),!0):!1}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class m3{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._areaId=t.readInt(),this._image=t.readString(),this._caption=t.readString(),!0):!1}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class I3{flush(){return this._rooms=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._rooms.push(new m3(t)),e--;return!0}get rooms(){return this._rooms}}class T3{flush(){return this._topLevelContexts=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._topLevelContexts.push(new s3(t)),e--;return!0}get topLevelContexts(){return this._topLevelContexts}}class R3{flush(){return!0}parse(t){return!!t}}class O3{flush(){return this._searches=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._searches.push(new pv(t)),e--;return!0}get searches(){return this._searches}}class v3{flush(){return this._result=null,!0}parse(t){return t?(this._result=new e3(t),!0):!1}get result(){return this._result}}class A3{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(t){return t?(this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),this._leftPanelHidden=t.readBoolean(),this._resultsMode=t.readInt(),!0):!1}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class S3{constructor(t){this._tagName=t.readString(),this._userCount=t.readInt()}get tagName(){return this._tagName}get userCount(){return this._userCount}}class y3{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._tags=[],!0}parse(t){if(!t)return!1;this._tags=[];const e=t.readInt();let s=0;for(;s<e;)this._tags.push(new S3(t)),s++;return!0}get tags(){return this._tags}}class M3{flush(){return this._data=null,!0}parse(t){return t?(this._data=new y3(t),!0):!1}get data(){return this._data}}class C3{flush(){return!0}parse(t){return!0}}class N3{flush(){return!0}parse(t){return this._data=new r3(t),!0}get data(){return this._data}}class b3{flush(){return this._words=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._words.push(t.readString()),e--;return!0}get words(){return this._words}}class P3{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class D3{flush(){return!0}parse(t){return this._flatId=t.readInt(),this._resultCode=t.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class L3{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new E3(t)),e--;return!0}get categories(){return this._categories}}class U3{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new f3(t)),e--;return!0}get categories(){return this._categories}}class x3{constructor(t){this._badgeCode="",this._removedBadgeCode="",this._type=t.readInt(),this._level=t.readInt(),this._badgeId=t.readInt(),this._badgeCode=t.readString(),this._points=t.readInt(),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._bonusPoints=t.readInt(),this._achievementID=t.readInt(),this._removedBadgeCode=t.readString(),this._category=t.readString(),this._showDialogToUser=t.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class F3{flush(){return this._data=null,!0}parse(t){return t?(this._data=new x3(t),!0):!1}get data(){return this._data}}class w3{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(t){return t?(this._amount=t.readInt(),this._amountChanged=t.readInt(),this._type=t.readInt(),!0):!1}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class G3{flush(){return this._message=null,this._image=null,this._link=null,!0}parse(t){return t?(this._message=t.readString(),this._image=t.readString(),this._link=t.readString(),!0):!1}get message(){return this._message}get image(){return this._image}get link(){return this._link}}class B3{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class H3{flush(){return this._numGifts=0,!0}parse(t){return t?(this._numGifts=t.readInt(),!0):!1}get numGifts(){return this._numGifts}}class V3{flush(){return this._errorCode=0,this._messageId=0,this._timestamp=null,!0}parse(t){return t?(this._messageId=t.readInt(),this._errorCode=t.readInt(),this._timestamp=t.readString(),!0):!1}get errorCode(){return this._errorCode}get messageId(){return this._messageId}get timestamp(){return this._timestamp}}class k3{flush(){return this._key=null,!0}parse(t){return t?(this._key=t.readString(),!0):!1}get key(){return this._key}}class j3{flush(){return this._message=null,!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class z3{flush(){return this._enabled=!1,!0}parse(t){return t?(this._enabled=t.readBoolean(),!0):!1}get enabled(){return this._enabled}}class Y3{flush(){return this._messages=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._messages.push(t.readString()),e--;return!0}get messages(){return this._messages}}class W3{flush(){return this._type=null,this._parameters=new Map,!0}parse(t){if(!t)return!1;this._type=t.readString();let e=t.readInt();for(;e>0;)this._parameters.set(t.readString(),t.readString()),e--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class X3{flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(t){return t?(this._petId=t.readInt(),this._petName=t.readString(),this._level=t.readInt(),this._figureData=new rE(t),!0):!1}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class K3{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class q3{flush(){return this._alertMessage=null,!0}parse(t){return t?(this._alertMessage=t.readString(),t.bytesAvailable&&(this._titleMessage=t.readString()),!0):!1}get alertMessage(){return this._alertMessage}get titleMessage(){return this._titleMessage}}class Q3{flush(){return this._items=new de,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt();let i=t.readInt();const n=[];for(;i>0;)n.push(t.readInt()),i--;this._items.add(s,n),e--}return!0}getItemsByCategory(t){return this._items.getValue(t)}get categories(){return this._items.getKeys()}}class Z3{constructor(t,e,s){this._code=t,this._errorMessage=e,this._isAllowed=s}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}class Fs{}Fs.USE_GUIDE_TOOL="USE_GUIDE_TOOL";Fs.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR";Fs.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS";Fs.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS";Fs.CALL_ON_HELPERS="CALL_ON_HELPERS";Fs.CITIZEN="CITIZEN";Fs.TRADE="TRADE";Fs.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA";Fs.BUILDER_AT_WORK="BUILDER_AT_WORK";Fs.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA";Fs.CAMERA="CAMERA";Fs.MOUSE_ZOOM="MOUSE_ZOOM";class J3{flush(){return this._perks=[],!0}parse(t){if(!t)return!1;this._perks=[];const e=t.readInt();for(let s=0;s<e;s++)this._perks.push(new Z3(t.readString(),t.readString(),t.readBoolean()));return!0}isAllowed(t){let e=!1;for(const s of this._perks)if(s.code===t){e=s.isAllowed;break}return e}get perks(){return this._perks}}class $3{flush(){return this._objectId=-1,this._figureData=null,!0}parse(t){return this._objectId=t.readInt(),t.bytesAvailable&&(this._figureData=new ql(t.readString())),!0}get objectId(){return this._objectId}get figureData(){return this._figureData}}class tz{flush(){return this._objectId=0,this._nameValidationStatus=0,this._nameValidationInfo=null,!0}parse(t){return this._objectId=t.readInt(),this._nameValidationStatus=t.readInt(),this._nameValidationInfo=t.readString(),!0}get objectId(){return this._objectId}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}class ez{flush(){return this._roomIndex=-1,this._petId=-1,this._level=-1,!0}parse(t){return this._roomIndex=t.readInt(),this._petId=t.readInt(),this._level=t.readInt(),!0}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get level(){return this._level}}class sz{flush(){return this._currentAge=-1,this._requiredAge=-1,!0}parse(t){return this._currentAge=t.readInt(),this._requiredAge=t.readInt(),!0}get currentAge(){return this._currentAge}get requiredAge(){return this._requiredAge}}class rz{flush(){return this._petId=-1,this._commands=[],this._enabledCommands=[],!0}parse(t){this._petId=t.readInt();let e=t.readInt();for(;e>0;)this._commands.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._enabledCommands.push(t.readInt()),s--;return!0}get petId(){return this._petId}get commands(){return this._commands}get enabledCommands(){return this._enabledCommands}}class iz{constructor(t,e,s){this._value=t,this._choiceText=e,this._choiceType=s}get value(){return this._value}set value(t){this._value=t}get choiceText(){return this._choiceText}set choiceText(t){this._choiceText=t}get choiceType(){return this._choiceType}set choiceType(t){this._choiceType=t}}class nz{constructor(){this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get questionType(){return this._questionType}set questionType(t){this._questionType=t}get sortOrder(){return this._sortOrder}set sortOrder(t){this._sortOrder=t}get questionText(){return this._questionText}set questionText(t){this._questionText=t}get questionCategory(){return this._questionCategory}set questionCategory(t){this._questionCategory=t}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(t){this._questionAnswerType=t}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(t){this._questionAnswerCount=t}get children(){return this._children}set children(t){this._children=t}get questionChoices(){return this._questionChoices}set questionChoices(t){this._questionChoices=t}}class az{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(t){this._id=t.readInt(),this._startMessage=t.readString(),this._endMessage=t.readString(),this._numQuestions=t.readInt();for(let e=0;e<this._numQuestions;e++){const s=this.parsePollQuestion(t),i=t.readInt();for(let n=0;n<i;n++)s.children.push(this.parsePollQuestion(t));this._questionArray.push(s)}return this._npsPoll=t.readBoolean(),!0}parsePollQuestion(t){const e=new nz;if(e.questionId=t.readInt(),e.sortOrder=t.readInt(),e.questionType=t.readInt(),e.questionText=t.readString(),e.questionCategory=t.readInt(),e.questionAnswerType=t.readInt(),e.questionAnswerCount=t.readInt(),e.questionType==1||e.questionType==2)for(let s=0;s<e.questionAnswerCount;s++)e.questionChoices.push(new iz(t.readString(),t.readString(),t.readInt()));return e}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class oz{flush(){throw!0}parse(t){return!0}}class hz{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(t){return this._id=t.readInt(),this._type=t.readString(),this._headline=t.readString(),this._summary=t.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class uz{flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(t){this._userId=t.readInt(),this._value=t.readString(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),n=t.readInt();this._answerCounts.set(i,n)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class lz{flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(t){this._questionId=t.readInt(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),n=t.readInt();this._answerCounts.set(i,n)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class _z{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(t){this._pollType=t.readString(),this._pollId=t.readInt(),this._questionId=t.readInt(),this._duration=t.readInt();const e=t.readInt(),s=t.readInt(),i=t.readInt(),n=t.readString();if(this._question={id:e,number:s,type:i,content:n},this._question.type==1||this._question.type==2){this._question.selection_min=t.readInt();const a=t.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=a,this._question.selection_max=a;for(let o=0;o<a;o++)this._question.selection_values.push(t.readString()),this._question.selections.push(t.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class cz{constructor(t){this._rewardUserLimits=[],this._hasGoalExpired=t.readBoolean(),this._personalContributionScore=t.readInt(),this._personalContributionRank=t.readInt(),this._communityTotalScore=t.readInt(),this._communityHighestAchievedLevel=t.readInt(),this._scoreRemainingUntilNextLevel=t.readInt(),this._percentCompletionTowardsNextLevel=t.readInt(),this._goalCode=t.readString(),this._timeRemainingInSeconds=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._rewardUserLimits.push(t.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return this._rewardUserLimits==null}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class dz{constructor(t){this._communityGoalId=t.readInt(),this._communityGoalCode=t.readString(),this._userRank=t.readInt(),this._rewardCode=t.readString(),this._badge=t.readBoolean(),this._localizedName=t.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class fz{flush(){return this._prizes=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._prizes.push(new dz(t));return!0}get prizes(){return this._prizes}}class gz{constructor(t){this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._rank=t.readInt(),this._currentScore=t.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class Ez{constructor(t){this._hof=[],this._goalCode=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._hof.push(new gz(t))}dispose(){this._hof=null}get disposed(){return this._hof==null}get hof(){return this._hof}get goalCode(){return this._goalCode}}class pz{flush(){return this._data=null,!0}parse(t){return t?(this._data=new Ez(t),!0):!1}get data(){return this._data}}class mz{flush(){return this._data=null,!0}parse(t){return t?(this._data=new cz(t),!0):!1}get data(){return this._data}}class Iz{flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(t){return t?(this._state=t.readInt(),this._userCount=t.readInt(),this._userCountGoal=t.readInt(),!0):!1}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class Tz{flush(){return this._imageUri="",!0}parse(t){return t?(this._imageUri=t.readString(),!0):!1}get imageUri(){return this._imageUri}}class Rz{flush(){return!0}parse(t){return t?(this._expired=t.readBoolean(),!0):!1}get expired(){return this._expired}}class zn{constructor(t){this._receiveTime=new Date,this._campaignCode=t.readString(),this._completedQuestsInCampaign=t.readInt(),this._questCountInCampaign=t.readInt(),this._activityPointType=t.readInt(),this._id=t.readInt(),this._accepted=t.readBoolean(),this._type=t.readString(),this._imageVersion=t.readString(),this._rewardCurrencyAmount=t.readInt(),this._localizationCode=t.readString(),this._completedSteps=t.readInt(),this._totalSteps=t.readInt(),this._sortOrder=t.readInt(),this._catalogPageName=t.readString(),this._chainCode=t.readString(),this._easy=t.readBoolean()}static getCampaignLocalizationKeyForCode(t){return"quests."+t}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(t){this._accepted=t}get accepted(){return this._accepted}set id(t){this._id=t}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(t){this._waitPeriodSeconds=t}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const e=new Date().getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(e/1e3))}getCampaignLocalizationKey(){return zn.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}}class Oz{flush(){return this._questData=null,!0}parse(t){return t?(this._questData=new zn(t),this._showDialog=t.readBoolean(),!0):!1}get questData(){return this._questData}get showDialog(){return this._showDialog}}class vz{flush(){return this._quest=null,!0}parse(t){return t?(t.readBoolean()&&(this._quest=new zn(t),this._easyQuestCount=t.readInt(),this._hardQuestCount=t.readInt()),!0):!1}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class Az{flush(){return this._quest=null,!0}parse(t){return t?(this._quest=new zn(t),!0):!1}get quest(){return this._quest}}class Sz{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new zn(t));return this._openWindow=t.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class yz{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new zn(t));return!0}get quests(){return this._quests}}class Mz{flush(){return this._recyclerFinishedStatus=-1,this._prizeId=0,!0}parse(t){return t?(this._recyclerFinishedStatus=t.readInt(),this._prizeId=t.readInt(),!0):!1}get recyclerFinishedStatus(){return this._recyclerFinishedStatus}get prizeId(){return this._prizeId}}class Cz{flush(){return this._recyclerStatus=-1,this._recyclerTimeoutSeconds=0,!0}parse(t){return t?(this._recyclerStatus=t.readInt(),this._recyclerTimeoutSeconds=t.readInt(),!0):!1}get recyclerStatus(){return this._recyclerStatus}get recyclerTimeoutSeconds(){return this._recyclerTimeoutSeconds}}class uE{constructor(t){this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=t.readBoolean(),this._furniLimit=t.readInt();let e=t.readInt();for(;e>0;)this._stuffIds.push(t.readInt()),e--;for(this._stuffTypeId=t.readInt(),this._id=t.readInt(),this._stringParam=t.readString(),e=t.readInt();e>0;)this._intParams.push(t.readInt()),e--;this._stuffTypeSelectionCode=t.readInt()}getBoolean(t){return this._intParams[t]===1}get stuffTypeSelectionEnabled(){return this._stuffTypeSelectionEnabled}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(t){this._stuffTypeSelectionCode=t}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class Nz extends uE{constructor(t){super(t),this._type=t.readInt()}get type(){return this._type}get code(){return this._type}}class bz extends uE{constructor(t){super(t),this._conflictingActions=[],this._triggerConf=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingActions.push(t.readInt()),e--}get code(){return this._triggerConf}get conflictingActions(){return this._conflictingActions}}class Pz extends uE{constructor(t){super(t),this._conflictingTriggers=[],this._type=t.readInt(),this._delayInPulses=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingTriggers.push(t.readInt()),e--}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get conflictingTriggers(){return this._conflictingTriggers}}class Dz{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new Pz(t),!0):!1}get definition(){return this._definition}}class Lz{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new Nz(t),!0):!1}get definition(){return this._definition}}class Uz{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new bz(t),!0):!1}get definition(){return this._definition}}class xz{flush(){return this._stuffId=0,!0}parse(t){return t?(this._stuffId=t.readInt(),!0):!1}get stuffId(){return this._stuffId}}class Fz{flush(){return this._reason=0,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class wz{flush(){return!0}parse(t){return!!t}}class Gz{flush(){return this._info=null,!0}parse(t){return t?(this._info=t.readString(),!0):!1}get info(){return this._info}}class Bz{flush(){return!0}parse(t){return!!t}}class Hz{flush(){return!0}parse(t){return!0}}class Vz{constructor(){this._songDisks=new de}flush(){return this._songDisks.reset(),this._maxLength=0,!0}parse(t){this._maxLength=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._songDisks.add(t.readInt(),t.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class kz{flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(t){return this._currentSongId=t.readInt(),this._currentPosition=t.readInt(),this._nextSongId=t.readInt(),this._nextPosition=t.readInt(),this._syncCount=t.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class jz{flush(){return this._songId=0,this._officialSongId="",!0}parse(t){return this._officialSongId=t.readString(),this._songId=t.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class M_{constructor(t,e,s,i){this._startPlayHead=0,this._id=t,this._length=e,this._name=s,this._creator=i}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(t){this._startPlayHead=t}}class zz{flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(t){this._synchronizationCount=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._playlist.push(new M_(t.readInt(),t.readInt(),t.readString(),t.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class Yz{flush(){return this._entry=null,!0}parse(t){return this._entry=new M_(t.readInt(),t.readInt(),t.readString(),t.readString()),!0}get entry(){return this._entry}}class Wz extends M_{constructor(t,e,s,i,n){super(t,e,s,i),this._data="",this._data=n}get data(){return this._data}}class Xz{flush(){return this._songs=[],!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt();t.readString();const n=t.readString(),a=t.readString(),o=t.readInt(),h=t.readString(),u=new Wz(i,o,n,h,a);this._songs.push(u)}return!0}get songs(){return this._songs}}class Kz{constructor(){this._songDiskInventory=new de}flush(){return this._songDiskInventory.reset(),!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++)this._songDiskInventory.add(t.readInt(),t.readInt());return!0}getDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}get songDiskCount(){return this._songDiskInventory.length}}class qz{flush(){return this._talentTrackName=null,this._level=-1,this._rewardPerks=[],this._rewardProducts=[],!0}parse(t){if(!t)return!1;let e=0;this._talentTrackName=t.readString(),this._level=t.readInt();const s=t.readInt();for(;e<s;)this._rewardPerks.push(new tY(t)),e++;const i=t.readInt();if(e<i)for(let n=0;n<i;n++){const a=t.readString(),o=t.readInt();this._rewardProducts.push(new mv(a,o)),e++}return!0}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get rewardPerks(){return this._rewardPerks}get rewardProducts(){return this._rewardProducts}}class Qz{constructor(t,e,s,i,n){this._level=t,this._state=e,this._tasks=s,this._rewardPerks=i,this._rewardProducts=n}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class Zz{flush(){return this._talentTrackName=null,this._level=-1,this._maxLevel=-1,!0}parse(t){return t?(this._talentTrackName=t.readString(),this._level=t.readInt(),this._maxLevel=t.readInt(),!0):!1}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get maxLevel(){return this._maxLevel}}class mv{constructor(t,e){this._productCode=t,this._vipDays=e}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class Jz{constructor(t,e,s,i,n,a){this._id=t,this._requiredLevel=e,this._badgeCode=s,this._state=i,this._currentScore=n,this._totalScore=a}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class $z{flush(){return this._type=null,this._levels=null,!0}parse(t){if(!t)return!1;this._type=t.readString(),this._levels=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),n=t.readInt(),a=[],o=t.readInt();for(let _=0;_<o;_++){const d=t.readInt(),f=t.readInt(),m=t.readString(),p=t.readInt(),T=t.readInt(),v=t.readInt();a.push(new Jz(d,f,m,p,T,v))}const h=[],u=t.readInt();for(let _=0;_<u;_++)h.push(t.readString());const c=[],l=t.readInt();for(let _=0;_<l;_++){const d=t.readString(),f=t.readInt();c.push(new mv(d,f))}this._levels.push(new Qz(i,n,a,h,c))}return!0}get type(){return this._type}get levels(){return this._levels}}class tY{constructor(t){this._perkId=t.readInt()}get perkId(){return this._perkId}}class eY{flush(){return this._classifiedUsersNames&&(this._classifiedUsersNames=new Map),this._classifiedUsersClass&&(this._classifiedUsersClass=new Map),!0}parse(t){if(!t)return!1;let e,s,i,n=t.readInt();for(this._classifiedUsersNames=new Map,this._classifiedUsersClass=new Map;n>0;)e=t.readInt(),s=t.readString(),i=t.readString(),this._classifiedUsersNames.set(e,s),this._classifiedUsersClass.set(e,i),n--;return!0}get classifiedUsernameMap(){return this._classifiedUsersNames}get classifiedUserTypeMap(){return this._classifiedUsersClass}}class sY extends R{constructor(t){super(t,tG)}getParser(){return this.parser}}class rY extends R{constructor(t){super(t,eG)}getParser(){return this.parser}}class Iv extends R{constructor(t){super(t,sG)}getParser(){return this.parser}}class iY extends R{constructor(t){super(t,rG)}getParser(){return this.parser}}class nY extends R{constructor(t){super(t,iG)}getParser(){return this.parser}}class aY extends R{constructor(t){super(t,nG)}getParser(){return this.parser}}class oY extends R{constructor(t){super(t,aG)}getParser(){return this.parser}}class hY extends R{constructor(t){super(t,oG)}getParser(){return this.parser}}class Ks extends R{constructor(t){super(t,hG)}getParser(){return this.parser}}Ks.NAME_OK=0;Ks.ERROR_NAME_REQUIRED=1;Ks.ERROR_NAME_TOO_SHORT=2;Ks.ERROR_NAME_TOO_LONG=3;Ks.ERROR_NAME_NOT_VALID=4;Ks.ERROR_NAME_IN_USE=5;Ks.ERROR_NAME_CHANGE_NOT_ALLOWED=6;Ks.ERROR_MERGE_HOTEL_DOWN=7;class uY extends R{constructor(t){super(t,uG)}getParser(){return this.parser}}class Tv extends R{constructor(t){super(t,lG)}getParser(){return this.parser}}class lY extends R{constructor(t){super(t,cG)}getParser(){return this.parser}}class _Y extends R{constructor(t){super(t,dG)}getParser(){return this.parser}}class cY extends R{constructor(t){super(t,fG)}getParser(){return this.parser}}class dY extends R{constructor(t){super(t,gG)}getParser(){return this.parser}}class fY extends R{constructor(t){super(t,EG)}getParser(){return this.parser}}class gY extends R{constructor(t){super(t,TG)}getParser(){return this.parser}}class EY extends R{constructor(t){super(t,RG)}getParser(){return this.parser}}class pY extends R{constructor(t){super(t,OG)}getParser(){return this.parser}}class mY extends R{constructor(t){super(t,vG)}getParser(){return this.parser}}class IY extends R{constructor(t){super(t,AG)}getParser(){return this.parser}}class TY extends R{constructor(t){super(t,SG)}getParser(){return this.parser}}class RY extends R{constructor(t){super(t,yG)}getParser(){return this.parser}}class OY extends R{constructor(t){super(t,MG)}getParser(){return this.parser}}class vY extends R{constructor(t){super(t,CG)}getParser(){return this.parser}}class AY extends R{constructor(t){super(t,NG)}getParser(){return this.parser}}class SY extends R{constructor(t){super(t,bG)}getParser(){return this.parser}}class yY extends R{constructor(t){super(t,PG)}getParser(){return this.parser}}class MY extends R{constructor(t){super(t,DG)}getParser(){return this.parser}}class CY extends R{constructor(t){super(t,LG)}getParser(){return this.parser}}class NY extends R{constructor(t){super(t,xG)}getParser(){return this.parser}}class bY extends R{constructor(t){super(t,GG)}getParser(){return this.parser}}class PY extends R{constructor(t){super(t,HG)}getParser(){return this.parser}}class DY extends R{constructor(t){super(t,FG)}getParser(){return this.parser}}class LY extends R{constructor(t){super(t,VG)}getParser(){return this.parser}}class UY extends R{constructor(t){super(t,kG)}getParser(){return this.parser}}class xY extends R{constructor(t){super(t,zG)}getParser(){return this.parser}}class FY extends R{constructor(t){super(t,YG)}getParser(){return this.parser}}class wY extends R{constructor(t){super(t,XG)}getParser(){return this.parser}}class GY extends R{constructor(t){super(t,KG)}getParser(){return this.parser}}class BY extends R{constructor(t){super(t,qG)}getParser(){return this.parser}}class HY extends R{constructor(t){super(t,QG)}getParser(){return this.parser}}class VY extends R{constructor(t){super(t,ZG)}getParser(){return this.parser}}class kY extends R{constructor(t){super(t,JG)}getParser(){return this.parser}}class jY extends R{constructor(t){super(t,$G)}getParser(){return this.parser}}class zY extends R{constructor(t){super(t,tB)}getParser(){return this.parser}}class YY extends R{constructor(t){super(t,eB)}getParser(){return this.parser}}class WY extends R{constructor(t){super(t,sB)}getParser(){return this.parser}}class XY extends R{constructor(t){super(t,rB)}getParser(){return this.parser}}class KY extends R{constructor(t){super(t,iB)}getParser(){return this.parser}}class qY extends R{constructor(t){super(t,aB)}getParser(){return this.parser}}class QY extends R{constructor(t){super(t,oV)}getParser(){return this.parser}}class ZY extends R{constructor(t){super(t,hV)}getParser(){return this.parser}}class JY extends R{constructor(t){super(t,lV)}getParser(){return this.parser}}class $Y extends R{constructor(t){super(t,dV)}getParser(){return this.parser}}class t5 extends R{constructor(t){super(t,cV)}getParser(){return this.parser}}class e5 extends R{constructor(t){super(t,fV)}getParser(){return this.parser}}class s5 extends R{constructor(t){super(t,gV)}getParser(){return this.parser}}class Rv extends R{constructor(t){super(t,EV)}getParser(){return this.parser}}class r5 extends R{constructor(t){super(t,Wi)}getParser(){return this.parser}}class i5 extends R{constructor(t){super(t,pV)}getParser(){return this.parser}}class n5 extends R{constructor(t){super(t,mV)}getParser(){return this.parser}}class a5 extends R{constructor(t){super(t,IV)}getParser(){return this.parser}}class o5 extends R{constructor(t){super(t,TV)}getParser(){return this.parser}}class h5 extends R{constructor(t){super(t,RV)}getParser(){return this.parser}}class u5 extends R{constructor(t){super(t,OV)}getParser(){return this.parser}}class l5 extends R{constructor(t){super(t,AV)}getParser(){return this.parser}}class _5 extends R{constructor(t){super(t,SV)}getParser(){return this.parser}}class c5 extends R{constructor(t){super(t,yV)}getParser(){return this.parser}}class df extends R{constructor(t){super(t,MV)}getParser(){return this.parser}}class d5 extends R{constructor(t){super(t,NV)}getParser(){return this.parser}}class f5 extends R{constructor(t){super(t,bV)}getParser(){return this.parser}}class g5 extends R{constructor(t){super(t,PV)}getParser(){return this.parser}}class E5 extends R{constructor(t){super(t,DV)}getParser(){return this.parser}}class p5 extends R{constructor(t){super(t,LV)}getParser(){return this.parser}}class m5 extends R{constructor(t){super(t,UV)}getParser(){return this.parser}}class I5 extends R{constructor(t){super(t,xV)}getParser(){return this.parser}}class T5 extends R{constructor(t){super(t,FV)}getParser(){return this.parser}}class R5 extends R{constructor(t){super(t,wV)}getParser(){return this.parser}}class O5 extends R{constructor(t){super(t,GV)}getParser(){return this.parser}}class v5 extends R{constructor(t){super(t,BV)}getParser(){return this.parser}}class A5 extends R{constructor(t){super(t,HV)}getParser(){return this.parser}}class S5 extends R{constructor(t){super(t,VV)}getParser(){return this.parser}}class y5 extends R{constructor(t){super(t,kV)}getParser(){return this.parser}}class Ov extends R{constructor(t){super(t,jV)}getParser(){return this.parser}}class M5 extends R{constructor(t){super(t,zV)}getParser(){return this.parser}}class C5 extends R{constructor(t){super(t,YV)}getParser(){return this.parser}}class N5 extends R{constructor(t){super(t,WV)}getParser(){return this.parser}}class b5 extends R{constructor(t){super(t,Bh)}getParser(){return this.parser}}class P5 extends R{constructor(t){super(t,XV)}getParser(){return this.parser}}class D5 extends R{constructor(t){super(t,li)}getParser(){return this.parser}}class L5 extends R{constructor(t){super(t,nE)}getParser(){return this.parser}}class U5 extends R{constructor(t){super(t,KV)}getParser(){return this.parser}}class x5 extends R{constructor(t){super(t,qV)}getParser(){return this.parser}}class F5 extends R{constructor(t){super(t,QV)}getParser(){return this.parser}}class w5 extends R{constructor(t){super(t,ZV)}getParser(){return this.parser}}class G5 extends R{constructor(t){super(t,JV)}getParser(){return this.parser}}class B5 extends R{constructor(t){super(t,tk)}getParser(){return this.parser}}class H5 extends R{constructor(t){super(t,sk)}getParser(){return this.parser}}class V5 extends R{constructor(t){super(t,rk)}getParser(){return this.parser}}class k5 extends R{constructor(t){super(t,ik)}getParser(){return this.parser}}class j5 extends R{constructor(t){super(t,nk)}getParser(){return this.parser}}class z5 extends R{constructor(t){super(t,cv)}getParser(){return this.parser}}class Y5 extends R{constructor(t){super(t,ak)}getParser(){return this.parser}}class W5 extends R{constructor(t){super(t,ok)}getParser(){return this.parser}}class vv extends R{constructor(t){super(t,hk)}getParser(){return this.parser}}class X5 extends R{constructor(t){super(t,uk)}getParser(){return this.parser}}class K5 extends R{constructor(t){super(t,lk)}getParser(){return this.parser}}class q5 extends R{constructor(t){super(t,O_)}getParser(){return this.parser}}class Q5 extends R{constructor(t){super(t,O_)}getParser(){return this.parser}}class Z5 extends R{constructor(t){super(t,O_)}getParser(){return this.parser}}class J5 extends R{constructor(t){super(t,O_)}getParser(){return this.parser}}class $5 extends R{constructor(t){super(t,ck)}getParser(){return this.parser}}class tW extends R{constructor(t){super(t,dk)}getParser(){return this.parser}}class ff extends R{constructor(t){super(t,fk)}getParser(){return this.parser}}class eW extends R{constructor(t){super(t,gk)}getParser(){return this.parser}}class sW extends R{constructor(t){super(t,Ek)}getParser(){return this.parser}}class rW extends R{constructor(t){super(t,pk)}getParser(){return this.parser}}class Av extends R{constructor(t){super(t,mk)}getParser(){return this.parser}}class iW extends R{constructor(t){super(t,Ik)}getParser(){return this.parser}}class nW extends R{constructor(t){super(t,Tk)}getParser(){return this.parser}}class aW extends R{constructor(t){super(t,Rk)}getParser(){return this.parser}}class oW extends R{constructor(t){super(t,Ak)}getParser(){return this.parser}}class hW extends R{constructor(t){super(t,Sk)}getParser(){return this.parser}}class uW extends R{constructor(t){super(t,yk)}getParser(){return this.parser}}class lW extends R{constructor(t){super(t,Mk)}getParser(){return this.parser}}class _W extends R{constructor(t){super(t,Ck)}getParser(){return this.parser}}class cW extends R{constructor(t){super(t,Nk)}getParser(){return this.parser}}class dW extends R{constructor(t){super(t,bk)}getParser(){return this.parser}}class fW extends R{constructor(t){super(t,Pk)}getParser(){return this.parser}}class gW extends R{constructor(t){super(t,Dk)}getParser(){return this.parser}}class EW extends R{constructor(t){super(t,Lk)}getParser(){return this.parser}}class pW extends R{constructor(t){super(t,Uk)}getParser(){return this.parser}}class mW extends R{constructor(t){super(t,xk)}getParser(){return this.parser}}class IW extends R{constructor(t){super(t,Fk)}getParser(){return this.parser}}class TW extends R{constructor(t){super(t,wk)}getParser(){return this.parser}}class lt{}lt.LOGOUT=0;lt.JUST_BANNED=1;lt.CONCURRENT_LOGIN=2;lt.CONNECTION_LOST_TO_PEER=3;lt.AVATAR_IDENTITY_CHANGE=4;lt.REMOVE_FURNITURE_TOOL=5;lt.STILL_BANNED=10;lt.DUAL_LOGIN_BY_USERID=11;lt.HOTEL_CLOSED=12;lt.DUAL_LOGIN_BY_IP=13;lt.PEER_CONNECTION_MISSING=16;lt.NO_LOGIN_PERMISSION=17;lt.DUPLICATE_CONNECTION=18;lt.HOTEL_CLOSING=19;lt.INCORRECT_PASSWORD=20;lt.INVALID_LOGIN_TICKET=22;lt.VERSION_CHECK_URL=23;lt.VERSION_CHECK_PROPERTY=24;lt.VERSION_CHECK_MACHINE_ID=25;lt.NO_MESSENGER_SESSION=26;lt.USER_NOT_FOUND=27;lt.CRYPTO_NOT_INITIALIZED=28;lt.DEV_CRYPTO_NOT_ALLOWED=29;lt.DUPLICATE_UUID_DETECTED=100;lt.OLD_SESSION_IN_PROXY=101;lt.PUBLIC_KEY_NOT_NUMERIC=102;lt.PUBLIC_KEY_TOO_SHORT=103;lt.SOCKET_READ_GENERIC=104;lt.SOCKET_READ_FIRST_BYTE=105;lt.SOCKET_READ_LENGTH=106;lt.SOCKET_READ_BODY=107;lt.SOCKET_READ_POLICY=108;lt.SOCKET_IO_EXCEPTION=109;lt.SOCKET_WRONG_CRYPTO=110;lt.PROXY_RUNTIME_EXCEPTION=111;lt.IDLE_CONNECTION=112;lt.PONG_TIMEOUT=113;lt.IDLE_CONNECTION_NOT_AUTH=114;lt.IDLE_CONNECTION_NO_USER_ID=115;lt.WRITE_CLOSED_CHANNEL=116;lt.SOCKET_WRITE_EXCEPTION_1=117;lt.SOCKET_WRITE_EXCEPTION_2=118;lt.SOCKET_WRITE_EXCEPTION_3=119;class RW extends R{constructor(t){super(t,Gk)}getParser(){return this.parser}get reasonString(){switch(this.getParser().reason){case lt.JUST_BANNED:case lt.STILL_BANNED:return"banned";case lt.CONCURRENT_LOGIN:return"concurrentlogin";case lt.INCORRECT_PASSWORD:return"incorrectpassword";default:return"logout"}}}class OW extends R{constructor(t){super(t,Bk)}getParser(){return this.parser}}class vW extends R{constructor(t){super(t,Hk)}getParser(){return this.parser}}class Sv extends R{constructor(t){super(t,Vk)}getParser(){return this.parser}}class AW extends R{constructor(t){super(t,kk)}getParser(){return this.parser}}class SW extends R{constructor(t){super(t,jk)}getParser(){return this.parser}}class yW extends R{constructor(t){super(t,zk)}getParser(){return this.parser}}class MW extends R{constructor(t){super(t,Yk)}getParser(){return this.parser}}class CW extends R{constructor(t){super(t,Wk)}getParser(){return this.parser}}class NW extends R{constructor(t){super(t,Xk)}getParser(){return this.parser}}class bW extends R{constructor(t){super(t,Kk)}getParser(){return this.parser}}class PW extends R{constructor(t){super(t,qk)}getParser(){return this.parser}}class DW extends R{constructor(t){super(t,Qk)}getParser(){return this.parser}}class LW extends R{constructor(t){super(t,jn)}getParser(){return this.parser}}class UW extends R{constructor(t){super(t,Zk)}getParser(){return this.parser}}class xW extends R{constructor(t){super(t,jh)}getParser(){return this.parser}}class FW extends R{constructor(t){super(t,$k)}getParser(){return this.parser}}class wW extends R{constructor(t){super(t,tj)}getParser(){return this.parser}}class yv extends R{constructor(t){super(t,ej)}getParser(){return this.parser}}class Mv extends R{constructor(t){super(t,Za)}getParser(){return this.parser}}class GW extends R{constructor(t){super(t,sj)}getParser(){return this.parser}}class BW extends R{constructor(t){super(t,rj)}getParser(){return this.parser}}class HW extends R{constructor(t){super(t,ij)}getParser(){return this.parser}}class VW extends R{constructor(t){super(t,nj)}getParser(){return this.parser}}class Cv extends R{constructor(t){super(t,aj)}getParser(){return this.parser}}class kW extends R{constructor(t){super(t,zh)}getParser(){return this.parser}}class jW extends R{constructor(t){super(t,v_)}getParser(){return this.parser}}class zW extends R{constructor(t){super(t,oj)}getParser(){return this.parser}}class YW extends R{constructor(t){super(t,hj)}getParser(){return this.parser}}class WW extends R{constructor(t){super(t,uj)}getParser(){return this.parser}}class XW extends R{constructor(t){super(t,lj)}getParser(){return this.parser}}class E{}E.ACHIEVEMENT_LIST=305;E.AUTHENTICATED=2491;E.AUTHENTICATION=-1;E.AVAILABILITY_STATUS=2033;E.BUILDERS_CLUB_EXPIRED=1452;E.CLUB_OFFERS=2405;E.CATALOG_PAGE=804;E.CATALOG_PAGE_LIST=1032;E.CATALOG_PURCHASE_OK=869;E.CATALOG_PURCHASE_ERROR=1404;E.CATALOG_PURCHASE_NOT_ALLOWED=3770;E.PRODUCT_OFFER=3388;E.LIMITED_SOLD_OUT=377;E.CATALOG_PUBLISHED=1866;E.CFH_RESULT_MESSAGE=3635;E.CLIENT_LATENCY=10;E.CLIENT_PING=3928;E.DESKTOP_CAMPAIGN=1745;E.DESKTOP_NEWS=286;E.DESKTOP_VIEW=122;E.BUNDLE_DISCOUNT_RULESET=2347;E.FIRST_LOGIN_OF_DAY=793;E.FURNITURE_ALIASES=1723;E.FURNITURE_DATA=2547;E.FURNITURE_FLOOR=1778;E.FURNITURE_FLOOR_ADD=1534;E.FURNITURE_FLOOR_REMOVE=2703;E.FURNITURE_FLOOR_UPDATE=3776;E.FURNITURE_ITEMDATA=2202;E.FURNITURE_STATE=2376;E.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293;E.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366;E.GAME_CENTER_ACHIEVEMENTS=2265;E.GAME_CENTER_GAME_LIST=222;E.GAME_CENTER_STATUS=2893;E.GAME_CENTER_IN_ARENA_QUEUE=872;E.GAME_CENTER_STOP_COUNTER=3191;E.GAME_CENTER_USER_LEFT_GAME=3138;E.GAME_CENTER_DIRECTORY_STATUS=2246;E.GAME_CENTER_STARTING_GAME_FAILED=2142;E.GAME_CENTER_JOINING_FAILED=1730;E.GAMESTATUSMESSAGE=3805;E.GAMEACHIEVEMENTS=1689;E.GAMEINVITE=904;E.JOININGQUEUEFAILED=3035;E.JOINEDQUEUEMESSAGE=2260;E.LEFTQUEUE=1477;E.LOAD_GAME_URL=2624;E.LOADGAME=3654;E.UNLOADGAME=1715;E.ACHIEVEMENTRESOLUTIONCOMPLETED=740;E.ACHIEVEMENTRESOLUTIONPROGRESS=3370;E.ACHIEVEMENTRESOLUTIONS=66;E.GENERIC_ALERT=3801;E.ALERT_TOP=3802;E.MODERATOR_MESSAGE=2030;E.GENERIC_ERROR=1600;E.GIFT_WRAPPER_CONFIG=2234;E.GROUP_BADGES=2402;E.GROUP_CREATE_OPTIONS=2159;E.GROUP_FORUM_DATA=3011;E.GROUP_FORUM_LIST=3001;E.GROUP_FORUM_THREADS=1073;E.GROUP_FORUM_POST=2049;E.GROUP_FORUM_POST_THREAD=1862;E.GROUP_FORUM_THREAD_MESSAGES=509;E.GROUP_FORUM_UNREAD_COUNT=2379;E.GROUP_FORUM_UPDATE_MESSAGE=324;E.GROUP_FORUM_UPDATE_THREAD=2528;E.GROUP_INFO=1702;E.GROUP_LIST=420;E.GROUP_MEMBER=265;E.GROUP_MEMBERS=1200;E.GROUP_MEMBERS_REFRESH=2445;E.GROUP_MEMBER_REMOVE_CONFIRM=1876;E.GROUP_PURCHASED=2808;E.GROUP_SETTINGS=3965;E.GROUP_BADGE_PARTS=2238;E.GROUP_MEMBERSHIP_REQUESTED=1180;E.GROUP_DETAILS_CHANGED=1459;E.GROUP_HABBO_JOIN_FAILED=762;E.GUILD_EDIT_FAILED=3988;E.GUILD_MEMBER_MGMT_FAILED=818;E.ITEM_DIMMER_SETTINGS=2710;E.ITEM_STACK_HELPER=2816;E.ITEM_WALL=1369;E.ITEM_WALL_ADD=2187;E.ITEM_WALL_REMOVE=3208;E.ITEM_WALL_UPDATE=2009;E.MARKETPLACE_CONFIG=1823;E.MESSENGER_ACCEPT_FRIENDS=896;E.MESSENGER_CHAT=1587;E.MESSENGER_FIND_FRIENDS=1210;E.MESSENGER_FOLLOW_FAILED=3048;E.MESSENGER_FRIEND_NOTIFICATION=3082;E.MESSENGER_FRIENDS=3130;E.MESSENGER_INIT=1605;E.MESSENGER_INSTANCE_MESSAGE_ERROR=3359;E.MESSENGER_INVITE=3870;E.MESSENGER_INVITE_ERROR=462;E.MESSENGER_MESSAGE_ERROR=892;E.MESSENGER_MINIMAIL_COUNT=2803;E.MESSENGER_MINIMAIL_NEW=1911;E.MESSENGER_RELATIONSHIPS=2016;E.MESSENGER_REQUEST=2219;E.MESSENGER_REQUEST_ERROR=892;E.MESSENGER_REQUESTS=280;E.MESSENGER_SEARCH=973;E.MESSENGER_UPDATE=2800;E.MODERATION_REPORT_DISABLED=1651;E.MODERATION_TOOL=2696;E.MODERATION_USER_INFO=2866;E.MOTD_MESSAGES=2035;E.NAVIGATOR_CATEGORIES=1562;E.NAVIGATOR_COLLAPSED=1543;E.NAVIGATOR_EVENT_CATEGORIES=3244;E.NAVIGATOR_LIFTED=3104;E.NAVIGATOR_METADATA=3052;E.NAVIGATOR_OPEN_ROOM_CREATOR=2064;E.NAVIGATOR_SEARCH=2690;E.NAVIGATOR_SEARCHES=3984;E.NAVIGATOR_SETTINGS=518;E.THUMBNAIL_UPDATE_RESULT=1927;E.CAN_CREATE_ROOM=378;E.CATEGORIES_WITH_VISITOR_COUNT=1455;E.COMPETITION_ROOMS_DATA=3954;E.CONVERTED_ROOM_ID=1331;E.GUEST_ROOM_SEARCH_RESULT=52;E.NOTIFICATION_LIST=1992;E.NOTIFICATION_SIMPLE_ALERT=5100;E.NOTIFICATION_ELEMENT_POINTER=1787;E.PET_FIGURE_UPDATE=1924;E.PET_INFO=2901;E.PET_TRAINING_PANEL=1164;E.PET_LEVEL_UPDATE=2824;E.PET_SCRATCH_FAILED=1130;E.PET_OPEN_PACKAGE_REQUESTED=2380;E.PET_OPEN_PACKAGE_RESULT=546;E.PET_BREEDING=1746;E.PET_CONFIRM_BREEDING_RESULT=1625;E.PET_GO_TO_BREEDING_NEST_FAILURE=2621;E.PET_NEST_BREEDING_SUCCESS=2527;E.PET_CONFIRM_BREEDING_REQUEST=634;E.PET_BREEDING_RESULT=1553;E.RECYCLER_PRIZES=3164;E.RECYCLER_STATUS=3433;E.RECYCLER_FINISHED=468;E.ROOM_BAN_LIST=1869;E.ROOM_BAN_REMOVE=3429;E.ROOM_CREATED=1304;E.ROOM_DOORBELL=2309;E.ROOM_DOORBELL_ACCEPTED=3783;E.ROOM_DOORBELL_REJECTED=878;E.ROOM_ENTER=758;E.ROOM_ENTER_ERROR=899;E.ROOM_FORWARD=160;E.ROOM_HEIGHT_MAP=2753;E.ROOM_HEIGHT_MAP_UPDATE=558;E.ROOM_INFO=687;E.ROOM_INFO_OWNER=749;E.ROOM_MODEL=1301;E.ROOM_MODEL_BLOCKED_TILES=3990;E.ROOM_MODEL_DOOR=1664;E.ROOM_MODEL_NAME=2031;E.ROOM_MUTED=2533;E.ROOM_MUTE_USER=826;E.ROOM_PAINT=2454;E.ROOM_PROMOTION=2274;E.ROOM_QUEUE_STATUS=2208;E.ROOM_RIGHTS=780;E.ROOM_RIGHTS_CLEAR=2392;E.ROOM_RIGHTS_LIST=1284;E.ROOM_RIGHTS_LIST_ADD=2088;E.ROOM_RIGHTS_LIST_REMOVE=1327;E.ROOM_RIGHTS_OWNER=339;E.ROOM_ROLLING=3207;E.ROOM_SCORE=482;E.ROOM_SETTINGS=1498;E.ROOM_SETTINGS_CHAT=1191;E.ROOM_SETTINGS_SAVE=948;E.ROOM_SETTINGS_SAVE_ERROR=1555;E.ROOM_INFO_UPDATED=3297;E.ROOM_SPECTATOR=1033;E.ROOM_THICKNESS=3547;E.ROOM_GET_FILTER_WORDS=2937;E.ROOM_MESSAGE_NOTIFICATION=1634;E.ROOM_POPULAR_TAGS_RESULT=2012;E.INFO_FEED_ENABLE=3284;E.SECURITY_MACHINE=1488;E.MYSTERY_BOX_KEYS=2833;E.GOTMYSTERYBOXPRIZEMESSAGE=3712;E.CANCELMYSTERYBOXWAITMESSAGE=596;E.SHOWMYSTERYBOXWAITMESSAGE=3201;E.TRADE_ACCEPTED=2568;E.TRADE_CLOSED=1373;E.TRADE_COMPLETED=1001;E.TRADE_CONFIRMATION=2720;E.TRADE_LIST_ITEM=2024;E.TRADE_NOT_OPEN=3128;E.TRADE_OPEN=2505;E.TRADE_OPEN_FAILED=217;E.TRADE_OTHER_NOT_ALLOWED=1254;E.TRADE_YOU_NOT_ALLOWED=3058;E.TRADE_NO_SUCH_ITEM=2873;E.UNIT=374;E.UNIT_CHANGE_NAME=2182;E.UNIT_CHAT=1446;E.UNIT_CHAT_SHOUT=1036;E.UNIT_CHAT_WHISPER=2704;E.UNIT_DANCE=2233;E.UNIT_EFFECT=1167;E.UNIT_EXPRESSION=1631;E.UNIT_HAND_ITEM=1474;E.UNIT_IDLE=1797;E.UNIT_INFO=3920;E.UNIT_NUMBER=2324;E.UNIT_REMOVE=2661;E.UNIT_STATUS=1640;E.UNIT_TYPING=1717;E.UNSEEN_ITEMS=2103;E.USER_ACHIEVEMENT_SCORE=1968;E.USER_BADGES=717;E.USER_BADGES_ADD=2493;E.USER_BADGES_CURRENT=1087;E.USER_BOT_REMOVE=233;E.USER_BOTS=3086;E.USER_CHANGE_NAME=118;E.USER_CLOTHING=1450;E.USER_CREDITS=3475;E.USER_CURRENCY=2018;E.ACTIVITY_POINT_NOTIFICATION=2275;E.USER_EFFECTS=340;E.USER_FAVORITE_ROOM=2524;E.USER_FAVORITE_ROOM_COUNT=151;E.USER_FIGURE=2429;E.USER_FURNITURE=994;E.USER_FURNITURE_ADD=104;E.USER_FURNITURE_POSTIT_PLACED=1501;E.USER_FURNITURE_REFRESH=3151;E.USER_FURNITURE_REMOVE=159;E.USER_HOME_ROOM=2875;E.ROOM_EVENT_CANCEL=3479;E.ROOM_EVENT=1840;E.USER_IGNORED=126;E.USER_IGNORED_RESULT=207;E.USER_INFO=2725;E.USER_OUTFITS=3315;E.USER_PERKS=2586;E.USER_PERMISSIONS=411;E.USER_PET_ADD=2101;E.USER_PET_REMOVE=3253;E.USER_PETS=3522;E.USER_PROFILE=3898;E.USER_RESPECT=2815;E.USER_SANCTION_STATUS=3679;E.USER_SETTINGS=513;E.USER_SUBSCRIPTION=954;E.USER_WARDROBE_PAGE=3315;E.USER_CLASSIFICATION=966;E.GET_USER_TAGS=1255;E.WIRED_ACTION=1434;E.WIRED_CONDITION=1108;E.WIRED_ERROR=156;E.WIRED_OPEN=1830;E.WIRED_REWARD=178;E.WIRED_SAVE=1155;E.WIRED_TRIGGER=383;E.PLAYING_GAME=448;E.FURNITURE_STATE_2=3431;E.REMOVE_BOT_FROM_INVENTORY=233;E.ADD_BOT_TO_INVENTORY=1352;E.ACHIEVEMENT_PROGRESSED=2107;E.MODTOOL_ROOM_INFO=1333;E.MODTOOL_USER_CHATLOG=3377;E.MODTOOL_ROOM_CHATLOG=3434;E.MODTOOL_VISITED_ROOMS_USER=1752;E.MODERATOR_ACTION_RESULT=2335;E.ISSUE_DELETED=3192;E.ISSUE_INFO=3609;E.ISSUE_PICK_FAILED=3150;E.CFH_CHATLOG=607;E.MODERATOR_TOOL_PREFERENCES=1576;E.LOVELOCK_FURNI_START=3753;E.LOVELOCK_FURNI_FRIEND_COMFIRMED=382;E.LOVELOCK_FURNI_FINISHED=770;E.GIFT_RECEIVER_NOT_FOUND=1517;E.GIFT_OPENED=56;E.FLOOD_CONTROL=566;E.REMAINING_MUTE=826;E.USER_EFFECT_LIST=340;E.USER_EFFECT_LIST_ADD=2867;E.USER_EFFECT_LIST_REMOVE=2228;E.USER_EFFECT_ACTIVATE=1959;E.AVATAR_EFFECT_SELECTED=3473;E.CLUB_GIFT_INFO=619;E.REDEEM_VOUCHER_ERROR=714;E.REDEEM_VOUCHER_OK=3336;E.IN_CLIENT_LINK=2023;E.BOT_COMMAND_CONFIGURATION=1618;E.BOT_SKILL_LIST_UPDATE=69;E.BOT_FORCE_OPEN_CONTEXT_MENU=296;E.HAND_ITEM_RECEIVED=354;E.PET_PLACING_ERROR=2913;E.BOT_ERROR=639;E.MARKETPLACE_SELL_ITEM=54;E.MARKETPLACE_ITEM_STATS=725;E.MARKETPLACE_OWN_ITEMS=3884;E.MARKETPLACE_CANCEL_SALE=3264;E.MARKETPLACE_ITEM_POSTED=1359;E.MARKETPLACE_ITEMS_SEARCHED=680;E.MARKETPLACE_AFTER_ORDER_STATUS=2032;E.CATALOG_RECEIVE_PET_BREEDS=3331;E.CATALOG_APPROVE_NAME_RESULT=1503;E.OBJECTS_DATA_UPDATE=1453;E.PET_EXPERIENCE=2156;E.COMMUNITY_GOAL_VOTE_EVENT=1435;E.PROMO_ARTICLES=286;E.COMMUNITY_GOAL_EARNED_PRIZES=3319;E.COMMUNITY_GOAL_PROGRESS=2525;E.CONCURRENT_USERS_GOAL_PROGRESS=2737;E.QUEST_DAILY=1878;E.QUEST_CANCELLED=3027;E.QUEST_COMPLETED=949;E.COMMUNITY_GOAL_HALL_OF_FAME=3005;E.EPIC_POPUP=3945;E.SEASONAL_QUESTS=1122;E.QUESTS=3625;E.QUEST=230;E.BONUS_RARE_INFO=1533;E.CRAFTABLE_PRODUCTS=1e3;E.CRAFTING_RECIPE=2774;E.CRAFTING_RECIPES_AVAILABLE=2124;E.CRAFTING_RESULT=618;E.CAMERA_PUBLISH_STATUS=2057;E.CAMERA_PURCHASE_OK=2783;E.CAMERA_STORAGE_URL=3696;E.COMPETITION_STATUS=133;E.INIT_CAMERA=3878;E.THUMBNAIL_STATUS=3595;E.ACHIEVEMENT_NOTIFICATION=806;E.CLUB_GIFT_NOTIFICATION=2188;E.INTERSTITIAL_MESSAGE=1808;E.ROOM_AD_ERROR=1759;E.AVAILABILITY_TIME=600;E.HOTEL_CLOSED_AND_OPENS=3728;E.HOTEL_CLOSES_AND_OPENS_AT=2771;E.HOTEL_WILL_CLOSE_MINUTES=1050;E.HOTEL_MAINTENANCE=1350;E.JUKEBOX_PLAYLIST_FULL=105;E.JUKEBOX_SONG_DISKS=34;E.NOW_PLAYING=469;E.OFFICIAL_SONG_ID=1381;E.PLAYLIST=1748;E.PLAYLIST_SONG_ADDED=1140;E.TRAX_SONG_INFO=3365;E.USER_SONG_DISKS_INVENTORY=2602;E.CHECK_USER_NAME=563;E.CFH_SANCTION=2782;E.CFH_TOPICS=325;E.CFH_SANCTION_STATUS=2221;E.CAMPAIGN_CALENDAR_DATA=2531;E.CAMPAIGN_CALENDAR_DOOR_OPENED=2551;E.BUILDERS_CLUB_FURNI_COUNT=3828;E.BUILDERS_CLUB_SUBSCRIPTION=1452;E.CATALOG_PAGE_EXPIRATION=2668;E.CATALOG_EARLIEST_EXPIRY=2515;E.CLUB_GIFT_SELECTED=659;E.TARGET_OFFER_NOT_FOUND=1237;E.TARGET_OFFER=119;E.DIRECT_SMS_CLUB_BUY=195;E.ROOM_AD_PURCHASE=2468;E.NOT_ENOUGH_BALANCE=3914;E.LIMITED_OFFER_APPEARING_NEXT=44;E.IS_OFFER_GIFTABLE=761;E.CLUB_EXTENDED_OFFER=3964;E.SEASONAL_CALENDAR_OFFER=1889;E.COMPETITION_ENTRY_SUBMIT=1177;E.COMPETITION_VOTING_INFO=3506;E.COMPETITION_TIMING_CODE=1745;E.COMPETITION_USER_PART_OF=3841;E.COMPETITION_NO_OWNED_ROOMS=2064;E.COMPETITION_SECONDS_UNTIL=3926;E.BADGE_POINT_LIMITS=2501;E.BADGE_REQUEST_FULFILLED=2998;E.HELPER_TALENT_TRACK=3406;E.TALENT_TRACK_LEVEL=1203;E.TALENT_TRACK_LEVEL_UP=638;E.USER_BANNED=1683;E.BOT_RECEIVED=3684;E.PET_LEVEL_NOTIFICATION=859;E.PET_RECEIVED=1111;E.MODERATION_CAUTION=1890;E.YOUTUBE_CONTROL_VIDEO=1554;E.YOUTUBE_DISPLAY_PLAYLISTS=1112;E.YOUTUBE_DISPLAY_VIDEO=1411;E.CFH_DISABLED_NOTIFY=1651;E.QUESTION=2665;E.POLL_CONTENTS=2997;E.POLL_ERROR=662;E.POLL_OFFER=3785;E.QUESTION_ANSWERED=2589;E.QUESTION_FINISHED=1066;E.CFH_PENDING_CALLS=1121;E.GUIDE_ON_DUTY_STATUS=1548;E.GUIDE_SESSION_ATTACHED=1591;E.GUIDE_SESSION_DETACHED=138;E.GUIDE_SESSION_ENDED=1456;E.GUIDE_SESSION_ERROR=673;E.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219;E.GUIDE_SESSION_MESSAGE=841;E.GUIDE_SESSION_PARTNER_IS_TYPING=1016;E.GUIDE_SESSION_REQUESTER_ROOM=1847;E.GUIDE_SESSION_STARTED=3209;E.GUIDE_TICKET_CREATION_RESULT=3285;E.GUIDE_TICKET_RESOLUTION=2674;E.GUIDE_REPORTING_STATUS=3463;E.HOTEL_MERGE_NAME_CHANGE=1663;E.ISSUE_CLOSE_NOTIFICATION=934;E.QUIZ_DATA=2927;E.QUIZ_RESULTS=2772;E.CFH_PENDING_CALLS_DELETED=77;E.CFH_REPLY=3796;E.CHAT_REVIEW_SESSION_DETACHED=30;E.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735;E.CHAT_REVIEW_SESSION_RESULTS=3276;E.CHAT_REVIEW_SESSION_STARTED=143;E.CHAT_REVIEW_SESSION_VOTING_STATUS=1829;E.SCR_SEND_KICKBACK_INFO=3277;E.PET_STATUS=1907;E.GROUP_DEACTIVATE=3129;E.PET_RESPECTED=2788;E.PET_SUPPLEMENT=3441;E.NOOBNESS_LEVEL=3738;E.DISCONNECT_REASON=4e3;E.CAN_CREATE_ROOM_EVENT=2599;E.FAVORITE_GROUP_UDPATE=3403;E.NO_SUCH_FLAT=84;E.ROOM_SETTINGS_ERROR=2897;E.SHOW_ENFORCE_ROOM_CATEGORY=3896;E.CUSTOM_USER_NOTIFICATION=909;E.NEW_USER_EXPERIENCE_GIFT_OFFER=3575;E.NEW_USER_EXPERIENCE_NOT_COMPLETE=3639;E.CONNECTION_ERROR=1004;E.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE=1243;E.PHONE_COLLECTION_STATE=2890;E.PHONE_TRY_NUMBER_RESULT=800;E.PHONE_TRY_VERIFICATION_CODE_RESULT=91;E.EXTENDED_PROFILE_CHANGED=876;E.WELCOME_GIFT_CHANGE_EMAIL_RESULT=2293;E.WELCOME_GIFT_STATUS=2707;E.HANDSHAKE_INIT_DIFFIE=1347;E.HANDSHAKE_COMPLETE_DIFFIE=3885;E.RENTABLE_SPACE_RENT_OK=2046;E.RENTABLE_SPACE_STATUS=3559;E.RENTABLE_SPACE_RENT_FAILED=1868;E.EMAIL_STATUS=612;E.CHANGE_EMAIL_RESULT=1815;E.WEEKLY_GAME_REWARD=2641;E.WEEKLY_GAME_REWARD_WINNERS=3097;E.WEEKLY_COMPETITIVE_LEADERBOARD=3512;E.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD=3560;E.WEEKLY_GAME2_FRIENDS_LEADERBOARD=2270;E.WEEKLY_GAME2_LEADERBOARD=2196;E.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER=35;E.HANDSHAKE_IDENTITY_ACCOUNT=3523;class KW extends R{constructor(t){super(t,bB)}getParser(){return this.parser}}class qW extends R{constructor(t){super(t,DB)}getParser(){return this.parser}}class QW extends R{constructor(t){super(t,LB)}getParser(){return this.parser}}class ZW extends R{constructor(t){super(t,xB)}getParser(){return this.parser}}class JW extends R{constructor(t){super(t,FB)}getParser(){return this.parser}}class $W extends R{constructor(t){super(t,wB)}getParser(){return this.parser}}class t4 extends R{constructor(t){super(t,GB)}getParser(){return this.parser}}class e4 extends R{constructor(t){super(t,BB)}getParser(){return this.parser}}class Nv extends R{constructor(t){super(t,VB)}getParser(){return this.parser}}class s4 extends R{constructor(t){super(t,kB)}getParser(){return this.parser}}class r4 extends R{constructor(t){super(t,jB)}getParser(){return this.parser}}class i4 extends R{constructor(t){super(t,zB)}getParser(){return this.parser}}class n4 extends R{constructor(t){super(t,YB)}getParser(){return this.parser}}class a4 extends R{constructor(t){super(t,bH)}getParser(){return this.parser}}class o4 extends R{constructor(t){super(t,DH)}getParser(){return this.parser}}class h4 extends R{constructor(t){super(t,PH)}getParser(){return this.parser}}class u4 extends R{constructor(t){super(t,LH)}getParser(){return this.parser}}class l4 extends R{constructor(t){super(t,UH)}getParser(){return this.parser}}class bv extends R{constructor(t){super(t,xH)}getParser(){return this.parser}}class _4 extends R{constructor(t){super(t,FH)}getParser(){return this.parser}}class c4 extends R{constructor(t){super(t,wH)}getParser(){return this.parser}}class d4 extends R{constructor(t){super(t,GH)}getParser(){return this.parser}}class f4 extends R{constructor(t){super(t,BH)}getParser(){return this.parser}}class g4 extends R{constructor(t){super(t,HH)}getParser(){return this.parser}}class E4 extends R{constructor(t){super(t,VH)}getParser(){return this.parser}}class p4 extends R{constructor(t){super(t,kH)}getParser(){return this.parser}}class m4 extends R{constructor(t){super(t,zH)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class I4 extends R{constructor(t){super(t,hv)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class T4 extends R{constructor(t){super(t,YH)}getParser(){return this.parser}}class R4 extends R{constructor(t){super(t,WH)}getParser(){return this.parser}}class O4 extends R{constructor(t){super(t,XH)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class v4 extends R{constructor(t){super(t,KH)}getParser(){return this.parser}}class A4 extends R{constructor(t){super(t,qH)}getParser(){return this.parser}}class S4 extends R{constructor(t){super(t,QH)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class y4 extends R{constructor(t){super(t,iE)}getParser(){return this.parser}}class M4 extends R{constructor(t){super(t,ZH)}getParser(){return this.parser}}class C4 extends R{constructor(t){super(t,JH)}getParser(){return this.parser}}class N4 extends R{constructor(t){super(t,_j)}getParser(){return this.parser}}class b4 extends R{constructor(t){super(t,cj)}getParser(){return this.parser}}class P4 extends R{constructor(t){super(t,dj)}getParser(){return this.parser}}class D4 extends R{constructor(t){super(t,fj)}getParser(){return this.parser}}class L4 extends R{constructor(t){super(t,gj)}getParser(){return this.parser}}class U4 extends R{constructor(t){super(t,Ej)}getParser(){return this.parser}}class x4 extends R{constructor(t){super(t,mj)}getParser(){return this.parser}}class F4 extends R{constructor(t){super(t,pj)}getParser(){return this.parser}}class w4 extends R{constructor(t){super(t,Ij)}getParser(){return this.parser}}class G4 extends R{constructor(t){super(t,Tj)}getParser(){return this.parser}}class B4 extends R{constructor(t){super(t,vj)}getParser(){return this.parser}}class H4 extends R{constructor(t){super(t,Aj)}getParser(){return this.parser}}class V4 extends R{constructor(t){super(t,Ev)}getParser(){return this.parser}}class k4 extends R{constructor(t){super(t,yj)}getParser(){return this.parser}}class j4 extends R{constructor(t){super(t,Cj)}getParser(){return this.parser}}class z4 extends R{constructor(t){super(t,Mj)}getParser(){return this.parser}}class Y4 extends R{constructor(t){super(t,bj)}getParser(){return this.parser}}class W4 extends R{constructor(t){super(t,Pj)}getParser(){return this.parser}}class X4 extends R{constructor(t){super(t,Uj)}getParser(){return this.parser}}class K4 extends R{constructor(t){super(t,xj)}getParser(){return this.parser}}class q4 extends R{constructor(t){super(t,wj)}getParser(){return this.parser}}class Q4 extends R{constructor(t){super(t,Gj)}getParser(){return this.parser}}class Z4 extends R{constructor(t){super(t,Vj)}getParser(){return this.parser}}class J4 extends R{constructor(t){super(t,kj)}getParser(){return this.parser}}class $4 extends R{constructor(t){super(t,zj)}getParser(){return this.parser}}class tX extends R{constructor(t){super(t,Yj)}getParser(){return this.parser}}class eX extends R{constructor(t){super(t,Wj)}getParser(){return this.parser}}class Pv extends R{constructor(t){super(t,Xj)}getParser(){return this.parser}}class sX extends R{constructor(t){super(t,Kj)}getParser(){return this.parser}}class rX extends R{constructor(t){super(t,hE)}getParser(){return this.parser}}class iX extends R{constructor(t){super(t,qj)}getParser(){return this.parser}}class nX extends R{constructor(t){super(t,i3)}getParser(){return this.parser}}class aX extends R{constructor(t){super(t,n3)}getParser(){return this.parser}}class oX extends R{constructor(t){super(t,a3)}getParser(){return this.parser}}class Dv extends R{constructor(t){super(t,o3)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class hX extends R{constructor(t){super(t,h3)}getParser(){return this.parser}}class uX extends R{constructor(t){super(t,u3)}getParser(){return this.parser}}class gf extends R{constructor(t){super(t,l3)}getParser(){return this.parser}}class lX extends R{constructor(t){super(t,_3)}getParser(){return this.parser}}class Ef extends R{constructor(t){super(t,c3)}getParser(){return this.parser}}class _X extends R{constructor(t){super(t,d3)}getParser(){return this.parser}}class cX extends R{constructor(t){super(t,g3)}getParser(){return this.parser}}class dX extends R{constructor(t){super(t,p3)}getParser(){return this.parser}}class fX extends R{constructor(t){super(t,I3)}getParser(){return this.parser}}class gX extends R{constructor(t){super(t,T3)}getParser(){return this.parser}}class EX extends R{constructor(t){super(t,R3)}getParser(){return this.parser}}class pX extends R{constructor(t){super(t,O3)}getParser(){return this.parser}}class mX extends R{constructor(t){super(t,v3)}getParser(){return this.parser}}class IX extends R{constructor(t){super(t,A3)}getParser(){return this.parser}}class TX extends R{constructor(t){super(t,M3)}getParser(){return this.parser}}class RX extends R{constructor(t){super(t,C3)}getParser(){return this.parser}}class OX extends R{constructor(t){super(t,N3)}getParser(){return this.parser}}class vX extends R{constructor(t){super(t,b3)}getParser(){return this.parser}}class AX extends R{constructor(t){super(t,P3)}getParser(){return this.parser}}class SX extends R{constructor(t){super(t,D3)}getParser(){return this.parser}}class yX extends R{constructor(t){super(t,L3)}getParser(){return this.parser}}class MX extends R{constructor(t){super(t,U3)}getParser(){return this.parser}}class CX extends R{constructor(t){super(t,F3)}getParser(){return this.parser}}class NX extends R{constructor(t){super(t,w3)}getParser(){return this.parser}}class bX extends R{constructor(t){super(t,G3)}getParser(){return this.parser}}class Lv extends R{constructor(t){super(t,B3)}getParser(){return this.parser}}class PX extends R{constructor(t){super(t,H3)}getParser(){return this.parser}}class DX extends R{constructor(t){super(t,V3)}getParser(){return this.parser}}class LX extends R{constructor(t){super(t,k3)}getParser(){return this.parser}}class UX extends R{constructor(t){super(t,j3)}getParser(){return this.parser}}class xX extends R{constructor(t){super(t,z3)}getParser(){return this.parser}}class FX extends R{constructor(t){super(t,Y3)}getParser(){return this.parser}}class wX extends R{constructor(t){super(t,W3)}getParser(){return this.parser}}class GX extends R{constructor(t){super(t,X3)}getParser(){return this.parser}}class Uv extends R{constructor(t){super(t,K3)}getParser(){return this.parser}}class BX extends R{constructor(t){super(t,q3)}getParser(){return this.parser}}class HX extends R{constructor(t){super(t,Q3)}getParser(){return this.parser}}class VX{constructor(t){this._itemName=t.readString(),this._extraInfo=t.readString(),this._extraInfo==""&&(this._extraInfo=null)}get itemName(){return this._itemName}get extraInfo(){return this._extraInfo}}class kX{constructor(t){this._thumbnailUrl=t.readString(),this._thumbnailUrl==""&&(this._thumbnailUrl=null),this._productOfferList=[];const e=t.readInt();let s=0;for(;s<e;)this._productOfferList.push(new VX(t)),s++}get productOfferList(){return this._productOfferList}get thumbnailUrl(){return this._thumbnailUrl}}class jX{flush(){return!0}parse(t){if(!t)return!1;const e=t.readInt();this._giftOptions=[];let s=0;for(;s<e;)this._giftOptions.push(new WX(t)),s++;return!0}get giftOptions(){return this._giftOptions}}class zX{flush(){return!0}parse(t){return!!t}}class YX extends R{constructor(t){super(t,jX)}getParser(){return this.parser}}class WX{constructor(t){this._dayIndex=t.readInt(),this._stepIndex=t.readInt(),this._options=[];const e=t.readInt();let s=0;for(;s<e;)this._options.push(new kX(t)),s++}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get options(){return this._options}}class XX extends R{constructor(t){super(t,zX)}getParser(){return this.parser}}class KX extends R{constructor(t){super(t,J3)}getParser(){return this.parser}}class qX extends R{constructor(t){super(t,T_)}getParser(){return this.parser}}class xv extends R{constructor(t){super(t,$3)}getParser(){return this.parser}}class Fv extends R{constructor(t){super(t,tz)}getParser(){return this.parser}}class wv extends R{constructor(t){super(t,ez)}getParser(){return this.parser}}class Gv extends R{constructor(t){super(t,sz)}getParser(){return this.parser}}class QX extends R{constructor(t){super(t,rz)}getParser(){return this.parser}}class Bv extends R{constructor(t){super(t,az)}getParser(){return this.parser}}class Hv extends R{constructor(t){super(t,oz)}getParser(){return this.parser}}class Vv extends R{constructor(t){super(t,hz)}getParser(){return this.parser}}class kv extends R{constructor(t){super(t,uz)}getParser(){return this.parser}}class jv extends R{constructor(t){super(t,_z)}getParser(){return this.parser}}class zv extends R{constructor(t){super(t,lz)}getParser(){return this.parser}}class ZX extends R{constructor(t){super(t,fz)}getParser(){return this.parser}}class JX extends R{constructor(t){super(t,pz)}getParser(){return this.parser}}class $X extends R{constructor(t){super(t,mz)}getParser(){return this.parser}}class t6 extends R{constructor(t){super(t,Iz)}getParser(){return this.parser}}class e6 extends R{constructor(t){super(t,Tz)}getParser(){return this.parser}}class s6 extends R{constructor(t){super(t,Rz)}getParser(){return this.parser}}class r6 extends R{constructor(t){super(t,Oz)}getParser(){return this.parser}}class i6 extends R{constructor(t){super(t,vz)}getParser(){return this.parser}}class n6 extends R{constructor(t){super(t,Az)}getParser(){return this.parser}}class a6 extends R{constructor(t){super(t,Sz)}getParser(){return this.parser}}class o6 extends R{constructor(t){super(t,yz)}getParser(){return this.parser}}class lE extends R{constructor(t){super(t,Mz)}getParser(){return this.parser}}lE.FINISHED_OK=1;lE.FINISHED_FAIL=2;class C_ extends R{constructor(t){super(t,Cz)}getParser(){return this.parser}}C_.SYSTEM_STATUS_ENABLED=1;C_.SYSTEM_STATUS_DISABLED=2;C_.SYSTEM_STATUS_TIMEOUT=3;class pf extends R{constructor(t){super(t,WB)}getParser(){return this.parser}}class mf extends R{constructor(t){super(t,XB)}getParser(){return this.parser}}class If extends R{constructor(t){super(t,qB)}getParser(){return this.parser}}class Tf extends R{constructor(t){super(t,KB)}getParser(){return this.parser}}class h6 extends R{constructor(t){super(t,wh)}getParser(){return this.parser}}class Rf extends R{constructor(t){super(t,QB)}getParser(){return this.parser}}class u6 extends R{constructor(t){super(t,ZB)}getParser(){return this.parser}}class l6 extends R{constructor(t){super(t,JB)}getParser(){return this.parser}}class _6 extends R{constructor(t){super(t,$B)}getParser(){return this.parser}}class c6 extends R{constructor(t){super(t,e2)}getParser(){return this.parser}}class d6 extends R{constructor(t){super(t,E2)}getParser(){return this.parser}}class f6 extends R{constructor(t){super(t,p2)}getParser(){return this.parser}}class g6 extends R{constructor(t){super(t,m2)}getParser(){return this.parser}}class Yv extends R{constructor(t){super(t,I2)}getParser(){return this.parser}}class Of extends R{constructor(t){super(t,J2)}getParser(){return this.parser}}class vf extends R{constructor(t){super(t,$2)}getParser(){return this.parser}}class E6 extends R{constructor(t){super(t,R2)}getParser(){return this.parser}}class Af extends R{constructor(t){super(t,O2)}getParser(){return this.parser}}class Sf extends R{constructor(t){super(t,v2)}getParser(){return this.parser}}class yf extends R{constructor(t){super(t,A2)}getParser(){return this.parser}}class Mf extends R{constructor(t){super(t,S2)}getParser(){return this.parser}}class Cf extends R{constructor(t){super(t,y2)}getParser(){return this.parser}}class p6 extends R{constructor(t){super(t,M2)}getParser(){return this.parser}}class Nf extends R{constructor(t){super(t,C2)}getParser(){return this.parser}}class bf extends R{constructor(t){super(t,Yi)}getParser(){return this.parser}}class m6 extends R{constructor(t){super(t,N2)}getParser(){return this.parser}}class I6 extends R{constructor(t){super(t,b2)}getParser(){return this.parser}}class Pf extends R{constructor(t){super(t,P2)}getParser(){return this.parser}}class T6 extends R{constructor(t){super(t,D2)}getParser(){return this.parser}}class R6 extends R{constructor(t){super(t,L2)}getParser(){return this.parser}}class O6 extends R{constructor(t){super(t,U2)}getParser(){return this.parser}}class Df extends R{constructor(t){super(t,x2)}getParser(){return this.parser}}class v6 extends R{constructor(t){super(t,F2)}getParser(){return this.parser}}class A6 extends R{constructor(t){super(t,w2)}getParser(){return this.parser}}class S6 extends R{constructor(t){super(t,G2)}getParser(){return this.parser}}class y6 extends R{constructor(t){super(t,B2)}getParser(){return this.parser}}class Wv extends R{constructor(t){super(t,V2)}getParser(){return this.parser}}class M6 extends R{constructor(t){super(t,k2)}getParser(){return this.parser}}class Lf extends R{constructor(t){super(t,j2)}getParser(){return this.parser}}class Uf extends R{constructor(t){super(t,z2)}getParser(){return this.parser}}class xf extends R{constructor(t){super(t,Y2)}getParser(){return this.parser}}class Ff extends R{constructor(t){super(t,W2)}getParser(){return this.parser}}class C6 extends R{constructor(t){super(t,X2)}getParser(){return this.parser}}class N6 extends R{constructor(t){super(t,K2)}getParser(){return this.parser}}class b6 extends R{constructor(t){super(t,Q2)}getParser(){return this.parser}}class P6 extends R{constructor(t){super(t,Z2)}getParser(){return this.parser}}class wf extends R{constructor(t){super(t,av)}getParser(){return this.parser}}class Gf extends R{constructor(t){super(t,tH)}getParser(){return this.parser}}class Bf extends R{constructor(t){super(t,wi)}getParser(){return this.parser}}class Hf extends R{constructor(t){super(t,eH)}getParser(){return this.parser}}class D6 extends R{constructor(t){super(t,sH)}getParser(){return this.parser}}class Vf extends R{constructor(t){super(t,rH)}getParser(){return this.parser}}class Va extends R{constructor(t){super(t,iH)}getParser(){return this.parser}}class kf extends R{constructor(t){super(t,nH)}getParser(){return this.parser}}class Xv extends R{constructor(t){super(t,aH)}getParser(){return this.parser}}class Kv extends R{constructor(t){super(t,oH)}getParser(){return this.parser}}class bl extends R{constructor(t){super(t,hH)}getParser(){return this.parser}}class qv extends R{constructor(t){super(t,uH)}getParser(){return this.parser}}class Qv extends R{constructor(t){super(t,lH)}getParser(){return this.parser}}class Zv extends R{constructor(t){super(t,cH)}getParser(){return this.parser}}class Jv extends R{constructor(t){super(t,dH)}getParser(){return this.parser}}class $v extends R{constructor(t){super(t,fH)}getParser(){return this.parser}}class tA extends R{constructor(t){super(t,gH)}getParser(){return this.parser}}class _E extends R{constructor(t){super(t,eE)}getParser(){return this.parser}}class Pl extends R{constructor(t){super(t,eE)}getParser(){return this.parser}}class Dl extends R{constructor(t){super(t,eE)}getParser(){return this.parser}}class jf extends R{constructor(t){super(t,EH)}getParser(){return this.parser}}class Ll extends R{constructor(t){super(t,pH)}getParser(){return this.parser}}class zf extends R{constructor(t){super(t,mH)}getParser(){return this.parser}}class Ul extends R{constructor(t){super(t,SH)}getParser(){return this.parser}}class Yf extends R{constructor(t){super(t,IH)}getParser(){return this.parser}}class Wf extends R{constructor(t){super(t,TH)}getParser(){return this.parser}}class eA extends R{constructor(t){super(t,RH)}getParser(){return this.parser}}class Xf extends R{constructor(t){super(t,OH)}getParser(){return this.parser}}class xl extends R{constructor(t){super(t,vH)}getParser(){return this.parser}}class Kf extends R{constructor(t){super(t,AH)}getParser(){return this.parser}}class Fl extends R{constructor(t){super(t,yH)}getParser(){return this.parser}}class qf extends R{constructor(t){super(t,NH)}getParser(){return this.parser}}class L6 extends R{constructor(t){super(t,Dz)}getParser(){return this.parser}}class U6 extends R{constructor(t){super(t,Lz)}getParser(){return this.parser}}class x6 extends R{constructor(t){super(t,Uz)}getParser(){return this.parser}}class F6 extends R{constructor(t){super(t,xz)}getParser(){return this.parser}}class cE extends R{constructor(t){super(t,Fz)}getParser(){return this.parser}}cE.PRODUCT_DONATED_CODE=6;cE.BADGE_DONATED_CODE=7;class w6 extends R{constructor(t){super(t,wz)}getParser(){return this.parser}}class G6 extends R{constructor(t){super(t,Gz)}getParser(){return this.parser}}class B6 extends R{constructor(t){super(t,r2)}getParser(){return this.parser}}class H6 extends R{constructor(t){super(t,n2)}getParser(){return this.parser}}class V6 extends R{constructor(t){super(t,a2)}getParser(){return this.parser}}class k6 extends R{constructor(t){super(t,o2)}getParser(){return this.parser}}class j6 extends R{constructor(t){super(t,h2)}getParser(){return this.parser}}class z6 extends R{constructor(t){super(t,u2)}getParser(){return this.parser}}class Y6 extends R{constructor(t){super(t,_2)}getParser(){return this.parser}}class W6 extends R{constructor(t){super(t,c2)}getParser(){return this.parser}}class X6 extends R{constructor(t){super(t,d2)}getParser(){return this.parser}}class K6 extends R{constructor(t){super(t,gs)}getParser(){return this.parser}}class q6 extends R{constructor(t){super(t,f2)}getParser(){return this.parser}}class Q6 extends R{constructor(t){super(t,g2)}getParser(){return this.parser}}class sA extends R{constructor(t){super(t,Bz)}getParser(){return this.parser}}class rA extends R{constructor(t){super(t,Hz)}getParser(){return this.parser}}class iA extends R{constructor(t){super(t,Vz)}getParser(){return this.parser}}class nA extends R{constructor(t){super(t,kz)}getParser(){return this.parser}}class Z6 extends R{constructor(t){super(t,jz)}getParser(){return this.parser}}class J6 extends R{constructor(t){super(t,zz)}getParser(){return this.parser}}class $6 extends R{constructor(t){super(t,Yz)}getParser(){return this.parser}}class aA extends R{constructor(t){super(t,Xz)}getParser(){return this.parser}}class oA extends R{constructor(t){super(t,Kz)}getParser(){return this.parser}}class t8 extends R{constructor(t){super(t,qz)}getParser(){return this.parser}}class e8 extends R{constructor(t){super(t,Zz)}getParser(){return this.parser}}class s8 extends R{constructor(t){super(t,$z)}getParser(){return this.parser}}class hA extends R{constructor(t){super(t,oB)}getParser(){return this.parser}}class uA extends R{constructor(t){super(t,p_)}getParser(){return this.parser}}class r8 extends R{constructor(t){super(t,hB)}getParser(){return this.parser}}class i8 extends R{constructor(t){super(t,$O)}getParser(){return this.parser}}class n8 extends R{constructor(t){super(t,lB)}getParser(){return this.parser}}class lA extends R{constructor(t){super(t,_B)}getParser(){return this.parser}}class wl extends R{constructor(t){super(t,dB)}getParser(){return this.parser}}class dE extends R{constructor(t){super(t,fB)}getParser(){return this.parser}}class a8 extends R{constructor(t){super(t,gB)}getParser(){return this.parser}}class o8 extends R{constructor(t){super(t,EB)}getParser(){return this.parser}}class _A extends R{constructor(t){super(t,pB)}getParser(){return this.parser}}class cA extends R{constructor(t){super(t,mB)}getParser(){return this.parser}}class h8 extends R{constructor(t){super(t,IB)}getParser(){return this.parser}}class u8 extends R{constructor(t){super(t,TB)}getParser(){return this.parser}}class l8 extends R{constructor(t){super(t,RB)}getParser(){return this.parser}}class _8 extends R{constructor(t){super(t,ev)}getParser(){return this.parser}}class c8 extends R{constructor(t){super(t,OB)}getParser(){return this.parser}}class d8 extends R{constructor(t){super(t,vB)}getParser(){return this.parser}}class dA extends R{constructor(t){super(t,AB)}getParser(){return this.parser}}class f8 extends R{constructor(t){super(t,sv)}getParser(){return this.parser}}class fA extends R{constructor(t){super(t,SB)}getParser(){return this.parser}}class fE extends R{constructor(t){super(t,yB)}getParser(){return this.parser}}class gA extends R{constructor(t){super(t,MB)}getParser(){return this.parser}}class g8 extends R{constructor(t){super(t,CB)}getParser(){return this.parser}}class E8 extends R{constructor(t){super(t,NB)}getParser(){return this.parser}}class p8 extends R{constructor(t){super(t,Fh)}getParser(){return this.parser}}const Ja=class oa{constructor(t){this._type=t.readInt(),this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._memberSince=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get admin(){return this._type==oa.TYPE_ADMIN}get owner(){return this._type==oa.TYPE_OWNER}get pending(){return this._type==oa.TYPE_PENDING}get member(){return this._type!=oa.TYPE_MEMBER}get blocked(){return this._type==oa.TYPE_BLOCKED}get figure(){return this._figure}get memberSince(){return this._memberSince}};Ja.TYPE_OWNER=0;Ja.TYPE_ADMIN=1;Ja.TYPE_PENDING=2;Ja.TYPE_MEMBER=3;Ja.TYPE_BLOCKED=4;let m8=Ja;class EA extends R{constructor(t){super(t,$H)}getParser(){return this.parser}}class pA extends R{constructor(t){super(t,tV)}getParser(){return this.parser}}class mA extends R{constructor(t){super(t,eV)}getParser(){return this.parser}}class I8 extends R{constructor(t){super(t,iV)}getParser(){return this.parser}}class T8 extends R{constructor(t){super(t,nV)}getParser(){return this.parser}}class R8 extends R{constructor(t){super(t,aV)}getParser(){return this.parser}}class O8 extends R{constructor(t){super(t,eY)}getParser(){return this.parser}}class v8{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class A8{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class S8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class y8{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class M8{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class C8{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class N8{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class b8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class P8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class D8{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class L8{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Gl{constructor(t="",e="",s="",i=-1,n=-1){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=[]}assignBitmap(t){const e=Qt.generateImageUrl(t);if(!e)return;const s=e.split(",")[1],i=Uint8Array.from(atob(s),n=>n.charCodeAt(0));this._data.push(i.byteLength,i.buffer)}assignBase64(t){const e=t.split(",")[1],s=Uint8Array.from(atob(e),i=>i.charCodeAt(0));this._data.push(s.byteLength,s.buffer)}}class Qf extends Gl{constructor(t="",e="",s="",i=-1,n=-1){super(t,e,s,i,n)}}class U8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class x8{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class F8{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class w8{constructor(t,e,s,i,n,a){this._data=[t,e,s,i,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class G8{constructor(t,e,s,i){this._data=[t,e,s,i]}dispose(){this._data=null}getMessageArray(){return this._data}}class B8{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class H8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class V8{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class k8{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class j8{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class z8{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Y8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class W8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class X8{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class K8{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class q8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Q8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Z8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class J8{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class $8{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class tK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class eK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class rK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class iK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class aK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class oK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class hK{constructor(t,e,s,i,n,a,o,h,u){this._data=[t,e,s,i,n,a,o,h,u]}getMessageArray(){return this._data}dispose(){}}class uK{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class lK{constructor(t,e,s,i,n,a,o){this._data=[t,e,s,i,n,a,o]}getMessageArray(){return this._data}dispose(){}}class _K{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class cK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class EK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class pK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class mK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class IK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class TK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class AK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Wh{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}Wh.CONFIRM_LEVEL_NOT_ACCEPTED=0;Wh.CONFIRM_LEVEL_NOT_SUBMITTED=1;Wh.CONFIRM_LEVEL_NOT_CONFIRMED=2;Wh.CONFIRM_LEVEL_COMMIT=3;class SK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class MK{constructor(t,e){this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class CK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bK{constructor(t,e){this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class PK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class DK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class LK{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class UK{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class xK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class FK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class GK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class BK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class HK{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class VK{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class kK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class zK{constructor(t,e){this._data=[e.length,...e,t]}getMessageArray(){return this._data}dispose(){}}class YK{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class WK{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XK{constructor(t=!0){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class KK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class qK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class QK{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class ZK{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class JK{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class $K{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class t7{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class e7{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class s7{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class r7{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class i7{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class IA{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class n7{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class a7{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class o7{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class h7{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class u7{constructor(t,e,s,i,n,a){this._data=[t,e,s,i,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class l7{constructor(t,e,s,i,n,a){this._data=[t,e,s,i,n,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class _7{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class c7{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class TA{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}TA.NO_ISSUE_ID=-1;class d7{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class RA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}RA.NO_ISSUE_ID=-1;class f7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class g7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class E7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class p7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class m7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class I7{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class T7{constructor(t,e,s,i,n,a){this._data=[t,e,s,i,n,a.length,...a]}getMessageArray(){return this._data}dispose(){}}class R7{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class O7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class v7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class A7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class S7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class y7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class M7{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class C7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class N7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class b7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class P7{constructor(t,e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class D7{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class L7{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class U7{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class x7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class F7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class w7{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class G7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class B7{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class H7{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class V7{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class k7{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class j7{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class z7{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Y7{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class W7{constructor(...t){this._data=[t.length],t.forEach(e=>{this._data.push(e.k),this._data.push(e._arg_2),this._data.push(e._arg_3)})}getMessageArray(){return this._data}dispose(){}}class X7{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class K7{constructor(t,e,s,i){this._data=[t,e,i,s]}getMessageArray(){return this._data}dispose(){}}class q7{constructor(t,e,s){if(this._type=t,e.length===s.length){this._data=[];for(let i=0;i<e.length;i++)this._data.push(e[i]),this._data.push(s[i])}}getMessageArray(){return this._data}dispose(){}}class OA{constructor(t,e,s,i){this._data=[`NITRO-${CO.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",o_.HTML5,Hg.BROWSER]}getMessageArray(){return this._data}dispose(){}}class Q7{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Z7{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vA{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class J7{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AA{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class SA{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class $7{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class t9{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class e9{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class s9{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class r9{constructor(t,e,s,i){this._data=[t,e,s,i.length/2,...i]}getMessageArray(){return this._data}dispose(){}}class i9{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class n9{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class a9{constructor(t,e,s,i,n){this._data=[t,e,s,i,n.length/2,...n]}getMessageArray(){return this._data}dispose(){}}class o9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class h9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class u9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class l9{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class _9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class c9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class d9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class f9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class g9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class E9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class p9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class m9{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class I9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class T9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class R9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class O9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class v9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class A9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class S9{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class y9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class M9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class C9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class N9{constructor(t,e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class b9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class P9{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class D9{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class L9{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class U9{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class x9{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class F9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class w9{constructor(){this._badges=[]}getMessageArray(){const t=[];for(let e=1;e<=this._badges.length;e++)t.push(e),t.push(this._badges[e-1]);return t}dispose(){}addActivatedBadge(t){this._badges.push(t)}}class cI{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class G9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class B9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class H9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class V9{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class dI{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class k9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class j9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class z9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Y9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class W9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class X9{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class K9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class q9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Q9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Z9{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class J9{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class $9{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class tq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class sq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class rq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class iq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class aq{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){this._data=null}}class oq{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){this._data=null}}class hq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class uq{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class lq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class _q{constructor(t,e,s){this._data=[t,e.length,...e,s]}getMessageArray(){return this._data}dispose(){}}class N_{constructor(t,e){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}N_.RESOLUTION_USELESS=1;N_.RESOLUTION_ABUSIVE=2;N_.RESOLUTION_RESOLVED=3;const yA=class MA{constructor(t,e,s,i,n,a=-1){this._data=[t,e,s,i,n],a!=MA.NO_ISSUE_ID&&this._data.push(a)}getMessageArray(){return this._data}dispose(){}};yA.NO_ISSUE_ID=-1;let Yn=yA;class cq{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=Yn.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class dq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Eq{constructor(t,e=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class pq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Iq{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=Yn.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class Tq{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Xh{constructor(t,e,s){this._data=[],this._data.push(t),this._data.push(e),this._data.push(s)}getMessageArray(){return this._data}dispose(){}}Xh.ACTION_ALERT=0;Xh.ACTION_KICK=1;Xh.ACTION_MESSAGE=3;Xh.ACTION_MESSAGE_AND_SOFT_KICK=4;class Rq{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=Yn.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class Oq{constructor(t,e,s,i=-1){this._data=[],this._data.push(t),this._data.push(e),this._data.push(""),this._data.push(""),this._data.push(s),i!=Yn.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class vq{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=Yn.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class Aq{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Sq{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class yq{constructor(t,e,s,i,n=-1){this._data=[t,e,s,i],n!=Yn.NO_ISSUE_ID&&this._data.push(n)}getMessageArray(){return this._data}dispose(){}}class Mq{constructor(t,e,s,i){this._data=[t.length,...t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Cq{constructor(t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class Nq{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class bq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Pq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Dq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Lq{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Uq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xq{constructor(t,e,s,i,n,a){this._data=[t,e,s,i,n,a]}getMessageArray(){return this._data}dispose(){}}class Fq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wq{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Gq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Hq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Vq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kq{constructor(t,e,s){this._data=[t,e?1:0,s?1:0]}getMessageArray(){return this._data}dispose(){}}class jq{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Yq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Wq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Xq{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Kq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class qq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Qq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Zq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Jq{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $q{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class tQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class eQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class rQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class iQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class oQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class uQ{constructor(t,e,s,i,n,a){this._data=[t,e,s,i,n,a]}getMessageArray(){return this._data}dispose(){}}class lQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class _Q{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dQ{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class fQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class EQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class TQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vQ{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class AQ{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class SQ{constructor(...t){this._data=[t.length*3],t.forEach(e=>{this._data.push(e.dayIndex),this._data.push(e.stepIndex),this._data.push(e.giftIndex)})}dispose(){this._data=null}getMessageArray(){return this._data}}class CA{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class g{}g.ACHIEVEMENT_LIST=219;g.AUTHENTICATION=-1;g.BOT_CONFIGURATION=1986;g.BOT_PICKUP=3323;g.BOT_PLACE=1592;g.BOT_SKILL_SAVE=2624;g.GET_CLUB_OFFERS=3285;g.GET_CLUB_GIFT_INFO=487;g.GET_CATALOG_INDEX=1195;g.GET_CATALOG_PAGE=412;g.CATALOG_PURCHASE=3492;g.CATALOG_PURCHASE_GIFT=1411;g.GET_PRODUCT_OFFER=2594;g.CLIENT_LATENCY=295;g.CLIENT_LATENCY_MEASURE=96;g.CLIENT_POLICY=26979;g.CLIENT_PONG=2596;g.CLIENT_TOOLBAR_TOGGLE=2313;g.CLIENT_VARIABLES=1053;g.GET_CURRENT_TIMING_CODE=2912;g.DESKTOP_NEWS=1827;g.DESKTOP_VIEW=105;g.GET_BUNDLE_DISCOUNT_RULESET=223;g.EVENT_TRACKER=3457;g.FIND_NEW_FRIENDS=516;g.FURNITURE_ALIASES=3898;g.FURNITURE_FLOOR_UPDATE=248;g.FURNITURE_MULTISTATE=99;g.FURNITURE_PICKUP=3456;g.FURNITURE_PLACE=1258;g.FURNITURE_POSTIT_PLACE=2248;g.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283;g.FURNITURE_RANDOMSTATE=3617;g.FURNITURE_WALL_MULTISTATE=210;g.FURNITURE_WALL_UPDATE=168;g.GAMES_INIT=2914;g.GAMES_LIST=741;g.ACCEPTGAMEINVITE=3802;g.GAMEUNLOADEDMESSAGE=3207;g.GETGAMEACHIEVEMENTSMESSAGE=2399;g.GETGAMESTATUSMESSAGE=3171;g.GETUSERGAMEACHIEVEMENTSMESSAGE=389;g.JOINQUEUEMESSAGE=1458;g.LEAVEQUEUEMESSAGE=2384;g.RESETRESOLUTIONACHIEVEMENTMESSAGE=3144;g.GETWEEKLYGAMEREWARDWINNERS=1054;g.GAME2GETACCOUNTGAMESTATUSMESSAGE=11;g.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE=3259;g.GAME2EXITGAMEMESSAGE=1445;g.GAME2GAMECHATMESSAGE=2502;g.GAME2LOADSTAGEREADYMESSAGE=2415;g.GAME2PLAYAGAINMESSAGE=3196;g.GAME2REQUESTFULLSTATUSUPDATEMESSAGE=1598;g.GAME2GETWEEKLYFRIENDSLEADERBOARD=1232;g.GAME2GETWEEKLYLEADERBOARD=2565;g.GET_GIFT_WRAPPING_CONFIG=418;g.GROUP_ADMIN_ADD=2894;g.GROUP_ADMIN_REMOVE=722;g.GROUP_CREATE_OPTIONS=798;g.GROUP_FAVORITE=3549;g.GET_FORUM_STATS=3149;g.GET_FORUM_THREADS=873;g.GET_FORUMS_LIST=436;g.GET_FORUM_MESSAGES=232;g.GET_FORUM_THREAD=3900;g.GET_UNREAD_FORUMS_COUNT=2908;g.FORUM_MODERATE_MESSAGE=286;g.FORUM_MODERATE_THREAD=1397;g.FORUM_POST_MESSAGE=3529;g.UPDATE_FORUM_READ_MARKER=1855;g.UPDATE_FORUM_SETTINGS=2214;g.FORUM_UPDATE_THREAD=3045;g.GROUP_INFO=2991;g.GROUP_DELETE=1134;g.GROUP_MEMBER_REMOVE_CONFIRM=3593;g.GROUP_MEMBER_REMOVE=593;g.GROUP_MEMBERS=312;g.GROUP_MEMBERSHIPS=367;g.GROUP_REQUEST=998;g.GROUP_REQUEST_ACCEPT=3386;g.GROUP_REQUEST_DECLINE=1894;g.GROUP_SETTINGS=1004;g.GROUP_PARTS=813;g.GROUP_BUY=230;g.GROUP_SAVE_INFORMATION=3137;g.GROUP_SAVE_BADGE=1991;g.GROUP_SAVE_COLORS=1764;g.GROUP_SAVE_PREFERENCES=3435;g.GROUP_BADGES=21;g.GROUP_UNBLOCK_MEMBER=2864;g.GET_BADGE_POINTS_LIMITS=1371;g.REQUESTABADGE=3077;g.GETISBADGEREQUESTFULFILLED=1364;g.ITEM_CLOTHING_REDEEM=3374;g.ITEM_COLOR_WHEEL_CLICK=2144;g.ITEM_DICE_CLICK=1990;g.ITEM_DICE_CLOSE=1533;g.ITEM_DIMMER_SAVE=1648;g.ITEM_DIMMER_SETTINGS=2813;g.ITEM_DIMMER_TOGGLE=2296;g.ITEM_EXCHANGE_REDEEM=3115;g.ITEM_PAINT=711;g.SET_OBJECT_DATA=3608;g.ITEM_STACK_HELPER=3839;g.ITEM_WALL_CLICK=210;g.ITEM_WALL_UPDATE=168;g.MARKETPLACE_CONFIG=2597;g.ACCEPT_FRIEND=137;g.MESSENGER_CHAT=3567;g.DECLINE_FRIEND=2890;g.FOLLOW_FRIEND=3997;g.MESSENGER_FRIENDS=1523;g.MESSENGER_INIT=2781;g.MESSENGER_RELATIONSHIPS=2138;g.SET_RELATIONSHIP_STATUS=3768;g.REMOVE_FRIEND=1689;g.REQUEST_FRIEND=3157;g.GET_FRIEND_REQUESTS=2448;g.SEND_ROOM_INVITE=1276;g.HABBO_SEARCH=1210;g.FRIEND_LIST_UPDATE=1419;g.MOD_TOOL_USER_INFO=3295;g.GET_USER_FLAT_CATS=3027;g.NAVIGATOR_INIT=2110;g.NAVIGATOR_SEARCH=249;g.NAVIGATOR_SEARCH_CLOSE=1834;g.NAVIGATOR_SEARCH_OPEN=637;g.NAVIGATOR_SEARCH_SAVE=2226;g.GET_USER_EVENT_CATS=1782;g.NAVIGATOR_SETTINGS_SAVE=3159;g.NAVIGATOR_CATEGORY_LIST_MODE=1202;g.NAVIGATOR_DELETE_SAVED_SEARCH=1954;g.PET_INFO=2934;g.PET_PICKUP=1581;g.PET_PLACE=2647;g.PET_RESPECT=3202;g.PET_RIDE=1036;g.PET_MOVE=3449;g.PET_OPEN_PACKAGE=3698;g.PET_SELECTED=549;g.PETS_BREED=1638;g.PET_CANCEL_BREEDING=2713;g.PET_CONFIRM_BREEDING=3382;g.GET_PET_TRAINING_PANEL=2161;g.RECYCLER_PRIZES=398;g.RECYCLER_STATUS=1342;g.RECYCLER_ITEMS=2771;g.RELEASE_VERSION=4e3;g.CALL_FOR_HELP=1691;g.ROOM_AMBASSADOR_ALERT=2996;g.ROOM_BAN_GIVE=1477;g.ROOM_BAN_LIST=2267;g.ROOM_BAN_REMOVE=992;g.ROOM_CREATE=2752;g.ROOM_DELETE=532;g.ROOM_DOORBELL=1644;g.ROOM_ENTER=2312;g.ROOM_FAVORITE=3817;g.ROOM_FAVORITE_REMOVE=309;g.CAN_CREATE_ROOM=2128;g.CANCEL_ROOM_EVENT=2725;g.EDIT_ROOM_EVENT=3991;g.COMPETITION_ROOM_SEARCH=433;g.FORWARD_TO_RANDOM_PROMOTED_ROOM=10;g.FORWARD_TO_SOME_ROOM=1703;g.GET_CATEGORIES_WITH_USER_COUNT=3782;g.GET_GUEST_ROOM=2230;g.GET_OFFICIAL_ROOMS=1229;g.GET_POPULAR_ROOM_TAGS=826;g.GUILD_BASE_SEARCH=2930;g.MY_FAVOURITE_ROOMS_SEARCH=2578;g.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002;g.MY_FRIENDS_ROOM_SEARCH=2266;g.MY_GUILD_BASES_SEARCH=39;g.MY_RECOMMENDED_ROOMS=2537;g.MY_ROOM_HISTORY_SEARCH=2264;g.MY_ROOM_RIGHTS_SEARCH=272;g.MY_ROOMS_SEARCH=2277;g.POPULAR_ROOMS_SEARCH=2758;g.ROOM_AD_EVENT_TAB_CLICKED=2412;g.ROOM_AD_EVENT_TAB_VIEWED=2668;g.ROOM_AD_SEARCH=2809;g.ROOM_TEXT_SEARCH=3943;g.ROOMS_WHERE_MY_FRIENDS_ARE=1786;g.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939;g.SET_ROOM_SESSION_TAGS=3305;g.UPDATE_ROOM_THUMBNAIL=2468;g.SET_WELCOME_ROOM=1915;g.ROOM_KICK=1320;g.ROOM_LIKE=3582;g.ROOM_MODEL=2300;g.GET_OCCUPIED_TILES=1687;g.GET_ROOM_ENTRY_TILE=3559;g.ROOM_MODEL_SAVE=875;g.ROOM_MUTE=3637;g.ROOM_MUTE_USER=3485;g.ROOM_RIGHTS_GIVE=808;g.ROOM_RIGHTS_LIST=3385;g.ROOM_RIGHTS_REMOVE=2064;g.ROOM_RIGHTS_REMOVE_ALL=2683;g.ROOM_RIGHTS_REMOVE_OWN=3182;g.ROOM_SETTINGS=3129;g.ROOM_SETTINGS_SAVE=1969;g.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE=1265;g.ROOM_STAFF_PICK=1918;g.ROOM_FILTER_WORDS=1911;g.ROOM_FILTER_WORDS_MODIFY=3001;g.MYSTERYBOXWAITINGCANCELEDMESSAGE=2012;g.MYSTERYBOX_OPEN_TROPHY=3074;g.SECURITY_MACHINE=2490;g.SECURITY_TICKET=2419;g.TRADE=1481;g.TRADE_ACCEPT=3863;g.TRADE_CANCEL=2341;g.TRADE_CLOSE=2551;g.TRADE_CONFIRM=2760;g.TRADE_ITEM=3107;g.TRADE_ITEM_REMOVE=3845;g.TRADE_ITEMS=1263;g.TRADE_UNACCEPT=1444;g.UNIT_ACTION=2456;g.UNIT_CHAT=1314;g.UNIT_CHAT_SHOUT=2085;g.UNIT_CHAT_WHISPER=1543;g.UNIT_DANCE=2080;g.UNIT_DROP_HAND_ITEM=2814;g.UNIT_GIVE_HANDITEM=2941;g.UNIT_LOOK=3301;g.UNIT_POSTURE=2235;g.UNIT_SIGN=1975;g.UNIT_TYPING=1597;g.UNIT_TYPING_STOP=1474;g.UNIT_WALK=3320;g.USER_BADGES=2769;g.USER_BADGES_CURRENT=2091;g.USER_BADGES_CURRENT_UPDATE=644;g.USER_BOTS=3848;g.USER_CURRENCY=273;g.USER_EFFECT_ACTIVATE=2959;g.USER_EFFECT_ENABLE=1752;g.USER_FIGURE=2730;g.USER_FURNITURE=3150;g.REQUESTFURNIINVENTORYWHENNOTINROOM=3500;g.USER_HOME_ROOM=1740;g.USER_INFO=357;g.USER_MOTTO=2228;g.USER_IGNORED=3878;g.USER_PETS=3095;g.USER_PROFILE=3265;g.USER_PROFILE_BY_NAME=2249;g.USER_RESPECT=2694;g.GET_SOUND_SETTINGS=2388;g.USER_SETTINGS_CAMERA=1461;g.USER_SETTINGS_CHAT_STYLE=1030;g.USER_SETTINGS_INVITES=1086;g.USER_SETTINGS_OLD_CHAT=1262;g.USER_SETTINGS_VOLUME=1367;g.USER_SUBSCRIPTION=3166;g.GET_WARDROBE=2742;g.SAVE_WARDROBE_OUTFIT=800;g.USER_TAGS=17;g.PEER_USERS_CLASSIFICATION=1160;g.USER_CLASSIFICATION=2285;g.VISIT_USER=2970;g.WIRED_ACTION_SAVE=2281;g.WIRED_APPLY_SNAPSHOT=3373;g.WIRED_CONDITION_SAVE=3203;g.WIRED_OPEN=768;g.WIRED_TRIGGER_SAVE=1520;g.GET_ITEM_DATA=3964;g.ONE_WAY_DOOR_CLICK=2765;g.REMOVE_WALL_ITEM=3336;g.SET_ITEM_DATA=3666;g.CATALOG_REDEEM_VOUCHER=339;g.ROOM_TONER_APPLY=2880;g.FRIEND_FURNI_CONFIRM_LOCK=3775;g.MANNEQUIN_SAVE_NAME=2850;g.MANNEQUIN_SAVE_LOOK=2209;g.PRESENT_OPEN_PRESENT=3558;g.CATALOG_SELECT_VIP_GIFT=2276;g.USER_IGNORE_ID=3314;g.USER_IGNORE=1117;g.USER_UNIGNORE=2061;g.MODTOOL_REQUEST_ROOM_INFO=707;g.MODTOOL_CHANGE_ROOM_SETTINGS=3260;g.MODTOOL_REQUEST_USER_CHATLOG=1391;g.MODTOOL_REQUEST_ROOM_CHATLOG=2587;g.MODTOOL_SANCTION_ALERT=229;g.MODTOOL_SANCTION_BAN=2766;g.MODTOOL_SANCTION_KICK=2582;g.MODTOOL_SANCTION_TRADELOCK=3742;g.MODTOOL_ALERTEVENT=1840;g.MODTOOL_SANCTION_MUTE=1945;g.MODTOOL_REQUEST_USER_ROOMS=3526;g.MODTOOL_ROOM_ALERT=3842;g.MODTOOL_PREFERENCES=31;g.CLOSE_ISSUE_DEFAULT_ACTION=2717;g.CLOSE_ISSUES=2067;g.DEFAULT_SANCTION=1681;g.GET_CFH_CHATLOG=211;g.MODTOOL_SANCTION=1392;g.PICK_ISSUES=15;g.RELEASE_ISSUES=1572;g.CONVERT_GLOBAL_ROOM_ID=314;g.REQUEST_SELL_ITEM=848;g.REQUEST_MARKETPLACE_ITEM_STATS=3288;g.MARKETPLACE_SELL_ITEM=3447;g.MARKETPLACE_REQUEST_OWN_ITEMS=2105;g.MARKETPLACE_TAKE_BACK_ITEM=434;g.MARKETPLACE_REDEEM_CREDITS=2650;g.MARKETPLACE_REQUEST_OFFERS=2407;g.MARKETPLACE_BUY_OFFER=1603;g.MARKETPLACE_BUY_TOKENS=1866;g.CATALOG_REQUESET_PET_BREEDS=1756;g.APPROVE_NAME=2109;g.UNIT_GIVE_HANDITEM_PET=2768;g.PET_MOUNT=1036;g.PET_SUPPLEMENT=749;g.FURNITURE_GROUP_INFO=2651;g.ACHIEVEMENT_RESOLUTION_OPEN=359;g.USE_PET_PRODUCT=1328;g.REMOVE_PET_SADDLE=186;g.TOGGLE_PET_RIDING=1472;g.TOGGLE_PET_BREEDING=3379;g.UNSEEN_RESET_CATEGORY=3493;g.UNSEEN_RESET_ITEMS=2343;g.COMMUNITY_GOAL_VOTE_COMPOSER=3536;g.GET_PROMO_ARTICLES=1827;g.ACCEPT_QUEST=3604;g.ACTIVATE_QUEST=793;g.CANCEL_QUEST=3133;g.FRIEND_REQUEST_QUEST_COMPLETE=1148;g.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688;g.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167;g.GET_COMMUNITY_GOAL_PROGRESS=1145;g.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343;g.GET_CONCURRENT_USERS_REWARD=3872;g.GET_DAILY_QUEST=2486;g.GET_QUESTS=3333;g.GET_SEASONAL_QUESTS_ONLY=1190;g.OPEN_QUEST_TRACKER=2750;g.REDEEM_COMMUNITY_GOAL_PRIZE=90;g.REJECT_QUEST=2397;g.START_CAMPAIGN=1697;g.GET_BONUS_RARE_INFO=957;g.CRAFT=3591;g.CRAFT_SECRET=1251;g.GET_CRAFTABLE_PRODUCTS=633;g.GET_CRAFTING_RECIPE=1173;g.GET_CRAFTING_RECIPES_AVAILABLE=3086;g.PHOTO_COMPETITION=3959;g.PUBLISH_PHOTO=2068;g.PURCHASE_PHOTO=2408;g.PURCHASE_PHOTO_XXL=2409;g.RENDER_ROOM=3226;g.RENDER_ROOM_THUMBNAIL=1982;g.REQUEST_CAMERA_CONFIGURATION=796;g.ADD_JUKEBOX_DISK=753;g.GET_JUKEBOX_PLAYLIST=1435;g.GET_NOW_PLAYING=1325;g.GET_OFFICIAL_SONG_ID=3189;g.GET_SONG_INFO=3082;g.GET_SOUND_MACHINE_PLAYLIST=3498;g.GET_USER_SONG_DISKS=2304;g.REMOVE_JUKEBOX_DISK=3050;g.INTERSTITIAL_SHOWN=1109;g.GET_INTERSTITIAL=2519;g.CHANGE_USERNAME=2977;g.CHECK_USERNAME=3950;g.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889;g.OPEN_CAMPAIGN_CALENDAR_DOOR=2257;g.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051;g.BUILDERS_CLUB_PLACE_WALL_ITEM=462;g.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529;g.GET_CATALOG_PAGE_EXPIRATION=742;g.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135;g.GET_DIRECT_CLUB_BUY_AVAILABLE=801;g.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603;g.GET_HABBO_CLUB_EXTEND_OFFER=2462;g.GET_IS_OFFER_GIFTABLE=1347;g.GET_LIMITED_OFFER_APPEARING_NEXT=410;g.GET_NEXT_TARGETED_OFFER=596;g.GET_ROOM_AD_PURCHASE_INFO=1075;g.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257;g.GET_TARGETED_OFFER=2487;g.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150;g.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735;g.PURCHASE_ROOM_AD=777;g.PURCHASE_TARGETED_OFFER=1826;g.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407;g.ROOM_AD_PURCHASE_INITIATED=2283;g.SET_TARGETTED_OFFER_STATE=2041;g.SHOP_TARGETED_OFFER_VIEWED=3483;g.HELPER_TALENT_TRACK=196;g.TALENT_TRACK_GET_LEVEL=2127;g.FORWARD_TO_A_COMPETITION_ROOM=172;g.FORWARD_TO_A_SUBMITTABLE_ROOM=1450;g.FORWARD_TO_RANDOM_COMPETITION_ROOM=865;g.GET_IS_USER_PART_OF_COMPETITION=2077;g.GET_SECONDS_UNTIL=271;g.ROOM_COMPETITION_INIT=1334;g.SUBMIT_ROOM_TO_COMPETITION=2595;g.VOTE_FOR_ROOM=143;g.GET_GIFT=2436;g.RESET_PHONE_NUMBER_STATE=2741;g.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379;g.TRY_PHONE_NUMBER=790;g.VERIFY_CODE=2721;g.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005;g.GET_YOUTUBE_DISPLAY_STATUS=336;g.SET_YOUTUBE_DISPLAY_PLAYLIST=2069;g.GO_TO_FLAT=685;g.CHANGE_QUEUE=3093;g.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412;g.CALL_FOR_HELP_FROM_FORUM_THREAD=534;g.CALL_FOR_HELP_FROM_IM=2950;g.CALL_FOR_HELP_FROM_PHOTO=2492;g.CALL_FOR_HELP_FROM_SELFIE=2755;g.CHAT_REVIEW_GUIDE_DECIDES=3365;g.CHAT_REVIEW_GUIDE_DETACHED=2501;g.CHAT_REVIEW_GUIDE_VOTE=3961;g.CHAT_REVIEW_SESSION_CREATE=3060;g.DELETE_PENDING_CALLS_FOR_HELP=3605;g.GET_CFH_STATUS=2746;g.GET_FAQ_CATEGORY=3445;g.GET_FAQ_TEXT=1849;g.GET_GUIDE_REPORTING_STATUS=3786;g.GET_PENDING_CALLS_FOR_HELP=3267;g.GET_QUIZ_QUESTIONS=1296;g.GUIDE_SESSION_CREATE=3338;g.GUIDE_SESSION_FEEDBACK=477;g.GUIDE_SESSION_GET_REQUESTER_ROOM=1052;g.GUIDE_SESSION_GUIDE_DECIDES=1424;g.GUIDE_SESSION_INVITE_REQUESTER=234;g.GUIDE_SESSION_IS_TYPING=519;g.GUIDE_SESSION_MESSAGE=3899;g.GUIDE_SESSION_ON_DUTY_UPDATE=1922;g.GUIDE_SESSION_REPORT=3969;g.GUIDE_SESSION_REQUESTER_CANCELS=291;g.GUIDE_SESSION_RESOLVED=887;g.POST_QUIZ_ANSWERS=3720;g.SEARCH_FAQS=2031;g.POLL_ANSWER=3505;g.POLL_REJECT=1773;g.POLL_START=109;g.DISCONNECT=2445;g.SCR_GET_KICKBACK_INFO=869;g.COMPOST_PLANT=3835;g.HARVEST_PET=1521;g.SET_CLOTHING_CHANGE_DATA=924;g.GROUP_UNFAVORITE=1820;g.NEW_USER_EXPERIENCE_GET_GIFTS=1822;g.NEW_USER_EXPERIENCE_SCRIPT_PROCEED=1299;g.HANDSHAKE_INIT_DIFFIE=3110;g.HANDSHAKE_COMPLETE_DIFFIE=773;g.WELCOME_OPEN_GIFT=2638;g.WELCOME_GIFT_CHANGE_EMAIL=66;g.EMAIL_GET_STATUS=2557;g.EMAIL_CHANGE=3965;g.APPROVE_ALL_MEMBERSHIP_REQUESTS=882;g.RENTABLE_SPACE_CANCEL_RENT=1667;g.RENTABLE_SPACE_RENT=2946;g.RENTABLE_SPACE_STATUS=872;g.TRACKING_PERFORMANCE_LOG=3230;g.TRACKING_LAG_WARNING_REPORT=3847;g.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION=3736;g.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM=2115;g.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI=1071;g.RENTABLE_GET_RENT_OR_BUYOUT_OFFER=2518;class NA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Zf{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class bA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class PA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class DA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class LA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xA{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class FA{constructor(t,e,s){this._data=[t,e,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class wA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class GA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class CQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class DQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class LQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class UQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class FQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class wQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class GQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class BQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class HQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class kQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jQ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zQ{constructor(...t){this._data=[t.length],t.forEach(e=>{this._data.push(e.itemId)})}getMessageArray(){return this._data}dispose(){}}class BA{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class HA{constructor(t,e=null){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class YQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kA{constructor(t,e=0,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class WQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class YA{constructor(t,e,s=0){this._data=[t,s,e]}getMessageArray(){return this._data}dispose(){}}class WA{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class XQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class KQ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class qQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ZQ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class JQ{constructor(t,e,s,i,n,a,o,h,u,c,l,_,d,f,m,p,T,v,O,A,y,M,N,P){this._data=[],this._data.push(t,e,s,i,n,a,o),this._data.push(u.length,...u),this._data.push(c,l,_,d,f,m,p,T,v,O,A,y,M,N,P)}getMessageArray(){return this._data}dispose(){}}class XA{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class KA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $Q{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class qA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QA extends qA{constructor(t){super(t)}}class ZA{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class JA extends qA{constructor(t){super(t)}}class Jf{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class $A{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class tS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sS{constructor(t,e,s=""){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class rS{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class iS{constructor(t,e){this._data=[t,e.size*2];for(const[s,i]of e.entries())this._data.push(s,i)}getMessageArray(){return this._data}dispose(){}}class tZ{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class nS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class aS{constructor(t,e,s,i,n){this._data=[t,e,s,i,n]}getMessageArray(){return this._data}dispose(){}}class oS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class eZ{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class sZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class $f{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class hS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class _S{constructor(t,e,s,i,n,a){this._itemId=t,this._category=e,this._wallLocation=s,this._x=i,this._y=n,this._direction=a}getMessageArray(){switch(this._category){case L.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case L.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class rZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class iZ{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class dS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gE{constructor(t,e=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class ES{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class aZ{constructor(t,e=-100){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class mS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class oZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class uZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class IS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _Z{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fZ{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class RS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class gZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class EZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class mZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class tg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class IZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class TZ{constructor(t,e,s,i,n,a,o){this._data=[t,e,s,i,n,a,o]}getMessageArray(){return this._data}dispose(){}}class RZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class EE{constructor(t,e=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class AS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class OZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SS{constructor(t,e,s){this._data=[t+" "+e,s]}getMessageArray(){return this._data}dispose(){}}class yS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class MS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class CS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class PS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class DS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class LS{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class b_{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}b_.STATE_START=0;b_.STATE_CANCEL=1;b_.STATE_ACCEPT=2;class yZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class CZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class NZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class PZ{constructor(t,e,s,i,n,a){this._data=[t,e.length,...e,s,i.length,...i,n,a]}getMessageArray(){return this._data}dispose(){}}class DZ{constructor(t,e,s,i,n){this._data=[t,e.length,...e,s,i.length,...i,n]}getMessageArray(){return this._data}dispose(){}}class LZ{constructor(t,e,s,i,n){this._data=[t,e.length,...e,s,i.length,...i,n]}getMessageArray(){return this._data}dispose(){}}class UZ{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class xZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class US{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class FZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class FS{constructor(...t){this._data=[t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class wZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class GZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class BZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class HZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jZ{constructor(t,e,s,i,n,a,o,h,u,c,l){this._data=[t,e,s,i,n,a,o,h,u,c,l]}getMessageArray(){return this._data}dispose(){}}class zZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class YZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class WZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class GS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class BS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class HS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class KZ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class zS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class qZ{constructor(t,e=!0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class QZ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ZZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class YS{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class JZ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $Z{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tJ{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class eJ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sJ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rJ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class iJ{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class nJ{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class WS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aJ{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class KS{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class oJ extends Rr{constructor(t){super(),this._communication=t,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const t=this._communication.connection;t&&(t.addEventListener(Te.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.addEventListener(Te.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.addEventListener(Te.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new Rv(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new sA(this.onAuthenticatedEvent.bind(this)))}onDispose(){const t=this._communication.connection;t&&(t.removeEventListener(Te.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.removeEventListener(Te.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.removeEventListener(Te.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(t){const e=this._communication.connection;e&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(ke.CONNECTION_ESTABLISHED,e),at.getValue("system.pong.manually",!1)&&this.startPonging(),this.startHandshake(e),e.send(new OA(null,null,null,null)),this.tryAuthentication(e))}onConnectionClosedEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(ke.CONNECTION_CLOSED,e))}onConnectionErrorEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(ke.CONNECTION_ERROR,e))}tryAuthentication(t){if(!t||!this.getSSO()){this.getSSO()||Y.error("Login without an SSO ticket is not supported"),this.dispatchCommunicationDemoEvent(ke.CONNECTION_HANDSHAKE_FAILED,t);return}t.send(new SA(this.getSSO(),ft()))}onClientPingEvent(t){!t||!t.connection||this.sendPong(t.connection)}onAuthenticatedEvent(t){!t||!t.connection||(this.completeHandshake(t.connection),this.dispatchCommunicationDemoEvent(ke.CONNECTION_AUTHENTICATED,t.connection),t.connection.send(new vA))}startHandshake(t){this.dispatchCommunicationDemoEvent(ke.CONNECTION_HANDSHAKING,t),this._handShaking=!0}completeHandshake(t){this.dispatchCommunicationDemoEvent(ke.CONNECTION_HANDSHAKED,t),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,at.getValue("system.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(t=null){t=t||this._communication.connection||null,t&&t.send(new AA)}dispatchCommunicationDemoEvent(t,e){Q.instance.events.dispatchEvent(new ke(t,e))}getSSO(){return at.getValue("sso.ticket",null)}}class hJ{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set(E.INTERSTITIAL_MESSAGE,sY),this._events.set(E.ROOM_AD_ERROR,rY),this._events.set(E.AVAILABILITY_STATUS,Iv),this._events.set(E.AVAILABILITY_TIME,iY),this._events.set(E.HOTEL_CLOSED_AND_OPENS,nY),this._events.set(E.HOTEL_CLOSES_AND_OPENS_AT,aY),this._events.set(E.HOTEL_WILL_CLOSE_MINUTES,oY),this._events.set(E.HOTEL_MAINTENANCE,hY),this._events.set(E.USER_CHANGE_NAME,Ks),this._events.set(E.CHECK_USER_NAME,uY),this._events.set(E.USER_FIGURE,Tv),this._events.set(E.USER_OUTFITS,lY),this._events.set(E.ADD_BOT_TO_INVENTORY,_Y),this._events.set(E.USER_BOTS,cY),this._events.set(E.BOT_RECEIVED,dY),this._events.set(E.REMOVE_BOT_FROM_INVENTORY,fY),this._events.set(E.CFH_SANCTION,gY),this._events.set(E.CFH_TOPICS,EY),this._events.set(E.CFH_SANCTION_STATUS,pY),this._events.set(E.CAMERA_PUBLISH_STATUS,mY),this._events.set(E.CAMERA_PURCHASE_OK,IY),this._events.set(E.CAMERA_STORAGE_URL,TY),this._events.set(E.COMPETITION_STATUS,RY),this._events.set(E.INIT_CAMERA,OY),this._events.set(E.THUMBNAIL_STATUS,vY),this._events.set(E.CAMPAIGN_CALENDAR_DATA,AY),this._events.set(E.CAMPAIGN_CALENDAR_DOOR_OPENED,SY),this._events.set(E.BONUS_RARE_INFO,yY),this._events.set(E.BUILDERS_CLUB_FURNI_COUNT,MY),this._events.set(E.BUILDERS_CLUB_SUBSCRIPTION,CY),this._events.set(E.BUNDLE_DISCOUNT_RULESET,NY),this._events.set(E.CATALOG_PAGE_EXPIRATION,bY),this._events.set(E.CATALOG_PAGE,PY),this._events.set(E.CATALOG_PAGE_LIST,DY),this._events.set(E.CATALOG_EARLIEST_EXPIRY,LY),this._events.set(E.CATALOG_PUBLISHED,UY),this._events.set(E.CLUB_GIFT_INFO,xY),this._events.set(E.CLUB_GIFT_SELECTED,FY),this._events.set(E.DIRECT_SMS_CLUB_BUY,wY),this._events.set(E.GIFT_RECEIVER_NOT_FOUND,GY),this._events.set(E.GIFT_WRAPPER_CONFIG,BY),this._events.set(E.CLUB_EXTENDED_OFFER,HY),this._events.set(E.CLUB_OFFERS,VY),this._events.set(E.IS_OFFER_GIFTABLE,kY),this._events.set(E.LIMITED_SOLD_OUT,jY),this._events.set(E.LIMITED_OFFER_APPEARING_NEXT,zY),this._events.set(E.NOT_ENOUGH_BALANCE,YY),this._events.set(E.PRODUCT_OFFER,WY),this._events.set(E.CATALOG_PURCHASE_ERROR,XY),this._events.set(E.CATALOG_PURCHASE_NOT_ALLOWED,KY),this._events.set(E.CATALOG_PURCHASE_OK,qY),this._events.set(E.ROOM_AD_PURCHASE,QY),this._events.set(E.SEASONAL_CALENDAR_OFFER,ZY),this._events.set(E.CATALOG_RECEIVE_PET_BREEDS,JY),this._events.set(E.TARGET_OFFER,$Y),this._events.set(E.TARGET_OFFER_NOT_FOUND,t5),this._events.set(E.REDEEM_VOUCHER_ERROR,e5),this._events.set(E.REDEEM_VOUCHER_OK,s5),this._events.set(E.CLIENT_PING,Rv),this._events.set(E.COMPETITION_ENTRY_SUBMIT,r5),this._events.set(E.COMPETITION_VOTING_INFO,i5),this._events.set(E.COMPETITION_TIMING_CODE,n5),this._events.set(E.COMPETITION_USER_PART_OF,a5),this._events.set(E.COMPETITION_NO_OWNED_ROOMS,o5),this._events.set(E.COMPETITION_SECONDS_UNTIL,h5),this._events.set(E.CRAFTABLE_PRODUCTS,u5),this._events.set(E.CRAFTING_RECIPE,l5),this._events.set(E.CRAFTING_RECIPES_AVAILABLE,_5),this._events.set(E.CRAFTING_RESULT,c5),this._events.set(E.DESKTOP_VIEW,df),this._events.set(E.MESSENGER_ACCEPT_FRIENDS,d5),this._events.set(E.MESSENGER_FIND_FRIENDS,f5),this._events.set(E.MESSENGER_FOLLOW_FAILED,g5),this._events.set(E.MESSENGER_FRIENDS,E5),this._events.set(E.MESSENGER_UPDATE,p5),this._events.set(E.MESSENGER_FRIEND_NOTIFICATION,m5),this._events.set(E.MESSENGER_REQUESTS,I5),this._events.set(E.MESSENGER_SEARCH,T5),this._events.set(E.MESSENGER_INSTANCE_MESSAGE_ERROR,R5),this._events.set(E.MESSENGER_MESSAGE_ERROR,O5),this._events.set(E.MESSENGER_INIT,v5),this._events.set(E.MESSENGER_MINIMAIL_NEW,A5),this._events.set(E.MESSENGER_MINIMAIL_COUNT,S5),this._events.set(E.MESSENGER_CHAT,y5),this._events.set(E.MESSENGER_REQUEST,Ov),this._events.set(E.MESSENGER_INVITE_ERROR,M5),this._events.set(E.MESSENGER_INVITE,C5),this._events.set(E.ACHIEVEMENTRESOLUTIONCOMPLETED,F5),this._events.set(E.ACHIEVEMENTRESOLUTIONPROGRESS,w5),this._events.set(E.ACHIEVEMENTRESOLUTIONS,G5),this._events.set(E.LOAD_GAME_URL,vv),this._events.set(E.LOADGAME,W5),this._events.set(E.UNLOADGAME,X5),this._events.set(E.GAME_CENTER_GAME_LIST,V5),this._events.set(E.GAMESTATUSMESSAGE,k5),this._events.set(E.GAME_CENTER_ACHIEVEMENTS,K5),this._events.set(E.GAME_CENTER_STATUS,N5),this._events.set(E.GAME_CENTER_IN_ARENA_QUEUE,P5),this._events.set(E.GAME_CENTER_STOP_COUNTER,U5),this._events.set(E.GAME_CENTER_USER_LEFT_GAME,x5),this._events.set(E.GAME_CENTER_DIRECTORY_STATUS,b5),this._events.set(E.GAME_CENTER_STARTING_GAME_FAILED,L5),this._events.set(E.GAME_CENTER_JOINING_FAILED,D5),this._events.set(E.GAMEACHIEVEMENTS,B5),this._events.set(E.GAMEINVITE,H5),this._events.set(E.JOINEDQUEUEMESSAGE,j5),this._events.set(E.JOININGQUEUEFAILED,z5),this._events.set(E.LEFTQUEUE,Y5),this._events.set(E.WEEKLY_GAME_REWARD,$5),this._events.set(E.WEEKLY_GAME_REWARD_WINNERS,tW),this._events.set(E.WEEKLY_COMPETITIVE_LEADERBOARD,J5),this._events.set(E.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD,Z5),this._events.set(E.WEEKLY_GAME2_FRIENDS_LEADERBOARD,q5),this._events.set(E.WEEKLY_GAME2_LEADERBOARD,Q5),this._events.set(E.GROUP_INFO,aW),this._events.set(E.GROUP_MEMBER_REMOVE_CONFIRM,nW),this._events.set(E.GROUP_MEMBERS,oW),this._events.set(E.GROUP_CREATE_OPTIONS,iW),this._events.set(E.GROUP_BADGE_PARTS,Av),this._events.set(E.GROUP_SETTINGS,uW),this._events.set(E.GROUP_PURCHASED,hW),this._events.set(E.GROUP_BADGES,dA),this._events.set(E.GROUP_DEACTIVATE,lW),this._events.set(E.GROUP_MEMBERSHIP_REQUESTED,l8),this._events.set(E.GROUP_DETAILS_CHANGED,u8),this._events.set(E.GROUP_HABBO_JOIN_FAILED,f8),this._events.set(E.GROUP_FORUM_DATA,_W),this._events.set(E.GROUP_FORUM_LIST,cW),this._events.set(E.GROUP_FORUM_THREADS,dW),this._events.set(E.GROUP_FORUM_POST,fW),this._events.set(E.GROUP_FORUM_POST_THREAD,gW),this._events.set(E.GROUP_FORUM_THREAD_MESSAGES,EW),this._events.set(E.GROUP_FORUM_UNREAD_COUNT,pW),this._events.set(E.GROUP_FORUM_UPDATE_MESSAGE,mW),this._events.set(E.GROUP_FORUM_UPDATE_THREAD,IW),this._events.set(E.CFH_DISABLED_NOTIFY,AW),this._events.set(E.CFH_PENDING_CALLS_DELETED,SW),this._events.set(E.CFH_PENDING_CALLS,yW),this._events.set(E.CFH_REPLY,MW),this._events.set(E.CFH_RESULT_MESSAGE,CW),this._events.set(E.GUIDE_ON_DUTY_STATUS,UW),this._events.set(E.GUIDE_SESSION_ATTACHED,FW),this._events.set(E.GUIDE_SESSION_DETACHED,wW),this._events.set(E.GUIDE_SESSION_ENDED,yv),this._events.set(E.GUIDE_SESSION_ERROR,Mv),this._events.set(E.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,GW),this._events.set(E.GUIDE_SESSION_MESSAGE,BW),this._events.set(E.GUIDE_SESSION_PARTNER_IS_TYPING,HW),this._events.set(E.GUIDE_SESSION_REQUESTER_ROOM,VW),this._events.set(E.GUIDE_SESSION_STARTED,Cv),this._events.set(E.GUIDE_TICKET_CREATION_RESULT,kW),this._events.set(E.GUIDE_TICKET_RESOLUTION,jW),this._events.set(E.GUIDE_REPORTING_STATUS,xW),this._events.set(E.HOTEL_MERGE_NAME_CHANGE,zW),this._events.set(E.ISSUE_CLOSE_NOTIFICATION,YW),this._events.set(E.QUIZ_DATA,WW),this._events.set(E.QUIZ_RESULTS,XW),this._events.set(E.CHAT_REVIEW_SESSION_DETACHED,NW),this._events.set(E.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,bW),this._events.set(E.CHAT_REVIEW_SESSION_RESULTS,PW),this._events.set(E.CHAT_REVIEW_SESSION_STARTED,DW),this._events.set(E.CHAT_REVIEW_SESSION_VOTING_STATUS,LW),this._events.set(E.ACHIEVEMENT_PROGRESSED,KW),this._events.set(E.ACHIEVEMENT_LIST,qW),this._events.set(E.USER_ACHIEVEMENT_SCORE,QW),this._events.set(E.USER_EFFECT_ACTIVATE,ZW),this._events.set(E.USER_EFFECT_LIST_ADD,JW),this._events.set(E.USER_EFFECT_LIST_REMOVE,$W),this._events.set(E.USER_EFFECT_LIST,e4),this._events.set(E.AVATAR_EFFECT_SELECTED,t4),this._events.set(E.USER_BADGES,r4),this._events.set(E.USER_BADGES_ADD,s4),this._events.set(E.BADGE_POINT_LIMITS,Nv),this._events.set(E.BADGE_REQUEST_FULFILLED,i4),this._events.set(E.USER_CLOTHING,n4),this._events.set(E.USER_FURNITURE_ADD,a4),this._events.set(E.USER_FURNITURE,o4),this._events.set(E.USER_FURNITURE_REFRESH,h4),this._events.set(E.USER_FURNITURE_REMOVE,u4),this._events.set(E.USER_FURNITURE_POSTIT_PLACED,l4),this._events.set(E.USER_PETS,g4),this._events.set(E.USER_PET_REMOVE,p4),this._events.set(E.USER_PET_ADD,f4),this._events.set(E.PET_RECEIVED,E4),this._events.set(E.PET_PLACING_ERROR,Uv),this._events.set(E.YOUTUBE_CONTROL_VIDEO,N6),this._events.set(E.YOUTUBE_DISPLAY_PLAYLISTS,b6),this._events.set(E.YOUTUBE_DISPLAY_VIDEO,P6),this._events.set(E.TRADE_ACCEPTED,m4),this._events.set(E.TRADE_CLOSED,I4),this._events.set(E.TRADE_COMPLETED,T4),this._events.set(E.TRADE_CONFIRMATION,R4),this._events.set(E.TRADE_LIST_ITEM,O4),this._events.set(E.TRADE_NOT_OPEN,A4),this._events.set(E.TRADE_OPEN_FAILED,y4),this._events.set(E.TRADE_OPEN,S4),this._events.set(E.TRADE_OTHER_NOT_ALLOWED,M4),this._events.set(E.TRADE_YOU_NOT_ALLOWED,C4),this._events.set(E.TRADE_NO_SUCH_ITEM,v4),this._events.set(E.COMMUNITY_GOAL_VOTE_EVENT,b4),this._events.set(E.PROMO_ARTICLES,N4),this._events.set(E.MARKETPLACE_AFTER_ORDER_STATUS,P4),this._events.set(E.MARKETPLACE_CANCEL_SALE,D4),this._events.set(E.MARKETPLACE_SELL_ITEM,L4),this._events.set(E.MARKETPLACE_CONFIG,U4),this._events.set(E.MARKETPLACE_ITEM_STATS,x4),this._events.set(E.MARKETPLACE_ITEM_POSTED,F4),this._events.set(E.MARKETPLACE_ITEMS_SEARCHED,w4),this._events.set(E.MARKETPLACE_OWN_ITEMS,G4),this._events.set(E.USER_BANNED,J4),this._events.set(E.MODERATION_CAUTION,z4),this._events.set(E.MODTOOL_ROOM_INFO,X4),this._events.set(E.MODTOOL_USER_CHATLOG,$4),this._events.set(E.MODTOOL_ROOM_CHATLOG,Q4),this._events.set(E.MODERATION_USER_INFO,q4),this._events.set(E.MODERATION_TOOL,Y4),this._events.set(E.MODTOOL_VISITED_ROOMS_USER,Z4),this._events.set(E.CFH_CHATLOG,B4),this._events.set(E.ISSUE_DELETED,H4),this._events.set(E.ISSUE_INFO,V4),this._events.set(E.ISSUE_PICK_FAILED,k4),this._events.set(E.MODERATOR_ACTION_RESULT,j4),this._events.set(E.MODERATOR_MESSAGE,W4),this._events.set(E.MODERATOR_TOOL_PREFERENCES,K4),this._events.set(E.MYSTERY_BOX_KEYS,Pv),this._events.set(E.GOTMYSTERYBOXPRIZEMESSAGE,eX),this._events.set(E.CANCELMYSTERYBOXWAITMESSAGE,tX),this._events.set(E.SHOWMYSTERYBOXWAITMESSAGE,sX),this._events.set(E.CAN_CREATE_ROOM,rX),this._events.set(E.CAN_CREATE_ROOM_EVENT,iX),this._events.set(E.CATEGORIES_WITH_VISITOR_COUNT,nX),this._events.set(E.COMPETITION_ROOMS_DATA,aX),this._events.set(E.CONVERTED_ROOM_ID,oX),this._events.set(E.ROOM_DOORBELL,Dv),this._events.set(E.USER_FAVORITE_ROOM,hX),this._events.set(E.USER_FAVORITE_ROOM_COUNT,uX),this._events.set(E.ROOM_DOORBELL_REJECTED,gf),this._events.set(E.ROOM_CREATED,lX),this._events.set(E.ROOM_INFO,Ef),this._events.set(E.GUEST_ROOM_SEARCH_RESULT,_X),this._events.set(E.USER_HOME_ROOM,dX),this._events.set(E.ROOM_EVENT_CANCEL,RX),this._events.set(E.ROOM_EVENT,OX),this._events.set(E.ROOM_INFO_UPDATED,AX),this._events.set(E.THUMBNAIL_UPDATE_RESULT,SX),this._events.set(E.NAVIGATOR_EVENT_CATEGORIES,yX),this._events.set(E.NAVIGATOR_CATEGORIES,MX),this._events.set(E.NAVIGATOR_COLLAPSED,cX),this._events.set(E.NAVIGATOR_LIFTED,fX),this._events.set(E.NAVIGATOR_METADATA,gX),this._events.set(E.NAVIGATOR_OPEN_ROOM_CREATOR,EX),this._events.set(E.NAVIGATOR_SEARCHES,pX),this._events.set(E.NAVIGATOR_SEARCH,mX),this._events.set(E.NAVIGATOR_SETTINGS,IX),this._events.set(E.GENERIC_ALERT,UX),this._events.set(E.ALERT_TOP,bX),this._events.set(E.MOTD_MESSAGES,FX),this._events.set(E.NOTIFICATION_LIST,wX),this._events.set(E.UNSEEN_ITEMS,HX),this._events.set(E.ACHIEVEMENT_NOTIFICATION,CX),this._events.set(E.INFO_FEED_ENABLE,xX),this._events.set(E.CLUB_GIFT_NOTIFICATION,PX),this._events.set(E.ACTIVITY_POINT_NOTIFICATION,NX),this._events.set(E.BOT_ERROR,Lv),this._events.set(E.PET_LEVEL_NOTIFICATION,GX),this._events.set(E.NOTIFICATION_SIMPLE_ALERT,BX),this._events.set(E.NOTIFICATION_ELEMENT_POINTER,LX),this._events.set(E.USER_PERKS,KX),this._events.set(E.PET_TRAINING_PANEL,QX),this._events.set(E.PET_LEVEL_UPDATE,wv),this._events.set(E.PET_SCRATCH_FAILED,Gv),this._events.set(E.PET_OPEN_PACKAGE_REQUESTED,xv),this._events.set(E.PET_OPEN_PACKAGE_RESULT,Fv),this._events.set(E.PET_BREEDING_RESULT,Xv),this._events.set(E.QUESTION,jv),this._events.set(E.POLL_CONTENTS,Bv),this._events.set(E.POLL_ERROR,Hv),this._events.set(E.POLL_OFFER,Vv),this._events.set(E.QUESTION_ANSWERED,kv),this._events.set(E.QUESTION_FINISHED,zv),this._events.set(E.COMMUNITY_GOAL_EARNED_PRIZES,ZX),this._events.set(E.COMMUNITY_GOAL_PROGRESS,$X),this._events.set(E.CONCURRENT_USERS_GOAL_PROGRESS,t6),this._events.set(E.QUEST_DAILY,i6),this._events.set(E.QUEST_CANCELLED,s6),this._events.set(E.QUEST_COMPLETED,r6),this._events.set(E.COMMUNITY_GOAL_HALL_OF_FAME,JX),this._events.set(E.EPIC_POPUP,e6),this._events.set(E.SEASONAL_QUESTS,o6),this._events.set(E.QUESTS,a6),this._events.set(E.QUEST,n6),this._events.set(E.ROOM_ENTER_ERROR,h6),this._events.set(E.ROOM_ENTER,Rf),this._events.set(E.ROOM_FORWARD,u6),this._events.set(E.ROOM_DOORBELL_ACCEPTED,pf),this._events.set(E.ROOM_RIGHTS_CLEAR,mf),this._events.set(E.ROOM_RIGHTS_OWNER,Tf),this._events.set(E.ROOM_RIGHTS,If),this._events.set(E.BOT_COMMAND_CONFIGURATION,l6),this._events.set(E.BOT_SKILL_LIST_UPDATE,c6),this._events.set(E.BOT_FORCE_OPEN_CONTEXT_MENU,_6),this._events.set(E.ROOM_SETTINGS_CHAT,d6),this._events.set(E.ROOM_INFO_OWNER,f6),this._events.set(E.ROOM_SCORE,g6),this._events.set(E.ROOM_ROLLING,vf),this._events.set(E.FURNITURE_FLOOR_ADD,Sf),this._events.set(E.FURNITURE_FLOOR,yf),this._events.set(E.FURNITURE_FLOOR_REMOVE,Mf),this._events.set(E.FURNITURE_FLOOR_UPDATE,Cf),this._events.set(E.ITEM_WALL_ADD,Lf),this._events.set(E.ITEM_WALL,Uf),this._events.set(E.ITEM_WALL_REMOVE,xf),this._events.set(E.ITEM_WALL_UPDATE,Ff),this._events.set(E.FURNITURE_ALIASES,Nf),this._events.set(E.FURNITURE_DATA,bf),this._events.set(E.FURNITURE_ITEMDATA,Pf),this._events.set(E.ITEM_STACK_HELPER,m6),this._events.set(E.FURNITURE_STATE,Df),this._events.set(E.ITEM_DIMMER_SETTINGS,Wv),this._events.set(E.FURNITURE_STATE_2,Af),this._events.set(E.LOVELOCK_FURNI_FINISHED,T6),this._events.set(E.LOVELOCK_FURNI_FRIEND_COMFIRMED,R6),this._events.set(E.LOVELOCK_FURNI_START,O6),this._events.set(E.OBJECTS_DATA_UPDATE,Of),this._events.set(E.FURNITURE_GROUP_CONTEXT_MENU_INFO,I6),this._events.set(E.FURNITURE_POSTIT_STICKY_POLE_OPEN,y6),this._events.set(E.ROOM_SPECTATOR,Jv),this._events.set(E.CUSTOM_USER_NOTIFICATION,E6),this._events.set(E.ROOM_MESSAGE_NOTIFICATION,M6),this._events.set(E.ROOM_POPULAR_TAGS_RESULT,TX),this._events.set(E.ROOM_RIGHTS_LIST,k6),this._events.set(E.ROOM_RIGHTS_LIST_ADD,H6),this._events.set(E.ROOM_RIGHTS_LIST_REMOVE,V6),this._events.set(E.ROOM_BAN_LIST,B6),this._events.set(E.ROOM_SETTINGS_SAVE_ERROR,K6),this._events.set(E.ROOM_SETTINGS,Y6),this._events.set(E.ROOM_SETTINGS_SAVE,X6),this._events.set(E.ROOM_SETTINGS_ERROR,W6),this._events.set(E.SHOW_ENFORCE_ROOM_CATEGORY,q6),this._events.set(E.ROOM_BAN_REMOVE,Q6),this._events.set(E.ROOM_MUTED,j6),this._events.set(E.NO_SUCH_FLAT,z6),this._events.set(E.FAVORITE_GROUP_UDPATE,Yv),this._events.set(E.ROOM_MODEL_DOOR,Gf),this._events.set(E.ROOM_HEIGHT_MAP,Bf),this._events.set(E.ROOM_HEIGHT_MAP_UPDATE,Hf),this._events.set(E.ROOM_MODEL,wf),this._events.set(E.ROOM_MODEL_NAME,Va),this._events.set(E.ROOM_PAINT,Vf),this._events.set(E.ROOM_THICKNESS,kf),this._events.set(E.ROOM_GET_FILTER_WORDS,vX),this._events.set(E.ROOM_MODEL_BLOCKED_TILES,D6),this._events.set(E.PET_FIGURE_UPDATE,bl),this._events.set(E.PET_INFO,qv),this._events.set(E.PET_STATUS,Qv),this._events.set(E.PET_EXPERIENCE,Kv),this._events.set(E.PLAYING_GAME,Zv),this._events.set(E.UNIT_DANCE,Ll),this._events.set(E.UNIT_EFFECT,zf),this._events.set(E.UNIT,Ul),this._events.set(E.UNIT_EXPRESSION,Yf),this._events.set(E.UNIT_HAND_ITEM,Wf),this._events.set(E.UNIT_IDLE,Xf),this._events.set(E.UNIT_INFO,xl),this._events.set(E.UNIT_NUMBER,Kf),this._events.set(E.UNIT_REMOVE,Fl),this._events.set(E.UNIT_STATUS,qf),this._events.set(E.HAND_ITEM_RECEIVED,eA),this._events.set(E.FLOOD_CONTROL,$v),this._events.set(E.REMAINING_MUTE,tA),this._events.set(E.UNIT_CHAT,_E),this._events.set(E.UNIT_CHAT_SHOUT,Pl),this._events.set(E.UNIT_CHAT_WHISPER,Dl),this._events.set(E.UNIT_TYPING,jf),this._events.set(E.WIRED_ACTION,L6),this._events.set(E.WIRED_CONDITION,U6),this._events.set(E.WIRED_TRIGGER,x6),this._events.set(E.WIRED_OPEN,F6),this._events.set(E.WIRED_REWARD,cE),this._events.set(E.WIRED_SAVE,w6),this._events.set(E.WIRED_ERROR,G6),this._events.set(E.AUTHENTICATED,sA),this._events.set(E.JUKEBOX_PLAYLIST_FULL,rA),this._events.set(E.JUKEBOX_SONG_DISKS,iA),this._events.set(E.NOW_PLAYING,nA),this._events.set(E.OFFICIAL_SONG_ID,Z6),this._events.set(E.PLAYLIST,J6),this._events.set(E.PLAYLIST_SONG_ADDED,$6),this._events.set(E.TRAX_SONG_INFO,aA),this._events.set(E.USER_SONG_DISKS_INVENTORY,oA),this._events.set(E.HELPER_TALENT_TRACK,s8),this._events.set(E.TALENT_TRACK_LEVEL,e8),this._events.set(E.TALENT_TRACK_LEVEL_UP,t8),this._events.set(E.IN_CLIENT_LINK,gA),this._events.set(E.USER_IGNORED,fA),this._events.set(E.USER_IGNORED_RESULT,fE),this._events.set(E.USER_RESPECT,mA),this._events.set(E.USER_PERMISSIONS,hA),this._events.set(E.USER_BADGES_CURRENT,lA),this._events.set(E.USER_INFO,wl),this._events.set(E.UNIT_CHANGE_NAME,dE),this._events.set(E.USER_SETTINGS,o8),this._events.set(E.USER_PROFILE,a8),this._events.set(E.MESSENGER_RELATIONSHIPS,n8),this._events.set(E.GIFT_OPENED,bv),this._events.set(E.USER_CREDITS,g8),this._events.set(E.USER_CURRENCY,E8),this._events.set(E.USER_SUBSCRIPTION,p8),this._events.set(E.USER_WARDROBE_PAGE,T8),this._events.set(E.USER_CLASSIFICATION,O8),this._events.set(E.GET_USER_TAGS,_A),this._events.set(E.SCR_SEND_KICKBACK_INFO,I8),this._events.set(E.PET_RESPECTED,EA),this._events.set(E.PET_SUPPLEMENT,pA),this._events.set(E.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE,uA),this._events.set(E.GENERIC_ERROR,ff),this._events.set(E.GROUP_LIST,d8),this._events.set(E.CATALOG_APPROVE_NAME_RESULT,r8),this._events.set(E.CONNECTION_ERROR,DX),this._events.set(E.GUILD_EDIT_FAILED,_8),this._events.set(E.GUILD_MEMBER_MGMT_FAILED,c8),this._events.set(E.EXTENDED_PROFILE_CHANGED,h8),this._events.set(E.NOOBNESS_LEVEL,Sv),this._events.set(E.DISCONNECT_REASON,RW),this._events.set(E.HANDSHAKE_INIT_DIFFIE,vW),this._events.set(E.HANDSHAKE_COMPLETE_DIFFIE,TW),this._events.set(E.HANDSHAKE_IDENTITY_ACCOUNT,OW),this._events.set(E.NEW_USER_EXPERIENCE_GIFT_OFFER,YX),this._events.set(E.NEW_USER_EXPERIENCE_NOT_COMPLETE,XX),this._events.set(E.PHONE_COLLECTION_STATE,eW),this._events.set(E.PHONE_TRY_NUMBER_RESULT,sW),this._events.set(E.PHONE_TRY_VERIFICATION_CODE_RESULT,rW),this._events.set(E.WELCOME_GIFT_CHANGE_EMAIL_RESULT,R8),this._events.set(E.WELCOME_GIFT_STATUS,C6),this._events.set(E.RENTABLE_SPACE_RENT_OK,A6),this._events.set(E.RENTABLE_SPACE_STATUS,S6),this._events.set(E.RENTABLE_SPACE_RENT_FAILED,v6),this._events.set(E.RECYCLER_STATUS,C_),this._events.set(E.RECYCLER_FINISHED,lE),this._events.set(E.EMAIL_STATUS,cA),this._events.set(E.CHANGE_EMAIL_RESULT,i8),this._events.set(E.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER,p6)}registerComposers(){this._composers.set(g.AUTHENTICATION,q7),this._composers.set(g.INTERSTITIAL_SHOWN,A8),this._composers.set(g.GET_INTERSTITIAL,v8),this._composers.set(g.GET_WARDROBE,C8),this._composers.set(g.SAVE_WARDROBE_OUTFIT,N8),this._composers.set(g.CHANGE_USERNAME,y8),this._composers.set(g.CHECK_USERNAME,M8),this._composers.set(g.REQUEST_CAMERA_CONFIGURATION,U8),this._composers.set(g.RENDER_ROOM,Gl),this._composers.set(g.RENDER_ROOM_THUMBNAIL,Qf),this._composers.set(g.PURCHASE_PHOTO,D8),this._composers.set(g.PURCHASE_PHOTO_XXL,L8),this._composers.set(g.PUBLISH_PHOTO,P8),this._composers.set(g.PHOTO_COMPETITION,b8),this._composers.set(g.OPEN_CAMPAIGN_CALENDAR_DOOR,F8),this._composers.set(g.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,x8),this._composers.set(g.BUILDERS_CLUB_PLACE_ROOM_ITEM,w8),this._composers.set(g.BUILDERS_CLUB_PLACE_WALL_ITEM,G8),this._composers.set(g.BUILDERS_CLUB_QUERY_FURNI_COUNT,B8),this._composers.set(g.GET_CATALOG_INDEX,k8),this._composers.set(g.GET_CATALOG_PAGE,j8),this._composers.set(g.CATALOG_PURCHASE,uK),this._composers.set(g.CATALOG_PURCHASE_GIFT,hK),this._composers.set(g.GET_PRODUCT_OFFER,eK),this._composers.set(g.GET_CLUB_OFFERS,X8),this._composers.set(g.GET_CLUB_GIFT_INFO,W8),this._composers.set(g.CATALOG_REDEEM_VOUCHER,dK),this._composers.set(g.GROUP_MEMBERSHIPS,YZ),this._composers.set(g.GET_GIFT_WRAPPING_CONFIG,q8),this._composers.set(g.CATALOG_SELECT_VIP_GIFT,gK),this._composers.set(g.CATALOG_REQUESET_PET_BREEDS,iK),this._composers.set(g.GET_BONUS_RARE_INFO,H8),this._composers.set(g.GET_BUNDLE_DISCOUNT_RULESET,V8),this._composers.set(g.GET_CATALOG_PAGE_EXPIRATION,z8),this._composers.set(g.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,Y8),this._composers.set(g.GET_DIRECT_CLUB_BUY_AVAILABLE,K8),this._composers.set(g.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,Q8),this._composers.set(g.GET_HABBO_CLUB_EXTEND_OFFER,Z8),this._composers.set(g.GET_IS_OFFER_GIFTABLE,J8),this._composers.set(g.GET_LIMITED_OFFER_APPEARING_NEXT,$8),this._composers.set(g.GET_NEXT_TARGETED_OFFER,tK),this._composers.set(g.GET_ROOM_AD_PURCHASE_INFO,sK),this._composers.set(g.GET_SEASONAL_CALENDAR_DAILY_OFFER,rK),this._composers.set(g.GET_TARGETED_OFFER,nK),this._composers.set(g.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,aK),this._composers.set(g.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,oK),this._composers.set(g.PURCHASE_ROOM_AD,lK),this._composers.set(g.PURCHASE_TARGETED_OFFER,_K),this._composers.set(g.PURCHASE_VIP_MEMBERSHIP_EXTENSION,cK),this._composers.set(g.ROOM_AD_PURCHASE_INITIATED,fK),this._composers.set(g.SET_TARGETTED_OFFER_STATE,EK),this._composers.set(g.SHOP_TARGETED_OFFER_VIEWED,pK),this._composers.set(g.FORWARD_TO_A_COMPETITION_ROOM,mK),this._composers.set(g.FORWARD_TO_A_SUBMITTABLE_ROOM,IK),this._composers.set(g.FORWARD_TO_RANDOM_COMPETITION_ROOM,TK),this._composers.set(g.GET_CURRENT_TIMING_CODE,RK),this._composers.set(g.GET_IS_USER_PART_OF_COMPETITION,OK),this._composers.set(g.GET_SECONDS_UNTIL,vK),this._composers.set(g.ROOM_COMPETITION_INIT,AK),this._composers.set(g.SUBMIT_ROOM_TO_COMPETITION,Wh),this._composers.set(g.VOTE_FOR_ROOM,SK),this._composers.set(g.CRAFT,yK),this._composers.set(g.CRAFT_SECRET,MK),this._composers.set(g.GET_CRAFTABLE_PRODUCTS,NK),this._composers.set(g.GET_CRAFTING_RECIPE,CK),this._composers.set(g.GET_CRAFTING_RECIPES_AVAILABLE,bK),this._composers.set(g.FRIEND_FURNI_CONFIRM_LOCK,DK),this._composers.set(g.ACCEPT_FRIEND,LK),this._composers.set(g.DECLINE_FRIEND,UK),this._composers.set(g.FIND_NEW_FRIENDS,xK),this._composers.set(g.FOLLOW_FRIEND,FK),this._composers.set(g.FRIEND_LIST_UPDATE,wK),this._composers.set(g.GET_FRIEND_REQUESTS,GK),this._composers.set(g.HABBO_SEARCH,BK),this._composers.set(g.MESSENGER_INIT,HK),this._composers.set(g.REMOVE_FRIEND,VK),this._composers.set(g.REQUEST_FRIEND,kK),this._composers.set(g.MESSENGER_CHAT,jK),this._composers.set(g.SEND_ROOM_INVITE,zK),this._composers.set(g.SET_RELATIONSHIP_STATUS,YK),this._composers.set(g.VISIT_USER,WK),this._composers.set(g.ACHIEVEMENT_RESOLUTION_OPEN,IA),this._composers.set(g.ACCEPTGAMEINVITE,t7),this._composers.set(g.GAMEUNLOADEDMESSAGE,e7),this._composers.set(g.GETGAMEACHIEVEMENTSMESSAGE,s7),this._composers.set(g.GAMES_LIST,r7),this._composers.set(g.GETGAMESTATUSMESSAGE,i7),this._composers.set(g.GETUSERGAMEACHIEVEMENTSMESSAGE,n7),this._composers.set(g.JOINQUEUEMESSAGE,a7),this._composers.set(g.LEAVEQUEUEMESSAGE,o7),this._composers.set(g.RESETRESOLUTIONACHIEVEMENTMESSAGE,h7),this._composers.set(g.GAMES_INIT,_7),this._composers.set(g.GETWEEKLYGAMEREWARDWINNERS,c7),this._composers.set(g.GAME2GETACCOUNTGAMESTATUSMESSAGE,JK),this._composers.set(g.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE,ZK),this._composers.set(g.GAME2EXITGAMEMESSAGE,XK),this._composers.set(g.GAME2GAMECHATMESSAGE,KK),this._composers.set(g.GAME2LOADSTAGEREADYMESSAGE,qK),this._composers.set(g.GAME2PLAYAGAINMESSAGE,QK),this._composers.set(g.GAME2REQUESTFULLSTATUSUPDATEMESSAGE,$K),this._composers.set(g.GAME2GETWEEKLYFRIENDSLEADERBOARD,u7),this._composers.set(g.GAME2GETWEEKLYLEADERBOARD,l7),this._composers.set(g.GET_GIFT,TA),this._composers.set(g.RESET_PHONE_NUMBER_STATE,d7),this._composers.set(g.SET_PHONE_NUMBER_VERIFICATION_STATUS,RA),this._composers.set(g.TRY_PHONE_NUMBER,f7),this._composers.set(g.VERIFY_CODE,g7),this._composers.set(g.GET_FORUM_STATS,G7),this._composers.set(g.GET_FORUMS_LIST,w7),this._composers.set(g.GET_FORUM_MESSAGES,B7),this._composers.set(g.GET_FORUM_THREAD,H7),this._composers.set(g.GET_FORUM_THREADS,V7),this._composers.set(g.GET_UNREAD_FORUMS_COUNT,k7),this._composers.set(g.FORUM_MODERATE_MESSAGE,j7),this._composers.set(g.FORUM_MODERATE_THREAD,z7),this._composers.set(g.FORUM_POST_MESSAGE,Y7),this._composers.set(g.UPDATE_FORUM_READ_MARKER,W7),this._composers.set(g.UPDATE_FORUM_SETTINGS,X7),this._composers.set(g.FORUM_UPDATE_THREAD,K7),this._composers.set(g.CLIENT_PONG,AA),this._composers.set(g.RELEASE_VERSION,OA),this._composers.set(g.SECURITY_TICKET,SA),this._composers.set(g.USER_INFO,vA),this._composers.set(g.DISCONNECT,Z7),this._composers.set(g.SECURITY_MACHINE,$7),this._composers.set(g.CLIENT_VARIABLES,t9),this._composers.set(g.HANDSHAKE_INIT_DIFFIE,J7),this._composers.set(g.HANDSHAKE_COMPLETE_DIFFIE,Q7),this._composers.set(g.CALL_FOR_HELP_FROM_FORUM_MESSAGE,e9),this._composers.set(g.CALL_FOR_HELP_FROM_FORUM_THREAD,s9),this._composers.set(g.CALL_FOR_HELP_FROM_IM,r9),this._composers.set(g.CALL_FOR_HELP_FROM_PHOTO,i9),this._composers.set(g.CALL_FOR_HELP_FROM_SELFIE,n9),this._composers.set(g.CALL_FOR_HELP,a9),this._composers.set(g.CHAT_REVIEW_GUIDE_DECIDES,o9),this._composers.set(g.CHAT_REVIEW_GUIDE_DETACHED,h9),this._composers.set(g.CHAT_REVIEW_GUIDE_VOTE,u9),this._composers.set(g.CHAT_REVIEW_SESSION_CREATE,l9),this._composers.set(g.DELETE_PENDING_CALLS_FOR_HELP,_9),this._composers.set(g.GET_CFH_STATUS,c9),this._composers.set(g.GET_FAQ_CATEGORY,d9),this._composers.set(g.GET_FAQ_TEXT,f9),this._composers.set(g.GET_GUIDE_REPORTING_STATUS,g9),this._composers.set(g.GET_PENDING_CALLS_FOR_HELP,E9),this._composers.set(g.GET_QUIZ_QUESTIONS,p9),this._composers.set(g.GUIDE_SESSION_CREATE,m9),this._composers.set(g.GUIDE_SESSION_FEEDBACK,I9),this._composers.set(g.GUIDE_SESSION_GET_REQUESTER_ROOM,T9),this._composers.set(g.GUIDE_SESSION_GUIDE_DECIDES,R9),this._composers.set(g.GUIDE_SESSION_INVITE_REQUESTER,O9),this._composers.set(g.GUIDE_SESSION_IS_TYPING,v9),this._composers.set(g.GUIDE_SESSION_MESSAGE,A9),this._composers.set(g.GUIDE_SESSION_ON_DUTY_UPDATE,S9),this._composers.set(g.GUIDE_SESSION_REPORT,y9),this._composers.set(g.GUIDE_SESSION_REQUESTER_CANCELS,M9),this._composers.set(g.GUIDE_SESSION_RESOLVED,C9),this._composers.set(g.POST_QUIZ_ANSWERS,N9),this._composers.set(g.SEARCH_FAQS,b9),this._composers.set(g.DESKTOP_VIEW,PK),this._composers.set(g.GROUP_INFO,S7),this._composers.set(g.GROUP_REQUEST,y7),this._composers.set(g.GROUP_MEMBER_REMOVE_CONFIRM,O7),this._composers.set(g.GROUP_MEMBER_REMOVE,b7),this._composers.set(g.GROUP_MEMBERS,M7),this._composers.set(g.GROUP_ADMIN_ADD,p7),this._composers.set(g.GROUP_ADMIN_REMOVE,m7),this._composers.set(g.GROUP_REQUEST_ACCEPT,C7),this._composers.set(g.GROUP_REQUEST_DECLINE,N7),this._composers.set(g.GROUP_DELETE,v7),this._composers.set(g.GROUP_CREATE_OPTIONS,R7),this._composers.set(g.GROUP_PARTS,I7),this._composers.set(g.GROUP_BUY,T7),this._composers.set(g.GROUP_SETTINGS,x7),this._composers.set(g.GROUP_SAVE_BADGE,P7),this._composers.set(g.GROUP_SAVE_COLORS,D7),this._composers.set(g.GROUP_SAVE_INFORMATION,L7),this._composers.set(g.GROUP_SAVE_PREFERENCES,U7),this._composers.set(g.GROUP_FAVORITE,A7),this._composers.set(g.GROUP_UNFAVORITE,F7),this._composers.set(g.GROUP_BADGES,YS),this._composers.set(g.APPROVE_ALL_MEMBERSHIP_REQUESTS,E7),this._composers.set(g.GROUP_UNBLOCK_MEMBER,nJ),this._composers.set(g.ROOM_FAVORITE,bq),this._composers.set(g.CAN_CREATE_ROOM,Pq),this._composers.set(g.CANCEL_ROOM_EVENT,Dq),this._composers.set(g.CONVERT_GLOBAL_ROOM_ID,Uq),this._composers.set(g.COMPETITION_ROOM_SEARCH,Lq),this._composers.set(g.ROOM_CREATE,xq),this._composers.set(g.GET_USER_FLAT_CATS,Wq),this._composers.set(g.GET_USER_EVENT_CATS,Yq),this._composers.set(g.ROOM_FAVORITE_REMOVE,Fq),this._composers.set(g.EDIT_ROOM_EVENT,wq),this._composers.set(g.FORWARD_TO_RANDOM_PROMOTED_ROOM,Gq),this._composers.set(g.FORWARD_TO_SOME_ROOM,Bq),this._composers.set(g.GET_CATEGORIES_WITH_USER_COUNT,Hq),this._composers.set(g.GET_GUEST_ROOM,kq),this._composers.set(g.GET_OFFICIAL_ROOMS,jq),this._composers.set(g.GET_POPULAR_ROOM_TAGS,zq),this._composers.set(g.GUILD_BASE_SEARCH,Xq),this._composers.set(g.MY_FAVOURITE_ROOMS_SEARCH,Kq),this._composers.set(g.MY_FREQUENT_ROOM_HISTORY_SEARCH,qq),this._composers.set(g.MY_FRIENDS_ROOM_SEARCH,Qq),this._composers.set(g.MY_GUILD_BASES_SEARCH,Zq),this._composers.set(g.MY_RECOMMENDED_ROOMS,Jq),this._composers.set(g.MY_ROOM_HISTORY_SEARCH,$q),this._composers.set(g.MY_ROOM_RIGHTS_SEARCH,tQ),this._composers.set(g.MY_ROOMS_SEARCH,eQ),this._composers.set(g.POPULAR_ROOMS_SEARCH,lQ),this._composers.set(g.ROOM_LIKE,_Q),this._composers.set(g.ROOM_RIGHTS_REMOVE_OWN,cQ),this._composers.set(g.ROOM_AD_EVENT_TAB_CLICKED,dQ),this._composers.set(g.ROOM_AD_EVENT_TAB_VIEWED,fQ),this._composers.set(g.ROOM_AD_SEARCH,gQ),this._composers.set(g.ROOM_TEXT_SEARCH,EQ),this._composers.set(g.ROOMS_WHERE_MY_FRIENDS_ARE,pQ),this._composers.set(g.ROOMS_WITH_HIGHEST_SCORE_SEARCH,mQ),this._composers.set(g.SET_ROOM_SESSION_TAGS,IQ),this._composers.set(g.ROOM_STAFF_PICK,RQ),this._composers.set(g.ROOM_FILTER_WORDS,Vq),this._composers.set(g.ROOM_FILTER_WORDS_MODIFY,vQ),this._composers.set(g.USER_HOME_ROOM,OQ),this._composers.set(g.UPDATE_ROOM_THUMBNAIL,AQ),this._composers.set(g.SET_WELCOME_ROOM,TQ),this._composers.set(g.NAVIGATOR_INIT,iQ),this._composers.set(g.NAVIGATOR_SEARCH_CLOSE,nQ),this._composers.set(g.NAVIGATOR_SEARCH,aQ),this._composers.set(g.NAVIGATOR_SEARCH_OPEN,oQ),this._composers.set(g.NAVIGATOR_SEARCH_SAVE,hQ),this._composers.set(g.NAVIGATOR_SETTINGS_SAVE,uQ),this._composers.set(g.NAVIGATOR_CATEGORY_LIST_MODE,sQ),this._composers.set(g.NAVIGATOR_DELETE_SAVED_SEARCH,rQ),this._composers.set(g.POLL_ANSWER,FA),this._composers.set(g.POLL_REJECT,wA),this._composers.set(g.POLL_START,GA),this._composers.set(g.USER_EFFECT_ACTIVATE,P9),this._composers.set(g.USER_EFFECT_ENABLE,D9),this._composers.set(g.USER_BADGES,F9),this._composers.set(g.USER_BADGES_CURRENT_UPDATE,w9),this._composers.set(g.GET_BADGE_POINTS_LIMITS,L9),this._composers.set(g.REQUESTABADGE,x9),this._composers.set(g.GETISBADGEREQUESTFULFILLED,U9),this._composers.set(g.USER_BOTS,cI),this._composers.set(g.USER_FURNITURE,G9),this._composers.set(g.REQUESTFURNIINVENTORYWHENNOTINROOM,B9),this._composers.set(g.USER_PETS,dI),this._composers.set(g.TRADE_ACCEPT,k9),this._composers.set(g.TRADE_CANCEL,j9),this._composers.set(g.TRADE_CLOSE,z9),this._composers.set(g.TRADE_CONFIRM,Y9),this._composers.set(g.TRADE_ITEM,W9),this._composers.set(g.TRADE_ITEMS,X9),this._composers.set(g.TRADE_ITEM_REMOVE,K9),this._composers.set(g.TRADE,q9),this._composers.set(g.TRADE_UNACCEPT,Q9),this._composers.set(g.UNSEEN_RESET_CATEGORY,Z9),this._composers.set(g.UNSEEN_RESET_ITEMS,J9),this._composers.set(g.ACHIEVEMENT_LIST,S8),this._composers.set(g.PET_MOUNT,Zf),this._composers.set(g.PET_RESPECT,bA),this._composers.set(g.PET_SUPPLEMENT,yQ),this._composers.set(g.REMOVE_PET_SADDLE,PA),this._composers.set(g.PET_INFO,DA),this._composers.set(g.TOGGLE_PET_BREEDING,LA),this._composers.set(g.TOGGLE_PET_RIDING,UA),this._composers.set(g.USE_PET_PRODUCT,xA),this._composers.set(g.GET_PET_TRAINING_PANEL,NA),this._composers.set(g.PET_OPEN_PACKAGE,IS),this._composers.set(g.PET_SELECTED,yZ),this._composers.set(g.PETS_BREED,b_),this._composers.set(g.PET_CANCEL_BREEDING,H9),this._composers.set(g.PET_CONFIRM_BREEDING,V9),this._composers.set(g.ROOM_ENTER,HA),this._composers.set(g.ROOM_DOORBELL,BA),this._composers.set(g.GO_TO_FLAT,vS),this._composers.set(g.CHANGE_QUEUE,OS),this._composers.set(g.ROOM_AMBASSADOR_ALERT,VA),this._composers.set(g.ROOM_BAN_GIVE,kA),this._composers.set(g.ROOM_BAN_REMOVE,XQ),this._composers.set(g.ROOM_RIGHTS_GIVE,jA),this._composers.set(g.ROOM_KICK,zA),this._composers.set(g.ROOM_MUTE_USER,YA),this._composers.set(g.ROOM_RIGHTS_REMOVE,WA),this._composers.set(g.ROOM_RIGHTS_REMOVE_ALL,YQ),this._composers.set(g.ROOM_DELETE,WQ),this._composers.set(g.ROOM_SETTINGS,QQ),this._composers.set(g.ROOM_SETTINGS_SAVE,JQ),this._composers.set(g.ROOM_RIGHTS_LIST,ZQ),this._composers.set(g.ROOM_BAN_LIST,qQ),this._composers.set(g.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE,UZ),this._composers.set(g.BOT_CONFIGURATION,KQ),this._composers.set(g.GET_ITEM_DATA,ZA),this._composers.set(g.REMOVE_WALL_ITEM,eS),this._composers.set(g.BOT_PLACE,XA),this._composers.set(g.BOT_PICKUP,KA),this._composers.set(g.BOT_SKILL_SAVE,$Q),this._composers.set(g.PET_PLACE,$A),this._composers.set(g.PET_MOVE,Jf),this._composers.set(g.PET_PICKUP,tS),this._composers.set(g.SET_ITEM_DATA,rS),this._composers.set(g.SET_OBJECT_DATA,iS),this._composers.set(g.COMPOST_PLANT,QA),this._composers.set(g.HARVEST_PET,JA),this._composers.set(g.SET_CLOTHING_CHANGE_DATA,sS),this._composers.set(g.FURNITURE_ALIASES,hS),this._composers.set(g.FURNITURE_GROUP_INFO,uS),this._composers.set(g.FURNITURE_PICKUP,lS),this._composers.set(g.FURNITURE_PLACE,_S),this._composers.set(g.ITEM_PAINT,rZ),this._composers.set(g.FURNITURE_POSTIT_PLACE,cS),this._composers.set(g.FURNITURE_POSTIT_SAVE_STICKY_POLE,tZ),this._composers.set(g.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,gZ),this._composers.set(g.GET_YOUTUBE_DISPLAY_STATUS,EZ),this._composers.set(g.SET_YOUTUBE_DISPLAY_PLAYLIST,pZ),this._composers.set(g.FURNITURE_FLOOR_UPDATE,$f),this._composers.set(g.FURNITURE_WALL_UPDATE,RS),this._composers.set(g.ITEM_DIMMER_SETTINGS,nS),this._composers.set(g.ITEM_DIMMER_SAVE,aS),this._composers.set(g.ITEM_DIMMER_TOGGLE,oS),this._composers.set(g.ROOM_TONER_APPLY,fZ),this._composers.set(g.ITEM_COLOR_WHEEL_CLICK,dS),this._composers.set(g.ITEM_DICE_CLICK,fS),this._composers.set(g.ITEM_DICE_CLOSE,gS),this._composers.set(g.FURNITURE_MULTISTATE,gE),this._composers.set(g.FURNITURE_RANDOMSTATE,pS),this._composers.set(g.ITEM_STACK_HELPER,aZ),this._composers.set(g.FURNITURE_WALL_MULTISTATE,mS),this._composers.set(g.ONE_WAY_DOOR_CLICK,ES),this._composers.set(g.ITEM_EXCHANGE_REDEEM,nZ),this._composers.set(g.ITEM_CLOTHING_REDEEM,RZ),this._composers.set(g.ROOM_MODEL,tg),this._composers.set(g.GET_OCCUPIED_TILES,mZ),this._composers.set(g.GET_ROOM_ENTRY_TILE,IZ),this._composers.set(g.ROOM_MODEL_SAVE,TZ),this._composers.set(g.UNIT_ACTION,CS),this._composers.set(g.UNIT_DANCE,NS),this._composers.set(g.UNIT_DROP_HAND_ITEM,vZ),this._composers.set(g.UNIT_GIVE_HANDITEM,AZ),this._composers.set(g.UNIT_GIVE_HANDITEM_PET,SZ),this._composers.set(g.UNIT_LOOK,bS),this._composers.set(g.UNIT_SIGN,DS),this._composers.set(g.UNIT_POSTURE,PS),this._composers.set(g.UNIT_WALK,LS),this._composers.set(g.UNIT_CHAT,EE),this._composers.set(g.UNIT_CHAT_SHOUT,AS),this._composers.set(g.USER_SETTINGS_CHAT_STYLE,OZ),this._composers.set(g.UNIT_CHAT_WHISPER,SS),this._composers.set(g.UNIT_TYPING,yS),this._composers.set(g.UNIT_TYPING_STOP,MS),this._composers.set(g.WIRED_APPLY_SNAPSHOT,CZ),this._composers.set(g.WIRED_OPEN,NZ),this._composers.set(g.WIRED_ACTION_SAVE,PZ),this._composers.set(g.WIRED_CONDITION_SAVE,DZ),this._composers.set(g.WIRED_TRIGGER_SAVE,LZ),this._composers.set(g.ROOM_MUTE,bZ),this._composers.set(g.APPROVE_NAME,zZ),this._composers.set(g.USER_RESPECT,WS),this._composers.set(g.SCR_GET_KICKBACK_INFO,tJ),this._composers.set(g.PEER_USERS_CLASSIFICATION,XS),this._composers.set(g.USER_CLASSIFICATION,KS),this._composers.set(g.USER_IGNORED,GS),this._composers.set(g.USER_IGNORE,HS),this._composers.set(g.USER_IGNORE_ID,VS),this._composers.set(g.USER_UNIGNORE,kS),this._composers.set(g.USER_BADGES_CURRENT,jS),this._composers.set(g.USER_FIGURE,KZ),this._composers.set(g.USER_MOTTO,zS),this._composers.set(g.USER_PROFILE,qZ),this._composers.set(g.USER_PROFILE_BY_NAME,XZ),this._composers.set(g.USER_TAGS,BS),this._composers.set(g.MESSENGER_RELATIONSHIPS,QZ),this._composers.set(g.MANNEQUIN_SAVE_NAME,hZ),this._composers.set(g.MANNEQUIN_SAVE_LOOK,oZ),this._composers.set(g.PRESENT_OPEN_PRESENT,TS),this._composers.set(g.MARKETPLACE_CONFIG,nq),this._composers.set(g.MARKETPLACE_SELL_ITEM,uq),this._composers.set(g.MARKETPLACE_REQUEST_OWN_ITEMS,hq),this._composers.set(g.MARKETPLACE_TAKE_BACK_ITEM,rq),this._composers.set(g.MARKETPLACE_REQUEST_OFFERS,oq),this._composers.set(g.MARKETPLACE_BUY_OFFER,eq),this._composers.set(g.MARKETPLACE_REDEEM_CREDITS,lq),this._composers.set(g.MARKETPLACE_BUY_TOKENS,sq),this._composers.set(g.REQUEST_SELL_ITEM,iq),this._composers.set(g.REQUEST_MARKETPLACE_ITEM_STATS,aq),this._composers.set(g.USER_BOTS,cI),this._composers.set(g.USER_PETS,dI),this._composers.set(g.USER_CURRENCY,JZ),this._composers.set(g.USER_SUBSCRIPTION,$Z),this._composers.set(g.MODTOOL_REQUEST_ROOM_INFO,fq),this._composers.set(g.MODTOOL_CHANGE_ROOM_SETTINGS,Tq),this._composers.set(g.MODTOOL_REQUEST_USER_CHATLOG,mq),this._composers.set(g.MODTOOL_REQUEST_ROOM_CHATLOG,Eq),this._composers.set(g.MOD_TOOL_USER_INFO,gq),this._composers.set(g.MODTOOL_SANCTION_ALERT,Iq),this._composers.set(g.MODTOOL_SANCTION_BAN,Yn),this._composers.set(g.MODTOOL_SANCTION_KICK,Rq),this._composers.set(g.MODTOOL_SANCTION_TRADELOCK,yq),this._composers.set(g.MODTOOL_ALERTEVENT,Oq),this._composers.set(g.MODTOOL_SANCTION_MUTE,vq),this._composers.set(g.MODTOOL_REQUEST_USER_ROOMS,pq),this._composers.set(g.MODTOOL_ROOM_ALERT,Xh),this._composers.set(g.CLOSE_ISSUE_DEFAULT_ACTION,_q),this._composers.set(g.CLOSE_ISSUES,N_),this._composers.set(g.DEFAULT_SANCTION,cq),this._composers.set(g.GET_CFH_CHATLOG,dq),this._composers.set(g.MODTOOL_PREFERENCES,Aq),this._composers.set(g.MODTOOL_SANCTION,Sq),this._composers.set(g.PICK_ISSUES,Mq),this._composers.set(g.RELEASE_ISSUES,Cq),this._composers.set(g.MYSTERYBOXWAITINGCANCELEDMESSAGE,Nq),this._composers.set(g.MYSTERYBOX_OPEN_TROPHY,uZ),this._composers.set(g.USER_SETTINGS_CAMERA,eJ),this._composers.set(g.USER_SETTINGS_OLD_CHAT,sJ),this._composers.set(g.USER_SETTINGS_INVITES,rJ),this._composers.set(g.USER_SETTINGS_VOLUME,iJ),this._composers.set(g.COMMUNITY_GOAL_VOTE_COMPOSER,tq),this._composers.set(g.GET_PROMO_ARTICLES,$9),this._composers.set(g.ACCEPT_QUEST,MQ),this._composers.set(g.ACTIVATE_QUEST,CQ),this._composers.set(g.CANCEL_QUEST,NQ),this._composers.set(g.FRIEND_REQUEST_QUEST_COMPLETE,bQ),this._composers.set(g.GET_COMMUNITY_GOAL_EARNED_PRIZES,PQ),this._composers.set(g.GET_COMMUNITY_GOAL_HALL_OF_FAME,DQ),this._composers.set(g.GET_COMMUNITY_GOAL_PROGRESS,LQ),this._composers.set(g.GET_CONCURRENT_USERS_GOAL_PROGRESS,UQ),this._composers.set(g.GET_CONCURRENT_USERS_REWARD,xQ),this._composers.set(g.GET_DAILY_QUEST,FQ),this._composers.set(g.GET_QUESTS,wQ),this._composers.set(g.GET_SEASONAL_QUESTS_ONLY,GQ),this._composers.set(g.OPEN_QUEST_TRACKER,BQ),this._composers.set(g.REDEEM_COMMUNITY_GOAL_PRIZE,HQ),this._composers.set(g.REJECT_QUEST,VQ),this._composers.set(g.START_CAMPAIGN,kQ),this._composers.set(g.GET_SOUND_SETTINGS,GZ),this._composers.set(g.ADD_JUKEBOX_DISK,xZ),this._composers.set(g.GET_JUKEBOX_PLAYLIST,US),this._composers.set(g.GET_NOW_PLAYING,xS),this._composers.set(g.GET_OFFICIAL_SONG_ID,FZ),this._composers.set(g.GET_SONG_INFO,FS),this._composers.set(g.GET_SOUND_MACHINE_PLAYLIST,wZ),this._composers.set(g.GET_USER_SONG_DISKS,wS),this._composers.set(g.REMOVE_JUKEBOX_DISK,BZ),this._composers.set(g.HELPER_TALENT_TRACK,VZ),this._composers.set(g.TALENT_TRACK_GET_LEVEL,HZ),this._composers.set(g.NEW_USER_EXPERIENCE_GET_GIFTS,SQ),this._composers.set(g.NEW_USER_EXPERIENCE_SCRIPT_PROCEED,CA),this._composers.set(g.WELCOME_OPEN_GIFT,lZ),this._composers.set(g.WELCOME_GIFT_CHANGE_EMAIL,aJ),this._composers.set(g.EMAIL_GET_STATUS,ZZ),this._composers.set(g.EMAIL_CHANGE,WZ),this._composers.set(g.RENTABLE_SPACE_CANCEL_RENT,_Z),this._composers.set(g.RENTABLE_SPACE_RENT,cZ),this._composers.set(g.RENTABLE_SPACE_STATUS,dZ),this._composers.set(g.RECYCLER_STATUS,jQ),this._composers.set(g.RECYCLER_ITEMS,zQ),this._composers.set(g.TRACKING_PERFORMANCE_LOG,jZ),this._composers.set(g.TRACKING_LAG_WARNING_REPORT,kZ),this._composers.set(g.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION,MZ),this._composers.set(g.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM,sZ),this._composers.set(g.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI,eZ),this._composers.set(g.RENTABLE_GET_RENT_OR_BUYOUT_OFFER,iZ)}get events(){return this._events}get composers(){return this._composers}}class uJ extends Rr{constructor(t){super(),this._communication=t,this._connection=null,this._messages=new hJ,this._demo=new oJ(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(Q.instance.events.addEventListener(ke.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(Te.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(Te.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(Te.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),this._connection.init(at.getValue("socket.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(Te.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(Te.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(Te.CONNECTION_ERROR,this.onConnectionErrorEvent)),Q.instance.events.removeEventListener(ke.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(t){Y.log("Connection Initialized")}onConnectionClosedEvent(t){Y.log("Connection Closed")}onConnectionErrorEvent(t){Y.log("Connection Error")}onConnectionAuthenticatedEvent(t){Y.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(t){Y.log("Initializing Connection",t)}registerMessageEvent(t){return this._connection&&this._connection.addMessageEvent(t),t}removeMessageEvent(t){this._connection&&this._connection.removeMessageEvent(t)}get demo(){return this._demo}get connection(){return this._connection}}const pE=class tl{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",t=>{if(typeof t.data=="string"&&t.data.startsWith(tl.MESSAGE_KEY)){const{method:e,params:s}=JSON.parse(t.data.substr(tl.MESSAGE_KEY.length)),i=window[e];if(!i)return;i(...s);return}})),!0}static call(t,...e){if(window.top!==window&&window.top.postMessage(tl.MESSAGE_KEY+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalInterface"in window))return;const s=window.FlashExternalInterface[t];return typeof s<"u"?s(...e):void 0}static callGame(t,...e){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalGameInterface"in window))return;const s=window.FlashExternalGameInterface[t];return typeof s<"u"?s(...e):void 0}static addCallback(t,e){window[t]=e}};pE.MESSAGE_KEY="Nitro_LegacyExternalInterface";pE._isListeningForPostMessages=!1;let Ot=pE;class lJ{constructor(t){t.addMessageEvent(new vv(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(t){if(!t)return;const e=t.getParser();e&&Ot.callGame("showGame",e.url)}}class Wc{constructor(t){this._badgeId="",this._level=1,this._base="",this._badgeId=t,this.parseText()}parseText(){let t=this._badgeId.length-1;for(;t>0&&this.isNumber(this._badgeId.charAt(t));)t--;this._base=this._badgeId.substr(0,t+1);const e=this._badgeId.substr(t+1,this._badgeId.length);e&&e!==""&&(this._level=Number.parseInt(e))}isNumber(t){const e=t.charCodeAt(0);return e>=48&&e<=57}get level(){return this._level}set level(t){this._level=Math.max(1,t)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class _J extends Rr{constructor(t){super(),this._communication=t,this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"],this._pendingUrls=[]}onInit(){this._communication.registerMessageEvent(new Nv(this.onBadgePointLimitsEvent.bind(this)));let t=at.getValue("external.texts.url");Array.isArray(t)||(t=[at.getValue("external.texts.url")]);for(let e=0;e<t.length;e++)t[e]=at.interpolate(t[e]);this._pendingUrls=t,this.loadNextLocalization()}loadNextLocalization(){if(!this._pendingUrls.length){this.events&&this.events.dispatchEvent(new Oa(Oa.LOADED));return}this.loadLocalizationFromURL(this._pendingUrls[0])}loadLocalizationFromURL(t){fetch(t).then(e=>e.json()).then(e=>this.onLocalizationLoaded(e,t)).catch(e=>this.onLocalizationFailed(e))}onLocalizationLoaded(t,e){if(!t)return;if(!this.parseLocalization(t))throw new Error(`Invalid json data for file ${e}`);const s=this._pendingUrls.indexOf(e);s>=0&&this._pendingUrls.splice(s,1),this.loadNextLocalization()}onLocalizationFailed(t){this.events&&this.events.dispatchEvent(new Oa(Oa.FAILED))}parseLocalization(t){if(!t)return!1;for(const e in t)this._definitions.set(e,t[e]);return!0}onBadgePointLimitsEvent(t){const e=t.getParser();for(const s of e.data)this.setBadgePointLimit(s.badgeId,s.limit)}getBadgePointLimit(t){return this._badgePointLimits.get(t)||-1}setBadgePointLimit(t,e){this._badgePointLimits.set(t,e)}getRomanNumeral(t){return this._romanNumerals[Math.max(0,t-1)]}getPreviousLevelBadgeId(t){const e=new Wc(t);return e.level--,e.getBadgeId}hasValue(t){return this._definitions.has(t)}getValue(t,e=!0){if(!t||!t.length)return null;const s=t.match(/\$\{.[^}]*\}/g);if(s&&s.length)for(const n of s)t=t.replace(n,this.getValue(n.slice(2,-1),e));let i=this._definitions.get(t)||null;if(!i&&(i=at.definitions.get(t),i))return i;if(i&&e){const n=this._parameters.get(t);if(n)for(const[a,o]of n)i=i.replace("%"+a+"%",o)}return i||t}getValueWithParameter(t,e,s){const i=this.getValue(t,!1),n=i.replace("%"+e+"%",s);if(i.startsWith("%{")){const a=new RegExp("%{"+e.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),o=i.match(a);if(!o)return n;let h=-1;switch(Number.parseInt(s)){case 0:h=1;break;case 1:h=2;break;default:case 2:h=3;break}if(h==-1||typeof o[h]>"u")return n;const c=o[h];if(c)return c.replace("%%",s)}return n}getValueWithParameters(t,e,s){let i=this.getValue(t,!1);if(e)for(let n=0;n<e.length;n++){const a=e[n],o=s[n];if(o!==void 0&&(i=i.replace("%"+a+"%",o),i.startsWith("%{"))){const h=new RegExp("%{"+a.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),u=i.match(h);if(!u)continue;const c=parseInt(o);let l=-1;switch(c){case 0:l=1;break;case 1:l=2;break;case 2:default:l=3;break}if(l===-1||typeof u[l]>"u")continue;const _=u[l];_&&(i=_.replace("%%",o))}}return i}setValue(t,e){this._definitions.set(t,e)}registerParameter(t,e,s){if(!t||t.length===0||!e||e.length===0)return;let i=this._parameters.get(t);i||(i=new Map,this._parameters.set(t,i)),i.set(e,s)}getBadgeName(t){const e=new Wc(t),s=["badge_name_"+t,"badge_name_"+e.base];let i=this.fixBadLocalization(this.getExistingKey(s));return i=i.replace("%roman%",this.getRomanNumeral(e.level)),i}getBadgeDesc(t){const e=new Wc(t),s=["badge_desc_"+t,"badge_desc_"+e.base];let i=this.fixBadLocalization(this.getExistingKey(s));const n=this.getBadgePointLimit(t);return n>-1&&(i=i.replace("%limit%",n.toString())),i=i.replace("%roman%",this.getRomanNumeral(e.level)),i}getExistingKey(t){for(const e of t){const s=this.getValue(e);if(s!=e)return s}return""}fixBadLocalization(t){return t.replace("${","$").replace("{","$").replace("}","$")}}/*!
 * @pixi/canvas-display - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/canvas-display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */Tr.prototype._renderCanvas=function(t){};Tr.prototype.renderCanvas=function(t){if(!(!this.visible||this.worldAlpha<=0||!this.renderable)){this._mask&&t.maskManager.pushMask(this._mask),this._renderCanvas(t);for(var e=0,s=this.children.length;e<s;++e)this.children[e].renderCanvas(t);this._mask&&t.maskManager.popMask(t)}};fe.prototype.renderCanvas=function(t){};/*!
 * @pixi/extract - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/extract is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var cJ=new it,dJ=4,fJ=function(){function r(t){this.renderer=t}return r.prototype.image=function(t,e,s){var i=new Image;return i.src=this.base64(t,e,s),i},r.prototype.base64=function(t,e,s){return this.canvas(t).toDataURL(e,s)},r.prototype.canvas=function(t,e){var s=this._rawPixels(t,e),i=s.pixels,n=s.width,a=s.height,o=s.flipY,h=new xp(n,a,1),u=h.context.getImageData(0,0,n,a);if(r.arrayPostDivide(i,u.data),h.context.putImageData(u,0,0),o){var c=new xp(h.width,h.height,1);c.context.scale(1,-1),c.context.drawImage(h.canvas,0,-a),h.destroy(),h=c}return h.canvas},r.prototype.pixels=function(t,e){var s=this._rawPixels(t,e).pixels;return r.arrayPostDivide(s,s),s},r.prototype._rawPixels=function(t,e){var s=this.renderer,i,n=!1,a,o=!1;if(t)if(t instanceof we)a=t;else{var h=s.context.webGLVersion>=2?s.multisample:ne.NONE;if(a=this.renderer.generateTexture(t,{multisample:h}),h!==ne.NONE){var u=we.create({width:a.width,height:a.height});s.framebuffer.bind(a.framebuffer),s.framebuffer.blit(u.framebuffer),s.framebuffer.bind(null),a.destroy(!0),a=u}o=!0}a?(i=a.baseTexture.resolution,e=e??a.frame,n=!1,s.renderTexture.bind(a)):(i=s.resolution,e||(e=cJ,e.width=s.width,e.height=s.height),n=!0,s.renderTexture.bind(null));var c=Math.round(e.width*i),l=Math.round(e.height*i),_=new Uint8Array(dJ*c*l),d=s.gl;return d.readPixels(Math.round(e.x*i),Math.round(e.y*i),c,l,d.RGBA,d.UNSIGNED_BYTE,_),o&&a.destroy(!0),{pixels:_,width:c,height:l,flipY:n}},r.prototype.destroy=function(){this.renderer=null},r.arrayPostDivide=function(t,e){for(var s=0;s<t.length;s+=4){var i=e[s+3]=t[s+3];i!==0?(e[s]=Math.round(Math.min(t[s]*255/i,255)),e[s+1]=Math.round(Math.min(t[s+1]*255/i,255)),e[s+2]=Math.round(Math.min(t[s+2]*255/i,255))):(e[s]=t[s],e[s+1]=t[s+1],e[s+2]=t[s+2])}},r.extension={name:"extract",type:Re.RendererPlugin},r}();/*!
 * @pixi/graphics-extras - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/graphics-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */function gJ(r,t,e,s,i,n){return i===void 0&&(i=0),n===void 0&&(n=Math.PI*2),Math.abs(n-i)>=Math.PI*2?this.drawCircle(r,t,s).beginHole().drawCircle(r,t,e).endHole():(this.finishPoly(),this.arc(r,t,e,n,i,!0).arc(r,t,s,i,n,!1).finishPoly(),this)}function EJ(r,t,e,s,i){if(i<=0)return this.drawRect(r,t,e,s);for(var n=Math.min(i,Math.min(e,s)/2),a=r+e,o=t+s,h=[r+n,t,a-n,t,a,t+n,a,o-n,a-n,o,r+n,o,r,o-n,r,t+n],u=h.length-1;u>=2;u-=2)h[u]===h[u-2]&&h[u-1]===h[u-3]&&h.splice(u-1,2);return this.drawPolygon(h)}function pJ(r,t,e,s,i){if(i===0)return this.drawRect(r,t,e,s);var n=Math.min(e,s)/2,a=Math.min(n,Math.max(-n,i)),o=r+e,h=t+s,u=a<0?-a:0,c=Math.abs(a);return this.moveTo(r,t+c).arcTo(r+u,t+u,r+c,t,c).lineTo(o-c,t).arcTo(o-u,t+u,o,t+c,c).lineTo(o,h-c).arcTo(o-u,h-u,r+e-c,h,c).lineTo(r+c,h).arcTo(r+u,h-u,r,h-c,c).closePath()}function mJ(r,t,e,s,i){i===void 0&&(i=0),s=Math.max(s|0,3);for(var n=-1*Math.PI/2+i,a=Math.PI*2/s,o=[],h=0;h<s;h++){var u=h*a+n;o.push(r+e*Math.cos(u),t+e*Math.sin(u))}return this.drawPolygon(o)}function IJ(r,t,e,s,i,n){if(n===void 0&&(n=0),s=Math.max(s|0,3),i<=0)return this.drawRegularPolygon(r,t,e,s,n);var a=e*Math.sin(Math.PI/s)-.001;i=Math.min(i,a);for(var o=-1*Math.PI/2+n,h=Math.PI*2/s,u=(s-2)*Math.PI/s/2,c=0;c<s;c++){var l=c*h+o,_=r+e*Math.cos(l),d=t+e*Math.sin(l),f=l+Math.PI+u,m=l-Math.PI-u,p=_+i*Math.cos(f),T=d+i*Math.sin(f),v=_+i*Math.cos(m),O=d+i*Math.sin(m);c===0?this.moveTo(p,T):this.lineTo(p,T),this.quadraticCurveTo(_,d,v,O)}return this.closePath()}/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var eg=function(r,t){return eg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},eg(r,t)};function TJ(r,t){eg(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var RJ=function(r){TJ(t,r);function t(e,s,i,n,a,o){o===void 0&&(o=0);var h=this;a=a||n/2;for(var u=-1*Math.PI/2+o,c=i*2,l=sh/c,_=[],d=0;d<c;d++){var f=d%2?a:n,m=d*l+u;_.push(e+f*Math.cos(m),s+f*Math.sin(m))}return h=r.call(this,_)||this,h}return t}(Vu);function OJ(r,t,e,s,i,n){return n===void 0&&(n=0),this.drawPolygon(new RJ(r,t,e,s,i,n))}Object.defineProperties(Ha.prototype,{drawTorus:{value:gJ},drawChamferRect:{value:EJ},drawFilletRect:{value:pJ},drawRegularPolygon:{value:mJ},drawRoundedPolygon:{value:IJ},drawStar:{value:OJ}});/*!
 * @pixi/math-extras - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/math-extras is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var qS={add:function(r,t){return t||(t=new B),t.x=this.x+r.x,t.y=this.y+r.y,t},subtract:function(r,t){return t||(t=new B),t.x=this.x-r.x,t.y=this.y-r.y,t},multiply:function(r,t){return t||(t=new B),t.x=this.x*r.x,t.y=this.y*r.y,t},multiplyScalar:function(r,t){return t||(t=new B),t.x=this.x*r,t.y=this.y*r,t},dot:function(r){return this.x*r.x+this.y*r.y},cross:function(r){return this.x*r.y-this.y*r.x},normalize:function(r){r||(r=new B);var t=Math.sqrt(this.x*this.x+this.y*this.y);return r.x=this.x/t,r.y=this.y/t,r},magnitude:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},magnitudeSquared:function(){return this.x*this.x+this.y*this.y},project:function(r,t){t||(t=new B);var e=(this.x*r.x+this.y*r.y)/(r.x*r.x+r.y*r.y);return t.x=r.x*e,t.y=r.y*e,t},reflect:function(r,t){t||(t=new B);var e=this.x*r.x+this.y*r.y;return t.x=this.x-2*e*r.x,t.y=this.y-2*e*r.y,t}};Object.assign(B.prototype,qS);Object.assign(pa.prototype,qS);it.prototype.containsRect=function(t){return t.width<=0||t.height<=0?t.x>this.x&&t.y>this.y&&t.right<this.right&&t.bottom<this.bottom:t.x>=this.x&&t.y>=this.y&&t.right<=this.right&&t.bottom<=this.bottom};it.prototype.equals=function(t){return t===this?!0:t&&this.x===t.x&&this.y===t.y&&this.width===t.width&&this.height===t.height};it.prototype.intersection=function(t,e){e||(e=new it);var s=this.x<t.x?t.x:this.x,i=this.right>t.right?t.right:this.right;if(i<=s)return e.x=e.y=e.width=e.height=0,e;var n=this.y<t.y?t.y:this.y,a=this.bottom>t.bottom?t.bottom:this.bottom;return a<=n?(e.x=e.y=e.width=e.height=0,e):(e.x=s,e.y=n,e.width=i-s,e.height=a-n,e)};it.prototype.union=function(t,e){e||(e=new it);var s=Math.min(this.x,t.x),i=Math.max(this.x+this.width,t.x+t.width),n=Math.min(this.y,t.y),a=Math.max(this.y+this.height,t.y+t.height);return e.x=s,e.y=n,e.width=i-s,e.height=a-n,e};/*!
 * @pixi/mixin-cache-as-bitmap - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-cache-as-bitmap is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var QS=new Vt;fe.prototype._cacheAsBitmap=!1;fe.prototype._cacheData=null;fe.prototype._cacheAsBitmapResolution=null;fe.prototype._cacheAsBitmapMultisample=ne.NONE;var vJ=function(){function r(){this.textureCacheId=null,this.originalRender=null,this.originalRenderCanvas=null,this.originalCalculateBounds=null,this.originalGetLocalBounds=null,this.originalUpdateTransform=null,this.originalDestroy=null,this.originalMask=null,this.originalFilterArea=null,this.originalContainsPoint=null,this.sprite=null}return r}();Object.defineProperties(fe.prototype,{cacheAsBitmapResolution:{get:function(){return this._cacheAsBitmapResolution},set:function(r){r!==this._cacheAsBitmapResolution&&(this._cacheAsBitmapResolution=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmapMultisample:{get:function(){return this._cacheAsBitmapMultisample},set:function(r){r!==this._cacheAsBitmapMultisample&&(this._cacheAsBitmapMultisample=r,this.cacheAsBitmap&&(this.cacheAsBitmap=!1,this.cacheAsBitmap=!0))}},cacheAsBitmap:{get:function(){return this._cacheAsBitmap},set:function(r){if(this._cacheAsBitmap!==r){this._cacheAsBitmap=r;var t;r?(this._cacheData||(this._cacheData=new vJ),t=this._cacheData,t.originalRender=this.render,t.originalRenderCanvas=this.renderCanvas,t.originalUpdateTransform=this.updateTransform,t.originalCalculateBounds=this.calculateBounds,t.originalGetLocalBounds=this.getLocalBounds,t.originalDestroy=this.destroy,t.originalContainsPoint=this.containsPoint,t.originalMask=this._mask,t.originalFilterArea=this.filterArea,this.render=this._renderCached,this.renderCanvas=this._renderCachedCanvas,this.destroy=this._cacheAsBitmapDestroy):(t=this._cacheData,t.sprite&&this._destroyCachedDisplayObject(),this.render=t.originalRender,this.renderCanvas=t.originalRenderCanvas,this.calculateBounds=t.originalCalculateBounds,this.getLocalBounds=t.originalGetLocalBounds,this.destroy=t.originalDestroy,this.updateTransform=t.originalUpdateTransform,this.containsPoint=t.originalContainsPoint,this._mask=t.originalMask,this.filterArea=t.originalFilterArea)}}}});fe.prototype._renderCached=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObject(t),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._render(t))};fe.prototype._initCachedDisplayObject=function(t){var e;if(!(this._cacheData&&this._cacheData.sprite)){var s=this.alpha;this.alpha=1,t.batch.flush();var i=this.getLocalBounds(null,!0).clone();if(this.filters&&this.filters.length){var n=this.filters[0].padding;i.pad(n)}i.ceil(Z.RESOLUTION);var a=t.renderTexture.current,o=t.renderTexture.sourceFrame.clone(),h=t.renderTexture.destinationFrame.clone(),u=t.projection.transform,c=we.create({width:i.width,height:i.height,resolution:this.cacheAsBitmapResolution||t.resolution,multisample:(e=this.cacheAsBitmapMultisample)!==null&&e!==void 0?e:t.multisample}),l="cacheAsBitmap_"+Dn();this._cacheData.textureCacheId=l,Xt.addToCache(c.baseTexture,l),_t.addToCache(c,l);var _=this.transform.localTransform.copyTo(QS).invert().translate(-i.x,-i.y);this.render=this._cacheData.originalRender,t.render(this,{renderTexture:c,clear:!0,transform:_,skipUpdateTransform:!1}),t.framebuffer.blit(),t.projection.transform=u,t.renderTexture.bind(a,o,h),this.render=this._renderCached,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;var d=new Kt(c);d.transform.worldTransform=this.transform.worldTransform,d.anchor.x=-(i.x/i.width),d.anchor.y=-(i.y/i.height),d.alpha=s,d._bounds=this._bounds,this._cacheData.sprite=d,this.transform._parentID=-1,this.parent?this.updateTransform():(this.enableTempParent(),this.updateTransform(),this.disableTempParent(null)),this.containsPoint=d.containsPoint.bind(d)}};fe.prototype._renderCachedCanvas=function(t){!this.visible||this.worldAlpha<=0||!this.renderable||(this._initCachedDisplayObjectCanvas(t),this._cacheData.sprite.worldAlpha=this.worldAlpha,this._cacheData.sprite._renderCanvas(t))};fe.prototype._initCachedDisplayObjectCanvas=function(t){if(!(this._cacheData&&this._cacheData.sprite)){var e=this.getLocalBounds(null,!0),s=this.alpha;this.alpha=1;var i=t.context,n=t._projTransform;e.ceil(Z.RESOLUTION);var a=we.create({width:e.width,height:e.height}),o="cacheAsBitmap_"+Dn();this._cacheData.textureCacheId=o,Xt.addToCache(a.baseTexture,o),_t.addToCache(a,o);var h=QS;this.transform.localTransform.copyTo(h),h.invert(),h.tx-=e.x,h.ty-=e.y,this.renderCanvas=this._cacheData.originalRenderCanvas,t.render(this,{renderTexture:a,clear:!0,transform:h,skipUpdateTransform:!1}),t.context=i,t._projTransform=n,this.renderCanvas=this._renderCachedCanvas,this.updateTransform=this.displayObjectUpdateTransform,this.calculateBounds=this._calculateCachedBounds,this.getLocalBounds=this._getCachedLocalBounds,this._mask=null,this.filterArea=null,this.alpha=s;var u=new Kt(a);u.transform.worldTransform=this.transform.worldTransform,u.anchor.x=-(e.x/e.width),u.anchor.y=-(e.y/e.height),u.alpha=s,u._bounds=this._bounds,this._cacheData.sprite=u,this.transform._parentID=-1,this.parent?this.updateTransform():(this.parent=t._tempDisplayObjectParent,this.updateTransform(),this.parent=null),this.containsPoint=u.containsPoint.bind(u)}};fe.prototype._calculateCachedBounds=function(){this._bounds.clear(),this._cacheData.sprite.transform._worldID=this.transform._worldID,this._cacheData.sprite._calculateBounds(),this._bounds.updateID=this._boundsID};fe.prototype._getCachedLocalBounds=function(){return this._cacheData.sprite.getLocalBounds(null)};fe.prototype._destroyCachedDisplayObject=function(){this._cacheData.sprite._texture.destroy(!0),this._cacheData.sprite=null,Xt.removeFromCache(this._cacheData.textureCacheId),_t.removeFromCache(this._cacheData.textureCacheId),this._cacheData.textureCacheId=null};fe.prototype._cacheAsBitmapDestroy=function(t){this.cacheAsBitmap=!1,this.destroy(t)};/*!
 * @pixi/mixin-get-child-by-name - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-child-by-name is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */fe.prototype.name=null;Tr.prototype.getChildByName=function(t,e){for(var s=0,i=this.children.length;s<i;s++)if(this.children[s].name===t)return this.children[s];if(e)for(var s=0,i=this.children.length;s<i;s++){var n=this.children[s];if(n.getChildByName){var a=n.getChildByName(t,!0);if(a)return a}}return null};/*!
 * @pixi/mixin-get-global-position - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/mixin-get-global-position is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */fe.prototype.getGlobalPosition=function(t,e){return t===void 0&&(t=new B),e===void 0&&(e=!1),this.parent?this.parent.toGlobal(this.position,t,e):(t.x=this.position.x,t.y=this.position.y),t};function AJ(r){var t=this.constructor;return this.then(function(e){return t.resolve(r()).then(function(){return e})},function(e){return t.resolve(r()).then(function(){return t.reject(e)})})}function SJ(r){var t=this;return new t(function(e,s){if(!(r&&typeof r.length<"u"))return s(new TypeError(typeof r+" "+r+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var i=Array.prototype.slice.call(r);if(i.length===0)return e([]);var n=i.length;function a(h,u){if(u&&(typeof u=="object"||typeof u=="function")){var c=u.then;if(typeof c=="function"){c.call(u,function(l){a(h,l)},function(l){i[h]={status:"rejected",reason:l},--n===0&&e(i)});return}}i[h]={status:"fulfilled",value:u},--n===0&&e(i)}for(var o=0;o<i.length;o++)a(o,i[o])})}function ZS(r,t){this.name="AggregateError",this.errors=r,this.message=t||""}ZS.prototype=Error.prototype;function yJ(r){var t=this;return new t(function(e,s){if(!(r&&typeof r.length<"u"))return s(new TypeError("Promise.any accepts an array"));var i=Array.prototype.slice.call(r);if(i.length===0)return s();for(var n=[],a=0;a<i.length;a++)try{t.resolve(i[a]).then(e).catch(function(o){n.push(o),n.length===i.length&&s(new ZS(n,"All promises were rejected"))})}catch(o){s(o)}})}var MJ=setTimeout;function JS(r){return!!(r&&typeof r.length<"u")}function CJ(){}function NJ(r,t){return function(){r.apply(t,arguments)}}function oe(r){if(!(this instanceof oe))throw new TypeError("Promises must be constructed via new");if(typeof r!="function")throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],ty(r,this)}function $S(r,t){for(;r._state===3;)r=r._value;if(r._state===0){r._deferreds.push(t);return}r._handled=!0,oe._immediateFn(function(){var e=r._state===1?t.onFulfilled:t.onRejected;if(e===null){(r._state===1?sg:mh)(t.promise,r._value);return}var s;try{s=e(r._value)}catch(i){mh(t.promise,i);return}sg(t.promise,s)})}function sg(r,t){try{if(t===r)throw new TypeError("A promise cannot be resolved with itself.");if(t&&(typeof t=="object"||typeof t=="function")){var e=t.then;if(t instanceof oe){r._state=3,r._value=t,rg(r);return}else if(typeof e=="function"){ty(NJ(e,t),r);return}}r._state=1,r._value=t,rg(r)}catch(s){mh(r,s)}}function mh(r,t){r._state=2,r._value=t,rg(r)}function rg(r){r._state===2&&r._deferreds.length===0&&oe._immediateFn(function(){r._handled||oe._unhandledRejectionFn(r._value)});for(var t=0,e=r._deferreds.length;t<e;t++)$S(r,r._deferreds[t]);r._deferreds=null}function bJ(r,t,e){this.onFulfilled=typeof r=="function"?r:null,this.onRejected=typeof t=="function"?t:null,this.promise=e}function ty(r,t){var e=!1;try{r(function(s){e||(e=!0,sg(t,s))},function(s){e||(e=!0,mh(t,s))})}catch(s){if(e)return;e=!0,mh(t,s)}}oe.prototype.catch=function(r){return this.then(null,r)};oe.prototype.then=function(r,t){var e=new this.constructor(CJ);return $S(this,new bJ(r,t,e)),e};oe.prototype.finally=AJ;oe.all=function(r){return new oe(function(t,e){if(!JS(r))return e(new TypeError("Promise.all accepts an array"));var s=Array.prototype.slice.call(r);if(s.length===0)return t([]);var i=s.length;function n(o,h){try{if(h&&(typeof h=="object"||typeof h=="function")){var u=h.then;if(typeof u=="function"){u.call(h,function(c){n(o,c)},e);return}}s[o]=h,--i===0&&t(s)}catch(c){e(c)}}for(var a=0;a<s.length;a++)n(a,s[a])})};oe.any=yJ;oe.allSettled=SJ;oe.resolve=function(r){return r&&typeof r=="object"&&r.constructor===oe?r:new oe(function(t){t(r)})};oe.reject=function(r){return new oe(function(t,e){e(r)})};oe.race=function(r){return new oe(function(t,e){if(!JS(r))return e(new TypeError("Promise.race accepts an array"));for(var s=0,i=r.length;s<i;s++)oe.resolve(r[s]).then(t,e)})};oe._immediateFn=typeof setImmediate=="function"&&function(r){setImmediate(r)}||function(r){MJ(r,0)};oe._unhandledRejectionFn=function(t){typeof console<"u"&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var fI=Object.getOwnPropertySymbols,PJ=Object.prototype.hasOwnProperty,DJ=Object.prototype.propertyIsEnumerable;function LJ(r){if(r==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(r)}function UJ(){try{if(!Object.assign)return!1;var r=new String("abc");if(r[5]="de",Object.getOwnPropertyNames(r)[0]==="5")return!1;for(var t={},e=0;e<10;e++)t["_"+String.fromCharCode(e)]=e;var s=Object.getOwnPropertyNames(t).map(function(n){return t[n]});if(s.join("")!=="0123456789")return!1;var i={};return"abcdefghijklmnopqrst".split("").forEach(function(n){i[n]=n}),Object.keys(Object.assign({},i)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}var xJ=UJ()?Object.assign:function(r,t){for(var e,s=LJ(r),i,n=1;n<arguments.length;n++){e=Object(arguments[n]);for(var a in e)PJ.call(e,a)&&(s[a]=e[a]);if(fI){i=fI(e);for(var o=0;o<i.length;o++)DJ.call(e,i[o])&&(s[i[o]]=e[i[o]])}}return s};const FJ=mg(xJ);/*!
 * @pixi/polyfill - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/polyfill is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */typeof globalThis>"u"&&(typeof self<"u"?self.globalThis=self:typeof global<"u"&&(global.globalThis=global));globalThis.Promise||(globalThis.Promise=oe);Object.assign||(Object.assign=FJ);var wJ=16;Date.now&&Date.prototype.getTime||(Date.now=function(){return new Date().getTime()});if(!(globalThis.performance&&globalThis.performance.now)){var GJ=Date.now();globalThis.performance||(globalThis.performance={}),globalThis.performance.now=function(){return Date.now()-GJ}}var Xc=Date.now(),gI=["ms","moz","webkit","o"];for(var Kc=0;Kc<gI.length&&!globalThis.requestAnimationFrame;++Kc){var qc=gI[Kc];globalThis.requestAnimationFrame=globalThis[qc+"RequestAnimationFrame"],globalThis.cancelAnimationFrame=globalThis[qc+"CancelAnimationFrame"]||globalThis[qc+"CancelRequestAnimationFrame"]}globalThis.requestAnimationFrame||(globalThis.requestAnimationFrame=function(r){if(typeof r!="function")throw new TypeError(r+"is not a function");var t=Date.now(),e=wJ+Xc-t;return e<0&&(e=0),Xc=t,globalThis.self.setTimeout(function(){Xc=Date.now(),r(performance.now())},e)});globalThis.cancelAnimationFrame||(globalThis.cancelAnimationFrame=function(r){return clearTimeout(r)});Math.sign||(Math.sign=function(t){return t=Number(t),t===0||isNaN(t)?t:t>0?1:-1});Number.isInteger||(Number.isInteger=function(t){return typeof t=="number"&&isFinite(t)&&Math.floor(t)===t});globalThis.ArrayBuffer||(globalThis.ArrayBuffer=Array);globalThis.Float32Array||(globalThis.Float32Array=Array);globalThis.Uint32Array||(globalThis.Uint32Array=Array);globalThis.Uint16Array||(globalThis.Uint16Array=Array);globalThis.Uint8Array||(globalThis.Uint8Array=Array);globalThis.Int32Array||(globalThis.Int32Array=Array);/*!
 * @pixi/sprite-tiling - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/sprite-tiling is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var ig=function(r,t){return ig=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},ig(r,t)};function ey(r,t){ig(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Io=new B,BJ=function(r){ey(t,r);function t(e,s,i){s===void 0&&(s=100),i===void 0&&(i=100);var n=r.call(this,e)||this;return n.tileTransform=new rT,n._width=s,n._height=i,n.uvMatrix=n.texture.uvMatrix||new fT(e),n.pluginName="tilingSprite",n.uvRespectAnchor=!1,n}return Object.defineProperty(t.prototype,"clampMargin",{get:function(){return this.uvMatrix.clampMargin},set:function(e){this.uvMatrix.clampMargin=e,this.uvMatrix.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tileScale",{get:function(){return this.tileTransform.scale},set:function(e){this.tileTransform.scale.copyFrom(e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tilePosition",{get:function(){return this.tileTransform.position},set:function(e){this.tileTransform.position.copyFrom(e)},enumerable:!1,configurable:!0}),t.prototype._onTextureUpdate=function(){this.uvMatrix&&(this.uvMatrix.texture=this._texture),this._cachedTint=16777215},t.prototype._render=function(e){var s=this._texture;!s||!s.valid||(this.tileTransform.updateLocalTransform(),this.uvMatrix.update(),e.batch.setObjectRenderer(e.plugins[this.pluginName]),e.plugins[this.pluginName].render(this))},t.prototype._calculateBounds=function(){var e=this._width*-this._anchor._x,s=this._height*-this._anchor._y,i=this._width*(1-this._anchor._x),n=this._height*(1-this._anchor._y);this._bounds.addFrame(this.transform,e,s,i,n)},t.prototype.getLocalBounds=function(e){return this.children.length===0?(this._bounds.minX=this._width*-this._anchor._x,this._bounds.minY=this._height*-this._anchor._y,this._bounds.maxX=this._width*(1-this._anchor._x),this._bounds.maxY=this._height*(1-this._anchor._y),e||(this._localBoundsRect||(this._localBoundsRect=new it),e=this._localBoundsRect),this._bounds.getRectangle(e)):r.prototype.getLocalBounds.call(this,e)},t.prototype.containsPoint=function(e){this.worldTransform.applyInverse(e,Io);var s=this._width,i=this._height,n=-s*this.anchor._x;if(Io.x>=n&&Io.x<n+s){var a=-i*this.anchor._y;if(Io.y>=a&&Io.y<a+i)return!0}return!1},t.prototype.destroy=function(e){r.prototype.destroy.call(this,e),this.tileTransform=null,this.uvMatrix=null},t.from=function(e,s){var i=e instanceof _t?e:_t.from(e,s);return new t(i,s.width,s.height)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e},enumerable:!1,configurable:!0}),t}(Kt),HJ=`#version 100
#define SHADER_NAME Tiling-Sprite-Simple-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;

void main(void)
{
    vec4 texSample = texture2D(uSampler, vTextureCoord);
    gl_FragColor = texSample * uColor;
}
`,EI=`#version 100
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

varying vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,VJ=`#version 100
#ifdef GL_EXT_shader_texture_lod
    #extension GL_EXT_shader_texture_lod : enable
#endif
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

varying vec2 vTextureCoord;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    #ifdef GL_EXT_shader_texture_lod
        vec4 texSample = unclamped == coord
            ? texture2D(uSampler, coord) 
            : texture2DLodEXT(uSampler, coord, 0);
    #else
        vec4 texSample = texture2D(uSampler, coord);
    #endif

    gl_FragColor = texSample * uColor;
}
`,kJ=`#version 300 es
#define SHADER_NAME Tiling-Sprite-300

precision lowp float;

in vec2 aVertexPosition;
in vec2 aTextureCoord;

uniform mat3 projectionMatrix;
uniform mat3 translationMatrix;
uniform mat3 uTransform;

out vec2 vTextureCoord;

void main(void)
{
    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);

    vTextureCoord = (uTransform * vec3(aTextureCoord, 1.0)).xy;
}
`,jJ=`#version 300 es
#define SHADER_NAME Tiling-Sprite-100

precision lowp float;

in vec2 vTextureCoord;

out vec4 fragmentColor;

uniform sampler2D uSampler;
uniform vec4 uColor;
uniform mat3 uMapCoord;
uniform vec4 uClampFrame;
uniform vec2 uClampOffset;

void main(void)
{
    vec2 coord = vTextureCoord + ceil(uClampOffset - vTextureCoord);
    coord = (uMapCoord * vec3(coord, 1.0)).xy;
    vec2 unclamped = coord;
    coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

    vec4 texSample = texture(uSampler, coord, unclamped == coord ? 0.0f : -32.0f);// lod-bias very negative to force lod 0

    fragmentColor = texSample * uColor;
}
`,Uu=new Vt,zJ=function(r){ey(t,r);function t(e){var s=r.call(this,e)||this;return e.runners.contextChange.add(s),s.quad=new uT,s.state=yh.for2d(),s}return t.prototype.contextChange=function(){var e=this.renderer,s={globals:e.globalUniforms};this.simpleShader=Cn.from(EI,HJ,s),this.shader=e.context.webGLVersion>1?Cn.from(kJ,jJ,s):Cn.from(EI,VJ,s)},t.prototype.render=function(e){var s=this.renderer,i=this.quad,n=i.vertices;n[0]=n[6]=e._width*-e.anchor.x,n[1]=n[3]=e._height*-e.anchor.y,n[2]=n[4]=e._width*(1-e.anchor.x),n[5]=n[7]=e._height*(1-e.anchor.y);var a=e.uvRespectAnchor?e.anchor.x:0,o=e.uvRespectAnchor?e.anchor.y:0;n=i.uvs,n[0]=n[6]=-a,n[1]=n[3]=-o,n[2]=n[4]=1-a,n[5]=n[7]=1-o,i.invalidate();var h=e._texture,u=h.baseTexture,c=u.alphaMode>0,l=e.tileTransform.localTransform,_=e.uvMatrix,d=u.isPowerOfTwo&&h.frame.width===u.width&&h.frame.height===u.height;d&&(u._glTextures[s.CONTEXT_UID]?d=u.wrapMode!==ri.CLAMP:u.wrapMode===ri.CLAMP&&(u.wrapMode=ri.REPEAT));var f=d?this.simpleShader:this.shader,m=h.width,p=h.height,T=e._width,v=e._height;Uu.set(l.a*m/T,l.b*m/v,l.c*p/T,l.d*p/v,l.tx/T,l.ty/v),Uu.invert(),d?Uu.prepend(_.mapCoord):(f.uniforms.uMapCoord=_.mapCoord.toArray(!0),f.uniforms.uClampFrame=_.uClampFrame,f.uniforms.uClampOffset=_.uClampOffset),f.uniforms.uTransform=Uu.toArray(!0),f.uniforms.uColor=cD(e.tint,e.worldAlpha,f.uniforms.uColor,c),f.uniforms.translationMatrix=e.transform.worldTransform.toArray(!0),f.uniforms.uSampler=h,s.shader.bind(f),s.geometry.bind(i),this.state.blendMode=_D(e.blendMode,c),s.state.set(this.state),s.geometry.draw(this.renderer.gl.TRIANGLES,6,0)},t.extension={name:"tilingSprite",type:Re.RendererPlugin},t}(t_);hi.add(mT,fJ,zJ,lF,dU,oU,pD);class pI{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?Qt.generateImage(this.data):null}}class rs extends ge{constructor(t){super(null,null),this._type=t}get type(){return this._type}}rs.IMAGE_LOADED="ROAUM_IMAGE_LOADED";rs.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";class le extends ge{constructor(){super(null,null)}}class sy extends le{constructor(t,e){super(),this._itemType=t,this._itemName=e}get itemType(){return this._itemType}get itemName(){return this._itemName}}class mE extends le{constructor(t=0){super(),this._numberOfWords=t}get numberOfWords(){return this._numberOfWords}}class ry extends le{constructor(t=0){super(),this._danceStyle=t}get danceStyle(){return this._danceStyle}}class iy extends le{constructor(t,e=0){super(),this._effect=t,this._delayMilliseconds=e}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class ny extends le{constructor(t){super(),this._gainedExperience=t}get gainedExperience(){return this._gainedExperience}}class ay extends le{constructor(t=0){super(),this._expressionType=t}get expressionType(){return this._expressionType}}class Bl extends le{constructor(t,e=null,s=null,i=!1){super(),this._figure=t,this._gender=e,this._subType=s,this._isRiding=i}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class oy extends le{constructor(t=0){super(),this._level=t}get level(){return this._level}}class hy extends le{constructor(t=0){super(),this._gesture=t}get gesture(){return this._gesture}}class YJ extends le{constructor(t){super(),this._guideStatus=t}get guideStatus(){return this._guideStatus}}class uy extends le{constructor(t=!1){super(),this._isMuted=t}get isMuted(){return this._isMuted}}class ly extends le{}class _y extends le{constructor(t){super(),this._gesture=t}get gesture(){return this._gesture}}class cy extends le{constructor(t){super(),this._value=t}get value(){return this._value}}class dy extends le{constructor(t){super(),this._isPlayingGame=t}get isPlayingGame(){return this._isPlayingGame}}class IE extends le{constructor(t,e=""){super(),this._postureType=t,this._parameter=e}get postureType(){return this._postureType}get parameter(){return this._parameter}}class Hl extends le{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class fy extends le{constructor(t=0){super(),this._signType=t}get signType(){return this._signType}}class TE extends le{constructor(t=!1){super(),this._isSleeping=t}get isSleeping(){return this._isSleeping}}class gy extends le{constructor(t=!1){super(),this._isTyping=t}get isTyping(){return this._isTyping}}class Bi extends ge{constructor(t,e,s,i=!1){super(t,s),this._targetLocation=e,this._isSlide=i}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}}class Vl extends Bi{constructor(t,e,s,i,n,a){super(t,e,s),this._headDirection=i,this._canStandUp=n,this._baseY=a}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class Ey extends le{constructor(t){super(),this._itemType=t}get itemType(){return this._itemType}}class Ht extends ge{constructor(t,e,s=null){super(null,null),this._state=t,this._data=e,this._extra=s}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}class ka extends ge{constructor(t,e){super(null,null),this._badgeId=t,this._assetName=e}get badgeId(){return this._badgeId}get assetName(){return this._assetName}}ka.BADGE_LOADED="ROGBUM_BADGE_LOADED";class py extends ge{constructor(t,e,s){super(t,e),this._height=s}get height(){return this._height}}class RE extends ge{constructor(t){super(null,null),this._data=t}get data(){return this._data}}class my extends ge{constructor(t,e){super(null,null),this._numberKey=t,this._numberValue=e}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}class kl extends ge{constructor(t,e,s,i){super(null,null),this._type=t,this._color=e,this._light=s,this._backgroundOnly=i}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}}kl.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";class Jr extends ge{constructor(t,e,s=0,i=0,n=0,a=0){super(null,null),this._type=t,this._id=e,this._x=s,this._y=i,this._width=n,this._height=a}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}Jr.ADD="ORPFHUM_ADD";Jr.REMOVE="ORPFHUM_REMOVE";const Iy=class Ty extends ge{constructor(t){super(null,null),this._type=Ty.UPDATE_MAP,this._mapData=t}get type(){return this._type}get mapData(){return this._mapData}};Iy.UPDATE_MAP="RORMUM_UPDATE_MAP";let Ry=Iy;class Se extends ge{constructor(t,e,s=null,i=null,n="window"){super(null,null),this._type=t,this._maskId=e,this._maskType=s,this._maskLocation=i?new S(i.x,i.y,i.z):null,this._maskCategory=n}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}}Se.ADD_MASK="RORMUM_ADD_MASK";Se.REMOVE_MASK="RORMUM_ADD_MASK";Se.DOOR="door";Se.WINDOW="window";Se.HOLE="hole";class $r extends ge{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}}$r.WALL_THICKNESS="RORPPUM_WALL_THICKNESS";$r.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";class ti extends ge{constructor(t,e){super(null,null),this._type=t,this._visible=e}get type(){return this._type}get visible(){return this._visible}}ti.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY";ti.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";class Ae extends ge{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}}Ae.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE";Ae.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE";Ae.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";class Ih extends le{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class ha extends ge{constructor(t,e,s,i,n=!1){super(t,null),this._height=e,this._visible=s,this._sourceEventId=i,this._toggleVisibility=n}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}class ei extends ge{constructor(t){super(null,null),this._type=t}get type(){return this._type}}ei.ENABLED="ROVUM_ENABLED";ei.DISABLED="ROVUM_DISABLED";const OE=class ng extends c_{constructor(){super(),this._liftAmount=0,this._location=new S,this._locationDelta=new S,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=ng.DEFAULT_UPDATE_INTERVAL}onDispose(){this._liftAmount=0,super.onDispose()}update(t){super.update(t);const e=this.getLocationOffset(),s=this.object&&this.object.model;if(s&&(e?this._liftAmount!==e.z&&(this._liftAmount=e.z,s.setValue(I.FURNITURE_LIFT_AMOUNT,this._liftAmount)):this._liftAmount!==0&&(this._liftAmount=0,s.setValue(I.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||e){const i=ng.TEMP_VECTOR;let n=this.time-this._changeTime;n===this._updateInterval>>1&&n++,n>this._updateInterval&&(n=this._updateInterval),this._locationDelta.length>0?(i.assign(this._locationDelta),i.multiply(n/this._updateInterval),i.add(this._location)):i.assign(this._location),e&&i.add(e),this.object.setLocation(i),n===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0)}this._lastUpdateTime=this.time}setObject(t){super.setObject(t),t&&this._location.assign(t.getLocation())}processUpdateMessage(t){if(t&&(super.processUpdateMessage(t),t.location&&this._location.assign(t.location),t instanceof Bi))return this.processMoveMessage(t)}processMoveMessage(t){!t||!this.object||!t.location||(this._changeTime=this._lastUpdateTime,this._locationDelta.assign(t.targetLocation),this._locationDelta.subtract(this._location))}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(t){t<=0&&(t=1),this._updateInterval=t}};OE.DEFAULT_UPDATE_INTERVAL=500;OE.TEMP_VECTOR=new S;let Pa=OE;const Xi=class ss extends Pa{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=ft()+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const t=[et.CLICK,et.DOUBLE_CLICK,$e.POSITION_CHANGED,et.MOUSE_ENTER,et.MOUSE_LEAVE,w.MOUSE_BUTTON,w.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new $e($e.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const s=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==s.x||this._reportedLocation.y!==s.y||this._reportedLocation.z!==s.z)&&(this._reportedLocation||(this._reportedLocation=new S),this._reportedLocation.assign(s),this.eventDispatcher.dispatchEvent(new $e($e.POSITION_CHANGED,this.object)))}const e=this.object&&this.object.model;e&&this.updateModel(this.time,e)}updateModel(t,e){this._talkingEndTimestamp>0&&(t>this._talkingEndTimestamp?(e.setValue(I.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):!this._talkingPauseEndTimestamp&&!this._talkingPauseStartTimestamp?(this._talkingPauseStartTimestamp=t+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp()):this._talkingPauseStartTimestamp>0&&t>this._talkingPauseStartTimestamp?(e.setValue(I.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&t>this._talkingPauseEndTimestamp&&(e.setValue(I.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0)),this._animationEndTimestamp>0&&t>this._animationEndTimestamp&&(e.setValue(I.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(I.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&t>this._signEndTimestamp&&(e.setValue(I.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&t>this._carryObjectEndTimestamp&&(e.setValue(I.FIGURE_CARRY_OBJECT,0),e.setValue(I.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&t-this._carryObjectStartTimestamp>5e3&&((t-this._carryObjectStartTimestamp)%1e4<1e3?e.setValue(I.FIGURE_USE_OBJECT,1):e.setValue(I.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&t>this._blinkingStartTimestamp&&(e.setValue(I.FIGURE_BLINK,1),this._blinkingStartTimestamp=t+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=t+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&t>this._blinkingEndTimestamp&&(e.setValue(I.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&t>this._effectChangeTimeStamp&&(e.setValue(I.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&t>this._numberValueEndTimestamp&&(e.setValue(I.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof IE){e.setValue(I.FIGURE_POSTURE,t.postureType),e.setValue(I.FIGURE_POSTURE_PARAMETER,t.parameter);return}if(t instanceof mE){e.setValue(I.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof gy){e.setValue(I.FIGURE_IS_TYPING,t.isTyping?1:0);return}if(t instanceof uy){e.setValue(I.FIGURE_IS_MUTED,t.isMuted?1:0);return}if(t instanceof dy){e.setValue(I.FIGURE_IS_PLAYING_GAME,t.isPlayingGame?1:0);return}if(t instanceof Vl){e.setValue(I.HEAD_DIRECTION,t.headDirection),e.setValue(I.FIGURE_CAN_STAND_UP,t.canStandUp),e.setValue(I.FIGURE_VERTICAL_OFFSET,t.baseY);return}if(t instanceof hy){e.setValue(I.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof ay){e.setValue(I.FIGURE_EXPRESSION,t.expressionType),this._animationEndTimestamp=q.getExpressionTimeout(e.getValue(I.FIGURE_EXPRESSION)),this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time);return}if(t instanceof ry){e.setValue(I.FIGURE_DANCE,t.danceStyle);return}if(t instanceof TE){e.setValue(I.FIGURE_SLEEP,t.isSleeping?1:0),t.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp();return}if(t instanceof cy){e.setValue(I.FIGURE_NUMBER_VALUE,t.value),this._numberValueEndTimestamp=this.time+3e3;return}if(t instanceof iy){this.updateAvatarEffect(t.effect,t.delayMilliseconds,e);return}if(t instanceof sy){e.setValue(I.FIGURE_CARRY_OBJECT,t.itemType),e.setValue(I.FIGURE_USE_OBJECT,0),t.itemType===0?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,t.itemType<ss.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=t.itemType<=ss.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1));return}if(t instanceof Ey){e.setValue(I.FIGURE_USE_OBJECT,t.itemType);return}if(t instanceof fy){e.setValue(I.FIGURE_SIGN,t.signType),this._signEndTimestamp=this.time+5e3;return}if(t instanceof oy){e.setValue(I.FIGURE_FLAT_CONTROL,t.level);return}if(t instanceof Bl){e.setValue(I.FIGURE,t.figure),e.setValue(I.GENDER,t.gender);return}if(t instanceof Hl){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof ly){e.setValue(I.OWN_USER,1);return}}}updateAvatarEffect(t,e,s){if(t===ss.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=ft()+ss.EFFECT_SPLASH_LENGTH,this._newEffect=ss.EFFECT_TYPE_SWIM;else if(t===ss.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=ft()+ss.EFFECT_SPLASH_LENGTH,this._newEffect=ss.EFFECT_TYPE_SWIM_DARK;else if(s.getValue(I.FIGURE_EFFECT)===ss.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=ft()+ss.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=ss.EFFECT_TYPE_SPLASH;else if(s.getValue(I.FIGURE_EFFECT)===ss.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=ft()+ss.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=ss.EFFECT_TYPE_SPLASH_DARK;else if(e===0)this._effectChangeTimeStamp=0;else{this._effectChangeTimeStamp=ft()+e,this._newEffect=t;return}s.setValue(I.FIGURE_EFFECT,t)}mouseEvent(t,e){let s=null;switch(t.type){case k.MOUSE_CLICK:s=et.CLICK;break;case k.DOUBLE_CLICK:s=et.DOUBLE_CLICK;break;case k.ROLL_OVER:s=et.MOUSE_ENTER,this.object.model&&this.object.model.setValue(I.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new w(w.MOUSE_BUTTON,this.object));break;case k.ROLL_OUT:s=et.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(I.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new w(w.MOUSE_ARROW,this.object));break}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new et(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+Math.random()*200}randomTalkingPauseEndTimestamp(){return 75+Math.random()*75}randomBlinkStartTimestamp(){return 4500+Math.random()*1e3}randomBlinkEndTimestamp(){return 50+Math.random()*200}};Xi.MAX_HAND_ID=999999999;Xi.MAX_HAND_USE_ID=999;Xi.EFFECT_TYPE_SPLASH=28;Xi.EFFECT_SPLASH_LENGTH=500;Xi.EFFECT_TYPE_SWIM=29;Xi.EFFECT_TYPE_SPLASH_DARK=184;Xi.EFFECT_TYPE_SWIM_DARK=185;let WJ=Xi;const vE=class Gs extends Pa{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new S,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,Gs.BOUNCING_STEPS===-1&&(Gs.BOUNCING_STEPS=at.getValue("furni.rotation.bounce.steps",8)),Gs.BOUNCING_Z===-1&&(Gs.BOUNCING_Z=at.getValue("furni.rotation.bounce.height",.0625))}getEventTypes(){const t=[mt.STATE_CHANGE,et.CLICK,et.MOUSE_DOWN,et.MOUSE_DOWN_LONG,Yt.ROOM_AD_TOOLTIP_SHOW,Yt.ROOM_AD_TOOLTIP_HIDE,Yt.ROOM_AD_FURNI_DOUBLE_CLICK,Yt.ROOM_AD_FURNI_CLICK];return this.widget&&t.push(C.OPEN_WIDGET,C.CLOSE_WIDGET),this.contextMenu&&t.push(C.OPEN_FURNI_CONTEXT_MENU,C.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic){if(t.logic.model){const s=t.logic.model.dimensions;s&&(this._sizeX=s.x,this._sizeY=s.y,this._sizeZ=s.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const i=t.logic.model.directions;if(i&&i.length){for(const n of i)this._directions.push(n);this._directions.sort((n,a)=>n-a)}}if(t.logic.customVars){const s=t.logic.customVars.variables;s&&s.length&&e.setValue(I.FURNITURE_CUSTOM_VARIABLES,s)}}e.setValue(I.FURNITURE_SIZE_X,this._sizeX),e.setValue(I.FURNITURE_SIZE_Y,this._sizeY),e.setValue(I.FURNITURE_SIZE_Z,this._sizeZ),e.setValue(I.FURNITURE_CENTER_X,this._centerX),e.setValue(I.FURNITURE_CENTER_Y,this._centerY),e.setValue(I.FURNITURE_CENTER_Z,this._centerZ),e.setValue(I.FURNITURE_ALLOWED_DIRECTIONS,this._directions),e.setValue(I.FURNITURE_ALPHA_MULTIPLIER,1)}}onDispose(){this._storedRotateMessage=null,this._directions=null,super.onDispose()}setObject(t){super.setObject(t),t&&t.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(t){return t.getValue(I.FURNITURE_AD_URL)}handleAdClick(t,e,s){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Yt(Yt.ROOM_AD_FURNI_CLICK,this.object))}update(t){super.update(t),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>Gs.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(t){if(t instanceof Ht){this.processDataUpdateMessage(t);return}if(t instanceof py){this.processObjectHeightUpdateMessage(t);return}if(t instanceof RE){this.processItemDataUpdateMessage(t);return}if(this._mouseOver=!1,t.location&&t.direction){if(!(t instanceof Bi)){const e=this.object.getDirection(),s=this.object.getLocation();e.x!==t.direction.x&&this._directionInitialized&&s.x===t.location.x&&s.y===t.location.y&&s.z===t.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new ge(t.location,t.direction),t=null)}this._directionInitialized=!0}if(t instanceof Ih&&this.contextMenu&&this.eventDispatcher&&this.object){const e=t.selected?C.OPEN_FURNI_CONTEXT_MENU:C.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new C(e,this.object))}super.processUpdateMessage(t)}processDataUpdateMessage(t){t&&(this.object.setState(t.state,0),t.data&&t.data.writeRoomObjectModel(this.object.model),t.extra!==null&&this.object.model.setValue(I.FURNITURE_EXTRAS,t.extra.toString()),this.object.model.setValue(I.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(t){t&&this.object.model.setValue(I.FURNITURE_SIZE_Z,t.height)}processItemDataUpdateMessage(t){t&&this.object.model.setValue(I.FURNITURE_ITEMDATA,t.data)}mouseEvent(t,e){const s=this.getAdClickUrl(this.object.model);switch(t.type){case k.MOUSE_MOVE:if(this.eventDispatcher){const i=new et(et.MOUSE_MOVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}return;case k.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Yt(Yt.ROOM_AD_TOOLTIP_SHOW,this.object));const i=new et(et.MOUSE_ENTER,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!0}return;case k.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Yt(Yt.ROOM_AD_TOOLTIP_HIDE,this.object));const i=new et(et.MOUSE_LEAVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!1}return;case k.DOUBLE_CLICK:this.useObject();return;case k.MOUSE_CLICK:if(this.eventDispatcher){const i=new et(et.CLICK,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i),s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Yt(Yt.ROOM_AD_TOOLTIP_HIDE,this.object)),s&&s.length&&this.handleAdClick(this.object.id,this.object.type,s)}return;case k.MOUSE_DOWN:if(this.eventDispatcher){const i=new et(et.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(i)}return;case k.MOUSE_DOWN_LONG:if(this.eventDispatcher){const i=new et(et.MOUSE_DOWN_LONG,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(i)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=Gs.BOUNCING_STEPS/2?this._locationOffset.z=Gs.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=Gs.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=Gs.BOUNCING_Z*(Gs.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){if(!this.object||!this.eventDispatcher)return;const t=this.getAdClickUrl(this.object.model);t&&t.length&&this.eventDispatcher.dispatchEvent(new Yt(Yt.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,t)),this.widget&&this.eventDispatcher.dispatchEvent(new C(C.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new mt(mt.STATE_CHANGE,this.object))}tearDown(){this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.widget&&this.eventDispatcher.dispatchEvent(new C(C.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new C(C.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}};vE.BOUNCING_STEPS=-1;vE.BOUNCING_Z=-1;let Nt=vE;class Oy extends Nt{getEventTypes(){const t=[C.BADGE_DISPLAY_ENGRAVING,Ir.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object){if(t instanceof Ht){const e=t.data;e instanceof Al&&this.updateBadge(e.getValue(1));return}if(t instanceof ka){t.assetName!=="loading_icon"&&(this.object.model.setValue(I.FURNITURE_BADGE_ASSET_NAME,t.assetName),this.object.model.setValue(I.FURNITURE_BADGE_IMAGE_STATUS,1),this.update(ft()));return}}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(t){t!==""&&this.eventDispatcher&&(this.object.model.setValue(I.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new Ir(Ir.LOAD_BADGE,this.object,t,!1)))}}const Wn=class un extends Oy{getEventTypes(){const t=[C.ACHIEVEMENT_RESOLUTION_OPEN,C.ACHIEVEMENT_RESOLUTION_ENGRAVING,C.ACHIEVEMENT_RESOLUTION_FAILED,Ir.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof ka&&t.assetName!=="loading_icon"&&this.object.model.setValue(I.FURNITURE_BADGE_VISIBLE_IN_STATE,un.BADGE_VISIBLE_IN_STATE),t instanceof Ih){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new C(C.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let t=null;switch(this.object.getState(0)){case un.STATE_RESOLUTION_NOT_STARTED:case un.STATE_RESOLUTION_IN_PROGRESS:t=new C(C.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case un.STATE_RESOLUTION_ACHIEVED:t=new C(C.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case un.STATE_RESOLUTION_FAILED:t=new C(C.ACHIEVEMENT_RESOLUTION_FAILED,this.object);break}t&&this.eventDispatcher.dispatchEvent(t)}updateBadge(t){t!==un.ACH_NOT_SET&&super.updateBadge(t)}};Wn.STATE_RESOLUTION_NOT_STARTED=0;Wn.STATE_RESOLUTION_IN_PROGRESS=1;Wn.STATE_RESOLUTION_ACHIEVED=2;Wn.STATE_RESOLUTION_FAILED=3;Wn.ACH_NOT_SET="ach_0";Wn.BADGE_VISIBLE_IN_STATE=2;let XJ=Wn;class KJ extends Nt{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(t){super.initialize(t),this.eventDispatcher&&this.eventDispatcher.addEventListener(fh.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(fh.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(t){if(!t||!this.object)return;const e=this.object.getLocation(),s=t.targetLocation;if(!s)return;let i=this.object.model.getValue(I.FURNITURE_SIZE_X),n=this.object.model.getValue(I.FURNITURE_SIZE_Y);const a=(Math.floor(this.object.getDirection().x)+45)%360/90;(a===1||a===3)&&([i,n]=[n,i]),s.x>=e.x&&s.x<e.x+i&&s.y>=e.y&&s.y<e.y+n?this.object.setState(1,0):this.object.setState(0,0)}}class qJ extends Nt{getEventTypes(){const t=[C.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);const e=this.object.model.getValue(I.FURNITURE_DATA);this.updateClothingData(e)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Ht&&t.data&&this.updateClothingData(t.data.getLegacyString())}updateClothingData(t){if(!t||!t.length)return;const[e,s]=t.split(",");e&&e.length&&this.object.model.setValue(I.FURNITURE_CLOTHING_BOY,e),s&&s.length&&this.object.model.setValue(I.FURNITURE_CLOTHING_GIRL,s)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.CLOTHING_CHANGE,this.object))}}class QJ extends Nt{getEventTypes(){const t=[mt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case k.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new mt(mt.STATE_CHANGE,this.object,1);break;case"reset":s=new mt(mt.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new mt(mt.STATE_CHANGE,this.object,1))}}class ZJ extends Nt{processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(Ce.INFOSTAND_EXTRA_PARAM,Ce.CRACKABLE_FURNI)}}class JJ extends Nt{get widget(){return st.CRAFTING}}class $J extends Nt{getEventTypes(){const t=[C.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);let e=0;t.logic&&t.logic.credits&&t.logic.credits!==""&&t.logic.credits.length>0&&(e=parseInt(t.logic.credits)),this.object.model.setValue(I.FURNITURE_CREDIT_VALUE,e)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new C(C.CREDITFURNI,this.object)),super.useObject())}}class he extends Nt{getEventTypes(){const t=[w.MOUSE_BUTTON,w.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case k.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new w(w.MOUSE_BUTTON,this.object));break;case k.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new w(w.MOUSE_ARROW,this.object));break}super.mouseEvent(t,e)}}}class t$ extends he{constructor(){super(...arguments),this._state=1}getEventTypes(){const t=[Qr.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Ht&&(this._state!==-1&&t.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=t.state)}dispatchSoundEvent(t){const e=Math.pow(2,t-1.2);this.eventDispatcher.dispatchEvent(new Qr(Qr.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",e))}}class e$ extends he{getEventTypes(){const t=[C.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(I.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new C(C.STACK_HEIGHT,this.object)),super.useObject())}}class s$ extends Nt{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const t=[w.DICE_ACTIVATE,w.DICE_OFF];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case k.DOUBLE_CLICK:this._noTags?!this._noTagsLastStateActivate||this.object.getState(0)===0||this.object.getState(0)===100?(s=new w(w.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):(s=new w(w.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):t.spriteTag==="activate"||this.object.getState(0)===0||this.object.getState(0)===100?s=new w(w.DICE_ACTIVATE,this.object):t.spriteTag==="deactivate"&&(s=new w(w.DICE_OFF,this.object)),s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(t,e)}}class r$ extends Nt{getEventTypes(){const t=[C.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.ECOTRONBOX,this.object))}}class i$ extends Nt{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[C.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.startState===1&&(this._showStateOnceRendered=!0)}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(I.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){!t||!e||(t.type===k.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.INERNAL_LINK,this.object))}}class n$ extends Nt{getEventTypes(){const t=[C.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.link&&t.logic.action.link!==""&&t.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(I.FURNITURE_INTERNAL_LINK,t.logic.action.link)}onDispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.onDispose()}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(I.FURNITURE_AUTOMATIC_STATE_INDEX,t)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),!(!this.object||!this.eventDispatcher)&&this.eventDispatcher.dispatchEvent(new C(C.ROOM_LINK,this.object))}}class a$ extends Nt{getEventTypes(){const t=[C.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return We.EFFECT_BOX}}class o$ extends he{getEventTypes(){const t=[C.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(super.initialize(t),!!t&&this.object&&this.object.model){let e="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(I.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(I.FURNITURE_PLANE_MASK_TYPE,e)}}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new C(C.EXTERNAL_IMAGE,this.object)),super.useObject())}}class h$ extends Nt{getEventTypes(){const t=[mt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(I.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case k.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new mt(mt.STATE_CHANGE,this.object,1);break;case"reset":s=new mt(mt.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new mt(mt.STATE_CHANGE,this.object,0))}}const vy=class No extends he{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const t=[Qe.ADD_HOLE,Qe.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._currentState===No.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new Qe(Qe.REMOVE_HOLE,this.object)),super.onDispose()}update(t){super.update(t),this.handleAutomaticStateUpdate()}processUpdateMessage(t){if(super.processUpdateMessage(t),!this.object)return;t instanceof Ht&&this.handleStateUpdate(this.object.getState(0));const e=this.object.getLocation();this._currentLocation?(e.x!==this._currentLocation.x||e.y!==this._currentLocation.y)&&this._currentState===No.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Qe(Qe.ADD_HOLE,this.object)):this._currentLocation=new S,this._currentLocation.assign(e)}handleStateUpdate(t){t!==this._currentState&&(this.eventDispatcher&&(t===No.STATE_HOLE?this.eventDispatcher.dispatchEvent(new Qe(Qe.ADD_HOLE,this.object)):this._currentState===No.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new Qe(Qe.REMOVE_HOLE,this.object))),this._currentState=t)}handleAutomaticStateUpdate(){if(!this.object)return;const t=this.object.model;if(!t)return;const e=t.getValue(I.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(e)||this.handleStateUpdate(e%2)}};vy.STATE_HOLE=0;let u$=vy;const P_=class ag extends he{constructor(){super(...arguments),this._state=-1}initialize(t){super.initialize(t),this.object&&this.object.model.setValue(I.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(t){if(t instanceof Ht){const e=t.data;e?this._state=e.state:this._state=t.state}super.processUpdateMessage(t)}getEventTypes(){const t=[C.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||(this._state===ag.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new C(C.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===ag.STATE_UNLOCKED?We.FRIEND_FURNITURE:We.DUMMY}};P_.STATE_UNINITIALIZED=-1;P_.STATE_UNLOCKED=0;P_.STATE_LOCKED=1;let Ay=P_;const Kh=class bo extends he{getEventTypes(){const t=[Ir.LOAD_BADGE,C.GUILD_FURNI_CONTEXT_MENU,C.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof Ht){const e=t.data;e instanceof Al&&(this.updateGroupId(e.getValue(bo.GROUPID_KEY)),this.updateBadge(e.getValue(bo.BADGE_KEY)),this.updateColors(e.getValue(bo.COLOR1_KEY),e.getValue(bo.COLOR2_KEY)))}else t instanceof ka?t.assetName!=="loading_icon"&&(this.object.model.setValue(I.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,t.assetName),this.update(ft())):t instanceof Ih&&(t.selected||this.eventDispatcher.dispatchEvent(new C(C.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(t){this.object.model.setValue(I.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(t))}updateBadge(t){this.eventDispatcher.dispatchEvent(new Ir(Ir.LOAD_BADGE,this.object,t,!0))}updateColors(t,e){this.object.model.setValue(I.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(t,16)),this.object.model.setValue(I.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(e,16))}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case k.MOUSE_CLICK:this.openContextMenu()}super.mouseEvent(t,e)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new C(C.GUILD_FURNI_CONTEXT_MENU,this.object))}};Kh.GROUPID_KEY=1;Kh.BADGE_KEY=2;Kh.COLOR1_KEY=3;Kh.COLOR2_KEY=4;let Sy=Kh;class l$ extends Sy{getEventTypes(){const t=[C.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}updateGroupId(t){super.updateGroupId(t),this.object.model.setValue(I.FURNITURE_INTERNAL_LINK,`groupforum/${t}`)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new C(C.INERNAL_LINK,this.object)),super.useObject())}}class _$ extends Nt{getEventTypes(){const t=[w.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new w(w.USE_HABBOWHEEL,this.object))}}const yy=class My extends Nt{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[C.HIGH_SCORE_DISPLAY,C.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new C(C.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(t){super.processUpdateMessage(t),this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&t instanceof Ht&&(t.state===My.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new C(C.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new C(C.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=t.state)}};yy.SHOW_WIDGET_IN_STATE=1;let c$=yy;class d$ extends Nt{getEventTypes(){const t=[mt.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case k.DOUBLE_CLICK:switch(t.spriteTag){case"off":s=new mt(mt.STATE_CHANGE,this.object,3);break}break;case k.MOUSE_CLICK:switch(t.spriteTag){case"inc":s=new mt(mt.STATE_CHANGE,this.object,2);break;case"dec":s=new mt(mt.STATE_CHANGE,this.object,1);break}break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new mt(mt.STATE_CHANGE,this.object,3))}}class f$ extends Ay{get engravingDialogType(){return Hn.HABBOWEEN}}class g$ extends he{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(t){if(this._nextStateTimestamp>0&&t>=this._nextStateTimestamp){this._nextStateTimestamp=0;const e=new Rs;e.setString(this._nextState.toString()),super.processUpdateMessage(new Ht(this._nextState,e,this._nextStateExtra))}super.update(t)}processUpdateMessage(t){if(t instanceof Ht){this.processUpdate(t);return}super.processUpdateMessage(t)}processUpdate(t){if(!t)return;const e=~~(t.state/1e3),s=~~(t.state%1e3);if(s)this._nextState=e,this._nextStateExtra=t.extra,this._nextStateTimestamp=this.time+s;else{this._nextStateTimestamp=0;const i=new Rs;i.setString(e.toString()),super.processUpdateMessage(new Ht(e,i,t.extra))}}}class E$ extends Nt{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[C.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&(this.object.model.setValue(I.FURNITURE_INTERNAL_LINK,t.logic.action.link),t.logic.action.startState===1&&(this._showStateOnceRendered=!0))}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount===20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(I.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){!t||!e||(t.type===k.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.INERNAL_LINK,this.object))}}class p$ extends he{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[w.JUKEBOX_START,w.JUKEBOX_MACHINE_STOP,w.JUKEBOX_DISPOSE,w.JUKEBOX_INIT,C.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(Ce.INFOSTAND_EXTRA_PARAM,Ce.JUKEBOX),t instanceof Ht)){const e=this.object.getState(0);e!==this._currentState&&(this._currentState=e,e===1?this.requestPlayList():e===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new w(w.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new w(w.JUKEBOX_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new w(w.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new w(w.JUKEBOX_DISPOSE,this.object))}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new C(C.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new mt(mt.STATE_CHANGE,this.object,-1)))}}class m$ extends Ay{get engravingDialogType(){return Hn.LOVE_LOCK}}const D_=class el extends Nt{getEventTypes(){const t=[C.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Ht&&(t.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const t=new dh;t.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(I.FURNITURE_MANNEQUIN_GENDER,t.getValue(el.GENDER)),this.object.model.setValue(I.FURNITURE_MANNEQUIN_FIGURE,t.getValue(el.FIGURE)),this.object.model.setValue(I.FURNITURE_MANNEQUIN_NAME,t.getValue(el.OUTFIT_NAME))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.MANNEQUIN,this.object))}};D_.GENDER="GENDER";D_.FIGURE="FIGURE";D_.OUTFIT_NAME="OUTFIT_NAME";let I$=D_;class T$ extends he{getEventTypes(){const t=[C.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return We.MONSTERPLANT_SEED}}class R$ extends he{initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(I.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class O$ extends he{getEventTypes(){const t=[C.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return We.MYSTERY_BOX}}class v$ extends he{getEventTypes(){const t=[C.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return We.MYSTERY_TROPHY}}class A$ extends Nt{getEventTypes(){const t=[w.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new w(w.ENTER_ONEWAYDOOR,this.object))}}class S$ extends Nt{getEventTypes(){const t=[C.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(Ce.INFOSTAND_EXTRA_PARAM,Ce.USABLE_PRODUCT)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.PET_PRODUCT_MENU,this.object))}}class y$ extends Nt{getEventTypes(){const t=[C.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.PLACEHOLDER,this.object))}}class M$ extends Nt{initialize(t){super.initialize(t),t.logic&&t.logic.planetSystems&&this.object.model.setValue(I.FURNITURE_PLANETSYSTEM_DATA,t.logic.planetSystems)}}const $a=class ua extends Nt{getEventTypes(){const t=[C.PRESENT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(I.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Ht&&(t.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),t instanceof my&&t.numberKey===I.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(I.FURNITURE_DISABLE_PICKING_ANIMATION,t.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const t=new dh;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(ua.MESSAGE),s=this.object.model.getValue(I.FURNITURE_DATA);!e&&typeof s=="string"?this.object.model.setValue(I.FURNITURE_DATA,s.substr(1)):this.object.model.setValue(I.FURNITURE_DATA,t.getValue(ua.MESSAGE)),this.writeToModel(I.FURNITURE_TYPE_ID,t.getValue(ua.PRODUCT_CODE)),this.writeToModel(I.FURNITURE_PURCHASER_NAME,t.getValue(ua.PURCHASER_NAME)),this.writeToModel(I.FURNITURE_PURCHASER_FIGURE,t.getValue(ua.PURCHASER_FIGURE))}writeToModel(t,e){e&&this.object.model.setValue(t,e)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case k.ROLL_OVER:this.eventDispatcher.dispatchEvent(new w(w.MOUSE_BUTTON,this.object));break;case k.ROLL_OUT:this.eventDispatcher.dispatchEvent(new w(w.MOUSE_ARROW,this.object));break}super.mouseEvent(t,e)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.PRESENT,this.object))}};$a.MESSAGE="MESSAGE";$a.PRODUCT_CODE="PRODUCT_CODE";$a.EXTRA_PARAM="EXTRA_PARAM";$a.PURCHASER_NAME="PURCHASER_NAME";$a.PURCHASER_FIGURE="PURCHASER_FIGURE";let C$=$a;class N$ extends he{getEventTypes(){const t=[C.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return We.PURCHASABLE_CLOTHING}}const L_=class Po extends he{constructor(){super(),this.updateInterval=Pa.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new S}processUpdateMessage(t){if(!t)return;const e=t instanceof Bi;if(this.object&&!e&&t.location){const s=this.object.getLocation(),i=S.dif(t.location,s);if(i&&Math.abs(i.x)<2&&Math.abs(i.y)<2){let n=s;(Math.abs(i.x)>1||Math.abs(i.y)>1)&&(n=S.sum(s,S.product(i,.5))),super.processUpdateMessage(new Bi(n,t.location,t.direction));return}}if(t.location&&!e&&super.processUpdateMessage(new Bi(t.location,t.location,t.direction)),t instanceof Ht){t.state>0?this.updateInterval=Pa.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(t.state):this.updateInterval=1,this.handleDataUpdate(t);return}e&&t.isSlide&&(this.updateInterval=Pa.DEFAULT_UPDATE_INTERVAL),super.processUpdateMessage(t)}getUpdateIntervalValue(t){return t/Po.MAX_ANIMATION_COUNT}getAnimationValue(t){return t%Po.MAX_ANIMATION_COUNT}handleDataUpdate(t){const e=this.getAnimationValue(t.state);if(e!==t.state){const s=new Rs;s.setString(e.toString()),t=new Ht(e,s,t.extra)}super.processUpdateMessage(t)}update(t){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(t),S.dif(this.object.getLocation(),this._oldLocation).length===0&&this.object.getState(0)!==Po.ANIMATION_NOT_MOVING&&this.object.setState(Po.ANIMATION_NOT_MOVING,0))}};L_.ANIMATION_NOT_MOVING=0;L_.ANIMATION_MOVING=1;L_.MAX_ANIMATION_COUNT=10;let b$=L_;class P$ extends Nt{getEventTypes(){const t=[mt.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new mt(mt.STATE_RANDOM,this.object))}}class D$ extends he{get contextMenu(){return We.RANDOM_TELEPORT}}class L$ extends Nt{getEventTypes(){const t=[Ns.RODRE_CURRENT_USER_ID];return this.mergeTypes(super.getEventTypes(),t)}update(t){if(super.update(t),this.object&&this.object.model){this.object.model.getValue(I.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new Ns(Ns.RODRE_CURRENT_USER_ID,this.object));const e=this.object.model.getValue(I.FURNITURE_DATA).getValue("renterId"),s=this.object.model.getValue(I.SESSION_CURRENT_USER_ID);e?parseInt(e)===s?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return st.RENTABLESPACE}}class U$ extends he{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[C.BACKGROUND_COLOR,yi.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new yi(yi.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Ht&&(t.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const t=new zd;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(0),s=t.getValue(1),i=t.getValue(2),n=t.getValue(3);e>-1&&s>-1&&i>-1&&n>-1&&(this.object.model.setValue(I.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,s),this.object.model.setValue(I.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,i),this.object.model.setValue(I.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,n),this.object.setState(e,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new yi(yi.ROOM_BACKGROUND_COLOR,this.object,e===1,s,i,n)),this._roomColorUpdated=!0)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case k.DOUBLE_CLICK:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new C(C.BACKGROUND_COLOR,this.object));return}super.mouseEvent(t,e)}}}var Nn={},Cy={},ii={};Object.defineProperty(ii,"__esModule",{value:!0});ii.loop=ii.conditional=ii.parse=void 0;var x$=function r(t,e){var s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:s;if(Array.isArray(e))e.forEach(function(a){return r(t,a,s,i)});else if(typeof e=="function")e(t,s,i,r);else{var n=Object.keys(e)[0];Array.isArray(e[n])?(i[n]={},r(t,e[n],s,i[n])):i[n]=e[n](t,s,i,r)}return s};ii.parse=x$;var F$=function(t,e){return function(s,i,n,a){e(s,i,n)&&a(s,t,i,n)}};ii.conditional=F$;var w$=function(t,e){return function(s,i,n,a){for(var o=[],h=s.pos;e(s,i,n);){var u={};if(a(s,t,i,u),s.pos===h)break;h=s.pos,o.push(u)}return o}};ii.loop=w$;var ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.readBits=ce.readArray=ce.readUnsigned=ce.readString=ce.peekBytes=ce.readBytes=ce.peekByte=ce.readByte=ce.buildStream=void 0;var G$=function(t){return{data:t,pos:0}};ce.buildStream=G$;var Ny=function(){return function(t){return t.data[t.pos++]}};ce.readByte=Ny;var B$=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return function(e){return e.data[e.pos+t]}};ce.peekByte=B$;var U_=function(t){return function(e){return e.data.subarray(e.pos,e.pos+=t)}};ce.readBytes=U_;var H$=function(t){return function(e){return e.data.subarray(e.pos,e.pos+t)}};ce.peekBytes=H$;var V$=function(t){return function(e){return Array.from(U_(t)(e)).map(function(s){return String.fromCharCode(s)}).join("")}};ce.readString=V$;var k$=function(t){return function(e){var s=U_(2)(e);return t?(s[1]<<8)+s[0]:(s[0]<<8)+s[1]}};ce.readUnsigned=k$;var j$=function(t,e){return function(s,i,n){for(var a=typeof e=="function"?e(s,i,n):e,o=U_(t),h=new Array(a),u=0;u<a;u++)h[u]=o(s);return h}};ce.readArray=j$;var z$=function(t,e,s){for(var i=0,n=0;n<s;n++)i+=t[e+n]&&Math.pow(2,s-n-1);return i},Y$=function(t){return function(e){for(var s=Ny()(e),i=new Array(8),n=0;n<8;n++)i[7-n]=!!(s&1<<n);return Object.keys(t).reduce(function(a,o){var h=t[o];return h.length?a[o]=z$(i,h.index,h.length):a[o]=i[h.index],a},{})}};ce.readBits=Y$;(function(r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var t=ii,e=ce,s={blocks:function(_){for(var d=0,f=[],m=_.data.length,p=0,T=(0,e.readByte)()(_);T!==d&&T;T=(0,e.readByte)()(_)){if(_.pos+T>=m){var v=m-_.pos;f.push((0,e.readBytes)(v)(_)),p+=v;break}f.push((0,e.readBytes)(T)(_)),p+=T}for(var O=new Uint8Array(p),A=0,y=0;y<f.length;y++)O.set(f[y],A),A+=f[y].length;return O}},i=(0,t.conditional)({gce:[{codes:(0,e.readBytes)(2)},{byteSize:(0,e.readByte)()},{extras:(0,e.readBits)({future:{index:0,length:3},disposal:{index:3,length:3},userInput:{index:6},transparentColorGiven:{index:7}})},{delay:(0,e.readUnsigned)(!0)},{transparentColorIndex:(0,e.readByte)()},{terminator:(0,e.readByte)()}]},function(l){var _=(0,e.peekBytes)(2)(l);return _[0]===33&&_[1]===249}),n=(0,t.conditional)({image:[{code:(0,e.readByte)()},{descriptor:[{left:(0,e.readUnsigned)(!0)},{top:(0,e.readUnsigned)(!0)},{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{lct:(0,e.readBits)({exists:{index:0},interlaced:{index:1},sort:{index:2},future:{index:3,length:2},size:{index:5,length:3}})}]},(0,t.conditional)({lct:(0,e.readArray)(3,function(l,_,d){return Math.pow(2,d.descriptor.lct.size+1)})},function(l,_,d){return d.descriptor.lct.exists}),{data:[{minCodeSize:(0,e.readByte)()},s]}]},function(l){return(0,e.peekByte)()(l)===44}),a=(0,t.conditional)({text:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{preData:function(_,d,f){return(0,e.readBytes)(f.text.blockSize)(_)}},s]},function(l){var _=(0,e.peekBytes)(2)(l);return _[0]===33&&_[1]===1}),o=(0,t.conditional)({application:[{codes:(0,e.readBytes)(2)},{blockSize:(0,e.readByte)()},{id:function(_,d,f){return(0,e.readString)(f.blockSize)(_)}},s]},function(l){var _=(0,e.peekBytes)(2)(l);return _[0]===33&&_[1]===255}),h=(0,t.conditional)({comment:[{codes:(0,e.readBytes)(2)},s]},function(l){var _=(0,e.peekBytes)(2)(l);return _[0]===33&&_[1]===254}),u=[{header:[{signature:(0,e.readString)(3)},{version:(0,e.readString)(3)}]},{lsd:[{width:(0,e.readUnsigned)(!0)},{height:(0,e.readUnsigned)(!0)},{gct:(0,e.readBits)({exists:{index:0},resolution:{index:1,length:3},sort:{index:4},size:{index:5,length:3}})},{backgroundColorIndex:(0,e.readByte)()},{pixelAspectRatio:(0,e.readByte)()}]},(0,t.conditional)({gct:(0,e.readArray)(3,function(l,_){return Math.pow(2,_.lsd.gct.size+1)})},function(l,_){return _.lsd.gct.exists}),{frames:(0,t.loop)([i,o,h,n,a],function(l){var _=(0,e.peekByte)()(l);return _===33||_===44})}],c=u;r.default=c})(Cy);var x_={};Object.defineProperty(x_,"__esModule",{value:!0});x_.deinterlace=void 0;var W$=function(t,e){for(var s=new Array(t.length),i=t.length/e,n=function(_,d){var f=t.slice(d*e,(d+1)*e);s.splice.apply(s,[_*e,e].concat(f))},a=[0,4,2,1],o=[8,8,4,2],h=0,u=0;u<4;u++)for(var c=a[u];c<i;c+=o[u])n(c,h),h++;return s};x_.deinterlace=W$;var F_={};Object.defineProperty(F_,"__esModule",{value:!0});F_.lzw=void 0;var X$=function(t,e,s){var i=4096,n=-1,a=s,o,h,u,c,l,_,d,M,f,m,y,p,N,P,D,b,T=new Array(s),v=new Array(i),O=new Array(i),A=new Array(i+1);for(p=t,h=1<<p,l=h+1,o=h+2,d=n,c=p+1,u=(1<<c)-1,f=0;f<h;f++)v[f]=0,O[f]=f;var y,M,N,P,b,D;for(y=M=N=P=b=D=0,m=0;m<a;){if(P===0){if(M<c){y+=e[D]<<M,M+=8,D++;continue}if(f=y&u,y>>=c,M-=c,f>o||f==l)break;if(f==h){c=p+1,u=(1<<c)-1,o=h+2,d=n;continue}if(d==n){A[P++]=O[f],d=f,N=f;continue}for(_=f,f==o&&(A[P++]=N,f=d);f>h;)A[P++]=O[f],f=v[f];N=O[f]&255,A[P++]=N,o<i&&(v[o]=d,O[o]=N,o++,!(o&u)&&o<i&&(c++,u+=o)),d=_}P--,T[b++]=A[P],m++}for(m=b;m<a;m++)T[m]=0;return T};F_.lzw=X$;Object.defineProperty(Nn,"__esModule",{value:!0});var by=Nn.decompressFrames=Nn.decompressFrame=Py=Nn.parseGIF=void 0,K$=$$(Cy),q$=ii,Q$=ce,Z$=x_,J$=F_;function $$(r){return r&&r.__esModule?r:{default:r}}var ttt=function(t){var e=new Uint8Array(t);return(0,q$.parse)((0,Q$.buildStream)(e),K$.default)},Py=Nn.parseGIF=ttt,ett=function(t){for(var e=t.pixels.length,s=new Uint8ClampedArray(e*4),i=0;i<e;i++){var n=i*4,a=t.pixels[i],o=t.colorTable[a]||[0,0,0];s[n]=o[0],s[n+1]=o[1],s[n+2]=o[2],s[n+3]=a!==t.transparentIndex?255:0}return s},Dy=function(t,e,s){if(!t.image){console.warn("gif frame does not have associated image.");return}var i=t.image,n=i.descriptor.width*i.descriptor.height,a=(0,J$.lzw)(i.data.minCodeSize,i.data.blocks,n);i.descriptor.lct.interlaced&&(a=(0,Z$.deinterlace)(a,i.descriptor.width));var o={pixels:a,dims:{top:t.image.descriptor.top,left:t.image.descriptor.left,width:t.image.descriptor.width,height:t.image.descriptor.height}};return i.descriptor.lct&&i.descriptor.lct.exists?o.colorTable=i.lct:o.colorTable=e,t.gce&&(o.delay=(t.gce.delay||10)*10,o.disposalType=t.gce.extras.disposal,t.gce.extras.transparentColorGiven&&(o.transparentIndex=t.gce.transparentColorIndex)),s&&(o.patch=ett(o)),o};Nn.decompressFrame=Dy;var stt=function(t,e){return t.frames.filter(function(s){return s.image}).map(function(s){return Dy(s,t.gct,e)})};by=Nn.decompressFrames=stt;const Xn=class Ss extends Nt{constructor(){super(),this._disableFurnitureSelection=!0,this._hasClickUrl=!1}getEventTypes(){const t=[Yt.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this._disableFurnitureSelection&&this.object.model.setValue(I.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Ht&&this.processAdDataUpdateMessage(t),t instanceof rs&&this.processAdUpdate(t)}processAdDataUpdateMessage(t){if(!t)return;const e=new dh;e.initializeFromRoomObjectModel(this.object.model);const s=parseInt(e.getValue(Ss.STATE));!isNaN(s)&&this.object.getState(0)!==s&&this.object.setState(s,0);const i=e.getValue(Ss.IMAGEURL_KEY),n=this.object.model.getValue(I.FURNITURE_BRANDING_IMAGE_URL);(!n||n!==i)&&(this.object.model.setValue(I.FURNITURE_BRANDING_IMAGE_URL,i),this.object.model.setValue(I.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const a=e.getValue(Ss.CLICKURL_KEY);if(a){const l=this.object.model.getValue(I.FURNITURE_BRANDING_URL);(!l||l!==a)&&this.object.model&&this.object.model.setValue(I.FURNITURE_BRANDING_URL,a)}const o=parseInt(e.getValue(Ss.OFFSETX_KEY)),h=parseInt(e.getValue(Ss.OFFSETY_KEY)),u=parseInt(e.getValue(Ss.OFFSETZ_KEY));isNaN(o)||this.object.model.setValue(I.FURNITURE_BRANDING_OFFSET_X,o),isNaN(h)||this.object.model.setValue(I.FURNITURE_BRANDING_OFFSET_Y,h),isNaN(u)||this.object.model.setValue(I.FURNITURE_BRANDING_OFFSET_Z,u);let c=Ss.IMAGEURL_KEY+"="+(i!==null?i:"")+"	";this._hasClickUrl&&(c=c+(Ss.CLICKURL_KEY+"="+(a!==null?a:"")+"	")),c=c+(Ss.OFFSETX_KEY+"="+o+"	"),c=c+(Ss.OFFSETY_KEY+"="+h+"	"),c=c+(Ss.OFFSETZ_KEY+"="+u+"	"),this.object.model.setValue(Ce.INFOSTAND_EXTRA_PARAM,Ce.BRANDING_OPTIONS+c)}processAdUpdate(t){if(!(!t||!this.object))switch(t.type){case rs.IMAGE_LOADED:this.object.model.setValue(I.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case rs.IMAGE_LOADING_FAILED:this.object.model.setValue(I.FURNITURE_BRANDING_IMAGE_STATUS,-1);break}}mouseEvent(t,e){!t||!e||t.type===k.MOUSE_MOVE||t.type===k.DOUBLE_CLICK||super.mouseEvent(t,e)}async downloadBackground(){const t=this.object&&this.object.model;if(!t)return;const e=t.getValue(I.FURNITURE_BRANDING_IMAGE_URL),s=t.getValue(I.FURNITURE_BRANDING_IMAGE_STATUS);if(!(!e||e===""||s===1))if(e.endsWith(".gif"))this.object.model.setValue(I.FURNITURE_BRANDING_IS_ANIMATED,!0),fetch(e).then(i=>i.arrayBuffer()).then(i=>Py(i)).then(i=>{const n=i.lsd.width,a=i.lsd.height,o=n*a,h=by(i,!1),u=[],c=[];let l=new Uint8Array(o*4);for(let _=0;_<h.length;_++){_>0&&(l=l.slice(0));const d=h[_].pixels,f=h[_].colorTable,m=h[_].transparentIndex,p=h[_].dims;for(let v=0;v<p.height;v++)for(let O=0;O<p.width;O++){const A=d[v*p.width+O],y=(v+p.top)*n+(O+p.left);if(m!==A){const M=f[A];l[4*y]=M[0],l[4*y+1]=M[1],l[4*y+2]=M[2],l[4*y+3]=255}}const T=Xt.fromBuffer(l,n,a);u.push(new _t(T)),c.push(h[_].delay)}Q.instance.roomEngine.roomContentLoader.createGifCollection(e,u,c),this.processUpdateMessage(new rs(rs.IMAGE_LOADED))}).catch(i=>{this.processUpdateMessage(new rs(rs.IMAGE_LOADING_FAILED))});else{const i=Cs();if(!i)return;if(!i.getTexture(e)){await i.downloadAsset(e)?this.processUpdateMessage(new rs(rs.IMAGE_LOADED)):this.processUpdateMessage(new rs(rs.IMAGE_LOADING_FAILED));return}this.processUpdateMessage(new rs(rs.IMAGE_LOADED))}}};Xn.STATE="state";Xn.IMAGEURL_KEY="imageUrl";Xn.CLICKURL_KEY="clickUrl";Xn.OFFSETX_KEY="offsetX";Xn.OFFSETY_KEY="offsetY";Xn.OFFSETZ_KEY="offsetZ";let Ly=Xn;class rtt extends Ly{getAdClickUrl(t){return null}}class itt extends Ly{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(t){return t.getValue(I.FURNITURE_BRANDING_URL)}handleAdClick(t,e,s){if(s.indexOf("http")===0){Xl.openWebPage(s);return}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Yt(Yt.ROOM_AD_FURNI_CLICK,this.object,"",s))}}class ntt extends Nt{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[C.DIMMER,C.WIDGET_REMOVE_DIMMER,Zo.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.eventDispatcher.dispatchEvent(new Zo(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new C(C.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(t){if(t instanceof Ht){if(t.data){const e=t.data.getLegacyString();this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processDimmerData(e),super.processUpdateMessage(new Ht(this.getStateFromDimmerData(e),t.data))}return}super.processUpdateMessage(t)}getStateFromDimmerData(t){if(!t)return 0;const e=t.split(",");return e.length>=5?parseInt(e[0])-1:0}processDimmerData(t){if(!t)return;const e=t.split(",");if(e.length>=5){const s=this.getStateFromDimmerData(t),i=parseInt(e[1]),n=parseInt(e[2]),a=e[3];let o=parseInt(a.substr(1),16),h=parseInt(e[4]);s||(o=16777215,h=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new Zo(this.object,s,i,n,o,h)),this._roomColorUpdated=!0)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.DIMMER,this.object))}update(t){super.update(t)}}const AE=class Do extends Nt{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(t){if(t instanceof Ht)return this.updateScore(t.state);super.processUpdateMessage(t)}updateScore(t){this._score=t;const e=this.object.getState(0);if(this._score!==e){let s=this._score-e;s<0&&(s=-s),s*Do.UPDATE_INTERVAL>Do.MAX_UPDATE_TIME?this._scoreIncreaser=Do.MAX_UPDATE_TIME/s:this._scoreIncreaser=Do.UPDATE_INTERVAL,this._scoreTimer=ft()}}update(t){super.update(t);const e=this.object.getState(0);if(e!==this._score&&t>=this._scoreTimer+this._scoreIncreaser){const s=t-this._scoreTimer;let i=s/this._scoreIncreaser,n=1;this._score<e&&(n=-1),i>n*(this._score-e)&&(i=n*(this._score-e)),this.object.setState(e+n*i,0),this._scoreTimer=t-(s-i*this._scoreIncreaser)}}};AE.UPDATE_INTERVAL=50;AE.MAX_UPDATE_TIME=3e3;let att=AE;class ott extends Nt{processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1){const e=this.object.model.getValue(I.FURNITURE_EXTRAS),s=parseInt(e);this.object.model.setValue(Ce.INFOSTAND_EXTRA_PARAM,Ce.SONGDISK+s)}}}const w_=class fi extends he{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const t=[ie.ROOM_OBJECT_INITIALIZED,ie.ROOM_OBJECT_DISPOSED,ie.PLAY_SAMPLE,ie.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.soundSample&&(this._sampleId=t.logic.soundSample.id,this._noPitch=t.logic.soundSample.noPitch),this.object.model.setValue(I.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}onDispose(){this._state!==fi.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new ie(ie.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.onDispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Ht&&this.updateSoundBlockMessage(t)}updateSoundBlockMessage(t){if(!t)return;const e=this.object&&this.object.model,s=this.object&&this.object.location;!e||!s||(this._state===fi.STATE_UNINITIALIZED&&e.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new ie(ie.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==fi.STATE_UNINITIALIZED&&e.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&this._lastLocZ!==s.z&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new ie(ie.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==fi.STATE_UNINITIALIZED&&t.state!==this._state&&this.playSoundAt(s.z),this._state=t.state)}playSoundAt(t){if(!this.object)return;const e=this.getPitchForHeight(t);this.object.model.setValue(I.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,e),this.eventDispatcher.dispatchEvent(new ie(ie.PLAY_SAMPLE,this.object,this._sampleId,e))}getPitchForHeight(t){if(this._noPitch)return 1;let e=t*2;return e>fi.HIGHEST_SEMITONE&&(e=Math.min(0,fi.LOWEST_SEMITONE+(e-fi.HIGHEST_SEMITONE-1))),Math.pow(2,e/12)}};w_.HIGHEST_SEMITONE=12;w_.LOWEST_SEMITONE=-12;w_.STATE_UNINITIALIZED=-1;let htt=w_;class utt extends he{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[w.SOUND_MACHINE_START,w.SOUND_MACHINE_STOP,w.SOUND_MACHINE_DISPOSE,w.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(I.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(Ce.INFOSTAND_EXTRA_PARAM,Ce.JUKEBOX),t instanceof Ht)){const e=this.object.getState(0);e!==this._currentState&&(this._currentState=e,e===1?this.requestPlayList():e===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new w(w.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new w(w.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new w(w.SOUND_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new w(w.SOUND_MACHINE_DISPOSE,this.object))}}const Uy=class xy extends Nt{getEventTypes(){const t=[C.STICKIE,w.STICKIE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.updateColor(),this.object&&this.object.model.setValue(I.FURNITURE_IS_STICKIE,"")}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof RE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new C(C.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const t=this.object.model.getValue(I.FURNITURE_DATA);let e=xy.STICKIE_COLORS.indexOf(t);e<0&&(e=3),this.object.model.setValue(I.FURNITURE_COLOR,e+1)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new w(w.STICKIE,this.object))}};Uy.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];let ltt=Uy;class _tt extends Nt{getEventTypes(){const t=[C.TROPHY];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.TROPHY,this.object))}}const SE=class Lo extends he{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof Ht){const e=t.data;if(!e)return;this.updateTotal(e.result)}}updateTotal(t){if(this._total=t,!this._lastUpdate){this.object.model.setValue(I.FURNITURE_VOTE_COUNTER_COUNT,t),this._lastUpdate=ft();return}if(this._total!==this.currentTotal){const e=Math.abs(this._total-this.currentTotal);e*Lo.UPDATE_INTERVAL>Lo.MAX_UPDATE_TIME?this._interval=Lo.MAX_UPDATE_TIME/e:this._interval=Lo.UPDATE_INTERVAL,this._lastUpdate=ft()}}update(t){if(super.update(t),this.object&&this.currentTotal!==this._total&&t>=this._lastUpdate+this._interval){const e=t-this._lastUpdate;let s=e/this._interval,i=1;this._total<this.currentTotal&&(i=-1),s>i*(this._total-this.currentTotal)&&(s=i*(this._total-this.currentTotal)),this.object.model.setValue(I.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+i*s),this._lastUpdate=t-(e-s*this._interval)}}get currentTotal(){return this.object.model.getValue(I.FURNITURE_VOTE_COUNTER_COUNT)}};SE.UPDATE_INTERVAL=33;SE.MAX_UPDATE_TIME=1e3;let ctt=SE;class dtt extends he{processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object&&t instanceof Ht){const e=t.data;e instanceof Yd&&this.object.model.setValue(I.FURNITURE_VOTE_MAJORITY_RESULT,e.result)}}}class ftt extends he{mouseEvent(t,e){!t||!e||(t.type===k.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new mt(mt.STATE_CHANGE,this.object)),super.mouseEvent(t,e))}}class gtt extends he{initialize(t){super.initialize(t);let e="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(I.FURNITURE_USES_PLANE_MASK,1),this.object.model.setValue(I.FURNITURE_PLANE_MASK_TYPE,e)}}class Ett extends Nt{getEventTypes(){const t=[C.YOUTUBE,Ns.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),t)}update(t){super.update(t),this.object.model.getValue(I.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new Ns(Ns.RODRE_URL_PREFIX,this.object))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new C(C.YOUTUBE,this.object))}}class ptt extends Pa{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const t=[et.CLICK,$e.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic&&t.logic.model){const s=t.logic.model.directions;if(s&&s.length){for(const i of s)this._directions.push(i);this._directions.sort()}}e.setValue(I.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new $e($e.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const e=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==e.x||this._reportedLocation.y!==e.y||this._reportedLocation.z!==e.z)&&(this._reportedLocation||(this._reportedLocation=new S),this._reportedLocation.assign(e),this.eventDispatcher.dispatchEvent(new $e($e.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(t,this.object.model)}updateModel(t,e){this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(I.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&t>this._talkingEndTimestamp&&(e.setValue(I.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&t>this._expressionEndTimestamp&&(e.setValue(I.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof Vl){e.setValue(I.HEAD_DIRECTION,t.headDirection);return}if(t instanceof Bl){const s=new ql(t.figure);e.setValue(I.FIGURE,t.figure),e.setValue(I.RACE,t.subType),e.setValue(I.PET_PALETTE_INDEX,s.paletteId),e.setValue(I.PET_COLOR,s.color),e.setValue(I.PET_TYPE,s.typeId),e.setValue(I.PET_CUSTOM_LAYER_IDS,s.customLayerIds),e.setValue(I.PET_CUSTOM_PARTS_IDS,s.customPartIds),e.setValue(I.PET_CUSTOM_PALETTE_IDS,s.customPaletteIds),e.setValue(I.PET_IS_RIDING,t.isRiding?1:0);return}if(t instanceof IE){e.setValue(I.FIGURE_POSTURE,t.postureType);return}if(t instanceof mE){e.setValue(I.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof TE){e.setValue(I.FIGURE_SLEEP,t.isSleeping?1:0);return}if(t instanceof _y){e.setValue(I.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof Hl){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof ny){e.setValue(I.FIGURE_EXPERIENCE_TIMESTAMP,this.time),e.setValue(I.FIGURE_GAINED_EXPERIENCE,t.gainedExperience);return}}}mouseEvent(t,e){let s=null;switch(t.type){case k.MOUSE_CLICK:s=et.CLICK;break;case k.DOUBLE_CLICK:break;case k.MOUSE_DOWN:{this.object.model.getValue(I.PET_TYPE)===Rt.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new et(et.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown));break}}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new et(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}}class Fy{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get wallHeight(){return this._wallHeight}set wallHeight(t){this._wallHeight=t}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(t){this._fixedWallsHeight=t}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}}class xn{constructor(t,e,s){this.type=t,this.loc=e,this.category=s}get loc(){return this._loc}set loc(t){this._loc||(this._loc=new S),this._loc.assign(t)}get type(){return this._type}set type(t){this._type=t}get category(){return this._category}set category(t){this._category=t}dispose(){this._loc=null}}xn.WINDOW="window";xn.HOLE="hole";class mtt{constructor(){this._masks=[]}get masks(){return this._masks}}class wy{constructor(){this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(t){if(!t)return!1;if(this._masks.clear(),t.masks.length)for(const e of t.masks){if(!e)continue;const s=e.locations.length?e.locations[0]:null;s&&this._masks.set(e.id,new xn(e.type,s,e.category))}return!0}reset(){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}addMask(t,e,s,i){const n=new xn(e,s,i);this._masks.delete(t),this._masks.set(t,n)}removeMask(t){const e=this._masks.get(t);return e?(this._masks.delete(t),e.dispose(),!0):!1}getXML(){const t=new mtt;for(const[e,s]of this._masks.entries()){if(!s)continue;const i=this.getMaskType(s),n=this.getMaskCategory(s),a=this.getMaskLocation(s);if(i&&n&&a){const o={id:e,type:i,category:n,locations:[{x:a.x,y:a.y,z:a.z}]};t.masks.push(o)}}return t}getMaskLocation(t){return t?t.loc:null}getMaskType(t){return t?t.type:null}getMaskCategory(t){return t?t.category:null}get masks(){return this._masks}}class Itt{constructor(t,e,s,i){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}class qt{constructor(t,e,s,i,n){this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null;let a,o,h,u,c,l,_,d;if(this._secondaryNormals=[],this._masks=[],this._loc=new S,this._loc.assign(e),this._leftSide=new S,this._leftSide.assign(s),this._rightSide=new S,this._rightSide.assign(i),this._type=t,s!=null&&i!=null&&(this._normal=S.crossProduct(s,i),a=0,o=0,h=0,u=0,c=0,this.normal.x!=0||this.normal.y!=0?(u=this.normal.x,c=this.normal.y,a=360+Math.atan2(c,u)/Math.PI*180,a>=360&&(a=a-360),u=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),c=this.normal.z,o=360+Math.atan2(c,u)/Math.PI*180,o>=360&&(o=o-360)):this.normal.z<0?o=90:o=270,this._normalDirection=new S(a,o,h)),n!=null&&n.length>0)for(l=0;l<n.length;)_=n[l],_!=null&&_.length>0&&(d=new S,d.assign(_),d.multiply(1/d.length),this._secondaryNormals.push(d)),l++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(t){if(t<0||t>=this.secondaryNormalCount)return null;const e=new S;return e.assign(this._secondaryNormals[t]),e}addMask(t,e,s,i){const n=new Itt(t,e,s,i);this._masks.push(n)}getMask(t){return t<0||t>=this.maskCount?null:this._masks[t]}getMaskLeftSideLoc(t){const e=this.getMask(t);return e!=null?e.leftSideLoc:-1}getMaskRightSideLoc(t){const e=this.getMask(t);return e!=null?e.rightSideLoc:-1}getMaskLeftSideLength(t){const e=this.getMask(t);return e!=null?e.leftSideLength:-1}getMaskRightSideLength(t){const e=this.getMask(t);return e!=null?e.rightSideLength:-1}}qt.PLANE_UNDEFINED=0;qt.PLANE_FLOOR=1;qt.PLANE_WALL=2;qt.PLANE_LANDSCAPE=3;qt.PLANE_BILLBOARD=4;class Ttt{constructor(t,e,s,i){this._x=t,this._y=e,this._width=s,this._height=i}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}const yE=class og{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(t,e,s,i,n){(this._addDuplicates||this.checkIsNotDuplicate(t,e,s,i,n))&&(this._corners.push(t),this._directions.push(e),this._lengths.push(s),this._borders.push(i),this._leftTurns.push(n),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(t,e,s,i,n){let a=0;for(;a<this._count;){if(this._corners[a].x==t.x&&this._corners[a].y==t.y&&this._directions[a]==e&&this._lengths[a]==s&&this._borders[a]==i&&this._leftTurns[a]==n)return!1;a++}return!0}get count(){return this._count}getCorner(t){return this._corners[t]}getEndPoint(t){return this.calculateWallEndPoints(),this._endPoints[t]}getLength(t){return this._lengths[t]}getDirection(t){return this._directions[t]}getBorder(t){return this._borders[t]}getHideWall(t){return this._hideWalls[t]}getLeftTurn(t){return this._leftTurns[t]}getManuallyLeftCut(t){return this._manuallyLeftCut[t]}getManuallyRightCut(t){return this._manuallyRightCut[t]}setHideWall(t,e){this._hideWalls[t]=e}setLength(t,e){e<this._lengths[t]&&(this._lengths[t]=e,this._manuallyRightCut[t]=!0)}moveCorner(t,e){let s;if(e>0&&e<this._lengths[t]){const i=this._corners[t];s=og.WALL_DIRECTION_VECTORS[this.getDirection(t)],this._corners[t]=new B(i.x+e*s.x,i.y+e*s.y),this._lengths[t]=this._lengths[t]-e,this._manuallyLeftCut[t]=!0}}calculateWallEndPoints(){let t,e,s,i,n;if(this._endPoints.length!=this.count)for(this._endPoints=[],t=0;t<this.count;)e=this.getCorner(t),s=new B(e.x,e.y),i=og.WALL_DIRECTION_VECTORS[this.getDirection(t)],n=this.getLength(t),s.x=s.x+i.x*n,s.y=s.y+i.y*n,this._endPoints.push(s),t++}};yE.WALL_DIRECTION_VECTORS=[new S(1,0,0),new S(0,1,0),new S(-1,0,0),new S(0,-1,0)];yE.WALL_NORMAL_VECTORS=[new S(0,1,0),new S(-1,0,0),new S(0,-1,0),new S(1,0,0)];let _i=yE;const to=class Mt{constructor(){this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._fixedWallHeight=-1,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map}static getFloorHeight(t){const e=t.length;if(!e)return 0;let s=0,i=0;for(;i<e;){const n=t[i];let a=0;for(;a<n.length;){const o=n[a];o>s&&(s=o),a++}i++}return s}static findEntranceTile(t){if(!t)return null;const e=t.length;if(!e)return null;const s=[];let i=0;for(;i<e;){const n=t[i];if(!n||!n.length)return null;let a=0;for(;a<n.length;){if(n[a]>=0){s.push(a);break}a++}s.length<i+1&&s.push(n.length+1),i++}for(i=1;i<s.length-1;){if(Math.trunc(s[i])<=Math.trunc(s[i-1])-1&&Math.trunc(s[i])<=Math.trunc(s[i+1])-1)return new B(Math.trunc(s[i]|0),i);i++}return null}static expandFloorTiles(t){let e,s,i,n,a,o,h,u,c,l,_,d;const f=t.length,m=t[0].length,p=[];for(s=0;s<f*4;)p[s]=[],s++;let T=0;for(s=0;s<f;){for(a=0,e=0;e<m;){if(o=t[s][e],o<0||o<=255)for(n=0;n<4;){for(i=0;i<4;)p[T+n]===void 0&&(p[T+n]=[]),p[T+n][a+i]=o<0?o:o*4,i++;n++}else{for(h=(o&255)*4,u=h+(o>>11&1)*3,c=h+(o>>10&1)*3,l=h+(o>>9&1)*3,_=h+(o>>8&1)*3,i=0;i<3;)d=i+1,p[T][a+i]=(u*(3-i)+c*i)/3,p[T+3][a+d]=(l*(3-d)+_*d)/3,p[T+d][a]=(u*(3-d)+l*d)/3,p[T+i][a+3]=(c*(3-i)+_*i)/3,i++;p[T+1][a+1]=u>h?h+2:h+1,p[T+1][a+2]=c>h?h+2:h+1,p[T+2][a+1]=l>h?h+2:h+1,p[T+2][a+2]=_>h?h+2:h+1}a=a+4,e++}T=T+4,s++}return p}static addTileTypes(t){let e,s,i,n,a,o,h,u,c,l,_,d,f;const m=t.length-1,p=t[0].length-1;for(s=1;s<m;){for(e=1;e<p;)i=t[s][e],i<0||(n=t[s-1][e-1]&255,a=t[s-1][e]&255,o=t[s-1][e+1]&255,h=t[s][e-1]&255,u=t[s][e+1]&255,c=t[s+1][e-1]&255,l=t[s+1][e]&255,_=t[s+1][e+1]&255,d=i+1,f=(n==d||a==d||h==d?8:0)|(o==d||a==d||u==d?4:0)|(c==d||l==d||h==d?2:0)|(_==d||l==d||u==d?1:0),f==15&&(f=0),t[s][e]=i|f<<8),e++;s++}}static unpadHeightMap(t){t.shift(),t.pop();for(const e of t)e.shift(),e.pop()}static padHeightMap(t){const e=[],s=[];for(const i of t)i.push(Mt.TILE_BLOCKED),i.unshift(Mt.TILE_BLOCKED);for(const i of t[0])e.push(Mt.TILE_BLOCKED),s.push(Mt.TILE_BLOCKED);t.push(s),t.unshift(e)}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}get floorHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight:this._floorHeight}get wallHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(t){t<0&&(t=0),this._wallHeight=t}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(t){t<0&&(t=0),this._wallThicknessMultiplier=t}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(t){t<0&&(t=0),this._floorThicknessMultiplier=t}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,this._floorHoles!=null&&(this._floorHoles.clear(),this._floorHoles=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(t,e){t<0&&(t=0),e<0&&(e=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let s=0;for(;s<e;){const i=[],n=[],a=[];let o=0;for(;o<t;)i[o]=Mt.TILE_BLOCKED,n[o]=Mt.TILE_BLOCKED,a[o]=!1,o++;this._tileMatrix.push(i),this._tileMatrixOriginal.push(n),this._floorHoleMatrix.push(a),s++}return this._width=t,this._height=e,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(t,e,s){let i,n,a,o,h;if(t>=0&&t<this._width&&e>=0&&e<this._height){if(i=this._tileMatrix[e],i[t]=s,s>=0)t<this._minX&&(this._minX=t),t>this._maxX&&(this._maxX=t),e<this._minY&&(this._minY=e),e>this._maxY&&(this._maxY=e);else{if(t==this._minX||t==this._maxX){for(n=!1,a=this._minY;a<this._maxY;){if(this.getTileHeightInternal(t,a)>=0){n=!0;break}a++}n||(t==this._minX&&this._minX++,t==this._maxX&&this._maxX--)}if(e==this._minY||e==this._maxY){for(o=!1,h=this._minX;h<this._maxX;){if(this.getTileHeight(h,e)>=0){o=!0;break}h++}o||(e==this._minY&&this._minY++,e==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return Mt.TILE_BLOCKED;const s=this._tileMatrix[e];return s[t]===void 0?0:Math.abs(s[t])}getTileHeightOriginal(t,e){return t<0||t>=this._width||e<0||e>=this._height?Mt.TILE_BLOCKED:this._floorHoleMatrix[e][t]?Mt.TILE_HOLE:this._tileMatrixOriginal[e][t]}getTileHeightInternal(t,e){return t<0||t>=this._width||e<0||e>=this._height?Mt.TILE_BLOCKED:this._tileMatrix[e][t]}initializeFromTileData(t=-1){let e,s;for(this._fixedWallHeight=t,s=0;s<this._height;){for(e=0;e<this._width;)this._tileMatrixOriginal[s]===void 0&&(this._tileMatrixOriginal[s]=[]),this._tileMatrixOriginal[s][e]=this._tileMatrix[s][e],e++;s++}const i=Mt.findEntranceTile(this._tileMatrix);for(s=0;s<this._height;){for(e=0;e<this._width;)this._floorHoleMatrix[s]===void 0&&(this._floorHoleMatrix[s]=[]),this._floorHoleMatrix[s][e]&&this.setTileHeight(e,s,Mt.TILE_HOLE),e++;s++}return this.initialize(i)}initialize(t){let e=0;t!=null&&(e=this.getTileHeight(t.x,t.y),this.setTileHeight(t.x,t.y,Mt.TILE_BLOCKED)),this._floorHeight=Mt.getFloorHeight(this._tileMatrix),this.createWallPlanes();const s=[];for(const n of this._tileMatrix)s.push(n.concat());Mt.padHeightMap(s),Mt.addTileTypes(s),Mt.unpadHeightMap(s);const i=Mt.expandFloorTiles(s);return this.extractPlanes(i),t!=null&&(this.setTileHeight(t.x,t.y,e),this.addFloor(new S(t.x+.5,t.y+.5,e),new S(-1,0,0),new S(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(t,e){let s,i,n,a,o;const h=new _i,u=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let c=0,l=new B(t.x,t.y),_=0;for(;_++<1e3;){if(s=!1,i=!1,n=c,(l.x<this.minX||l.x>this.maxX||l.y<this.minY||l.y>this.maxY)&&(s=!0),a=u[c](l,e),a==null)return null;if(o=Math.abs(a.x-l.x)+Math.abs(a.y-l.y),l.x==a.x||l.y==a.y?(c=(c-1+u.length)%u.length,o=o+1,i=!0):(c=(c+1)%u.length,o--),h.addWall(l,n,o,s,i),a.x==t.x&&a.y==t.y&&(a.x!=l.x||a.y!=l.y))break;l=a}return h.count==0?null:h}hidePeninsulaWallChains(t){let e,s,i,n,a=0;const o=t.count;for(;a<o;){const h=a;for(e=a,s=0,i=!1;!t.getBorder(a)&&a<o;)t.getLeftTurn(a)?s++:s>0&&s--,s>1&&(i=!0),e=a,a++;if(i)for(n=h;n<=e;)t.setHideWall(n,!0),n++;a++}}updateWallsNextToHoles(t){let e,s,i,n,a,o,h;const u=t.count;let c=0;for(;c<u;){if(!t.getHideWall(c)){for(e=t.getCorner(c),s=t.getDirection(c),i=t.getLength(c),n=_i.WALL_DIRECTION_VECTORS[s],a=_i.WALL_NORMAL_VECTORS[s],o=0,h=0;h<i;){if(this.getTileHeightInternal(e.x+h*n.x-a.x,e.y+h*n.y-a.y)==Mt.TILE_HOLE){if(h>0&&o==0){t.setLength(c,h);break}o++}else if(o>0){t.moveCorner(c,o);break}h++}o==i&&t.setHideWall(c,!0)}c++}}resolveOriginalWallIndex(t,e,s){let i,n,a,o,h,u;const c=Math.min(t.y,e.y),l=Math.max(t.y,e.y),_=Math.min(t.x,e.x),d=Math.max(t.x,e.x),f=s.count;let m=0;for(;m<f;){if(i=s.getCorner(m),n=s.getEndPoint(m),t.x==e.x){if(i.x==t.x&&n.x==t.x&&(a=Math.min(i.y,n.y),o=Math.max(i.y,n.y),a<=c&&l<=o))return m}else if(t.y==e.y&&i.y==t.y&&n.y==t.y&&(h=Math.min(i.x,n.x),u=Math.max(i.x,n.x),h<=_&&d<=u))return m;m++}return-1}hideOriginallyHiddenWalls(t,e){let s,i,n,a,o;const h=t.count;let u=0;for(;u<h;)t.getHideWall(u)||(s=t.getCorner(u),i=new B(s.x,s.y),n=_i.WALL_DIRECTION_VECTORS[t.getDirection(u)],a=t.getLength(u),i.x=i.x+n.x*a,i.y=i.y+n.y*a,o=this.resolveOriginalWallIndex(s,i,e),o>=0?e.getHideWall(o)&&t.setHideWall(u,!0):t.setHideWall(u,!0)),u++}checkWallHiding(t,e){this.hidePeninsulaWallChains(e),this.updateWallsNextToHoles(t),this.hideOriginallyHiddenWalls(t,e)}addWalls(t,e){const s=t.count,i=e.count;let n=0;for(;n<s;){if(!t.getHideWall(n)){const a=t.getCorner(n),o=t.getDirection(n),h=t.getLength(n),u=_i.WALL_DIRECTION_VECTORS[o],c=_i.WALL_NORMAL_VECTORS[o];let l=-1,_=0;for(;_<h;){const x=this.getTileHeightInternal(a.x+_*u.x+c.x,a.y+_*u.y+c.y);x>=0&&(x<l||l<0)&&(l=x),_++}const d=l;let f=new S(a.x,a.y,d);f=S.sum(f,S.product(c,.5)),f=S.sum(f,S.product(u,-.5));const m=this.wallHeight+Math.min(Mt.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-l,p=S.product(u,-h),T=new S(0,0,m);f=S.dif(f,p);const v=this.resolveOriginalWallIndex(a,t.getEndPoint(n),e);let O=0,A=0;v>=0?(O=e.getDirection((v+1)%i),A=e.getDirection((v-1+i)%i)):(O=t.getDirection((n+1)%s),A=t.getDirection((n-1+s)%s));let y=null;(O-o+4)%4==3?y=_i.WALL_NORMAL_VECTORS[O]:(o-A+4)%4==3&&(y=_i.WALL_NORMAL_VECTORS[A]);const M=t.getLeftTurn(n),N=t.getLeftTurn((n-1+s)%s),P=t.getHideWall((n+1)%s),b=t.getManuallyLeftCut(n),D=t.getManuallyRightCut(n);this.addWall(f,p,T,y,!N||b,!M||D,!P)}n++}}createWallPlanes(){const t=this._tileMatrix;if(t==null)return!1;let e,s,i;const n=t.length;let a=0;if(n==0)return!1;for(e=0;e<n;){if(i=t[e],i==null||i.length==0)return!1;a>0?a=Math.min(a,i.length):a=i.length,e++}const o=Math.min(Mt.MAX_WALL_ADDITIONAL_HEIGHT,this._fixedWallHeight!=-1?this._fixedWallHeight:Mt.getFloorHeight(t)),h=this.minX;let u=this.minY;for(u=this.minY;u<=this.maxY;){if(this.getTileHeightInternal(h,u)>Mt.TILE_HOLE){u--;break}u++}if(u>this.maxY)return!1;const c=new B(h,u),l=this.generateWallData(c,!0),_=this.generateWallData(c,!1);for(l!=null&&(l.count,_.count,this.checkWallHiding(l,_),this.addWalls(l,_)),s=0;s<this.tileMapHeight;){for(e=0;e<this.tileMapWidth;)this.getTileHeightInternal(e,s)<0&&this.setTileHeight(e,s,-(o+this.wallHeight)),e++;s++}return!0}extractTopWall(t,e){if(t==null)return null;let s=1,i=Mt.TILE_HOLE;for(e||(i=Mt.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x+s,t.y)>i)return new B(t.x+s-1,t.y);if(this.getTileHeightInternal(t.x+s,t.y+1)<=i)return new B(t.x+s,t.y+1);s++}return null}extractRightWall(t,e){if(t==null)return null;let s=1,i=Mt.TILE_HOLE;for(e||(i=Mt.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y+s)>i)return new B(t.x,t.y+(s-1));if(this.getTileHeightInternal(t.x-1,t.y+s)<=i)return new B(t.x-1,t.y+s);s++}return null}extractBottomWall(t,e){if(t==null)return null;let s=1,i=Mt.TILE_HOLE;for(e||(i=Mt.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x-s,t.y)>i)return new B(t.x-(s-1),t.y);if(this.getTileHeightInternal(t.x-s,t.y-1)<=i)return new B(t.x-s,t.y-1);s++}return null}extractLeftWall(t,e){if(t==null)return null;let s=1,i=Mt.TILE_HOLE;for(e||(i=Mt.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y-s)>i)return new B(t.x,t.y-(s-1));if(this.getTileHeightInternal(t.x+1,t.y-s)<=i)return new B(t.x+1,t.y-s);s++}return null}addWall(t,e,s,i,n,a,o){this.addPlane(qt.PLANE_WALL,t,e,s,[i]),this.addPlane(qt.PLANE_LANDSCAPE,t,e,s,[i]);const h=Mt.WALL_THICKNESS*this._wallThicknessMultiplier,u=Mt.FLOOR_THICKNESS*this._floorThicknessMultiplier,c=S.crossProduct(e,s),l=S.product(c,1/c.length*-h);if(this.addPlane(qt.PLANE_WALL,S.sum(t,s),e,l,[c,i]),n&&this.addPlane(qt.PLANE_WALL,S.sum(S.sum(t,e),s),S.product(s,-(s.length+u)/s.length),l,[c,i]),a&&(this.addPlane(qt.PLANE_WALL,S.sum(t,S.product(s,-u/s.length)),S.product(s,(s.length+u)/s.length),l,[c,i]),o)){const _=S.product(e,h/e.length);this.addPlane(qt.PLANE_WALL,S.sum(S.sum(t,s),S.product(_,-1)),_,l,[c,e,i])}}addFloor(t,e,s,i,n,a,o){let h,u,c;this.addPlane(qt.PLANE_FLOOR,t,e,s)!=null&&(h=Mt.FLOOR_THICKNESS*this._floorThicknessMultiplier,u=new S(0,0,h),c=S.dif(t,u),a&&this.addPlane(qt.PLANE_FLOOR,c,e,u),o&&this.addPlane(qt.PLANE_FLOOR,S.sum(c,S.sum(e,s)),S.product(e,-1),u),i&&this.addPlane(qt.PLANE_FLOOR,S.sum(c,s),S.product(s,-1),u),n&&this.addPlane(qt.PLANE_FLOOR,S.sum(c,e),s,u))}initializeFromMapData(t){if(!t)return!1;this.reset(),this.resetFloorHoles();const e=t.width,s=t.height,i=t.wallHeight,n=t.fixedWallsHeight;if(this.initializeTileMap(e,s),t.tileMap){let a=0;for(;a<t.tileMap.length;){const o=t.tileMap[a];if(o){let h=0;for(;h<o.length;){const u=o[h];u&&this.setTileHeight(h,a,u.height),h++}}a++}}if(t.holeMap&&t.holeMap.length){let a=0;for(;a<t.holeMap.length;){const o=t.holeMap[a];o&&(this.addFloorHole(o.id,o.x,o.y,o.width,o.height),a++)}this.initializeHoleMap()}return this.wallHeight=i,this.restrictsDragging=t.restrictsDragging,this.restrictsScaling=t.restrictsScaling,this.restrictedScale=t.restrictedScale,this.initializeFromTileData(n),!0}addPlane(t,e,s,i,n=null){if(s.length==0||i.length==0)return null;const a=new qt(t,e,s,i,n);return this._planes.push(a),a}getMapData(){const t=new Fy;t.width=this._width,t.height=this._height,t.wallHeight=this._wallHeight,t.fixedWallsHeight=this._fixedWallHeight,t.dimensions.minX=this.minX,t.dimensions.maxX=this.maxX,t.dimensions.minY=this.minY,t.dimensions.maxY=this.maxY,t.restrictsDragging=this.restrictsDragging,t.restrictsScaling=this.restrictsScaling,t.restrictedScale=this.restrictedScale;let e=0;for(;e<this._height;){const s=[],i=this._tileMatrixOriginal[e];let n=0;for(;n<this._width;){const a=i[n];s.push({height:a}),n++}t.tileMap.push(s),e++}for(const[s,i]of this._floorHoles.entries())i&&t.holeMap.push({id:s,x:i.x,y:i.y,width:i.width,height:i.height});return t}getPlaneLocation(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.loc:null}getPlaneNormal(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normal:null}getPlaneLeftSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.leftSide:null}getPlaneRightSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.rightSide:null}getPlaneNormalDirection(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normalDirection:null}getPlaneSecondaryNormals(t){let e,s;if(t<0||t>=this.planeCount)return null;const i=this._planes[t];if(i!=null){for(e=[],s=0;s<i.secondaryNormalCount;)e.push(i.getSecondaryNormal(s)),s++;return e}return null}getPlaneType(t){if(t<0||t>=this.planeCount)return qt.PLANE_UNDEFINED;const e=this._planes[t];return e?e.type:qt.PLANE_UNDEFINED}getPlaneMaskCount(t){if(t<0||t>=this.planeCount)return 0;const e=this._planes[t];return e?e.maskCount:0}getPlaneMaskLeftSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLoc(e):-1}getPlaneMaskRightSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLoc(e):-1}getPlaneMaskLeftSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLength(e):-1}getPlaneMaskRightSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLength(e):-1}addFloorHole(t,e,s,i,n){this.removeFloorHole(t),this._floorHoles.set(t,new Ttt(e,s,i,n))}removeFloorHole(t){this._floorHoles.delete(t)}resetFloorHoles(){this._floorHoles.clear()}initializeHoleMap(){let t,e,s,i,n,a,o,h;for(e=0;e<this._height;){for(s=this._floorHoleMatrix[e],t=0;t<this._width;)s[t]=!1,t++;e++}for(const u of this._floorHoles.values())if(i=u,i!=null)for(n=i.x,a=i.x+i.width-1,o=i.y,h=i.y+i.height-1,n=n<0?0:n,a=a>=this._width?this._width-1:a,o=o<0?0:o,h=h>=this._height?this._height-1:h,e=o;e<=h;){for(s=this._floorHoleMatrix[e],t=n;t<=a;)s[t]=!0,t++;e++}}extractPlanes(t){let e,s,i,n,a,o,h,u,c,l,_,d,f,m,p;const T=t.length,v=t[0].length,O=[];let A=0;for(;A<T;)O[A]=[],A++;let y=0;for(;y<T;){for(e=0;e<v;){if(s=t[y][e],!(s<0||O[y][e])){for(a=e==0||t[y][e-1]!=s,o=y==0||t[y-1][e]!=s,i=e+1;i<v&&!(t[y][i]!=s||O[y][i]||y>0&&t[y-1][i]==s==o);)i++;for(h=i==v||t[y][i]!=s,_=!1,n=y+1;n<T&&!_;){for(u=t[n][e]!=s,_=u||e>0&&t[n][e-1]==s==a||i<v&&t[n][i]==s==h,c=e;c<i;){if(t[n][c]==s==u){_=!0,i=c;break}c++}if(_)break;n++}for(u=u||n==T,h=i==v||t[y][i]!=s,l=y;l<n;){for(c=e;c<i;)O[l][c]=!0,c++;l++}d=e/4-.5,f=y/4-.5,m=(i-e)/4,p=(n-y)/4,this.addFloor(new S(d+m,f+p,s/4),new S(-m,0,0),new S(0,-p,0),h,a,u,o)}e++}y++}}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}};to.FLOOR_THICKNESS=.25;to.WALL_THICKNESS=.25;to.MAX_WALL_ADDITIONAL_HEIGHT=20;to.TILE_BLOCKED=-110;to.TILE_HOLE=-100;let ye=to;class Rtt extends c_{constructor(){super(),this._planeParser=new ye,this._planeBitmapMaskParser=new wy,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const t=[et.MOUSE_MOVE,et.CLICK];return this.mergeTypes(super.getEventTypes(),t)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(t){!t||!this.object||t instanceof Fy&&this._planeParser.initializeFromMapData(t)&&(this.object.model.setValue(I.ROOM_MAP_DATA,t),this.object.model.setValue(I.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(I.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(I.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(I.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=at.getValue("room.color.skip.transition")===!0)}update(t){if(super.update(t),this.updateBackgroundColor(t),this._needsMapUpdate){if(this._lastHoleUpdate&&t-this._lastHoleUpdate<5)return;const e=this.object&&this.object.model;if(e){const s=this._planeParser.getMapData();e.setValue(I.ROOM_MAP_DATA,s),e.setValue(I.ROOM_FLOOR_HOLE_UPDATE_TIME,t),this._planeParser.initializeFromMapData(s)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}updateBackgroundColor(t){if(!this.object||!this._colorChangedTime)return;let e=this._color,s=this._light;if(t-this._colorChangedTime>=this._colorTransitionLength)e=this._targetColor,s=this._targetLight,this._colorChangedTime=0;else{let n=this._originalColor>>16&255,a=this._originalColor>>8&255,o=this._originalColor&255;const h=this._targetColor>>16&255,u=this._targetColor>>8&255,c=this._targetColor&255,l=(t-this._colorChangedTime)/this._colorTransitionLength;n=n+(h-n)*l,a=a+(u-a)*l,o=o+(c-o)*l,e=(n<<16)+(a<<8)+o,s=this._originalLight+(this._targetLight-this._originalLight)*l,this._color=e,this._light=s}let i=af.rgbToHSL(e);i=(i&16776960)+s,e=af.hslToRGB(i),this.object.model&&this.object.model.setValue(I.ROOM_BACKGROUND_COLOR,e)}processUpdateMessage(t){if(!t||!this.object)return;const e=this.object.model;if(e){if(t instanceof Ae){this.onObjectRoomUpdateMessage(t,e);return}if(t instanceof Se){this.onObjectRoomMaskUpdateMessage(t,e);return}if(t instanceof ti){this.onObjectRoomPlaneVisibilityUpdateMessage(t,e);return}if(t instanceof $r){this.onObjectRoomPlanePropertyUpdateMessage(t,e);return}if(t instanceof Jr){this.onObjectRoomFloorHoleUpdateMessage(t,e);return}if(t instanceof kl){this.onObjectRoomColorUpdateMessage(t,e);return}t instanceof Ry&&this.onObjectRoomMapUpdateMessage(t)}}onObjectRoomUpdateMessage(t,e){switch(t.type){case Ae.ROOM_FLOOR_UPDATE:e.setValue(I.ROOM_FLOOR_TYPE,t.value);return;case Ae.ROOM_WALL_UPDATE:e.setValue(I.ROOM_WALL_TYPE,t.value);return;case Ae.ROOM_LANDSCAPE_UPDATE:e.setValue(I.ROOM_LANDSCAPE_TYPE,t.value);return}}onObjectRoomMaskUpdateMessage(t,e){let s=null,i=!1;switch(t.type){case Se.ADD_MASK:s=xn.WINDOW,t.maskCategory===Se.HOLE&&(s=xn.HOLE),this._planeBitmapMaskParser.addMask(t.maskId,t.maskType,t.maskLocation,s),i=!0;break;case Se.REMOVE_MASK:i=this._planeBitmapMaskParser.removeMask(t.maskId);break}i&&e.setValue(I.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(t,e){let s=0;switch(t.visible&&(s=1),t.type){case ti.FLOOR_VISIBILITY:e.setValue(I.ROOM_FLOOR_VISIBILITY,s);return;case ti.WALL_VISIBILITY:e.setValue(I.ROOM_WALL_VISIBILITY,s),e.setValue(I.ROOM_LANDSCAPE_VISIBILITY,s);return}}onObjectRoomPlanePropertyUpdateMessage(t,e){switch(t.type){case $r.FLOOR_THICKNESS:e.setValue(I.ROOM_FLOOR_THICKNESS,t.value);return;case $r.WALL_THICKNESS:e.setValue(I.ROOM_WALL_THICKNESS,t.value);return}}onObjectRoomFloorHoleUpdateMessage(t,e){switch(t.type){case Jr.ADD:this._planeParser.addFloorHole(t.id,t.x,t.y,t.width,t.height),this._needsMapUpdate=!0;return;case Jr.REMOVE:this._planeParser.removeFloorHole(t.id),this._needsMapUpdate=!0;return}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(t,e){!t||!e||(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=t.color,this._targetLight=t.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,e.setValue(I.ROOM_COLORIZE_BG_ONLY,t.backgroundOnly))}onObjectRoomMapUpdateMessage(t){!t||!t.mapData||(this.object.model.setValue(I.ROOM_MAP_DATA,t.mapData),this.object.model.setValue(I.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(t.mapData))}mouseEvent(t,e){if(!t||!e||!this.object||!this.object.model)return;const s=t.spriteTag;let i=0;if(s&&s.indexOf("@")>=0&&(i=parseInt(s.substr(s.indexOf("@")+1))),i<1||i>this._planeParser.planeCount){t.type===k.ROLL_OUT&&this.object.model.setValue(I.ROOM_SELECTED_PLANE,0);return}i--;let n=null;const a=this._planeParser.getPlaneLocation(i),o=this._planeParser.getPlaneLeftSide(i),h=this._planeParser.getPlaneRightSide(i),u=this._planeParser.getPlaneNormalDirection(i),c=this._planeParser.getPlaneType(i);if(a==null||o==null||h==null||u==null)return;const l=o.length,_=h.length;if(l==0||_==0)return;const d=t.screenX,f=t.screenY,m=new B(d,f);if(n=e.getPlanePosition(m,a,o,h),!n){this.object.model.setValue(I.ROOM_SELECTED_PLANE,0);return}const p=S.product(o,n.x/l);p.add(S.product(h,n.y/_)),p.add(a);const T=p.x,v=p.y,O=p.z;if(n.x>=0&&n.x<l&&n.y>=0&&n.y<_)this.object.model.setValue(I.ROOM_SELECTED_X,T),this.object.model.setValue(I.ROOM_SELECTED_Y,v),this.object.model.setValue(I.ROOM_SELECTED_Z,O),this.object.model.setValue(I.ROOM_SELECTED_PLANE,i+1);else{this.object.model.setValue(I.ROOM_SELECTED_PLANE,0);return}let A=null;switch(t.type===k.MOUSE_MOVE||t.type===k.ROLL_OVER?A=et.MOUSE_MOVE:t.type===k.MOUSE_CLICK&&(A=et.CLICK),t.type){case k.MOUSE_MOVE:case k.ROLL_OVER:case k.MOUSE_CLICK:{let y=null;if(c===qt.PLANE_FLOOR)y=new Nr(A,this.object,t.eventId,T,v,O,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);else if(c===qt.PLANE_WALL||c===qt.PLANE_LANDSCAPE){let M=90;u&&(M=u.x+90,M>360&&(M-=360));const N=o.length*n.x/l,P=h.length*n.y/_;y=new aa(A,this.object,t.eventId,a,o,h,N,P,M,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown)}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(y);return}}}}class Ott extends c_{initialize(t){this.object&&(this.object.model.setValue(I.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof ei&&this.object)switch(t.type){case ei.ENABLED:this.object.setState(0,0);return;case ei.DISABLED:this.object.setState(1,0);return}}}const G_=class la extends c_{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(t){this.object&&(this.object.model.setValue(I.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(la.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(t){t instanceof ha&&(this._lastEventId&&this._lastEventId===t.sourceEventId||(t.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(t),this.object&&(this._isHidden?this.object.setState(la.CURSOR_HIDDEN_STATE,0):t.visible?(this.object.model.setValue(I.TILE_CURSOR_HEIGHT,t.height),this.object.setState(t.height>.8?la.CURSOR_HEIGHT_STATE:la.CURSOR_VISIBLE_STATE)):this.object.setState(la.CURSOR_HIDDEN_STATE,0)),this._lastEventId=t.sourceEventId))}};G_.CURSOR_VISIBLE_STATE=0;G_.CURSOR_HIDDEN_STATE=1;G_.CURSOR_HEIGHT_STATE=6;let vtt=G_;class Gy{constructor(t,e,s){this._id=t,this._type=e,this._visualization=s}dispose(){this._visualization=null}update(t,e){}animate(t){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}const eo=class gi extends Gy{constructor(t,e,s){super(t,e,s),this._asset=null,this._startTime=ft(),this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(t,e){if(!t)return;this._scale=e;let s=64,i=0;if(e<48?(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss_small"),this.visualization.angle===90||this.visualization.angle===270?i=0:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=6:i=-6,this._offsetY=-38,s=32):(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss"),this.visualization.angle===90||this.visualization.angle===270?i=-3:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=22:i=-30,this._offsetY=-70),this.visualization.posture===q.POSTURE_SIT?this._offsetY+=s/2:this.visualization.posture===q.POSTURE_LAY&&(this._offsetY+=s),this._asset){t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0;const n=this._delta;this.animate(t),this._delta=n}}animate(t){if(!t)return!1;if(this._asset&&(t.texture=this._asset),this._state===gi.STATE_DELAY)return ft()-this._startTime<gi.DELAY_BEFORE_ANIMATION?!1:(this._state=gi.STATE_FADE_IN,t.alpha=0,t.visible=!0,this._delta=0,!0);if(this._state===gi.STATE_FADE_IN)return this._delta+=.1,t.offsetY=this._offsetY,t.alpha=Math.pow(this._delta,.9)*255,this._delta>=1&&(t.alpha=255,this._delta=0,this._state=gi.STATE_FLOAT),!0;if(this._state===gi.STATE_FLOAT){const e=Math.pow(this._delta,.9);this._delta+=.05;const s=this._scale<48?-30:-40;return t.offsetY=this._offsetY+(this._delta<1?e:1)*s,t.alpha=(1-e)*255,t.alpha<=0&&(t.visible=!1,this._state=gi.STATE_COMPLETE),!0}return!1}};eo.DELAY_BEFORE_ANIMATION=300;eo.STATE_DELAY=0;eo.STATE_FADE_IN=1;eo.STATE_FLOAT=2;eo.STATE_COMPLETE=3;let Att=eo;class so{static getExpressionAddition(t,e,s){switch(e){case this.BLOW:return new Att(t,this.BLOW,s);default:return new Gy(t,e,s)}}}so.WAVE=1;so.BLOW=2;so.LAUGH=3;so.CRY=4;so.IDLE=5;const ro=class Bs{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._startTime=ft(),this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(t){let e="left";return(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270)&&(e="right"),"avatar_addition_user_idle_"+e+"_"+t+(this._scale<48?"_small":"")}update(t,e){if(!t)return;this._scale=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===Bs.STATE_FRAME_A?1:2));let s=64,i=0;e<48?(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=10:i=-16,this._offsetY=-38,s=32):(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=22:i=-30,this._offsetY=-70),this._visualization.posture===q.POSTURE_SIT?this._offsetY+=s/2:this._visualization.posture===q.POSTURE_LAY&&(this._offsetY+=s-.3*s),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0)}animate(t){if(!t)return!1;const e=ft();return this._state===Bs.STATE_DELAY&&e-this._startTime>=Bs.DELAY_BEFORE_ANIMATION&&(this._state=Bs.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===Bs.STATE_FRAME_A&&e-this._startTime>=Bs.DELAY_PER_FRAME&&(this._state=Bs.STATE_FRAME_B,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===Bs.STATE_FRAME_B&&e-this._startTime>=Bs.DELAY_PER_FRAME&&(this._state=Bs.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(t.texture=this._asset,t.alpha=255,t.visible=!0):t.visible=!1,!1}get id(){return this._id}};ro.DELAY_BEFORE_ANIMATION=2e3;ro.DELAY_PER_FRAME=2e3;ro.STATE_DELAY=0;ro.STATE_FRAME_A=1;ro.STATE_FRAME_B=2;let Stt=ro;const qh=class Uo{constructor(t){this._id=t,this._asset=null,this._disposed=!1}dispose(){this._asset=null}update(t,e){if(t){if(!this._asset){const s=new Kt(_t.WHITE);s.alpha=0,s.width=Uo.WIDTH,s.height=Uo.HEIGHT,this._asset=Qt.generateTexture(s)}t.visible=!0,t.texture=this._asset,t.offsetX=Uo.OFFSET_X,t.offsetY=Uo.OFFSET_Y,t.alphaTolerance=bs.MATCH_ALL_PIXELS}}animate(t){return!1}get id(){return this._id}};qh.WIDTH=46;qh.HEIGHT=60;qh.OFFSET_X=-23;qh.OFFSET_Y=-48;let ytt=qh;class Mtt{constructor(t,e,s){this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0,this._status=s}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,n=0;this._asset=this._visualization.getAvatarRenderAsset(this._status===ks.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),e<48?(i=-19,n=-80,s=32):(i=-19,n=-120),this._visualization.posture===q.POSTURE_SIT?n+=s/2:this._visualization.posture===q.POSTURE_LAY&&(n+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=n,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class Ctt{constructor(t,e){this._id=t,this._visualization=e,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;let s=64,i=0,n=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted_small"),s=32,i=-12,n=-66):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted"),i=-15,n=-110),this._visualization.posture===q.POSTURE_SIT?n+=s/2:this._visualization.posture===q.POSTURE_LAY&&(n+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=n,t.relativeDepth=-.02):t.visible=!1}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}}class Ntt{constructor(t,e,s){this._id=t,this._visualization=s,this._asset=null,this._scale=0,this._number=e,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;this._scale=e;let s=64,i=0,n=0;this._number>0?(e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number+"_small"),s=32,i=-6,n=-52):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number),i=-8,n=-105),this._visualization.posture===q.POSTURE_SIT?n+=s/2:this._visualization.posture===q.POSTURE_LAY&&(n+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=n,t.relativeDepth=-.01,t.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):t.visible=!1):t.visible&&(this._numberValueFadeDirection=-1)}animate(t){if(!t)return!1;this._asset&&(t.texture=this._asset);let e=t.alpha,s=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?t.offsetY-=2:t.offsetY-=4;else{let i=4;this._scale<48&&(i=8),this._numberValueMoveCounter%i||(t.offsetY--,s=!0)}}return this._numberValueFadeDirection>0?(e<255&&(e+=32),e>=255&&(e=255,this._numberValueFadeDirection=0),t.alpha=e,!0):this._numberValueFadeDirection<0?(e>=0&&(e-=32),e<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,e=0,t.visible=!1),t.alpha=e,!0):s}get id(){return this._id}}class btt{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,n=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing_small"),i=3,n=-42,s=32):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing"),i=14,n=-83),this._visualization.posture===q.POSTURE_SIT?n+=s/2:this._visualization.posture===q.POSTURE_LAY&&(n+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=n,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class jl extends ds{constructor(){super()}initialize(t){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(t,e,s=null,i=null,n=null){let a=null;return e>48?a=this._avatarRenderer.createAvatarImage(t,cr.LARGE,s,i,n):a=this._avatarRenderer.createAvatarImage(t,cr.SMALL,s,i,n),a}getAvatarRendererAsset(t){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(t):null}get avatarManager(){return this._avatarRenderer}set avatarManager(t){this._avatarRenderer=t}get layerCount(){return 0}}const ue=class nt extends d_{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new de,this._cachedAvatarEffects=new de,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(t){return t instanceof jl?(this._data=t,this.createSprites(nt.INITIAL_RESERVED_SPRITES),super.initialize(t),!0):!1}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(t,e,s,i){if(!this.object||!t||!this._data||e<this._lastUpdate+nt.UPDATE_TIME_INCREASER)return;this._lastUpdate+=nt.UPDATE_TIME_INCREASER,this._lastUpdate+nt.UPDATE_TIME_INCREASER<e&&(this._lastUpdate=e-nt.UPDATE_TIME_INCREASER);const n=this.object.model,a=t.scale,o=this._effect;let h=!1,u=!1,c=!1,l=!1;const _=this.updateModel(n,a);if(_||a!==this._scale||!this._avatarImage){if(a!==this._scale&&(h=!0,this.updateScale(a)),o!==this._effect&&(u=!0),h||!this._avatarImage||u){if(this._avatarImage=this.createAvatarImage(a,this._effect),!this._avatarImage)return;c=!0;const m=this.getSprite(nt.AVATAR_LAYER_ID);m&&this._avatarImage&&this._avatarImage.isPlaceholder()?m.alpha=150:m&&(m.alpha=255)}if(!this._avatarImage)return;if(u&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(a),l=this.updateObject(this.object,t,s,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let m=this._extraSpritesStartIndex;for(const p of this._additions.values())p.update(this.getSprite(m++),a)}this._scale=a}else l=this.updateObject(this.object,t,s);if(this._additions){let m=this._extraSpritesStartIndex;for(const p of this._additions.values())p.animate(this.getSprite(m++))&&this.updateSpriteCounter++}const d=l||_||h,f=(this._isAnimating||this._forcedAnimFrames>0)&&s;if(d&&(this._forcedAnimFrames=nt.ANIMATION_FRAME_UPDATE_INTERVAL),d||f){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,this._updatesUntilFrameUpdate<=0||h||_||c)this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=nt.ANIMATION_FRAME_UPDATE_INTERVAL;else return;let m=this._avatarImage.getCanvasOffsets();(!m||m.length<3)&&(m=nt.DEFAULT_CANVAS_OFFSETS);const p=this.getSprite(nt.SPRITE_INDEX_AVATAR);if(p){const A=this.object.model.getValue(I.FIGURE_HIGHLIGHT_ENABLE)===1&&this.object.model.getValue(I.FIGURE_HIGHLIGHT)===1,y=this._avatarImage.getImage(Je.FULL,A);y&&(p.texture=y,A||(p.filters=[])),p.texture&&(p.offsetX=-1*a/2+m[0]-(p.texture.width-a)/2,p.offsetY=-p.texture.height+a/4+m[1]+this._postureOffset),this._isLaying?this._layInside?p.relativeDepth=-.5:p.relativeDepth=nt.AVATAR_SPRITE_LAYING_DEPTH+m[2]:p.relativeDepth=nt.AVATAR_SPRITE_DEFAULT_DEPTH+m[2],this._ownUser?(p.relativeDepth-=nt.AVATAR_OWN_DEPTH_ADJUST,p.spriteType=as.AVATAR_OWN):p.spriteType=as.AVATAR}const T=this.getAddition(nt.TYPING_BUBBLE_ID);T&&(this._isLaying?T.relativeDepth=nt.AVATAR_SPRITE_LAYING_DEPTH-.01+m[2]:T.relativeDepth=nt.AVATAR_SPRITE_DEFAULT_DEPTH-.01+m[2]),this._isAnimating=this._avatarImage.isAnimating();let v=nt.INITIAL_RESERVED_SPRITES;const O=this._avatarImage.getDirection();for(const A of this._avatarImage.getSprites())if(A.id===nt.AVATAR){const y=this.getSprite(nt.SPRITE_INDEX_AVATAR);if(y){const M=this._avatarImage.getLayerData(A);let N=A.getDirectionOffsetX(O),P=A.getDirectionOffsetY(O);M&&(N+=M.dx,P+=M.dy),a<48&&(N/=2,P/=2),this._canStandUp||(y.offsetX+=N,y.offsetY+=P)}}else{const y=this.getSprite(v);if(y){y.alphaTolerance=bs.MATCH_NOTHING,y.visible=!0;const M=this._avatarImage.getLayerData(A);let N=0,P=A.getDirectionOffsetX(O),b=A.getDirectionOffsetY(O);const D=A.getDirectionOffsetZ(O);let x=0;A.hasDirections&&(x=O),M&&(N=M.animationFrame,P+=M.dx,b+=M.dy,x+=M.dd),a<48&&(P/=2,b/=2),x<0?x+=8:x>7&&(x-=8);const V=this._avatarImage.getScale()+"_"+A.member+"_"+x+"_"+N,J=this._avatarImage.getAsset(V);if(!J)continue;y.texture=J.texture,y.offsetX=J.offsetX-a/2+P,y.offsetY=J.offsetY+b,y.flipH=J.flipH,A.hasStaticY?y.offsetY+=this._verticalOffset*a/(2*nt.BASE_Y_SCALE):y.offsetY+=this._postureOffset,this._isLaying?y.relativeDepth=nt.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*D:y.relativeDepth=nt.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*D,A.ink===33?y.blendMode=tt.ADD:y.blendMode=tt.NORMAL}v++}}}createAvatarImage(t,e){let s=null,i="avatarImage"+t.toString();if(e?(i+="-"+e,s=this._cachedAvatarEffects.getValue(i)):s=this._cachedAvatars.getValue(i),!s&&(s=this._data.createAvatarImage(this._figure,t,this._gender,this,this),s))if(!e)this._cachedAvatars.add(i,s);else{if(this._cachedAvatarEffects.length>=nt.MAX_EFFECT_CACHE){const n=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));n&&n.dispose()}this._cachedAvatarEffects.add(i,s)}return s}updateObject(t,e,s,i=!1){if(!i&&this.updateObjectCounter===t.updateCounter&&this._geometryUpdateCounter===e.updateId)return!1;let n=t.getDirection().x-e.direction.x,a=this._headDirection-e.direction.x;return this._posture==="float"&&(a=n),n=(n%360+360)%360,a=(a%360+360)%360,this._posture==="sit"&&this._canStandUp&&(n-=n%90-45,a-=a%90-45),(n!==this._angle||i)&&(s=!0,this._angle=n,n=n-(135-22.5),n=(n+360)%360,this._avatarImage.setDirectionAngle(Je.FULL,n)),(a!==this._headAngle||i)&&(s=!0,this._headAngle=a,this._headAngle!==this._angle&&(a=a-(135-22.5),a=(a+360)%360,this._avatarImage.setDirectionAngle(Je.HEAD,a))),this._geometryUpdateCounter=e.updateId,this.updateObjectCounter=this.object.updateCounter,s}updateModel(t,e){if(!t||this.updateModelCounter===t.updateCounter)return!1;let s=!1;const i=t.getValue(I.FIGURE_TALK)>0;i!==this._talk&&(this._talk=i,s=!0);const n=t.getValue(I.FIGURE_EXPRESSION);n!==this._expression&&(this._expression=n,s=!0);const a=t.getValue(I.FIGURE_SLEEP)>0;a!==this._sleep&&(this._sleep=a,s=!0);const o=t.getValue(I.FIGURE_BLINK)>0;o!==this._blink&&(this._blink=o,s=!0);const h=t.getValue(I.FIGURE_GESTURE)||0;h!==this._gesture&&(this._gesture=h,s=!0);const u=t.getValue(I.FIGURE_POSTURE);u!==this._posture&&(this._posture=u,s=!0);const c=t.getValue(I.FIGURE_POSTURE_PARAMETER);c!==this._postureParameter&&(this._postureParameter=c,s=!0);const l=t.getValue(I.FIGURE_CAN_STAND_UP);l!==this._canStandUp&&(this._canStandUp=l,s=!0);const _=t.getValue(I.FIGURE_VERTICAL_OFFSET)*nt.BASE_Y_SCALE;_!==this._verticalOffset&&(this._verticalOffset=_,s=!0);const d=t.getValue(I.FIGURE_DANCE)||0;d!==this._dance&&(this._dance=d,s=!0);const f=t.getValue(I.FIGURE_EFFECT)||0;f!==this._effect&&(this._effect=f,s=!0);const m=t.getValue(I.FIGURE_CARRY_OBJECT)||0;m!==this._carryObject&&(this._carryObject=m,s=!0);const p=t.getValue(I.FIGURE_USE_OBJECT)||0;p!==this._useObject&&(this._useObject=p,s=!0);const T=t.getValue(I.HEAD_DIRECTION);T!==this._headDirection&&(this._headDirection=T,s=!0),this._carryObject>0&&p>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,s=!0):this._useObject!==0&&(this._useObject=0,s=!0);let v=this.getAddition(nt.FLOATING_IDLE_Z_ID);this._sleep?(v||(v=this.addAddition(new Stt(nt.FLOATING_IDLE_Z_ID,this))),s=!0):v&&this.removeAddition(nt.FLOATING_IDLE_Z_ID);const O=t.getValue(I.FIGURE_IS_MUTED)>0;let A=this.getAddition(nt.MUTED_BUBBLE_ID);if(O)A||(A=this.addAddition(new Ctt(nt.MUTED_BUBBLE_ID,this))),s=!0;else{A&&(this.removeAddition(nt.MUTED_BUBBLE_ID),s=!0);const H=t.getValue(I.FIGURE_IS_TYPING)>0;let z=this.getAddition(nt.TYPING_BUBBLE_ID);H?(z||(z=this.addAddition(new btt(nt.TYPING_BUBBLE_ID,this))),s=!0):z&&(this.removeAddition(nt.TYPING_BUBBLE_ID),s=!0)}const y=t.getValue(I.FIGURE_GUIDE_STATUS)||0;y!==ks.NONE?(this.removeAddition(nt.GUIDE_BUBBLE_ID),this.addAddition(new Mtt(nt.GUIDE_BUBBLE_ID,this,y)),s=!0):this.getAddition(nt.GUIDE_BUBBLE_ID)&&(this.removeAddition(nt.GUIDE_BUBBLE_ID),s=!0);const M=t.getValue(I.FIGURE_IS_PLAYING_GAME)>0;let N=this.getAddition(nt.GAME_CLICK_TARGET_ID);M?(N||(N=this.addAddition(new ytt(nt.GAME_CLICK_TARGET_ID))),s=!0):N&&this.removeAddition(nt.GAME_CLICK_TARGET_ID);const P=t.getValue(I.FIGURE_NUMBER_VALUE);let b=this.getAddition(nt.NUMBER_BUBBLE_ID);P>0?(b||(b=this.addAddition(new Ntt(nt.NUMBER_BUBBLE_ID,P,this))),s=!0):b&&this.removeAddition(nt.NUMBER_BUBBLE_ID);let D=this.getAddition(nt.EXPRESSION_ID);this._expression>0?D||(D=so.getExpressionAddition(nt.EXPRESSION_ID,this._expression,this),D&&this.addAddition(D)):D&&this.removeAddition(nt.EXPRESSION_ID),this.updateScale(e);const x=t.getValue(I.GENDER);x!==this._gender&&(this._gender=x,s=!0),this.updateFigure(t.getValue(I.FIGURE))&&(s=!0);let V=t.getValue(I.FIGURE_SIGN);V===null&&(V=-1),this._sign!==V&&(this._sign=V,s=!0);const J=t.getValue(I.FIGURE_HIGHLIGHT_ENABLE)>0;if(J!==this._highlightEnabled&&(this._highlightEnabled=J,s=!0),this._highlightEnabled){const H=t.getValue(I.FIGURE_HIGHLIGHT)>0;H!==this._highlight&&(this._highlight=H,s=!0)}const ct=t.getValue(I.OWN_USER)>0;return ct!==this._ownUser&&(this._ownUser=ct,s=!0),this.updateModelCounter=t.updateCounter,s}setDirection(t){this._direction!==t&&(this._direction=t,this._needsUpdate=!0)}updateScale(t){t<48&&(this._blink=!1),this._posture==="sit"||this._posture==="lay"?this._postureOffset=t/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,this._posture==="lay"&&(this._isLaying=!0,parseInt(this._postureParameter)<0&&(this._layInside=!0))}processActionsForAvatar(t){if(!t)return;if(t.initActionAppends(),t.appendAction(q.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(q.GESTURE,q.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(q.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(q.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(q.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(q.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(q.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(q.SLEEP),this._expression>0){const s=q.getExpression(this._expression);if(s!=="")switch(s){case q.DANCE:this._avatarImage.appendAction(q.DANCE,2);break;default:this._avatarImage.appendAction(s);break}}this._effect>0&&this._avatarImage.appendAction(q.EFFECT,this._effect),t.endActionAppends(),this._isAnimating=t.isAnimating();let e=nt.INITIAL_RESERVED_SPRITES;for(const s of this._avatarImage.getSprites())s.id!==nt.AVATAR&&e++;if(e!==this.totalSprites&&this.createSprites(e),this._extraSpritesStartIndex=e,this._additions)for(const s of this._additions.values())this.createSprite()}updateFigure(t){return this._figure===t?!1:(this._figure=t,this.clearAvatar(),!0)}resetFigure(t){this.clearAvatar()}resetEffect(t){this.clearAvatar()}clearAvatar(){for(const e of this._cachedAvatars.getValues())e&&e.dispose();for(const e of this._cachedAvatarEffects.getValues())e&&e.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const t=this.getSprite(nt.AVATAR_LAYER_ID);t&&(t.texture=_t.EMPTY,t.alpha=255)}getAddition(t){if(!this._additions)return null;const e=this._additions.get(t);return e||null}addAddition(t){if(!this.getAddition(t.id))return this._additions.set(t.id,t),t}removeAddition(t){const e=this.getAddition(t);e&&(this._additions.delete(e.id),e.dispose())}updateShadow(t){this._shadow=null;const e=this.getSprite(nt.SHADOW_LAYER_ID);if(!e)return;let s=this._posture==="mv"||this._posture==="std"||this._posture==="sit"&&this._canStandUp;if(this._effect===nt.SNOWBOARDING_EFFECT&&(s=!1),s){if(e.visible=!0,!this._shadow||t!==this._scale){let i=0,n=0;t<48?(e.libraryAssetName="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),i=-8,n=this._canStandUp?6:-3):(e.libraryAssetName="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),i=-17,n=this._canStandUp?10:-7),this._shadow?(e.texture=this._shadow.texture,e.offsetX=i,e.offsetY=n,e.alpha=50,e.relativeDepth=1):e.visible=!1}}else this._shadow=null,e.visible=!1}getAvatarRenderAsset(t){return this._data?this._data.getAvatarRendererAsset(t):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}};ue.AVATAR="avatar";ue.FLOATING_IDLE_Z_ID=1;ue.TYPING_BUBBLE_ID=2;ue.EXPRESSION_ID=3;ue.NUMBER_BUBBLE_ID=4;ue.GAME_CLICK_TARGET_ID=5;ue.MUTED_BUBBLE_ID=6;ue.GUIDE_BUBBLE_ID=7;ue.OWN_USER_ID=4;ue.UPDATE_TIME_INCREASER=41;ue.AVATAR_LAYER_ID=0;ue.SHADOW_LAYER_ID=1;ue.SNOWBOARDING_EFFECT=97;ue.INITIAL_RESERVED_SPRITES=2;ue.ANIMATION_FRAME_UPDATE_INTERVAL=2;ue.DEFAULT_CANVAS_OFFSETS=[0,0,0];ue.MAX_EFFECT_CACHE=2;ue.SPRITE_INDEX_AVATAR=0;ue.BASE_Y_SCALE=1e3;ue.AVATAR_SPRITE_DEFAULT_DEPTH=-.01;ue.AVATAR_OWN_DEPTH_ADJUST=.001;ue.AVATAR_SPRITE_LAYING_DEPTH=-.409;let Ptt=ue;const Qh=class Lr{static allocate(t,e,s,i,n,a,o=-1,h=0){const u=Lr.POOL.length?Lr.POOL.pop():new Lr;return i<1&&(i=1),n<0&&(n=Lr.FRAME_REPEAT_FOREVER),u._id=t,u._x=e||0,u._y=s||0,u._repeats=i,u._frameRepeats=n,u._remainingFrameRepeats=n,u._isLastFrame=a,u._isRecycled=!1,o>=0?(u._activeSequence=o,u._activeSequenceOffset=h):(u._activeSequence=-1,u._activeSequenceOffset=0),u}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?Lr.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(t){t<0&&(t=0),this._frameRepeats>0&&t>this._frameRepeats&&(t=this._frameRepeats),this._remainingFrameRepeats=t}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,Lr.POOL.length<Lr.POOL_SIZE_LIMIT&&Lr.POOL.push(this))}};Qh.FRAME_REPEAT_FOREVER=-1;Qh.SEQUENCE_NOT_DEFINED=-1;Qh.POOL_SIZE_LIMIT=3e3;Qh.POOL=[];let Da=Qh;class By{constructor(t,e,s,i,n,a){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=t,this._x=e,this._y=s,this._randomX=i,this._randomY=n,this._repeats=a}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(t){return this._x}getY(t){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class Dtt extends By{constructor(t,e,s,i,n,a,o){super(t,e,s,i,n,o),this._directionalOffsets=a}hasDirectionalOffsets(){return this._directionalOffsets!==null}getX(t){return this._directionalOffsets?this._directionalOffsets.getXOffset(t,super.getX(t)):super.getX(t)}getY(t){return this._directionalOffsets?this._directionalOffsets.getYOffset(t,super.getY(t)):super.getY(t)}}class Ltt{constructor(t,e){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=e,this._loopCount=t<1?1:t}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let t=this._frameIndexes.length-1,e=-1,s=1;for(;t>=0;)this._frameIndexes[t]===e?s++:(e=this._frameIndexes[t],s=1),this._frameRepeats[t]=s,t--}addFrame(t,e,s,i,n,a){let o=1;if(this._frames.length>0){const u=this._frames[this._frames.length-1];u.id===t&&!u.hasDirectionalOffsets()&&u.x===e&&u.y===s&&u.randomX===i&&i===0&&u.randomY===n&&n===0&&(o+=u.repeats,this._frames.pop())}const h=a?new Dtt(t,e,s,i,n,a,o):new By(t,e,s,i,n,o);this._frames.push(h),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(t){return!this._frames.length||t<0||t>=this.frameCount?null:this._frames[this._frameIndexes[t%this._frameIndexes.length]]}getFrameIndex(t){return t<0||t>=this.frameCount?-1:(this._isRandom&&(t=Math.round(Math.random()*this._frameIndexes.length),t===this._frameIndexes.length&&t--),t)}getRepeats(t){return t<0||t>=this.frameCount?0:this._frameRepeats[t%this._frameRepeats.length]}}class Utt{constructor(t,e,s){this._frameSequences=[],this._frameCount=-1,this._loopCount=t<0?0:t,this._frameRepeat=e<1?1:e,this._isRandom=s}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(!(!this._frameSequences||!this._frameSequences.length)){for(const t of this._frameSequences)t&&t.dispose();this._frameSequences=[]}}addFrameSequence(t,e){const s=new Ltt(t,e);return this._frameSequences.push(s),s}calculateLength(){this._frameCount=0;for(const t of this._frameSequences)t&&(this._frameCount+=t.frameCount)}getFrame(t,e){if(this._frameCount<1)return null;if(e=e/this._frameRepeat,!this._isRandom){const n=Math.floor(e/this._frameCount);e=Math.floor(e%this._frameCount);let a=!1,o=null;(this._loopCount>0&&n>=this._loopCount||this._loopCount<=0&&this._frameCount===1)&&(e=this._frameCount-1,a=!0);let h=0,u=0;for(;u<this._frameSequences.length;){if(o=this._frameSequences[u],o){if(e<h+o.frameCount)break;h+=o.frameCount}u++}return this.getFrameFromSpecificSequence(t,o,u,e-h,a)}const s=Math.trunc(this._frameSequences.length*Math.random()),i=this._frameSequences[s];return i.frameCount<1?null:this.getFrameFromSpecificSequence(t,i,s,0,!1)}getFrameFromSequence(t,e,s,i){if(e<0||e>=this._frameSequences.length)return null;const n=this._frameSequences[e];return n?s>=n.frameCount?this.getFrame(t,i):this.getFrameFromSpecificSequence(t,n,e,s,!1):null}getFrameFromSpecificSequence(t,e,s,i,n){if(!e)return null;const a=e.getFrameIndex(i),o=e.getFrame(a);if(!o)return null;let h=o.getX(t),u=o.getY(t);const c=o.randomX,l=o.randomY;let _=o.repeats,d=!1;c&&(h=Math.trunc(h+c*Math.random())),l&&(u=Math.trunc(u+l*Math.random())),_>1&&(_=e.getRepeats(a));let f=this._frameRepeat*_;return n&&(f=Da.FRAME_REPEAT_FOREVER),!this._isRandom&&!e.isRandom&&s===this._frameSequences.length-1&&i===e.frameCount-1&&(d=!0),Da.allocate(o.id,h,u,_,f,d,s,i)}}class Hy{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(t,e){const s=this._offsetX.get(t);return s??e}getYOffset(t,e){const s=this._offsetY.get(t);return s??e}setDirection(t,e,s){this._offsetX.set(t,e),this._offsetY.set(t,s)}}const B_=class _a{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(t){return _a.TRANSITION_TO_ANIMATION_OFFSET+t}static getTransitionFromAnimationId(t){return _a.TRANSITION_FROM_ANIMATION_OFFSET+t}static isTransitionToAnimation(t){return t>=_a.TRANSITION_TO_ANIMATION_OFFSET&&t<_a.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(t){return t>=_a.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const t of this._layers.values())t&&t.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(t){this._immediateChanges=t}isImmediateChange(t){return!(!this._immediateChanges||this._immediateChanges.indexOf(t)===-1)}getStartFrame(t){return this._randomStart?Math.random()*this._frameCount:0}initialize(t){if(t.randomStart&&(this._randomStart=!0),t.layers)for(const e in t.layers){const s=t.layers[e];if(!s)return!1;const i=parseInt(e),n=s.loopCount!==void 0?s.loopCount:1,a=s.frameRepeat!==void 0?s.frameRepeat:1,o=s.random!==void 0&&s.random!==0;if(!this.addLayer(i,n,a,o,s))return!1}return!0}addLayer(t,e,s,i,n){const a=new Utt(e,s,i);if(n.frameSequences)for(const h in n.frameSequences){const u=n.frameSequences[h];if(!u)continue;const c=u.loopCount!==void 0?u.loopCount:1,l=u.random!==void 0&&u.random!==0,_=a.addFrameSequence(c,l);if(u.frames)for(const d in u.frames){const f=u.frames[d];if(!f)return a.dispose(),!1;_.addFrame(f.id,f.x||0,f.y||0,f.randomX||0,f.randomY||0,this.readDirectionalOffsets(f))}_.initialize()}a.calculateLength(),this._layers.set(t,a);const o=a.frameCount;return o>this._frameCount&&(this._frameCount=o),!0}readDirectionalOffsets(t){let e=null;if(t&&t.offsets)for(const s in t.offsets){const i=t.offsets[s];i&&(e||(e=new Hy),e.setDirection(i.direction,i.x,i.y))}return e}getFrame(t,e,s){const i=this._layers.get(e);return i?i.getFrame(t,s):null}getFrameFromSequence(t,e,s,i,n){const a=this._layers.get(e);return a?a.getFrameFromSequence(t,s,i,n):null}};B_.TRANSITION_TO_ANIMATION_OFFSET=1e6;B_.TRANSITION_FROM_ANIMATION_OFFSET=2e6;B_.DEFAULT_FRAME_NUMBER=0;let Le=B_;const Vy=class hg{constructor(t){this._colors=[],this.createColors(t)}createColors(t){if(t)for(let e=0;e<t;e++)this._colors.push(hg.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(t){const e=this._colors[t];return e||hg.DEFAULT_COLOR}setColorLayer(t,e){this._colors[t]&&(this._colors[t]=e)}};Vy.DEFAULT_COLOR=16777215;let Th=Vy;const Ar=class Ei{constructor(){this._tag=Ei.DEFAULT_TAG,this._ink=Ei.DEFAULT_INK,this._alpha=Ei.DEFAULT_ALPHA,this._ignoreMouse=Ei.DEFAULT_IGNORE_MOUSE,this._xOffset=Ei.DEFAULT_XOFFSET,this._yOffset=Ei.DEFAULT_YOFFSET,this._zOffset=Ei.DEFAULT_ZOFFSET}setFromLayer(t){t&&(this._tag=t.tag,this._ink=t.ink,this._alpha=t.alpha,this._ignoreMouse=t.ignoreMouse,this._xOffset=t.xOffset,this._yOffset=t.yOffset,this._zOffset=t.zOffset)}get tag(){return this._tag}set tag(t){this._tag=t}get ink(){return this._ink}set ink(t){this._ink=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(t){this._ignoreMouse=t}get xOffset(){return this._xOffset}set xOffset(t){this._xOffset=t}get yOffset(){return this._yOffset}set yOffset(t){this._yOffset=t}get zOffset(){return this._zOffset}set zOffset(t){this._zOffset=t}};Ar.DEFAULT_COUNT=0;Ar.DEFAULT_DIRECTION=0;Ar.DEFAULT_TAG="";Ar.DEFAULT_INK=tt.NORMAL;Ar.DEFAULT_ALPHA=255;Ar.DEFAULT_IGNORE_MOUSE=!1;Ar.DEFAULT_XOFFSET=0;Ar.DEFAULT_YOFFSET=0;Ar.DEFAULT_ZOFFSET=0;let Bt=Ar;class Rn{constructor(t){this._layers=[],this.createLayers(t)}createLayers(t){if(t)for(let e=0;e<t;e++)this._layers.push(new Bt)}dispose(){this._layers=[]}setFromDirection(t){if(!t)return;const e=this.layerCount;if(e===t.layerCount)for(let s=0;s<e;s++){const i=this.getLayer(s),n=t.getLayer(s);i&&i.setFromLayer(n)}}getLayer(t){const e=this._layers[t];return e||null}getLayerTag(t){const e=this.getLayer(t);return e?e.tag:Bt.DEFAULT_TAG}setLayerTag(t,e){const s=this.getLayer(t);s&&(s.tag=e)}getLayerInk(t){const e=this.getLayer(t);return e?e.ink:Bt.DEFAULT_INK}setLayerInk(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.ink=e))}getLayerAlpha(t){const e=this.getLayer(t);return e?e.alpha:Bt.DEFAULT_ALPHA}setLayerAlpha(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.alpha=e))}getLayerIgnoreMouse(t){const e=this.getLayer(t);return e?e.ignoreMouse:Bt.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(t,e){const s=this.getLayer(t);s&&(s.ignoreMouse=e||!1)}getLayerXOffset(t){const e=this.getLayer(t);return e?e.xOffset:Bt.DEFAULT_XOFFSET}setLayerXOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.xOffset=e))}getLayerYOffset(t){const e=this.getLayer(t);return e?e.yOffset:Bt.DEFAULT_YOFFSET}setLayerYOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.yOffset=e))}getLayerZOffset(t){const e=this.getLayer(t);return e?e.zOffset:Bt.DEFAULT_ZOFFSET}setLayerZOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.zOffset=e))}get layerCount(){return this._layers.length}}Rn.USE_DEFAULT_DIRECTION=-1;const ky=class ug{constructor(t,e){this._layerCount=t<0?0:t>ug.MAX_LAYERS?ug.MAX_LAYERS:t,this._angle=e<1?1:e>360?360:e,this._defaultDirection=new Rn(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const t of this._directions.values())t&&t.dispose();for(const t of this._colors)t&&t.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(t){return t?this.setDirectionLayers(this._defaultDirection,t):!1}processDirections(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._directions.get(i))return!1;const n=new Rn(this._layerCount);n.setFromDirection(this._defaultDirection),this.setDirectionLayers(n,s.layers),this._directions.set(i,n),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._colors[i])return!1;const n=new Th(this._layerCount);for(const a in s.layers){const o=s.layers[a];if(!o)continue;const h=parseInt(a),u=o.color;n.setColorLayer(h,u)}this._colors[i]=n}return!0}setDirectionLayers(t,e){if(!t||!e)return!1;for(const s in e){const i=e[s];if(!i)continue;const n=parseInt(s);if(n<0||n>=this._layerCount)return!1;i.ink!==void 0&&t.setLayerInk(n,kw.inkToBlendMode(i.ink)),i.tag!==void 0&&t.setLayerTag(n,i.tag),i.alpha!==void 0&&t.setLayerAlpha(n,i.alpha),i.ignoreMouse!==void 0&&t.setLayerIgnoreMouse(n,i.ignoreMouse),i.x!==void 0&&t.setLayerXOffset(n,i.x),i.y!==void 0&&t.setLayerYOffset(n,i.y),i.z!==void 0&&t.setLayerZOffset(n,i.z/-1e3)}return!0}getValidDirection(t){if(this._directions.get(t))return t;t=(t%360+360)%360;let s=-1,i=-1;for(const n of this._directions.keys()){let a=(n*this._angle-t+360)%360;a>180&&(a=360-a),(a<s||s<0)&&(s=a,i=n)}return i>=0?Math.trunc(i):0}getDirectionData(t){if(t===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let e=this._directions.get(t);return e||(e=this._defaultDirection),this._lastDirection=t,this._lastDirectionData=e,this._lastDirectionData}getLayerTag(t,e){const s=this.getDirectionData(t);return s?s.getLayerTag(e):Bt.DEFAULT_TAG}getLayerInk(t,e){const s=this.getDirectionData(t);return s?s.getLayerInk(e):Bt.DEFAULT_INK}getLayerAlpha(t,e){const s=this.getDirectionData(t);return s?s.getLayerAlpha(e):Bt.DEFAULT_ALPHA}getLayerColor(t,e){const s=this._colors[e];return s?s.getLayerColor(t):Th.DEFAULT_COLOR}getLayerIgnoreMouse(t,e){const s=this.getDirectionData(t);return s?s.getLayerIgnoreMouse(e):Bt.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerXOffset(e):Bt.DEFAULT_XOFFSET}getLayerYOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerYOffset(e):Bt.DEFAULT_YOFFSET}getLayerZOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerZOffset(e):Bt.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}};ky.MAX_LAYERS=26;let jy=ky;class zl extends jy{constructor(t,e){super(t,e),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const t of this._animations.values())t&&t.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(t){if(!t)return!0;for(const e in t){const s=t[e];if(!s)return!1;let i=parseInt(e.split("_")[0]),n=!1;const a=s.transitionTo,o=s.transitionFrom;a!==void 0&&(i=Le.getTransitionToAnimationId(a),n=!0),o!==void 0&&(i=Le.getTransitionFromAnimationId(o),n=!0);const h=this.createAnimationData();if(!h.initialize(s))return h.dispose(),!1;const u=s.immediateChangeFrom;if(u!==void 0){const c=u.split(","),l=[];for(const _ of c){const d=parseInt(_);l.indexOf(d)===-1&&l.push(d)}h.setImmediateChanges(l)}this._animations.set(i,h),n||this._animationIds.push(i)}return!0}createAnimationData(){return new Le}hasAnimation(t){return!!this._animations.get(t)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(t){const e=this.getAnimationCount();return t<0||e<=0?0:this._animationIds[t%e]}isImmediateChange(t,e){const s=this._animations.get(t);return s?s.isImmediateChange(e):!1}getStartFrame(t,e){const s=this._animations.get(t);return s?s.getStartFrame(e):0}getFrame(t,e,s,i){const n=this._animations.get(t);return n?n.getFrame(e,s,i):null}getFrameFromSequence(t,e,s,i,n,a){const o=this._animations.get(t);return o?o.getFrameFromSequence(e,s,i,n,a):null}}class zy{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(t){this._animationOver=t}get frameCounter(){return this._frameCounter}set frameCounter(t){this._frameCounter=t}get animationId(){return this._animationId}set animationId(t){t!==this._animationId&&(this._animationId=t,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(t){this._animationAfterTransitionId=t}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(t){this._layerCount=t,this.resetAnimationFrames()}resetAnimationFrames(t=!0){(t||!this._frames)&&(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let e=0;for(;e<this._layerCount;){if(t||this._frames.length<=e)this._frames[e]=null;else{const s=this._frames[e];s&&(s.recycle(),this._frames[e]=Da.allocate(s.id,s.x,s.y,s.repeats,0,s.isLastFrame))}this._lastFramePlayed[e]=!1,this._animationPlayed[e]=!1,e++}}recycleFrames(){if(!(!this._frames||!this._frames.length))for(const t of this._frames)t&&t.recycle()}getFrame(t){return t<0||t>=this._layerCount?null:this._frames[t]}setFrame(t,e){if(t<0||t>=this._layerCount)return;const s=this._frames[t];s&&s.recycle(),this._frames[t]=e}getAnimationPlayed(t){return t<0||t>=this._layerCount?!0:this._animationPlayed[t]}setAnimationPlayed(t,e){t<0||t>=this._layerCount||(this._animationPlayed[t]=e)}getLastFramePlayed(t){return t<0||t>=this._layerCount?!0:this._lastFramePlayed[t]}setLastFramePlayed(t,e){t<0||t>=this._layerCount||(this._lastFramePlayed[t]=e)}}const Yy=class Wy extends zl{constructor(t,e){super(t,e),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(t){if(!t||(t.defaultPosture&&t.defaultPosture.length&&(this._defaultPosture=t.defaultPosture),!t.postures))return!1;for(const e of t.postures)this._posturesToAnimations.get(e.id)||(this._defaultPosture===null&&(this._defaultPosture=e.id),this._posturesToAnimations.set(e.id,e.animationId));return this._posturesToAnimations.get(this._defaultPosture)!==void 0}processGestures(t){if(!t)return!1;for(const e of t)this._gesturesToAnimations.get(e.id)||this._gesturesToAnimations.set(e.id,e.animationId);return!0}postureToAnimation(t){return this._posturesToAnimations.get(t)||(t=this._defaultPosture),this._posturesToAnimations.get(t)}getGestureDisabled(t){return t==="ded"}gestureToAnimation(t){return this._gesturesToAnimations.get(t)?this._gesturesToAnimations.get(t):Wy.DEFAULT}animationToPosture(t,e){if(t>=0&&t<this._posturesToAnimations.size){const s=this._posturesToAnimations.keys();for(;;){const i=s.next();if(i.done)return null;if(t<=0)return i.value;--t}}return e?this._defaultPosture:null}animationToGesture(t){if(t>=0&&t<this._gesturesToAnimations.size){const e=this._gesturesToAnimations.keys();for(;;){const s=e.next();if(s.done)return null;if(t<=0)return s.value;--t}}return null}getGestureForAnimationId(t){for(const e of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(e)===t)return e;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}};Yy.DEFAULT=-1;let To=Yy;class ni{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(t){return this.reset(),t?(this._type=t.name,this.defineVisualizations(t.visualizations)?!0:(this.reset(),!1)):!1}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(t,e,s){return new jy(e,s)}defineVisualizations(t){if(!t)return!1;for(const e in t){const s=t[e],i=s.layerCount,n=s.angle;let a=s.size;if(a<1&&(a=1),this._sizeDatas.get(a))return!1;const o=this.createSizeData(a,i,n);if(!o)return!1;for(const h in s){const u=s[h];if(!this.processVisualElement(o,h,u))return o.dispose(),!1}this._sizeDatas.set(a,o),this._sizes.push(a)}return this._sizes.sort(),!0}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"layers":if(!t.processLayers(s))return!1;break;case"directions":if(!t.processDirections(s))return!1;break;case"colors":if(!t.processColors(s))return!1;break}return!0}getValidSize(t){if(t===this._lastSizeScale)return this._lastSize;const e=this.getSizeIndex(t);let s=-1;return e<this._sizes.length&&(s=this._sizes[e]),this._lastSizeScale=t,this._lastSize=s,s}getSizeIndex(t){if(t<=0)return 0;let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]/t<t/this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getSizeData(t){if(t===this._lastSizeDataScale)return this._lastSizeData;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[e]):this._lastSizeData=null,this._lastSizeDataScale=t,this._lastSizeData}getLayerCount(t){const e=this.getSizeData(t);return e?e.layerCount:Bt.DEFAULT_COUNT}getValidDirection(t,e){const s=this.getSizeData(t);return s?s.getValidDirection(e):Bt.DEFAULT_DIRECTION}getLayerTag(t,e,s){const i=this.getSizeData(t);return i?i.getLayerTag(e,s):Bt.DEFAULT_TAG}getLayerInk(t,e,s){const i=this.getSizeData(t);return i?i.getLayerInk(e,s):Bt.DEFAULT_INK}getLayerAlpha(t,e,s){const i=this.getSizeData(t);return i?i.getLayerAlpha(e,s):Bt.DEFAULT_ALPHA}getLayerColor(t,e,s){const i=this.getSizeData(t);return i?i.getLayerColor(e,s):Th.DEFAULT_COLOR}getLayerIgnoreMouse(t,e,s){const i=this.getSizeData(t);return i?i.getLayerIgnoreMouse(e,s):Bt.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerXOffset(e,s):Bt.DEFAULT_XOFFSET}getLayerYOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerYOffset(e,s):Bt.DEFAULT_YOFFSET}getLayerZOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerZOffset(e,s):Bt.DEFAULT_ZOFFSET}get type(){return this._type}}ni.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];class ME extends ni{createSizeData(t,e,s){return new zl(e,s)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"animations":if(!(t instanceof zl)||!t.defineAnimations(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1;break}return!0}hasAnimation(t,e){const s=this.getSizeData(t);return s?s.hasAnimation(e):null}getAnimationCount(t){const e=this.getSizeData(t);return e?e.getAnimationCount():null}getAnimationId(t,e){const s=this.getSizeData(t);return s?s.getAnimationId(e):null}isImmediateChange(t,e,s){const i=this.getSizeData(t);return i?i.isImmediateChange(e,s):null}getStartFrame(t,e,s){const i=this.getSizeData(t);return i?i.getStartFrame(e,s):null}getFrame(t,e,s,i,n){const a=this.getSizeData(t);return a?a.getFrame(e,s,i,n):null}getFrameFromSequence(t,e,s,i,n,a,o){const h=this.getSizeData(t);return h?h.getFrameFromSequence(e,s,i,n,a,o):null}}const CE=class Xy extends d_{constructor(){super(),this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0}initialize(t){return this.reset(),t instanceof ni?(this._type=t.type,this._data=t,!0):!1}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(t,e){this._cacheDirection===e&&this._cacheScale===t||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=e,this._cacheScale=t,this._cacheSize=this.getValidSize(t),this.setLayerCount((this._data&&this._data.getLayerCount(t)||0)+this.getAdditionalLayerCount()))}update(t,e,s,i){if(!t)return;const n=t.scale;let a=!1;this.updateObject(n,t.direction.x)&&(a=!0),this.updateModel(n)&&(a=!0);let o=0;i?this._animationNumber=this._animationNumber|this.updateAnimation(n):(o=this.updateAnimation(n)|this._animationNumber,this._animationNumber=0),(a||o!==0)&&(this.updateSprites(n,a,o),this._scale=n,this.updateSpriteCounter++)}updateObject(t,e){if(!this.object||this.updateObjectCounter===this.object.updateCounter&&t===this._scale&&this._lastCameraAngle===e)return!1;let s=this.object.getDirection().x-(e+135);if(s=(s%360+360)%360,this._data){const i=this._data.getValidDirection(t,s);this.setDirection(i)}return this._lastCameraAngle=e,this._scale=t,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(t,this._direction),!0}updateModel(t){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;this._selectedColor=e.getValue(I.FURNITURE_COLOR),this._clickUrl=e.getValue(I.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&this._clickUrl!==""&&this._clickUrl.indexOf("http")===0||!1,this._furnitureLift=e.getValue(I.FURNITURE_LIFT_AMOUNT)||0;let s=e.getValue(I.FURNITURE_ALPHA_MULTIPLIER);return isNaN(s)&&(s=1),this._alphaMultiplier!==s&&(this._alphaMultiplier=s,this._alphaChanged=!0),this.updateModelCounter=e.updateCounter,!0}updateSprites(t,e,s){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),e){let i=this.totalSprites-1;for(;i>=0;)this.updateSprite(t,i),i--}else{let i=0;for(;s>0;)s&&this.updateSprite(t,i),i++,s=s>>1}this._alphaChanged=!1}updateSprite(t,e){const s=this.getSpriteAssetName(t,e),i=this.getSprite(e);if(s&&i){const n=this.getAsset(s,e);if(n&&n.texture){i.visible=!0,i.type=this._type,i.texture=n.texture,i.flipH=n.flipH,i.flipV=n.flipV,i.direction=this._direction;let a=0;e!==this._shadowLayerIndex?(i.tag=this.getLayerTag(t,this._direction,e),i.alpha=this.getLayerAlpha(t,this._direction,e),i.color=this.getLayerColor(t,e,this._selectedColor),i.offsetX=n.offsetX+this.getLayerXOffset(t,this._direction,e),i.offsetY=n.offsetY+this.getLayerYOffset(t,this._direction,e),i.blendMode=this.getLayerInk(t,this._direction,e),i.alphaTolerance=this.getLayerIgnoreMouse(t,this._direction,e)?bs.MATCH_NOTHING:bs.MATCH_OPAQUE_PIXELS,a=this.getLayerZOffset(t,this._direction,e),a=a-e*.001):(i.offsetX=n.offsetX,i.offsetY=n.offsetY+this.getLayerYOffset(t,this._direction,e),i.alpha=48*this._alphaMultiplier,i.alphaTolerance=bs.MATCH_NOTHING,a=1),i.relativeDepth=a*Xy.DEPTH_MULTIPLIER,i.name=s,i.libraryAssetName=this.getLibraryAssetNameForSprite(n,i),i.posture=this.getPostureForAsset(t,n.source),i.clickHandling=this._clickHandling}else this.resetSprite(i)}else i&&this.resetSprite(i)}getLibraryAssetNameForSprite(t,e){return t.source}getPostureForAssetFile(t,e){return null}resetSprite(t){t&&(t.texture=null,t.libraryAssetName="",t.posture="",t.tag="",t.offsetX=0,t.offsetY=0,t.flipH=!1,t.flipV=!1,t.relativeDepth=0,t.clickHandling=!1)}getSpriteAssetName(t,e){if(!this._data||e>=ni.LAYER_LETTERS.length)return"";let s=this._assetNames[e],i=this._updatedLayers[e];return(!s||!s.length)&&(s=this.cacheSpriteAssetName(t,e,!0),i=this._cacheSize!==1),i&&(s+=this.getFrameNumber(t,e)),s}cacheSpriteAssetName(t,e,s){this._type;const i=s?this._cacheSize:this.getValidSize(t);let n="";const a=i!==1;if(e!==this._shadowLayerIndex?n=ni.LAYER_LETTERS[e]||"":n="sd",n==="")return null;const o=this._type+(a?"_"+i+"_"+n+"_"+this._direction+"_":"_icon_"+n);return s&&(this._assetNames[e]=o,this._updatedLayers[e]=a),o}getLayerTag(t,e,s){const i=this._spriteTags[s];if(i!==void 0)return i;if(!this._data)return Bt.DEFAULT_TAG;const n=this._data.getLayerTag(t,e,s);return this._spriteTags[s]=n,n}getLayerInk(t,e,s){const i=this._spriteInks[s];if(i!==void 0)return i;if(!this._data)return Bt.DEFAULT_INK;const n=this._data.getLayerInk(t,e,s);return this._spriteInks[s]=n,n}getLayerAlpha(t,e,s){if(!this._alphaChanged){const n=this._spriteAlphas[s];if(n!==void 0)return n}if(!this._data)return Bt.DEFAULT_ALPHA;let i=this._data.getLayerAlpha(t,e,s);return this._alphaMultiplier!==null&&(i=i*this._alphaMultiplier),this._spriteAlphas[s]=i,i}getLayerColor(t,e,s){const i=this._spriteColors[e];if(i!==void 0)return i;if(!this._data)return Th.DEFAULT_COLOR;const n=this._data.getLayerColor(t,e,s);return this._spriteColors[e]=n,n}getLayerIgnoreMouse(t,e,s){const i=this._spriteMouseCaptures[s];if(i!==void 0)return i;if(!this._data)return Bt.DEFAULT_IGNORE_MOUSE;const n=this._data.getLayerIgnoreMouse(t,e,s);return this._spriteMouseCaptures[s]=n,n}getLayerXOffset(t,e,s){const i=this._spriteXOffsets[s];if(i!==void 0)return i;if(!this._data)return Bt.DEFAULT_XOFFSET;const n=this._data.getLayerXOffset(t,e,s);return this._spriteXOffsets[s]=n,n}getLayerYOffset(t,e,s){if(s===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(t/2));const i=this._spriteYOffsets[s];if(i!==void 0)return i;if(!this._data)return Bt.DEFAULT_YOFFSET;const n=this._data.getLayerYOffset(t,e,s);return this._spriteYOffsets[s]=n,n}getLayerZOffset(t,e,s){const i=this._spriteZOffsets[s];if(i!==void 0)return i;if(!this._data)return Bt.DEFAULT_ZOFFSET;const n=this._data.getLayerZOffset(t,e,s);return this._spriteZOffsets[s]=n,n}getValidSize(t){return this._data?this._data.getValidSize(t):t}setLayerCount(t){this._layerCount=t,this._shadowLayerIndex=t-this.getAdditionalLayerCount()}setDirection(t){this._direction!==t&&(this._direction=t)}getAdditionalLayerCount(){return 1}updateAnimation(t){return 0}getFrameNumber(t,e){return 0}getPostureForAsset(t,e){return null}getAsset(t,e=-1){return this.asset?this.asset.getAsset(t):null}get direction(){return this._direction}get data(){return this._data}};CE.DEPTH_MULTIPLIER=Math.sqrt(.5);CE.TYPE=F.FURNITURE_STATIC;let Kn=CE;const NE=class lg extends Kn{constructor(){super(),this._state=-1,this._frameIncrease=1,this._animationData=new zy,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(t){return t instanceof ME?super.initialize(t):!1}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(t){return this.animationId!==lg.DEFAULT_ANIMATION_ID&&this.data.hasAnimation(this._animationScale,this.animationId)?this.animationId:lg.DEFAULT_ANIMATION_ID}updateObject(t,e){if(super.updateObject(t,e)){const s=this.object.getState(0);return s!==this._state&&(this.setAnimation(s),this._state=s,this._animationChangeTime=this.object.model.getValue(I.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(t){if(super.updateModel(t)){if(this.usesAnimationResetting()){const s=this.object.model.getValue(I.FURNITURE_STATE_UPDATE_TIME);s>this._animationChangeTime&&(this._animationChangeTime=s,this.setAnimation(this._state))}const e=this.object.model.getValue(I.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(e)){const s=this.data.getAnimationId(this._animationScale,e);this.setAnimation(s)}return!0}return!1}isPlayingTransition(t,e){return!(!Le.isTransitionFromAnimation(t.animationId)&&!Le.isTransitionToAnimation(t.animationId)||e!==t.animationAfterTransitionId||t.animationOver)}getCurrentState(t){const e=t.animationId;return!Le.isTransitionFromAnimation(e)&&!Le.isTransitionToAnimation(e)?e:t.animationAfterTransitionId}setAnimation(t){this.data&&this.setSubAnimation(this._animationData,t,this._state>=0)}setSubAnimation(t,e,s=!0){const i=t.animationId;if(s){if(this.isPlayingTransition(t,e))return!1;const n=this.getCurrentState(t);if(e!==n){if(!this.data.isImmediateChange(this._animationScale,e,n)){let a=Le.getTransitionFromAnimationId(n);this.data.hasAnimation(this._animationScale,a)?(t.animationAfterTransitionId=e,e=a):(a=Le.getTransitionToAnimationId(e),this.data.hasAnimation(this._animationScale,a)&&(t.animationAfterTransitionId=e,e=a))}}else if(Le.isTransitionFromAnimation(t.animationId)){const a=Le.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,a)&&(t.animationAfterTransitionId=e,e=a)}else if(!Le.isTransitionToAnimation(t.animationId)&&this.usesAnimationResetting()){const a=Le.getTransitionFromAnimationId(n);if(this.data.hasAnimation(this._animationScale,a))t.animationAfterTransitionId=e,e=a;else{const o=Le.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,o)&&(t.animationAfterTransitionId=e,e=o)}}}return i!==e?(t.animationId=e,!0):!1}getLastFramePlayed(t){return this._animationData.getLastFramePlayed(t)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(t){if(!this.data)return 0;t!==this._animationScale&&(this._animationScale=t,this._animatedLayerCount=this.data.getLayerCount(t),this.resetAllAnimationFrames());const e=this.updateAnimations(t);return this._directionChanged=!1,e}updateAnimations(t){if(this._animationData.animationOver&&!this._directionChanged)return 0;const e=this.updateFramesForAnimation(this._animationData,t);return this._animationData.animationOver&&(Le.isTransitionFromAnimation(this._animationData.animationId)||Le.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),e}updateFramesForAnimation(t,e){if(t.animationOver&&!this._directionChanged)return 0;const s=this.getAnimationId(t);let i=t.frameCounter;i||(i=this.data.getStartFrame(e,s,this._direction)),i+=this.frameIncrease,t.frameCounter=i,t.animationOver=!0;let n=!1,a=this._animatedLayerCount-1,o=0,h=1<<this._animatedLayerCount-1;for(;a>=0;){let u=0;if(n=t.getAnimationPlayed(a),!n||this._directionChanged){let c=t.getLastFramePlayed(a),l=t.getFrame(a);l&&l.isLastFrame&&l.remainingFrameRepeats<=this.frameIncrease&&(c=!0),(this._directionChanged||!l||l.remainingFrameRepeats>=0&&(l.remainingFrameRepeats=l.remainingFrameRepeats-this.frameIncrease)<=0)&&(u=Da.SEQUENCE_NOT_DEFINED,l&&(u=l.activeSequence),u===Da.SEQUENCE_NOT_DEFINED?l=this.data.getFrame(e,s,this._direction,a,i):l=this.data.getFrameFromSequence(e,s,this._direction,a,u,l.activeSequenceOffset+l.repeats,i),t.setFrame(a,l),o=o|h),!l||l.remainingFrameRepeats==Da.FRAME_REPEAT_FOREVER?(c=!0,n=!0):t.animationOver=!1,t.setLastFramePlayed(a,c),t.setAnimationPlayed(a,n)}h=h>>1,a--}return o}getFrameNumber(t,e){const s=this._animationData.getFrame(e);return s?s.id:super.getFrameNumber(t,e)}getLayerXOffset(t,e,s){const i=super.getLayerXOffset(t,e,s),n=this._animationData.getFrame(s);return n?i+n.x:i}getLayerYOffset(t,e,s){const i=super.getLayerYOffset(t,e,s),n=this._animationData.getFrame(s);return n?i+n.y:i}usesAnimationResetting(){return!1}setDirection(t){this._direction!==t&&(super.setDirection(t),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}get data(){return this._data}};NE.TYPE=F.FURNITURE_ANIMATED;NE.DEFAULT_ANIMATION_ID=0;let pe=NE;const Ky=class sl extends pe{constructor(){super(),this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(t){let e=super.updateModel(t);const s=this.object.model.getValue(I.FURNITURE_BADGE_IMAGE_STATUS),i=this.object.model.getValue(I.FURNITURE_BADGE_ASSET_NAME);if(s===-1)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(s===1&&i!==this._badgeId){this._badgeId=i,this._badgeAssetNameNormalScale=this._badgeId,this._badgeAssetNameSmallScale===""&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const n=this.object.model.getValue(I.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(n)||(this._badgeVisibleInState=n),e=!0}return e}getSpriteAssetName(t,e){return this.getLayerTag(t,this.direction,e)!==sl.BADGE||this._badgeVisibleInState!==-1&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(t,e):t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s);if(this.getLayerTag(t,e,s)===sl.BADGE){const n=this.getAsset(t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);n&&(t===64?i+=(40-n.width)/2:i+=(20-n.width)/2)}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s);if(this.getLayerTag(t,e,s)===sl.BADGE){const n=this.getAsset(t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);n&&(t===64?i+=(40-n.height)/2:i+=(20-n.height)/2)}return i}};Ky.BADGE="BADGE";let xtt=Ky;const io=class ln extends Kn{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._isAnimated=!1,this._gifCollection=null,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(t,e){return super.updateObject(t,e)?(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0):!1}updateModel(t){const e=super.updateModel(t);if(e&&(this._offsetX=this.object.model.getValue(I.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(I.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(I.FURNITURE_BRANDING_OFFSET_Z)||0,this._isAnimated=this.object.model.getValue(I.FURNITURE_BRANDING_IS_ANIMATED)||!1),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return e}checkIfImageChanged(){const t=this.object.model.getValue(I.FURNITURE_BRANDING_IMAGE_URL);return t&&t===this._imageUrl?!1:(this._gifCollection,this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const e=this.object.model.getValue(I.FURNITURE_BRANDING_IMAGE_URL);if(!e||this._imageUrl&&this._imageUrl===e)return!1;if(this.object.model.getValue(I.FURNITURE_BRANDING_IMAGE_STATUS)===1){let i=null;if(this._isAnimated){const n=Q.instance.roomEngine.roomContentLoader.getGifCollection(e);n&&(this._gifCollection=n,i=n.textures[0])}else i=Cs().getTexture(e);return i?(this.imageReady(i,e),!0):!1}return!1}imageReady(t,e){if(!t){this._imageUrl=null;return}this._imageUrl=e}checkAndCreateImageForCurrentState(){if(this._isAnimated){this.buildAssetsForGif();return}if(!this._imageUrl)return;const t=Cs().getTexture(this._imageUrl);if(!t)return;const e=this.object.getState(0);this.addBackgroundAsset(t,e,0)}buildAssetsForGif(){if(!this._gifCollection)return;const t=this._gifCollection.textures,e=this._gifCollection.durations;if(!t.length||!e.length||t.length!==e.length)return;const s=this.object.getState(0);for(let i=0;i<t.length;i++){const n=t[i];e[i],n&&this.addBackgroundAsset(n,s,i)}this._currentFrame=-1,this._totalFrames=t.length}addBackgroundAsset(t,e,s){let i=0,n=0,a=!1,o=!1;switch(e){case ln.STATE_0:i=0,n=0,a=!1,o=!1;break;case ln.STATE_1:i=-t.width,n=0,a=!0,o=!1;break;case ln.STATE_2:i=-t.width,n=-t.height,a=!0,o=!0;break;case ln.STATE_3:i=0,n=-t.height,a=!1,o=!0;break}this.asset.addAsset(`${this._imageUrl}_${s}`,t,!0,i,n,a,o)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===ln.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(t,e)}`:super.getSpriteAssetName(t,e)}updateAnimation(t){return!this._imageReady||!this._isAnimated||this._totalFrames<=0?0:1}getFrameNumber(t,e){if(!this._imageReady||!this._isAnimated||this._totalFrames<=0)return 0;if(this.getLayerTag(t,this._direction,e)===ln.BRANDED_IMAGE&&this._imageUrl){let i=this._currentFrame;return i<0?i=0:i+=1,i===this._totalFrames&&(i=0),this._currentFrame=i,this._currentFrame}return 0}};io.BRANDED_IMAGE="branded_image";io.STATE_0=0;io.STATE_1=1;io.STATE_2=2;io.STATE_3=3;let bE=io;class qy extends bE{getLayerXOffset(t,e,s){return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+this._offsetZ}}const H_=class rl extends pe{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(t){if(t===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(rl.ANIMATION_ID_ROLL);return}if(t>=0&&t<=7){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(rl.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(rl.ANIMATION_ID_OFFSET_SLOW2+t),this._stateQueue.push(t);return}super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};H_.ANIMATION_ID_OFFSET_SLOW1=20;H_.ANIMATION_ID_OFFSET_SLOW2=9;H_.ANIMATION_ID_ROLL=-1;let Ftt=H_;class wtt extends Kn{}const Zh=class xo extends pe{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),i=this.object.getState(0);switch(s){case xo.SECONDS_SPRITE:return Math.floor(i%60%10);case xo.TEN_SECONDS_SPRITE:return Math.floor(i%60/10);case xo.MINUTES_SPRITE:return Math.floor(i/60%10);case xo.TEN_MINUTES_SPRITE:return Math.floor(i/60/10%10);default:return super.getFrameNumber(t,e)}}get animationId(){return 0}};Zh.SECONDS_SPRITE="seconds_sprite";Zh.TEN_SECONDS_SPRITE="ten_seconds_sprite";Zh.MINUTES_SPRITE="minutes_sprite";Zh.TEN_MINUTES_SPRITE="ten_minutes_sprite";let Gtt=Zh;class Btt extends d_{}const Qy=class _g extends pe{constructor(){super(),this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return this._thumbnailImageNormal!=null}setThumbnailImages(t){this._thumbnailImageNormal=t,this._thumbnailChanged=!0}updateModel(t){const e=super.updateModel(t);return!this._thumbnailChanged&&this._thumbnailDirection===this.direction?e:(this.refreshThumbnail(),!0)}refreshThumbnail(){this.asset!=null&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(t,e){let s=0;for(;s<this.totalSprites;){if(this.getLayerTag(e,this.direction,s)===_g.THUMBNAIL){const i=this.cacheSpriteAssetName(e,s,!1)+this.getFrameNumber(e,s),n=this.getAsset(i,s);if(n){const a=this.generateTransformedThumbnail(t,n),o=this.getThumbnailAssetName(e);this.asset.disposeAsset(o),this.asset.addAsset(o,a,!0,n.offsetX,n.offsetY,!1,!1)}return}s++}}generateTransformedThumbnail(t,e){if(this._hasOutline){const o=new te,h=new te(hR.WHITE);h.tint=0,h.width=t.width+40,h.height=t.height+40;const u=new te(t),c=(h.width-u.width)/2,l=(h.height-u.height)/2;u.position.set(c,l),o.addChild(h,u),t=Qt.generateTexture(o)}const s=1.1,i=new Vt,n=e.width/t.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*s,i.tx=0,i.ty=.5*n*t.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*s,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const a=new te(t);return a.transform.setFromMatrix(i),Qt.generateTexture(a)}getSpriteAssetName(t,e){return this._thumbnailImageNormal&&this.getLayerTag(t,this.direction,e)===_g.THUMBNAIL?this.getThumbnailAssetName(t):super.getSpriteAssetName(t,e)}getThumbnailAssetName(t){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(t,e){return[this._type,t,"thumb",e].join("_")}};Qy.THUMBNAIL="THUMBNAIL";let Zy=Qy;class Jy extends Zy{constructor(){super(),this._cachedUrl=null,this._hasOutline=!0}updateModel(t){if(this.object){const e=this.getThumbnailURL();if(this._cachedUrl!==e)if(this._cachedUrl=e,this._cachedUrl&&this._cachedUrl!==""){const s=new Image;s.src=e,s.crossOrigin="*",s.onload=()=>{const i=_t.from(s);i.baseTexture.scaleMode=_s.LINEAR,this.setThumbnailImages(i)}}else this.setThumbnailImages(null)}return super.updateModel(t)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class Htt extends Jy{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const t=this.object.model.getValue(I.FURNITURE_DATA);if(!t||t==="")return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let s=JSON.parse(t).w||"";return s=this.buildThumbnailUrl(s),this._url=s,this._url}buildThumbnailUrl(t){return t=t.replace(".png","_small.png"),t.indexOf(".png")===-1&&(t=t+"_small.png"),t}}class mI{constructor(){this._hasMoved=!1,this._age=0,this._isEmitter=!1,this._fade=!1,this._alphaMultiplier=1}init(t,e,s,i,n,a,o,h=!1,u=null,c=!1){this._x=t,this._y=e,this._z=s,this._particleDirection=new Os(i.x,i.y,i.z),this._particleDirection.scaleBy(n),this._lastX=this._x-this._particleDirection.x*a,this._lastY=this._y-this._particleDirection.y*a,this._lastZ=this._z-this._particleDirection.z*a,this._age=0,this._hasMoved=!1,this._lifeTime=o,this._isEmitter=h,this._frames=u,this._fade=c,this._alphaMultiplier=1,this._fadeTime=.5+Math.random()*.5}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}get lastX(){return this._lastX}set lastX(t){this._hasMoved=!0,this._lastX=t}get lastY(){return this._lastY}set lastY(t){this._hasMoved=!0,this._lastY=t}get lastZ(){return this._lastZ}set lastZ(t){this._hasMoved=!0,this._lastZ=t}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(t,e){this._x=t._x*e,this._y=t._y*e,this._z=t._z*e,this._lastX=t._lastX*e,this._lastY=t._lastY*e,this._lastZ=t._lastZ*e,this._hasMoved=t.hasMoved,this._particleDirection=t._particleDirection,this._age=t._age,this._lifeTime=t._lifeTime,this._isEmitter=t._isEmitter,this._fade=t._fade,this._fadeTime=t._fadeTime,this._alphaMultiplier=t._alphaMultiplier}}const V_=class il extends mI{constructor(t="",e=-1){super(),this._roomObjectSpriteId=-1,this._timeStep=.1,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._particles=[],this._name=t,this._roomObjectSpriteId=e,this._particleConfigurations=[]}dispose(){for(const t of this._particles)t.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(t,e,s,i,n,a,o,h,u,c){this._maxNumberOfParticles=t,this._particlesPerFrame=e,this._force=s,this._emitterDirection=i,this._emitterDirection.normalize(),this._gravity=n,this._airFriction=a,this._explosionShape=o,this._fuseTime=u,this._energy=h,this._burstPulse=c,this.reset()}reset(){for(const t of this._particles)t.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(t,e){super.copy(t,e),this._force=t._force,this._emitterDirection=t._emitterDirection,this._gravity=t._gravity,this._airFriction=t._airFriction,this._explosionShape=t._explosionShape,this._fuseTime=t._fuseTime,this._energy=t._energy,this._burstPulse=t._burstPulse,this._timeStep=t._timeStep,this._hasIgnited=t._hasIgnited}configureParticle(t,e,s,i){const n={};n.lifeTime=t,n.isEmitter=e,n.frames=s,n.fade=i,this._particleConfigurations.push(n)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(t,e=null){e||(e=new Os);const s=new Os,i=this.getRandomParticleConfiguration();let n=0;for(;n<this._particlesPerFrame;){switch(this._explosionShape){case il.CONE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=-(Math.random()+1),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case il.PLANE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=0,s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case il.SPHERE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=this.randomBoolean(.5)?Math.random():-Math.random(),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break}s.normalize();const a=new mI;let o=0,h=!1,u=!1,c=[];i?(o=Math.floor(Math.random()*i.lifeTime+10),h=i.isEmitter,c=i.frames,u=i.fade):(o=Math.trunc(Math.floor(Math.random()*20+10)),h=!1,c=[]),a.init(t.x,t.y,t.z,s,this._energy,this._timeStep,o,h,c,u),this._particles.push(a),this._emittedParticles++,n++}}getRandomParticleConfiguration(){const t=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[t]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const e=this.x,s=this.y,i=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=e,this.lastY=s,this.lastZ=i}const t=[];for(const e of this._particles){e.update();const s=e.x,i=e.y,n=e.z;e.x=(2-this._airFriction)*e.x-(1-this._airFriction)*e.lastX,e.y=(2-this._airFriction)*e.y-(1-this._airFriction)*e.lastY+this._gravity*this._timeStep*this._timeStep,e.z=(2-this._airFriction)*e.z-(1-this._airFriction)*e.lastZ,e.lastX=s,e.lastY=i,e.lastZ=n,(e.y>10||!e.isAlive)&&t.push(e)}for(const e of t)e.isEmitter,this._particles.splice(this._particles.indexOf(e),1),e.dispose()}satisfyConstraints(){}accumulateForces(){for(const t of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(t){return Math.random()<t}get roomObjectSpriteId(){return this._roomObjectSpriteId}};V_.CONE="cone";V_.PLANE="plane";V_.SPHERE="sphere";let Vtt=V_;class ktt{constructor(t){this._canvasId=-1,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blend=1,this._bgColor=4278190080,this._isDone=!1,this._emitters=new de,this._visualization=t,this._blackOverlayAlphaTransform=new Bd,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new Bd,this._identityMatrix=new Vt,this._translationMatrix=new Vt}dispose(){for(const t of this._emitters.getValues())t.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(t){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(t),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(!(!this._currentEmitter||this._canvasId===-1)&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;this._canvasTexture&&(this._canvasTexture.width!==this._roomSprite.width||this._canvasTexture.height!==this._roomSprite.height)&&(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(t,e,s){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===s?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(t){return this._currentEmitter?this._currentEmitter.roomObjectSpriteId==t:!1}updateSprites(){!this._currentEmitter||!this._roomSprite||(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;const t=10;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const e=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const s of this._currentEmitter.particles){const i=this._centerX+(s.x-s.z)*t/10*this._scaleMultiplier,n=this._centerY-e+(s.y+(s.x+s.z)/2)*t/10*this._scaleMultiplier,a=s.getAsset();if(a&&a.texture)if(s.fade&&s.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(i+a.offsetX,n+a.offsetY);const o=new te(a.texture);this._particleColorTransform.alpha=s.alphaMultiplier,o.filters=[this._particleColorTransform],Me.instance.renderer.render(o,{renderTexture:this._canvasTexture,transform:this._translationMatrix,clear:!1})}else{const o=new vl(i+a.offsetX,n+a.offsetY),h=new te(a.texture);h.x=o.x,h.y=o.y,Me.instance.renderer.render(h,{renderTexture:this._canvasTexture,clear:!1})}else{const o=new te(_t.WHITE);o.tint=16777215,o.x=i-1,o.y=n-1,o.width=2,o.height=2,Me.instance.renderer.render(o,{renderTexture:this._canvasTexture,clear:!1})}}if(!this._currentEmitter.particles.length){this._isDone=!0;return}}}parseData(t){this._size=t.size,this._canvasId=t.canvasId!==void 0?t.canvasId:-1,this._offsetY=t.offsetY!==void 0?t.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=t.blend!==void 0?t.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const e=t.bgColor!==void 0?t.bgColor:"0";if(this._bgColor=parseInt(e,16)||0,!(!t.emitters||!t.emitters.length))for(const s of t.emitters){const i=s.id,n=s.name,a=s.spriteId,o=new Vtt(n,a);this._emitters.add(i,o);const h=s.maxNumParticles,u=s.particlesPerFrame,c=s.burstPulse!==void 0?s.burstPulse:1,l=s.fuseTime,_=s.simulation.force,d=s.simulation.direction,f=s.simulation.gravity,m=s.simulation.airFriction,p=s.simulation.shape,T=s.simulation.energy;for(const v of s.particles){const O=v.lifeTime,A=v.isEmitter||!1,y=v.fade||!1,M=[];for(const N of v.frames)M.push(this._visualization.asset.getAsset(N));o.configureParticle(O,A,M,y)}o.setup(h,u,_,new Os(0,d,0),f,m,p,T,l,c)}}copyStateFrom(t){let e=0;t._emitters&&t._currentEmitter&&(e=t._emitters.getKey(t._emitters.getValues().indexOf(t._currentEmitter))),this.setAnimation(e),this._currentEmitter&&this._currentEmitter.copyStateFrom(t._currentEmitter,t._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new te(_t.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?Me.instance.renderer.render(this._emptySprite,{renderTexture:this._canvasTexture,clear:!0}):this._canvasTexture=we.create({width:this._roomSprite.width,height:this._roomSprite.height})}}class $y extends pe{dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const t of this._particleSystems.getValues())t.dispose();this._particleSystems=null}}updateObject(t,e){if(super.updateObject(t,e)){if(!this._particleSystems)this.readDefinition(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(t):Y.log("ERROR Particle systems could not be read!",this.object.type);else if(t!==this._scale||this._particleSystems.getValue(t)!==this._currentParticleSystem){const s=this._particleSystems.getValue(t);s.copyStateFrom(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=s}return!0}return!1}updateSprites(t,e,s){super.updateSprites(t,e,s),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(t){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(t)}setAnimation(t){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(t),super.setAnimation(t)}getLayerYOffset(t,e,s){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(s)?this._currentParticleSystem.getLayerYOffset(t,e,s):super.getLayerYOffset(t,e,s)}readDefinition(){if(!this.object||!this.object.model)return!1;const t=this.object.model.getValue(I.FURNITURE_FIREWORKS_DATA);if(!t||!t.length)return!1;this._particleSystems=new de;for(const e of t){const s=e.size,i=new ktt(this);i.parseData(e),this._particleSystems.add(s,i)}return!0}}const k_=class nl extends $y{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(t,e,s,i){this.updatePresentWrap(),super.update(t,e,s,i)}updatePresentWrap(){if(!this.object)return;const t=1e3,e=this.object.model.getValue(I.FURNITURE_EXTRAS),s=parseInt(e),i=Math.floor(s/t),n=s%t;this._packetType=i>nl.MAX_PACKET_TYPE_VALUE?0:i,this._ribbonType=n>nl.MAX_RIBBON_TYPE_VALUE?0:n}getFrameNumber(t,e){if(this._lastAnimationId===nl.PRESENT_DEFAULT_STATE){if(e<=1)return this._packetType;if(e===2)return this._ribbonType}return super.getFrameNumber(t,e)}getSpriteAssetName(t,e){const s=this.getValidSize(t);let i=this._type,n="";e<this.spriteCount-1?n=String.fromCharCode("a".charCodeAt(0)+e):n="sd";const a=this.getFrameNumber(t,e);return i=i+("_"+s+"_"+n+"_"+this.direction),i=i+("_"+a),i}setAnimation(t){this._lastAnimationId=t,super.setAnimation(t)}};k_.PRESENT_DEFAULT_STATE=0;k_.MAX_PACKET_TYPE_VALUE=9;k_.MAX_RIBBON_TYPE_VALUE=11;let jtt=k_;class ztt extends Kn{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(t,e,s,i){this.updatePresentWrap(),super.update(t,e,s,i)}updatePresentWrap(){if(!this.object)return;const t=this.object.model.getValue(I.FURNITURE_EXTRAS),e=1e3,s=parseInt(t);this._packetType=Math.floor(s/e),this._ribbonType=s%e}getFrameNumber(t,e){return e<=1?this._packetType:this._ribbonType}getSpriteAssetName(t,e){const s=this.getValidSize(t);let i=this._type,n="";e<this.spriteCount-1?n=String.fromCharCode("a".charCodeAt(0)+e):n="sd";const a=this.getFrameNumber(t,e);return i=i+("_"+s+"_"+n+"_"+this.direction),i=i+("_"+a),i}}const no=class Ur extends pe{constructor(){super(),this._color1=Ur.DEFAULT_COLOR_1,this._color2=Ur.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(t){const e=super.updateModel(t);if(this._badgeAssetNameNormalScale===""){const n=this.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&(this._badgeAssetNameNormalScale=n,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const s=this.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||Ur.DEFAULT_COLOR_1;const i=this.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||Ur.DEFAULT_COLOR_2,e}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case Ur.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case Ur.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===Ur.BADGE?t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(t,e)}getLibraryAssetNameForSprite(t,e){return e.tag===Ur.BADGE?"%group.badge.url%"+e.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(t,e)}};no.PRIMARY_COLOUR_SPRITE_TAG="COLOR1";no.SECONDARY_COLOUR_SPRITE_TAG="COLOR2";no.BADGE="BADGE";no.DEFAULT_COLOR_1=15658734;no.DEFAULT_COLOR_2=4934475;let Ytt=no;const Jh=class ca extends Zy{updateModel(t){const e=super.updateModel(t);if(!this.hasThumbnailImage){const n=this.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);n&&n.length&&this.setThumbnailImages(this.getBitmapAsset(n))}const s=this.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||ca.DEFAULT_COLOR_1;const i=this.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||ca.DEFAULT_COLOR_2,e}generateTransformedThumbnail(t,e){const i=new Vt,n=e.width/t.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=.5*n*t.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const a=new te(t);return a.transform.setFromMatrix(i),a.position.set(0),Qt.generateTexture(a)}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case ca.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case ca.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getLibraryAssetNameForSprite(t,e){return e.tag===ca.THUMBNAIL&&this.object&&this.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(t,e)}getBitmapAsset(t){const e=this.asset.getAsset(t);return!e||!e.texture?null:e.texture}};Jh.PRIMARY_COLOUR_SPRITE_TAG="COLOR1";Jh.SECONDARY_COLOUR_SPRITE_TAG="COLOR2";Jh.DEFAULT_COLOR_1=15658734;Jh.DEFAULT_COLOR_2=4934475;let Wtt=Jh;const $h=class da extends pe{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(t){if(t===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(da.ANIMATION_ID_START_ROLL),this._stateQueue.push(da.ANIMATION_ID_ROLL);return}if(t>0&&t<=da.ANIMATION_ID_OFFSET_SLOW1){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(da.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(da.ANIMATION_ID_OFFSET_SLOW2+t),this._stateQueue.push(t);return}super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};$h.ANIMATION_ID_OFFSET_SLOW1=10;$h.ANIMATION_ID_OFFSET_SLOW2=20;$h.ANIMATION_ID_START_ROLL=31;$h.ANIMATION_ID_ROLL=32;let Xtt=$h;class Ktt extends qy{constructor(){super(...arguments),this._needsTransform=!0}transformGifTextures(t){if(!this._gifCollection)return;const e=this._gifCollection.textures;if(e.length){for(let s=0;s<e.length;s++){const i=e[s];if(!i||!this.getAsset(`${this._imageUrl}_${s}`))continue;const a=1.1,o=new Vt,h=t.width/i.width;switch(this.direction){case 2:o.a=h,o.b=-.5*h,o.c=0,o.d=h*a,o.tx=0,o.ty=.5*h*i.width;break;case 0:case 4:o.a=h,o.b=.5*h,o.c=0,o.d=h*a,o.tx=0,o.ty=0;break;default:o.a=h,o.b=0,o.c=0,o.d=h,o.tx=0,o.ty=0}const u=new te(i),c=we.create({width:t.width+o.tx,height:t.height+o.ty});Me.instance.renderer.render(u,{renderTexture:c,clear:!0,transform:o}),this.asset.disposeAsset(`${this._imageUrl}_${s}`),this.asset.addAsset(`${this._imageUrl}_${s}`,c,!0,t.x,t.y,t.flipH,t.flipV)}this._needsTransform=!1}}generateTransformedImage(t,e){const i=new Vt,n=e.width/t.width;switch(this.direction){case 2:i.a=n,i.b=-.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=.5*n*t.width;break;case 0:case 4:i.a=n,i.b=.5*n,i.c=0,i.d=n*1.1,i.tx=0,i.ty=0;break;default:i.a=n,i.b=0,i.c=0,i.d=n,i.tx=0,i.ty=0}const a=new te(t),o=we.create({width:e.width+i.tx,height:e.height+i.ty});Me.instance.renderer.render(a,{renderTexture:o,clear:!0,transform:i}),this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,o,!0,a.x,a.y,e.flipH,e.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===bE.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&(this._isAnimated?this.transformGifTextures(this.getAsset(super.getSpriteAssetName(t,e))):this.generateTransformedImage(Cs().getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(t,e)))),`${this._imageUrl}_${this.getFrameNumber(t,e)}`):super.getSpriteAssetName(t,e)}}class cg extends ni{constructor(){super(),this._avatarData=new jl}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(t,e,s=null,i=null,n=null){return this._avatarData.createAvatarImage(t,e,s,i,n)}set avatarManager(t){this._avatarData.avatarManager=t}}const t0=class al extends Kn{constructor(){super(),this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(t){return t instanceof cg?super.initialize(t):!1}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(t,e){const s=super.updateObject(t,e);return s&&this._mannequinScale!==t&&(this._mannequinScale=t,this.updateAvatar()),s}updateModel(t){let e=super.updateModel(t);if(e){const s=this.object.model.getValue(I.FURNITURE_MANNEQUIN_FIGURE)||null;s&&(this._figure=s+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(I.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return e=e||this._needsUpdate,this._needsUpdate=!1,e}updateAvatar(t=!1){if(!this.avatarExists()||t){const e=this.data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);e&&(e.setDirection(Je.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this.getAvatarAssetName(),e.getImage(Je.FULL,!1,1,!1),!0),this._dynamicAssetName=this.getAvatarAssetName(),this._needsUpdate=!0,e.dispose())}}avatarExists(){return this._figure&&this.getAsset(this.getAvatarAssetName())!==null}getAvatarAssetName(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(t){t===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(t,e){const s=this.getLayerTag(t,this.direction,e);return this._figure&&s===al.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this.getAvatarAssetName():super.getSpriteAssetName(t,e)}getLayerXOffset(t,e,s){return this.getLayerTag(t,e,s)===al.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).width/2:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this.getLayerTag(t,e,s)===al.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).height:super.getLayerYOffset(t,e,s)}get disposed(){return this._disposed}get data(){return this._data}};t0.AVATAR_IMAGE_SPRITE_TAG="avatar_image";let qtt=t0;const ao=class _n extends pe{constructor(){super(),this._animOffsetIndex=[]}updateAnimation(t){this._animSpeedIndex||this.initItems(t);let e=this.getSprite(2);return e&&(this._animOffsetIndex[0]=this.getNewPoint(t,0)),e=this.getSprite(3),e&&(this._animOffsetIndex[1]=this.getNewPoint(t,1)),super.updateAnimation(t)}getNewPoint(t,e){let s=0,i=this._animPhaseIndex[e],n=this._animDirectionIndex[e];const a=this._animSpeedIndex[e],o=this._animFactorIndex[e];let h=1;t==32?(s=_n.AREA_DIAMETER_SMALL,h=.5):s=_n.AREA_DIAMETER_LARGE;const u=i+n*a;Math.abs(u)>=s&&(n>0?i=i-(u-s):i=i+(-s-u),n=-n,this._animDirectionIndex[e]=n);const c=(s-Math.abs(i))*o;let l=n*Math.sin(Math.abs(i/4))*c;return n>0?l=l-c:l=l+c,i=i+n*a*h,this._animPhaseIndex[e]=i,Math.trunc(l)==0&&(this._animFactorIndex[e]=this.getRandomAmplitudeFactor()),new vl(i,l)}initItems(t){let e;t===32?e=_n.AREA_DIAMETER_SMALL:e=_n.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*e*1.5),this._animPhaseIndex.push(Math.random()*e*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push(_n.ANIM_SPEED_FAST),this._animSpeedIndex.push(_n.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(t,e,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].y:super.getLayerYOffset(t,e,s)}getRandomAmplitudeFactor(){return Math.random()*30/100+.15}};ao.UPDATE_INTERVAL=2;ao.AREA_DIAMETER_SMALL=15;ao.AREA_DIAMETER_LARGE=31;ao.ANIM_SPEED_FAST=2;ao.ANIM_SPEED_SLOW=1;let Qtt=ao;const e0=class s0{constructor(t,e,s,i,n,a){this._name=t,this._index=e,this._radius=s,this._arcSpeed=i*Math.PI*2/360,this._arcOffset=n*Math.PI*2/360,this._height=a,this._position=0,this._positionVector=new S(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;)this._children.shift().dispose()}update(t,e,s){this._position=this._position+this._arcSpeed/s0.SYSTEM_TEMPO,t[this._index]=this.getPositionVector(e,s);for(const i of this._children)i.update(t,this._positionVector,s)}getPositionVector(t,e){const s=this._radius*Math.cos(this._position+this._arcOffset),i=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=(s-i)*(e/2),this._positionVector.y=(i+s)*(e/2)*.5-this._height*(e/2),this._positionVector.z=-Math.trunc(4*(s+i)-.7),t&&this._positionVector.add(t),this._positionVector}addChild(t){this._children.indexOf(t)>=0||this._children.push(t)}hasChild(t){return!!this.getChild(t)}getChild(t){for(const e of this._children){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}get name(){return this._name}};e0.SYSTEM_TEMPO=30;let Ztt=e0;class Jtt extends pe{constructor(){super(),this._offsetArray=[],this._rootPosition=new S}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;)this._planetIndex.shift().dispose();this._planetIndex=null,this._planetNameIndex=null}updateAnimation(t){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const e of this._planetIndex)e.update(this._offsetArray,this._rootPosition,t);return super.updateAnimation(t)}return 0}getLayerXOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].y:super.getLayerYOffset(t,e,s)}getLayerZOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].z:super.getLayerZOffset(t,e,s)}processPlanets(){if(!this.object||!this.object.model)return;const t=this.object.model.getValue(I.FURNITURE_PLANETSYSTEM_DATA);if(!t)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const e of t)this.getSprite(e.id)&&this.addPlanet(e.name,e.id,e.parent,e.radius||0,e.arcSpeed||0,e.arcOffset||0,e.height||0);return!0}addPlanet(t,e,s,i,n,a,o){if(!this._planetIndex)return;const h=new Ztt(t,e,i,n,a,o),u=this.getPlanet(s);u?u.addChild(h):(this._planetIndex.push(h),this._planetNameIndex.push(t))}getPlanet(t){for(const e of this._planetIndex){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}}class $tt extends pe{}const tu=class ol extends pe{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(t){return t===ol.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(ol.ANIMATION_ID_NORMAL),this._animationCounter=ol.ANIMATION_DURATION),super.setAnimation(t)}updateAnimation(t){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}usesAnimationResetting(){return!0}};tu.ANIMATION_ID_ROLL=3;tu.ANIMATION_ID_ROLL_ONCE=2;tu.ANIMATION_ID_NORMAL=1;tu.ANIMATION_DURATION=15;let tet=tu;class eet extends pe{usesAnimationResetting(){return!0}}class set extends bE{imageReady(t,e){super.imageReady(t,e),t&&this.setImageOffset(t.width,t.height)}setImageOffset(t,e){const s=new Hy;s.setDirection(1,0,-e),s.setDirection(3,0,0),s.setDirection(5,-t,0),s.setDirection(7,-t,-e),s.setDirection(4,-t/2,-e/2),this._imageOffset=s}getLayerXOffset(t,e,s){if(this._imageOffset){const i=this._imageOffset.getXOffset(e,0);if(i!==void 0)return i+this._offsetX}return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){if(this._imageOffset){const i=this._imageOffset.getYOffset(e,0);if(i!==void 0)return i+this._offsetY}return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+-this._offsetZ}getLayerIgnoreMouse(t,e,s){return!0}}const eu=class Fo extends pe{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),i=this.object.getState(0);switch(s){case Fo.ONES_SPRITE:return Math.floor(i%10);case Fo.TENS_SPRITE:return Math.floor(i/10%10);case Fo.HUNDREDS_SPRITE:return Math.floor(i/100%10);case Fo.THOUSANDS_SPRITE:return Math.floor(i/1e3%10);default:return super.getFrameNumber(t,e)}}};eu.ONES_SPRITE="ones_sprite";eu.TENS_SPRITE="tens_sprite";eu.HUNDREDS_SPRITE="hundreds_sprite";eu.THOUSANDS_SPRITE="thousands_sprite";let ret=eu;class iet extends pe{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(t){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(I.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(t)}}class net extends Kn{getLayerColor(t,e,s){return this._data?this._data.getLayerColor(t,e,s):Th.DEFAULT_COLOR}}const oo=class Hs extends pe{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(Hs.ANIMATION_ID_OFF)}setAnimation(t){if(t===0&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Hs.ANIMATION_ID_START_ROLL),this._stateQueue.push(Hs.ANIMATION_ID_ROLL);return}if(t>0&&t<=Hs.ANIMATION_ID_OFFSET_SLOW2){if(this._running){this._running=!1,this._stateQueue=[],this.direction===2?(this._stateQueue.push(Hs.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(Hs.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(Hs.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(Hs.ANIMATION_ID_OFFSET_SLOW2+t)),this._stateQueue.push(Hs.ANIMATION_ID_OFF);return}super.setAnimation(Hs.ANIMATION_ID_OFF)}}updateAnimation(t){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};oo.ANIMATION_ID_OFFSET_SLOW1=20;oo.ANIMATION_ID_OFFSET_SLOW2=10;oo.ANIMATION_ID_START_ROLL=31;oo.ANIMATION_ID_ROLL=32;oo.ANIMATION_ID_OFF=30;let aet=oo;const su=class pi extends pe{updateObject(t,e){return super.updateObject(t,e),!0}getFrameNumber(t,e){const s=this.object.model.getValue(I.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(t,this.direction,e)){case pi.ONES_SPRITE:return s%10;case pi.TENS_SPRITE:return s/10%10;case pi.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){if(this.object.model.getValue(I.FURNITURE_VOTE_COUNTER_COUNT)===pi.HIDE_COUNTER_SCORE)switch(this.getLayerTag(t,e,s)){case pi.ONES_SPRITE:case pi.TENS_SPRITE:case pi.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(t,e,s)}};su.ONES_SPRITE="ones_sprite";su.TENS_SPRITE="tens_sprite";su.HUNDREDS_SPRITE="hundreds_sprite";su.HIDE_COUNTER_SCORE=-1;let oet=su;const ho=class xr extends pe{getFrameNumber(t,e){const s=this.object.model.getValue(I.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(t,this.direction,e)){case xr.ONES_SPRITE:return s%10;case xr.TENS_SPRITE:return s/10%10;case xr.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){const i=this.object.model.getValue(I.FURNITURE_VOTE_MAJORITY_RESULT);if(xr.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))!==-1||i===xr.HIDE_RESULTS_VALUE)switch(this.getLayerTag(t,e,s)){case xr.ONES_SPRITE:case xr.TENS_SPRITE:case xr.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(t,e,s)}};ho.ONES_SPRITE="ones_sprite";ho.TENS_SPRITE="tens_sprite";ho.HUNDREDS_SPRITE="hundreds_sprite";ho.HIDE_RESULTS_STATES=[-1,1];ho.HIDE_RESULTS_VALUE=-1;let het=ho;class uet extends pe{}const r0=class i0 extends Jy{getThumbnailURL(){if(!this.object)return null;const t=this.object.model.getValue(I.FURNITURE_DATA);return t&&t[i0.THUMBNAIL_URL]||null}};r0.THUMBNAIL_URL="THUMBNAIL_URL";let _et=r0;/*!
 * @pixi/text - v6.5.10
 * Compiled Thu, 06 Jul 2023 15:25:11 UTC
 *
 * @pixi/text is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var dg=function(r,t){return dg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var i in s)s.hasOwnProperty(i)&&(e[i]=s[i])},dg(r,t)};function cet(r,t){dg(r,t);function e(){this.constructor=r}r.prototype=t===null?Object.create(t):(e.prototype=t.prototype,new e)}var Yl;(function(r){r[r.LINEAR_VERTICAL=0]="LINEAR_VERTICAL",r[r.LINEAR_HORIZONTAL=1]="LINEAR_HORIZONTAL"})(Yl||(Yl={}));var Qc={align:"left",breakWords:!1,dropShadow:!1,dropShadowAlpha:1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"black",dropShadowDistance:5,fill:"black",fillGradientType:Yl.LINEAR_VERTICAL,fillGradientStops:[],fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100,leading:0},det=["serif","sans-serif","monospace","cursive","fantasy","system-ui"],II=function(){function r(t){this.styleID=0,this.reset(),Jc(this,t,t)}return r.prototype.clone=function(){var t={};return Jc(t,this,Qc),new r(t)},r.prototype.reset=function(){Jc(this,Qc,Qc)},Object.defineProperty(r.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"breakWords",{get:function(){return this._breakWords},set:function(t){this._breakWords!==t&&(this._breakWords=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadow",{get:function(){return this._dropShadow},set:function(t){this._dropShadow!==t&&(this._dropShadow=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowAlpha",{get:function(){return this._dropShadowAlpha},set:function(t){this._dropShadowAlpha!==t&&(this._dropShadowAlpha=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowAngle",{get:function(){return this._dropShadowAngle},set:function(t){this._dropShadowAngle!==t&&(this._dropShadowAngle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowBlur",{get:function(){return this._dropShadowBlur},set:function(t){this._dropShadowBlur!==t&&(this._dropShadowBlur=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowColor",{get:function(){return this._dropShadowColor},set:function(t){var e=Zc(t);this._dropShadowColor!==e&&(this._dropShadowColor=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"dropShadowDistance",{get:function(){return this._dropShadowDistance},set:function(t){this._dropShadowDistance!==t&&(this._dropShadowDistance=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fill",{get:function(){return this._fill},set:function(t){var e=Zc(t);this._fill!==e&&(this._fill=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientType",{get:function(){return this._fillGradientType},set:function(t){this._fillGradientType!==t&&(this._fillGradientType=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fillGradientStops",{get:function(){return this._fillGradientStops},set:function(t){fet(this._fillGradientStops,t)||(this._fillGradientStops=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this.fontFamily!==t&&(this._fontFamily=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"letterSpacing",{get:function(){return this._letterSpacing},set:function(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"leading",{get:function(){return this._leading},set:function(t){this._leading!==t&&(this._leading=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"lineJoin",{get:function(){return this._lineJoin},set:function(t){this._lineJoin!==t&&(this._lineJoin=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"miterLimit",{get:function(){return this._miterLimit},set:function(t){this._miterLimit!==t&&(this._miterLimit=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"padding",{get:function(){return this._padding},set:function(t){this._padding!==t&&(this._padding=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"stroke",{get:function(){return this._stroke},set:function(t){var e=Zc(t);this._stroke!==e&&(this._stroke=e,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"strokeThickness",{get:function(){return this._strokeThickness},set:function(t){this._strokeThickness!==t&&(this._strokeThickness=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"textBaseline",{get:function(){return this._textBaseline},set:function(t){this._textBaseline!==t&&(this._textBaseline=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"trim",{get:function(){return this._trim},set:function(t){this._trim!==t&&(this._trim=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"whiteSpace",{get:function(){return this._whiteSpace},set:function(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.styleID++)},enumerable:!1,configurable:!0}),Object.defineProperty(r.prototype,"wordWrapWidth",{get:function(){return this._wordWrapWidth},set:function(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.styleID++)},enumerable:!1,configurable:!0}),r.prototype.toFontString=function(){var t=typeof this.fontSize=="number"?this.fontSize+"px":this.fontSize,e=this.fontFamily;Array.isArray(this.fontFamily)||(e=this.fontFamily.split(","));for(var s=e.length-1;s>=0;s--){var i=e[s].trim();!/([\"\'])[^\'\"]+\1/.test(i)&&det.indexOf(i)<0&&(i='"'+i+'"'),e[s]=i}return this.fontStyle+" "+this.fontVariant+" "+this.fontWeight+" "+t+" "+e.join(",")},r}();function TI(r){return typeof r=="number"?JI(r):(typeof r=="string"&&r.indexOf("0x")===0&&(r=r.replace("0x","#")),r)}function Zc(r){if(Array.isArray(r)){for(var t=0;t<r.length;++t)r[t]=TI(r[t]);return r}else return TI(r)}function fet(r,t){if(!Array.isArray(r)||!Array.isArray(t)||r.length!==t.length)return!1;for(var e=0;e<r.length;++e)if(r[e]!==t[e])return!1;return!0}function Jc(r,t,e){for(var s in e)Array.isArray(t[s])?r[s]=t[s].slice():r[s]=t[s]}var xu={willReadFrequently:!0},Ki=function(){function r(t,e,s,i,n,a,o,h,u){this.text=t,this.style=e,this.width=s,this.height=i,this.lines=n,this.lineWidths=a,this.lineHeight=o,this.maxLineWidth=h,this.fontProperties=u}return r.measureText=function(t,e,s,i){i===void 0&&(i=r._canvas),s=s??e.wordWrap;var n=e.toFontString(),a=r.measureFont(n);a.fontSize===0&&(a.fontSize=e.fontSize,a.ascent=e.fontSize);var o=i.getContext("2d",xu);o.font=n;for(var h=s?r.wordWrap(t,e,i):t,u=h.split(/(?:\r\n|\r|\n)/),c=new Array(u.length),l=0,_=0;_<u.length;_++){var d=o.measureText(u[_]).width+(u[_].length-1)*e.letterSpacing;c[_]=d,l=Math.max(l,d)}var f=l+e.strokeThickness;e.dropShadow&&(f+=e.dropShadowDistance);var m=e.lineHeight||a.fontSize+e.strokeThickness,p=Math.max(m,a.fontSize+e.strokeThickness)+(u.length-1)*(m+e.leading);return e.dropShadow&&(p+=e.dropShadowDistance),new r(t,e,f,p,u,c,m+e.leading,l,a)},r.wordWrap=function(t,e,s){s===void 0&&(s=r._canvas);for(var i=s.getContext("2d",xu),n=0,a="",o="",h=Object.create(null),u=e.letterSpacing,c=e.whiteSpace,l=r.collapseSpaces(c),_=r.collapseNewlines(c),d=!l,f=e.wordWrapWidth+u,m=r.tokenize(t),p=0;p<m.length;p++){var T=m[p];if(r.isNewline(T)){if(!_){o+=r.addLine(a),d=!l,a="",n=0;continue}T=" "}if(l){var v=r.isBreakingSpace(T),O=r.isBreakingSpace(a[a.length-1]);if(v&&O)continue}var A=r.getFromCache(T,u,h,i);if(A>f)if(a!==""&&(o+=r.addLine(a),a="",n=0),r.canBreakWords(T,e.breakWords))for(var y=r.wordWrapSplit(T),M=0;M<y.length;M++){for(var N=y[M],P=1;y[M+P];){var b=y[M+P],D=N[N.length-1];if(!r.canBreakChars(D,b,T,M,e.breakWords))N+=b;else break;P++}M+=N.length-1;var x=r.getFromCache(N,u,h,i);x+n>f&&(o+=r.addLine(a),d=!1,a="",n=0),a+=N,n+=x}else{a.length>0&&(o+=r.addLine(a),a="",n=0);var V=p===m.length-1;o+=r.addLine(T,!V),d=!1,a="",n=0}else A+n>f&&(d=!1,o+=r.addLine(a),a="",n=0),(a.length>0||!r.isBreakingSpace(T)||d)&&(a+=T,n+=A)}return o+=r.addLine(a,!1),o},r.addLine=function(t,e){return e===void 0&&(e=!0),t=r.trimRight(t),t=e?t+`
`:t,t},r.getFromCache=function(t,e,s,i){var n=s[t];if(typeof n!="number"){var a=t.length*e;n=i.measureText(t).width+a,s[t]=n}return n},r.collapseSpaces=function(t){return t==="normal"||t==="pre-line"},r.collapseNewlines=function(t){return t==="normal"},r.trimRight=function(t){if(typeof t!="string")return"";for(var e=t.length-1;e>=0;e--){var s=t[e];if(!r.isBreakingSpace(s))break;t=t.slice(0,-1)}return t},r.isNewline=function(t){return typeof t!="string"?!1:r._newlines.indexOf(t.charCodeAt(0))>=0},r.isBreakingSpace=function(t,e){return typeof t!="string"?!1:r._breakingSpaces.indexOf(t.charCodeAt(0))>=0},r.tokenize=function(t){var e=[],s="";if(typeof t!="string")return e;for(var i=0;i<t.length;i++){var n=t[i],a=t[i+1];if(r.isBreakingSpace(n,a)||r.isNewline(n)){s!==""&&(e.push(s),s=""),e.push(n);continue}s+=n}return s!==""&&e.push(s),e},r.canBreakWords=function(t,e){return e},r.canBreakChars=function(t,e,s,i,n){return!0},r.wordWrapSplit=function(t){return t.split("")},r.measureFont=function(t){if(r._fonts[t])return r._fonts[t];var e={ascent:0,descent:0,fontSize:0},s=r._canvas,i=r._context;i.font=t;var n=r.METRICS_STRING+r.BASELINE_SYMBOL,a=Math.ceil(i.measureText(n).width),o=Math.ceil(i.measureText(r.BASELINE_SYMBOL).width),h=Math.ceil(r.HEIGHT_MULTIPLIER*o);o=o*r.BASELINE_MULTIPLIER|0,s.width=a,s.height=h,i.fillStyle="#f00",i.fillRect(0,0,a,h),i.font=t,i.textBaseline="alphabetic",i.fillStyle="#000",i.fillText(n,0,o);var u=i.getImageData(0,0,a,h).data,c=u.length,l=a*4,_=0,d=0,f=!1;for(_=0;_<o;++_){for(var m=0;m<l;m+=4)if(u[d+m]!==255){f=!0;break}if(!f)d+=l;else break}for(e.ascent=o-_,d=c-l,f=!1,_=h;_>o;--_){for(var m=0;m<l;m+=4)if(u[d+m]!==255){f=!0;break}if(!f)d-=l;else break}return e.descent=_-o,e.fontSize=e.ascent+e.descent,r._fonts[t]=e,e},r.clearMetrics=function(t){t===void 0&&(t=""),t?delete r._fonts[t]:r._fonts={}},Object.defineProperty(r,"_canvas",{get:function(){if(!r.__canvas){var t=void 0;try{var e=new OffscreenCanvas(0,0),s=e.getContext("2d",xu);if(s&&s.measureText)return r.__canvas=e,e;t=Z.ADAPTER.createCanvas()}catch{t=Z.ADAPTER.createCanvas()}t.width=t.height=10,r.__canvas=t}return r.__canvas},enumerable:!1,configurable:!0}),Object.defineProperty(r,"_context",{get:function(){return r.__context||(r.__context=r._canvas.getContext("2d",xu)),r.__context},enumerable:!1,configurable:!0}),r}();Ki._fonts={};Ki.METRICS_STRING="|ÉqÅ";Ki.BASELINE_SYMBOL="M";Ki.BASELINE_MULTIPLIER=1.4;Ki.HEIGHT_MULTIPLIER=2;Ki._newlines=[10,13];Ki._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288];var get={texture:!0,children:!1,baseTexture:!0},Eet=function(r){cet(t,r);function t(e,s,i){var n=this,a=!1;i||(i=Z.ADAPTER.createCanvas(),a=!0),i.width=3,i.height=3;var o=_t.from(i);return o.orig=new it,o.trim=new it,n=r.call(this,o)||this,n._ownCanvas=a,n.canvas=i,n.context=i.getContext("2d",{willReadFrequently:!0}),n._resolution=Z.RESOLUTION,n._autoResolution=!0,n._text=null,n._style=null,n._styleListener=null,n._font="",n.text=e,n.style=s,n.localStyleID=-1,n}return t.prototype.updateText=function(e){var s=this._style;if(this.localStyleID!==s.styleID&&(this.dirty=!0,this.localStyleID=s.styleID),!(!this.dirty&&e)){this._font=this._style.toFontString();var i=this.context,n=Ki.measureText(this._text||" ",this._style,this._style.wordWrap,this.canvas),a=n.width,o=n.height,h=n.lines,u=n.lineHeight,c=n.lineWidths,l=n.maxLineWidth,_=n.fontProperties;this.canvas.width=Math.ceil(Math.ceil(Math.max(1,a)+s.padding*2)*this._resolution),this.canvas.height=Math.ceil(Math.ceil(Math.max(1,o)+s.padding*2)*this._resolution),i.scale(this._resolution,this._resolution),i.clearRect(0,0,this.canvas.width,this.canvas.height),i.font=this._font,i.lineWidth=s.strokeThickness,i.textBaseline=s.textBaseline,i.lineJoin=s.lineJoin,i.miterLimit=s.miterLimit;for(var d,f,m=s.dropShadow?2:1,p=0;p<m;++p){var T=s.dropShadow&&p===0,v=T?Math.ceil(Math.max(1,o)+s.padding*2):0,O=v*this._resolution;if(T){i.fillStyle="black",i.strokeStyle="black";var A=s.dropShadowColor,y=pl(typeof A=="number"?A:uD(A)),M=s.dropShadowBlur*this._resolution,N=s.dropShadowDistance*this._resolution;i.shadowColor="rgba("+y[0]*255+","+y[1]*255+","+y[2]*255+","+s.dropShadowAlpha+")",i.shadowBlur=M,i.shadowOffsetX=Math.cos(s.dropShadowAngle)*N,i.shadowOffsetY=Math.sin(s.dropShadowAngle)*N+O}else i.fillStyle=this._generateFillStyle(s,h,n),i.strokeStyle=s.stroke,i.shadowColor="black",i.shadowBlur=0,i.shadowOffsetX=0,i.shadowOffsetY=0;var P=(u-_.fontSize)/2;(!t.nextLineHeightBehavior||u-_.fontSize<0)&&(P=0);for(var b=0;b<h.length;b++)d=s.strokeThickness/2,f=s.strokeThickness/2+b*u+_.ascent+P,s.align==="right"?d+=l-c[b]:s.align==="center"&&(d+=(l-c[b])/2),s.stroke&&s.strokeThickness&&this.drawLetterSpacing(h[b],d+s.padding,f+s.padding-v,!0),s.fill&&this.drawLetterSpacing(h[b],d+s.padding,f+s.padding-v)}this.updateTexture()}},t.prototype.drawLetterSpacing=function(e,s,i,n){n===void 0&&(n=!1);var a=this._style,o=a.letterSpacing,h=t.experimentalLetterSpacing&&("letterSpacing"in CanvasRenderingContext2D.prototype||"textLetterSpacing"in CanvasRenderingContext2D.prototype);if(o===0||h){h&&(this.context.letterSpacing=o,this.context.textLetterSpacing=o),n?this.context.strokeText(e,s,i):this.context.fillText(e,s,i);return}for(var u=s,c=Array.from?Array.from(e):e.split(""),l=this.context.measureText(e).width,_=0,d=0;d<c.length;++d){var f=c[d];n?this.context.strokeText(f,u,i):this.context.fillText(f,u,i);for(var m="",p=d+1;p<c.length;++p)m+=c[p];_=this.context.measureText(m).width,u+=l-_+o,l=_}},t.prototype.updateTexture=function(){var e=this.canvas;if(this._style.trim){var s=gD(e);s.data&&(e.width=s.width,e.height=s.height,this.context.putImageData(s.data,0,0))}var i=this._texture,n=this._style,a=n.trim?0:n.padding,o=i.baseTexture;i.trim.width=i._frame.width=e.width/this._resolution,i.trim.height=i._frame.height=e.height/this._resolution,i.trim.x=-a,i.trim.y=-a,i.orig.width=i._frame.width-a*2,i.orig.height=i._frame.height-a*2,this._onTextureUpdate(),o.setRealSize(e.width,e.height,this._resolution),i.updateUvs(),this.dirty=!1},t.prototype._render=function(e){this._autoResolution&&this._resolution!==e.resolution&&(this._resolution=e.resolution,this.dirty=!0),this.updateText(!0),r.prototype._render.call(this,e)},t.prototype.updateTransform=function(){this.updateText(!0),r.prototype.updateTransform.call(this)},t.prototype.getBounds=function(e,s){return this.updateText(!0),this._textureID===-1&&(e=!1),r.prototype.getBounds.call(this,e,s)},t.prototype.getLocalBounds=function(e){return this.updateText(!0),r.prototype.getLocalBounds.call(this,e)},t.prototype._calculateBounds=function(){this.calculateVertices(),this._bounds.addQuad(this.vertexData)},t.prototype._generateFillStyle=function(e,s,i){var n=e.fill;if(Array.isArray(n)){if(n.length===1)return n[0]}else return n;var a,o=e.dropShadow?e.dropShadowDistance:0,h=e.padding||0,u=this.canvas.width/this._resolution-o-h*2,c=this.canvas.height/this._resolution-o-h*2,l=n.slice(),_=e.fillGradientStops.slice();if(!_.length)for(var d=l.length+1,f=1;f<d;++f)_.push(f/d);if(l.unshift(n[0]),_.unshift(0),l.push(n[n.length-1]),_.push(1),e.fillGradientType===Yl.LINEAR_VERTICAL){a=this.context.createLinearGradient(u/2,h,u/2,c+h);for(var m=i.fontProperties.fontSize+e.strokeThickness,f=0;f<s.length;f++){var p=i.lineHeight*(f-1)+m,T=i.lineHeight*f,v=T;f>0&&p>T&&(v=(T+p)/2);var O=T+m,A=i.lineHeight*(f+1),y=O;f+1<s.length&&A<O&&(y=(O+A)/2);for(var M=(y-v)/c,N=0;N<l.length;N++){var P=0;typeof _[N]=="number"?P=_[N]:P=N/l.length;var b=Math.min(1,Math.max(0,v/c+P*M));b=Number(b.toFixed(5)),a.addColorStop(b,l[N])}}}else{a=this.context.createLinearGradient(h,c/2,u+h,c/2);for(var D=l.length+1,x=1,f=0;f<l.length;f++){var V=void 0;typeof _[f]=="number"?V=_[f]:V=x/D,a.addColorStop(V,l[f]),x++}}return a},t.prototype.destroy=function(e){typeof e=="boolean"&&(e={children:e}),e=Object.assign({},get,e),r.prototype.destroy.call(this,e),this._ownCanvas&&(this.canvas.height=this.canvas.width=0),this.context=null,this.canvas=null,this._style=null},Object.defineProperty(t.prototype,"width",{get:function(){return this.updateText(!0),Math.abs(this.scale.x)*this._texture.orig.width},set:function(e){this.updateText(!0);var s=Ea(this.scale.x)||1;this.scale.x=s*e/this._texture.orig.width,this._width=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.updateText(!0),Math.abs(this.scale.y)*this._texture.orig.height},set:function(e){this.updateText(!0);var s=Ea(this.scale.y)||1;this.scale.y=s*e/this._texture.orig.height,this._height=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(e){e=e||{},e instanceof II?this._style=e:this._style=new II(e),this.localStyleID=-1,this.dirty=!0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this._text},set:function(e){e=String(e??""),this._text!==e&&(this._text=e,this.dirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resolution",{get:function(){return this._resolution},set:function(e){this._autoResolution=!1,this._resolution!==e&&(this._resolution=e,this.dirty=!0)},enumerable:!1,configurable:!0}),t.nextLineHeightBehavior=!1,t.experimentalLetterSpacing=!1,t}(Kt);class pet{constructor(t){this._sprite=new te(t),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(t){if(!this._sprite||this._amount===t)return null;const e=new zs;e.addChild(this._sprite);const s=new Eet("+"+t,{fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"});return s.anchor.x=.5,s.x=this._sprite.width/2,s.y=19,e.addChild(s),this._texture?Me.instance.renderer.render(e,{renderTexture:this._texture,clear:!0}):this._texture=Qt.generateTexture(e),this._texture}get amount(){return this._amount}set amount(t){this._amount=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}}class n0 extends ME{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(t,e,s){return t>1?new To(e,s):new zl(e,s)}defineVisualizations(t){return this._isAllowedToTurnHead=!0,super.defineVisualizations(t)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"postures":if(!(t instanceof To)||!t.processPostures(s))return!1;break;case"gestures":if(!(t instanceof To)||!t.processGestures(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1;break}return!0}postureToAnimation(t,e){const s=this.getSizeData(t);return s?s.postureToAnimation(e):To.DEFAULT}getGestureDisabled(t,e){const s=this.getSizeData(t);return s?s.getGestureDisabled(e):!1}gestureToAnimation(t,e){const s=this.getSizeData(t);return s?s.gestureToAnimation(e):To.DEFAULT}animationToPosture(t,e,s){const i=this.getSizeData(t);return i?i.animationToPosture(e,s):null}animationToGesture(t,e){const s=this.getSizeData(t);return s?s.animationToGesture(e):null}getGestureForAnimationId(t,e){const s=this.getSizeData(t);return s?s.getGestureForAnimationId(e):null}totalPostures(t){const e=this.getSizeData(t);return e?e.totalPostures:0}totalGestures(t){const e=this.getSizeData(t);return e?e.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}const Zs=class Be extends pe{constructor(){for(super(),this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<Be.ANIMATION_INDEX_COUNT;)this._animationStates.push(new zy)}initialize(t){if(!(t instanceof n0))return!1;const e=this.getPetAdditionAsset(Be.PET_EXPERIENCE_BUBBLE);return e&&(this._experienceData=new pet(e)),super.initialize(t)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const t=this._animationStates[0];t&&t.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(t){return t.animationId}update(t,e,s,i){super.update(t,e,s,i),this.updateExperienceBubble(e)}updateExperienceBubble(t){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const e=t-this._experienceTimestamp;e<Be.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=Math.sin(e/Be.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI)*255:this._experienceTimestamp=0;const s=this.getSprite(this.totalSprites-1);if(s){if(this._experienceData.alpha>0){const i=this._experienceData.renderBubble(this._experience);if(i){s.texture=i,s.offsetX=-20,s.offsetY=-80,s.alpha=this._experienceData.alpha,s.visible=!0,s.relativeDepth=-.2;return}}s.texture=null,s.visible=!1}}}updateModel(t){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;const s=e.getValue(I.FIGURE_POSTURE),i=e.getValue(I.FIGURE_GESTURE);this.setPostureAndGesture(s,i);let n=e.getValue(I.FURNITURE_ALPHA_MULTIPLIER)||null;(n===null||isNaN(n))&&(n=1),this._alphaMultiplier!==n&&(this._alphaMultiplier=n,this._alphaChanged=!0),this._isSleeping=e.getValue(I.FIGURE_SLEEP)>0;const a=e.getValue(I.HEAD_DIRECTION);!isNaN(a)&&this.data.isAllowedToTurnHead?this._headDirection=a:this._headDirection=this.object.getDirection().x,this._experience=e.getValue(I.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=e.getValue(I.FIGURE_EXPERIENCE_TIMESTAMP);const o=e.getValue(I.PET_PALETTE_INDEX),h=e.getValue(I.PET_CUSTOM_LAYER_IDS),u=e.getValue(I.PET_CUSTOM_PARTS_IDS),c=e.getValue(I.PET_CUSTOM_PALETTE_IDS),l=e.getValue(I.PET_IS_RIDING),_=e.getValue(I.PET_HEAD_ONLY),d=e.getValue(I.PET_COLOR);return o!==this._paletteIndex&&(this._paletteIndex=o,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=h||[],this._customPartIds=u||[],this._customPaletteIds=c||[],this._isRiding=!isNaN(l)&&l>0,this._headOnly=!isNaN(_)&&_>0,!isNaN(d)&&this._color!==d&&(this._color=d),this.updateModelCounter=e.updateCounter,!0}updateAnimation(t){if(this.object){const e=this.object.getDirection().x;e!==this._previousAnimationDirection&&(this._previousAnimationDirection=e,this.resetAllAnimationFrames())}return super.updateAnimation(t)}setPostureAndGesture(t,e){this.data&&(t!==this._posture&&(this._posture=t,this.setAnimationForIndex(Be.POSTURE_ANIMATION_INDEX,this.data.postureToAnimation(this._scale,t))),this.data.getGestureDisabled(this._scale,t)&&(e=null),e!==this._gesture&&(this._gesture=e,this.setAnimationForIndex(Be.GESTURE_ANIMATION_INDEX,this.data.gestureToAnimation(this._scale,e))))}getAnimationStateData(t){return t>=0&&t<this._animationStates.length?this._animationStates[t]:null}setAnimationForIndex(t,e){const s=this.getAnimationStateData(t);s&&this.setSubAnimation(s,e)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let t=this._animationStates.length-1;for(;t>=0;){const e=this._animationStates[t];e&&e.setLayerCount(this.animatedLayerCount),t--}}updateAnimations(t){if(this._animationOver)return 0;let e=!0,s=0,i=0;for(;i<this._animationStates.length;){const n=this._animationStates[i];if(n&&!n.animationOver){const a=this.updateFramesForAnimation(n,t);s=s|a,n.animationOver?(Le.isTransitionFromAnimation(n.animationId)||Le.isTransitionToAnimation(n.animationId))&&(this.setAnimationForIndex(i,n.animationAfterTransitionId),e=!1):e=!1}i++}return this._animationOver=e,s}getSpriteAssetName(t,e){if(this._headOnly&&this.isNonHeadSprite(e)||this._isRiding&&this._parser3(e))return null;const s=this.totalSprites;if(e<s-Be.ADDITIONAL_SPRITE_COUNT){const i=this.getValidSize(t);if(e<s-(1+Be.ADDITIONAL_SPRITE_COUNT)){if(e>=ni.LAYER_LETTERS.length)return null;const n=ni.LAYER_LETTERS[e];return i===1?this._type+"_icon_"+n:this._type+"_"+i+"_"+n+"_"+this.getDirection(t,e)+"_"+this.getFrameNumber(i,e)}return this._type+"_"+i+"_sd_"+this.getDirection(t,e)+"_0"}return null}getLayerColor(t,e,s){return e<this.totalSprites-Be.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s),n=this._animationStates.length-1;for(;n>=0;){const a=this._animationStates[n];if(a){const o=a.getFrame(s);o&&(i+=o.x)}n--}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s),n=this._animationStates.length-1;for(;n>=0;){const a=this._animationStates[n];if(a){const o=a.getFrame(s);o&&(i+=o.y)}n--}return i}getLayerZOffset(t,e,s){return this.data?this.data.getLayerZOffset(t,this.getDirection(t,s),s):Bt.DEFAULT_ZOFFSET}getDirection(t,e){return this.isHeadSprite(e)?this.data.getValidDirection(t,this._headDirection):this._direction}getFrameNumber(t,e){let s=this._animationStates.length-1;for(;s>=0;){const i=this._animationStates[s];if(i){const n=i.getFrame(e);if(n)return n.id}s--}return super.getFrameNumber(t,e)}isHeadSprite(t){if(this._headSprites[t]===void 0){const e=this.data.getLayerTag(this._scale,Rn.USE_DEFAULT_DIRECTION,t)===Be.HEAD,s=this.data.getLayerTag(this._scale,Rn.USE_DEFAULT_DIRECTION,t)===Be.HAIR;e||s?this._headSprites[t]=!0:this._headSprites[t]=!1}return this._headSprites[t]}isNonHeadSprite(t){if(this._nonHeadSprites[t]===void 0)if(t<this.totalSprites-(1+Be.ADDITIONAL_SPRITE_COUNT)){const e=this.data.getLayerTag(this._scale,Rn.USE_DEFAULT_DIRECTION,t);e&&e.length>0&&e!==Be.HEAD&&e!==Be.HAIR?this._nonHeadSprites[t]=!0:this._nonHeadSprites[t]=!1}else this._nonHeadSprites[t]=!0;return this._nonHeadSprites[t]}_parser3(t){return this._saddleSprites[t]===void 0&&(this.data.getLayerTag(this._scale,Rn.USE_DEFAULT_DIRECTION,t)===Be.SADDLE?this._saddleSprites[t]=!0:this._saddleSprites[t]=!1),this._saddleSprites[t]}getAsset(t,e=-1){if(!this.asset)return null;const s=this._customLayerIds.indexOf(e);let i=this._paletteName,n=-1,a=-1;return s>-1&&(n=this._customPartIds[s],a=this._customPaletteIds[s],i=a>-1?a.toString():this._paletteName),!isNaN(n)&&n>-1&&(t=t+"_"+n),this.asset.getAssetWithPalette(t,i)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+Be.ADDITIONAL_SPRITE_COUNT}setLayerCount(t){super.setLayerCount(t),this._headSprites=[]}getPostureForAsset(t,e){const s=e.split("_");let i=s.length,n=0;for(;n<s.length;){if(s[n]==="64"||s[n]==="32"){i=n+3;break}n++}let a=null;if(i<s.length){let o=s[i];o=o.split("@")[0],a=this.data.animationToPosture(t,parseInt(o)/100,!1),a||(a=this.data.getGestureForAnimationId(t,parseInt(o)/100))}return a}getPetAdditionAsset(t){return Cs().getTexture(t)}get data(){return this._data}};Zs.TYPE=F.PET_ANIMATED;Zs.HEAD="head";Zs.SADDLE="saddle";Zs.HAIR="hair";Zs.ADDITIONAL_SPRITE_COUNT=1;Zs.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3;Zs.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble";Zs.POSTURE_ANIMATION_INDEX=0;Zs.GESTURE_ANIMATION_INDEX=1;Zs.ANIMATION_INDEX_COUNT=2;let met=Zs;class PE{constructor(t,e=-1,s=1,i=-1,n=1){this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=n,this._asset=t}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}}PE.MIN_NORMAL_COORDINATE_VALUE=-1;PE.MAX_NORMAL_COORDINATE_VALUE=1;class On{constructor(){this._bitmaps=[]}dispose(){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}addBitmap(t,e=-1,s=1,i=-1,n=1){this._bitmaps.push(new PE(t,e,s,i,n))}getAsset(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e.asset;return null}}On.MIN_NORMAL_COORDINATE_VALUE=-1;On.MAX_NORMAL_COORDINATE_VALUE=1;class Iet{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const t of this._maskVisualizations.values())t&&t.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(t){if(this._maskVisualizations.get(t))return null;const s=new On;return this._maskVisualizations.set(t,s),this._sizes.push(t),this._sizes.sort(),s}getSizeIndex(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getMaskVisualization(t){if(t===this._lastSize)return this._lastMaskVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[e]):this._lastMaskVisualization=null,this._lastSize=t,this._lastMaskVisualization}getGraphicAsset(t,e){const s=this.getMaskVisualization(t);return s?s.getAsset(e):null}getAssetName(t){return this._assetNames&&this._assetNames.get(t)||null}setAssetName(t,e){this._assetNames&&this._assetNames.set(t,e)}}class Tet{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}}initialize(t){this._data=t}initializeAssetCollection(t){this.data&&(this._assetCollection=t,this.parseMasks(this.data,t))}parseMasks(t,e){if(!(!t||!e)&&t.masks&&t.masks.length){let s=0;for(;s<t.masks.length;){const i=t.masks[s];if(i){const n=i.id;if(this._masks.get(n))continue;const o=new Iet;if(i.visualizations&&i.visualizations.length){let h=0;for(;h<i.visualizations.length;){const u=i.visualizations[h];if(u){const c=u.size,l=o.createMaskVisualization(c);if(l){const _=this.parseMaskBitmaps(u.bitmaps,l,e);o.setAssetName(c,_)}}h++}}this._masks.set(n,o)}s++}}}parseMaskBitmaps(t,e,s){if(!t||!t.length)return null;let i=null;for(const n of t){if(!n)continue;const a=n.assetName,o=s.getAsset(a);if(!o)continue;let h=On.MIN_NORMAL_COORDINATE_VALUE,u=On.MAX_NORMAL_COORDINATE_VALUE,c=On.MIN_NORMAL_COORDINATE_VALUE,l=On.MAX_NORMAL_COORDINATE_VALUE;n.normalMinX!==void 0&&(h=n.normalMinX),n.normalMaxX!==void 0&&(u=n.normalMaxX),n.normalMinY!==void 0&&(c=n.normalMinY),n.normalMaxY!==void 0&&(l=n.normalMaxY),o.flipH||(i=a),e.addBitmap(o,h,u,c,l)}return i}updateMask(t,e,s,i,n,a){const o=this._masks.get(e);if(!o)return!0;const h=o.getGraphicAsset(s,i);if(!h)return!0;const u=h.texture;if(!u)return!0;const c=new B(n+h.offsetX,a+h.offsetY),l=new Vt;let _=1,d=1,f=0,m=0,p=c.x+f,T=c.y+m;return h.flipH&&(_=-1,f=u.width,p=c.x+f-u.width),h.flipV&&(d=-1,m=u.height,T=c.y+m-u.height),l.scale(_,d),l.translate(p,T),Me.instance.renderer.render(new Kt(u),{renderTexture:t,clear:!1,transform:l}),!0}getMask(t){return!this._masks||!this._masks.size?null:this._masks.get(t)||null}}class wo{constructor(t=null,e=0,s=!1){this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],t!=null&&(this._maskAssetNames=t._maskAssetNames,this._maskAssetLocations=t._maskAssetLocations,this._maskAssetFlipHs=t._maskAssetFlipHs,this._maskAssetFlipVs=t._maskAssetFlipVs),this._color=e,this._alignBottom=s}addMask(t,e,s,i){this._maskAssetNames.push(t),this._maskAssetLocations.push(e),this._maskAssetFlipHs.push(s),this._maskAssetFlipVs.push(i)}addAssetColumn(t){this._assetNames.push(t)}set z(t){this._z=t}get z(){return this._z}set cornerPoints(t){this._points=t}get cornerPoints(){return this._points}get color(){return this._color}get maskAssetNames(){return this._maskAssetNames}get maskAssetLocations(){return this._maskAssetLocations}get maskAssetFlipHs(){return this._maskAssetFlipHs}get maskAssetFlipVs(){return this._maskAssetFlipVs}isBottomAligned(){return this._alignBottom}get assetNameColumns(){return this._assetNames}}class Ret{constructor(t,e,s,i,n){this._x=t,this._y=e,this._speedX=s,this._speedY=i,this._asset=n,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._asset}dispose(){this._asset=null}getPosition(t,e,s,i,n){let a=this._x,o=this._y;s>0&&(a=a+this._speedX/s*n/1e3),i>0&&(o=o+this._speedY/i*n/1e3);const h=Math.trunc(a%1*t),u=Math.trunc(o%1*e);return new B(h,u)}}const ja=class a0{constructor(t,e,s,i=0){this._material=t,this._offset=i,this._align=s,this._color=e,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this.clearCache()}clearCache(){}render(t,e,s,i,n,a,o,h,u){const c=this._color>>16,l=this._color>>8&255,_=this._color&255,d=c<255||l<255||_<255;if(this._material){const f=this._material.render(t,e,d?null:s,i,n,a,o,h,u+this.offset,this.align===a0.ALIGN_TOP);if(f&&d){const m=new Kt(f);d&&(m.tint=this._color),e.writeToRenderTexture(m,s,!1)}}else{const f=e.createAndFillRenderTexture(i,n,t,this._color);e.writeToRenderTexture(new Kt(f),s,!1)}return s}getMaterial(){return this._material}getColor(){return this._color}};ja.DEFAULT_OFFSET=0;ja.ALIGN_TOP=1;ja.ALIGN_BOTTOM=2;ja.ALIGN_DEFAULT=ja.ALIGN_TOP;let fr=ja;class Oet{constructor(t,e,s){this._layers=[],this._geometry=s,this._cachedBitmapNormal=new S,this._isCached=!1,this._hasAnimationLayers=!1,e<0&&(e=0);let i=0;for(;i<e;)this._layers.push(null),i++}get geometry(){return this._geometry}get hasAnimationLayers(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const t of this._layers)t&&t.dispose();this._layers=null}this._geometry=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new S),this._layers&&this._layers.length)for(const t of this._layers){if(!t)continue;t.clearCache()}this._isCached=!1}}setLayer(t,e,s,i,n=0){if(t<0||t>this._layers.length)return!1;let a=this._layers[t];return a&&a.dispose(),a=new fr(e,s,i,n),this._layers[t]=a,!0}setAnimationLayer(t,e,s){if(t<0||t>this._layers.length)return!1;let i=this._layers[t];return i&&i.dispose(),i=new RI(e,s),this._layers[t]=i,this._hasAnimationLayers=!0,!0}getLayers(){return this._layers}render(t,e,s,i,n,a,o,h=0,u=0,c=0,l=0,_=0,d=0,f=0){i<1&&(i=1),n<1&&(n=1),(!s||s.width!==i||s.height!==n)&&(s=null),this._isCached=!0;const m=e.createAndFillRenderTexture(i,n,t);if(this._cachedBitmapNormal.assign(a),this._layers&&this._layers.length)for(const p of this._layers)p&&(p instanceof fr?p.render(`${t}:${this._layers.indexOf(p)}`,e,m,i,n,a,o,h,u):p instanceof RI&&p.render(e,m,i,n,a,h,u,c,l,_,d,f));return m}}class DE{constructor(){this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(t){return!0}dispose(){for(const t of this._planeVisualizations.values())t&&t.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}clearCache(){for(const t of this._planeVisualizations.values())t&&t.clearCache()}createPlaneVisualization(t,e,s){if(this._planeVisualizations.get(t.toString()))return null;const n=new Oet(t,e,s);return this._planeVisualizations.set(t.toString(),n),this._sizes.push(t),this._sizes.sort(),n}getSizeIndex(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getPlaneVisualization(t){if(t===this._lastSize)return this._lastPlaneVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastPlaneVisualization=this._planeVisualizations.get(this._sizes[e].toString()):this._lastPlaneVisualization=null,this._lastSize=t,this._lastPlaneVisualization}getLayers(){return this.getPlaneVisualization(this._lastSize).getLayers()}}class bn extends DE{render(t,e,s,i,n,a,o,h,u,c){const l=this.getPlaneVisualization(a);if(!l||!l.geometry)return null;const _=l.geometry.getScreenPoint(new S(0,0,0)),d=l.geometry.getScreenPoint(new S(0,n/l.geometry.scale,0)),f=l.geometry.getScreenPoint(new S(i/l.geometry.scale,0,0));let m=0,p=0;if(_&&d&&f){i=Math.round(Math.abs(_.x-f.x)),n=Math.round(Math.abs(_.x-d.x));const T=_.x-l.geometry.getScreenPoint(new S(1,0,0)).x;m=u*Math.trunc(Math.abs(T)),p=c*Math.trunc(Math.abs(T))}return l.render(t,e,s,i,n,o,h,m,p)}}bn.DEFAULT_COLOR=16777215;bn.HORIZONTAL_ANGLE_DEFAULT=45;bn.VERTICAL_ANGLE_DEFAULT=30;class Wl{constructor(t,e){this._texture=t,this._timeStamp=e}dispose(){this._texture=null}get texture(){return this._texture}get timeStamp(){return this._timeStamp}}const j_=class He{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(t=1){He._randomizer||(He._randomizer=new He),He._randomizer.seed=t}static setModulus(t=16777216){He._randomizer||(He._randomizer=new He),He._randomizer.modulus=t}static getValues(t,e,s){return He._randomizer||(He._randomizer=new He),He._randomizer.getRandomValues(t,e,s)}static getArray(t,e){return He._randomizer||(He._randomizer=new He),He._randomizer.getRandomArray(t,e)}set seed(t){this._seed=t}set modulus(t){t<1&&(t=1),this._modulus=t}dispose(){}getRandomValues(t,e,s){const i=[];let n=0;for(;n<t;)i.push(this.iterateScaled(e,s-e)),n++;return i}getRandomArray(t,e){if(t>e||e>1e3)return null;const s=[];let i=0;for(;i<=e;)s.push(i),i++;const n=[];let a=0;for(;a<t;){const o=this.iterateScaled(0,s.length-1);n.push(s[o]),s.splice(o,1),a++}return n}iterate(){let t=R0(Math.trunc(this._multiplier*this._seed)+this._increment);return t<0&&(t=-t),t=t%this._modulus,this._seed=t,t}iterateScaled(t,e){let s=this.iterate();return e<1?t:(s=Math.trunc(t+s/this._modulus*e),s)}};j_.DEFAULT_SEED=1;j_.DEFAULT_MODULUS=16777216;j_._randomizer=null;let za=j_;const qn=class mi{constructor(t,e,s=1){if(this._cells=[],this._repeatMode=s,this._width=t<1?1:t,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,e&&e.length){let i=0;for(;i<e.length;){const n=e[i];n&&(this._cells.push(n),n.isStatic||(this._isStatic=!1)),i++}}}get isStatic(){return this._isStatic}isRepeated(){return this._repeatMode!==mi.REPEAT_MODE_NONE}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const t of this._cells)t&&t.dispose();this._cells=null}this._cachedBitmapData=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const t of this._cells)t&&t.clearCache();this._isCached=!1}}render(t,e,s,i,n,a){if(this._repeatMode===mi.REPEAT_MODE_NONE&&(s=this.getCellsHeight(this._cells,i)),this._cachedBitmapNormal||(this._cachedBitmapNormal=new S),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===s&&S.isEqual(this._cachedBitmapNormal,i)&&this._cachedBitmapDataOffsetX===n&&this._cachedBitmapDataOffsetY===a)return this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=e.createRenderTexture(this._width,s,`${t}:column`)),this._cachedBitmapNormal.assign(i),this._cachedBitmapDataOffsetX=n,this._cachedBitmapDataOffsetY=a,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case mi.REPEAT_MODE_NONE:this.renderRepeatNone(i);break;case mi.REPEAT_MODE_BORDERS:this.renderRepeatBorders(i);break;case mi.REPEAT_MODE_CENTER:this.renderRepeatCenter(i);break;case mi.REPEAT_MODE_FIRST:this.renderRepeatFirst(i);break;case mi.REPEAT_MODE_LAST:this.renderRepeatLast(i);break;default:this.renderRepeatAll(i,n,a);break}return this._cachedBitmapData}getCellsHeight(t,e){if(!t||!t.length)return 0;let s=0,i=0;for(;i<t.length;){const n=t[i];n&&(s+=n.getHeight(e)),i++}return s}renderCells(t,e,s,i,n=0,a=0){if(!t||!t.length||!this._cachedBitmapData)return e;let o=0;for(;o<t.length;){let h=null;if(s?h=t[o]:h=t[t.length-1-o],h){const u=h.render(i,n,a);if(u&&(s||(e-=u.height),u.y=e,Qt.writeToRenderTexture(u,this._cachedBitmapData,!1),s&&(e=e+u.height),s&&e>=this._cachedBitmapData.height||!s&&e<=0))return e}o++}return e}renderRepeatNone(t){!this._cells.length||!this._cachedBitmapData||this.renderCells(this._cells,0,!0,t)}renderRepeatAll(t,e,s){if(!this._cells.length||!this._cachedBitmapData)return;let i=0;for(;i<this._cachedBitmapData.height;)if(i=this.renderCells(this._cells,i,!0,t,e,s),!i)return}renderRepeatBorders(t){if(!this._cells.length||!this._cachedBitmapData)return;const e=[];let s=0,i=1;for(;i<this._cells.length-1;){const h=this._cells[i];if(h){const u=h.getHeight(t);u>0&&(s=s+u,e.push(h))}i++}if(this._cells.length==1){const h=this._cells[0];if(h){const u=h.getHeight(t);u>0&&(s=s+u,e.push(h))}}let n=this._cachedBitmapData.height-s>>1,a=this.renderCells(e,n,!0,t),o=this._cells[0];if(o){const h=[o];for(;n>=0;)n=this.renderCells(h,n,!1,t)}if(o=this._cells[this._cells.length-1],o){const h=[o];for(;a<this._cachedBitmapData.height;)a=this.renderCells(h,a,!0,t)}}renderRepeatCenter(t){if(!this._cells.length||!this._cachedBitmapData)return;const e=[],s=[];let i=0,n=0,a=0;for(;a<this._cells.length>>1;){const u=this._cells[a];if(u){const c=u.getHeight(t);c>0&&(i=i+c,e.push(u))}a++}for(a=(this._cells.length>>1)+1;a<this._cells.length;){const u=this._cells[a];if(u){const c=u.getHeight(t);c>0&&(n=n+c,s.push(u))}a++}let o=0,h=this._cachedBitmapData.height;if(i+n>this._cachedBitmapData.height&&(o=i+n-this._cachedBitmapData.height,h=h+(o-(o>>1))),o==0){const u=this._cells[this._cells.length>>1];if(u){const c=u.getHeight(t);if(c>0){const l=this._cachedBitmapData.height-(i+n),_=Math.ceil(l/c)*c;let d=i-(_-l>>1);const f=d+_,m=[u];for(;d<f;)d=this.renderCells(m,d,!0,t)}}}this.renderCells(e,0,!0,t),this.renderCells(s,h,!1,t)}renderRepeatFirst(t){if(!this._cells.length||!this._cachedBitmapData)return;let e=this.renderCells(this._cells,this._cachedBitmapData.height,!1,t);const s=this._cells[0];if(!s)return;const i=[s];for(;e>=0;)e=this.renderCells(i,e,!1,t)}renderRepeatLast(t){if(!this._cells.length||!this._cachedBitmapData)return;let e=this.renderCells(this._cells,0,!0,t);const s=this._cells[this._cells.length-1];if(!s)return;const i=[s];for(;e<this._cachedBitmapData.height;)e=this.renderCells(i,e,!0,t)}getCells(){return this._cells}};qn.REPEAT_MODE_NONE=0;qn.REPEAT_MODE_ALL=1;qn.REPEAT_MODE_BORDERS=2;qn.REPEAT_MODE_CENTER=3;qn.REPEAT_MODE_FIRST=4;qn.REPEAT_MODE_LAST=5;let Ii=qn;const hs=class Es{constructor(t,e=1,s=1,i=-1,n=1,a=-1,o=1){this._repeatMode=1,this._align=1,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],t<1&&(t=1);let h=0;for(;h<t;)this._columns.push(null),h++;this._repeatMode=e,this._align=s,this._normalMinX=i,this._normalMaxX=n,this._normalMinY=a,this._normalMaxY=o,this._repeatMode===Es.REPEAT_MODE_RANDOM&&(this._isStatic=!1)}static nextRandomColumnIndex(t){return za.getValues(1,0,t*17631)[0]%t}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}isBottomAligned(){return this._align===Es.ALIGN_BOTTOM}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const t of this._columns)t&&t.clearCache();this._isCached=!1}}createColumn(t,e,s,i=1){if(t<0||t>=this._columns.length)return!1;const n=new Ii(e,s,i),a=this._columns[t];return a&&a.dispose(),this._columns[t]=n,n&&!n.isStatic&&(this._isStatic=!1),!0}render(t,e,s,i,n,a,o,h,u,c){if(i<1&&(i=1),n<1&&(n=1),this._cachedBitmapNormal||(this._cachedBitmapNormal=new S),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.baseTexture&&this._cachedBitmapData.width===i&&this._cachedBitmapData.height===n&&S.isEqual(this._cachedBitmapNormal,a))return s?(this.copyCachedBitmapOnCanvas(s,this._cachedBitmapHeight,u,c),s):this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapNormal.assign(a),!o)return this._cachedBitmapHeight=n,this._cachedBitmapData?e.clearAndFillRenderTexture(this._cachedBitmapData):this._cachedBitmapData=e.createAndFillRenderTexture(i,n,`${t}:matrix`),this._cachedBitmapData;this._cachedBitmapData||(this._cachedBitmapHeight=n,this._cachedBitmapData=e.createRenderTexture(i,n,`${t}:matrix`),e.clearRenderTexture(this._cachedBitmapData));const l=[];let _=0;for(;_<this._columns.length;){const f=this._columns[_];if(f){const m=f.render(t,e,n,a,h,u);m&&l.push(m)}_++}if(!l.length)return s||this._cachedBitmapData;let d=0;switch(this._repeatMode){case Es.REPEAT_MODE_BORDERS:Y.log("REPEAT_MODE_BORDERS");break;case Es.REPEAT_MODE_CENTER:Y.log("REPEAT_MODE_CENTER");break;case Es.REPEAT_MODE_FIRST:Y.log("REPEAT_MODE_FIRST");break;case Es.REPEAT_MODE_LAST:Y.log("REPEAT_MODE_LAST");break;case Es.REPEAT_MODE_RANDOM:d=this.renderRepeatRandom(this._cachedBitmapData,l);break;default:d=this.renderRepeatAll(this._cachedBitmapData,l);break}return this._cachedBitmapHeight=d,s?(this.copyCachedBitmapOnCanvas(s,d,u,c),s):this._cachedBitmapData}copyCachedBitmapOnCanvas(t,e,s,i){if(!t||!this._cachedBitmapData||t===this._cachedBitmapData)return;i||(s=t.height-e-s);let n=null;this._align===Es.ALIGN_TOP?n=new it(0,0,this._cachedBitmapData.width,this._cachedBitmapHeight):n=new it(0,this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const a=new we(this._cachedBitmapData.baseTexture,n),o=new Kt(a);o.position.set(0,s),Qt.writeToRenderTexture(o,t,!1)}getColumnsWidth(t){if(!t||!t.length)return 0;let e=0;for(const s of t)s&&(e+=s.width);return e}renderColumns(t,e,s,i){if(!t||!e||!e.length)return new B(s,0);let n=0,a=0;for(;a<e.length;){const o=i?e[a]:e[e.length-1-a];if(o){i||(s=s-o.width);let h=0;this._align==Es.ALIGN_BOTTOM&&(h=t.height-o.height);const u=new Kt(o);if(u.position.set(s,h),Qt.writeToRenderTexture(u,t,!1),o.height>n&&(n=o.height),i&&(s=s+o.width),i&&s>=t.width||!i&&s<=0)return new B(s,n)}a++}return new B(s,n)}renderRepeatAll(t,e){if(!t||!e||!e.length)return 0;this.getColumnsWidth(e);let s=0,i=0;for(;s<t.width;){const n=this.renderColumns(t,e,s,!0);if(s=n.x,n.y>i&&(i=n.y),!n.x)return i}return i}renderRepeatRandom(t,e){if(!t||!e||!e.length)return 0;let s=0,i=0;for(;i<t.width;){const n=e[Es.nextRandomColumnIndex(e.length)];if(n!=null){const a=this.renderColumns(t,[n],i,!0);i=a.x,a.y>s&&(s=a.y)}else return s}return s}getColumns(t){if(this._repeatMode===Es.REPEAT_MODE_RANDOM){const e=[];let s=0;for(;s<t;){const i=this._columns[Es.nextRandomColumnIndex(this._columns.length)];if(i)if(e.push(i),i.width>1)s+=i.width;else break;else break}return e}return this._columns}};hs.REPEAT_MODE_ALL=1;hs.REPEAT_MODE_BORDERS=2;hs.REPEAT_MODE_CENTER=3;hs.REPEAT_MODE_FIRST=4;hs.REPEAT_MODE_LAST=5;hs.REPEAT_MODE_RANDOM=6;hs.REPEAT_MODE_DEFAULT=hs.REPEAT_MODE_ALL;hs.MIN_NORMAL_COORDINATE_VALUE=-1;hs.MAX_NORMAL_COORDINATE_VALUE=1;hs.ALIGN_TOP=1;hs.ALIGN_BOTTOM=2;hs.ALIGN_DEFAULT=hs.ALIGN_TOP;let Ke=hs;class LE{constructor(){this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)t&&t.dispose();this._planeMaterialItems=null}this._isCached=!1}clearCache(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const t of this._planeMaterialItems)t&&t.clearCache();this._isCached=!1}}addMaterialCellMatrix(t,e,s,i=-1,n=1,a=-1,o=1){const h=new Ke(t,e,s,i,n,a,o);return this._planeMaterialItems.push(h),h}getMaterialCellMatrix(t){if(!t)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const e of this._planeMaterialItems)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e}return null}render(t,e,s,i,n,a,o,h,u,c){i<1&&(i=1),n<1&&(n=1);const l=this.getMaterialCellMatrix(a);return l?(this._isCached=!0,l.render(t,e,s,i,n,a,o,h,u,c)):null}}LE.MIN_NORMAL_COORDINATE_VALUE=-1;LE.MAX_NORMAL_COORDINATE_VALUE=1;class vet{constructor(t,e=null,s=null,i=0){if(this._extraItemCount=0,this._texture=t,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,e&&e.length&&i>0){let n=0;for(;n<e.length;){const a=e[n];a&&this._extraItemAssets.push(a),n++}if(this._extraItemAssets.length){if(s){let a=0;for(;a<s.length;){const o=s[a];o&&this._extraItemOffsets.push(new B(o.x,o.y)),a++}}this._extraItemCount=i}}}get isStatic(){return this._extraItemCount===0}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}clearCache(){}getHeight(t){if(this._texture){const e=this._texture.getBitmap(t);if(e)return e.height}return 0}render(t,e,s){if(!this._texture)return null;const i=this._texture.getBitmap(t);if(!i)return null;const n=new BJ(i,i.width,i.height);if(e!==0||s!==0){for(;e<0;)e+=i.width;for(;s<0;)s+=i.height;n.tilePosition.set(e%i.width,s%i.height),n.uvRespectAnchor=!0,e&&(n.anchor.x=1,n.scale.x=-1),s&&(n.anchor.y=1,n.scale.y=-1)}if(!this.isStatic){const a=Math.min(this._extraItemCount,this._extraItemOffsets.length),o=Math.max(this._extraItemCount,this._extraItemOffsets.length),h=za.getArray(this._extraItemCount,o);let u=0;for(;u<a;){const c=this._extraItemOffsets[h[u]],l=this._extraItemAssets[u%this._extraItemAssets.length];if(c&&l){const _=l.texture;if(_){let d=l.offsetX,f=l.offsetY,m=1,p=1,T=0,v=0;l.flipH&&(m=-1,T=_.width,d=-(l.width+l.x)),l.flipV&&(p=-1,v=_.height,f=-(l.height+l.y));const O=new B(c.x+d,c.y+f),A=new Vt;let y=O.x+T;y=y>>1<<1,A.scale(m,p),A.translate(y,O.y+v);const M=new Kt(_);M.transform.setFromMatrix(A),n.addChild(M)}}u++}}return n}getAssetName(t){return this._texture==null?null:this._texture.getAssetName(t)}}class UE{constructor(t,e=-1,s=1,i=-1,n=1,a=null){this._bitmap=t,this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=n,this._assetName=a}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}}UE.MIN_NORMAL_COORDINATE_VALUE=-1;UE.MAX_NORMAL_COORDINATE_VALUE=1;class gn{constructor(){this._bitmaps=[]}dispose(){if(this._bitmaps){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}}addBitmap(t,e=-1,s=1,i=-1,n=1,a=null){this._bitmaps.push(new UE(t,e,s,i,n,a))}getBitmap(t){const e=this.getPlaneTextureBitmap(t);return e?e.bitmap:null}getPlaneTextureBitmap(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e;return null}getAssetName(t){const e=this.getPlaneTextureBitmap(t);return e?e.assetName:null}}gn.MIN_NORMAL_COORDINATE_VALUE=-1;gn.MAX_NORMAL_COORDINATE_VALUE=1;const o0=class h0{constructor(){this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get assetCollection(){return this._assetCollection}initializeDimensions(t,e){return!0}dispose(){if(this._planes){for(const t of this._planes.values())t&&t.dispose();this._planes=null}if(this._materials&&(this.resetMaterials(),this._materials=null),this._textures&&(this.resetTextures(),this._textures=null),this._geometries){for(const t of this._geometries.values())t&&t.dispose();this._geometries=null}this._data=null,this._assetCollection=null}clearCache(){for(const t of this._planes.values())t&&t.clearCache();for(const t of this._materials.values())t&&t.clearCache()}initialize(t){this._data=t}reinitialize(){this.resetTextures(),this.resetMaterials(),this.initializeAll()}resetMaterials(){for(const t of this._materials.values())t&&t.dispose();this._materials.clear()}resetTextures(){for(const t of this._textures.values())t&&t.dispose();this._textures.clear()}getTexture(t){return this._textures.get(t)}getMaterial(t){return this._materials.get(t)}getPlane(t){return this._planes.get(t)}addPlane(t,e){return e?this._planes.get(t)?!1:(this._planes.set(t,e),!0):!1}initializeAssetCollection(t){this._data&&(this._assetCollection=t,this.initializeAll())}initializeAll(){this._data&&(this.initializeTexturesAndMaterials(),this.initializePlanes())}initializeTexturesAndMaterials(){this._data.textures&&this._data.textures.length&&this.parseTextures(this._data.textures,this.assetCollection),this._data.materials&&this._data.materials.length&&this.parsePlaneMaterials(this._data.materials)}initializePlanes(){}parseTextures(t,e){if(!(!t||!e)&&t.length)for(const s of t){if(!s)continue;const i=s.id;if(!this._textures.get(i)){const n=new gn;if(s.bitmaps&&s.bitmaps.length)for(const a of s.bitmaps){if(!a)continue;const o=a.assetName;let h=gn.MIN_NORMAL_COORDINATE_VALUE,u=gn.MAX_NORMAL_COORDINATE_VALUE,c=gn.MIN_NORMAL_COORDINATE_VALUE,l=gn.MAX_NORMAL_COORDINATE_VALUE;a.normalMinX!==void 0&&(h=a.normalMinX),a.normalMaxX!==void 0&&(u=a.normalMaxX),a.normalMinY!==void 0&&(c=a.normalMinY),a.normalMaxY!==void 0&&(l=a.normalMaxY);const _=e.getAsset(o);if(_){const d=_.texture;if(d){let f=d;_.flipH?f=Vw.getFlipHBitmapData(d):f=f.clone(),n.addBitmap(f,h,u,c,l,o)}}}this._textures.set(i,n)}}}parsePlaneMaterials(t){if(!(!t||!t.length))for(const e of t){if(!e)continue;const s=e.id,i=new LE;if(e.matrices&&e.matrices.length)for(const n of e.matrices){if(!n)continue;let a=Ke.REPEAT_MODE_DEFAULT,o=Ke.ALIGN_DEFAULT,h=Ke.MIN_NORMAL_COORDINATE_VALUE,u=Ke.MAX_NORMAL_COORDINATE_VALUE,c=Ke.MIN_NORMAL_COORDINATE_VALUE,l=Ke.MAX_NORMAL_COORDINATE_VALUE;switch(n.normalMinX!==void 0&&(h=n.normalMinX),n.normalMaxX!==void 0&&(u=n.normalMaxX),n.normalMinY!==void 0&&(c=n.normalMinY),n.normalMaxY!==void 0&&(l=n.normalMaxY),n.repeatMode){case"borders":a=Ke.REPEAT_MODE_BORDERS;break;case"center":a=Ke.REPEAT_MODE_CENTER;break;case"first":a=Ke.REPEAT_MODE_FIRST;break;case"last":a=Ke.REPEAT_MODE_LAST;break;case"random":a=Ke.REPEAT_MODE_RANDOM;break;default:a=Ke.REPEAT_MODE_DEFAULT;break}switch(n.align){case"top":o=Ke.ALIGN_TOP;break;case"bottom":o=Ke.ALIGN_BOTTOM;break;default:o=Ke.ALIGN_DEFAULT;break}if(n.columns&&n.columns.length){const _=i.addMaterialCellMatrix(n.columns.length,a,o,h,u,c,l);let d=0;for(;d<n.columns.length;){const f=n.columns[d];f&&this.parsePlaneMaterialCellColumn(f,_,d),d++}}}this._materials.set(s,i)}}parsePlaneMaterialCellColumn(t,e,s){if(!t||!e)return;let i=Ii.REPEAT_MODE_ALL;const n=t.width,a=this.parsePlaneMaterialCells(t);switch(t.repeatMode){case"borders":i=Ii.REPEAT_MODE_BORDERS;break;case"center":i=Ii.REPEAT_MODE_CENTER;break;case"first":i=Ii.REPEAT_MODE_FIRST;break;case"last":i=Ii.REPEAT_MODE_LAST;break;case"none":i=Ii.REPEAT_MODE_NONE;break;default:i=Ii.REPEAT_MODE_ALL;break}e.createColumn(s,n,a,i)}parsePlaneMaterialCells(t){if(!t||!t.cells||!t.cells.length)return null;const e=[];let s=0;for(;s<t.cells.length;){const i=t.cells[s];if(i){const n=i.textureId;let a=null,o=null,h=null,u=0;if(i.extraData){const _=i.extraData.extraItemTypes,d=i.extraData.offsets;_&&d&&_.length&&d.length&&(a=this.parseExtraItemTypes(_),o=this.parseExtraItemOffsets(d),u=o.length,i.extraData.limitMax!==void 0&&(u=i.extraData.limitMax))}if(a&&a.length){h=[];for(const _ of a){if(!_)continue;const d=this._assetCollection.getAsset(_);d&&h.push(d)}}const c=this.getTexture(n),l=new vet(c,h,o,u);e.push(l)}s++}return!e||!e.length?null:e}parseExtraItemTypes(t){const e=[];if(t&&t.length){let s=0;for(;s<t.length;){const i=t[s];i&&e.push(i),s++}}return e}parseExtraItemOffsets(t){const e=[];if(t&&t.length){let s=0;for(;s<t.length;){const[i,n]=t[s];e.push(new B(i,n)),s++}}return e}getGeometry(t,e,s){e=Math.abs(e),e>90&&(e=90),s=Math.abs(s),s>90&&(s=90);const i=`${t}_${Math.round(e)}_${Math.round(s)}`;let n=this._geometries.get(i);return n||(n=new Eh(t,new S(e,s),new S(-10,0,0)),this._geometries.set(i,n),n)}parseVisualizations(t,e){if(!(!t||!e)&&e&&e.length)for(const s of e){if(!s)continue;const i=s.size;let n=bn.HORIZONTAL_ANGLE_DEFAULT,a=bn.VERTICAL_ANGLE_DEFAULT;s.horizontalAngle!==void 0&&(n=s.horizontalAngle),s.verticalAngle!==void 0&&(a=s.verticalAngle);const o=s.allLayers,h=t.createPlaneVisualization(i,o&&o.length||0,this.getGeometry(i,n,a));if(h&&o&&o.length){let u=0;for(;u<o.length;){const c=o[u];if(c){let l=null,_=fr.ALIGN_DEFAULT,d=bn.DEFAULT_COLOR,f=fr.DEFAULT_OFFSET;c.materialId&&(l=this.getMaterial(c.materialId)),c.color&&(d=c.color),c.offset&&(f=c.offset),c.align&&(c.align==="bottom"?_=fr.ALIGN_BOTTOM:c.align=="top"&&(_=fr.ALIGN_TOP)),h.setLayer(u,l,d,_,f)}u++}}}}render(t,e,s,i,n,a,o,h,u,c=0,l=0,_=0,d=0,f=0){return null}getTextureIdentifier(t,e){return t.toString()}getLayers(t){let e=this.getPlane(t);return e||(e=this.getPlane(h0.DEFAULT)),e.getLayers()}};o0.DEFAULT="default";let Rh=o0;class Aet extends Rh{initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseFloors(t)}parseFloors(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,n=s.visualizations,a=new bn;this.parseVisualizations(a,n),this.addPlane(i,a)||a.dispose()}}render(t,e,s,i,n,a,o,h,u,c=0,l=0,_=0,d=0,f=0){let m=this.getPlane(i);if(m||(m=this.getPlane(Rh.DEFAULT)),!m)return null;s&&e.clearAndFillRenderTexture(s);let p=m.render(t,e,s,n,a,o,h,u,c,l);return p&&p!==s&&(p=new we(p.baseTexture),!p)?null:new Wl(p,-1)}}class z_ extends DE{render(t,e,s,i,n,a,o,h){const u=this.getPlaneVisualization(a);if(!u||!u.geometry)return null;const c=u.geometry.getScreenPoint(new S(0,0,0)),l=u.geometry.getScreenPoint(new S(0,0,n/u.geometry.scale)),_=u.geometry.getScreenPoint(new S(0,i/u.geometry.scale,0));return c&&l&&_&&(i=Math.round(Math.abs(c.x-_.x)),n=Math.round(Math.abs(c.y-l.y))),u.render(t,e,s,i,n,o,h)}}z_.DEFAULT_COLOR=16777215;z_.HORIZONTAL_ANGLE_DEFAULT=45;z_.VERTICAL_ANGLE_DEFAULT=30;class yet extends Rh{initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseWalls(t)}parseWalls(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,n=s.visualizations,a=new z_;this.parseVisualizations(a,n),this.addPlane(i,a)||a.dispose()}}render(t,e,s,i,n,a,o,h,u,c=0,l=0,_=0,d=0,f=0){let m=this.getPlane(i);if(m||(m=this.getPlane(Rh.DEFAULT)),!m)return null;s&&e.clearAndFillRenderTexture(s);let p=m.render(t,e,s,n,a,o,h,u);return p&&p!==s&&(p=new we(p.baseTexture),!p)?null:new Wl(p,-1)}getTextureIdentifier(t,e){return e?`${t}_${e.x}_${e.y}_${e.z}`:super.getTextureIdentifier(t,e)}}class vn extends DE{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(t){const e=this.getPlaneVisualization(t);return e?!e.hasAnimationLayers:super.isStatic(t)}initializeDimensions(t,e){t<0&&(t=0),e<0&&(e=0),(t!==this._width||e!==this._height)&&(this._width=t,this._height=e)}render(t,e,s,i,n,a,o,h,u,c,l,_,d){const f=this.getPlaneVisualization(a);if(!f||!f.geometry)return null;const m=f.geometry.getScreenPoint(new S(0,0,0)),p=f.geometry.getScreenPoint(new S(0,0,1)),T=f.geometry.getScreenPoint(new S(0,1,0));if(m&&p&&T){i=Math.round(Math.abs((m.x-T.x)*i/f.geometry.scale)),n=Math.round(Math.abs((m.y-p.y)*n/f.geometry.scale));const v=Math.trunc(u*Math.abs(m.x-T.x)),O=Math.trunc(c*Math.abs(m.y-p.y)),A=Math.trunc(l*Math.abs(m.x-T.x)),y=Math.trunc(_*Math.abs(m.y-p.y));return f.render(t,e,s,i,n,o,h,v,O,A,y,l,_,d)}return null}}vn.DEFAULT_COLOR=16777215;vn.HORIZONTAL_ANGLE_DEFAULT=45;vn.VERTICAL_ANGLE_DEFAULT=30;const Y_=class fa extends Rh{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0,this._cachedBitmap=null}initializeDimensions(t,e){return t<0&&(t=0),e<0&&(e=0),this._landscapeWidth=t,this._landscapeHeight=e,!0}initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseLandscapes(t)}parseLandscapes(t){if(!t)return;const e=Math.trunc(Math.random()*654321);for(const s in t){const i=t[s];if(!i)continue;const n=i.id,a=i.animatedVisualization,o=new vn;for(const h of a){if(!h)continue;const u=h.size;let c=vn.HORIZONTAL_ANGLE_DEFAULT,l=vn.VERTICAL_ANGLE_DEFAULT;h.horizontalAngle!==void 0&&(c=h.horizontalAngle),h.verticalAngle!==void 0&&(l=h.verticalAngle);const _=h.allLayers.length??0,d=o.createPlaneVisualization(u,_||0,this.getGeometry(u,c,l));if(d){za.setSeed(e);let f=0;for(;f<_;){const m=h.allLayers[f];if(m){if(m.items===void 0){const p=m;let T=null,v=fr.ALIGN_DEFAULT,O=vn.DEFAULT_COLOR,A=fr.DEFAULT_OFFSET;p.materialId&&(T=this.getMaterial(p.materialId)),p.color&&(O=p.color),p.offset&&(A=p.offset),p.align&&(p.align==="bottom"?v=fr.ALIGN_BOTTOM:p.align==="top"&&(v=fr.ALIGN_TOP)),d.setLayer(f,T,O,v,A)}else{const T=m.items,v=[];if(T&&T.length){for(const O of T)if(O){O.id;const A=O.assetId,y=this.getCoordinateValue(O.x||"",O.randomX||""),M=this.getCoordinateValue(O.y||"",O.randomY||""),N=O.speedX,P=O.speedY;v.push({asset:A,x:y,y:M,speedX:N,speedY:P})}}d.setAnimationLayer(f,v,this.assetCollection)}f++}}}}this.addPlane(n,o)||o.dispose()}}getCoordinateValue(t,e){let s=0;if(t.length>0&&t.charAt(t.length-1)==="%"&&(t=t.substr(0,t.length-1),s=parseFloat(t)/100),e.length>0){const a=za.getValues(1,0,1e4)[0]/1e4;e.charAt(e.length-1)==="%"&&(e=e.substr(0,e.length-1),s=s+a*parseFloat(e)/100)}return s}render(t,e,s,i,n,a,o,h,u,c=0,l=0,_=0,d=0,f=0){let m=this.getPlane(i);if(m||(m=this.getPlane(fa.DEFAULT)),!m)return null;s&&e.clearRenderTexture(s);let p=m.render(t,e,s,n,a,o,h,u,c,l,_,d,f);if(p&&p!==s&&(p=new we(p.baseTexture),!p))return null;let T=null;return!m.isStatic(o)&&fa.UPDATE_INTERVAL>0?T=new Wl(p,Math.round(f/fa.UPDATE_INTERVAL)*fa.UPDATE_INTERVAL+fa.UPDATE_INTERVAL):T=new Wl(p,-1),T}getTextureIdentifier(t,e){return e?e.x<0?t+"_0":t+"_1":super.getTextureIdentifier(t,e)}};Y_.LANDSCAPES_ENABLED=!0;Y_.LANDSCAPE_DEFAULT_COLOR=8828617;Y_.UPDATE_INTERVAL=500;let u0=Y_;class RI{constructor(t,e){if(this._color=0,this._isDisposed=!1,this._color=0,this._isDisposed=!1,this._items=[],t&&e)for(const s of t){if(!s)continue;const i=s.asset;if(i){const n=e.getAsset(i);n&&this._items.push(new Ret(s.x,s.y,s.speedX,s.speedY,n))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._items){for(const t of this._items)t&&t.dispose();this._items=[]}}clearCache(){}render(t,e,s,i,n,a,o,h,u,c,l,_){if(h>0&&u>0){let d=0;for(;d<this._items.length;){const f=this._items[d];if(f){const m=f.getPosition(h,u,c,l,_);if(m.x=Math.trunc(m.x-a),m.y=Math.trunc(m.y-o),f.bitmapData){if(m.x>-f.bitmapData.width&&m.x<e.width&&m.y>-f.bitmapData.height&&m.y<e.height){const p=new Kt(f.bitmapData.texture);p.position.set(m.x,m.y),t.writeToRenderTexture(p,e,!1)}if(m.x-h>-f.bitmapData.width&&m.x-h<e.width&&m.y>-f.bitmapData.height&&m.y<e.height){const p=new Kt(f.bitmapData.texture);p.position.set(m.x-h,m.y),t.writeToRenderTexture(p,e,!1)}if(m.x>-f.bitmapData.width&&m.x<e.width&&m.y-u>-f.bitmapData.height&&m.y-u<e.height){const p=new Kt(f.bitmapData.texture);p.position.set(m.x,m.y-u),t.writeToRenderTexture(p,e,!1)}if(m.x-h>-f.bitmapData.width&&m.x-h<e.width&&m.y-u>-f.bitmapData.height&&m.y-u<e.height){const p=new Kt(f.bitmapData.texture);p.position.set(m.x-h,m.y-u),t.writeToRenderTexture(p,e,!1)}}}d++}}return e}}class OI{constructor(t,e,s){this._type=t,this._leftSideLoc=e,this._rightSideLoc=s}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class vI{constructor(t,e,s,i){this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const Qn=class Ti{constructor(t,e,s,i,n,a,o,h,u,c=0,l=0,_=0,d=0){if(this._maskManager=null,this._width=0,this._height=0,this._textureCache=t,this._secondaryNormals=[],this._bitmapMasks=[],this._rectangleMasks=[],this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._randomSeed=u,this._bitmapData=null,this._maskBitmapData=null,this._maskChanged=!1,this._activeTexture=null,this._origin=new S,this._origin.assign(e),this._location=new S,this._location.assign(s),this._leftSide=new S,this._leftSide.assign(i),this._rightSide=new S,this._rightSide.assign(n),this._normal=S.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),h!=null)for(const f of h){if(!f)continue;const m=new S;m.assign(f),this._secondaryNormals.push(m)}this._disposed=!1,this._isVisible=!1,this._id=null,this._hasTexture=!0,this._geometryUpdateId=-1,this._offset=new B,this._relativeDepth=0,this._type=a,this._color=0,this._rasterizer=null,this._canBeVisible=!0,this._cornerA=new S,this._cornerB=new S,this._cornerC=new S,this._cornerD=new S,this._width=0,this._height=0,this._textureOffsetX=c,this._textureOffsetY=l,this._textureMaxX=_,this._textureMaxY=d,this._useMask=o,this._uniqueId=++Ti._uniqueIdCounter}static blend(t,e){return af.colorize(e,t|4278190080)&16777215}set canBeVisible(t){t!==this._canBeVisible&&(this._canBeVisible||this.resetTextureCache(),this._canBeVisible=t)}get canBeVisible(){return this._canBeVisible}get bitmapData(){return!this.visible||!this._bitmapData?null:this._bitmapData}get maskBitmapData(){return!this.visible||!this._maskBitmapData?null:this._maskBitmapData}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth}get color(){return this._color}set color(t){this._color=t}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}get hasTexture(){return this._hasTexture}set hasTexture(t){this._hasTexture=t}set rasterizer(t){this._rasterizer=t}set maskManager(t){this._maskManager=t}set id(t){t!==this._id&&(this.resetTextureCache(),this._id=t)}get uniqueId(){return this._uniqueId}dispose(){this._activeTexture=null,this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._rasterizer=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._bitmapMasks=null,this._rectangleMasks=null,this._maskPixels=null,this._maskBitmapData&&(this._maskBitmapData.destroy(!0),this._maskBitmapData=null),this._disposed=!0}copyBitmapData(t){return!this.visible||!this._bitmapData||!t||this._bitmapData.width!==t.width||this._bitmapData.height!==t.height?null:t}resetTextureCache(t=null){this._activeTexture=null}getTextureIdentifier(t){return this._rasterizer?this._rasterizer.getTextureIdentifier(t,this.normal):t.toString()}needsNewTexture(t,e){if(!t)return!1;const s=this._activeTexture;return this.updateMaskChangeStatus(),!!(this._canBeVisible&&(!s||s.timeStamp>=0&&e>s.timeStamp||this._maskChanged))}getTexture(t,e){if(!t)return null;let s=null;if(this.needsNewTexture(t,e)){this.getTextureIdentifier(t.scale);const i=this._leftSide.length*t.scale,n=this._rightSide.length*t.scale,a=t.getCoordinatePosition(this._normal);s=this._rasterizer.render(this._uniqueId.toString(),this._textureCache,null,this._id,i,n,t.scale,a,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,e),s&&this.updateMask(s.texture,t)}else this._activeTexture&&(s=this._activeTexture);return s?(this._activeTexture=s,s.texture):null}resolveMasks(t){if(!this._useMask)return null;const e=new wo,s=0;for(;s<this._bitmapMasks.length;){const i=this._bitmapMasks[s];if(i){const n=this._maskManager.getMask(i.type);if(n){const a=n.getAssetName(t.scale);if(a){const o=t.getCoordinatePosition(this._normal),h=n.getGraphicAsset(t.scale,o);if(h){const u=this._maskBitmapData.width*(1-i.leftSideLoc/this._leftSide.length),c=this._maskBitmapData.height*(1-i.rightSideLoc/this._rightSide.length);e.addMask(a,new B(u+h.offsetX,c+h.offsetY),h.flipH,h.flipV)}}}}}return e}screenWidth(t){const e=t.getScreenPoint(new S(0,0,0)),s=t.getScreenPoint(new S(0,1,0));return Math.round(this._leftSide.length*Math.abs(e.x-s.x))}getDrawingDatas(t){const e=[];if(this._isVisible){const s=this.resolveMasks(t),i=this._rasterizer.getLayers(this._id);for(const n of i)if(this._hasTexture&&n.getMaterial()){const a=t.getCoordinatePosition(this._normal),o=n.getMaterial().getMaterialCellMatrix(a),h=new wo(s,Ti.blend(this._color,n.getColor()),o.isBottomAligned());za.setSeed(this._randomSeed);for(const u of o.getColumns(this.screenWidth(t))){const c=[];for(const l of u.getCells()){const _=l.getAssetName(a);_&&c.push(_)}c.length>0&&(u.isRepeated()||c.push(""),h.addAssetColumn(c))}h.assetNameColumns.length>0&&e.push(h)}else{const a=new wo(s,Ti.blend(this._color,n.getColor()));e.push(a)}e.length||e.push(new wo(s,this._color))}return e}update(t,e){if(!t||this._disposed)return!1;let s=!1;if(this._geometryUpdateId!=t.updateId&&(s=!0),(!s||!this._canBeVisible)&&!this.visible)return!1;if(s){this._activeTexture=null;let i=0;if(i=S.cosAngle(t.directionAxis,this.normal),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;let n=0;for(;n<this._secondaryNormals.length;){if(i=S.cosAngle(t.directionAxis,this._secondaryNormals[n]),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;n++}this.updateCorners(t);const o=t.getScreenPosition(this._origin).z;let h=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-o;this._type===Ti.TYPE_FLOOR&&(h=h-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8),this._type===Ti.TYPE_LANDSCAPE&&(h=h+.02),this._relativeDepth=h,this._isVisible=!0,this._geometryUpdateId=t.updateId}if(s||this.needsNewTexture(t,e)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData)if(this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData.destroy(),this._bitmapData=null,this._width<1||this._height<1)return!0;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}else{if(this._width<1||this._height<1)return this._bitmapData.destroy(),this._bitmapData=null,!0;this._textureCache.clearAndFillRenderTexture(this._bitmapData)}else{if(this._width<1||this._height<1)return!1;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}if(!this._bitmapData)return!1}else this._textureCache.clearAndFillRenderTexture(this._bitmapData);za.setSeed(this._randomSeed);const i=this.getTexture(t,e);if(i)this.renderTexture(t,i);else return this.dispose(),!1;return i!==null||s}return!1}updateCorners(t){this._cornerA.assign(t.getScreenPosition(this._location)),this._cornerB.assign(t.getScreenPosition(S.sum(this._location,this._rightSide))),this._cornerC.assign(t.getScreenPosition(S.sum(S.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(t.getScreenPosition(S.sum(this._location,this._leftSide))),this._offset=t.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const e=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x),s=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x)-e,i=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y),n=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y)-i;this._offset.x=this._offset.x-e,this._cornerA.x=this._cornerA.x-e,this._cornerB.x=this._cornerB.x-e,this._cornerC.x=this._cornerC.x-e,this._cornerD.x=this._cornerD.x-e,this._offset.y=this._offset.y-i,this._cornerA.y=this._cornerA.y-i,this._cornerB.y=this._cornerB.y-i,this._cornerC.y=this._cornerC.y-i,this._cornerD.y=this._cornerD.y-i,this._width=s,this._height=n}getMatrixForDimensions(t,e){let s=this._cornerD.x-this._cornerC.x,i=this._cornerD.y-this._cornerC.y,n=this._cornerB.x-this._cornerC.x,a=this._cornerB.y-this._cornerC.y;(this._type===Ti.TYPE_WALL||this._type===Ti.TYPE_LANDSCAPE)&&(Math.abs(n-t)<=1&&(n=t),Math.abs(a-t)<=1&&(a=t),Math.abs(s-e)<=1&&(s=e),Math.abs(i-e)<=1&&(i=e));const o=n/t,h=a/t,u=s/e,c=i/e,l=new Vt(o,h,u,c);return l.translate(this._cornerC.x,this._cornerC.y),l}renderTexture(t,e){this._cornerA==null||this._cornerB==null||this._cornerC==null||this._cornerD==null||e==null||this._bitmapData==null||this.draw(e,this.getMatrixForDimensions(e.width,e.height))}draw(t,e){this._textureCache.writeToRenderTexture(new Kt(t),this._bitmapData,!0,e)}resetBitmapMasks(){this._disposed||!this._useMask||!this._bitmapMasks.length||(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(t,e,s){if(!this._useMask)return!1;for(const n of this._bitmapMasks)if(n&&n.type===t&&n.leftSideLoc===e&&n.rightSideLoc===s)return!1;const i=new OI(t,e,s);return this._bitmapMasks.push(i),this._maskChanged=!0,!0}resetRectangleMasks(){!this._useMask||!this._rectangleMasks.length||(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(t,e,s,i){if(this._useMask){for(const a of this._rectangleMasks)if(a&&a.leftSideLoc===t&&a.rightSideLoc===e&&a.leftSideLength===s&&a.rightSideLength===i)return!1;const n=new vI(t,e,s,i);return this._rectangleMasks.push(n),this._maskChanged=!0,!0}return!1}updateMaskChangeStatus(){if(!this._maskChanged)return;let t=!0;if(this._bitmapMasks.length===this._bitmapMasksOld.length)for(const e of this._bitmapMasks){if(!e)continue;let s=!1;for(const i of this._bitmapMasksOld)if(i&&i.type===e.type&&i.leftSideLoc===e.leftSideLoc&&i.rightSideLoc===e.rightSideLoc){s=!0;break}if(!s){t=!1;break}}else t=!1;this._rectangleMasks.length>this._rectangleMasksOld.length&&(t=!1),t&&(this._maskChanged=!1)}updateMask(t,e){if(!t||!e||!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;const s=t.width,i=t.height;if(this.updateMaskChangeStatus(),(!this._maskBitmapData||this._maskBitmapData.width!==s||this._maskBitmapData.height!==i)&&(this._maskBitmapData=this._textureCache.createAndFillRenderTexture(s,i,"mask"),this._maskChanged=!0),this._maskChanged){this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._maskBitmapData&&this._textureCache.clearAndFillRenderTexture(this._maskBitmapData),this.resetTextureCache(t);const n=e.getCoordinatePosition(this._normal);let a=null,o=0,h=0,u=0;for(;u<this._bitmapMasks.length;){const c=this._bitmapMasks[u];c&&(a=c.type,o=this._maskBitmapData.width-this._maskBitmapData.width*c.leftSideLoc/this._leftSide.length,h=this._maskBitmapData.height-this._maskBitmapData.height*c.rightSideLoc/this._rightSide.length,this._maskManager.updateMask(this._maskBitmapData,a,e.scale,n,o,h),this._bitmapMasksOld.push(new OI(a,c.leftSideLoc,c.rightSideLoc))),u++}for(u=0;u<this._rectangleMasks.length;){const c=this._rectangleMasks[u];if(c){o=this._maskBitmapData.width-this._maskBitmapData.width*c.leftSideLoc/this._leftSide.length,h=this._maskBitmapData.height-this._maskBitmapData.height*c.rightSideLoc/this._rightSide.length;const l=this._maskBitmapData.width*c.leftSideLength/this._leftSide.length,_=this._maskBitmapData.height*c.rightSideLength/this._rightSide.length,d=new Kt(_t.WHITE);d.tint=0,d.width=l,d.height=_,d.position.set(o-l,h-_),this._textureCache.writeToRenderTexture(d,this._maskBitmapData,!1),this._rectangleMasksOld.push(new vI(c.leftSideLength,c.rightSideLoc,c.leftSideLength,c.rightSideLength))}u++}this._maskPixels=this._textureCache.getPixels(this._maskBitmapData),this._maskChanged=!1}this.combineTextureMask(t,this._maskPixels)}combineTextureMask(t,e){var a,o;if(!t||!e)return;const s=this._textureCache.getPixels(t);for(let h=0;h<s.length;h+=4){const u=e[h],c=e[h+1],l=e[h+2];e[h+3],!u&&!c&&!l&&(s[h+3]=0)}const i=(a=t.baseTexture._glTextures[1])==null?void 0:a.texture,n=(o=Me.instance.renderer)==null?void 0:o.gl;!i||!n||(n.bindTexture(n.TEXTURE_2D,i),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,s),n.bindTexture(n.TEXTURE_2D,null))}};Qn.ZERO_POINT=new B(0,0);Qn.TYPE_UNDEFINED=0;Qn.TYPE_WALL=1;Qn.TYPE_FLOOR=2;Qn.TYPE_LANDSCAPE=3;Qn._uniqueIdCounter=1;let wt=Qn;class l0 extends ds{constructor(){super(),this._wallRasterizer=new yet,this._floorRasterizer=new Aet,this._landscapeRasterizer=new u0,this._maskManager=new Tet,this._initialized=!1}initialize(t){if(!t.roomVisualization)return!1;const e=t.roomVisualization.wallData;e&&this._wallRasterizer.initialize(e);const s=t.roomVisualization.floorData;s&&this._floorRasterizer.initialize(s);const i=t.roomVisualization.landscapeData;i&&this._landscapeRasterizer.initialize(i);const n=t.roomVisualization.maskData;return n&&this._maskManager.initialize(n),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(t){this._initialized||(this._wallRasterizer.initializeAssetCollection(t),this._floorRasterizer.initializeAssetCollection(t),this._landscapeRasterizer.initializeAssetCollection(t),this._maskManager.initializeAssetCollection(t),this._initialized=!0)}clearCache(){this._wallRasterizer&&this._wallRasterizer.clearCache(),this._floorRasterizer&&this._floorRasterizer.clearCache(),this._landscapeRasterizer&&this._landscapeRasterizer.clearCache()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}const ws=class be extends d_{constructor(){super(),this._data=null,this._roomPlaneParser=new ye,this._roomPlaneBitmapMaskParser=new wy,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._textureCache=new _F,this._typeVisibility[wt.TYPE_UNDEFINED]=!1,this._typeVisibility[wt.TYPE_FLOOR]=!0,this._typeVisibility[wt.TYPE_WALL]=!0,this._typeVisibility[wt.TYPE_LANDSCAPE]=!0}initialize(t){return t instanceof l0?(this._data=t,super.initialize(t),this._data.setGraphicAssetCollection(this.asset),!0):!1}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null),this._textureCache&&this._textureCache.clearCache()}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(t,e,s,i){if(!this.object||!t)return;const n=this.updateGeometry(t),a=this.object.model;let o=!1;if(this.updateThickness(a)&&(o=!0),this.updateHole(a)&&(o=!0),this.initializeRoomPlanes(),o=this.updateMasks(a),!(e<this._lastUpdateTime+this._updateIntervalTime&&!n&&!o)){if(this.updatePlaneTexturesAndVisibilities(a)&&(o=!0),this.updatePlanes(t,n,e)&&(o=!0),o){let h=0;for(;h<this._visiblePlanes.length;){const u=this._visiblePlaneSpriteNumbers[h],c=this.getSprite(u),l=this._visiblePlanes[h];if(c&&l&&l.type!==wt.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let _=l.color;const d=(_&255)*this._redColor/255,f=(_>>8&255)*this._greenColor/255,m=(_>>16&255)*this._blueColor/255;_=(_>>24<<24)+(m<<16)+(f<<8)+d,c.color=_}else c.color=l.color;h++}this.updateSpriteCounter++}this.updateModelCounter=a.updateCounter,this._lastUpdateTime=e}}updateGeometry(t){if(!t||this._geometryUpdateId===t.updateId)return!1;this._geometryUpdateId=t.updateId,this._boundingRectangle=null;const e=t.direction;return e&&(e.x!==this._directionX||e.y!==this._directionY||e.z!==this._directionZ||t.scale!==this._roomScale)?(this._directionX=e.x,this._directionY=e.y,this._directionZ=e.z,this._roomScale=t.scale,!0):!1}updateThickness(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(I.ROOM_FLOOR_THICKNESS),s=t.getValue(I.ROOM_WALL_THICKNESS);return!isNaN(e)&&!isNaN(s)&&(e!==this._floorThickness||s!==this._wallThickness)?(this._floorThickness=e,this._wallThickness=s,this.clearPlanes(),!0):!1}updateHole(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(I.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(e)&&e!==this._holeUpdateTime?(this._holeUpdateTime=e,this.clearPlanes(),!0):!1}updateMasks(t){if(this.updateModelCounter===t.updateCounter)return!1;let e=!1;const s=t.getValue(I.ROOM_PLANE_MASK_XML);s!==this._maskData&&(this.updatePlaneMasks(s),this._maskData=s,e=!0);const i=t.getValue(I.ROOM_BACKGROUND_COLOR);i!==this._color&&(this._color=i,this._redColor=this._color&255,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,e=!0);const n=t.getValue(I.ROOM_COLORIZE_BG_ONLY)||!1;return n!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=n,e=!0),e}updatePlaneTexturesAndVisibilities(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(I.ROOM_FLOOR_TYPE),s=t.getValue(I.ROOM_WALL_TYPE),i=t.getValue(I.ROOM_LANDSCAPE_TYPE),n=t.getValue(I.ROOM_FLOOR_VISIBILITY)===1,a=t.getValue(I.ROOM_WALL_VISIBILITY)===1,o=t.getValue(I.ROOM_LANDSCAPE_VISIBILITY)===1;return this.updatePlaneTypes(e,s,i)||this.updatePlaneVisibility(n,a,o)}clearPlanes(){if(this._planes){for(;this._planes.length;){const t=this._planes[0];t&&t.dispose(),this._planes.pop()}this._planes=[],this._planes=[]}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const t=this.object.model.getValue(I.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(t))return;const e=this.getLandscapeWidth(),s=this.getLandscapeHeight();let i=0,n=this.object.model.getValue(I.ROOM_RANDOM_SEED),a=0;for(;a<this._roomPlaneParser.planeCount;){const o=this._roomPlaneParser.getPlaneLocation(a),h=this._roomPlaneParser.getPlaneLeftSide(a),u=this._roomPlaneParser.getPlaneRightSide(a),c=this._roomPlaneParser.getPlaneSecondaryNormals(a),l=this._roomPlaneParser.getPlaneType(a);let _=null;if(o&&h&&u){const d=S.crossProduct(h,u);if(n=R0(Math.trunc(n*7613+517)>>>0),_=null,l===qt.PLANE_FLOOR){const f=o.x+h.x+.5,m=o.y+u.y+.5,p=Math.trunc(f)-f,T=Math.trunc(m)-m;_=new wt(this._textureCache,this.object.getLocation(),o,h,u,wt.TYPE_FLOOR,!0,c,n,-p,-T),d.z!==0?_.color=be.FLOOR_COLOR:_.color=d.x!==0?be.FLOOR_COLOR_RIGHT:be.FLOOR_COLOR_LEFT,this._data&&(_.rasterizer=this._data.floorRasterizer)}else l===qt.PLANE_WALL?(_=new wt(this._textureCache,this.object.getLocation(),o,h,u,wt.TYPE_WALL,!0,c,n),(h.length<1||u.length<1)&&(_.hasTexture=!1),d.x===0&&d.y===0?_.color=be.WALL_COLOR_BORDER:d.y>0?_.color=be.WALL_COLOR_TOP:d.y===0?_.color=be.WALL_COLOR_SIDE:_.color=be.WALL_COLOR_BOTTOM,this._data&&(_.rasterizer=this._data.wallRasterizer)):l===qt.PLANE_LANDSCAPE?(_=new wt(this._textureCache,this.object.getLocation(),o,h,u,wt.TYPE_LANDSCAPE,!0,c,n,i,0,e,s),d.y>0?_.color=be.LANDSCAPE_COLOR_TOP:d.y==0?_.color=be.LANDSCAPE_COLOR_SIDE:_.color=be.LANDSCAPE_COLOR_BOTTOM,this._data&&(_.rasterizer=this._data.landscapeRasterizer),i=i+h.length):l==qt.PLANE_BILLBOARD&&(_=new wt(this._textureCache,this.object.getLocation(),o,h,u,wt.TYPE_WALL,!0,c,n),(h.length<1||u.length<1)&&(_.hasTexture=!1),d.x==0&&d.y==0?_.color=be.WALL_COLOR_BORDER:d.y>0?_.color=be.WALL_COLOR_TOP:d.y==0?_.color=be.WALL_COLOR_SIDE:_.color=be.WALL_COLOR_BOTTOM);if(_){_.maskManager=this._data.maskManager;let f=0;for(;f<this._roomPlaneParser.getPlaneMaskCount(a);){const m=this._roomPlaneParser.getPlaneMaskLeftSideLoc(a,f),p=this._roomPlaneParser.getPlaneMaskRightSideLoc(a,f),T=this._roomPlaneParser.getPlaneMaskLeftSideLength(a,f),v=this._roomPlaneParser.getPlaneMaskRightSideLength(a,f);_.addRectangleMask(m,p,T,v),f++}this._planes.push(_)}}else return;a++}this._isPlaneSet=!0,this.defineSprites()}defineSprites(){this.createSprites(this._planes.length);let t=0;for(;t<this._planes.length;){const e=this._planes[t],s=this.getSprite(t);e&&s&&e.leftSide&&e.rightSide&&(e.type===wt.TYPE_WALL&&(e.leftSide.length<1||e.rightSide.length<1)?s.alphaTolerance=bs.MATCH_NOTHING:s.alphaTolerance=bs.MATCH_OPAQUE_PIXELS,e.type===wt.TYPE_WALL?s.tag="plane.wall@"+(t+1):e.type===wt.TYPE_FLOOR?s.tag="plane.floor@"+(t+1):s.tag="plane@"+(t+1),s.spriteType=as.ROOM_PLANE),t++}}getLandscapeWidth(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===qt.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneLeftSide(e);t+=i.length}e++}return t}getLandscapeHeight(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===qt.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneRightSide(e);i.length>t&&(t=i.length)}e++}return t>5&&(t=5),t}updatePlaneTypes(t,e,s){if(t!==this._floorType?this._floorType=t:t=null,e!==this._wallType?this._wallType=e:e=null,s!==this._landscapeType?this._landscapeType=s:s=null,!t&&!e&&!s)return!1;let i=0;for(;i<this._planes.length;){const n=this._planes[i];n&&(n.type===wt.TYPE_FLOOR&&t?n.id=t:n.type===wt.TYPE_WALL&&e?n.id=e:n.type===wt.TYPE_LANDSCAPE&&s&&(n.id=s)),i++}return!0}updatePlaneVisibility(t,e,s){return t===this._typeVisibility[wt.TYPE_FLOOR]&&e===this._typeVisibility[wt.TYPE_WALL]&&s===this._typeVisibility[wt.TYPE_LANDSCAPE]?!1:(this._typeVisibility[wt.TYPE_FLOOR]=t,this._typeVisibility[wt.TYPE_WALL]=e,this._typeVisibility[wt.TYPE_LANDSCAPE]=s,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],!0)}updatePlanes(t,e,s){if(!t||!this.object)return!1;this._assetUpdateCounter++,e&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const i=this._visiblePlanes.length>0;let n=this._visiblePlanes;this._visiblePlanes.length||(n=this._planes);let a=0,o=!1,h=0;for(;h<n.length;){let u=h;i&&(u=this._visiblePlaneSpriteNumbers[h]);const c=this.getSprite(u);if(c){const l=n[h];l?(c.id=l.uniqueId,l.update(t,s)&&(l.visible&&(a=l.relativeDepth+this.floorRelativeDepth+u/1e3,l.type!==wt.TYPE_FLOOR&&(a=l.relativeDepth+this.wallRelativeDepth+u/1e3,(l.leftSide.length<1||l.rightSide.length<1)&&(a=a+be.ROOM_DEPTH_OFFSET*.5)),this.updateSprite(c,t,l,`plane ${u} ${t.scale}`,a)),o=!0),c.visible!=(l.visible&&this._typeVisibility[l.type])&&(c.visible=!c.visible,o=!0),c.visible&&(i||(this._visiblePlanes.push(l),this._visiblePlaneSpriteNumbers.push(h)))):(c.id=0,c.visible&&(c.visible=!1,o=!0))}h++}return o}updatePlaneMasks(t){if(!t)return;this._roomPlaneBitmapMaskParser.initialize(t);const e=[],s=[];let i=!1,n=0;for(;n<this._planes.length;){const a=this._planes[n];a&&(a.resetBitmapMasks(),a.type===wt.TYPE_LANDSCAPE&&e.push(n)),n++}for(const a of this._roomPlaneBitmapMaskParser.masks.values()){const o=this._roomPlaneBitmapMaskParser.getMaskType(a),h=this._roomPlaneBitmapMaskParser.getMaskLocation(a),u=this._roomPlaneBitmapMaskParser.getMaskCategory(a);if(h){let c=0;for(;c<this._planes.length;){const l=this._planes[c];if((l.type===wt.TYPE_WALL||l.type===wt.TYPE_LANDSCAPE)&&l&&l.location&&l.normal){const _=S.dif(h,l.location);if(Math.abs(S.scalarProjection(_,l.normal))<.01&&l.leftSide&&l.rightSide){const f=S.scalarProjection(_,l.leftSide),m=S.scalarProjection(_,l.rightSide);l.type===wt.TYPE_WALL||l.type===wt.TYPE_LANDSCAPE&&u===xn.HOLE?l.addBitmapMask(o,f,m):l.type===wt.TYPE_LANDSCAPE&&(l.canBeVisible||(i=!0),l.canBeVisible=!0,s.push(c))}}c++}}}for(n=0;n<e.length;){const a=e[n];if(s.indexOf(a)<0){const o=this._planes[a];o.canBeVisible=!1,i=!0}n++}i&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateSprite(t,e,s,i,n){const a=s.offset;t.offsetX=-a.x,t.offsetY=-a.y,t.relativeDepth=n,t.color=s.color,t.texture=s.bitmapData,t.name=i+"_"+this._assetUpdateCounter}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new it(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get planes(){const t=[];for(const e of this._visiblePlanes)t.push(e);return t}get floorRelativeDepth(){return be.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return be.ROOM_DEPTH_OFFSET+.5}};ws.FLOOR_COLOR=16777215;ws.FLOOR_COLOR_LEFT=14540253;ws.FLOOR_COLOR_RIGHT=12303291;ws.WALL_COLOR_TOP=16777215;ws.WALL_COLOR_SIDE=13421772;ws.WALL_COLOR_BOTTOM=10066329;ws.WALL_COLOR_BORDER=10066329;ws.LANDSCAPE_COLOR_TOP=16777215;ws.LANDSCAPE_COLOR_SIDE=13421772;ws.LANDSCAPE_COLOR_BOTTOM=10066329;ws.ROOM_DEPTH_OFFSET=1e3;let Met=ws;class Cet extends pe{constructor(){super(),this._tileHeight=0}getLayerYOffset(t,e,s){return s===1?(this._tileHeight=this.object.model.getValue(I.TILE_CURSOR_HEIGHT),-this._tileHeight*32):super.getLayerYOffset(t,e,s)}}const _0=class c0{constructor(){this._visualizationDatas=new Map}getVisualization(t){const e=this.getVisualizationType(t);return e?new e:null}getVisualizationType(t){if(!t)return null;let e=null;switch(t){case F.ROOM:e=Met;break;case F.TILE_CURSOR:e=Cet;break;case F.USER:case F.BOT:case F.RENTABLE_BOT:e=Ptt;break;case F.PET_ANIMATED:e=met;break;case F.FURNITURE_STATIC:e=Kn;break;case F.FURNITURE_ANIMATED:e=pe;break;case F.FURNITURE_RESETTING_ANIMATED:e=eet;break;case F.FURNITURE_BADGE_DISPLAY:e=xtt;break;case F.FURNITURE_BG:e=set;break;case F.FURNITURE_BB:e=qy;break;case F.FURNITURE_ISOMETRIC_BB:e=Ktt;break;case F.FURNITURE_BOTTLE:e=Ftt;break;case F.FURNITURE_BUILDER_PLACEHOLDER:e=wtt;break;case F.FURNITURE_COUNTER_CLOCK:e=Gtt;break;case F.FURNITURE_CUBOID:e=Btt;break;case F.FURNITURE_EXTERNAL_IMAGE:e=Htt;break;case F.FURNITURE_FIREWORKS:e=$y;break;case F.FURNITURE_GIFT_WRAPPED_FIREWORKS:e=jtt;break;case F.FURNITURE_GIFT_WRAPPED:e=ztt;break;case F.FURNITURE_GUILD_CUSTOMIZED:e=Ytt;break;case F.FURNITURE_GUILD_ISOMETRIC_BADGE:e=Wtt;break;case F.FURNITURE_HABBOWHEEL:e=Xtt;break;case F.FURNITURE_MANNEQUIN:e=qtt;break;case F.FURNITURE_PARTY_BEAMER:e=Qtt;break;case F.FURNITURE_PLANET_SYSTEM:e=Jtt;break;case F.FURNITURE_POSTER:e=$tt;break;case F.FURNITURE_QUEUE_TILE:e=tet;break;case F.FURNITURE_SCORE_BOARD:e=ret;break;case F.FURNITURE_SOUNDBLOCK:e=iet;break;case F.FURNITURE_STICKIE:e=net;break;case F.FURNITURE_VAL_RANDOMIZER:e=aet;break;case F.FURNITURE_VOTE_COUNTER:e=oet;break;case F.FURNITURE_VOTE_MAJORITY:e=het;break;case F.FURNITURE_WATER_AREA:e=uet;break;case F.FURNITURE_YOUTUBE:e=_et;break}return e||(Y.log("Unknown Visualization",t),null)}getVisualizationData(t,e,s){const i=this._visualizationDatas.get(t);if(i)return i;let n=null;switch(e){case F.FURNITURE_STATIC:case F.FURNITURE_GIFT_WRAPPED:case F.FURNITURE_BB:case F.FURNITURE_ISOMETRIC_BB:case F.FURNITURE_BG:case F.FURNITURE_STICKIE:case F.FURNITURE_BUILDER_PLACEHOLDER:n=new ni;break;case F.FURNITURE_ANIMATED:case F.FURNITURE_RESETTING_ANIMATED:case F.FURNITURE_POSTER:case F.FURNITURE_HABBOWHEEL:case F.FURNITURE_VAL_RANDOMIZER:case F.FURNITURE_BOTTLE:case F.FURNITURE_PLANET_SYSTEM:case F.FURNITURE_QUEUE_TILE:case F.FURNITURE_PARTY_BEAMER:case F.FURNITURE_COUNTER_CLOCK:case F.FURNITURE_WATER_AREA:case F.FURNITURE_SCORE_BOARD:case F.FURNITURE_FIREWORKS:case F.FURNITURE_GIFT_WRAPPED_FIREWORKS:case F.FURNITURE_GUILD_CUSTOMIZED:case F.FURNITURE_GUILD_ISOMETRIC_BADGE:case F.FURNITURE_VOTE_COUNTER:case F.FURNITURE_VOTE_MAJORITY:case F.FURNITURE_SOUNDBLOCK:case F.FURNITURE_BADGE_DISPLAY:case F.FURNITURE_EXTERNAL_IMAGE:case F.FURNITURE_YOUTUBE:case F.TILE_CURSOR:n=new ME;break;case F.FURNITURE_MANNEQUIN:n=new cg;break;case F.ROOM:n=new l0;break;case F.USER:case F.BOT:case F.RENTABLE_BOT:n=new jl;break;case F.PET_ANIMATED:n=new n0;break}return n?n.initialize(s)?((n instanceof jl||n instanceof cg)&&(n.avatarManager=Q.instance.avatar),c0.CACHING_ENABLED&&this._visualizationDatas.set(t,n),n):(n.dispose(),null):null}};_0.CACHING_ENABLED=!0;let Net=_0;class zt{}zt.ROOM_MIN_X="room_min_x";zt.ROOM_MAX_X="room_max_x";zt.ROOM_MIN_Y="room_min_y";zt.ROOM_MAX_Y="room_max_y";zt.ROOM_IS_PUBLIC="room_is_public";zt.ROOM_Z_SCALE="room_z_scale";zt.AD_DISPLAY_DELAY="ad_display_delay";zt.IS_PLAYING_GAME="is_playing_game";zt.RESTRICTS_DRAGGING="restricts_dragging";zt.RESTRICTS_SCALING="restricts_scaling";zt.RESTRICTED_SCALE="room_scale";class bet{constructor(t,e){this._width=t,this._height=e,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let s=t*e;for(;s>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),s--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height}getTileHeight(t,e){return this.validPosition(t,e)?this._heights[e*this._width+t]:0}setTileHeight(t,e,s){this.validPosition(t,e)&&(this._heights[e*this._width+t]=s)}setStackingBlocked(t,e,s){this.validPosition(t,e)&&(this._isNotStackable[e*this._width+t]=s)}setIsRoomTile(t,e,s){this.validPosition(t,e)&&(this._isRoomTile[e*this._width+t]=s)}validateLocation(t,e,s,i,n,a,o,h,u,c=-1){let l=0,_=0;if(!this.validPosition(t,e)||!this.validPosition(t+s-1,e+i-1))return!1;(n<0||n>=this._width)&&(n=0),(a<0||a>=this._height)&&(a=0),o=Math.min(o,this._width-n),h=Math.min(h,this._height-a),c===-1&&(c=this.getTileHeight(t,e));let d=e;for(;d<e+i;){for(l=t;l<t+s;){if(l<n||l>=n+o||d<a||d>=a+h){if(_=d*this._width+l,u){if(!this._isRoomTile[_])return!1}else if(this._isNotStackable[_]||!this._isRoomTile[_]||Math.abs(this._heights[_]-c)>.01)return!1}l++}d++}return!0}get width(){return this._width}get height(){return this._height}}const W_=class Fr{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(t){this._scale=t}dispose(){this.reset(),this._isDisposed=!0}initialize(t,e,s){if(t<=this._width&&e<=this._height){this._width=t,this._height=e,this._floorHeight=s;return}this.reset();let i=0;for(;i<e;){const n=[];this._heightMap.push(n);let a=0;for(;a<t;)n.push(0),a++;i++}this._width=t,this._height=e,this._floorHeight=s}reset(){this._heightMap=[]}setHeight(t,e,s){if(t<0||t>=this._width||e<0||e>=this._height)return!1;const i=this._heightMap[e];return i?(i[t]=s,!0):!1}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return 0;const s=this._heightMap[e];return s?s[t]:0}getLocation(t,e,s,i,n){if(t==0&&e==0){t=this._width,e=this._height;const c=Math.round(this.scale/10);if(n==Fr.R){let l=this._width-1;for(;l>=0;){let _=1;for(;_<this._height;){if(this.getHeight(l,_)<=this._floorHeight){_-1<e&&(t=l,e=_-1);break}_++}l--}i=i+(this.scale/4-c/2),s=s+this.scale/2}else{let l=this._height-1;for(;l>=0;){let _=1;for(;_<this._width;){if(this.getHeight(_,l)<=this._floorHeight){_-1<t&&(t=_-1,e=l);break}_++}l--}i=i+(this.scale/4-c/2),s=s-c}}let a=t,o=e,h=this.getHeight(t,e);return n==Fr.R?(a=a+(s/(this._scale/2)-.5),o=o+.5,h=h-(i-s/2)/(this._scale/2)):(o=o+((this._scale/2-s)/(this._scale/2)-.5),a=a+.5,h=h-(i-(this._scale/2-s)/2)/(this._scale/2)),new S(a,o,h)}getLocationOldFormat(t,e,s){let i,n,a=0,o=0;n=Math.ceil(t),a=n-t;let h,u,c,l=0;for(i=0;i<this._width;){if(n>=0&&n<this._height){if(this.getHeight(i,n)<=this._floorHeight){h=i-1,u=n,o=i,s=Fr.L;break}if(this.getHeight(i,n+1)<=this._floorHeight){h=i,u=n,o=u-t,s=Fr.R;break}}n++,i++}const _=this.scale/2*a;let d=-o*this.scale/2;return d=d+-e*18/32*this.scale/2,l=this.getHeight(h,u),c=l*this.scale/2+d,s==Fr.R?c=c+a*this.scale/4:c=c+(1-a)*this.scale/4,this.getLocation(h,u,_,c,s)}getOldLocation(t,e){if(t==null)return null;let s=0,i=0,n=0,a=0,o="",h=0;if(e==90)s=Math.floor(t.x-.5),i=Math.floor(t.y+.5),h=this.getHeight(s,i),n=this._scale/2-(t.y-i+.5)*(this._scale/2),a=(h-t.z)*(this._scale/2)+(this._scale/2-n)/2,o=Fr.L;else if(e==180)s=Math.floor(t.x+.5),i=Math.floor(t.y-.5),h=this.getHeight(s,i),n=(t.x+.5-s)*(this._scale/2),a=(h-t.z)*(this._scale/2)+n/2,o=Fr.R;else return null;return[s,i,n,a,o]}getOldLocationString(t,e){const s=this.getOldLocation(t,e);if(s==null)return null;const i=Math.trunc(s[0]),n=Math.trunc(s[1]),a=Math.trunc(s[2]),o=Math.trunc(s[3]),h=s[4];return":w="+i+","+n+" l="+a+","+o+" "+h}getDirection(t){return t==Fr.R?180:90}getFloorAltitude(t,e){const s=this.getHeight(t,e),i=s+1;return s+(Math.trunc(this.getHeight(t-1,e-1))==i||Math.trunc(this.getHeight(t,e-1))==i||Math.trunc(this.getHeight(t+1,e-1))==i||Math.trunc(this.getHeight(t-1,e))==i||Math.trunc(this.getHeight(t+1,e))==i||Math.trunc(this.getHeight(t-1,e+1))==i||Math.trunc(this.getHeight(t,e+1))==i||Math.trunc(this.getHeight(t+1,e+1))==i?.5:0)}isRoomTile(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._heightMap[e][t]>=0}};W_.DEFAULT_SCALE=32;W_.L="l";W_.R="r";let xE=W_;const d0=class f0{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new S}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(t){this._targetId=t}get targetCategory(){return this._targetCategory}set targetCategory(t){this._targetCategory=t}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(t){this._targetObjectLoc.assign(t)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(t){this._limitedLocX=t}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(t){this._limitedLocY=t}get centeredLocX(){return this._centeredLocX}set centeredLocX(t){this._centeredLocX=t}get centeredLocY(){return this._centeredLocY}set centeredLocY(t){this._centeredLocY=t}get screenWd(){return this._screenWd}set screenWd(t){this._screenWd=t}get screenHt(){return this._screenHt}set screenHt(t){this._screenHt=t}get scale(){return this._scale}set scale(t){this._scale!=t&&(this._scale=t,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(t){this._roomWd=t}get roomHt(){return this._roomHt}set roomHt(t){this._roomHt=t}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(t){this._geometryUpdateId=t}get isMoving(){return this._targetLoc!=null&&this._currentLoc!=null}set target(t){let e;this._targetLoc==null&&(this._targetLoc=new S),(this._targetLoc.x!=t.x||this._targetLoc.y!=t.y||this._targetLoc.z!=t.z)&&(this._targetLoc.assign(t),e=S.dif(this._targetLoc,this._currentLoc),this._moveDistance=e.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(t){this._currentLoc==null&&(this._currentLoc=new S,this._currentLoc.assign(t))}resetLocation(t){this._currentLoc==null&&(this._currentLoc=new S),this._currentLoc.assign(t)}update(t,e){let s,i,n,a,o;if(this._followDuration>0&&this._targetLoc!=null&&this._currentLoc!=null){if(this._scaleChanged){this._scaleChanged=!1,this._currentLoc=this._targetLoc,this._targetLoc=null;return}s=S.dif(this._targetLoc,this._currentLoc),s.length>this._moveDistance&&(this._moveDistance=s.length),s.length<=e?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(i=Math.sin(Math.PI*s.length/this._moveDistance),n=e*.5,a=this._moveDistance/f0.MOVE_SPEED_DENOMINATOR,o=n+(a-n)*i,this._maintainPreviousMoveSpeed&&(o<this._previousMoveSpeed?(o=this._previousMoveSpeed,o>s.length&&(o=s.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=o,s.divide(s.length),s.multiply(o),this._currentLoc=S.sum(this._currentLoc,s))}}reset(){this._geometryUpdateId=-1}activateFollowing(t){this._followDuration=t}};d0.MOVE_SPEED_DENOMINATOR=12;let Pet=d0;class AI{constructor(t,e){this._roomId=t,this._data=e,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(t){this._floorType=t}get wallType(){return this._wallType}set wallType(t){this._wallType=t}get landscapeType(){return this._landscapeType}set landscapeType(t){this._landscapeType=t}}class $c{constructor(t,e,s,i,n,a,o,h=NaN,u=-1,c=0,l=0,_="",d=!0,f=!0,m=-1){this._id=t,this._typeId=e,this._type=s,this._state=a,this._data=o,this._extra=h,this._expiryTime=u,this._usagePolicy=c,this._ownerId=l,this._ownerName=_,this._synchronized=d,this._realRoomObject=f,this._sizeZ=m,this._location=new S,this._direction=new S,this._location.assign(i),this._direction.assign(n)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}class Det{constructor(t,e){this._tileObjectMap=new Map;let s=0;for(;s<e;)this._tileObjectMap.set(s,new Map),s++;this._width=t,this._height=e}clear(){for(const t of this._tileObjectMap.values())t&&t.clear();this._tileObjectMap.clear()}populate(t){this.clear();for(const e of t)this.addRoomObject(e)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(t,e){if(t>=0&&t<this._width&&e>=0&&e<this._height){const s=this._tileObjectMap.get(e);if(s)return s.get(t)}return null}setObjectInTile(t,e,s){if(!s.isReady){Y.log("Assigning non initialized object to tile object map!");return}if(t>=0&&t<this._width&&e>=0&&e<this._height){const i=this._tileObjectMap.get(e);i&&i.set(t,s)}}addRoomObject(t){if(!t||!t.model||!t.isReady)return;const e=t.getLocation(),s=t.getDirection();if(!e||!s)return;let i=t.model.getValue(I.FURNITURE_SIZE_X),n=t.model.getValue(I.FURNITURE_SIZE_Y);i<1&&(i=1),n<1&&(n=1);const a=Math.trunc(s.x+45)%360/90;(a===1||a===3)&&([i,n]=[n,i]);let o=e.y;for(;o<e.y+n;){let h=e.x;for(;h<e.x+i;){const u=this.getObjectIntTile(h,o);(!u||u!==t&&u.getLocation().z<=e.z)&&this.setObjectInTile(h,o,t),h++}o++}}}class Let{constructor(t){this._roomId=t,this._modelName=null,this._legacyGeometry=new xE,this._tileObjectMap=null,this._roomCamera=new Pet,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(t){this._modelName=t}setSelectedObject(t){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=t}setPlacedObject(t){this._placedObject&&this._placedObject.dispose(),this._placedObject=t}setFurnitureStackingHeightMap(t){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=t,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new Det(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(t){t&&(this._floorStack.delete(t.id),this._floorStack.set(t.id,t))}removePendingFunitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getPendingFurnitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const t=this._floorStack.keys();return this.getPendingFurnitureFloor(t.next().value)}addPendingFurnitureWall(t){t&&(this._wallStack.delete(t.id),this._wallStack.set(t.id,t))}removePendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getPendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const t=this._wallStack.keys();return this.getPendingFurnitureWall(t.next().value)}addButtonMouseCursorOwner(t){return this._mouseButtonCursorOwners.indexOf(t)===-1?(this._mouseButtonCursorOwners.push(t),!0):!1}removeButtonMouseCursorOwner(t){const e=this._mouseButtonCursorOwners.indexOf(t);return e>-1?(this._mouseButtonCursorOwners.splice(e,1),!0):!1}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class Uet{constructor(t,e){this._object=t,this._groupBadge=e}get object(){return this._object}get groupBadge(){return this._groupBadge}}class td{constructor(t,e,s,i,n,a=0,o=null,h=null,u=-1,c=-1,l=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=t,this._category=e,this._operation=s,this._loc=new S,this._loc.assign(i),this._dir=new S,this._dir.assign(n),this._typeId=a,this._instanceData=o,this._stuffData=h,this._state=u,this._animFrame=c,this._posture=l}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}const ru=class ar{constructor(){this.spriteCount=0,this.externalImageCount=0}static addMannequinSprites(t,e){const s=[];for(const i of t)if(i)if(i.type==="boutique_mannequin1"&&i.name.indexOf("mannequin_")===0){const n=e.getRoomObject(e.activeRoomId,i.objectId,L.FLOOR);if(n){const a=n.visualization.getSpriteList();if(a)for(const o of a)o.x=o.x+(i.x+i.width/2+ar.MANNEQUIN_MAGIC_X_OFFSET),o.y=o.y+(i.y+i.height+ar.MANNEQUIN_MAGIC_Y_OFFSET),o.z=o.z+i.z,s.push(o)}}else s.push(i);return s}static sortSpriteDataObjects(t,e){return t.z<e.z?1:(t.z>e.z,-1)}static isSpriteInViewPort(t,e,s){return!0}static sortQuadPoints(t,e,s,i){const n=[];if(t.x==e.x?n.push(t,s,e,i):t.x==s.x?n.push(t,e,s,i):e.x<t.x&&e.y>t.y||e.x>t.x&&e.y<t.y?n.push(t,s,e,i):n.push(t,e,s,i),n[0].x<n[1].x){let a=n[0];n[0]=n[1],n[1]=a,a=n[2],n[2]=n[3],n[3]=a}if(n[0].y<n[2].y){let a=n[0];n[0]=n[2],n[2]=a,a=n[1],n[1]=n[3],n[3]=a}return n}getFurniData(t,e,s,i){const n=[];let a=e.getSortableSpriteList();const o=s.getRoomObjects(s.activeRoomId,L.UNIT);for(const h of o)if(h.id!==i){const u=h.visualization.getSpriteList();if(u){let c=0,l=0;for(const d of a)if(d.name==="avatar_"+h.id){c=d.z,l=d.y+d.height-e.geometry.scale/4;break}const _=s.getRoomObjectScreenLocation(s.activeRoomId,h.id,L.UNIT,e.id);if(_){l===0&&(l=_.y);for(const d of u)d.x=d.x+(_.x-e.screenOffsetX),d.y=d.y+l,d.z=d.z+c,(d.name.indexOf("h_std_fx29_")===0||d.name.indexOf("h_std_fx185_")===0)&&(d.y=d.y+ar.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET),a.push(d)}}}a=ar.addMannequinSprites(a,s),a.sort(ar.sortSpriteDataObjects);for(const h of a)h.name!==null&&h.name.length>0&&h.name.indexOf("tile_cursor_")!==0&&ar.isSpriteInViewPort(h,t,e)&&(i<0||h.objectId!=i)&&(n.push(this.getSpriteDataObject(h,t,e,s)),this.maxZ||(this.maxZ=h.z),this.spriteCount++);return JSON.stringify(n)}getRoomRenderingModifiers(t){return JSON.stringify(new Object)}getSpriteDataObject(t,e,s,i){let n=[];const a={};let o=t.name;return t.name.indexOf("@")!==-1&&(n=t.name.split("@"),o=n[0],n[1]),a.name=o,a.x=t.x-e.x,a.y=t.y-e.y,a.x=a.x+s.screenOffsetX,a.y=a.y+s.screenOffsetY,a.z=t.z,t.alpha&&t.alpha.toString()!=="255"&&(a.alpha=t.alpha),t.flipH&&(a.flipH=t.flipH),t.skew&&(a.skew=t.skew),t.frame&&(a.frame=t.frame),t.color&&t.color.length>0&&(a.color=parseInt(t.color)),t.blendMode&&t.blendMode!=="normal"&&(a.blendMode=t.blendMode),o.indexOf("http")===0&&(a.width=t.width,a.height=t.height,this.externalImageCount++,this.externalImageCount>ar.MAX_EXTERNAL_IMAGE_COUNT&&(a.name="box")),t.posture&&(a.posture=t.posture),a}makeBackgroundPlane(t,e,s){const i=new B(0,0),n=new B(t.width,0),a=new B(0,t.height),o=new B(t.width,t.height),h=ar.sortQuadPoints(i,n,a,o);let u=0;s.length>0?(u=s[0].z,this.maxZ&&(u=Math.max(this.maxZ,u))):u=this.maxZ?this.maxZ:0,u=u+(this.spriteCount*1.776104+s.length*2.31743);const c=new wo(null,e);return c.cornerPoints=h,c.z=u,c}sortRoomPlanes(t,e,s){const i=new Map;let n=1;this.maxZ&&(n=n+this.maxZ);for(const h of t){const u={plane:h,z:n};i.set(h.uniqueId,u)}const a=e.getPlaneSortableSprites();a.sort((h,u)=>u.z-h.z),a.reverse();let o=[];for(const h of a){const u=h.sprite;if(u){const c=i.get(u.id);c&&(i.delete(u.id),c.z=h.z,o.push(c))}}return o=o.concat(Array.from(i.values())),o}getRoomPlanes(t,e,s,i){const n=[],o=s.getRoomObject(s.activeRoomId,FE.ROOM_OBJECT_ID,L.ROOM).visualization;if(o){const h=e.geometry,u=this.sortRoomPlanes(o.planes,e,s),c=Me.instance.stage;for(const l of u){const _=l.plane,d=[],f=S.sum(_.location,_.leftSide),m=h.getScreenPoint(_.location),p=h.getScreenPoint(f),T=h.getScreenPoint(S.sum(_.location,_.rightSide)),v=h.getScreenPoint(S.sum(f,_.rightSide));d.push(m,p,T,v);let O=0,A=0;for(const y of d)y.x+=c.width/2,y.y+=c.height/2,y.x+=e.screenOffsetX,y.y+=e.screenOffsetY,y.x+=-t.x,y.y+=-t.y,y.x<0?O--:y.x>=t.width&&O++,y.y<0?A--:y.y>=t.height&&A++;if(!(Math.abs(O)===4||Math.abs(A)===4)){const y=ar.sortQuadPoints(m,p,T,v);for(const M of _.getDrawingDatas(h))M.cornerPoints=y,M.z=l.z,n.push(M)}}n.unshift(this.makeBackgroundPlane(t,i,n))}return n}};ru.MANNEQUIN_MAGIC_X_OFFSET=1;ru.MANNEQUIN_MAGIC_Y_OFFSET=-16;ru.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET=-52;ru.MAX_EXTERNAL_IMAGE_COUNT=30;let xet=ru;class Fet extends ds{constructor(t){super(),this._connection=null,this._roomCreator=t,this._planeParser=new ye,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}setConnection(t){this._connection||!t||(this._connection=t,this._connection.addMessageEvent(new wl(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new Va(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new Vf(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new wf(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new Bf(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new Hf(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new kf(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new Gf(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new vf(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new Of(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new Nf(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new Sf(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new yf(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new Mf(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new Cf(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new Lf(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new Uf(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new xf(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new Ff(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new bf(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new Pf(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new Df(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new Ll(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new zf(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new Ul(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new Yf(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new Wf(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new Xf(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new xl(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new Kf(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new Fl(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new qf(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new _E(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new Pl(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new Dl(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new jf(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new bl(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new Kv(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new Zv(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new Af(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new fE(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new Cv(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new yv(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new Mv(this.onGuideSessionErrorMessageEvent.bind(this))))}setRoomId(t){this._currentRoomId!==0&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=t,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(t){if(!(t instanceof wl)||!t.connection)return;const e=t.getParser();e&&(this._ownUserId=e.userInfo.userId)}onRoomReadyMessageEvent(t){const e=t.getParser();if(this._currentRoomId!==e.roomId&&this.setRoomId(e.roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(e.roomId,e.name),this._initialConnection){t.connection.send(new hS),this._initialConnection=!1;return}t.connection.send(new tg)}onRoomPaintEvent(t){if(!(t instanceof Vf))return;const e=t.getParser();if(!e)return;const s=e.floorType,i=e.wallType,n=e.landscapeType;this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,s,i,n)}onRoomModelEvent(t){if(!(t instanceof wf)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!s)return;this._planeParser.reset();const i=e.width,n=e.height;this._planeParser.initializeTileMap(i,n);let a=null;this._latestEntryTileEvent&&(a=this._latestEntryTileEvent.getParser());let o=-1,h=-1,u=0,c=0,l=0;for(;l<n;){let f=0;for(;f<i;){const m=e.getHeight(f,l);(l>0&&l<n-1||f>0&&f<i-1)&&m!=ye.TILE_BLOCKED&&(a==null||f==a.x&&l==a.y)&&(e.getHeight(f,l-1)==ye.TILE_BLOCKED&&e.getHeight(f-1,l)==ye.TILE_BLOCKED&&e.getHeight(f,l+1)==ye.TILE_BLOCKED&&(o=f+.5,h=l,u=m,c=90),e.getHeight(f,l-1)==ye.TILE_BLOCKED&&e.getHeight(f-1,l)==ye.TILE_BLOCKED&&e.getHeight(f+1,l)==ye.TILE_BLOCKED&&(o=f,h=l+.5,u=m,c=180)),this._planeParser.setTileHeight(f,l,m),f++}l++}this._planeParser.setTileHeight(Math.floor(o),Math.floor(h),u),this._planeParser.initializeFromTileData(e.wallHeight),this._planeParser.setTileHeight(Math.floor(o),Math.floor(h),u+this._planeParser.wallHeight),e.scale===64?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),s.scale=xE.DEFAULT_SCALE,s.initialize(i,n,this._planeParser.floorHeight);let _=e.height-1;for(;_>=0;){let f=e.width-1;for(;f>=0;)s.setHeight(f,_,this._planeParser.getTileHeight(f,_)),f--;_--}const d=this._planeParser.getMapData();d.doors.push({x:o,y:h,z:u,dir:c}),this._roomCreator.createRoomInstance(this._currentRoomId,d)}onRoomHeightMapEvent(t){if(!(t instanceof Bf)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.width,i=e.height,n=new bet(s,i);let a=0;for(;a<i;){let o=0;for(;o<s;)n.setTileHeight(o,a,e.getTileHeight(o,a)),n.setStackingBlocked(o,a,e.getStackingBlocked(o,a)),n.setIsRoomTile(o,a,e.isRoomTile(o,a)),o++;a++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,n)}onRoomHeightMapUpdateEvent(t){if(!(t instanceof Hf)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(s){for(;e.next();)s.setTileHeight(e.x,e.y,e.tileHeight()),s.setStackingBlocked(e.x,e.y,e.isStackingBlocked()),s.setIsRoomTile(e.x,e.y,e.isRoomTile());this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(t){if(!(t instanceof kf))return;const e=t.getParser();if(!e)return;const s=!e.hideWalls,i=!0,n=e.thicknessWall,a=e.thicknessFloor;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,s,i),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,n,a))}onRoomDoorEvent(t){t instanceof Gf&&(this._latestEntryTileEvent=t)}onRoomRollingEvent(t){if(!(t instanceof vf)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,2,null);const s=e.itemsRolling;if(s&&s.length)for(const n of s)n&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,n.id,n.location,n.targetLocation);const i=e.unitRolling;if(i){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,i.id,i.location,i.targetLocation);const n=this._roomCreator.getRoomObjectUser(this._currentRoomId,i.id);if(n&&n.type!==Dt.MONSTER_PLANT){let a="std";switch(i.movementType){case Kr.MOVE:a="mv";break;case Kr.SLIDE:a="std";break}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,i.id,a)}}}onObjectsDataUpdateEvent(t){if(!(t instanceof Of)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(e)for(const s of e.objects)this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.id,null,null,s.state,s.data)}onFurnitureAliasesEvent(t){!(t instanceof Nf)||!t.connection||!this._roomCreator||(t.getParser().aliases,this._connection.send(new tg))}onFurnitureFloorAddEvent(t){if(!(t instanceof Sf)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureFloor(this._currentRoomId,e)}onFurnitureFloorEvent(t){if(!(t instanceof yf)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const n=e.items[i];n&&this.addRoomObjectFurnitureFloor(this._currentRoomId,n),i++}}onFurnitureFloorRemoveEvent(t){if(!(t instanceof Mf)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(e.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0)},e.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0))}onFurnitureFloorUpdateEvent(t){if(!(t instanceof Cf)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;if(!e)return;const s=new S(e.x,e.y,e.z),i=new S(e.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,s,i,e.data.state,e.data,e.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,e.itemId,e.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,e.itemId,e.expires)}onFurnitureWallAddEvent(t){if(!(t instanceof Lf)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureWall(this._currentRoomId,e)}onFurnitureWallEvent(t){if(!(t instanceof Uf)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const n=e.items[i];n&&this.addRoomObjectFurnitureWall(this._currentRoomId,n),i++}}onFurnitureWallRemoveEvent(t){if(!(t instanceof xf)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.removeRoomObjectWall(this._currentRoomId,e.itemId,e.userId)}onFurnitureWallUpdateEvent(t){if(!(t instanceof Ff)||!t.connection||!this._roomCreator)return;const e=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!e)return;const s=t.getParser().item;if(!s)return;const i=e.getLocation(s.width,s.height,s.localX,s.localY,s.direction),n=new S(e.getDirection(s.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,s.itemId,i,n,s.state,s.stuffData),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,s.itemId,s.secondsToExpiration)}onFurnitureDataEvent(t){if(!(t instanceof bf)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.furnitureId,null,null,e.objectData.state,e.objectData)}onItemDataUpdateMessageEvent(t){if(!(t instanceof Pf)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,e.furnitureId,e.data)}onOneWayDoorStatusMessageEvent(t){if(!(t instanceof Df)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.state,new Rs)}onDiceValueMessageEvent(t){if(!(t instanceof Af)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.value,new Rs)}onRoomUnitDanceEvent(t){!(t instanceof Ll)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,I.FIGURE_DANCE,t.getParser().danceId)}onRoomUnitEffectEvent(t){!(t instanceof zf)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,t.getParser().unitId,t.getParser().effectId,t.getParser().delay)}onRoomUnitEvent(t){if(!(t instanceof Ul)||!t.connection||!this._roomCreator)return;const e=t.getParser().users;if(!(!e||!e.length)){for(const s of e){if(!s)continue;const i=new S(s.x,s.y,s.z),n=new S(s.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,s.roomIndex,i,n,s.dir,s.userType,s.figure),s.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,s.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,s.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,s.roomIndex,s.figure,s.sex,s.subType,s.isRiding),Dt.getTypeString(s.userType)===Dt.PET&&this._roomCreator.getPetTypeId(s.figure)===Rt.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,s.roomIndex,s.petPosture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,s.roomIndex,I.FIGURE_IS_MUTED,this._roomCreator.sessionDataManager.isUserIgnored(s.name)?1:0)}this.updateGuideMarker()}}onRoomUnitExpressionEvent(t){!(t instanceof Yf)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,I.FIGURE_EXPRESSION,t.getParser().expression)}onRoomUnitHandItemEvent(t){!(t instanceof Wf)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,I.FIGURE_CARRY_OBJECT,t.getParser().handId)}onRoomUnitIdleEvent(t){!(t instanceof Xf)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,I.FIGURE_SLEEP,t.getParser().isIdle?1:0)}onRoomUnitInfoEvent(t){!(t instanceof xl)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.getParser().unitId,t.getParser().figure,t.getParser().gender)}onRoomUnitNumberEvent(t){if(!(t instanceof Kf)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.unitId,I.FIGURE_NUMBER_VALUE,e.value)}onRoomUnitRemoveEvent(t){!(t instanceof Fl)||!t.connection||!this._roomCreator||(this._roomCreator.removeRoomObjectUser(this._currentRoomId,t.getParser().unitId),this.updateGuideMarker())}onRoomUnitStatusEvent(t){if(!(t instanceof qf)||!t.connection||!this._roomCreator)return;const e=t.getParser().statuses;if(!e||!e.length)return;const s=this._roomCreator.getRoomInstance(this._currentRoomId);if(!s)return;const i=s.model.getValue(zt.ROOM_Z_SCALE)||1;for(const n of e){if(!n)continue;let a=n.height;a&&(a=a/i);const o=new S(n.x,n.y,n.z+a),h=new S(n.direction);let u=null;n.didMove&&(u=new S(n.targetX,n.targetY,n.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,n.id,o,u,n.canStandUp,a,h,n.headDirection),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,null);let c=!0,l=!1,_=I.STD,d="";if(n.actions&&n.actions.length){for(const f of n.actions)if(f)switch(f.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,n.id,f.value);break;case"sign":n.actions.length===1&&(c=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,n.id,I.FIGURE_SIGN,parseInt(f.value));break;case"gst":n.actions.length===1&&(c=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,n.id,f.value);break;case"wav":case"mv":l=!0,_=f.action,d=f.value;break;case"trd":break;default:l=!0,_=f.action,d=f.value;break}}l?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,_,d):c&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,n.id,I.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(t){if(!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,e.roomIndex,e.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,I.FIGURE_TALK,e.message.length/10))}onRoomUnitTypingEvent(t){!(t instanceof jf)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,I.FIGURE_IS_TYPING,t.getParser().isTyping?1:0)}onPetFigureUpdateEvent(t){if(!(t instanceof bl)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,e.roomIndex,e.figureData.figuredata,"","",e.isRiding)}onPetExperienceEvent(t){const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,I.FIGURE_GAINED_EXPERIENCE,e.gainedExperience)}onYouArePlayingGameEvent(t){if(!t)return;const e=t.getParser();e&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,e.isPlaying)}addRoomObjectFurnitureFloor(t,e){if(!e||!this._roomCreator)return;const s=new S(e.x,e.y,e.z),i=new S(e.direction);e.spriteName?this._roomCreator.addFurnitureFloorByTypeName(t,e.itemId,e.spriteName,s,i,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight):this._roomCreator.addFurnitureFloor(t,e.itemId,e.spriteId,s,i,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight)}addRoomObjectFurnitureWall(t,e){if(!e||!this._roomCreator)return;const s=this._roomCreator.getLegacyWallGeometry(t);if(!s)return;let i=null;e.isOldFormat||(i=s.getLocation(e.width,e.height,e.localX,e.localY,e.direction));const n=new S(s.getDirection(e.direction));this._roomCreator.addFurnitureWall(t,e.itemId,e.spriteId,i,n,e.state,e.stuffData,e.secondsToExpiration,e.usagePolicy,e.userId,e.username)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getUserDataByName(e.name);if(i)switch(e.result){case 1:case 2:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,I.FIGURE_IS_MUTED,1);return;case 3:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,I.FIGURE_IS_MUTED,0);return}}onGuideSessionStartedMessageEvent(t){const e=t.getParser();this._guideId=e.guideUserId,this._requesterId=e.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(t){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(t){this.removeGuideMarker()}updateGuideMarker(){const t=this._roomCreator.sessionDataManager.userId;this.setUserGuideStatus(this._guideId,this._requesterId===t?ks.GUIDE:ks.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===t?ks.REQUESTER:ks.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,ks.NONE),this.setUserGuideStatus(this._requesterId,ks.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(t,e){if(!this._roomCreator||!this._roomCreator.roomSessionManager)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getDataByType(t,Ys.USER);i&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,I.FIGURE_GUIDE_STATUS,e)}get currentRoomId(){return this._currentRoomId}}class wet extends ds{constructor(t){super(),this._roomEngine=t,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener($.ADDED,this.onRoomEngineObjectEvent)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener($.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}onRoomEngineObjectEvent(t){let e=this.getSelectedRoomObjectData(t.roomId);if(e&&e.operation===ut.OBJECT_PLACE&&e.id===t.objectId){const s=this._roomEngine.getRoomObject(t.roomId,e.id,e.category);if(s&&s.model&&e.category===L.FLOOR){const i=s.model.getValue(I.FURNITURE_ALLOWED_DIRECTIONS);if(i&&i.length){const n=new S(i[0]);if(s.setDirection(n),this.updateSelectedObjectData(t.roomId,e.id,e.category,e.loc,n,e.operation,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture),e=this.getSelectedRoomObjectData(t.roomId),!e)return}}this.setFurnitureAlphaMultiplier(s,.5)}}processRoomCanvasMouseEvent(t,e,s){if(!t||!e||Ci.isRunning())return;const i=e.type;let n=this._roomEngine.getRoomObjectCategoryForType(i);if(n!==L.ROOM&&(!this._roomEngine.isPlayingGame()||n!==L.UNIT)&&(n=L.MINIMUM),this.getMouseEventId(n,t.type)===t.eventId){if(t.type===k.MOUSE_CLICK||t.type===k.DOUBLE_CLICK||t.type===k.MOUSE_DOWN||t.type===k.MOUSE_UP||t.type===k.MOUSE_MOVE)return}else t.eventId&&this.setMouseEventId(n,t.type,t.eventId);e.mouseHandler&&e.mouseHandler.mouseEvent(t,s)}processRoomObjectPlacement(t,e,s,i,n,a=null,o=null,h=-1,u=-1,c=null){this._objectPlacementSource=t;const l=new S(-100,-100),_=new S(0);return this.setSelectedRoomObjectData(e,s,i,l,_,ut.OBJECT_PLACE,n,a,o,h,u,c),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(n,i,!1,a,o,h,u,c),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(t){return this.resetSelectedObjectData(t),!0}getMouseEventId(t,e){const s=this._eventIds.get(t);return s&&s.get(e)||null}setMouseEventId(t,e,s){let i=this._eventIds.get(t);i||(i=new Map,this._eventIds.set(t,i)),i.delete(e),i.set(e,s)}handleRoomObjectEvent(t,e){if(t){if(t instanceof et){this.handleRoomObjectMouseEvent(t,e);return}switch(t.type){case mt.STATE_CHANGE:case mt.STATE_RANDOM:this.onRoomObjectStateChangedEvent(t,e);return;case Zo.DIMMER_STATE:this.onRoomObjectDimmerStateUpdateEvent(t,e);return;case $e.POSITION_CHANGED:case $e.OBJECT_REMOVED:this.handleSelectedObjectRemove(t,e);return;case C.OPEN_WIDGET:case C.CLOSE_WIDGET:case C.OPEN_FURNI_CONTEXT_MENU:case C.CLOSE_FURNI_CONTEXT_MENU:case C.PLACEHOLDER:case C.CREDITFURNI:case C.STACK_HEIGHT:case C.EXTERNAL_IMAGE:case C.STICKIE:case C.PRESENT:case C.TROPHY:case C.TEASER:case C.ECOTRONBOX:case C.DIMMER:case C.WIDGET_REMOVE_DIMMER:case C.CLOTHING_CHANGE:case C.JUKEBOX_PLAYLIST_EDITOR:case C.MANNEQUIN:case C.PET_PRODUCT_MENU:case C.GUILD_FURNI_CONTEXT_MENU:case C.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case C.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case C.BACKGROUND_COLOR:case C.MYSTERYBOX_OPEN_DIALOG:case C.EFFECTBOX_OPEN_DIALOG:case C.MYSTERYTROPHY_OPEN_DIALOG:case C.ACHIEVEMENT_RESOLUTION_OPEN:case C.ACHIEVEMENT_RESOLUTION_ENGRAVING:case C.ACHIEVEMENT_RESOLUTION_FAILED:case C.FRIEND_FURNITURE_CONFIRM:case C.FRIEND_FURNITURE_ENGRAVING:case C.BADGE_DISPLAY_ENGRAVING:case C.HIGH_SCORE_DISPLAY:case C.HIDE_HIGH_SCORE_DISPLAY:case C.INERNAL_LINK:case C.ROOM_LINK:case C.YOUTUBE:this.onRoomObjectWidgetRequestEvent(t,e);return;case w.DICE_ACTIVATE:case w.DICE_OFF:case w.USE_HABBOWHEEL:case w.STICKIE:case w.ENTER_ONEWAYDOOR:this.onRoomObjectFurnitureActionEvent(t,e);return;case w.SOUND_MACHINE_INIT:case w.SOUND_MACHINE_START:case w.SOUND_MACHINE_STOP:case w.SOUND_MACHINE_DISPOSE:this.handleObjectSoundMachineEvent(t,e);return;case w.JUKEBOX_INIT:case w.JUKEBOX_START:case w.JUKEBOX_MACHINE_STOP:case w.JUKEBOX_DISPOSE:this.handleObjectJukeboxEvent(t,e);return;case Qe.ADD_HOLE:case Qe.REMOVE_HOLE:this.onRoomObjectFloorHoleEvent(t,e);return;case Yt.ROOM_AD_FURNI_CLICK:case Yt.ROOM_AD_FURNI_DOUBLE_CLICK:case Yt.ROOM_AD_TOOLTIP_SHOW:case Yt.ROOM_AD_TOOLTIP_HIDE:case Yt.ROOM_AD_LOAD_IMAGE:this.onRoomObjectRoomAdEvent(t,e);return;case Ir.LOAD_BADGE:this.onRoomObjectBadgeAssetEvent(t,e);return;case w.MOUSE_ARROW:case w.MOUSE_BUTTON:this.handleMousePointer(t,e);return;case Qr.PLAY_SOUND:case Qr.PLAY_SOUND_AT_PITCH:this.handleRoomObjectPlaySoundEvent(t,e);return;case ie.ROOM_OBJECT_INITIALIZED:case ie.ROOM_OBJECT_DISPOSED:case ie.PLAY_SAMPLE:case ie.CHANGE_PITCH:this.handleRoomObjectSamplePlaybackEvent(t,e);return;case yi.ROOM_BACKGROUND_COLOR:this.onHSLColorEnableEvent(t,e);return;case Ns.RODRE_CURRENT_USER_ID:case Ns.RODRE_URL_PREFIX:this.onRoomObjectDataRequestEvent(t,e);return;default:Y.warn("Unhandled Event",t.constructor.name,"Object ID",t.object.id);return}}}handleRoomObjectMouseEvent(t,e){if(!(!t||!t.type))switch(t.type){case et.CLICK:this.handleRoomObjectMouseClickEvent(t,e);return;case et.DOUBLE_CLICK:this.handleRoomObjectMouseDoubleClickEvent(t,e);return;case et.MOUSE_MOVE:this.handleRoomObjectMouseMoveEvent(t,e);return;case et.MOUSE_DOWN:this.handleRoomObjectMouseDownEvent(t,e);return;case et.MOUSE_DOWN_LONG:this.handleRoomObjectMouseDownLongEvent(t,e);return;case et.MOUSE_ENTER:this.handleRoomObjectMouseEnterEvent(t,e);return;case et.MOUSE_LEAVE:this.handleRoomObjectMouseLeaveEvent(t,e);return}}handleRoomObjectMouseClickEvent(t,e){if(!t)return;let s=ut.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);let n=!1,a=!1;this._whereYouClickIsWhereYouGo&&(!s||s===ut.OBJECT_UNDEFINED)&&(n=this.handleMoveTargetFurni(e,t));const o=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case ut.OBJECT_MOVE:o===L.ROOM?i&&this.modifyRoomObject(e,i.id,i.category,ut.OBJECT_MOVE_TO):o===L.UNIT&&(i&&t.objectType===Dt.MONSTER_PLANT&&this.modifyRoomObject(e,i.id,i.category,ut.OBJECT_MOVE_TO),t.eventId&&this.setMouseEventId(L.ROOM,k.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,o)),a=!0,t.objectId!==-1&&this.setSelectedObject(e,t.objectId,o);break;case ut.OBJECT_PLACE:if(o===L.ROOM)this.placeObject(e,t instanceof Nr,t instanceof aa);else if(o===L.UNIT)switch(t.objectType){case Dt.MONSTER_PLANT:case Dt.RENTABLE_BOT:this.placeObject(e,t instanceof Nr,t instanceof aa);break;default:t.eventId&&this.setMouseEventId(L.ROOM,k.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,o);break}break;case ut.OBJECT_UNDEFINED:o===L.ROOM?!n&&t instanceof Nr&&this.onRoomObjectTileMouseEvent(e,t):(this.setSelectedObject(e,t.objectId,o),a=!1,o===L.UNIT?(t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===Dt.RENTABLE_BOT?this.modifyRoomObject(e,t.objectId,o,ut.OBJECT_PICKUP_BOT):t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===Dt.MONSTER_PLANT?this.modifyRoomObject(e,t.objectId,o,ut.OBJECT_PICKUP_PET):!t.ctrlKey&&!t.altKey&&t.shiftKey&&t.objectType===Dt.MONSTER_PLANT&&this.modifyRoomObject(e,t.objectId,o,ut.OBJECT_ROTATE_POSITIVE),this._roomEngine.isPlayingGame()?a=!0:n=!0):(o===L.FLOOR||o===L.WALL)&&(t.altKey||t.ctrlKey||t.shiftKey)&&(!t.ctrlKey&&!t.altKey&&t.shiftKey?o===L.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new $($.REQUEST_ROTATE,e,t.objectId,o)):t.ctrlKey&&!t.altKey&&!t.shiftKey&&this.modifyRoomObject(e,t.objectId,o,ut.OBJECT_PICKUP),this._roomEngine.isPlayingGame()?a=!0:n=!0),t.eventId&&(n&&this.setMouseEventId(L.ROOM,k.MOUSE_CLICK,t.eventId),a&&this.setMouseEventId(L.MINIMUM,k.MOUSE_CLICK,t.eventId)));break}if(o===L.ROOM){const h=this.getMouseEventId(L.MINIMUM,k.MOUSE_CLICK),u=this.getMouseEventId(L.UNIT,k.MOUSE_CLICK);h!==t.eventId&&u!==t.eventId&&!a&&(this.deselectObject(e),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new $($.DESELECTED,e,-1,L.MINIMUM)),this.setSelectedAvatar(e,0,!1))}}handleRoomObjectMouseDoubleClickEvent(t,e){const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new $($.DOUBLE_CLICK,e,s,n))}handleRoomObjectMouseMoveEvent(t,e){if(!t)return;let s=ut.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);if(this._roomEngine){const a=this._roomEngine.getRoomObjectCursor(e);if(a&&a.logic){let o=null;t instanceof Nr?o=this.handleMouseOverTile(t,e):t.object&&t.object.id!==-1?this._whereYouClickIsWhereYouGo&&(o=this.handleMouseOverObject(n,e,t)):o=new ha(null,0,!1,t.eventId),a.processUpdateMessage(o)}}switch(s){case ut.OBJECT_MOVE:n===L.ROOM&&this.handleObjectMove(t,e);return;case ut.OBJECT_PLACE:n===L.ROOM&&this.handleObjectPlace(t,e);return}}handleRoomObjectMouseDownEvent(t,e){if(!t)return;let s=ut.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case ut.OBJECT_UNDEFINED:(n===L.FLOOR||n===L.WALL||t.objectType===Dt.MONSTER_PLANT)&&(t.altKey&&!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new $($.REQUEST_MOVE,e,t.objectId,n));return}}handleRoomObjectMouseDownLongEvent(t,e){if(!t)return;let s=ut.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const n=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case ut.OBJECT_UNDEFINED:(n===L.FLOOR||n===L.WALL||t.objectType===Dt.MONSTER_PLANT)&&(!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new $($.REQUEST_MANIPULATION,e,t.objectId,n));return}}handleRoomObjectMouseEnterEvent(t,e){const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new $($.MOUSE_ENTER,e,s,n))}handleRoomObjectMouseLeaveEvent(t,e){const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);if(n!==L.ROOM&&n===L.UNIT){const a=this._roomEngine.getRoomObjectCursor(e);a&&a.processUpdateMessage(new Ht(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new $($.MOUSE_LEAVE,e,s,n))}onRoomObjectStateChangedEvent(t,e){if(t)switch(t.type){case mt.STATE_CHANGE:this.changeObjectState(e,t.object.id,t.object.type,t.state,!1);return;case mt.STATE_RANDOM:this.changeObjectState(e,t.object.id,t.object.type,t.state,!0);return}}onRoomObjectDimmerStateUpdateEvent(t,e){if(t)switch(t.type){case Zo.DIMMER_STATE:this._roomEngine.events.dispatchEvent(new vF(e,t.state,t.presetId,t.effectId,t.color,t.brightness));return}}handleSelectedObjectRemove(t,e){if(!(!t||!this._roomEngine))switch(t.type){case $e.POSITION_CHANGED:{const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i),a=this._roomEngine.getRoomObject(e,s,n),o=this._roomEngine.getRoomObjectSelectionArrow(e);if(a&&o&&o.logic){const h=a.getLocation();o.logic.processUpdateMessage(new ge(h,null))}return}case $e.OBJECT_REMOVED:this.setSelectedAvatar(e,0,!1);return}}onRoomObjectWidgetRequestEvent(t,e){if(!t||!this._roomEngine)return;const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i),a=this._roomEngine.events;if(a&&!XO.isRoomPreviewerId(e))switch(t.type){case C.OPEN_WIDGET:a.dispatchEvent(new G(G.OPEN_WIDGET,e,s,n,t.object.logic.widget));return;case C.CLOSE_WIDGET:a.dispatchEvent(new G(G.CLOSE_WIDGET,e,s,n,t.object.logic.widget));return;case C.OPEN_FURNI_CONTEXT_MENU:a.dispatchEvent(new G(G.OPEN_FURNI_CONTEXT_MENU,e,s,n,t.object.logic.contextMenu));return;case C.CLOSE_FURNI_CONTEXT_MENU:a.dispatchEvent(new G(G.CLOSE_FURNI_CONTEXT_MENU,e,s,n));return;case C.PLACEHOLDER:a.dispatchEvent(new G(G.REQUEST_PLACEHOLDER,e,s,n));return;case C.CREDITFURNI:a.dispatchEvent(new G(G.REQUEST_CREDITFURNI,e,s,n));return;case C.STACK_HEIGHT:a.dispatchEvent(new G(G.REQUEST_STACK_HEIGHT,e,s,n));return;case C.EXTERNAL_IMAGE:a.dispatchEvent(new G(G.REQUEST_EXTERNAL_IMAGE,e,s,n));return;case C.STICKIE:a.dispatchEvent(new G(G.REQUEST_STICKIE,e,s,n));return;case C.PRESENT:a.dispatchEvent(new G(G.REQUEST_PRESENT,e,s,n));return;case C.TROPHY:a.dispatchEvent(new G(G.REQUEST_TROPHY,e,s,n));return;case C.TEASER:a.dispatchEvent(new G(G.REQUEST_TEASER,e,s,n));return;case C.ECOTRONBOX:a.dispatchEvent(new G(G.REQUEST_ECOTRONBOX,e,s,n));return;case C.DIMMER:a.dispatchEvent(new G(G.REQUEST_DIMMER,e,s,n));return;case C.WIDGET_REMOVE_DIMMER:a.dispatchEvent(new G(G.REMOVE_DIMMER,e,s,n));return;case C.CLOTHING_CHANGE:a.dispatchEvent(new G(G.REQUEST_CLOTHING_CHANGE,e,s,n));return;case C.JUKEBOX_PLAYLIST_EDITOR:a.dispatchEvent(new G(G.REQUEST_PLAYLIST_EDITOR,e,s,n));return;case C.MANNEQUIN:a.dispatchEvent(new G(G.REQUEST_MANNEQUIN,e,s,n));return;case C.PET_PRODUCT_MENU:a.dispatchEvent(new Sl(Sl.USE_PRODUCT_FROM_ROOM,e,s,n));return;case C.GUILD_FURNI_CONTEXT_MENU:this._roomEngine.connection.send(new uS(t.objectId,t.object.model.getValue(I.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));return;case C.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:a.dispatchEvent(new G(G.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,e,s,n));return;case C.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:a.dispatchEvent(new G(G.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,e,s,n));return;case C.BACKGROUND_COLOR:a.dispatchEvent(new G(G.REQUEST_BACKGROUND_COLOR,e,s,n));return;case C.MYSTERYBOX_OPEN_DIALOG:a.dispatchEvent(new G(G.REQUEST_MYSTERYBOX_OPEN_DIALOG,e,s,n));return;case C.EFFECTBOX_OPEN_DIALOG:a.dispatchEvent(new G(G.REQUEST_EFFECTBOX_OPEN_DIALOG,e,s,n));return;case C.MYSTERYTROPHY_OPEN_DIALOG:a.dispatchEvent(new G(G.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,e,s,n));return;case C.ACHIEVEMENT_RESOLUTION_OPEN:this._roomEngine.connection.send(new IA(t.objectId,0));return;case C.ACHIEVEMENT_RESOLUTION_ENGRAVING:a.dispatchEvent(new G(G.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,e,s,n));return;case C.ACHIEVEMENT_RESOLUTION_FAILED:a.dispatchEvent(new G(G.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,e,s,n));return;case C.FRIEND_FURNITURE_CONFIRM:a.dispatchEvent(new G(G.REQUEST_FRIEND_FURNITURE_CONFIRM,e,s,n));return;case C.FRIEND_FURNITURE_ENGRAVING:a.dispatchEvent(new G(G.REQUEST_FRIEND_FURNITURE_ENGRAVING,e,s,n));return;case C.BADGE_DISPLAY_ENGRAVING:a.dispatchEvent(new G(G.REQUEST_BADGE_DISPLAY_ENGRAVING,e,s,n));return;case C.HIGH_SCORE_DISPLAY:a.dispatchEvent(new G(G.REQUEST_HIGH_SCORE_DISPLAY,e,s,n));return;case C.HIDE_HIGH_SCORE_DISPLAY:a.dispatchEvent(new G(G.REQUEST_HIDE_HIGH_SCORE_DISPLAY,e,s,n));return;case C.INERNAL_LINK:a.dispatchEvent(new G(G.REQUEST_INTERNAL_LINK,e,s,n));return;case C.ROOM_LINK:a.dispatchEvent(new G(G.REQUEST_ROOM_LINK,e,s,n));return;case C.YOUTUBE:a.dispatchEvent(new G(G.REQUEST_YOUTUBE,e,s,n));return}}onRoomObjectFurnitureActionEvent(t,e){t&&this.useObject(e,t.object.id,t.object.type,t.type)}handleObjectSoundMachineEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),i=this.getSelectedRoomObjectData(e);if(!(i&&i.category===s&&i.id===t.objectId&&i.operation===ut.OBJECT_PLACE))switch(t.type){case w.SOUND_MACHINE_INIT:this._roomEngine.events.dispatchEvent(new Gt(Gt.SOUND_MACHINE_INIT,e,t.objectId,s));return;case w.SOUND_MACHINE_START:this._roomEngine.events.dispatchEvent(new Gt(Gt.SOUND_MACHINE_SWITCHED_ON,e,t.objectId,s));return;case w.SOUND_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new Gt(Gt.SOUND_MACHINE_SWITCHED_OFF,e,t.objectId,s));return;case w.SOUND_MACHINE_DISPOSE:this._roomEngine.events.dispatchEvent(new Gt(Gt.SOUND_MACHINE_DISPOSE,e,t.objectId,s));return}}handleObjectJukeboxEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),i=this.getSelectedRoomObjectData(e);if(!(i&&i.category===s&&i.id===t.objectId&&i.operation===ut.OBJECT_PLACE))switch(t.type){case w.JUKEBOX_INIT:this._roomEngine.events.dispatchEvent(new Gt(Gt.JUKEBOX_INIT,e,t.objectId,s));return;case w.JUKEBOX_START:this._roomEngine.events.dispatchEvent(new Gt(Gt.JUKEBOX_SWITCHED_ON,e,t.objectId,s));return;case w.JUKEBOX_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new Gt(Gt.JUKEBOX_SWITCHED_OFF,e,t.objectId,s));return;case w.JUKEBOX_DISPOSE:this._roomEngine.events.dispatchEvent(new Gt(Gt.JUKEBOX_DISPOSE,e,t.objectId,s));return}}onRoomObjectFloorHoleEvent(t,e){if(t)switch(t.type){case Qe.ADD_HOLE:this._roomEngine.addRoomInstanceFloorHole(e,t.objectId);return;case Qe.REMOVE_HOLE:this._roomEngine.removeRoomInstanceFloorHole(e,t.objectId);return}}onRoomObjectRoomAdEvent(t,e){if(!t)return;let s=null;switch(t.type){case Yt.ROOM_AD_FURNI_CLICK:this._roomEngine.events.dispatchEvent(t),t.clickUrl&&t.clickUrl.length>0&&Q.instance.createLinkEvent(t.clickUrl),s=Di.FURNI_CLICK;break;case Yt.ROOM_AD_FURNI_DOUBLE_CLICK:if(t.clickUrl&&t.clickUrl.length>0){const i="CATALOG_PAGE";t.clickUrl.indexOf(i)===0&&Q.instance.createLinkEvent(t.clickUrl.substr(i.length))}s=Di.FURNI_DOUBLE_CLICK;break;case Yt.ROOM_AD_TOOLTIP_SHOW:s=Di.TOOLTIP_SHOW;break;case Yt.ROOM_AD_TOOLTIP_HIDE:s=Di.TOOLTIP_HIDE;break}s&&this._roomEngine.events.dispatchEvent(new $(s,e,t.objectId,this._roomEngine.getRoomObjectCategoryForType(t.objectType)))}onRoomObjectBadgeAssetEvent(t,e){if(!(!t||!this._roomEngine))switch(t.type){case Ir.LOAD_BADGE:{const s=t.objectId,i=t.objectType,n=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.loadRoomObjectBadgeImage(e,s,n,t.badgeId,t.groupBadge);return}}}handleMousePointer(t,e){t&&this._roomEngine.updateMousePointer(t.type,t.objectId,t.objectType)}handleRoomObjectPlaySoundEvent(t,e){const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case Qr.PLAY_SOUND:this._roomEngine.events.dispatchEvent(new va(va.PLAY_SOUND,e,t.objectId,s,t.soundId,t.pitch));return;case Qr.PLAY_SOUND_AT_PITCH:this._roomEngine.events.dispatchEvent(new va(va.PLAY_SOUND_AT_PITCH,e,t.objectId,s,t.soundId,t.pitch));return}}handleRoomObjectSamplePlaybackEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case ie.ROOM_OBJECT_INITIALIZED:this._roomEngine.events.dispatchEvent(new is(is.ROOM_OBJECT_INITIALIZED,e,t.objectId,s,t.sampleId,t.pitch));break;case ie.ROOM_OBJECT_DISPOSED:this._roomEngine.events.dispatchEvent(new is(is.ROOM_OBJECT_DISPOSED,e,t.objectId,s,t.sampleId,t.pitch));break;case ie.PLAY_SAMPLE:this._roomEngine.events.dispatchEvent(new is(is.PLAY_SAMPLE,e,t.objectId,s,t.sampleId,t.pitch));break;case ie.CHANGE_PITCH:this._roomEngine.events.dispatchEvent(new is(is.CHANGE_PITCH,e,t.objectId,s,t.sampleId,t.pitch));break}}onHSLColorEnableEvent(t,e){if(!(!t||!this._roomEngine))switch(t.type){case yi.ROOM_BACKGROUND_COLOR:this._roomEngine.events.dispatchEvent(new Kd(Kd.ROOM_BACKGROUND_COLOR,e,t.enable,t.hue,t.saturation,t.lightness));return}}onRoomObjectDataRequestEvent(t,e){if(!(!t||!this._roomEngine||!t.object))switch(t.type){case Ns.RODRE_CURRENT_USER_ID:t.object.model.setValue(I.SESSION_CURRENT_USER_ID,this._roomEngine.sessionDataManager.userId);return;case Ns.RODRE_URL_PREFIX:t.object.model.setValue(I.SESSION_URL_PREFIX,at.getValue("url.prefix"));return}}onRoomObjectTileMouseEvent(t,e){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const s=this._roomEngine.roomSessionManager.getSession(t);!s||s.isSpectator||this.sendWalkUpdate(e.tileXAsInt,e.tileYAsInt)}handleObjectMove(t,e){if(!t||!this._roomEngine||!this._roomEngine.events)return;const i=this.getSelectedRoomObjectData(e);if(!i)return;const n=this._roomEngine.getRoomObject(e,i.id,i.category);if(!n)return;let a=!0;if(i.category===L.FLOOR||i.category===L.UNIT){const o=this._roomEngine.getFurnitureStackingHeightMap(e);t instanceof Nr&&this.handleFurnitureMove(n,i,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),o)||(this.handleFurnitureMove(n,i,i.loc.x,i.loc.y,o),a=!1)}else if(i.category===L.WALL){if(a=!1,t instanceof aa){const o=t.wallLocation,h=t.wallWidth,u=t.wallHeight,c=t.x,l=t.y,_=t.direction;this.handleWallItemMove(n,i,o,h,u,c,l,_)&&(a=!0)}a||(n.setLocation(i.loc),n.setDirection(i.dir)),this._roomEngine.updateRoomObjectMask(e,i.id,a)}a?(this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1)):(this.setFurnitureAlphaMultiplier(n,0),this._roomEngine.setObjectMoverIconSpriteVisible(!0))}handleObjectPlace(t,e){if(!t||!this._roomEngine||!this._roomEngine.events)return;let i=this.getSelectedRoomObjectData(e);if(!i)return;let n=this._roomEngine.getRoomObject(e,i.id,i.category);if(!n){if(t instanceof Nr){if(i.category===L.FLOOR)this._roomEngine.addFurnitureFloor(e,i.id,i.typeId,i.loc,i.dir,0,i.stuffData,parseFloat(i.instanceData),-1,0,0,"",!1);else if(i.category===L.UNIT){this._roomEngine.addRoomObjectUser(e,i.id,new S,new S(180),180,i.typeId,i.instanceData);const a=this._roomEngine.getRoomObject(e,i.id,i.category);a&&i.posture&&a.model.setValue(I.FIGURE_POSTURE,i.posture)}}else t instanceof aa&&i.category===L.WALL&&this._roomEngine.addFurnitureWall(e,i.id,i.typeId,i.loc,i.dir,0,i.instanceData,0);if(n=this._roomEngine.getRoomObject(e,i.id,i.category),n&&i.category===L.FLOOR){const a=n.model.getValue(I.FURNITURE_ALLOWED_DIRECTIONS);if(a&&a.length){const o=new S(a[0]);if(n.setDirection(o),this.updateSelectedObjectData(e,i.id,i.category,i.loc,o,i.operation,i.typeId,i.instanceData,i.stuffData,i.state,i.animFrame,i.posture),i=this.getSelectedRoomObjectData(e),!i)return}}this.setFurnitureAlphaMultiplier(n,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(n){let a=!0;const o=this._roomEngine.getFurnitureStackingHeightMap(e);if(i.category===L.FLOOR)t instanceof Nr&&this.handleFurnitureMove(n,i,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),o)||(this._roomEngine.removeRoomObjectFloor(e,i.id),a=!1);else if(i.category===L.WALL){if(a=!1,t instanceof aa){const h=t.wallLocation,u=t.wallWidth,c=t.wallHeight,l=t.x,_=t.y,d=t.direction;this.handleWallItemMove(n,i,h,u,c,l,_,d)&&(a=!0)}a||this._roomEngine.removeRoomObjectWall(e,i.id),this._roomEngine.updateRoomObjectMask(e,i.id,a)}else i.category===L.UNIT&&(t instanceof Nr&&this.handleUserPlace(n,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),this._roomEngine.getLegacyWallGeometry(e))||(this._roomEngine.removeRoomObjectUser(e,i.id),a=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!a)}}handleFurnitureMove(t,e,s,i,n){if(!t||!e)return!1;const a=new S;a.assign(t.getDirection()),t.setDirection(e.dir);const o=new S(s,i,0),h=new S;h.assign(t.getDirection());let u=this.validateFurnitureLocation(t,o,e.loc,e.dir,n);return u||(h.x=this.getValidRoomObjectDirection(t,!0),t.setDirection(h),u=this.validateFurnitureLocation(t,o,e.loc,e.dir,n)),u?(t.setLocation(u),h&&t.setDirection(h),!0):(t.setDirection(a),!1)}handleWallItemMove(t,e,s,i,n,a,o,h){if(!t||!e)return!1;const u=new S(h),c=this.validateWallItemLocation(t,s,i,n,a,o,e);return c?(t.setLocation(c),t.setDirection(u),!0):!1}validateFurnitureLocation(t,e,s,i,n){if(!t||!t.model||!e)return null;let a=null;const o=t.getDirection();if(!o||!s||!i)return null;if(e.x===s.x&&e.y===s.y&&o.x===i.x)return a=new S,a.assign(s),a;let h=t.model.getValue(I.FURNITURE_SIZE_X),u=t.model.getValue(I.FURNITURE_SIZE_Y);h<1&&(h=1),u<1&&(u=1);const c=s.x,l=s.y;let _=h,d=u,f=0,m=Math.trunc(Math.trunc(o.x+45)%360/90);if((m===1||m===3)&&(f=h,h=u,u=f),m=Math.trunc(Math.trunc(i.x+45)%360/90),(m===1||m===3)&&(f=_,_=d,d=f),n&&e){const p=t.model.getValue(I.FURNITURE_ALWAYS_STACKABLE)===1;return n.validateLocation(e.x,e.y,h,u,c,l,_,d,p)?new S(e.x,e.y,n.getTileHeight(e.x,e.y)):null}return null}validateWallItemLocation(t,e,s,i,n,a,o){if(t==null||t.model==null||e==null||s==null||i==null||o==null)return null;const h=t.model.getValue(I.FURNITURE_SIZE_X),u=t.model.getValue(I.FURNITURE_SIZE_Z),c=t.model.getValue(I.FURNITURE_CENTER_Z);if((n<h/2||n>s.length-h/2||a<c||a>i.length-(u-c))&&(n<h/2&&n<=s.length-h/2?n=h/2:n>=h/2&&n>s.length-h/2&&(n=s.length-h/2),a<c&&a<=i.length-(u-c)?a=c:a>=c&&a>i.length-(u-c)&&(a=i.length-(u-c))),n<h/2||n>s.length-h/2||a<c||a>i.length-(u-c))return null;let l=S.sum(S.product(s,n/s.length),S.product(i,a/i.length));return l=S.sum(e,l),l}changeObjectState(t,e,s,i,n){const a=this._roomEngine.getRoomObjectCategoryForType(s);this.changeRoomObjectState(t,e,a,i,n)}useObject(t,e,s,i){if(!(!this._roomEngine||!this._roomEngine.connection))switch(i){case w.DICE_ACTIVATE:this._roomEngine.connection.send(new fS(e));return;case w.DICE_OFF:this._roomEngine.connection.send(new gS(e));return;case w.USE_HABBOWHEEL:this._roomEngine.connection.send(new dS(e));return;case w.STICKIE:this._roomEngine.connection.send(new ZA(e));return;case w.ENTER_ONEWAYDOOR:this._roomEngine.connection.send(new ES(e));return}}changeRoomObjectState(t,e,s,i,n){return!this._roomEngine||!this._roomEngine.connection||(s===L.FLOOR?n?this._roomEngine.connection.send(new pS(e,i)):this._roomEngine.connection.send(new gE(e,i)):s===L.WALL&&this._roomEngine.connection.send(new mS(e,i))),!0}sendWalkUpdate(t,e){!this._roomEngine||!this._roomEngine.connection||this._roomEngine.connection.send(new LS(t,e))}handleMouseOverObject(t,e,s){if(t!==L.FLOOR)return null;const i=this._roomEngine.getRoomObject(e,s.objectId,L.FLOOR);if(!i)return null;const n=this.getActiveSurfaceLocation(i,s);if(!n||!this._roomEngine.getFurnitureStackingHeightMap(e))return null;const o=n.x,h=n.y,u=n.z;return new ha(new S(o,h,i.getLocation().z),u,!0,s.eventId)}handleMoveTargetFurni(t,e){if(e.objectType===Dt.USER||e.objectType===Dt.PET||e.objectType===Dt.BOT||e.objectType===Dt.RENTABLE_BOT||e.objectType===Dt.MONSTER_PLANT)return;const s=this._roomEngine.getRoomObject(t,e.objectId,L.FLOOR),i=this.getActiveSurfaceLocation(s,e);return i?(this.sendWalkUpdate(i.x,i.y),!0):!1}getActiveSurfaceLocation(t,e){if(!t||!e)return null;const s=this._roomEngine.sessionDataManager.getFloorItemDataByName(t.type);if(!s||!s.canStandOn&&!s.canSitOn&&!s.canLayOn)return null;const i=t.model;if(!i)return null;const n=t.getLocation(),a=t.getDirection();let o=i.getValue(I.FURNITURE_SIZE_X),h=i.getValue(I.FURNITURE_SIZE_Y);const u=i.getValue(I.FURNITURE_SIZE_Z);(a.x===90||a.x===270)&&([o,h]=[h,o]),o<1&&(o=1),h<1&&(h=1);const c=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!c)return null;const l=c.geometry.scale,_=s.canSitOn?.5:0,d=(l/2+e.spriteOffsetX+e.localX)/(l/4),f=(e.spriteOffsetY+e.localY+(u-_)*l/2)/(l/4),m=(d+2*f)/4,p=(d-2*f)/4,T=Math.floor(n.x+m),v=Math.floor(n.y-p+1);let O=!1;(T<n.x||T>=n.x+o||v<n.y||v>=n.y+h)&&(O=!0);const A=s.canSitOn?u-.5:u;return O?null:new S(T,v,A)}handleMouseOverTile(t,e){if(this._whereYouClickIsWhereYouGo)return new ha(new S(t.tileXAsInt,t.tileYAsInt,t.tileZAsInt),0,!0,t.eventId);const s=this._roomEngine.getRoomObjectCursor(e);if(s&&s.visualization){const i=t.tileXAsInt,n=t.tileYAsInt,a=t.tileZAsInt;if(this._roomEngine.getRoomInstance(e)){const h=this._roomEngine.getRoomTileObjectMap(e);if(h){const u=h.getObjectIntTile(i,n),c=this._roomEngine.getFurnitureStackingHeightMap(e);if(c){if(u&&u.model&&u.model.getValue(I.FURNITURE_IS_VARIABLE_HEIGHT)>0){const l=c.getTileHeight(i,n),_=this._roomEngine.getLegacyWallGeometry(e).getHeight(i,n);return new ha(new S(i,n,a),l-_,!0,t.eventId)}return new ha(new S(i,n,a),0,!0,t.eventId)}}}}return null}placeObject(t,e,s){const i=this.getSelectedRoomObjectData(t);if(!i)return;let n=null,a=i.id;const o=i.category;let h=0,u=0,c=0,l=0,_="";if(this._roomEngine&&this._roomEngine.connection&&(n=this._roomEngine.getRoomObject(t,a,o),n)){const d=n.getLocation();if(l=n.getDirection().x,o===L.FLOOR||o===L.UNIT)h=d.x,u=d.y,c=d.z;else if(o===L.WALL){h=d.x,u=d.y,c=d.z;const f=this._roomEngine.getLegacyWallGeometry(t);f&&(_=f.getOldLocationString(d,l))}l=(l/45%8+8)%8,a<0&&o===L.UNIT&&(a=a*-1),this._objectPlacementSource!==Vg.CATALOG&&(o===L.UNIT?i.typeId===Ys.PET?this._roomEngine.connection.send(new $A(a,Math.trunc(h),Math.trunc(u))):i.typeId===Ys.RENTABLE_BOT&&this._roomEngine.connection.send(new XA(a,Math.trunc(h),Math.trunc(u))):n.model.getValue(I.FURNITURE_IS_STICKIE)!==void 0?this._roomEngine.connection.send(new cS(a,_)):this._roomEngine.connection.send(new _S(a,o,_,Math.trunc(h),Math.trunc(u),l)))}if(this._roomEngine.setPlacedRoomObjectData(t,new td(i.id,i.category,null,i.dir,null)),this.resetSelectedObjectData(t),this._roomEngine&&this._roomEngine.events){const d=n&&n.id===i.id;this._roomEngine.events.dispatchEvent(new AF($.PLACED,t,a,o,_,h,u,c,l,d,e,s,i.instanceData))}}modifyRoomObject(t,e,s,i){if(!this._roomEngine)return!1;const n=this._roomEngine.getRoomObject(t,e,s);if(!n)return!1;let a=!0;switch(i){case ut.OBJECT_ROTATE_POSITIVE:case ut.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){let o=0;i==ut.OBJECT_ROTATE_NEGATIVE?o=this.getValidRoomObjectDirection(n,!1):o=this.getValidRoomObjectDirection(n,!0);const h=n.getLocation().x,u=n.getLocation().y;if(this.isValidLocation(n,new S(o),this._roomEngine.getFurnitureStackingHeightMap(t)))if(o=Math.trunc(o/45),n.type===Dt.MONSTER_PLANT){const c=this._roomEngine.roomSessionManager.getSession(t);if(c){const l=c.userDataManager.getUserDataByIndex(e);l&&this._roomEngine.connection.send(new Jf(l.webID,Math.trunc(h),Math.trunc(u),o))}}else this._roomEngine.connection.send(new $f(e,h,u,o))}break;case ut.OBJECT_EJECT:case ut.OBJECT_PICKUP:this._roomEngine.connection&&this._roomEngine.connection.send(new lS(s,e));break;case ut.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const o=this._roomEngine.roomSessionManager.getSession(t);if(o){const h=o.userDataManager.getUserDataByIndex(e);o.pickupPet(h.webID)}}break;case ut.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const o=this._roomEngine.roomSessionManager.getSession(t);if(o){const h=o.userDataManager.getUserDataByIndex(e);o.pickupBot(h.webID)}}break;case ut.OBJECT_MOVE:a=!1,this.setFurnitureAlphaMultiplier(n,.5),this.setSelectedRoomObjectData(t,n.id,s,n.getLocation(),n.getDirection(),i),this._roomEngine.setObjectMoverIconSprite(n.id,s,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case ut.OBJECT_MOVE_TO:{const o=this.getSelectedRoomObjectData(t);if(this.updateSelectedObjectData(t,o.id,o.category,o.loc,o.dir,ut.OBJECT_MOVE_TO,o.typeId,o.instanceData,o.stuffData,o.state,o.animFrame,o.posture),this.setFurnitureAlphaMultiplier(n,1),this._roomEngine.removeObjectMoverIconSprite(),this._roomEngine.connection){if(s===L.FLOOR){const h=n.getDirection().x%360,u=n.getLocation(),c=h/45;this._roomEngine.connection.send(new $f(e,u.x,u.y,c))}else if(s===L.WALL){const h=n.getDirection().x%360,u=this._roomEngine.getLegacyWallGeometry(t);if(u){const c=u.getOldLocationString(n.getLocation(),h);c&&this._roomEngine.connection.send(new RS(e,c))}}else if(s===L.UNIT){const h=n.getDirection().x%360,u=n.getLocation(),c=h/45;parseInt(n.model.getValue(I.RACE));const l=this._roomEngine.roomSessionManager.getSession(t);if(l){const _=l.userDataManager.getUserDataByIndex(e);_&&this._roomEngine.connection.send(new Jf(_.webID,u.x,u.y,c))}}}break}}return a&&this.resetSelectedObjectData(t),!0}modifyRoomObjectDataWithMap(t,e,s,i,n){if(!this._roomEngine||!this._roomEngine.getRoomObject(t,e,s))return!1;switch(i){case ut.OBJECT_SAVE_STUFF_DATA:this._roomEngine.connection&&this._roomEngine.connection.send(new iS(e,n));break}return!0}modifyWallItemData(t,e,s,i){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new rS(e,s,i)),!0)}deleteWallItem(t,e){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new eS(e)),!0)}getValidRoomObjectDirection(t,e){if(!t||!t.model)return 0;let s=0,i=0,n=[];t.type===Dt.MONSTER_PLANT?n=t.model.getValue(I.PET_ALLOWED_DIRECTIONS):n=t.model.getValue(I.FURNITURE_ALLOWED_DIRECTIONS);let a=t.getDirection().x;if(n&&n.length){if(s=n.indexOf(a),s<0){for(s=0,i=0;i<n.length&&!(a<=n[i]);)s++,i++;s=s%n.length}e?s=(s+1)%n.length:s=(s-1+n.length)%n.length,a=n[s]}return a}isValidLocation(t,e,s){if(!t||!t.model||!e)return!1;const i=t.getDirection(),n=t.getLocation();if(!i||!n)return!1;if(i.x%180===e.x%180)return!0;let a=t.model.getValue(I.FURNITURE_SIZE_X),o=t.model.getValue(I.FURNITURE_SIZE_Y);a<1&&(a=1),o<1&&(o=1);let h=a,u=o,c=Math.trunc(Math.trunc(e.x+45)%360/90);if((c===1||c===3)&&([a,o]=[o,a]),c=Math.trunc(Math.trunc(i.x+45)%360/90),(c===1||c===3)&&([h,u]=[u,h]),s&&n){const l=t.model.getValue(I.FURNITURE_ALWAYS_STACKABLE)===1;if(s.validateLocation(n.x,n.y,a,o,n.x,n.y,h,u,l,n.z))return!0}return!1}placeObjectOnUser(t,e,s){const i=this.getSelectedRoomObjectData(t);!i||!this._roomEngine.getRoomObject(t,e,s)||!this._roomEngine||!this._roomEngine.events||this._roomEngine.events.dispatchEvent(new SF($.PLACED_ON_USER,t,e,s,i.id,i.category))}setSelectedObject(t,e,s){if(!this._roomEngine)return;const i=this._roomEngine.events;if(i)switch(s){case L.UNIT:case L.FLOOR:case L.WALL:if(s===L.UNIT)this.deselectObject(t),this.setSelectedAvatar(t,e,!0);else if(this.setSelectedAvatar(t,0,!1),e!==this._selectedObjectId){this.deselectObject(t);const n=this._roomEngine.getRoomObject(t,e,s);n&&n.logic&&(n.logic.processUpdateMessage(new Ih(!0)),this._selectedObjectId=e,this._selectedObjectCategory=s)}i.dispatchEvent(new $($.SELECTED,t,e,s));return}}deselectObject(t){if(this._selectedObjectId===-1)return;const e=this._roomEngine.getRoomObject(t,this._selectedObjectId,this._selectedObjectCategory);e&&e.logic&&(e.logic.processUpdateMessage(new Ih(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=L.MINIMUM)}setSelectedAvatar(t,e,s){if(!this._roomEngine)return;const i=L.UNIT,n=this._roomEngine.getRoomObject(t,this._selectedAvatarId,i);n&&n.logic&&(n.logic.processUpdateMessage(new Hl(!1)),this._selectedAvatarId=-1);let a=!1;if(s){const h=this._roomEngine.getRoomObject(t,e,i);if(h&&h.logic){h.logic.processUpdateMessage(new Hl(!0)),a=!0,this._selectedAvatarId=e;const u=h.getLocation();u&&this._roomEngine.connection.send(new bS(~~u.x,~~u.y))}}const o=this._roomEngine.getRoomObjectSelectionArrow(t);o&&o.logic&&(a&&!this._roomEngine.isPlayingGame()?o.logic.processUpdateMessage(new ei(ei.ENABLED)):o.logic.processUpdateMessage(new ei(ei.DISABLED)))}resetSelectedObjectData(t){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const e=this.getSelectedRoomObjectData(t);if(e){if(e.operation===ut.OBJECT_MOVE||e.operation===ut.OBJECT_MOVE_TO){const s=this._roomEngine.getRoomObject(t,e.id,e.category);s&&e.operation!==ut.OBJECT_MOVE_TO&&(s.setLocation(e.loc),s.setDirection(e.dir)),this.setFurnitureAlphaMultiplier(s,1),e.category===L.WALL&&this._roomEngine.updateRoomObjectMask(t,e.id,!0),this.updateSelectedObjectData(t,e.id,e.category,e.loc,e.dir,ut.OBJECT_MOVE,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture)}else if(e.operation===ut.OBJECT_PLACE){const s=e.id;switch(e.category){case L.FLOOR:this._roomEngine.removeRoomObjectFloor(t,s);break;case L.WALL:this._roomEngine.removeRoomObjectWall(t,s);break;case L.UNIT:this._roomEngine.removeRoomObjectUser(t,s);break}}this._roomEngine.setSelectedRoomObjectData(t,null)}}getSelectedRoomObjectData(t){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(t):null}setFurnitureAlphaMultiplier(t,e){!t||!t.model||t.model.setValue(I.FURNITURE_ALPHA_MULTIPLIER,e)}decorateModeMove(t){return this._roomEngine.isDecorating&&!(t.ctrlKey||t.shiftKey)}cancelRoomObjectPlacement(t){return this.resetSelectedObjectData(t),!0}setSelectedRoomObjectData(t,e,s,i,n,a,o=0,h=null,u=null,c=-1,l=-1,_=null){if(this.resetSelectedObjectData(t),!this._roomEngine)return;const d=new td(e,s,a,i,n,o,h,u,c,l,_);this._roomEngine.setSelectedRoomObjectData(t,d)}updateSelectedObjectData(t,e,s,i,n,a,o=0,h=null,u=null,c=-1,l=-1,_=null){if(!this._roomEngine)return null;const d=new td(e,s,a,i,n,o,h,u,c,l,_);this._roomEngine.setSelectedRoomObjectData(t,d)}handleUserPlace(t,e,s,i){return i.isRoomTile(e,s)?(t.setLocation(new S(e,s,i.getHeight(e,s))),!0):!1}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}}class Get{constructor(){this._events=new vs,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(t){const e=this.getLogicType(t);if(!e)return null;const s=new e;if(!s)return null;if(s.eventDispatcher=this._events,!this._cachedEvents.get(t)){this._cachedEvents.set(t,!0);const i=s.getEventTypes();for(const n of i)n&&this.registerEventType(n)}return s}registerEventType(t){if(!this._registeredEvents.get(t)){this._registeredEvents.set(t,!0);for(const e of this._functions)e&&this._events.addEventListener(t,e)}}registerEventFunction(t){if(t&&!(this._functions.indexOf(t)>=0)){this._functions.push(t);for(const e of this._registeredEvents.keys())e&&this._events.addEventListener(e,t)}}removeEventFunction(t){if(!t)return;const e=this._functions.indexOf(t);if(e!==-1){this._functions.splice(e,1);for(const s of this._registeredEvents.keys())s&&this._events.removeEventListener(s,t)}}getLogicType(t){if(!t)return null;let e=null;switch(t){case U.ROOM:e=Rtt;break;case U.TILE_CURSOR:e=vtt;break;case U.SELECTION_ARROW:e=Ott;break;case U.USER:case U.BOT:case U.RENTABLE_BOT:e=WJ;break;case U.PET:e=ptt;break;case U.FURNITURE_BASIC:e=Nt;break;case U.FURNITURE_BADGE_DISPLAY:e=Oy;break;case U.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:e=KJ;break;case U.FURNITURE_COUNTER_CLOCK:e=QJ;break;case U.FURNITURE_CRACKABLE:e=ZJ;break;case U.FURNITURE_CREDIT:e=$J;break;case U.FURNITURE_CUSTOM_STACK_HEIGHT:e=e$;break;case U.FURNITURE_DICE:e=s$;break;case U.FURNITURE_EDITABLE_INTERNAL_LINK:e=i$;break;case U.FURNITURE_EDITABLE_ROOM_LINK:e=n$;break;case U.FURNITURE_EXTERNAL_IMAGE_WALLITEM:e=o$;break;case U.FURNITURE_FIREWORKS:e=h$;break;case U.FURNITURE_FLOOR_HOLE:e=u$;break;case U.FURNITURE_GUILD_CUSTOMIZED:e=Sy;break;case U.FURNITURE_HIGH_SCORE:e=c$;break;case U.FURNITURE_HOCKEY_SCORE:e=d$;break;case U.FURNITURE_ES:e=g$;break;case U.FURNITURE_MANNEQUIN:e=I$;break;case U.FURNITURE_MULTIHEIGHT:e=R$;break;case U.FURNITURE_MULTISTATE:e=he;break;case U.FURNITURE_ONE_WAY_DOOR:e=A$;break;case U.FURNITURE_PET_CUSTOMIZATION:e=S$;break;case U.FURNITURE_PRESENT:e=C$;break;case U.FURNITURE_PURCHASABLE_CLOTHING:e=N$;break;case U.FURNITURE_PUSHABLE:e=b$;break;case U.FURNITURE_BACKGROUND_COLOR:e=U$;break;case U.FURNITURE_BG:e=rtt;break;case U.FURNITURE_BB:e=itt;break;case U.FURNITURE_ROOMDIMMER:e=ntt;break;case U.FURNITURE_SCORE:e=att;break;case U.FURNITURE_SOUNDBLOCK:e=htt;break;case U.FURNITURE_STICKIE:e=ltt;break;case U.FURNITURE_TROPHY:e=_tt;break;case U.FURNITURE_VOTE_COUNTER:e=ctt;break;case U.FURNITURE_VOTE_MAJORITY:e=dtt;break;case U.FURNITURE_WINDOW:e=gtt;break;case U.FURNITURE_LOVELOCK:e=m$;break;case U.FURNITURE_YOUTUBE:e=Ett;break;case U.FURNITURE_CRAFTING_GIZMO:e=JJ;break;case U.FURNITURE_RENTABLE_SPACE:e=L$;break;case U.FURNITURE_EFFECTBOX:e=a$;break;case U.FURNITURE_MONSTERPLANT_SEED:e=T$;break;case U.FURNITURE_MYSTERYBOX:e=O$;break;case U.FURNITURE_MYSTERYTROPHY:e=v$;break;case U.FURNITURE_RANDOM_TELEPORT:e=D$;break;case U.FURNITURE_CLOTHING_CHANGE:e=qJ;break;case U.FURNITURE_CUCKOO_CLOCK:e=t$;break;case U.FURNITURE_ECOTRON_BOX:e=r$;break;case U.FURNITURE_GROUP_FORUM_TERMINAL:e=l$;break;case U.FURNITURE_HWEEN_LOVELOCK:e=f$;break;case U.FURNITURE_INTERNAL_LINK:e=E$;break;case U.FURNITURE_JUKEBOX:e=p$;break;case U.FURNITURE_PLACEHOLDER:e=y$;break;case U.FURNITURE_PLANET_SYSTEM:e=M$;break;case U.FURNITURE_RANDOMSTATE:e=P$;break;case U.FURNITURE_SONG_DISK:e=ott;break;case U.FURNITURE_SOUND_MACHINE:e=utt;break;case U.FURNITURE_WELCOME_GIFT:e=ftt;break;case U.FURNITURE_ACHIEVEMENT_RESOLUTION:e=XJ;break;case U.FURNITURE_HABBOWHEEL:e=_$;break;default:e=Nt;break}return e||(Y.warn("Unknown Logic",t),null)}get events(){return this._events}}const Js=class jt extends Rr{constructor(t){super(),this._communication=t,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new wet(this),this._roomMessageHandler=new Fet(this),this._roomContentLoader=new Ju,this._ready=!1,this._roomContentLoaderReady=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new Xw,this._visualizationFactory=new Net,this._logicFactory=new Get,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onRoomContentLoaderReadyEvent=this.onRoomContentLoaderReadyEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}onInit(){this._ready||(this._imageObjectIdBank=new hI(1e3),this._thumbnailObjectIdBank=new hI(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(L.FLOOR),this._roomManager.addUpdateCategory(L.WALL),this._roomManager.addUpdateCategory(L.UNIT),this._roomManager.addUpdateCategory(L.CURSOR),this._roomManager.addUpdateCategory(L.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(ot.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(ot.ENDED,this.onRoomSessionEvent)),this.events.addEventListener(Ju.LOADER_READY,this.onRoomContentLoaderReadyEvent),Xr().add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate))}onDispose(){if(this._ready){for(const[t,e]of this._roomInstanceDatas)this.removeRoomInstance(t);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),Xr().remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomContentLoader&&this._roomContentLoader.dispose(),this.events.removeEventListener(Ju.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(ot.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(ot.ENDED,this.onRoomSessionEvent)),super.onDispose()}}onRoomSessionEvent(t){if(t instanceof ot)switch(t.type){case ot.STARTED:this._roomMessageHandler&&this._roomMessageHandler.setRoomId(t.session.roomId);return;case ot.ENDED:this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(t.session.roomId));return}}onRoomContentLoaderReadyEvent(t){this._roomContentLoaderReady=!0,this._roomManager.init()}setActiveRoomId(t){this._activeRoomId=t}destroyRoom(t){this.removeRoomInstance(t)}getRoomInstance(t){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(t))||null}removeRoomInstance(t){this.getRoomInstance(t)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(t));const s=this._roomInstanceDatas.get(t);s&&(this._roomInstanceDatas.delete(s.roomId),s.dispose()),this.events.dispatchEvent(new At(At.DISPOSED,t))}createRoomInstance(t,e){let s="111",i="201",n="1";if(!this._ready){let h=this._roomDatas.get(t);h&&(this._roomDatas.delete(t),s=h.floorType,i=h.wallType,n=h.landscapeType),h=new AI(t,e),h.floorType=s,h.wallType=i,h.landscapeType=n,this._roomDatas.set(t,h),Y.warn("Room Engine not initilized yet, can not create room. Room data stored for later initialization.");return}if(!e){Y.warn("Room property messages");return}const a=this._roomDatas.get(t);a&&(this._roomDatas.delete(t),a.floorType&&(s=a.floorType),a.wallType&&(i=a.wallType),a.landscapeType&&(n=a.landscapeType)),this.setupRoomInstance(t,e,s,i,n,this.getRoomInstanceModelName(t))&&(e.restrictsDragging?this._roomAllowsDragging=!1:this._roomAllowsDragging=!0,this.events.dispatchEvent(new At(At.INITIALIZED,t)))}setupRoomInstance(t,e,s,i,n,a){if(!this._ready||!this._roomManager)return;const o=this._roomManager.createRoomInstance(this.getRoomId(t));if(!o)return null;const h=L.ROOM,u=o.createRoomObjectAndInitalize(jt.ROOM_OBJECT_ID,jt.ROOM_OBJECT_TYPE,h);if(o.model.setValue(zt.ROOM_IS_PUBLIC,0),o.model.setValue(zt.ROOM_Z_SCALE,1),e&&(o.model.setValue(zt.RESTRICTS_DRAGGING,e.restrictsDragging),o.model.setValue(zt.RESTRICTS_SCALING,e.restrictsScaling),o.model.setValue(zt.RESTRICTED_SCALE,e.restrictedScale),e.dimensions)){const _=e.dimensions.minX,d=e.dimensions.maxX,f=e.dimensions.minY,m=e.dimensions.maxY;o.model.setValue(zt.ROOM_MIN_X,_),o.model.setValue(zt.ROOM_MAX_X,d),o.model.setValue(zt.ROOM_MIN_Y,f),o.model.setValue(zt.ROOM_MAX_Y,m);const p=Math.trunc(_*423+d*671+f*913+m*7509);u&&u.model&&u.model.setValue(I.ROOM_RANDOM_SEED,p)}const c=u&&u.logic||null;if(c&&(c.initialize(e),s&&(c.processUpdateMessage(new Ae(Ae.ROOM_FLOOR_UPDATE,s)),o.model.setValue(I.ROOM_FLOOR_TYPE,s)),i&&(c.processUpdateMessage(new Ae(Ae.ROOM_WALL_UPDATE,i)),o.model.setValue(I.ROOM_WALL_TYPE,i)),n&&(c.processUpdateMessage(new Ae(Ae.ROOM_LANDSCAPE_UPDATE,n)),o.model.setValue(I.ROOM_LANDSCAPE_TYPE,n))),e&&e.doors.length){let l=0;for(;l<e.doors.length;){const _=e.doors[l];if(_){const d=_.x,f=_.y,m=_.z,p=_.dir,T=Se.DOOR,v="door_"+l,O=new S(d,f,m);c.processUpdateMessage(new Se(Se.ADD_MASK,v,T,O,Se.HOLE)),(p===90||p===180)&&(p===90&&(o.model.setValue(I.ROOM_DOOR_X,d-.5),o.model.setValue(I.ROOM_DOOR_Y,f)),p===180&&(o.model.setValue(I.ROOM_DOOR_X,d),o.model.setValue(I.ROOM_DOOR_Y,f-.5)),o.model.setValue(I.ROOM_DOOR_Z,m),o.model.setValue(I.ROOM_DOOR_DIR,p))}l++}}return o.createRoomObjectAndInitalize(jt.CURSOR_OBJECT_ID,jt.CURSOR_OBJECT_TYPE,L.CURSOR),at.getValue("enable.avatar.arrow",!1)&&o.createRoomObjectAndInitalize(jt.ARROW_OBJECT_ID,jt.ARROW_OBJECT_TYPE,L.CURSOR),o}getRoomInstanceDisplay(t,e,s,i,n){const a=this.getRoomInstance(t);if(!a)return null;let o=a.renderer;if(!o&&(o=this._roomRendererFactory.createRenderer(),!o))return null;o.roomObjectVariableAccurateZ=I.OBJECT_ACCURATE_Z_VALUE,a.setRenderer(o);const h=o.createCanvas(e,s,i,n);if(!h)return null;if(a.model.getValue(zt.RESTRICTS_SCALING)){let c=a.model.getValue(zt.RESTRICTED_SCALE);c||(c=1),h.setScale(c),h.restrictsScaling=!0}else h.restrictsScaling=!1;if(h.setMouseListener(this._roomObjectEventHandler),h.geometry){h.geometry.z_scale=a.model.getValue(zt.ROOM_Z_SCALE);const c=a.model.getValue(I.ROOM_DOOR_X),l=a.model.getValue(I.ROOM_DOOR_Y),_=a.model.getValue(I.ROOM_DOOR_Z),d=a.model.getValue(I.ROOM_DOOR_DIR),f=new S(c,l,_);let m=null;d===90&&(m=new S(-2e3,0,0)),d===180&&(m=new S(0,-2e3,0)),h.geometry.setDisplacement(f,m);const p=h.master;if(p){const T=new te(_t.EMPTY);T.name=jt.OVERLAY,T.interactive=!1,p.addChild(T)}}return h.master}setRoomInstanceRenderingCanvasMask(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);i&&i.setMask(s)}setRoomInstanceRenderingCanvasScale(t,e,s,i=null,n=null,a=!1,o=!1){const h=this.getRoomInstanceRenderingCanvas(t,e);if(h){if(h.restrictsScaling&&!a)return;h.setScale(s,i,n,a,o),this.events.dispatchEvent(new At(At.ROOM_ZOOMED,t))}}getRoomInstanceRenderingCanvas(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;e===-1&&(e=this._activeRoomActiveCanvas);const n=i.getCanvas(e);return n||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(t,e=-1){e===-1&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new B(s.screenOffsetX,s.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);if(!i||!s)return!1;const n=~~s.x,a=~~s.y;if(!(i.screenOffsetX===n&&i.screenOffsetY===a))return this.events.dispatchEvent(new OF(t,-(i.screenOffsetX-n),-(i.screenOffsetY-a))),i.screenOffsetX=n,i.screenOffsetY=a,!0}getRoomInstanceRenderingCanvasScale(t=-1e3,e=-1){t===-1e3&&(t=this._activeRoomId),e===-1&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?s.scale:1}initializeRoomInstanceRenderingCanvas(t,e,s,i){const n=this.getRoomInstanceRenderingCanvas(t,e);n&&n.initialize(s,i)}getRoomInstanceGeometry(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;e===-1&&(e=this._activeRoomActiveCanvas);const n=i.getCanvas(e);return n?n.geometry:null}getRoomInstanceVariable(t,e){const s=this.getRoomInstance(t);return s&&s.model&&s.model.getValue(e)||null}updateRoomInstancePlaneVisibility(t,e,s=!0){const i=this.getRoomOwnObject(t);return i?(i.processUpdateMessage(new ti(ti.WALL_VISIBILITY,e)),i.processUpdateMessage(new ti(ti.FLOOR_VISIBILITY,s)),!0):!1}updateRoomInstancePlaneThickness(t,e,s){const i=this.getRoomOwnObject(t);return i?(i.processUpdateMessage(new $r($r.WALL_THICKNESS,e)),i.processUpdateMessage(new $r($r.FLOOR_THICKNESS,s)),!0):!1}updateRoomInstancePlaneType(t,e=null,s=null,i=null,n=!1){const a=this.getRoomOwnObject(t),o=this.getRoomInstance(t);if(!a){let h=this._roomDatas.get(t);return h||(h=new AI(t,null),this._roomDatas.set(t,h)),e&&(h.floorType=e),s&&(h.wallType=s),i&&(h.landscapeType=i),!0}return e&&(o&&!n&&o.model.setValue(I.ROOM_FLOOR_TYPE,e),a.processUpdateMessage(new Ae(Ae.ROOM_FLOOR_UPDATE,e))),s&&(o&&!n&&o.model.setValue(I.ROOM_WALL_TYPE,s),a.processUpdateMessage(new Ae(Ae.ROOM_WALL_UPDATE,s))),i&&(o&&!n&&o.model.setValue(I.ROOM_LANDSCAPE_TYPE,i),a.processUpdateMessage(new Ae(Ae.ROOM_LANDSCAPE_UPDATE,i))),!0}updateObjectRoomColor(t,e,s,i){const n=this.getRoomOwnObject(t);if(!n||!n.logic)return!1;const a=new kl(kl.BACKGROUND_COLOR,e,s,i);return n.logic.processUpdateMessage(a),this.events.dispatchEvent(new RF(t,e,s,i)),!0}addRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t),i=this.getRoomObjectFloor(t,e);if(s&&s.logic&&i&&i.model){const n=i.getLocation(),a=i.model.getValue(I.FURNITURE_SIZE_X),o=i.model.getValue(I.FURNITURE_SIZE_Y);s.processUpdateMessage(new Jr(Jr.ADD,e,n.x,n.y,a,o))}}removeRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t);s&&s.processUpdateMessage(new Jr(Jr.REMOVE,e))}setRoomEngineGameMode(t,e){const s=this.getRoomInstance(t);if(!s)return;const i=e?1:0;s.model.setValue(zt.IS_PLAYING_GAME,i),i===0?this.events.dispatchEvent(new At(At.NORMAL_MODE,t)):this.events.dispatchEvent(new At(At.GAME_MODE,t))}isRoomIdPlayingGame(t){const e=this.getRoomInstance(t);return e?e.model.getValue(zt.IS_PLAYING_GAME)>0:!1}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}disableUpdate(t){t?Xr().remove(this.update,this):(Xr().remove(this.update,this),Xr().add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(t,e=!1){this._roomManager&&(t=ft(),Ci.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(t,e),this.updateRoomCameras(t),this._mouseCursorUpdate&&this.setPointer(),Ci.turnVisualizationOff())}setPointer(){this._mouseCursorUpdate=!1;const t=this.getRoomInstanceData(this._activeRoomId);t&&t.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame){this._skipFurnitureCreationForNextFrame=!1;return}const t=new Date().valueOf(),e=5;for(const s of this._roomInstanceDatas.values()){if(!s)continue;let i=null,n=0,a=!1;for(;i=s.getNextPendingFurnitureFloor();)if(a=this.processPendingFurnitureFloor(s.roomId,i.id,i),!(++n%e)&&new Date().valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(i=s.getNextPendingFurnitureWall());)if(a=this.processPendingFurnitureWall(s.roomId,i.id,i),!(++n%e)&&new Date().valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(a&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(s.roomId)).hasUninitializedObjects()||this.objectsInitialized(s.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}onRoomEngineInitalized(t){if(t){this._ready=!0,this.events.dispatchEvent(new At(At.ENGINE_INITIALIZED,0));for(const e of this._roomDatas.values())e&&this.createRoomInstance(e.roomId,e.data)}}processPendingFurnitureFloor(t,e,s){if(!s){const h=this.getRoomInstanceData(t);if(h&&(s=h.getPendingFurnitureFloor(e)),!s)return!1}let i=s.type;i||(i=this.getFurnitureFloorName(s.typeId));const n=this.createRoomObjectFloor(t,e,i);if(!n)return!1;const a=n.model;if(a&&(a.setValue(I.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(s.typeId)),a.setValue(I.FURNITURE_TYPE_ID,s.typeId),a.setValue(I.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),a.setValue(I.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),a.setValue(I.FURNITURE_EXPIRY_TIME,s.expiryTime),a.setValue(I.FURNITURE_EXPIRTY_TIMESTAMP,ft()),a.setValue(I.FURNITURE_USAGE_POLICY,s.usagePolicy),a.setValue(I.FURNITURE_OWNER_ID,s.ownerId),a.setValue(I.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectFloor(t,e,s.location,s.direction,s.state,s.data,s.extra)||s.sizeZ>=0&&!this.updateRoomObjectFloorHeight(t,e,s.sizeZ))return!1;this.events&&this.events.dispatchEvent(new $($.ADDED,t,e,L.FLOOR));const o=this.getPlacedRoomObjectData(t);return o&&o.id===e&&o.category===L.FLOOR&&this.selectRoomObject(t,e,L.FLOOR),n.isReady&&s.synchronized&&this.addObjectToTileMap(t,n),!0}processPendingFurnitureWall(t,e,s){if(!s){const u=this.getRoomInstanceData(t);if(u&&(s=u.getPendingFurnitureWall(e)),!s)return!1}let i="";s.data&&(i=s.data.getLegacyString());let n=this.getFurnitureWallName(s.typeId,i);n||(n="");const a=this.createRoomObjectWall(t,e,n);if(!a)return!1;const o=a.model;if(o&&(o.setValue(I.FURNITURE_COLOR,this.getFurnitureWallColorIndex(s.typeId)),o.setValue(I.FURNITURE_TYPE_ID,s.typeId),o.setValue(I.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),o.setValue(I.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),o.setValue(I.OBJECT_ACCURATE_Z_VALUE,1),o.setValue(I.FURNITURE_EXPIRY_TIME,s.expiryTime),o.setValue(I.FURNITURE_EXPIRTY_TIMESTAMP,ft()),o.setValue(I.FURNITURE_USAGE_POLICY,s.usagePolicy),o.setValue(I.FURNITURE_OWNER_ID,s.ownerId),o.setValue(I.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectWall(t,e,s.location,s.direction,s.state,i))return!1;this.events&&this.events.dispatchEvent(new $($.ADDED,t,e,L.WALL));const h=this.getPlacedRoomObjectData(t);return h&&Math.abs(h.id)===e&&h.category===L.WALL&&this.selectRoomObject(t,e,L.WALL),!0}setRoomSessionOwnUser(t,e){if(!this._roomSessionManager)return;const s=this._roomSessionManager.getSession(t);s&&s.setOwnRoomIndex(e);const i=this.getRoomCamera(t);i&&(i.targetId=e,i.targetCategory=L.UNIT,i.activateFollowing(this.cameraFollowDuration))}get cameraFollowDuration(){return 1e3}updateRoomCameras(t){for(const e of this._roomInstanceDatas.values()){if(!e)continue;const s=e.roomCamera;if(!s)continue;let i=null;const n=this.getRoomObject(e.roomId,s.targetId,s.targetCategory);n&&(i=n.getLocation()),i&&(e.roomId!==this._activeRoomId||!this._activeRoomIsDragged)&&this.updateRoomCamera(e.roomId,1,i,t)}if(this._activeRoomWasDragged){const e=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);e&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new B(e.screenOffsetX+this._activeRoomDragX,e.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(t,e,s,i){const n=this.getRoomInstanceRenderingCanvas(t,e),a=this.getRoomInstanceData(t);if(!n||!a||n.scale!==1)return;const o=n.geometry,h=a.roomCamera,u=this.getRoomInstance(t);if(!o||!h||!u)return;const c=this.getRoomCanvasRectangle(t,e);if(!c)return;let l=Math.floor(s.z)+1;const _=Math.round(c.width),d=Math.round(c.height),f=this.getCanvasBoundingRectangle(e);if(f&&(f.right<0||f.bottom<0||f.left>=_||f.top>=d)&&h.reset(),h.screenWd!==_||h.screenHt!==d||h.scale!==o.scale||h.geometryUpdateId!==o.updateId||!S.isEqual(s,h.targetObjectLoc)||h.isMoving){h.targetObjectLoc=s;const m=new S;m.assign(s),m.x=Math.round(m.x),m.y=Math.round(m.y);const p=u.model.getValue(zt.ROOM_MIN_X)-.5,T=u.model.getValue(zt.ROOM_MIN_Y)-.5,v=u.model.getValue(zt.ROOM_MAX_X)+.5,O=u.model.getValue(zt.ROOM_MAX_Y)+.5,A=Math.round((p+v)/2),y=Math.round((T+O)/2),M=2;let N=new B(m.x-A,m.y-y);const P=o.scale/Math.sqrt(2),b=P/2,D=new Vt;D.rotate(-(o.direction.x+90)/180*Math.PI),N=D.apply(N),N.y=N.y*(b/P);const x=c.width/2/P-1,V=c.height/2/b-1;let J=0,ct=0,H=0,z=0,ht=o.getScreenPoint(new S(A,y,M));if(!ht)return;if(ht.x=ht.x+Math.round(c.width/2),ht.y=ht.y+Math.round(c.height/2),f)if(f.x+=-n.screenOffsetX,f.y+=-n.screenOffsetY,f.width>1&&f.height>1)J=(f.left-ht.x-o.scale*.25)/P,H=(f.right-ht.x+o.scale*.25)/P,ct=(f.top-ht.y-o.scale*.5)/b,z=(f.bottom-ht.y+o.scale*.5)/b;else{o.adjustLocation(new S(-30,-30),25);return}else{o.adjustLocation(new S(0,0),25);return}let Xe=!1,Ge=!1,K=!1,rt=!1;Math.round((H-J)*P)<c.width?(l=2,N.x=(H+J)/2,K=!0):(N.x>H-x&&(N.x=H-x,Xe=!0),N.x<J+x&&(N.x=J+x,Xe=!0)),Math.round((z-ct)*b)<c.height?(l=2,N.y=(z+ct)/2,rt=!0):(N.y>z-V&&(N.y=z-V,Ge=!0),N.y<ct+V&&(N.y=ct+V,Ge=!0),Ge&&(N.y=N.y/(b/P))),D.invert(),N=D.apply(N),N.x=N.x+A,N.y=N.y+y;let Tt=.35,bt=.2,Ft=.2;const Jt=10,ee=10;if(Ft*_>100&&(Ft=100/_),Tt*d>150&&(Tt=150/d),bt*d>150&&(bt=150/d),h.limitedLocationX&&h.screenWd==_&&h.screenHt==d&&(Ft=0),h.limitedLocationY&&h.screenWd==_&&h.screenHt==d&&(Tt=0,bt=0),c.width=c.width*(1-Ft*2),c.height=c.height*(1-(Tt+bt)),c.width<Jt&&(c.width=Jt),c.height<ee&&(c.height=ee),Tt+bt>0?(c.x+=-c.width/2,c.y+=-c.height*(bt/(Tt+bt))):(c.x+=-c.width/2,c.y+=-c.height/2),ht=o.getScreenPoint(m),!ht)return;if(ht){ht.x=ht.x+n.screenOffsetX,ht.y=ht.y+n.screenOffsetY,m.z=l,m.x=Math.round(N.x*2)/2,m.y=Math.round(N.y*2)/2,h.location||(o.location=m,this.useOffsetScrolling?h.initializeLocation(new S(0,0,0)):h.initializeLocation(m));const Ne=o.getScreenPoint(m),_e=new S(0,0,0);Ne&&(_e.x=Ne.x,_e.y=Ne.y),(ht.x<c.left||ht.x>c.right)&&!h.centeredLocX||(ht.y<c.top||ht.y>c.bottom)&&!h.centeredLocY||K&&!h.centeredLocX&&h.screenWd!=_||rt&&!h.centeredLocY&&h.screenHt!=d||h.roomWd!=f.width||h.roomHt!=f.height||h.screenWd!=_||h.screenHt!=d?(h.limitedLocationX=Xe,h.limitedLocationY=Ge,this.useOffsetScrolling?h.target=_e:h.target=m):(Xe||(h.limitedLocationX=!1),Ge||(h.limitedLocationY=!1))}h.centeredLocX=K,h.centeredLocY=rt,h.screenWd=_,h.screenHt=d,h.scale=o.scale,h.geometryUpdateId=o.updateId,h.roomWd=f.width,h.roomHt=f.height,this._sessionDataManager.isCameraFollowDisabled||(this.useOffsetScrolling?h.update(i,8):h.update(i,.5)),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new B(-h.location.x,-h.location.y)):o.adjustLocation(h.location,25)}else h.limitedLocationX=!1,h.limitedLocationY=!1,h.centeredLocX=!1,h.centeredLocY=!1}getRoomCanvasRectangle(t,e){const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new it(0,0,s.width,s.height):null}getRoomObjectBoundingRectangle(t,e,s,i){const n=this.getRoomInstanceGeometry(t,i);if(!n)return null;const a=this.getRoomObject(t,e,s);if(!a)return null;const o=a.visualization;if(!o)return null;const h=o.getBoundingRectangle(),u=this.getRoomInstanceRenderingCanvas(t,i),c=u?u.scale:1,l=n.getScreenPoint(a.getLocation());return!l||(l.x=Math.round(l.x),l.y=Math.round(l.y),h.x=h.x*c,h.y=h.y*c,h.width=h.width*c,h.height=h.height*c,l.x=l.x*c,l.y=l.y*c,h.x+=l.x,h.y+=l.y,!u)?null:(h.x+=Math.round(u.width/2)+u.screenOffsetX,h.y+=Math.round(u.height/2)+u.screenOffsetY,h)}getCanvasBoundingRectangle(t){return this.getRoomObjectBoundingRectangle(this._activeRoomId,jt.ROOM_OBJECT_ID,L.ROOM,t)}getFurnitureFloorName(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(t):null}getFurnitureWallName(t,e=null){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(t,e):null}getFurnitureFloorColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(t):null}getFurnitureWallColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(t):null}getRoomInstanceData(t){const e=this._roomInstanceDatas.get(t);if(e)return e;const s=new Let(t);return this._roomInstanceDatas.set(s.roomId,s),s}getRoomInstanceModelName(t){const e=this.getRoomInstanceData(t);return e?e.modelName:null}setRoomInstanceModelName(t,e){const s=this.getRoomInstanceData(t);s&&s.setModelName(e)}getRoomTileObjectMap(t){const e=this.getRoomInstanceData(t);return e?e.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(t){const e=this.getRoomInstanceData(t);return e?e.roomCamera:null}getSelectedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.selectedObject:null}setSelectedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setSelectedObject(e),e&&s.setPlacedObject(null)}getPlacedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.placedObject:null}setPlacedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setPlacedObject(e)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(t){const e=this.getRoomInstanceData(t);return e?e.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setFurnitureStackingHeightMap(e)}getLegacyWallGeometry(t){const e=this.getRoomInstanceData(t);return e?e.legacyGeometry:null}createRoomObjectAndInitialize(t,e,s,i){const n=this.getRoomInstance(t);return n?n.createRoomObjectAndInitalize(e,s,i):null}getTotalObjectsForManager(t,e){const s=this.getRoomInstance(t);return s?s.getTotalObjectsForManager(e):0}getRoomObject(t,e,s){if(!this._ready)return null;let i=this.getRoomId(t);return t===0&&(i=jt.TEMPORARY_ROOM),this.getObject(i,e,s)}getObject(t,e,s){let i=null;if(this._roomManager&&(i=this._roomManager.getRoomInstance(t)),!i)return null;let n=i.getRoomObject(e,s);if(!n)switch(s){case L.FLOOR:this.processPendingFurnitureFloor(this.getRoomIdFromString(t),e,null),n=i.getRoomObject(e,s);break;case L.WALL:this.processPendingFurnitureWall(this.getRoomIdFromString(t),e,null),n=i.getRoomObject(e,s);break}return n}getRoomObjectByIndex(t,e,s){const i=this.getRoomInstance(t);return i?i.getRoomObjectByIndex(e,s):null}getRoomObjectCategoryForType(t){return!t||!this._roomContentLoader?L.MINIMUM:this._roomContentLoader.getCategoryForType(t)}getRoomObjectCursor(t){return this.getObject(this.getRoomId(t),jt.CURSOR_OBJECT_ID,L.CURSOR)}getRoomObjectSelectionArrow(t){return this.getObject(this.getRoomId(t),jt.ARROW_OBJECT_ID,L.CURSOR)}getRoomOwnObject(t){return this.getObject(this.getRoomId(t),jt.ROOM_OBJECT_ID,L.ROOM)}getRoomObjectUser(t,e){return this.getObject(this.getRoomId(t),e,L.UNIT)}removeRoomObjectUser(t,e){return this.removeRoomObject(t,e,L.UNIT)}createRoomObjectUser(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,L.UNIT)}getRoomObjectFloor(t,e){return this.getObject(this.getRoomId(t),e,L.FLOOR)}createRoomObjectFloor(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,L.FLOOR)}removeRoomObjectFloor(t,e,s=-1,i=!1){const n=this.getRoomInstanceData(t);if(n&&n.removePendingFunitureFloor(e),this._sessionDataManager&&s===this._sessionDataManager.userId&&!MI.isBuilderClubId(e)){const a=this.getRoomObject(t,e,L.FLOOR);if(a){const o=this.getRoomObjectScreenLocation(t,e,L.FLOOR,this._activeRoomActiveCanvas);if(o&&!(a.model.getValue(I.FURNITURE_DISABLE_PICKING_ANIMATION)===1)){const u=a.model.getValue(I.FURNITURE_TYPE_ID),c=a.model.getValue(I.FURNITURE_EXTRAS),l=a.model.getValue(I.FURNITURE_DATA_FORMAT),_=Pi.getData(l),d=this.getFurnitureFloorIcon(u,null,c,_).data;if(d){const f=Qt.generateImage(d);if(this.events){const m=new Km(f,o.x,o.y);m.iconName=oi.INVENTORY,this.events.dispatchEvent(m)}}}}}this.removeRoomObject(t,e,L.FLOOR),this.setMouseDefault(t,L.FLOOR,e),i&&this.refreshTileObjectMap(t,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(t,e){return this.getObject(this.getRoomId(t),e,L.WALL)}removeRoomObjectWall(t,e,s=-1){if(this._sessionDataManager&&s===this._sessionDataManager.userId&&!MI.isBuilderClubId(e)){const i=this.getRoomObject(t,e,L.WALL);if(i&&i.type.indexOf("post_it")===-1&&i.type.indexOf("external_image_wallitem")===-1){const n=this.getRoomObjectScreenLocation(t,e,L.WALL,this._activeRoomActiveCanvas);if(n){const a=i.model.getValue(I.FURNITURE_TYPE_ID),o=i.model.getValue(I.FURNITURE_DATA),h=this.getFurnitureWallIcon(a,null,o).data;if(h){const u=Qt.generateImage(h);if(this.events){const c=new Km(u,n.x,n.y);c.iconName=oi.INVENTORY,this.events.dispatchEvent(c)}}}}}this.removeRoomObject(t,e,L.WALL),this.updateRoomObjectMask(t,e,!1),this.setMouseDefault(t,L.WALL,e)}createRoomObjectWall(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,L.WALL)}removeRoomObject(t,e,s){const i=this.getRoomInstance(t);if(!i)return null;i.removeRoomObject(e,s),this.events&&this.events.dispatchEvent(new $($.REMOVED,t,e,s))}addFurnitureFloor(t,e,s,i,n,a,o,h=NaN,u=-1,c=0,l=0,_="",d=!0,f=!0,m=-1){const p=this.getRoomInstanceData(t);if(!p)return!1;const T=new $c(e,s,null,i,n,a,o,h,u,c,l,_,d,f,m);return p.addPendingFurnitureFloor(T),!0}addFurnitureFloorByTypeName(t,e,s,i,n,a,o,h=NaN,u=-1,c=0,l=0,_="",d=!0,f=!0,m=-1){const p=this.getRoomInstanceData(t);if(!p)return!1;const T=new $c(e,0,s,i,n,a,o,h,u,c,l,_,d,f,m);return p.addPendingFurnitureFloor(T),!0}addFurnitureWall(t,e,s,i,n,a,o,h=-1,u=0,c=0,l="",_=!0){const d=this.getRoomInstanceData(t);if(!d)return!1;const f=new Rs;f.setString(o);const m=new $c(e,s,null,i,n,a,f,NaN,h,u,c,l,!0,_);return d.addPendingFurnitureWall(m),!0}updateRoomObjectFloor(t,e,s,i,n,a,o=null){const h=this.getRoomObjectFloor(t,e);return h?(h.processUpdateMessage(new ge(s,i)),h.processUpdateMessage(new Ht(n,a,o)),!0):!1}updateRoomObjectWall(t,e,s,i,n,a=null){const o=this.getRoomObjectWall(t,e);if(!o||!o.logic)return!1;const h=new ge(s,i),u=new Rs,c=new Ht(n,u);return u.setString(a),o.logic.processUpdateMessage(h),o.logic.processUpdateMessage(c),this.updateRoomObjectMask(t,e),!0}updateRoomObjectWallItemData(t,e,s){const i=this.getRoomObjectWall(t,e);return!i||!i.logic?!1:(i.logic.processUpdateMessage(new RE(s)),!0)}updateRoomObjectFloorHeight(t,e,s){const i=this.getRoomObjectFloor(t,e);return i?(i.processUpdateMessage(new py(null,null,s)),!0):!1}updateRoomObjectFloorExpiration(t,e,s){const i=this.getRoomObjectFloor(t,e);return i?(i.model.setValue(I.FURNITURE_EXPIRY_TIME,s),i.model.setValue(I.FURNITURE_EXPIRTY_TIMESTAMP,ft()),!0):!1}updateRoomObjectWallExpiration(t,e,s){const i=this.getRoomObjectWall(t,e);return i?(i.model.setValue(I.FURNITURE_EXPIRY_TIME,s),i.model.setValue(I.FURNITURE_EXPIRTY_TIMESTAMP,ft()),!0):!1}updateRoomObjectMask(t,e,s=!0){const i=L.WALL+"_"+e,n=this.getRoomObjectWall(t,e);let a=null;if(n&&n.model){if(n.model.getValue(I.FURNITURE_USES_PLANE_MASK)>0){const h=n.model.getValue(I.FURNITURE_PLANE_MASK_TYPE),u=n.getLocation();s?a=new Se(Se.ADD_MASK,i,h,u):a=new Se(Se.REMOVE_MASK,i)}}else a=new Se(Se.REMOVE_MASK,i);const o=this.getRoomOwnObject(t);o&&o.logic&&a&&o.logic.processUpdateMessage(a)}rollRoomObjectFloor(t,e,s,i){const n=this.getRoomObjectFloor(t,e);n&&n.processUpdateMessage(new Bi(s,i,null,!!i))}updateRoomObjectWallLocation(t,e,s){const i=this.getRoomObjectWall(t,e);return i?(i.logic&&i.logic.processUpdateMessage(new Bi(s,null,null)),this.updateRoomObjectMask(t,e),!0):!1}addRoomObjectUser(t,e,s,i,n,a,o){if(this.getRoomObjectUser(t,e))return!1;let u=Dt.getTypeString(a);u===Dt.PET&&(u=this.getPetType(o));const c=this.createRoomObjectUser(t,e,u);return c?(c.processUpdateMessage(new Vl(this.fixedUserLocation(t,s),null,i,n,!1,0)),o&&c.processUpdateMessage(new Bl(o)),this.events&&this.events.dispatchEvent(new $($.ADDED,t,e,L.UNIT)),!0):!1}updateRoomObjectUserLocation(t,e,s,i,n=!1,a=0,o=null,h=NaN){const u=this.getRoomObjectUser(t,e);if(!u)return!1;s||(s=u.getLocation()),o||(o=u.getDirection()),isNaN(h)&&(h=u.model.getValue(I.HEAD_DIRECTION)),u.processUpdateMessage(new Vl(this.fixedUserLocation(t,s),this.fixedUserLocation(t,i),o,h,n,a));const c=this._roomSessionManager&&this._roomSessionManager.getSession(t)||null;return c&&c.ownRoomIndex===e&&this._logicFactory.events.dispatchEvent(new fh(fh.ROAME_MOVE_TO,i)),!0}fixedUserLocation(t,e){if(!e)return null;const s=this.getFurnitureStackingHeightMap(t),i=this.getLegacyWallGeometry(t);if(!s||!i)return e;let n=e.z;const a=s.getTileHeight(e.x,e.y),o=i.getHeight(e.x,e.y);return Math.abs(n-a)<.1&&Math.abs(a-o)<.1&&(n=i.getFloorAltitude(e.x,e.y)),new S(e.x,e.y,n)}updateRoomObjectUserAction(t,e,s,i,n=null){const a=this.getRoomObjectUser(t,e);if(!a)return!1;let o=null;switch(s){case I.FIGURE_TALK:o=new mE(i);break;case I.FIGURE_SLEEP:o=new TE(i===1);break;case I.FIGURE_IS_TYPING:o=new gy(i===1);break;case I.FIGURE_IS_MUTED:o=new uy(i===1);break;case I.FIGURE_CARRY_OBJECT:o=new sy(i,n);break;case I.FIGURE_USE_OBJECT:o=new Ey(i);break;case I.FIGURE_DANCE:o=new ry(i);break;case I.FIGURE_GAINED_EXPERIENCE:o=new ny(i);break;case I.FIGURE_NUMBER_VALUE:o=new cy(i);break;case I.FIGURE_SIGN:o=new fy(i);break;case I.FIGURE_EXPRESSION:o=new ay(i);break;case I.FIGURE_IS_PLAYING_GAME:o=new dy(i===1);break;case I.FIGURE_GUIDE_STATUS:o=new YJ(i);break}return o?(a.processUpdateMessage(o),!0):!1}updateRoomObjectUserFigure(t,e,s,i=null,n=null,a=!1){const o=this.getRoomObjectUser(t,e);return o?(o.processUpdateMessage(new Bl(s,i,n,a)),!0):!1}updateRoomObjectUserFlatControl(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new oy(parseInt(s))),!0):!1}updateRoomObjectUserEffect(t,e,s,i=0){const n=this.getRoomObjectUser(t,e);return n?(n.processUpdateMessage(new iy(s,i)),!0):!1}updateRoomObjectUserGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new hy(s)),!0):!1}updateRoomObjectUserPetGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new _y(s)),!0):!1}updateRoomObjectUserPosture(t,e,s,i=null){const n=this.getRoomObjectUser(t,e);return n?(n.processUpdateMessage(new IE(s,i)),!0):!1}updateRoomObjectUserOwn(t,e){const s=this.getRoomObjectUser(t,e);s&&s.processUpdateMessage(new ly)}useRoomObject(t,e){const s=this.getRoomObject(this._activeRoomId,t,e);if(s){const i=s.logic;if(i)return i.useObject(),!0}return!1}objectInitialized(t,e,s){const i=this.getRoomIdFromString(t);s===L.WALL&&this.updateRoomObjectMask(i,e);const n=this.getRoomObject(i,e,s);if(n&&n.model&&n.logic){const a=n.model.getValue(I.FURNITURE_DATA_FORMAT);if(!isNaN(a)){const o=Pi.getData(a);o.initializeFromRoomObjectModel(n.model),n.processUpdateMessage(new Ht(n.getState(0),o))}this.events.dispatchEvent(new $($.CONTENT_UPDATED,i,e,s))}t!==jt.TEMPORARY_ROOM&&this.addObjectToTileMap(i,n)}changeObjectModelData(t,e,s,i,n){const a=this.getObject(this.getRoomId(t),e,s);if(!a||!a.logic)return!1;const o=new my(i,n);return a.processUpdateMessage(o),!0}changeObjectState(t,e,s){const i=this.getObject(this.getRoomId(t),e,s);if(!i||!i.model)return;let n=i.model.getValue(I.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(n)?n=1:n=n+1,i.model.setValue(I.FURNITURE_AUTOMATIC_STATE_INDEX,n);const a=i.model.getValue(I.FURNITURE_DATA_FORMAT),o=Pi.getData(a);o.initializeFromRoomObjectModel(i.model),i.logic&&i.logic.processUpdateMessage(new Ht(n,o))}loadRoomObjectBadgeImage(t,e,s,i,n=!0){if(!this._sessionDataManager)return;let a=null;if(t===0){const h=this._roomManager.getRoomInstance(jt.TEMPORARY_ROOM);h&&(a=h.getRoomObject(e,s))}else a=this.getRoomObjectFloor(t,e);if(!a||!a.logic)return;let o=n?this._sessionDataManager.loadGroupBadgeImage(i):this._sessionDataManager.loadBadgeImage(i);if(o)this.putBadgeInObjectAssets(a,i,n);else{o="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(yl.IMAGE_READY,this.onBadgeImageReadyEvent);let h=this._badgeListenerObjects.get(i);h||(h=[]),h.push(new Uet(a,n)),this._badgeListenerObjects.set(i,h)}a.logic.processUpdateMessage(new ka(i,o))}onBadgeImageReadyEvent(t){if(!this._sessionDataManager)return;const e=this._badgeListenerObjects&&this._badgeListenerObjects.get(t.badgeId);if(e){for(const s of e){if(!s)continue;this.putBadgeInObjectAssets(s.object,t.badgeId,s.groupBadge);const i=s.groupBadge?this._sessionDataManager.loadGroupBadgeImage(t.badgeId):this._sessionDataManager.loadBadgeImage(t.badgeId);s.object&&s.object.logic&&s.object.logic.processUpdateMessage(new ka(t.badgeId,i))}this._badgeListenerObjects.delete(t.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(yl.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(t,e,s=!1){if(!this._roomContentLoader||!this._sessionDataManager)return;const i=s?this._sessionDataManager.loadGroupBadgeImage(e):this._sessionDataManager.loadBadgeImage(e),n=s?this._sessionDataManager.getGroupBadgeImage(e):this._sessionDataManager.getBadgeImage(e);n&&this._roomContentLoader.addAssetToCollection(t.type,i,n,!1)}dispatchMouseEvent(t,e,s,i,n,a,o,h){const u=this.getRoomInstanceRenderingCanvas(this._activeRoomId,t);if(!u)return;const c=this.getRenderingCanvasOverlay(u),l=this.getOverlayIconSprite(c,jt.OBJECT_ICON_SPRITE);if(l){const _=l.getLocalBounds();l.x=e-_.width/2,l.y=s-_.height/2}if(!this.handleRoomDragging(u,e,s,i,n,a,o)&&!u.handleMouseEvent(e,s,i,n,a,o,h)){let _=null;i===k.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new $($.DESELECTED,this._activeRoomId,-1,L.MINIMUM)),_=et.CLICK):i===k.MOUSE_MOVE?_=et.MOUSE_MOVE:i===k.MOUSE_DOWN?_=et.MOUSE_DOWN:i===k.MOUSE_DOWN_LONG?_=et.MOUSE_DOWN_LONG:i===k.MOUSE_UP&&(_=et.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new et(_,this.getRoomObject(this._activeRoomId,jt.ROOM_OBJECT_ID,L.ROOM),null,n),this._activeRoomId)}this._activeRoomActiveCanvas=t,this._activeRoomActiveCanvasMouseX=e,this._activeRoomActiveCanvasMouseY=s}handleRoomDragging(t,e,s,i,n,a,o){let h=e-this._activeRoomActiveCanvasMouseX,u=s-this._activeRoomActiveCanvasMouseY;if(i===k.MOUSE_DOWN)!n&&!a&&!o&&!this.isDecorating&&this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(i===k.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const c=this.getRoomInstanceData(this._activeRoomId);if(c){const l=c.roomCamera;l&&(this.useOffsetScrolling&&(l.isMoving||(l.centeredLocX=!1,l.centeredLocY=!1),l.resetLocation(new S(-t.screenOffsetX,-t.screenOffsetY))),this._roomDraggingAlwaysCenters&&l.reset())}}}else if(i===k.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(h=e-this._activeRoomDragStartX,u=s-this._activeRoomDragStartY,(h<=-jt.DRAG_THRESHOLD||h>=jt.DRAG_THRESHOLD||u<=-jt.DRAG_THRESHOLD||u>=jt.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),h=0,u=0),(h!=0||u!=0)&&(this._activeRoomDragX+=h,this._activeRoomDragY+=u,this._activeRoomWasDragged=!0));else if((i===k.MOUSE_CLICK||i===k.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(t,e,s){const i=this.getRoomObjectCategoryForType(s);switch(t){case w.MOUSE_BUTTON:this.setMouseButton(this._activeRoomId,i,e);return;default:this.setMouseDefault(this._activeRoomId,i,e);return}}setMouseButton(t,e,s){if(!this._roomSessionManager)return;const i=this._roomSessionManager.getSession(t);if(i&&(e!==L.FLOOR&&e!==L.WALL||i.controllerLevel>=Ts.GUEST)){const n=this.getRoomInstanceData(t);n&&n.addButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(t,e,s){if(!this._roomSessionManager)return;const i=this.getRoomInstanceData(t);i&&i.removeButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(t,e,s){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,t,e,s)}modifyRoomObjectDataWithMap(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===L.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,t,e,s,i)}modifyRoomObjectData(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===L.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,t,s,i)}processRoomObjectEvent(t){if(!this._roomObjectEventHandler)return;const e=this.getRoomObjectRoomId(t.object);if(!e)return;const s=this.getRoomIdFromString(e);this._roomObjectEventHandler.handleRoomObjectEvent(t,s)}processRoomObjectPlacement(t,e,s,i,n=null,a=null,o=-1,h=-1,u=null){const c=this.getRoomInstance(this._activeRoomId);return!c||c.model.getValue(zt.ROOM_IS_PUBLIC)!==0||!this._roomObjectEventHandler?!1:this._roomObjectEventHandler.processRoomObjectPlacement(t,this._activeRoomId,e,s,i,n,a,o,h,u)}getRoomObjectScreenLocation(t,e,s,i=-1){i==-1&&(i=this._activeRoomActiveCanvas);const n=this.getRoomInstanceGeometry(t,i);if(!n)return null;const a=this.getRoomObject(t,e,s);if(!a)return null;const o=n.getScreenPoint(a.getLocation());if(!o)return null;const h=this.getRoomInstanceRenderingCanvas(t,i);return h?(o.x=o.x*h.scale,o.y=o.y*h.scale,o.x+=h.width/2+h.screenOffsetX,o.y+=h.height/2+h.screenOffsetY,o.x=Math.round(o.x),o.y=Math.round(o.y),o):null}selectRoomObject(t,e,s){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(t,e,s)}setSelectedAvatar(t,e){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(t,e,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}addOverlayIconSprite(t,e,s,i=1){if(!t||!s)return;let n=this.getOverlayIconSprite(t,e);return n?null:(n=new te(s),n.name=e,n.scale.set(i),t.addChild(n),n)}onRoomContentLoaded(t,e,s){if(!this._roomContentLoader||t===-1)return;this._thumbnailObjectIdBank.freeNumber(t-1);const i=this._thumbnailCallbacks.get(e);if(i){this._thumbnailCallbacks.delete(e);const n=this._roomContentLoader.getImage(e);if(n)for(const a of i)a&&a.imageReady(t,null,n)}}setObjectMoverIconSprite(t,e,s,i=null,n=null,a=-1,o=-1,h=null){let u=null,c=0,l=null;const _=1;if(s)l=this.getRoomObjectImage(this._activeRoomId,t,e,new S,1,null);else if(this._roomContentLoader)if(e===L.FLOOR?(u=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),c=this._roomContentLoader.getFurnitureFloorColorIndex(t)):e===L.WALL&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(t,i),c=this._roomContentLoader.getFurnitureWallColorIndex(t)),e===L.UNIT)if(u=Dt.getTypeString(t),u==="pet"){u=this.getPetType(i);const p=new ql(i);l=this.getRoomObjectPetImage(p.typeId,p.paletteId,p.color,new S(180),64,null,!0,0,p.customParts,h)}else l=this.getGenericRoomObjectImage(u,i,new S(180),64,null,0,null,n,a,o,h);else l=this.getGenericRoomObjectImage(u,c.toString(),new S,1,null,0,i,n,a,o,h);if(!l||!l.data)return;const d=this.getActiveRoomInstanceRenderingCanvas();if(!d)return;const f=this.getRenderingCanvasOverlay(d);this.removeOverlayIconSprite(f,jt.OBJECT_ICON_SPRITE);const m=this.addOverlayIconSprite(f,jt.OBJECT_ICON_SPRITE,l.data,_);m&&(m.x=this._activeRoomActiveCanvasMouseX-l.data.width/2,m.y=this._activeRoomActiveCanvasMouseY-l.data.height/2)}getRoomObjectImage(t,e,s,i,n,a,o=0){if(!this._roomManager)return null;let h=-1,u=null,c=null,l="",_=null;const d=this.getRoomId(t),f=this._roomManager.getRoomInstance(d);if(f){const m=f.getRoomObject(e,s);if(m&&m.model)switch(h=m.id,u=m.type,s){case L.FLOOR:case L.WALL:{l=m.model.getValue(I.FURNITURE_COLOR).toString(),_=m.model.getValue(I.FURNITURE_EXTRAS);const p=m.model.getValue(I.FURNITURE_DATA_FORMAT);p!==Rs.FORMAT_KEY&&(c=Pi.getData(p),c.initializeFromRoomObjectModel(m.model));break}case L.UNIT:l=m.model.getValue(I.FIGURE);break}}return this.getGenericRoomObjectImage(u,l,i,n,a,o,_,c,-1,-1,null,h)}getFurnitureFloorIconUrl(t){let e=null,s="";return this._roomContentLoader?(e=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),s=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(e,s)):null}getFurnitureFloorIcon(t,e,s=null,i=null){return this.getFurnitureFloorImage(t,new S,1,e,0,s,-1,-1,i)}getFurnitureWallIconUrl(t,e=null){let s=null,i="";return this._roomContentLoader?(s=this._roomContentLoader.getFurnitureWallNameForTypeId(t,e),i=this._roomContentLoader.getFurnitureWallColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(s,i)):null}getFurnitureWallIcon(t,e,s=null){return this.getFurnitureWallImage(t,new S,1,e,0,s)}getFurnitureFloorImage(t,e,s,i,n=0,a=null,o=-1,h=-1,u=null){let c=null,l="";return this._roomContentLoader&&(c=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),l=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(c,l,i,a,u):this.getGenericRoomObjectImage(c,l,e,s,i,n,a,u,o,h)}getFurnitureWallImage(t,e,s,i,n=0,a=null,o=-1,h=-1){let u=null,c="";return this._roomContentLoader&&(u=this._roomContentLoader.getFurnitureWallNameForTypeId(t),c=this._roomContentLoader.getFurnitureWallColorIndex(t).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(u,c,i,a,null):this.getGenericRoomObjectImage(u,c,e,s,i,n,a,null,o,h)}getRoomObjectPetImage(t,e,s,i,n,a,o=!1,h=0,u=null,c=null){let l=null,_=t+" "+e+" "+s.toString(16);if(o&&(_=_+" head"),u){_=_+(" "+u.length);for(const d of u)_=_+(" "+d.layerId+" "+d.partId+" "+d.paletteId)}return this._roomContentLoader&&(l=this._roomContentLoader.getPetNameForType(t)),this.getGenericRoomObjectImage(l,_,i,n,a,h,null,null,-1,-1,c)}getGenericRoomObjectImage(t,e,s,i,n,a=0,o=null,h=null,u=-1,c=-1,l=null,_=-1){if(!this._roomManager)return null;const d=new pI;if(d.id=-1,!this._ready||!t)return d;let f=this._roomManager.getRoomInstance(jt.TEMPORARY_ROOM);if(!f&&(f=this._roomManager.createRoomInstance(jt.TEMPORARY_ROOM),!f))return d;let m=this._imageObjectIdBank.reserveNumber();const p=this.getRoomObjectCategoryForType(t);if(m<0)return d;m++;const T=f.createRoomObjectAndInitalize(m,t,p);if(!T||!T.model||!T.logic)return d;const v=T.model;switch(p){case L.FLOOR:case L.WALL:v.setValue(I.FURNITURE_COLOR,parseInt(e)),v.setValue(I.FURNITURE_EXTRAS,o);break;case L.UNIT:if(t===Dt.USER||t===Dt.BOT||t===Dt.RENTABLE_BOT||t===Dt.PET)v.setValue(I.FIGURE,e);else{const M=new ql(e);v.setValue(I.PET_PALETTE_INDEX,M.paletteId),v.setValue(I.PET_COLOR,M.color),M.headOnly&&v.setValue(I.PET_HEAD_ONLY,1),M.hasCustomParts&&(v.setValue(I.PET_CUSTOM_LAYER_IDS,M.customLayerIds),v.setValue(I.PET_CUSTOM_PARTS_IDS,M.customPartIds),v.setValue(I.PET_CUSTOM_PALETTE_IDS,M.customPaletteIds)),l&&v.setValue(I.FIGURE_POSTURE,l)}break}T.setDirection(s);const O=T.visualization;if(!O)return f.removeRoomObject(m,p),d;(u>-1||h)&&(h&&h.getLegacyString()!==""?T.logic.processUpdateMessage(new Ht(parseInt(h.getLegacyString()),h)):T.logic.processUpdateMessage(new Ht(u,h)));const A=new Eh(i,new S(-135,30,0),new S(11,11,5));if(O.update(A,0,!0,!1),c>0){let M=0;for(;M<c;)O.update(A,0,!0,!1),M++}const y=O.getImage(a,_);if(d.data=y,d.id=m,!this.isRoomContentTypeLoaded(t)&&n){let M=this._imageCallbacks.get(m.toString());M||(M=[],this._imageCallbacks.set(m.toString(),M)),M.push(n),v.setValue(I.IMAGE_QUERY_SCALE,i)}else f.removeRoomObject(m,p),this._imageObjectIdBank.freeNumber(m-1),d.id=0;return A.dispose(),d}getGenericRoomObjectThumbnail(t,e,s,i=null,n=null){if(!this._roomManager)return null;const a=new pI;if(a.id=-1,!this._ready||!t)return a;let o=this._roomManager.getRoomInstance(jt.TEMPORARY_ROOM);if(!o&&(o=this._roomManager.createRoomInstance(jt.TEMPORARY_ROOM),!o))return a;let h=this._thumbnailObjectIdBank.reserveNumber();if(this.getRoomObjectCategoryForType(t),h<0)return a;h++,a.id=h,a.data=null,a.image=null;const u=[t,e].join("_"),c=this._roomContentLoader.getImage(u);if(!c&&s){let l=this._thumbnailCallbacks.get(u);l||(l=[],this._thumbnailCallbacks.set(u,l),this._roomContentLoader.downloadImage(h,t,e,null)),l.push(s)}else c&&(a.image=c),this._thumbnailObjectIdBank.freeNumber(h-1),a.id=0;return a}initalizeTemporaryObjectsByType(t,e){const s=this._roomManager.getRoomInstance(jt.TEMPORARY_ROOM);if(!s||!this._roomContentLoader)return;const i=this._roomContentLoader.getCategoryForType(t),n=s.getManager(i);let a=null,o=0;if(n&&n.objects.length){for(const h of n.objects.getValues())if(h&&h.model&&h.type===t){const u=h.id,c=h.visualization;let l=null;if(c){const d=h.model.getValue(I.IMAGE_QUERY_SCALE);a&&o!==d&&(a.dispose(),a=null),a||(o=d,a=new Eh(d,new S(-135,30,0),new S(11,11,5))),c.update(a,0,!0,!1),l=c.image}s.removeRoomObject(u,i),this._imageObjectIdBank.freeNumber(u-1);const _=this._imageCallbacks.get(u.toString());if(_){this._imageCallbacks.delete(u.toString());for(const d of _)d&&(l?d.imageReady(u,l):d.imageFailed(u))}}}a&&a.dispose()}setObjectMoverIconSpriteVisible(t){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const s=this.getRenderingCanvasOverlay(e),i=this.getOverlayIconSprite(s,jt.OBJECT_ICON_SPRITE);i&&(i.visible=t)}removeObjectMoverIconSprite(){const t=this.getActiveRoomInstanceRenderingCanvas();if(!t)return;const e=this.getRenderingCanvasOverlay(t);this.removeOverlayIconSprite(e,jt.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(t){if(!t)return null;const e=t.master;return e&&e.getChildByName(jt.OVERLAY)||null}removeOverlayIconSprite(t,e){if(!t)return!1;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e){if(t.removeChildAt(s),i.children.length){const n=i.getChildAt(0);n.parent.removeChild(n),n.destroy()}return!0}s--}return!1}getOverlayIconSprite(t,e){if(!t)return null;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e)return i;s--}return null}getRoomObjects(t,e){if(this._ready){const s=this.getRoomId(t),i=this._roomManager.getRoomInstance(s);if(i)return i.getRoomObjectsForCategory(e)}return[]}addObjectToTileMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.addRoomObject(e)}refreshTileObjectMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.populate(this.getRoomObjects(t,L.FLOOR))}getRenderRoomMessage(t,e,s=!1,i=!0,n=!1,a=-1){let o=null;if(a>-1?o=this.getRoomInstanceRenderingCanvas(this._activeRoomId,a):o=this.getActiveRoomInstanceRenderingCanvas(),!o)return null;n&&o.skipSpriteVisibilityChecking();let h=-1;!i&&this._roomSessionManager.getSession(this._activeRoomId)!=null&&(h=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const u=new xet,c=u.getFurniData(t,o,this,h),l=u.getRoomRenderingModifiers(this),_=u.getRoomPlanes(t,o,this,e);return n&&o.resumeSpriteVisibilityChecking(),Y.log(c,l,_),null}createTextureFromRoom(t,e=-1,s=null){let i=null;e>-1?i=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e):i=this.getActiveRoomInstanceRenderingCanvas();let n=null;return s?n=Qt.generateTexture(i.master,s):n=i.getDisplayAsTexture(),n}saveTextureAsScreenshot(t,e=!1){let s=null;e?s=new Qf:s=new Gl,s.assignBitmap(t),this._communication.connection.send(s)}saveBase64AsScreenshot(t,e=!1){let s=null;e?s=new Qf:s=new Gl,s.assignBase64(t),this._communication.connection.send(s)}objectsInitialized(t){const e=this.getRoomIdFromString(t);this.events.dispatchEvent(new At(At.OBJECTS_INITIALIZED,e))}getRoomId(t){return t.toString()}getRoomIdFromString(t){if(!t)return-1;const e=t.split("_");return e.length<=0?-1:parseInt(e[0])||0}getRoomObjectRoomId(t){return!t||!t.model?null:t.model.getValue(I.OBJECT_ROOM_ID)}getRoomObjectAdUrl(t){return this._roomContentLoader.getRoomObjectAdUrl(t)}getPetTypeId(t){let e=-1;if(t){const s=t.split(" ");s.length>1&&(e=parseInt(s[0]))}return e}getPetType(t){if(!t)return null;const e=t.split(" ");if(e.length>1){const s=parseInt(e[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(s):"pet"}return null}isRoomContentTypeLoaded(t){return this._roomContentLoader?this._roomContentLoader.getCollection(t)!==null:!1}getPetColorResult(t,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResult(t,e):null}getPetColorResultsForTag(t,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResultsForTag(t,e):null}deleteRoomObject(t,e){return!this._roomObjectEventHandler||e!==L.WALL?!1:this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,t)}get connection(){return this._communication.connection}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(t){this._sessionDataManager=t}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(t){this._roomSessionManager=t}get roomManager(){return this._roomManager}set roomManager(t){this._roomManager=t}get objectEventHandler(){return this._roomObjectEventHandler}get roomRendererFactory(){return this._roomRendererFactory}get visualizationFactory(){return this._visualizationFactory}get logicFactory(){return this._logicFactory}get activeRoomId(){return this._activeRoomId}get ready(){return this._ready}get roomContentLoader(){return this._roomContentLoader}get isDecorating(){if(!this._roomSessionManager)return!1;const t=this._roomSessionManager.getSession(this._activeRoomId);return t&&t.isDecorating||!1}get useOffsetScrolling(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(t,e){return this._roomManager==null?0:this._roomManager.getRoomInstance(t.toString()).getRoomObjectsForCategory(e).length}};Js.ROOM_OBJECT_ID=-1;Js.ROOM_OBJECT_TYPE="room";Js.CURSOR_OBJECT_ID=-2;Js.CURSOR_OBJECT_TYPE="tile_cursor";Js.ARROW_OBJECT_ID=-3;Js.ARROW_OBJECT_TYPE="selection_arrow";Js.OVERLAY="overlay";Js.OBJECT_ICON_SPRITE="object_icon_sprite";Js.DRAG_THRESHOLD=15;Js.TEMPORARY_ROOM="temporary_room";let FE=Js;const $s=class j{constructor(t,e=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._backgroundColor=305148561,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=t,this._planeParser=new ye,this._previewRoomId=XO.makeRoomPreviewerId(e),this._addViewOffset=new B(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener($.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener($.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(At.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener($.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener($.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(At.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const e=new ye;e.initializeTileMap(7+2,7+2);let s=1;for(;s<1+7;){let i=1;for(;i<1+7;)e.setTileHeight(i,s,0),i++;s++}e.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,e.getMapData()),e.dispose()}}reset(t){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,j.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,j.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,j.PREVIEW_OBJECT_ID),t||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=L.MINIMUM}updatePreviewModel(t,e,s=!0){const i=new av;i.flush(),i.parseModel(t,e,s);const n=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!n)return;this._planeParser.reset();const a=i.width,o=i.height;this._planeParser.initializeTileMap(a,o);const h=null;let u=-1,c=-1,l=0,_=0,d=0;for(;d<o;){let T=0;for(;T<a;){const v=i.getHeight(T,d);(d>0&&d<o-1||T>0&&T<a-1)&&v!=ye.TILE_BLOCKED&&h==null&&(i.getHeight(T,d-1)==ye.TILE_BLOCKED&&i.getHeight(T-1,d)==ye.TILE_BLOCKED&&i.getHeight(T,d+1)==ye.TILE_BLOCKED&&(u=T+.5,c=d,l=v,_=90),i.getHeight(T,d-1)==ye.TILE_BLOCKED&&i.getHeight(T-1,d)==ye.TILE_BLOCKED&&i.getHeight(T+1,d)==ye.TILE_BLOCKED&&(u=T,c=d+.5,l=v,_=180)),this._planeParser.setTileHeight(T,d,v),T++}d++}this._planeParser.setTileHeight(Math.floor(u),Math.floor(c),l),this._planeParser.initializeFromTileData(i.wallHeight),this._planeParser.setTileHeight(Math.floor(u),Math.floor(c),l+this._planeParser.wallHeight),n.scale=xE.DEFAULT_SCALE,n.initialize(a,o,this._planeParser.floorHeight);let f=i.height-1;for(;f>=0;){let T=i.width-1;for(;T>=0;)n.setHeight(T,f,this._planeParser.getTileHeight(T,f)),T--;f--}const m=this._planeParser.getMapData();m.doors.push({x:u,y:c,z:l,dir:_});const p=this.getRoomPreviewOwnRoomObject();p&&p.processUpdateMessage(new Ry(m))}addFurnitureIntoRoom(t,e,s=null,i=null){if(s||(s=new Rs),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=L.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,j.PREVIEW_OBJECT_ID,t,new S(j.PREVIEW_OBJECT_LOCATION_X,j.PREVIEW_OBJECT_LOCATION_Y,0),e,0,s,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=ft(),this._automaticStateChange=!0;const n=this._roomEngine.getRoomObject(this._previewRoomId,j.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return n&&i&&n.model.setValue(I.FURNITURE_EXTRAS,i),this.updatePreviewRoomView(),j.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(t,e,s){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===L.WALL&&this._currentPreviewObjectType===t&&this._currentPreviewObjectData===s)return j.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=L.WALL,this._currentPreviewObjectData=s,this._roomEngine.addFurnitureWall(this._previewRoomId,j.PREVIEW_OBJECT_ID,t,new S(.5,2.3,1.8),e,0,s,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=ft(),this._automaticStateChange=!0,this.updatePreviewRoomView(),j.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(t,e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=L.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,j.PREVIEW_OBJECT_ID,new S(j.PREVIEW_OBJECT_LOCATION_X,j.PREVIEW_OBJECT_LOCATION_Y,0),new S(90,0,0),135,Dt.getTypeNumber(Dt.USER),t)&&(this._previousAutomaticStateChangeTime=ft(),this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(e),this.updateUserPosture("std")),this.updatePreviewRoomView(),j.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(t){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=L.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,j.PREVIEW_OBJECT_ID,new S(j.PREVIEW_OBJECT_LOCATION_X,j.PREVIEW_OBJECT_LOCATION_Y,0),new S(90,0,0),90,Dt.getTypeNumber(Dt.PET),t)&&(this._previousAutomaticStateChangeTime=ft(),this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),j.PREVIEW_OBJECT_ID):-1}updateUserPosture(t,e=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,j.PREVIEW_OBJECT_ID,t,e)}updateUserGesture(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,j.PREVIEW_OBJECT_ID,t)}updateUserEffect(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,j.PREVIEW_OBJECT_ID,t)}updateObjectUserFigure(t,e=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,j.PREVIEW_OBJECT_ID,t,e,s,i):!1}updateObjectUserAction(t,e,s=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,j.PREVIEW_OBJECT_ID,t,e,s)}updateObjectStuffData(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,j.PREVIEW_OBJECT_ID,null,null,t.state,t)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==L.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,j.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,j.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!t)return;const e=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(t,!0);switch(this._currentPreviewObjectCategory){case L.FLOOR:{const s=new S(j.PREVIEW_OBJECT_LOCATION_X,j.PREVIEW_OBJECT_LOCATION_Y),i=new S(e,e,e);this._roomEngine.updateRoomObjectFloor(this._previewRoomId,j.PREVIEW_OBJECT_ID,s,i,null,null);return}case L.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const t=ft();t>this._previousAutomaticStateChangeTime+j.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=t,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,j.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(t,e){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,j.PREVIEW_CANVAS_ID,t,e,this._currentPreviewScale);if(s&&this._backgroundColor!==null){let n=this._backgroundSprite;n||(n=new te(_t.WHITE),s.addChildAt(n,0)),n.width=t,n.height=e,n.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,j.PREVIEW_CANVAS_ID,!0);const i=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,j.PREVIEW_CANVAS_ID);return i&&i.adjustLocation(new S(j.PREVIEW_OBJECT_LOCATION_X,j.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,s}return null}modifyRoomCanvas(t,e){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,this._backgroundSprite&&(this._backgroundSprite.width=t,this._backgroundSprite.height=e),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,j.PREVIEW_CANVAS_ID,t,e))}set addViewOffset(t){this._addViewOffset=t}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(t){const e=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,j.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,j.PREVIEW_CANVAS_ID);if(e&&t)if(e.x+=-(this._currentPreviewCanvasWidth>>1),e.y+=-(this._currentPreviewCanvasHeight>>1),e.x+=-t.x,e.y+=-t.y,!this._currentPreviewRectangle)this._currentPreviewRectangle=e;else{const s=this._currentPreviewRectangle.clone().enlarge(e);(s.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||s.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=s)}}validatePreviewSize(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;if(this.isRoomEngineReady){const e=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,j.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+j.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+j.ALLOWED_IMAGE_CUT)?j.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,j.PREVIEW_CANVAS_ID)!==.5&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,j.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=j.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,t.x=t.x>>1,t.y=t.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):e.isZoomedIn()&&(e.performZoomOut(),this._currentPreviewScale=j.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(j.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,j.PREVIEW_CANVAS_ID)!==1&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,j.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=j.SCALE_NORMAL):e.isZoomedIn()||(e.performZoomIn(),this._currentPreviewScale=j.SCALE_NORMAL))}return t}zoomIn(){this.isRoomEngineReady&&(j.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,j.PREVIEW_CANVAS_ID,1):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,j.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=j.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(j.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,j.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,j.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=j.SCALE_SMALL}updateAvatarDirection(t,e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,j.PREVIEW_OBJECT_ID,new S(j.PREVIEW_OBJECT_LOCATION_X,j.PREVIEW_OBJECT_LOCATION_Y,0),new S(j.PREVIEW_OBJECT_LOCATION_X,j.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new S(t*45,0,0),e*45)}updateObjectRoom(t=null,e=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,t,e,s,i):!1}updateRoomWallsAndFloorVisibility(t,e=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,t,e)}getCanvasOffset(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;let e=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,s=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const i=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;i>10?s=s+Math.min(15,i-10):this._currentPreviewObjectCategory!==L.UNIT?s=s+(5-Math.max(0,i/2)):s=s-(5-Math.min(0,i/2)),s=s+this._addViewOffset.y,e=e+this._addViewOffset.x;const n=e-t.x,a=s-t.y;if(n!==0||a!==0){const o=Math.sqrt(n*n+a*a);return o>10&&(e=t.x+n*10/o,s=t.y+a*10/o),new B(e,s)}return null}updatePreviewRoomView(t=!1){if(!(this._disableUpdate&&!t)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let e=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,j.PREVIEW_CANVAS_ID);if(e&&(this.updatePreviewObjectBoundingRectangle(e),this._currentPreviewRectangle)){const s=this._currentPreviewScale;e=this.validatePreviewSize(e);const i=this.getCanvasOffset(e);i&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,j.PREVIEW_CANVAS_ID,i),this._currentPreviewScale!==s&&(this._currentPreviewRectangle=null)}}}set disableUpdate(t){this._disableUpdate=t}set disableRoomEngineUpdate(t){this.isRoomEngineReady&&this._roomEngine.disableUpdate(t)}onRoomInitializedonRoomInitialized(t){if(t)switch(t.type){case At.INITIALIZED:t.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999");return}}onRoomObjectAdded(t){if(t.roomId===this._previewRoomId&&t.objectId===j.PREVIEW_OBJECT_ID&&t.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const e=this._roomEngine.getRoomObject(t.roomId,t.objectId,t.category);if(e&&e.model&&t.category===L.WALL){const s=e.model.getValue(I.FURNITURE_SIZE_Z),i=e.model.getValue(I.FURNITURE_CENTER_Z);(s!==null||i!==null)&&this._roomEngine.updateRoomObjectWallLocation(t.roomId,t.objectId,new S(.5,2.3,(3.6-s)/2+i))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){const t=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,j.PREVIEW_CANVAS_ID);return t||null}getGenericRoomObjectImage(t,e,s,i,n,a=0,o=null,h=null,u=-1,c=-1,l=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(t,e,s,i,n,a,o,h,u,c,l):null}getRoomObjectImage(t,e,s,i=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,j.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,t,e,s,i):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,j.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t&&t.visualization)return t.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,j.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t)return t}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,FE.ROOM_OBJECT_ID,L.ROOM);if(t)return t}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}};$s.SCALE_NORMAL=64;$s.SCALE_SMALL=32;$s.PREVIEW_COUNTER=0;$s.PREVIEW_CANVAS_ID=1;$s.PREVIEW_OBJECT_ID=1;$s.PREVIEW_OBJECT_LOCATION_X=2;$s.PREVIEW_OBJECT_LOCATION_Y=2;$s.ALLOWED_IMAGE_CUT=.25;$s.AUTOMATIC_STATE_CHANGE_INTERVAL=2500;$s.ZOOM_ENABLED=!0;let Bst=$s;class SI{constructor(t,e){this._image=t,this._placeHolder=e}get image(){return this._image}get placeHolder(){return this._placeHolder}}class Bet{constructor(t){this._code=t,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}const Sr=class us{constructor(t,e=0,s=0,i=0){this.type=t,this.key=e,this.color=s,this.position=i}get code(){return this.key===0?null:us.getCode(this.type,this.key,this.color,this.position)}static getCode(t,e,s,i){return(t===us.BASE?t:e>=100?us.SYMBOL_ALT:us.SYMBOL)+(e<10?"0":"")+(t===us.BASE?e:e>=100?e-100:e)+(s<10?"0":"")+s+i}calculatePosition(t){const e=this.calculateGridPos(this.position);let s=us.CELL_WIDTH*e.x+us.CELL_WIDTH/2-t.width/2,i=us.CELL_HEIGHT*e.y+us.CELL_HEIGHT/2-t.height/2;return s<0&&(s=0),s+t.width>us.IMAGE_WIDTH&&(s=us.IMAGE_WIDTH-t.width),i<0&&(i=0),i+t.height>us.IMAGE_HEIGHT&&(i=us.IMAGE_HEIGHT-t.height),new vl(Math.floor(s),Math.floor(i))}calculateGridPos(t){const e=new vl;return e.x=Math.floor(t%3),e.y=Math.floor(t/3),e}};Sr.BASE="b";Sr.SYMBOL="s";Sr.SYMBOL_ALT="t";Sr.BASE_PART=0;Sr.LAYER_PART=1;Sr.IMAGE_WIDTH=39;Sr.IMAGE_HEIGHT=39;Sr.CELL_WIDTH=13;Sr.CELL_HEIGHT=13;let ed=Sr;const wE=class wr{constructor(t,e){this._assets=t,this._sessionDataManager=e,this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Av(this.onGroupBadgePartsEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}getBadgeImage(t,e=wr.NORMAL_BADGE,s=!0){let i=this.getBadgeTexture(t,e);return!i&&s&&(i=this.getBadgePlaceholder()),i}getBadgeInfo(t){const e=this.getBadgeTexture(t);return e?new SI(e,!1):new SI(this.getBadgePlaceholder(),!0)}loadBadgeImage(t,e=wr.NORMAL_BADGE){return this._assets.getTexture(this.getBadgeUrl(t,e))?t:(this.getBadgeTexture(t,e),null)}getBadgeTexture(t,e=wr.NORMAL_BADGE){const s=this.getBadgeUrl(t,e);if(!s||!s.length)return null;const i=this._assets.getTexture(s);if(i)return i.clone();if(e===wr.NORMAL_BADGE){if(this._requestedBadges.get(t))return null;this._requestedBadges.set(t,!0),this._assets.downloadAsset(s).then(n=>{if(!n)return;this._requestedBadges.delete(t);const a=this._assets.getTexture(s);a&&this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new yl(t,a.clone()))}).catch(n=>{})}else if(e===wr.GROUP_BADGE){if(this._groupBadgesQueue.get(t))return;this._groupBadgesQueue.set(t,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(t)}return null}getBadgePlaceholder(){const t=at.getValue("images.url")+"/loading_icon.png",e=this._assets.getTexture(t);return e?e.clone():null}getBadgeUrl(t,e=wr.NORMAL_BADGE){let s=null;switch(e){case wr.NORMAL_BADGE:s=at.getValue("badge.asset.url").replace("%badgename%",t);break;case wr.GROUP_BADGE:s=t;break}return s}loadGroupBadge(t){const e=new Bet(t),s=[...t.matchAll(/[b|s][0-9]{4,6}/g)];for(const i of s){const n=i[0],a=n.length===6,o=n[0],h=parseInt(n.slice(1,a?3:4)),u=parseInt(n.slice(a?3:4,a?5:6)),c=n.length<6?0:parseInt(n.slice(a?5:6,a?6:7)),l=new ed(o,h,u,c);e.parts.push(l)}this.renderGroupBadge(e)}renderGroupBadge(t){const e=new zs,s=new te(hR.EMPTY);s.width=ed.IMAGE_WIDTH,s.height=ed.IMAGE_HEIGHT,e.addChild(s);for(const n of t.parts){let a=!0;const o=n.type==="b"?this._groupBases.get(n.key):this._groupSymbols.get(n.key);if(o)for(const h of o){if(!h||!h.length)continue;const u=this._assets.getTexture(`badgepart_${h}`);if(!u)continue;const{x:c,y:l}=n.calculatePosition(u),_=new te(u);_.position.set(c,l),a&&(_.tint=parseInt(this._groupPartColors.get(n.color),16)),a=!1,e.addChild(_)}}this._requestedBadges.delete(t.code),this._groupBadgesQueue.delete(t.code);const i=Qt.generateTexture(e);this._assets.setTexture(t.code,i),this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new yl(t.code,i))}onGroupBadgePartsEvent(t){if(!t)return;const e=t.getParser();if(e){e.bases.forEach((s,i)=>this._groupBases.set(i,s.map(n=>n.replace(".png","").replace(".gif","")))),e.symbols.forEach((s,i)=>this._groupSymbols.set(i,s.map(n=>n.replace(".png","").replace(".gif","")))),this._groupPartColors=e.partColors,this._readyToGenerateGroupBadges=!0;for(const s of this._groupBadgesQueue.keys())this.loadGroupBadge(s)}}get disposed(){return!!this._sessionDataManager}};wE.GROUP_BADGE="group_badge";wE.NORMAL_BADGE="normal_badge";let Fu=wE;class yI{constructor(t,e,s,i,n,a,o,h,u,c,l,_,d,f,m,p,T,v,O,A,y,M,N,P,b,D,x,V,J){this._type=t,this._id=e,this._fullName=s,this._className=i,this._category=n,this._revision=h,this._tileSizeX=u,this._tileSizeY=c,this._tileSizeZ=l,this._colors=_,this._hasIndexedColor=d,this._colourIndex=f,this._localizedName=a,this._description=o,this._adUrl=m,this._purchaseOfferId=p,this._purchaseCouldBeUsedForBuyout=T,this._rentOfferId=v,this._rentCouldBeUsedForBuyout=O,this._customParams=y,this._specialType=M,this._availableForBuildersClub=A,this._canStandOn=N,this._canSitOn=P,this._canLayOn=b,this._excludedFromDynamic=D,this._furniLine=x,this._environment=V,this._rare=J}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(t){this._className=t}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return this._className.indexOf("external_image")!==-1}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}const GE=class fg extends vs{constructor(t,e,s){super(),this._floorItems=t,this._wallItems=e,this._localization=s}loadFurnitureData(t){t&&fetch(t).then(e=>e.json()).then(e=>this.onFurnitureDataLoaded(e)).catch(e=>this.onFurnitureDataError(e))}onFurnitureDataLoaded(t){t&&((typeof t.roomitemtypes>"u"||typeof t.wallitemtypes>"u")&&Y.warn("Could not find `roomitemtypes` or `wallitemtypes` in furnidata."),t.roomitemtypes&&this.parseFloorItems(t.roomitemtypes),t.wallitemtypes&&this.parseWallItems(t.wallitemtypes),this.dispatchEvent(new It(fg.FURNITURE_DATA_READY)))}onFurnitureDataError(t){t&&(Y.error(t),this.dispatchEvent(new It(fg.FURNITURE_DATA_ERROR)))}parseFloorItems(t){if(!(!t||!t.furnitype))for(const e of t.furnitype){if(!e)continue;const s=[];if(e.partcolors)for(const u of e.partcolors.color){let c=u;c.charAt(0)==="#"&&(c=c.replace("#","")),s.push(parseInt(c,16))}const i=e.classname.split("*"),n=i[0],a=i.length>1?parseInt(i[1]):0,o=i.length>1,h=new yI(Tn.FLOOR,e.id,e.classname,n,e.category,e.name,e.description,e.revision,e.xdim,e.ydim,0,s,o,a,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,e.customparams,e.specialtype,e.canstandon,e.cansiton,e.canlayon,e.excludeddynamic,e.furniline,e.environment,e.rare);this._floorItems.set(h.id,h),this.updateLocalizations(h)}}parseWallItems(t){if(!(!t||!t.furnitype))for(const e of t.furnitype){if(!e)continue;const s=new yI(Tn.WALL,e.id,e.classname,e.classname,e.category,e.name,e.description,e.revision,0,0,0,null,!1,0,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,null,e.specialtype,!1,!1,!1,e.excludeddynamic,e.furniline,e.environment,e.rare);this._wallItems.set(s.id,s),this.updateLocalizations(s)}}updateLocalizations(t){if(this._localization)switch(t.type){case Tn.FLOOR:this._localization.setValue("roomItem.name."+t.id,t.name),this._localization.setValue("roomItem.desc."+t.id,t.description);return;case Tn.WALL:this._localization.setValue("wallItem.name."+t.id,t.name),this._localization.setValue("wallItem.desc."+t.id,t.description);return}}};GE.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY";GE.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR";let sd=GE;class Het{constructor(t){this._sessionDataManager=t,this._groupBadges=new Map}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Va(this.onRoomReadyMessageEvent.bind(this)),new dA(this.onGroupBadgesEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._groupBadges=null,this._sessionDataManager=null}}onRoomReadyMessageEvent(t){this._sessionDataManager.send(new YS)}onGroupBadgesEvent(t){const e=t.getParser();for(const[s,i]of e.badges.entries())this._groupBadges.set(s,i)}getGroupBadge(t){return this._groupBadges.get(t)}get disposed(){return!!this._sessionDataManager}}class BE{}BE.NO_CLUB=0;BE.CLUB=1;BE.VIP=2;class tr extends ds{constructor(t,e){super(),this._connection=t,this._listener=e,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(t){this._roomId=t}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class Vet extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new ff(this.onRoomGenericError.bind(this)))}onRoomGenericError(t){if(!(t instanceof ff))return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case zg.KICKED_OUT_OF_ROOM:i=Zt.RSEME_KICKED;break;default:return}!i||i.length==0||this.listener.events.dispatchEvent(new Zt(i,s))}}class ket extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new xv(this.onOpenPetPackageRequested.bind(this))),t.addMessageEvent(new Fv(this.onOpenPetPackageResult.bind(this)))}onOpenPetPackageRequested(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Aa(Aa.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,s,e.objectId,e.figureData,0,null))}onOpenPetPackageResult(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Aa(Aa.RSOPPE_OPEN_PET_PACKAGE_RESULT,s,e.objectId,null,e.nameValidationStatus,e.nameValidationInfo))}}class jet extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new Bv(this.onPollContentsEvent.bind(this))),t.addMessageEvent(new Vv(this.onPollOfferEvent.bind(this))),t.addMessageEvent(new Hv(this.onPollErrorEvent.bind(this)))}onPollContentsEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new jr(jr.CONTENT,e,s.id);i.startMessage=s.startMessage,i.endMessage=s.endMessage,i.numQuestions=s.numQuestions,i.questionArray=s.questionArray,i.npsPoll=s.npsPoll,this.listener.events.dispatchEvent(i)}onPollOfferEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new jr(jr.OFFER,e,s.id);i.summary=s.headline,i.summary=s.summary,this.listener.events.dispatchEvent(i)}onPollErrorEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e||!t.getParser())return;const i=new jr(jr.ERROR,e,-1);i.headline="???",i.summary="???",this.listener.events.dispatchEvent(i)}}class zet extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new _E(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new Pl(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new Dl(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new eA(this.onRoomUnitHandItemReceivedEvent.bind(this))),t.addMessageEvent(new mA(this.onRespectReceivedEvent.bind(this))),t.addMessageEvent(new EA(this.onPetRespectNoficationEvent.bind(this))),t.addMessageEvent(new pA(this.onPetSupplementedNotificationEvent.bind(this))),t.addMessageEvent(new $v(this.onFloodControlEvent.bind(this))),t.addMessageEvent(new tA(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;let i=pt.CHAT_TYPE_SPEAK;t instanceof Pl?i=pt.CHAT_TYPE_SHOUT:t instanceof Dl&&(i=pt.CHAT_TYPE_WHISPER);const n=new pt(pt.CHAT_EVENT,e,s.roomIndex,s.message,i,s.bubble);this.listener.events.dispatchEvent(n)}onRoomUnitHandItemReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&this.listener.events.dispatchEvent(new pt(pt.CHAT_EVENT,e,s.giverUserId,"",pt.CHAT_TYPE_HAND_ITEM_RECEIVED,Si.GENERIC,null,s.handItemType))}onRespectReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getUserData(s.userId);i&&this.listener.events.dispatchEvent(new pt(pt.CHAT_EVENT,e,i.roomIndex,"",pt.CHAT_TYPE_RESPECT,Si.GENERIC))}onPetRespectNoficationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getPetData(s.petData.id);if(!i)return;let n=pt.CHAT_TYPE_PETRESPECT;s.isTreat&&(n=pt.CHAT_TYPE_PETTREAT),this.listener.events.dispatchEvent(new pt(pt.CHAT_EVENT,e,i.roomIndex,"",n,Si.GENERIC))}onPetSupplementedNotificationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getPetData(s.petId);if(!i)return;let n=-1;const a=e.userDataManager.getUserData(s.userId);a&&(n=a.roomIndex);let o=pt.CHAT_TYPE_PETREVIVE;switch(s.supplementType){case Gi.REVIVE:o=pt.CHAT_TYPE_PETREVIVE;break;case Gi.REBREED_FERTILIZER:o=pt.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case Gi.SPEED_FERTILIZER:o=pt.CHAT_TYPE_PET_SPEED_FERTILIZE;break}this.listener.events.dispatchEvent(new pt(pt.CHAT_EVENT,e,i.roomIndex,"",o,Si.GENERIC,null,n))}onFloodControlEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=s.seconds;this.listener.events.dispatchEvent(new pt(pt.FLOOD_EVENT,e,-1,i.toString(),0,0))}onRemainingMuteEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&this.listener.events.dispatchEvent(new pt(pt.CHAT_EVENT,e,e.ownRoomIndex,"",pt.CHAT_TYPE_MUTE_REMAINING,Si.GENERIC,null,s.seconds))}}class Yet extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new Ef(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(t){if(!(t instanceof Ef))return;const e=t.getParser();if(!e||e.roomForward)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.data;s.tradeMode=i.tradeMode,s.isGuildRoom=i.habboGroupId!==0,s.doorMode=i.doorMode,s.allowPets=i.allowPets,s.moderationSettings=e.moderation,this.listener.events.dispatchEvent(new Zd(Zd.RSDUE_ALLOW_PETS,s)),this.listener.events.dispatchEvent(new ot(ot.ROOM_DATA,s))}}class Wet extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new Wv(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new qd(qd.ROOM_DIMMER_PRESETS,s);i.selectedPresetId=e.selectedPresetId;let n=0;for(;n<e.presetCount;){const a=e.getPreset(n);a&&i.storePreset(a.id,a.type,a.color,a.brightness),n++}this.listener&&this.listener.events.dispatchEvent(i)}}class Xet extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new If(this.onRoomRightsEvent.bind(this))),t.addMessageEvent(new mf(this.onRoomRightsClearEvent.bind(this))),t.addMessageEvent(new Tf(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(t){if(!(t instanceof If))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(t.getParser().controllerLevel)}onRoomRightsClearEvent(t){if(!(t instanceof mf))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(Ts.NONE)}onRoomRightsOwnerEvent(t){if(!(t instanceof Tf))return;const e=this.listener.getSession(this.roomId);e&&e.setRoomOwner()}}class Ket extends tr{constructor(t,e){super(t,e),t&&t.addMessageEvent(new bv(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener&&this.listener.events&&this.listener.events.dispatchEvent(new Qd(Qd.RSPE_PRESENT_OPENED,s,e.classId,e.itemType,e.productCode,e.placedItemId,e.placedItemType,e.placedInRoom,e.petFigureString))}}const X_=class Go extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new Rf(this.onRoomEnterEvent.bind(this))),t.addMessageEvent(new Va(this.onRoomReadyMessageEvent.bind(this))),t.addMessageEvent(new df(this.onDesktopViewEvent.bind(this))),t.addMessageEvent(new pf(this.onRoomDoorbellAcceptedEvent.bind(this))),t.addMessageEvent(new gf(this.onRoomDoorbellRejectedEvent.bind(this))),t.addMessageEvent(new Jv(this.onYouAreSpectatorMessageEvent.bind(this)))}onRoomEnterEvent(t){t instanceof Rf&&this.listener&&this.listener.sessionUpdate(this.roomId,Go.RS_CONNECTED)}onRoomReadyMessageEvent(t){if(!(t instanceof Va))return;const e=this.roomId,s=t.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(e,s),this.listener.sessionUpdate(this.roomId,Go.RS_READY))}onDesktopViewEvent(t){t instanceof df&&this.listener&&this.listener.sessionUpdate(this.roomId,Go.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(t){if(!(t instanceof pf)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)this.connection.send(new vS(this.roomId));else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new Zr(Zr.RSDE_ACCEPTED,i,s))}}onRoomDoorbellRejectedEvent(t){if(!(t instanceof gf)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)this.listener.sessionUpdate(this.roomId,Go.RS_DISCONNECTED);else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new Zr(Zr.RSDE_REJECTED,i,s))}}onYouAreSpectatorMessageEvent(t){if(this.listener){const e=this.listener.getSession(this.roomId);if(!e)return;e.isSpectator=!0,this.listener.events.dispatchEvent(new Jd(Jd.SPECTATOR_MODE,e))}}};X_.RS_CONNECTED="RS_CONNECTED";X_.RS_READY="RS_READY";X_.RS_DISCONNECTED="RS_DISCONNECTED";let wu=X_;class qet{constructor(){this._adultLevel=7}get id(){return this._id}set id(t){this._id=t}get level(){return this._level}set level(t){this._level=t}get maximumLevel(){return this._maximumLevel}set maximumLevel(t){this._maximumLevel=t}get experience(){return this._experience}set experience(t){this._experience=t}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(t){this._levelExperienceGoal=t}get energy(){return this._energy}set energy(t){this._energy=t}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(t){this._maximumEnergy=t}get happyness(){return this._happyness}set happyness(t){this._happyness=t}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(t){this._maximumHappyness=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get respect(){return this._respect}set respect(t){this._respect=t}get age(){return this._age}set age(t){this._age=t}get unknownRarity(){return this._unknownRarity}set unknownRarity(t){this._unknownRarity=t}get saddle(){return this._saddle}set saddle(t){this._saddle=t}get rider(){return this._rider}set rider(t){this._rider=t}get skillTresholds(){return this._skillThresholds}set skillTresholds(t){this._skillThresholds=t}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(t){this._publiclyRideable=t}get breedable(){return this._breedable}set breedable(t){this._breedable=t}get fullyGrown(){return this._fullyGrown}set fullyGrown(t){this._fullyGrown=t}get dead(){return this._dead}set dead(t){this._dead=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(t){this._maximumTimeToLive=t}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(t){this._remainingTimeToLive=t}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(t){this._remainingGrowTime=t}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(t){this._publiclyBreedable=t}get adultLevel(){return this._adultLevel}}class Qet{constructor(t){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=t}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(t){this._activityPoints=t}get name(){return this._name}set name(t){this._name=t}get type(){return this._type}set type(t){this._type=t}get sex(){return this._sex}set sex(t){this._sex=t}get figure(){return this._figure}set figure(t){this._figure=t}get custom(){return this._custom}set custom(t){this._custom=t}get webID(){return this._webID}set webID(t){this._webID=t}get groupId(){return this._groupID}set groupId(t){this._groupID=t}get groupName(){return this._groupName}set groupName(t){this._groupName=t}get groupStatus(){return this._groupStatus}set groupStatus(t){this._groupStatus=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._hasSaddle=t}get isRiding(){return this._isRiding}set isRiding(t){this._isRiding=t}get canBreed(){return this._canBreed}set canBreed(t){this._canBreed=t}get canHarvest(){return this._canHarvest}set canHarvest(t){this._canHarvest=t}get canRevive(){return this._canRevive}set canRevive(t){this._canRevive=t}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._hasBreedingPermission=t}get petLevel(){return this._petLevel}set petLevel(t){this._petLevel=t}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isModerator=t}}class Zet extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new Ul(this.onRoomUnitEvent.bind(this))),t.addMessageEvent(new xl(this.onRoomUnitInfoEvent.bind(this))),t.addMessageEvent(new Fl(this.onRoomUnitRemoveEvent.bind(this))),t.addMessageEvent(new Ll(this.onRoomUnitDanceEvent.bind(this))),t.addMessageEvent(new lA(this.onUserCurrentBadgesEvent.bind(this))),t.addMessageEvent(new Dv(this.onRoomDoorbellEvent.bind(this))),t.addMessageEvent(new dE(this.onUserNameChangeMessageEvent.bind(this))),t.addMessageEvent(new Ov(this.onNewFriendRequestEvent.bind(this))),t.addMessageEvent(new qv(this.onPetInfoEvent.bind(this))),t.addMessageEvent(new Qv(this.onPetStatusUpdateEvent.bind(this))),t.addMessageEvent(new qX(this.onPetBreedingMessageEvent.bind(this))),t.addMessageEvent(new wv(this.onPetLevelUpdateMessageEvent.bind(this))),t.addMessageEvent(new c4(this.onConfirmBreedingResultEvent.bind(this))),t.addMessageEvent(new d4(this.onNestBreedingSuccessEvent.bind(this))),t.addMessageEvent(new _4(this.onConfirmBreedingRequestEvent.bind(this))),t.addMessageEvent(new bl(this.onPetFigureUpdateEvent.bind(this))),t.addMessageEvent(new Xv(this.onPetBreedingResultEvent.bind(this))),t.addMessageEvent(new Uv(this.onPetPlacingError.bind(this))),t.addMessageEvent(new Lv(this.onBotError.bind(this))),t.addMessageEvent(new Yv(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser().users,i=[];if(s&&s.length)for(const n of s){if(!n)continue;const a=new Qet(n.roomIndex);a.name=n.name,a.custom=n.custom,a.activityPoints=n.activityPoints,a.figure=n.figure,a.type=n.userType,a.webID=n.webID,a.groupId=n.groupID,a.groupName=n.groupName,a.groupStatus=n.groupStatus,a.sex=n.sex,a.ownerId=n.ownerId,a.ownerName=n.ownerName,a.rarityLevel=n.rarityLevel,a.hasSaddle=n.hasSaddle,a.isRiding=n.isRiding,a.canBreed=n.canBreed,a.canHarvest=n.canHarvest,a.canRevive=n.canRevive,a.hasBreedingPermission=n.hasBreedingPermission,a.petLevel=n.petLevel,a.botSkills=n.botSkills,a.isModerator=n.isModerator,e.userDataManager.getUserData(n.roomIndex)||i.push(a),e.userDataManager.updateUserData(a)}this.listener.events.dispatchEvent(new YF(e,i))}onRoomUnitInfoEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&(e.userDataManager.updateFigure(s.unitId,s.figure,s.gender,!1,!1),e.userDataManager.updateMotto(s.unitId,s.motto),e.userDataManager.updateAchievementScore(s.unitId,s.achievementScore),this.listener.events.dispatchEvent(new WF(e,s.unitId,s.figure,s.gender,s.motto,s.achievementScore)))}onRoomUnitRemoveEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);e&&e.userDataManager.removeUserData(t.getParser().unitId)}onRoomUnitDanceEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new DF(s,e.unitId,e.danceId))}onUserCurrentBadgesEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.setUserBadges(e.userId,e.badges),this.listener.events.dispatchEvent(new zF(s,e.userId,e.badges)))}onRoomDoorbellEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new Zr(Zr.DOORBELL,i,s))}onUserNameChangeMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&s.userDataManager.updateName(e.id,e.newName)}onNewFriendRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.request;this.listener.events.dispatchEvent(new xF(s,i.requestId,i.requesterUserId,i.requesterName))}onPetInfoEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new qet;i.id=e.id,i.level=e.level,i.maximumLevel=e.maximumLevel,i.experience=e.experience,i.levelExperienceGoal=e.levelExperienceGoal,i.energy=e.energy,i.maximumEnergy=e.maximumEnergy,i.happyness=e.happyness,i.maximumHappyness=e.maximumHappyness,i.ownerId=e.ownerId,i.ownerName=e.ownerName,i.respect=e.respect,i.age=e.age,i.unknownRarity=e.unknownRarity,i.saddle=e.saddle,i.rider=e.rider,i.breedable=e.breedable,i.fullyGrown=e.fullyGrown,i.rarityLevel=e.rarityLevel,i.dead=e.dead,i.skillTresholds=e.skillTresholds,i.publiclyRideable=e.publiclyRideable,i.maximumTimeToLive=e.maximumTimeToLive,i.remainingTimeToLive=e.remainingTimeToLive,i.remainingGrowTime=e.remainingGrowTime,i.publiclyBreedable=e.publiclyBreedable,this.listener.events.dispatchEvent(new VF(s,i))}onPetStatusUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetBreedingStatus(e.roomIndex,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission),this.listener.events.dispatchEvent(new jF(s,e.petId,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission)))}onPetBreedingMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new wF(s,e.state,e.ownPetId,e.otherPetId))}onPetLevelUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetLevel(e.roomIndex,e.level),this.listener.events.dispatchEvent(new kF(s,e.petId,e.level)))}onConfirmBreedingResultEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new PF(s,e.breedingNestStuffId,e.result))}onNestBreedingSuccessEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new FF(s,e.petId,e.rarityCategory))}onConfirmBreedingRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new bF(s,e.nestId,e.pet1,e.pet2,e.rarityCategories,e.resultPetType))}onPetFigureUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.figureData.figuredata;s.userDataManager.updateFigure(e.roomIndex,i,"",e.hasSaddle,e.isRiding),this.listener.events.dispatchEvent(new HF(s,e.petId,i))}onPetBreedingResultEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new GF(s,e.resultData,e.otherResultData))}onPetPlacingError(t){if(!t||!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case 0:i=Zt.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:i=Zt.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:i=Zt.RSEME_MAX_PETS;break;case 3:i=Zt.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:i=Zt.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:i=Zt.RSEME_MAX_NUMBER_OF_OWN_PETS;break}!i||i.length==0||this.listener.events.dispatchEvent(new Zt(i,s))}onBotError(t){if(!t||!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case 0:i=Zt.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:i=Zt.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:i=Zt.RSEME_BOT_LIMIT_REACHED;break;case 3:i=Zt.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:i=Zt.RSEME_BOT_NAME_NOT_ACCEPTED;break}!i||i.length==0||this.listener.events.dispatchEvent(new Zt(i,s))}onFavoriteMembershipUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser(),s=this.listener.getSession(this.roomId);if(!s)return;const i=s.userDataManager.getUserDataByIndex(e.roomIndex);i&&(i.groupId=e.groupId,i.groupName=e.groupName,this.listener.events.dispatchEvent(new UF(s,e.roomIndex,e.groupId,e.status,e.groupName)))}}class Jet extends tr{constructor(t,e){super(t,e),t.addMessageEvent(new jv(this.onQuestionEvent.bind(this))),t.addMessageEvent(new kv(this.onQuestionAnsweredEvent.bind(this))),t.addMessageEvent(new zv(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new zr(zr.QUESTION,e,s.pollId);i.question=s.question,i.duration=s.duration,i.pollType=s.pollType,i.questionId=s.questionId,i.pollId=s.pollId,this.listener.events.dispatchEvent(i)}onQuestionAnsweredEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new zr(zr.ANSWERED,e,s.userId);i.value=s.value,i.userId=s.userId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}onQuestionFinishedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new zr(zr.FINISHED,e);i.questionId=s.questionId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}}class $et{constructor(t){this._sessionDataManager=t,this._ignoredUsers=[]}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new fA(this.onIgnoredUsersEvent.bind(this)),new fE(this.onIgnoreResultEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}}requestIgnoredUsers(){this._sessionDataManager.send(new GS(this._sessionDataManager.userName))}onIgnoredUsersEvent(t){if(!t)return;const e=t.getParser();e&&(this._ignoredUsers=e.ignoredUsers)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.name;switch(e.result){case 0:return;case 1:this.addUserToIgnoreList(s);return;case 2:this.addUserToIgnoreList(s),this._ignoredUsers.shift();return;case 3:this.removeUserFromIgnoreList(s);return}}addUserToIgnoreList(t){this._ignoredUsers.indexOf(t)<0&&this._ignoredUsers.push(t)}removeUserFromIgnoreList(t){const e=this._ignoredUsers.indexOf(t);e>=0&&this._ignoredUsers.splice(e,1)}ignoreUserId(t){this._sessionDataManager.send(new VS(t))}ignoreUser(t){this._sessionDataManager.send(new HS(t))}unignoreUser(t){this._sessionDataManager.send(new kS(t))}isIgnored(t){return this._ignoredUsers.indexOf(t)>=0}get disposed(){return!!this._sessionDataManager}}class tst{constructor(t,e,s){this._type=t,this._name=e,this._description=s}get type(){return this._type}get name(){return this._name}get description(){return this._description}}const HE=class gg extends vs{constructor(t){super(),this._products=t}dispose(){this._products=null}loadProductData(t){t&&fetch(t).then(e=>e.json()).then(e=>this.onProductDataLoadedEvent(e)).catch(e=>this.onProductDataError(e))}onProductDataLoadedEvent(t){t&&(this.parseProducts(t.productdata),this.dispatchEvent(new It(gg.PDP_PRODUCT_DATA_READY)))}onProductDataError(t){t&&this.dispatchEvent(new It(gg.PDP_PRODUCT_DATA_FAILED))}parseProducts(t){if(t)for(const e of t.product)e&&this._products.set(e.code,new tst(e.code,e.name,e.description))}};HE.PDP_PRODUCT_DATA_READY="PDP_PRODUCT_DATA_READY";HE.PDP_PRODUCT_DATA_FAILED="PDP_PRODUCT_DATA_FAILED";let rd=HE;const iu=class Bo extends ds{constructor(){super(),this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(t){this._connection=t}getUserData(t){return this.getDataByType(t,Bo.TYPE_USER)}getPetData(t){return this.getDataByType(t,Bo.TYPE_PET)}getBotData(t){return this.getDataByType(t,Bo.TYPE_BOT)}getRentableBotData(t){return this.getDataByType(t,Bo.TYPE_RENTABLE_BOT)}getDataByType(t,e){const s=this._userDataByType.get(e);if(!s)return null;const i=s.get(t);return i||null}getUserDataByIndex(t){const e=this._userDataByRoomIndex.get(t);return e||null}getUserDataByName(t){for(const e of this._userDataByRoomIndex.values())if(!(!e||e.name!==t))return e;return null}updateUserData(t){if(!t)return;this.removeUserData(t.roomIndex);let e=this._userDataByType.get(t.type);e||(e=new Map,this._userDataByType.set(t.type,e)),e.set(t.webID,t),this._userDataByRoomIndex.set(t.roomIndex,t)}removeUserData(t){const e=this.getUserDataByIndex(t);if(!e)return;this._userDataByRoomIndex.delete(t);const s=this._userDataByType.get(e.type);s&&s.delete(e.webID)}getUserBadges(t){this._connection&&this._connection.send(new jS(t));const e=this._userBadges.get(t);return e||[]}setUserBadges(t,e){this._userBadges.set(t,e)}updateFigure(t,e,s,i,n){const a=this.getUserDataByIndex(t);a&&(a.figure=e,a.sex=s,a.hasSaddle=i,a.isRiding=n)}updateName(t,e){const s=this.getUserDataByIndex(t);s&&(s.name=e)}updateMotto(t,e){const s=this.getUserDataByIndex(t);s&&(s.custom=e)}updateAchievementScore(t,e){const s=this.getUserDataByIndex(t);s&&(s.activityPoints=e)}updatePetLevel(t,e){const s=this.getUserDataByIndex(t);s&&(s.petLevel=e)}updatePetBreedingStatus(t,e,s,i,n){const a=this.getUserDataByIndex(t);a&&(a.canBreed=e,a.canHarvest=s,a.canRevive=i,a.hasBreedingPermission=n)}requestPetInfo(t){!this._connection||!this.getPetData(t)||this._connection.send(new DA(t))}get connection(){return this._connection}};iu.TYPE_USER=1;iu.TYPE_PET=2;iu.TYPE_BOT=3;iu.TYPE_RENTABLE_BOT=4;let est=iu;class sst extends ds{constructor(){super(),this._connection=null,this._userData=new est,this._roomId=0,this._password=null,this._state=ot.CREATED,this._tradeMode=EF.NO_TRADING,this._doorMode=0,this._controllerLevel=Ts.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(t){this._connection||!t||(this._connection=t,this._userData&&this._userData.setConnection(t))}setControllerLevel(t){if(t>=Ts.NONE&&t<=Ts.MODERATOR){this._controllerLevel=t;return}this._controllerLevel=Ts.NONE}setOwnRoomIndex(t){this._ownRoomIndex=t}setRoomOwner(){this._isRoomOwner=!0}start(){return this._state!==ot.CREATED||!this._connection?!1:(this._state=ot.STARTED,this.enterRoom())}enterRoom(){return this._connection?(this._connection.send(new HA(this._roomId,this._password)),!0):!1}reset(t){t!==this._roomId&&(this._roomId=t)}sendChatMessage(t,e){this._connection.send(new EE(t,e))}sendShoutMessage(t,e){this._connection.send(new AS(t,e))}sendWhisperMessage(t,e,s){this._connection.send(new SS(t,e,s))}sendChatTypingMessage(t){t?this._connection.send(new yS):this._connection.send(new MS)}sendMottoMessage(t){this._connection.send(new zS(t))}sendDanceMessage(t){this._connection.send(new NS(t))}sendExpressionMessage(t){this._connection.send(new CS(t))}sendSignMessage(t){t<0||t>17||this._connection.send(new DS(t))}sendPostureMessage(t){this._connection.send(new PS(t))}sendDoorbellApprovalMessage(t,e){this._connection.send(new BA(t,e))}sendAmbassadorAlertMessage(t){this._connection.send(new VA(t))}sendKickMessage(t){this._connection.send(new zA(t))}sendMuteMessage(t,e){this._connection.send(new YA(t,e,this._roomId))}sendBanMessage(t,e){this._connection.send(new kA(t,this._roomId,e))}sendGiveRightsMessage(t){this._connection.send(new jA(t))}sendTakeRightsMessage(t){this._connection.send(new WA(t))}sendPollStartMessage(t){this._connection.send(new GA(t))}sendPollRejectMessage(t){this._connection.send(new wA(t))}sendPollAnswerMessage(t,e,s){this._connection.send(new FA(t,e,s))}sendPeerUsersClassificationMessage(t){this._connection.send(new XS(t))}sendOpenPetPackageMessage(t,e){this._connection.send(new IS(t,e))}sendRoomUsersClassificationMessage(t){this._connection.send(new KS(t))}updateMoodlightData(t,e,s,i,n){let a="000000"+s.toString(16).toUpperCase();a="#"+a.substring(a.length-6),this.connection.send(new aS(t,e,a,i,n))}toggleMoodlightState(){this.connection.send(new oS)}pickupPet(t){this._connection&&this._connection.send(new tS(t))}pickupBot(t){this._connection&&this._connection.send(new KA(t))}requestMoodlightSettings(){this._connection&&this._connection.send(new nS)}openGift(t){this._connection.send(new TS(t))}mountPet(t){this._connection.send(new Zf(t,!0))}dismountPet(t){this._connection.send(new Zf(t,!1))}usePetProduct(t,e){this._connection.send(new xA(t,e))}removePetSaddle(t){this._connection.send(new PA(t))}togglePetBreeding(t){this._connection.send(new LA(t))}togglePetRiding(t){this._connection.send(new UA(t))}useMultistateItem(t){this._connection.send(new gE(t))}harvestPet(t){this._connection.send(new JA(t))}compostPlant(t){this._connection.send(new QA(t))}requestPetCommands(t){this._connection.send(new NA(t))}sendScriptProceed(){this._connection.send(new CA)}sendUpdateClothingChangeFurniture(t,e,s){this._connection.send(new sS(t,e,s))}changeQueue(t){this._connection.send(new OS(t))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get password(){return this._password}set password(t){this._password=t}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(t){this._isGuildRoom=t}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(t){this._isDecorating=t}get isSpectator(){return this._isSpectator}set isSpectator(t){this._isSpectator=t}get moderationSettings(){return this._moderationSettings}set moderationSettings(t){this._moderationSettings=t}}class rst extends Rr{constructor(t,e){super(),this._communication=t,this._roomEngine=e,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(At.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(At.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const t=this._communication&&this._communication.connection;t&&this._handlers.push(new zet(t,this),new Yet(t,this),new Wet(t,this),new Xet(t,this),new wu(t,this),new Zet(t,this),new Ket(t,this),new Vet(t,this),new Jet(t,this),new jet(t,this),new ket(t,this))}setHandlers(t){if(!(!this._handlers||!this._handlers.length))for(const e of this._handlers)e&&e.setRoomId(t.roomId)}onRoomEngineEvent(t){this.processPendingSession()}processPendingSession(){!this._pendingSession||!this._roomEngine.ready||(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(t){const e=this._sessions.get(this.getRoomId(t));return e||null}createSession(t,e=null){const s=new sst;return s.roomId=t,s.password=e,this.addSession(s)}addSession(t){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(t.roomId))&&this.removeSession(t.roomId,!1),t.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(t.roomId),t),this.events.dispatchEvent(new ot(ot.CREATED,t)),this._viewerSession=t,this.startSession(this._viewerSession),!0):(this._pendingSession=t,!1)}startSession(t){return t.state===ot.STARTED?!1:(this._sessionStarting=!1,t.start()?(this.events.dispatchEvent(new ot(ot.STARTED,t)),this.setHandlers(t),!0):(this.removeSession(t.roomId),!1))}removeSession(t,e=!0){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),this.events.dispatchEvent(new ot(ot.ENDED,s,e)),s.dispose())}sessionUpdate(t,e){if(this.getSession(t))switch(e){case wu.RS_CONNECTED:return;case wu.RS_READY:return;case wu.RS_DISCONNECTED:this.removeSession(t);return}}sessionReinitialize(t,e){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),s.reset(e),this._sessions.set(this.getRoomId(e),s),this.setHandlers(s))}getRoomId(t){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}const K_=class g0{static logEventLog(t){try{Ot.available&&Ot.call("logEventLog",t)}catch{Y.log("External interface not working, failed to log event log.")}}static openPage(t){try{Ot.available&&Ot.call("openPage",t)}catch{Y.log("Failed to open web page",t)}}static openWebPage(t){window.open(t)}static sendHeartBeat(){try{Ot.available&&Ot.call("heartBeat")}catch{Y.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(t){try{Ot.available&&g0.openPage(t)}catch{Y.log("Failed to open web page",t)}}static closeWebPageAndRestoreClient(){try{Ot.available&&Ot.call("closeWebPageAndRestoreClient")}catch{Y.log("Failed to close web page and restore client!")}}static openHabblet(t,e=null){try{Ot.available&&Ot.call("openHabblet",t,e)}catch{Y.log("Failed to open Habblet",t)}}static closeHabblet(t,e=null){try{Ot.available&&Ot.call("closeHabblet",t,e)}catch{Y.log("Failed to close Habblet",t)}}static send(t,e){try{Ot.available&&Ot.call("disconnect",t,e)}catch{Y.log("Failed to close send ")}}static showGame(t){try{Ot.available&&Ot.callGame("showGame",t)}catch(e){Y.log("Failed to open game",e)}}static hideGame(){try{Ot.available&&Ot.callGame("hideGame")}catch{Y.log("Failed to hide game")}}static open(t){try{Ot.available&&Ot.call("openExternalLink",escape(t))}catch{Y.log("External interface not working. Could not request to open: "+t)}}static roomVisited(t){try{Ot.available&&Ot.call("roomVisited",t)}catch{Y.log("External interface not working. Could not store last room visit.")}}static openMinimail(t){try{Ot.available&&Ot.call("openMinimail",t)}catch{Y.log("External interface not working. Could not open minimail.")}}static openNews(){try{Ot.available&&Ot.call("openNews")}catch{Y.log("External interface not working. Could not open news.")}}static closeNews(){try{Ot.available&&Ot.call("closeNews")}catch{Y.log("External interface not working. Could not close news.")}}static openAvatars(){try{Ot.available&&Ot.call("openAvatars")}catch{Y.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{Ot.available&&Ot.call("openRoomEnterAd")}catch{Y.log("External interface not working. Could not open roomenterad.")}}static updateFigure(t){try{Ot.available&&Ot.call("updateFigure",t)}catch{Y.log("External interface not working. Could not update figure.")}}};K_.ADVERTISEMENT="advertisement";K_.OPENLINK="openlink";K_.OPENROOM="openroom";let Xl=K_;class ist extends Rr{constructor(t){super(),this._communication=t,this.resetUserInfo(),this._ignoredUsersManager=new $et(this),this._groupInformationManager=new Het(this),this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._noobnessLevel=-1,this._isEmailVerified=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=null,this._furnitureReady=!1,this._productsReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._pendingProductListeners=[],this._tags=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this),this.onProductDataReadyEvent=this.onProductDataReadyEvent.bind(this),this.onNitroSettingsEvent=this.onNitroSettingsEvent.bind(this)}onInit(){this.loadFurnitureData(),this.loadProductData(),this.loadBadgeImageManager(),this._ignoredUsersManager&&this._ignoredUsersManager.init(),this._groupInformationManager&&this._groupInformationManager.init(),this._communication.registerMessageEvent(new Tv(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new wl(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new hA(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new Iv(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new Gv(this.onPetRespectFailed.bind(this))),this._communication.registerMessageEvent(new Ks(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new dE(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new _A(this.onUserTags.bind(this))),this._communication.registerMessageEvent(new Va(this.onRoomModelNameEvent.bind(this))),this._communication.registerMessageEvent(new gA(this.onInClientLinkEvent.bind(this))),this._communication.registerMessageEvent(new Pv(this.onMysteryBoxKeysEvent.bind(this))),this._communication.registerMessageEvent(new Sv(this.onNoobnessLevelMessageEvent.bind(this))),this._communication.registerMessageEvent(new uA(this.onAccountSafetyLockStatusChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new cA(this.onEmailStatus.bind(this))),Q.instance.events.addEventListener(Qo.SETTINGS_UPDATED,this.onNitroSettingsEvent)}onDispose(){this.destroyFurnitureData(),this._ignoredUsersManager&&(this._ignoredUsersManager.dispose(),this._ignoredUsersManager=null),this._groupInformationManager&&(this._groupInformationManager.dispose(),this._groupInformationManager=null),Q.instance.events.removeEventListener(Qo.SETTINGS_UPDATED,this.onNitroSettingsEvent),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1,this._safetyLocked=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new sd(this._floorItems,this._wallItems,Q.instance.localization),this._furnitureData.addEventListener(sd.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(at.getValue("furnidata.url"))}loadProductData(){this.destroyProductData(),this._productData=new rd(this._products),this._productData.addEventListener(rd.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productData.loadProductData(at.getValue("productdata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new Fu(Cs(),this),this._badgeImageManager.init())}hasProductData(t){return this._productsReady?!0:(t&&this._pendingProductListeners.indexOf(t)===-1&&this._pendingProductListeners.push(t),!1)}getAllFurnitureData(t){if(!this._furnitureReady)return this._pendingFurnitureListeners.indexOf(t)===-1&&this._pendingFurnitureListeners.push(t),null;const e=[];for(const s of this._floorItems.values())s&&e.push(s);for(const s of this._wallItems.values())s&&e.push(s);return e}removePendingFurniDataListener(t){if(!this._pendingFurnitureListeners)return;const e=this._pendingFurnitureListeners.indexOf(t);e!==-1&&this._pendingFurnitureListeners.splice(e,1)}onUserFigureEvent(t){!t||!t.connection||(this._figure=t.getParser().figure,this._gender=t.getParser().gender,Xl.updateFigure(this._figure))}onUserInfoEvent(t){if(!t||!t.connection)return;this.resetUserInfo();const e=t.getParser().userInfo;e&&(this._userId=e.userId,this._name=e.username,this._figure=e.figure,this._gender=e.gender,this._realName=e.realName,this._respectsReceived=e.respectsReceived,this._respectsLeft=e.respectsRemaining,this._respectsPetLeft=e.respectsPetRemaining,this._canChangeName=e.canChangeName,this._safetyLocked=e.safetyLocked,this._ignoredUsersManager&&this._ignoredUsersManager.requestIgnoredUsers())}onUserPermissionsEvent(t){!t||!t.connection||(this._clubLevel=t.getParser().clubLevel,this._securityLevel=t.getParser().securityLevel,this._isAmbassador=t.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._systemOpen=e.isOpen,this._systemShutdown=e.onShutdown,this._isAuthenticHabbo=e.isAuthenticUser)}onPetRespectFailed(t){!t||!t.connection||this._respectsPetLeft++}onChangeNameUpdateEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.resultCode===Ks.NAME_OK&&(this._canChangeName=!1,this.events.dispatchEvent(new qm(e.name)))}onUserNameChangeMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.webId===this.userId&&(this._name=e.newName,this._canChangeName=!1,this.events.dispatchEvent(new qm(this._name)))}onUserTags(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._tags=e.tags)}onRoomModelNameEvent(t){if(!t)return;const e=t.getParser();e&&Xl.roomVisited(e.roomId)}onFurnitureDataReadyEvent(t){if(this._furnitureData.removeEventListener(sd.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const e of this._pendingFurnitureListeners)e&&e.loadFurnitureData();this._pendingProductListeners=[]}onProductDataReadyEvent(t){this._productData.removeEventListener(rd.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productsReady=!0;for(const e of this._pendingProductListeners)e&&e.loadProductData();this._pendingProductListeners=[]}onInClientLinkEvent(t){if(!t)return;const e=t.getParser();e&&Q.instance.createLinkEvent(e.link)}onMysteryBoxKeysEvent(t){if(!t)return;const e=t.getParser();e&&this.events.dispatchEvent(new CF(e.boxColor,e.keyColor))}onNoobnessLevelMessageEvent(t){this._noobnessLevel=t.getParser().noobnessLevel,this._noobnessLevel!==ba.OLD_IDENTITY&&at.setValue("new.identity",1)}onAccountSafetyLockStatusChangeMessageEvent(t){if(!t)return;const e=t.getParser();e&&(this._safetyLocked=e.status==p_.SAFETY_LOCK_STATUS_LOCKED)}onEmailStatus(t){if(!t)return;const e=t.getParser();e&&(this._isEmailVerified=e.isVerified)}onNitroSettingsEvent(t){this._isRoomCameraFollowDisabled=t.cameraFollow,this._uiFlags=t.flags,this.events.dispatchEvent(new KF(this._uiFlags))}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}destroyProductData(){this._productData&&(this._productData.dispose(),this._productData=null)}getFloorItemData(t){const e=this._floorItems.get(t);return e||null}getFloorItemDataByName(t){if(!t||!this._floorItems||!this._floorItems.size)return null;for(const e of this._floorItems.values())if(!(!e||e.className!==t))return e}getWallItemData(t){const e=this._wallItems.get(t);return e||null}getWallItemDataByName(t){if(!t||!this._wallItems||!this._wallItems.size)return null;for(const e of this._wallItems.values())if(!(!e||e.className!==t))return e}getProductData(t){return this._productsReady||this.loadProductData(),this._products.get(t)}getBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t)}getGroupBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t,Fu.GROUP_BADGE)}getBadgeImage(t){return this._badgeImageManager.getBadgeImage(t)}getGroupBadgeImage(t){return this._badgeImageManager.getBadgeImage(t,Fu.GROUP_BADGE)}getUserTags(t){t<0||this.send(new BS(t))}loadBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t)}loadGroupBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t,Fu.GROUP_BADGE)}hasSecurity(t){return this._securityLevel>=t}giveRespect(t){t<0||this._respectsLeft<=0||(this.send(new WS(t)),this._respectsLeft--)}givePetRespect(t){t<0||this._respectsPetLeft<=0||(this.send(new bA(t)),this._respectsPetLeft--)}sendSpecialCommandMessage(t,e=0){this.send(new EE(t))}ignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.ignoreUser(t)}unignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.unignoreUser(t)}isUserIgnored(t){return this._ignoredUsersManager&&this._ignoredUsersManager.isIgnored(t)}getGroupBadge(t){return this._groupInformationManager&&this._groupInformationManager.getGroupBadge(t)}send(t){this._communication.connection.send(t)}get communication(){return this._communication}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get isEmailVerified(){return this._isEmailVerified}get isNoob(){return this._noobnessLevel!==ba.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===ba.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=qs.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}get tags(){return this._tags}}class E0 extends M_{constructor(t,e,s,i,n=""){super(t,e,s,i),this._jukeboxDiskId=-1,this._songData=n}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get songData(){return this._songData}set songData(t){this._songData=t}get diskId(){return this._jukeboxDiskId}set diskId(t){this._jukeboxDiskId=t}}class nst{constructor(t,e,s,i,n){this._songId=t,this._startPos=e,this._playLength=s,this._fadeInSeconds=i,this._fadeOutSeconds=n,this._playRequestTime=Date.now()}get songId(){return this._songId}get startPos(){return this._startPos<0?0:this._startPos+(Date.now()-this._playRequestTime)/1e3}get playLength(){return this._playLength}get playRequestTime(){return this._playRequestTime}get fadeInSeconds(){return this._fadeInSeconds}get fadeOutSeconds(){return this._fadeOutSeconds}}const p0=class m0 extends It{constructor(t,e){super(m0.NOTIFY_PLAYED_SONG),this._name=t,this._creator=e}get name(){return this._name}get creator(){return this._creator}};p0.NOTIFY_PLAYED_SONG="UIEW_NOTIFY_PLAYED_SONG";let ast=p0;class si extends It{constructor(t,e,s,i){super(t),this._id=s,this._position=i,this._priority=e}get id(){return this._id}get position(){return this._position}get priority(){return this._priority}}si.NPE_USER_PLAY_SONG="NPE_USER_PLAY_SONG";si.NPW_USER_STOP_SONG="NPW_USER_STOP_SONG";si.NPE_SONG_CHANGED="NPE_SONG_CHANGED";class vi extends It{constructor(t){super(t)}}vi.PLUE_PLAY_LIST_UPDATED="PLUE_PLAY_LIST_UPDATED";vi.PLUE_PLAY_LIST_FULL="PLUE_PLAY_LIST_FULL";class Ho extends It{constructor(t){super(t)}}Ho.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT="SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT";class Oh extends It{constructor(t,e){super(t),this._id=e}get id(){return this._id}}Oh.SIR_TRAX_SONG_INFO_RECEIVED="SIR_TRAX_SONG_INFO_RECEIVED";class vh extends It{constructor(t,e){super(t),this._id=e}get id(){return this._id}}vh.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";class Ze{}Ze.PRIORITY_ROOM_PLAYLIST=0;Ze.PRIORITY_USER_PLAYLIST=1;Ze.PRIORITY_SONG_PLAY=2;Ze.PRIORITY_PURCHASE_PREVIEW=3;Ze.PRIORITY_COUNT=4;class ost{constructor(){this._isPlaying=!1,this._disposed=!1,this._entries=[],this._missingSongInfo=[],this._messageEvents=[new nA(this.onNowPlayingMessageEvent.bind(this)),new iA(this.onJukeboxSongDisksMessageEvent.bind(this)),new rA(this.onJukeboxPlayListFullMessageEvent.bind(this))],this.onSongInfoReceivedEvent=this.onSongInfoReceivedEvent.bind(this)}init(){this._messageEvents.forEach(t=>Q.instance.communication.connection.addMessageEvent(t)),Q.instance.soundManager.events.addEventListener(Oh.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent)}get priority(){return Ze.PRIORITY_ROOM_PLAYLIST}onNowPlayingMessageEvent(t){const e=t.getParser();this._isPlaying=e.currentSongId!==-1,e.currentSongId>=0?(Q.instance.soundManager.musicController.playSong(e.currentSongId,Ze.PRIORITY_ROOM_PLAYLIST,e.syncCount/1e3,0,1,1),this._currentEntryId=e.currentSongId):this.stopPlaying(),e.nextSongId>=0&&Q.instance.soundManager.musicController.addSongInfoRequest(e.nextSongId),this._playPosition=e.currentPosition,Q.instance.soundManager.events.dispatchEvent(new si(si.NPE_SONG_CHANGED,Ze.PRIORITY_ROOM_PLAYLIST,e.currentSongId,e.currentPosition))}onJukeboxSongDisksMessageEvent(t){const e=t.getParser();this._entries=[];for(let s=0;s<e.songDisks.length;s++){const i=e.songDisks.getWithIndex(s),n=e.songDisks.getKey(s);let a=Q.instance.soundManager.musicController.getSongInfo(i);a==null&&(a=new E0(i,-1,null,null,null),this._missingSongInfo.indexOf(i)<0&&(this._missingSongInfo.push(i),Q.instance.soundManager.musicController.requestSongInfoWithoutSamples(i))),a.diskId=n,this._entries.push(a)}this._missingSongInfo.length==0&&Q.instance.soundManager.events.dispatchEvent(new vi(vi.PLUE_PLAY_LIST_UPDATED))}onJukeboxPlayListFullMessageEvent(t){Q.instance.soundManager.events.dispatchEvent(new vi(vi.PLUE_PLAY_LIST_FULL))}onSongInfoReceivedEvent(t){for(let s=0;s<this.length;s++){const i=this._entries[s];if(i.id===t.id){const n=i.diskId,a=Q.instance.soundManager.musicController.getSongInfo(t.id);a!=null&&(a.diskId=n,this._entries[s]=a);break}}const e=this._missingSongInfo.indexOf(t.id);e>=0&&this._missingSongInfo.splice(e,1),this._missingSongInfo.length==0&&Q.instance.soundManager.events.dispatchEvent(new vi(vi.PLUE_PLAY_LIST_UPDATED))}stopPlaying(){Q.instance.soundManager.musicController.stop(this.priority),this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1}get length(){return this._entries?this._entries.length:0}get playPosition(){return this._playPosition}get nowPlayingSongId(){return this._currentEntryId}get isPlaying(){return this._isPlaying}get entries(){return this._entries}getEntry(t){return t<0||t>=this._entries.length?null:this._entries[t]}requestPlayList(){Q.instance.communication.connection.send(new US)}dispose(){this._disposed||(this._disposed=!0,this.stopPlaying(),Q.instance.soundManager.events&&Q.instance.soundManager.events.removeEventListener(Oh.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent),this._messageEvents.forEach(t=>Q.instance.communication.connection.removeMessageEvent(t)),this._messageEvents=null)}}class hst{constructor(t){this._id=t,this._items=[]}addChannelItem(t){this._items.push(t)}get items(){return this._items}}class ust{constructor(t,e){this._id=t,this._length=e}get id(){return this._id}get length(){return this._length}}class Eg{constructor(t){this._channels=[],this._metaData=new Map;let e=[];const s=t.split(":"),i=s[s.length-1];if(i.indexOf("meta")>-1){const n=i.split(";");for(const a of n){const o=a.split(",");this._metaData.set(o[0],o[1])}e=s.slice(0,s.length-1)}else e=s;for(let n=0;n<e.length/2;n++)if(e[n*2].length>0){const a=parseInt(e[n*2]),o=e[n*2+1].split(";"),h=new hst(a);for(const u of o){const c=u.split(",");if(c.length!==2)return;h.addChannelItem(new ust(parseInt(c[0]),parseInt(c[1])))}this._channels.push(h)}}get channels(){return this._channels}getSampleIds(){const t=[];for(const e of this._channels)for(const s of e.items)t.indexOf(s.id)===-1&&t.push(s.id);return t}get hasMetaData(){return this._metaData.has("meta")}get metaCutMode(){return this._metaData.has("c")}get metaTempo(){const t=this._metaData.get("t");return t?parseInt(t):null}}var cn={};/*!
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(r){(function(){var t=function(){this.init()};t.prototype={init:function(){var l=this||e;return l._counter=1e3,l._html5AudioPool=[],l.html5PoolSize=10,l._codecs={},l._howls=[],l._muted=!1,l._volume=1,l._canPlayEvent="canplaythrough",l._navigator=typeof window<"u"&&window.navigator?window.navigator:null,l.masterGain=null,l.noAudio=!1,l.usingWebAudio=!0,l.autoSuspend=!0,l.ctx=null,l.autoUnlock=!0,l._setup(),l},volume:function(l){var _=this||e;if(l=parseFloat(l),_.ctx||c(),typeof l<"u"&&l>=0&&l<=1){if(_._volume=l,_._muted)return _;_.usingWebAudio&&_.masterGain.gain.setValueAtTime(l,e.ctx.currentTime);for(var d=0;d<_._howls.length;d++)if(!_._howls[d]._webAudio)for(var f=_._howls[d]._getSoundIds(),m=0;m<f.length;m++){var p=_._howls[d]._soundById(f[m]);p&&p._node&&(p._node.volume=p._volume*l)}return _}return _._volume},mute:function(l){var _=this||e;_.ctx||c(),_._muted=l,_.usingWebAudio&&_.masterGain.gain.setValueAtTime(l?0:_._volume,e.ctx.currentTime);for(var d=0;d<_._howls.length;d++)if(!_._howls[d]._webAudio)for(var f=_._howls[d]._getSoundIds(),m=0;m<f.length;m++){var p=_._howls[d]._soundById(f[m]);p&&p._node&&(p._node.muted=l?!0:p._muted)}return _},stop:function(){for(var l=this||e,_=0;_<l._howls.length;_++)l._howls[_].stop();return l},unload:function(){for(var l=this||e,_=l._howls.length-1;_>=0;_--)l._howls[_].unload();return l.usingWebAudio&&l.ctx&&typeof l.ctx.close<"u"&&(l.ctx.close(),l.ctx=null,c()),l},codecs:function(l){return(this||e)._codecs[l.replace(/^x-/,"")]},_setup:function(){var l=this||e;if(l.state=l.ctx&&l.ctx.state||"suspended",l._autoSuspend(),!l.usingWebAudio)if(typeof Audio<"u")try{var _=new Audio;typeof _.oncanplaythrough>"u"&&(l._canPlayEvent="canplay")}catch{l.noAudio=!0}else l.noAudio=!0;try{var _=new Audio;_.muted&&(l.noAudio=!0)}catch{}return l.noAudio||l._setupCodecs(),l},_setupCodecs:function(){var l=this||e,_=null;try{_=typeof Audio<"u"?new Audio:null}catch{return l}if(!_||typeof _.canPlayType!="function")return l;var d=_.canPlayType("audio/mpeg;").replace(/^no$/,""),f=l._navigator?l._navigator.userAgent:"",m=f.match(/OPR\/(\d+)/g),p=m&&parseInt(m[0].split("/")[1],10)<33,T=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,v=f.match(/Version\/(.*?) /),O=T&&v&&parseInt(v[1],10)<15;return l._codecs={mp3:!!(!p&&(d||_.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!d,opus:!!_.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!_.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!_.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(_.canPlayType('audio/wav; codecs="1"')||_.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!_.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!_.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(_.canPlayType("audio/x-m4a;")||_.canPlayType("audio/m4a;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(_.canPlayType("audio/x-m4b;")||_.canPlayType("audio/m4b;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(_.canPlayType("audio/x-mp4;")||_.canPlayType("audio/mp4;")||_.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!O&&_.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!O&&_.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!_.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(_.canPlayType("audio/x-flac;")||_.canPlayType("audio/flac;")).replace(/^no$/,"")},l},_unlockAudio:function(){var l=this||e;if(!(l._audioUnlocked||!l.ctx)){l._audioUnlocked=!1,l.autoUnlock=!1,!l._mobileUnloaded&&l.ctx.sampleRate!==44100&&(l._mobileUnloaded=!0,l.unload()),l._scratchBuffer=l.ctx.createBuffer(1,1,22050);var _=function(d){for(;l._html5AudioPool.length<l.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,l._releaseHtml5Audio(f)}catch{l.noAudio=!0;break}for(var m=0;m<l._howls.length;m++)if(!l._howls[m]._webAudio)for(var p=l._howls[m]._getSoundIds(),T=0;T<p.length;T++){var v=l._howls[m]._soundById(p[T]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}l._autoResume();var O=l.ctx.createBufferSource();O.buffer=l._scratchBuffer,O.connect(l.ctx.destination),typeof O.start>"u"?O.noteOn(0):O.start(0),typeof l.ctx.resume=="function"&&l.ctx.resume(),O.onended=function(){O.disconnect(0),l._audioUnlocked=!0,document.removeEventListener("touchstart",_,!0),document.removeEventListener("touchend",_,!0),document.removeEventListener("click",_,!0),document.removeEventListener("keydown",_,!0);for(var A=0;A<l._howls.length;A++)l._howls[A]._emit("unlock")}};return document.addEventListener("touchstart",_,!0),document.addEventListener("touchend",_,!0),document.addEventListener("click",_,!0),document.addEventListener("keydown",_,!0),l}},_obtainHtml5Audio:function(){var l=this||e;if(l._html5AudioPool.length)return l._html5AudioPool.pop();var _=new Audio().play();return _&&typeof Promise<"u"&&(_ instanceof Promise||typeof _.then=="function")&&_.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(l){var _=this||e;return l._unlocked&&_._html5AudioPool.push(l),_},_autoSuspend:function(){var l=this;if(!(!l.autoSuspend||!l.ctx||typeof l.ctx.suspend>"u"||!e.usingWebAudio)){for(var _=0;_<l._howls.length;_++)if(l._howls[_]._webAudio){for(var d=0;d<l._howls[_]._sounds.length;d++)if(!l._howls[_]._sounds[d]._paused)return l}return l._suspendTimer&&clearTimeout(l._suspendTimer),l._suspendTimer=setTimeout(function(){if(l.autoSuspend){l._suspendTimer=null,l.state="suspending";var f=function(){l.state="suspended",l._resumeAfterSuspend&&(delete l._resumeAfterSuspend,l._autoResume())};l.ctx.suspend().then(f,f)}},3e4),l}},_autoResume:function(){var l=this;if(!(!l.ctx||typeof l.ctx.resume>"u"||!e.usingWebAudio))return l.state==="running"&&l.ctx.state!=="interrupted"&&l._suspendTimer?(clearTimeout(l._suspendTimer),l._suspendTimer=null):l.state==="suspended"||l.state==="running"&&l.ctx.state==="interrupted"?(l.ctx.resume().then(function(){l.state="running";for(var _=0;_<l._howls.length;_++)l._howls[_]._emit("resume")}),l._suspendTimer&&(clearTimeout(l._suspendTimer),l._suspendTimer=null)):l.state==="suspending"&&(l._resumeAfterSuspend=!0),l}};var e=new t,s=function(l){var _=this;if(!l.src||l.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}_.init(l)};s.prototype={init:function(l){var _=this;return e.ctx||c(),_._autoplay=l.autoplay||!1,_._format=typeof l.format!="string"?l.format:[l.format],_._html5=l.html5||!1,_._muted=l.mute||!1,_._loop=l.loop||!1,_._pool=l.pool||5,_._preload=typeof l.preload=="boolean"||l.preload==="metadata"?l.preload:!0,_._rate=l.rate||1,_._sprite=l.sprite||{},_._src=typeof l.src!="string"?l.src:[l.src],_._volume=l.volume!==void 0?l.volume:1,_._xhr={method:l.xhr&&l.xhr.method?l.xhr.method:"GET",headers:l.xhr&&l.xhr.headers?l.xhr.headers:null,withCredentials:l.xhr&&l.xhr.withCredentials?l.xhr.withCredentials:!1},_._duration=0,_._state="unloaded",_._sounds=[],_._endTimers={},_._queue=[],_._playLock=!1,_._onend=l.onend?[{fn:l.onend}]:[],_._onfade=l.onfade?[{fn:l.onfade}]:[],_._onload=l.onload?[{fn:l.onload}]:[],_._onloaderror=l.onloaderror?[{fn:l.onloaderror}]:[],_._onplayerror=l.onplayerror?[{fn:l.onplayerror}]:[],_._onpause=l.onpause?[{fn:l.onpause}]:[],_._onplay=l.onplay?[{fn:l.onplay}]:[],_._onstop=l.onstop?[{fn:l.onstop}]:[],_._onmute=l.onmute?[{fn:l.onmute}]:[],_._onvolume=l.onvolume?[{fn:l.onvolume}]:[],_._onrate=l.onrate?[{fn:l.onrate}]:[],_._onseek=l.onseek?[{fn:l.onseek}]:[],_._onunlock=l.onunlock?[{fn:l.onunlock}]:[],_._onresume=[],_._webAudio=e.usingWebAudio&&!_._html5,typeof e.ctx<"u"&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(_),_._autoplay&&_._queue.push({event:"play",action:function(){_.play()}}),_._preload&&_._preload!=="none"&&_.load(),_},load:function(){var l=this,_=null;if(e.noAudio){l._emit("loaderror",null,"No audio support.");return}typeof l._src=="string"&&(l._src=[l._src]);for(var d=0;d<l._src.length;d++){var f,m;if(l._format&&l._format[d])f=l._format[d];else{if(m=l._src[d],typeof m!="string"){l._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(m),f||(f=/\.([^.]+)$/.exec(m.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&e.codecs(f)){_=l._src[d];break}}if(!_){l._emit("loaderror",null,"No codec support for selected audio sources.");return}return l._src=_,l._state="loading",window.location.protocol==="https:"&&_.slice(0,5)==="http:"&&(l._html5=!0,l._webAudio=!1),new i(l),l._webAudio&&a(l),l},play:function(l,_){var d=this,f=null;if(typeof l=="number")f=l,l=null;else{if(typeof l=="string"&&d._state==="loaded"&&!d._sprite[l])return null;if(typeof l>"u"&&(l="__default",!d._playLock)){for(var m=0,p=0;p<d._sounds.length;p++)d._sounds[p]._paused&&!d._sounds[p]._ended&&(m++,f=d._sounds[p]._id);m===1?l=null:f=null}}var T=f?d._soundById(f):d._inactiveSound();if(!T)return null;if(f&&!l&&(l=T._sprite||"__default"),d._state!=="loaded"){T._sprite=l,T._ended=!1;var v=T._id;return d._queue.push({event:"play",action:function(){d.play(v)}}),v}if(f&&!T._paused)return _||d._loadQueue("play"),T._id;d._webAudio&&e._autoResume();var O=Math.max(0,T._seek>0?T._seek:d._sprite[l][0]/1e3),A=Math.max(0,(d._sprite[l][0]+d._sprite[l][1])/1e3-O),y=A*1e3/Math.abs(T._rate),M=d._sprite[l][0]/1e3,N=(d._sprite[l][0]+d._sprite[l][1])/1e3;T._sprite=l,T._ended=!1;var P=function(){T._paused=!1,T._seek=O,T._start=M,T._stop=N,T._loop=!!(T._loop||d._sprite[l][2])};if(O>=N){d._ended(T);return}var b=T._node;if(d._webAudio){var D=function(){d._playLock=!1,P(),d._refreshBuffer(T);var ct=T._muted||d._muted?0:T._volume;b.gain.setValueAtTime(ct,e.ctx.currentTime),T._playStart=e.ctx.currentTime,typeof b.bufferSource.start>"u"?T._loop?b.bufferSource.noteGrainOn(0,O,86400):b.bufferSource.noteGrainOn(0,O,A):T._loop?b.bufferSource.start(0,O,86400):b.bufferSource.start(0,O,A),y!==1/0&&(d._endTimers[T._id]=setTimeout(d._ended.bind(d,T),y)),_||setTimeout(function(){d._emit("play",T._id),d._loadQueue()},0)};e.state==="running"&&e.ctx.state!=="interrupted"?D():(d._playLock=!0,d.once("resume",D),d._clearTimer(T._id))}else{var x=function(){b.currentTime=O,b.muted=T._muted||d._muted||e._muted||b.muted,b.volume=T._volume*e.volume(),b.playbackRate=T._rate;try{var ct=b.play();if(ct&&typeof Promise<"u"&&(ct instanceof Promise||typeof ct.then=="function")?(d._playLock=!0,P(),ct.then(function(){d._playLock=!1,b._unlocked=!0,_?d._loadQueue():d._emit("play",T._id)}).catch(function(){d._playLock=!1,d._emit("playerror",T._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),T._ended=!0,T._paused=!0})):_||(d._playLock=!1,P(),d._emit("play",T._id)),b.playbackRate=T._rate,b.paused){d._emit("playerror",T._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}l!=="__default"||T._loop?d._endTimers[T._id]=setTimeout(d._ended.bind(d,T),y):(d._endTimers[T._id]=function(){d._ended(T),b.removeEventListener("ended",d._endTimers[T._id],!1)},b.addEventListener("ended",d._endTimers[T._id],!1))}catch(H){d._emit("playerror",T._id,H)}};b.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(b.src=d._src,b.load());var V=window&&window.ejecta||!b.readyState&&e._navigator.isCocoonJS;if(b.readyState>=3||V)x();else{d._playLock=!0,d._state="loading";var J=function(){d._state="loaded",x(),b.removeEventListener(e._canPlayEvent,J,!1)};b.addEventListener(e._canPlayEvent,J,!1),d._clearTimer(T._id)}}return T._id},pause:function(l){var _=this;if(_._state!=="loaded"||_._playLock)return _._queue.push({event:"pause",action:function(){_.pause(l)}}),_;for(var d=_._getSoundIds(l),f=0;f<d.length;f++){_._clearTimer(d[f]);var m=_._soundById(d[f]);if(m&&!m._paused&&(m._seek=_.seek(d[f]),m._rateSeek=0,m._paused=!0,_._stopFade(d[f]),m._node))if(_._webAudio){if(!m._node.bufferSource)continue;typeof m._node.bufferSource.stop>"u"?m._node.bufferSource.noteOff(0):m._node.bufferSource.stop(0),_._cleanBuffer(m._node)}else(!isNaN(m._node.duration)||m._node.duration===1/0)&&m._node.pause();arguments[1]||_._emit("pause",m?m._id:null)}return _},stop:function(l,_){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"stop",action:function(){d.stop(l)}}),d;for(var f=d._getSoundIds(l),m=0;m<f.length;m++){d._clearTimer(f[m]);var p=d._soundById(f[m]);p&&(p._seek=p._start||0,p._rateSeek=0,p._paused=!0,p._ended=!0,d._stopFade(f[m]),p._node&&(d._webAudio?p._node.bufferSource&&(typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),d._cleanBuffer(p._node)):(!isNaN(p._node.duration)||p._node.duration===1/0)&&(p._node.currentTime=p._start||0,p._node.pause(),p._node.duration===1/0&&d._clearSound(p._node))),_||d._emit("stop",p._id))}return d},mute:function(l,_){var d=this;if(d._state!=="loaded"||d._playLock)return d._queue.push({event:"mute",action:function(){d.mute(l,_)}}),d;if(typeof _>"u")if(typeof l=="boolean")d._muted=l;else return d._muted;for(var f=d._getSoundIds(_),m=0;m<f.length;m++){var p=d._soundById(f[m]);p&&(p._muted=l,p._interval&&d._stopFade(p._id),d._webAudio&&p._node?p._node.gain.setValueAtTime(l?0:p._volume,e.ctx.currentTime):p._node&&(p._node.muted=e._muted?!0:l),d._emit("mute",p._id))}return d},volume:function(){var l=this,_=arguments,d,f;if(_.length===0)return l._volume;if(_.length===1||_.length===2&&typeof _[1]>"u"){var m=l._getSoundIds(),p=m.indexOf(_[0]);p>=0?f=parseInt(_[0],10):d=parseFloat(_[0])}else _.length>=2&&(d=parseFloat(_[0]),f=parseInt(_[1],10));var T;if(typeof d<"u"&&d>=0&&d<=1){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,_)}}),l;typeof f>"u"&&(l._volume=d),f=l._getSoundIds(f);for(var v=0;v<f.length;v++)T=l._soundById(f[v]),T&&(T._volume=d,_[2]||l._stopFade(f[v]),l._webAudio&&T._node&&!T._muted?T._node.gain.setValueAtTime(d,e.ctx.currentTime):T._node&&!T._muted&&(T._node.volume=d*e.volume()),l._emit("volume",T._id))}else return T=f?l._soundById(f):l._sounds[0],T?T._volume:0;return l},fade:function(l,_,d,f){var m=this;if(m._state!=="loaded"||m._playLock)return m._queue.push({event:"fade",action:function(){m.fade(l,_,d,f)}}),m;l=Math.min(Math.max(0,parseFloat(l)),1),_=Math.min(Math.max(0,parseFloat(_)),1),d=parseFloat(d),m.volume(l,f);for(var p=m._getSoundIds(f),T=0;T<p.length;T++){var v=m._soundById(p[T]);if(v){if(f||m._stopFade(p[T]),m._webAudio&&!v._muted){var O=e.ctx.currentTime,A=O+d/1e3;v._volume=l,v._node.gain.setValueAtTime(l,O),v._node.gain.linearRampToValueAtTime(_,A)}m._startFadeInterval(v,l,_,d,p[T],typeof f>"u")}}return m},_startFadeInterval:function(l,_,d,f,m,p){var T=this,v=_,O=d-_,A=Math.abs(O/.01),y=Math.max(4,A>0?f/A:f),M=Date.now();l._fadeTo=d,l._interval=setInterval(function(){var N=(Date.now()-M)/f;M=Date.now(),v+=O*N,v=Math.round(v*100)/100,O<0?v=Math.max(d,v):v=Math.min(d,v),T._webAudio?l._volume=v:T.volume(v,l._id,!0),p&&(T._volume=v),(d<_&&v<=d||d>_&&v>=d)&&(clearInterval(l._interval),l._interval=null,l._fadeTo=null,T.volume(d,l._id),T._emit("fade",l._id))},y)},_stopFade:function(l){var _=this,d=_._soundById(l);return d&&d._interval&&(_._webAudio&&d._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(d._interval),d._interval=null,_.volume(d._fadeTo,l),d._fadeTo=null,_._emit("fade",l)),_},loop:function(){var l=this,_=arguments,d,f,m;if(_.length===0)return l._loop;if(_.length===1)if(typeof _[0]=="boolean")d=_[0],l._loop=d;else return m=l._soundById(parseInt(_[0],10)),m?m._loop:!1;else _.length===2&&(d=_[0],f=parseInt(_[1],10));for(var p=l._getSoundIds(f),T=0;T<p.length;T++)m=l._soundById(p[T]),m&&(m._loop=d,l._webAudio&&m._node&&m._node.bufferSource&&(m._node.bufferSource.loop=d,d&&(m._node.bufferSource.loopStart=m._start||0,m._node.bufferSource.loopEnd=m._stop,l.playing(p[T])&&(l.pause(p[T],!0),l.play(p[T],!0)))));return l},rate:function(){var l=this,_=arguments,d,f;if(_.length===0)f=l._sounds[0]._id;else if(_.length===1){var m=l._getSoundIds(),p=m.indexOf(_[0]);p>=0?f=parseInt(_[0],10):d=parseFloat(_[0])}else _.length===2&&(d=parseFloat(_[0]),f=parseInt(_[1],10));var T;if(typeof d=="number"){if(l._state!=="loaded"||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,_)}}),l;typeof f>"u"&&(l._rate=d),f=l._getSoundIds(f);for(var v=0;v<f.length;v++)if(T=l._soundById(f[v]),T){l.playing(f[v])&&(T._rateSeek=l.seek(f[v]),T._playStart=l._webAudio?e.ctx.currentTime:T._playStart),T._rate=d,l._webAudio&&T._node&&T._node.bufferSource?T._node.bufferSource.playbackRate.setValueAtTime(d,e.ctx.currentTime):T._node&&(T._node.playbackRate=d);var O=l.seek(f[v]),A=(l._sprite[T._sprite][0]+l._sprite[T._sprite][1])/1e3-O,y=A*1e3/Math.abs(T._rate);(l._endTimers[f[v]]||!T._paused)&&(l._clearTimer(f[v]),l._endTimers[f[v]]=setTimeout(l._ended.bind(l,T),y)),l._emit("rate",T._id)}}else return T=l._soundById(f),T?T._rate:l._rate;return l},seek:function(){var l=this,_=arguments,d,f;if(_.length===0)l._sounds.length&&(f=l._sounds[0]._id);else if(_.length===1){var m=l._getSoundIds(),p=m.indexOf(_[0]);p>=0?f=parseInt(_[0],10):l._sounds.length&&(f=l._sounds[0]._id,d=parseFloat(_[0]))}else _.length===2&&(d=parseFloat(_[0]),f=parseInt(_[1],10));if(typeof f>"u")return 0;if(typeof d=="number"&&(l._state!=="loaded"||l._playLock))return l._queue.push({event:"seek",action:function(){l.seek.apply(l,_)}}),l;var T=l._soundById(f);if(T)if(typeof d=="number"&&d>=0){var v=l.playing(f);v&&l.pause(f,!0),T._seek=d,T._ended=!1,l._clearTimer(f),!l._webAudio&&T._node&&!isNaN(T._node.duration)&&(T._node.currentTime=d);var O=function(){v&&l.play(f,!0),l._emit("seek",f)};if(v&&!l._webAudio){var A=function(){l._playLock?setTimeout(A,0):O()};setTimeout(A,0)}else O()}else if(l._webAudio){var y=l.playing(f)?e.ctx.currentTime-T._playStart:0,M=T._rateSeek?T._rateSeek-T._seek:0;return T._seek+(M+y*Math.abs(T._rate))}else return T._node.currentTime;return l},playing:function(l){var _=this;if(typeof l=="number"){var d=_._soundById(l);return d?!d._paused:!1}for(var f=0;f<_._sounds.length;f++)if(!_._sounds[f]._paused)return!0;return!1},duration:function(l){var _=this,d=_._duration,f=_._soundById(l);return f&&(d=_._sprite[f._sprite][1]/1e3),d},state:function(){return this._state},unload:function(){for(var l=this,_=l._sounds,d=0;d<_.length;d++)_[d]._paused||l.stop(_[d]._id),l._webAudio||(l._clearSound(_[d]._node),_[d]._node.removeEventListener("error",_[d]._errorFn,!1),_[d]._node.removeEventListener(e._canPlayEvent,_[d]._loadFn,!1),_[d]._node.removeEventListener("ended",_[d]._endFn,!1),e._releaseHtml5Audio(_[d]._node)),delete _[d]._node,l._clearTimer(_[d]._id);var f=e._howls.indexOf(l);f>=0&&e._howls.splice(f,1);var m=!0;for(d=0;d<e._howls.length;d++)if(e._howls[d]._src===l._src||l._src.indexOf(e._howls[d]._src)>=0){m=!1;break}return n&&m&&delete n[l._src],e.noAudio=!1,l._state="unloaded",l._sounds=[],l=null,null},on:function(l,_,d,f){var m=this,p=m["_on"+l];return typeof _=="function"&&p.push(f?{id:d,fn:_,once:f}:{id:d,fn:_}),m},off:function(l,_,d){var f=this,m=f["_on"+l],p=0;if(typeof _=="number"&&(d=_,_=null),_||d)for(p=0;p<m.length;p++){var T=d===m[p].id;if(_===m[p].fn&&T||!_&&T){m.splice(p,1);break}}else if(l)f["_on"+l]=[];else{var v=Object.keys(f);for(p=0;p<v.length;p++)v[p].indexOf("_on")===0&&Array.isArray(f[v[p]])&&(f[v[p]]=[])}return f},once:function(l,_,d){var f=this;return f.on(l,_,d,1),f},_emit:function(l,_,d){for(var f=this,m=f["_on"+l],p=m.length-1;p>=0;p--)(!m[p].id||m[p].id===_||l==="load")&&(setTimeout((function(T){T.call(this,_,d)}).bind(f,m[p].fn),0),m[p].once&&f.off(l,m[p].fn,m[p].id));return f._loadQueue(l),f},_loadQueue:function(l){var _=this;if(_._queue.length>0){var d=_._queue[0];d.event===l&&(_._queue.shift(),_._loadQueue()),l||d.action()}return _},_ended:function(l){var _=this,d=l._sprite;if(!_._webAudio&&l._node&&!l._node.paused&&!l._node.ended&&l._node.currentTime<l._stop)return setTimeout(_._ended.bind(_,l),100),_;var f=!!(l._loop||_._sprite[d][2]);if(_._emit("end",l._id),!_._webAudio&&f&&_.stop(l._id,!0).play(l._id),_._webAudio&&f){_._emit("play",l._id),l._seek=l._start||0,l._rateSeek=0,l._playStart=e.ctx.currentTime;var m=(l._stop-l._start)*1e3/Math.abs(l._rate);_._endTimers[l._id]=setTimeout(_._ended.bind(_,l),m)}return _._webAudio&&!f&&(l._paused=!0,l._ended=!0,l._seek=l._start||0,l._rateSeek=0,_._clearTimer(l._id),_._cleanBuffer(l._node),e._autoSuspend()),!_._webAudio&&!f&&_.stop(l._id,!0),_},_clearTimer:function(l){var _=this;if(_._endTimers[l]){if(typeof _._endTimers[l]!="function")clearTimeout(_._endTimers[l]);else{var d=_._soundById(l);d&&d._node&&d._node.removeEventListener("ended",_._endTimers[l],!1)}delete _._endTimers[l]}return _},_soundById:function(l){for(var _=this,d=0;d<_._sounds.length;d++)if(l===_._sounds[d]._id)return _._sounds[d];return null},_inactiveSound:function(){var l=this;l._drain();for(var _=0;_<l._sounds.length;_++)if(l._sounds[_]._ended)return l._sounds[_].reset();return new i(l)},_drain:function(){var l=this,_=l._pool,d=0,f=0;if(!(l._sounds.length<_)){for(f=0;f<l._sounds.length;f++)l._sounds[f]._ended&&d++;for(f=l._sounds.length-1;f>=0;f--){if(d<=_)return;l._sounds[f]._ended&&(l._webAudio&&l._sounds[f]._node&&l._sounds[f]._node.disconnect(0),l._sounds.splice(f,1),d--)}}},_getSoundIds:function(l){var _=this;if(typeof l>"u"){for(var d=[],f=0;f<_._sounds.length;f++)d.push(_._sounds[f]._id);return d}else return[l]},_refreshBuffer:function(l){var _=this;return l._node.bufferSource=e.ctx.createBufferSource(),l._node.bufferSource.buffer=n[_._src],l._panner?l._node.bufferSource.connect(l._panner):l._node.bufferSource.connect(l._node),l._node.bufferSource.loop=l._loop,l._loop&&(l._node.bufferSource.loopStart=l._start||0,l._node.bufferSource.loopEnd=l._stop||0),l._node.bufferSource.playbackRate.setValueAtTime(l._rate,e.ctx.currentTime),_},_cleanBuffer:function(l){var _=this,d=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(!l.bufferSource)return _;if(e._scratchBuffer&&l.bufferSource&&(l.bufferSource.onended=null,l.bufferSource.disconnect(0),d))try{l.bufferSource.buffer=e._scratchBuffer}catch{}return l.bufferSource=null,_},_clearSound:function(l){var _=/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent);_||(l.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var i=function(l){this._parent=l,this.init()};i.prototype={init:function(){var l=this,_=l._parent;return l._muted=_._muted,l._loop=_._loop,l._volume=_._volume,l._rate=_._rate,l._seek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++e._counter,_._sounds.push(l),l.create(),l},create:function(){var l=this,_=l._parent,d=e._muted||l._muted||l._parent._muted?0:l._volume;return _._webAudio?(l._node=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),l._node.gain.setValueAtTime(d,e.ctx.currentTime),l._node.paused=!0,l._node.connect(e.masterGain)):e.noAudio||(l._node=e._obtainHtml5Audio(),l._errorFn=l._errorListener.bind(l),l._node.addEventListener("error",l._errorFn,!1),l._loadFn=l._loadListener.bind(l),l._node.addEventListener(e._canPlayEvent,l._loadFn,!1),l._endFn=l._endListener.bind(l),l._node.addEventListener("ended",l._endFn,!1),l._node.src=_._src,l._node.preload=_._preload===!0?"auto":_._preload,l._node.volume=d*e.volume(),l._node.load()),l},reset:function(){var l=this,_=l._parent;return l._muted=_._muted,l._loop=_._loop,l._volume=_._volume,l._rate=_._rate,l._seek=0,l._rateSeek=0,l._paused=!0,l._ended=!0,l._sprite="__default",l._id=++e._counter,l},_errorListener:function(){var l=this;l._parent._emit("loaderror",l._id,l._node.error?l._node.error.code:0),l._node.removeEventListener("error",l._errorFn,!1)},_loadListener:function(){var l=this,_=l._parent;_._duration=Math.ceil(l._node.duration*10)/10,Object.keys(_._sprite).length===0&&(_._sprite={__default:[0,_._duration*1e3]}),_._state!=="loaded"&&(_._state="loaded",_._emit("load"),_._loadQueue()),l._node.removeEventListener(e._canPlayEvent,l._loadFn,!1)},_endListener:function(){var l=this,_=l._parent;_._duration===1/0&&(_._duration=Math.ceil(l._node.duration*10)/10,_._sprite.__default[1]===1/0&&(_._sprite.__default[1]=_._duration*1e3),_._ended(l)),l._node.removeEventListener("ended",l._endFn,!1)}};var n={},a=function(l){var _=l._src;if(n[_]){l._duration=n[_].duration,u(l);return}if(/^data:[^;]+;base64,/.test(_)){for(var d=atob(_.split(",")[1]),f=new Uint8Array(d.length),m=0;m<d.length;++m)f[m]=d.charCodeAt(m);h(f.buffer,l)}else{var p=new XMLHttpRequest;p.open(l._xhr.method,_,!0),p.withCredentials=l._xhr.withCredentials,p.responseType="arraybuffer",l._xhr.headers&&Object.keys(l._xhr.headers).forEach(function(T){p.setRequestHeader(T,l._xhr.headers[T])}),p.onload=function(){var T=(p.status+"")[0];if(T!=="0"&&T!=="2"&&T!=="3"){l._emit("loaderror",null,"Failed loading audio file with status: "+p.status+".");return}h(p.response,l)},p.onerror=function(){l._webAudio&&(l._html5=!0,l._webAudio=!1,l._sounds=[],delete n[_],l.load())},o(p)}},o=function(l){try{l.send()}catch{l.onerror()}},h=function(l,_){var d=function(){_._emit("loaderror",null,"Decoding audio data failed.")},f=function(m){m&&_._sounds.length>0?(n[_._src]=m,u(_,m)):d()};typeof Promise<"u"&&e.ctx.decodeAudioData.length===1?e.ctx.decodeAudioData(l).then(f).catch(d):e.ctx.decodeAudioData(l,f,d)},u=function(l,_){_&&!l._duration&&(l._duration=_.duration),Object.keys(l._sprite).length===0&&(l._sprite={__default:[0,l._duration*1e3]}),l._state!=="loaded"&&(l._state="loaded",l._emit("load"),l._loadQueue())},c=function(){if(e.usingWebAudio){try{typeof AudioContext<"u"?e.ctx=new AudioContext:typeof webkitAudioContext<"u"?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch{e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var l=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),_=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),d=_?parseInt(_[1],10):null;if(l&&d&&d<9){var f=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!f&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=typeof e.ctx.createGain>"u"?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};r.Howler=e,r.Howl=s,typeof Yr<"u"?(Yr.HowlerGlobal=t,Yr.Howler=e,Yr.Howl=s,Yr.Sound=i):typeof window<"u"&&(window.HowlerGlobal=t,window.Howler=e,window.Howl=s,window.Sound=i)})();/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.4
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */(function(){HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var s=this;if(!s.ctx||!s.ctx.listener)return s;for(var i=s._howls.length-1;i>=0;i--)s._howls[i].stereo(e);return s},HowlerGlobal.prototype.pos=function(e,s,i){var n=this;if(!n.ctx||!n.ctx.listener)return n;if(s=typeof s!="number"?n._pos[1]:s,i=typeof i!="number"?n._pos[2]:i,typeof e=="number")n._pos=[e,s,i],typeof n.ctx.listener.positionX<"u"?(n.ctx.listener.positionX.setTargetAtTime(n._pos[0],Howler.ctx.currentTime,.1),n.ctx.listener.positionY.setTargetAtTime(n._pos[1],Howler.ctx.currentTime,.1),n.ctx.listener.positionZ.setTargetAtTime(n._pos[2],Howler.ctx.currentTime,.1)):n.ctx.listener.setPosition(n._pos[0],n._pos[1],n._pos[2]);else return n._pos;return n},HowlerGlobal.prototype.orientation=function(e,s,i,n,a,o){var h=this;if(!h.ctx||!h.ctx.listener)return h;var u=h._orientation;if(s=typeof s!="number"?u[1]:s,i=typeof i!="number"?u[2]:i,n=typeof n!="number"?u[3]:n,a=typeof a!="number"?u[4]:a,o=typeof o!="number"?u[5]:o,typeof e=="number")h._orientation=[e,s,i,n,a,o],typeof h.ctx.listener.forwardX<"u"?(h.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),h.ctx.listener.forwardY.setTargetAtTime(s,Howler.ctx.currentTime,.1),h.ctx.listener.forwardZ.setTargetAtTime(i,Howler.ctx.currentTime,.1),h.ctx.listener.upX.setTargetAtTime(n,Howler.ctx.currentTime,.1),h.ctx.listener.upY.setTargetAtTime(a,Howler.ctx.currentTime,.1),h.ctx.listener.upZ.setTargetAtTime(o,Howler.ctx.currentTime,.1)):h.ctx.listener.setOrientation(e,s,i,n,a,o);else return u;return h},Howl.prototype.init=function(e){return function(s){var i=this;return i._orientation=s.orientation||[1,0,0],i._stereo=s.stereo||null,i._pos=s.pos||null,i._pannerAttr={coneInnerAngle:typeof s.coneInnerAngle<"u"?s.coneInnerAngle:360,coneOuterAngle:typeof s.coneOuterAngle<"u"?s.coneOuterAngle:360,coneOuterGain:typeof s.coneOuterGain<"u"?s.coneOuterGain:0,distanceModel:typeof s.distanceModel<"u"?s.distanceModel:"inverse",maxDistance:typeof s.maxDistance<"u"?s.maxDistance:1e4,panningModel:typeof s.panningModel<"u"?s.panningModel:"HRTF",refDistance:typeof s.refDistance<"u"?s.refDistance:1,rolloffFactor:typeof s.rolloffFactor<"u"?s.rolloffFactor:1},i._onstereo=s.onstereo?[{fn:s.onstereo}]:[],i._onpos=s.onpos?[{fn:s.onpos}]:[],i._onorientation=s.onorientation?[{fn:s.onorientation}]:[],e.call(this,s)}}(Howl.prototype.init),Howl.prototype.stereo=function(e,s){var i=this;if(!i._webAudio)return i;if(i._state!=="loaded")return i._queue.push({event:"stereo",action:function(){i.stereo(e,s)}}),i;var n=typeof Howler.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof s>"u")if(typeof e=="number")i._stereo=e,i._pos=[e,0,0];else return i._stereo;for(var a=i._getSoundIds(s),o=0;o<a.length;o++){var h=i._soundById(a[o]);if(h)if(typeof e=="number")h._stereo=e,h._pos=[e,0,0],h._node&&(h._pannerAttr.panningModel="equalpower",(!h._panner||!h._panner.pan)&&t(h,n),n==="spatial"?typeof h._panner.positionX<"u"?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):h._panner.setPosition(e,0,0):h._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),i._emit("stereo",h._id);else return h._stereo}return i},Howl.prototype.pos=function(e,s,i,n){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"pos",action:function(){a.pos(e,s,i,n)}}),a;if(s=typeof s!="number"?0:s,i=typeof i!="number"?-.5:i,typeof n>"u")if(typeof e=="number")a._pos=[e,s,i];else return a._pos;for(var o=a._getSoundIds(n),h=0;h<o.length;h++){var u=a._soundById(o[h]);if(u)if(typeof e=="number")u._pos=[e,s,i],u._node&&((!u._panner||u._panner.pan)&&t(u,"spatial"),typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.positionY.setValueAtTime(s,Howler.ctx.currentTime),u._panner.positionZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setPosition(e,s,i)),a._emit("pos",u._id);else return u._pos}return a},Howl.prototype.orientation=function(e,s,i,n){var a=this;if(!a._webAudio)return a;if(a._state!=="loaded")return a._queue.push({event:"orientation",action:function(){a.orientation(e,s,i,n)}}),a;if(s=typeof s!="number"?a._orientation[1]:s,i=typeof i!="number"?a._orientation[2]:i,typeof n>"u")if(typeof e=="number")a._orientation=[e,s,i];else return a._orientation;for(var o=a._getSoundIds(n),h=0;h<o.length;h++){var u=a._soundById(o[h]);if(u)if(typeof e=="number")u._orientation=[e,s,i],u._node&&(u._panner||(u._pos||(u._pos=a._pos||[0,0,-.5]),t(u,"spatial")),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),u._panner.orientationY.setValueAtTime(s,Howler.ctx.currentTime),u._panner.orientationZ.setValueAtTime(i,Howler.ctx.currentTime)):u._panner.setOrientation(e,s,i)),a._emit("orientation",u._id);else return u._orientation}return a},Howl.prototype.pannerAttr=function(){var e=this,s=arguments,i,n,a;if(!e._webAudio)return e;if(s.length===0)return e._pannerAttr;if(s.length===1)if(typeof s[0]=="object")i=s[0],typeof n>"u"&&(i.pannerAttr||(i.pannerAttr={coneInnerAngle:i.coneInnerAngle,coneOuterAngle:i.coneOuterAngle,coneOuterGain:i.coneOuterGain,distanceModel:i.distanceModel,maxDistance:i.maxDistance,refDistance:i.refDistance,rolloffFactor:i.rolloffFactor,panningModel:i.panningModel}),e._pannerAttr={coneInnerAngle:typeof i.pannerAttr.coneInnerAngle<"u"?i.pannerAttr.coneInnerAngle:e._coneInnerAngle,coneOuterAngle:typeof i.pannerAttr.coneOuterAngle<"u"?i.pannerAttr.coneOuterAngle:e._coneOuterAngle,coneOuterGain:typeof i.pannerAttr.coneOuterGain<"u"?i.pannerAttr.coneOuterGain:e._coneOuterGain,distanceModel:typeof i.pannerAttr.distanceModel<"u"?i.pannerAttr.distanceModel:e._distanceModel,maxDistance:typeof i.pannerAttr.maxDistance<"u"?i.pannerAttr.maxDistance:e._maxDistance,refDistance:typeof i.pannerAttr.refDistance<"u"?i.pannerAttr.refDistance:e._refDistance,rolloffFactor:typeof i.pannerAttr.rolloffFactor<"u"?i.pannerAttr.rolloffFactor:e._rolloffFactor,panningModel:typeof i.pannerAttr.panningModel<"u"?i.pannerAttr.panningModel:e._panningModel});else return a=e._soundById(parseInt(s[0],10)),a?a._pannerAttr:e._pannerAttr;else s.length===2&&(i=s[0],n=parseInt(s[1],10));for(var o=e._getSoundIds(n),h=0;h<o.length;h++)if(a=e._soundById(o[h]),a){var u=a._pannerAttr;u={coneInnerAngle:typeof i.coneInnerAngle<"u"?i.coneInnerAngle:u.coneInnerAngle,coneOuterAngle:typeof i.coneOuterAngle<"u"?i.coneOuterAngle:u.coneOuterAngle,coneOuterGain:typeof i.coneOuterGain<"u"?i.coneOuterGain:u.coneOuterGain,distanceModel:typeof i.distanceModel<"u"?i.distanceModel:u.distanceModel,maxDistance:typeof i.maxDistance<"u"?i.maxDistance:u.maxDistance,refDistance:typeof i.refDistance<"u"?i.refDistance:u.refDistance,rolloffFactor:typeof i.rolloffFactor<"u"?i.rolloffFactor:u.rolloffFactor,panningModel:typeof i.panningModel<"u"?i.panningModel:u.panningModel};var c=a._panner;c||(a._pos||(a._pos=e._pos||[0,0,-.5]),t(a,"spatial"),c=a._panner),c.coneInnerAngle=u.coneInnerAngle,c.coneOuterAngle=u.coneOuterAngle,c.coneOuterGain=u.coneOuterGain,c.distanceModel=u.distanceModel,c.maxDistance=u.maxDistance,c.refDistance=u.refDistance,c.rolloffFactor=u.rolloffFactor,c.panningModel=u.panningModel}return e},Sound.prototype.init=function(e){return function(){var s=this,i=s._parent;s._orientation=i._orientation,s._stereo=i._stereo,s._pos=i._pos,s._pannerAttr=i._pannerAttr,e.call(this),s._stereo?i.stereo(s._stereo):s._pos&&i.pos(s._pos[0],s._pos[1],s._pos[2],s._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var s=this,i=s._parent;return s._orientation=i._orientation,s._stereo=i._stereo,s._pos=i._pos,s._pannerAttr=i._pannerAttr,s._stereo?i.stereo(s._stereo):s._pos?i.pos(s._pos[0],s._pos[1],s._pos[2],s._id):s._panner&&(s._panner.disconnect(0),s._panner=void 0,i._refreshBuffer(s)),e.call(this)}}(Sound.prototype.reset);var t=function(e,s){s=s||"spatial",s==="spatial"?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,typeof e._panner.positionX<"u"?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),typeof e._panner.orientationX<"u"?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}})()})(cn);class lst{constructor(t){this._sampleUrl=t,this._isPlaying=!1,this._startPos=0,this._currentPos=0,this._playLength=0,this._sequence=[],this._cache=new Map}async play(t,e,s=0,i=-1){this.reset(),this._currentSong=new Eg(t),this._startPos=Math.trunc(s),this._playLength=i,this._currentPos=this._startPos,this._currentSongId=e,await this.preload(),this._isPlaying=!0,this.tick(),this._tickerInterval=window.setInterval(()=>this.tick(),1e3)}reset(){this._isPlaying=!1,window.clearInterval(this._tickerInterval),cn.Howler.stop(),this._currentSongId=-1,this._currentSong=void 0,this._tickerInterval=void 0,this._startPos=0,this._playLength=0,this._sequence=[],this._currentPos=0}pause(){this._isPlaying=!1,cn.Howler.stop()}resume(){this._isPlaying=!0}stop(){const t=this._currentSongId;this.reset(),Q.instance.soundManager.events.dispatchEvent(new vh(vh.TRAX_SONG_COMPLETE,t))}setVolume(t){cn.Howler.volume(t)}getVolume(){return cn.Howler.volume()}async getSample(t){let e=this._cache.get(t);return e||(e=await this.loadSong(t)),Promise.resolve(e)}async preload(){if(this._sequence=[],!!this._currentSong){for(const t of this._currentSong.channels){const e=[];for(const s of t.items){const i=await this.getSample(s.id),n=Math.ceil(s.length*2/Math.ceil(i.duration()));for(let a=0;a<n;a++)for(let o=0;o<Math.ceil(i.duration());o++)e.push({sampleId:s.id,offset:o})}this._sequence.push(e)}this._playLength<=0&&(this._playLength=Math.max(...this._sequence.map(t=>t.length)))}}async preloadSamplesForSong(t){const e=new Eg(t);await Promise.all(e.getSampleIds().map(s=>this.getSample(s)))}async loadSong(t){return new Promise((e,s)=>{const i=new cn.Howl({src:[this._sampleUrl.replace("%sample%",t.toString())],preload:!0});i.once("load",()=>{this._cache.set(t,i),e(i)}),i.once("loaderror",()=>{Y.error("failed to load sample "+t),s("failed to load sample "+t)})})}tick(){this._currentPos>this._playLength-1&&this.stop(),this._isPlaying&&(this._currentSong&&this.playPosition(this._currentPos),this._currentPos++)}playPosition(t){if(!(!this._currentSong||!this._sequence)&&cn.Howler._audioUnlocked)for(const e of this._sequence){const s=e[t];if(!s||s.sampleId===-1||s.sampleId===0)continue;const i=this._cache.get(s.sampleId);i&&(s.offset===0?i.play():i.playing()||(i.seek(s.offset),i.play()))}}}const VE=class hl{constructor(){this._priorityPlaying=-1,this._requestNumberPlaying=-1,this._previousNotificationTime=-1,this._timerInstance=-1,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songDiskInventory=new de,this._songRequestsPerPriority=[],this._songRequestCountsPerPriority=[],this._diskInventoryMissingData=[],this._songIdPlaying=-1,this._previousNotifiedSongId=-1,this._messageEvents=[new aA(this.onTraxSongInfoMessageEvent.bind(this)),new oA(this.onSongDiskInventoryMessage.bind(this))],this.onJukeboxInit=this.onJukeboxInit.bind(this),this.onJukeboxDispose=this.onJukeboxDispose.bind(this),this.onSoundMachineInit=this.onSoundMachineInit.bind(this),this.onSoundMachineDispose=this.onSoundMachineDispose.bind(this),this.onTraxSongComplete=this.onTraxSongComplete.bind(this)}init(){this._timerInstance=window.setInterval(this.onTick.bind(this),1e3),this._musicPlayer=new lst(Q.instance.getConfiguration("external.samples.url")),this._messageEvents.forEach(t=>Q.instance.communication.connection.addMessageEvent(t)),Q.instance.roomEngine.events.addEventListener(Gt.JUKEBOX_INIT,this.onJukeboxInit),Q.instance.roomEngine.events.addEventListener(Gt.JUKEBOX_DISPOSE,this.onJukeboxDispose),Q.instance.roomEngine.events.addEventListener(Gt.SOUND_MACHINE_INIT,this.onSoundMachineInit),Q.instance.roomEngine.events.addEventListener(Gt.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),Q.instance.soundManager.events.addEventListener(vh.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}getRoomItemPlaylist(t){return this._roomItemPlaylist}get songDiskInventory(){return this._songDiskInventory}getSongDiskInventorySize(){return this._songDiskInventory.length}getSongDiskInventoryDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongDiskInventorySongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}getSongInfo(t){const e=this.getSongDataEntry(t);return e||this.requestSongInfoWithoutSamples(t),e}getSongIdPlayingAtPriority(t){return t!==this._priorityPlaying?-1:this._songIdPlaying}stop(t){const e=t===this._priorityPlaying,s=this.getTopRequestPriority()===t;e?(this.resetSongStartRequest(t),this.stopSongAtPriority(t)):(this.resetSongStartRequest(t),s&&this.reRequestSongAtPriority(this._priorityPlaying))}addSongInfoRequest(t){this.requestSong(t,!0)}requestSongInfoWithoutSamples(t){this.requestSong(t,!1)}requestUserSongDisks(){Q.instance.communication.connection.send(new wS)}updateVolume(t){this._musicPlayer.setVolume(t)}dispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=void 0),this._messageEvents.forEach(t=>Q.instance.communication.connection.removeMessageEvent(t)),Q.instance.roomEngine.events.removeEventListener(Gt.JUKEBOX_INIT,this.onJukeboxInit),Q.instance.roomEngine.events.removeEventListener(Gt.JUKEBOX_DISPOSE,this.onJukeboxDispose),Q.instance.roomEngine.events.removeEventListener(Gt.SOUND_MACHINE_INIT,this.onSoundMachineInit),Q.instance.roomEngine.events.removeEventListener(Gt.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),Q.instance.soundManager.events.removeEventListener(vh.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}get samplesIdsInUse(){let t,e,s=[];for(let i=0;i<this._songRequestsPerPriority.length;i++)if(this._songRequestsPerPriority[i]&&(t=this._songRequestsPerPriority[i],e=this._availableSongs.get(t.songId),e)){const n=e.songData;if(n.length>0){const a=new Eg(n);s=s.concat(a.getSampleIds())}}return s}onSongLoaded(t){const e=this.getTopRequestPriority();if(e>=0){const s=this.getSongIdRequestedAtPriority(e);t===s&&this.playSongObject(e,t)}}samplesUnloaded(t){throw new Error("Method not implemented.")}onTraxSongComplete(t){if(this.getSongIdPlayingAtPriority(this._priorityPlaying)===t.id){this.getTopRequestPriority()===this._priorityPlaying&&this.getSongRequestCountAtPriority(this._priorityPlaying)==this._requestNumberPlaying&&this.resetSongStartRequest(this._priorityPlaying);const e=this._priorityPlaying;this.playSongWithHighestPriority(),e>=Ze.PRIORITY_SONG_PLAY&&Q.instance.soundManager.events.dispatchEvent(new si(si.NPW_USER_STOP_SONG,e,t.id,-1))}}onTraxSongInfoMessageEvent(t){const e=t.getParser();for(const s of e.songs){const i=!!this.getSongDataEntry(s.id);if(this.areSamplesRequested(s.id),!i){const n=new E0(s.id,s.length,s.name,s.creator,s.data);this._availableSongs.set(s.id,n);const a=this.getTopRequestPriority(),o=this.getSongIdRequestedAtPriority(a);for(s.id===o&&this.playSongObject(a,o),Q.instance.soundManager.events.dispatchEvent(new Oh(Oh.SIR_TRAX_SONG_INFO_RECEIVED,s.id));this._diskInventoryMissingData.indexOf(s.id)!=-1;)this._diskInventoryMissingData.splice(this._diskInventoryMissingData.indexOf(s.id),1),this._diskInventoryMissingData.length===0&&Q.instance.soundManager.events.dispatchEvent(new Ho(Ho.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}}}onSongDiskInventoryMessage(t){const e=t.getParser();this._songDiskInventory.reset();for(let s=0;s<e.songDiskCount;s++){const i=e.getDiskId(s),n=e.getSongId(s);this._songDiskInventory.add(i,n),this._availableSongs.get(n)||(this._diskInventoryMissingData.push(n),this.requestSongInfoWithoutSamples(n))}this._diskInventoryMissingData.length===0&&Q.instance.soundManager.events.dispatchEvent(new Ho(Ho.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}onTick(){this._songRequestList.length!==0&&(Q.instance.communication.connection.send(new FS(...this._songRequestList)),this._songRequestList=[])}requestSong(t,e){this._requestedSongs.get(t)===void 0&&(this._requestedSongs.set(t,e),this._songRequestList.push(t))}areSamplesRequested(t){return this._requestedSongs.get(t)?this._requestedSongs.get(t):!1}processSongEntryForPlaying(t,e=!0){return this.getSongDataEntry(t)?!0:(this.addSongInfoRequest(t),!1)}playSong(t,e,s=0,i=0,n=.5,a=.5){return!this.addSongStartRequest(e,t,s,i,n,a)||!this.processSongEntryForPlaying(t)?!1:(e>=this._priorityPlaying&&this.playSongObject(e,t),!0)}playSongObject(t,e){if(e===-1||t<0||t>=Ze.PRIORITY_COUNT)return!1;let s=!1;this.stopSongAtPriority(this._priorityPlaying)&&(s=!0);const i=this.getSongDataEntry(e);if(!i)return!1;if(s)return!0;this._musicPlayer.setVolume(Q.instance.soundManager.traxVolume);let n=hl.SKIP_POSITION_SET,a=0;const o=this.getSongStartRequest(t);return o&&(n=o.startPos,a=o.playLength,o.fadeInSeconds,o.fadeOutSeconds),n>=i.length/1e3?!1:(n<=hl.SKIP_POSITION_SET&&(n=0),n=Math.trunc(n),this._priorityPlaying=t,this._requestNumberPlaying=this.getSongRequestCountAtPriority(t),this._songIdPlaying=e,this._priorityPlaying<=hl.MAXIMUM_NOTIFY_PRIORITY&&this.notifySongPlaying(i),this._musicPlayer.preloadSamplesForSong(i.songData).then(()=>this._musicPlayer.play(i.songData,i.id,n,a)),t>Ze.PRIORITY_ROOM_PLAYLIST&&Q.instance.soundManager.events.dispatchEvent(new si(si.NPE_USER_PLAY_SONG,t,i.id,-1)),!0)}notifySongPlaying(t){const s=Date.now();t.length>=8e3&&(this._previousNotifiedSongId!=t.id||s>this._previousNotificationTime+8e3)&&(Q.instance.soundManager.events.dispatchEvent(new ast(t.name,t.creator)),this._previousNotifiedSongId=t.id,this._previousNotificationTime=s)}addSongStartRequest(t,e,s,i,n,a){if(t<0||t>=Ze.PRIORITY_COUNT)return!1;const o=new nst(e,s,i,n,a);return this._songRequestsPerPriority[t]=o,this._songRequestCountsPerPriority[t]=this._songRequestCountsPerPriority[t]+1,!0}getSongDataEntry(t){let e;return this._availableSongs&&(e=this._availableSongs.get(t)),e}getSongStartRequest(t){return this._songRequestsPerPriority[t]}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(t){return t<0||t>=Ze.PRIORITY_COUNT||!this._songRequestsPerPriority[t]?-1:this._songRequestsPerPriority[t].songId}getSongRequestCountAtPriority(t){return t<0||t>=Ze.PRIORITY_COUNT?-1:this._songRequestCountsPerPriority[t]}playSongWithHighestPriority(){let t;this._priorityPlaying=-1,this._songIdPlaying=-1,this._requestNumberPlaying=-1;let s=this.getTopRequestPriority();for(;s>=0;){if(t=this.getSongIdRequestedAtPriority(s),t>=0&&this.playSongObject(s,t))return;s--}}resetSongStartRequest(t){t>=0&&t<Ze.PRIORITY_COUNT&&(this._songRequestsPerPriority[t]=void 0)}reRequestSongAtPriority(t){this._songRequestCountsPerPriority[t]=this._songRequestCountsPerPriority[t]+1}stopSongAtPriority(t){if(t===this._priorityPlaying&&this._priorityPlaying>=0){const e=this.getSongIdPlayingAtPriority(t);if(e>=0)return this.getSongDataEntry(e),this._musicPlayer.stop(),!0}return!1}onSoundMachineInit(t){this.disposeRoomPlaylist()}onSoundMachineDispose(t){this.disposeRoomPlaylist()}onJukeboxInit(t){this.disposeRoomPlaylist(),this._roomItemPlaylist=new ost,this._roomItemPlaylist.init(),Q.instance.communication.connection.send(new xS)}onJukeboxDispose(t){this.disposeRoomPlaylist()}disposeRoomPlaylist(){this._roomItemPlaylist&&(this._roomItemPlaylist.dispose(),this._roomItemPlaylist=void 0)}};VE.SKIP_POSITION_SET=-1;VE.MAXIMUM_NOTIFY_PRIORITY=Ze.PRIORITY_ROOM_PLAYLIST;let _st=VE;class cst extends Rr{constructor(){super(),this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._internalSamples=new de,this._furniSamples=new de,this._furnitureBeingPlayed=new de,this._musicController=new _st,this.onEvent=this.onEvent.bind(this)}onInit(){this._musicController.init(),Q.instance.roomEngine.events.addEventListener(is.PLAY_SAMPLE,this.onEvent),Q.instance.roomEngine.events.addEventListener($.REMOVED,this.onEvent),Q.instance.roomEngine.events.addEventListener(At.DISPOSED,this.onEvent),Q.instance.events.addEventListener(Qo.SETTINGS_UPDATED,this.onEvent),Q.instance.events.addEventListener(Xu.PLAY_SOUND,this.onEvent)}onDispose(){this._musicController&&(this._musicController.dispose(),this._musicController=null),Q.instance.roomEngine.events.removeEventListener(is.PLAY_SAMPLE,this.onEvent),Q.instance.roomEngine.events.removeEventListener($.REMOVED,this.onEvent),Q.instance.roomEngine.events.removeEventListener(At.DISPOSED,this.onEvent),Q.instance.events.removeEventListener(Qo.SETTINGS_UPDATED,this.onEvent),Q.instance.events.removeEventListener(Xu.PLAY_SOUND,this.onEvent)}onEvent(t){var e;switch(t.type){case is.PLAY_SAMPLE:{const s=t;this.playFurniSample(s.objectId,s.sampleId,s.pitch);return}case $.REMOVED:{const s=t;this.stopFurniSample(s.objectId);return}case At.DISPOSED:{this._furnitureBeingPlayed.getKeys().forEach(s=>{this.stopFurniSample(s)});return}case Qo.SETTINGS_UPDATED:{const s=t,i=s.volumeFurni!==this._volumeFurni,n=s.volumeTrax!==this._volumeTrax;this._volumeSystem=s.volumeSystem/100,this._volumeFurni=s.volumeFurni/100,this._volumeTrax=s.volumeTrax/100,i&&this.updateFurniSamplesVolume(this._volumeFurni),n&&((e=this._musicController)==null||e.updateVolume(this._volumeTrax));return}case Xu.PLAY_SOUND:{const s=t;this.playInternalSample(s.sampleCode);return}}}playSample(t,e,s=1){t.volume=e,t.currentTime=0;try{t.play()}catch(i){Y.error(i)}}playInternalSample(t){let e=this._internalSamples.getValue(t);if(!e){const s=at.getValue("sounds.url");e=new Audio(s.replace("%sample%",t)),this._internalSamples.add(t,e)}this.playSample(e,this._volumeSystem)}playFurniSample(t,e,s){let i=this._furniSamples.getValue(e);if(!i){const n=at.getValue("external.samples.url");i=new Audio(n.replace("%sample%",e.toString())),this._furniSamples.add(e,i)}this._furnitureBeingPlayed.hasKey(t)||this._furnitureBeingPlayed.add(t,e),i.onended=n=>{this.stopFurniSample(t)},i.onpause=n=>{this.stopFurniSample(t)},i.onerror=n=>{this.stopFurniSample(t)},this.playSample(i,this._volumeFurni,s)}stopInternalSample(t){const e=this._internalSamples.getValue(t);if(e)try{e.pause()}catch(s){Y.error(s)}}stopFurniSample(t){const e=this._furnitureBeingPlayed.getValue(t);if(!e)return;const s=this._furniSamples.getValue(e);if(this._furnitureBeingPlayed.remove(t),!!s)try{s.pause()}catch(i){Y.error(i)}}updateInternalSamplesVolume(t){this._internalSamples.getValues().forEach(e=>{e.volume=t})}updateFurniSamplesVolume(t){this._furniSamples.getValues().forEach(e=>{e.volume=t})}get traxVolume(){return this._volumeTrax}get musicController(){return this._musicController}}Ot.available;Z.SCALE_MODE=window.devicePixelRatio%1?_s.LINEAR:_s.NEAREST;Z.ROUND_PIXELS=!0;Z.GC_MAX_IDLE=120;const nu=class dn{constructor(t,e){dn.INSTANCE||(dn.INSTANCE=this),this._application=new Me(e),this._core=t,this._events=new vs,this._communication=new uJ(t.communication),this._localization=new _J(this._communication),this._avatar=new Ost,this._roomEngine=new FE(this._communication),this._sessionDataManager=new ist(this._communication),this._roomSessionManager=new rst(this._communication,this._roomEngine),this._roomManager=new Zw(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._cameraManager=new $w,this._soundManager=new cst,this._linkTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener(Mi.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(At.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this))}static bootstrap(){dn.INSTANCE&&(dn.INSTANCE.dispose(),dn.INSTANCE=null);const t=document.createElement("canvas"),e=new this(new $F,{autoDensity:!1,width:window.innerWidth,height:window.innerHeight,resolution:window.devicePixelRatio,view:t});t.addEventListener("webglcontextlost",()=>e.events.dispatchEvent(new It(dn.WEBGL_CONTEXT_LOST)))}init(){if(!(this._isReady||this._isDisposed)){if(this._avatar&&this._avatar.init(),this._soundManager&&this._soundManager.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._sessionDataManager&&this._sessionDataManager.init(),this._roomSessionManager&&this._roomSessionManager.init(),this._roomEngine.init()),!this._communication.connection)throw new Error("No connection found");new lJ(this._communication.connection),this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._soundManager&&(this._soundManager.dispose(),this._soundManager=null),this._communication&&(this._communication.dispose(),this._communication=null),this._application&&(this._application.destroy(),this._application=null),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(t){Xr().maxFPS=at.getValue("system.fps.max",24),Y.LOG_DEBUG=at.getValue("system.log.debug",!0),Y.LOG_WARN=at.getValue("system.log.warn",!1),Y.LOG_ERROR=at.getValue("system.log.error",!1),Y.LOG_EVENTS=at.getValue("system.log.events",!1),Y.LOG_PACKETS=at.getValue("system.log.packets",!1),u0.LANDSCAPES_ENABLED=at.getValue("room.landscapes.enabled",!0)}onRoomEngineReady(t){this.startSendingHeartBeat()}getConfiguration(t,e=null){return at.getValue(t,e)}getLocalization(t){return this._localization.getValue(t)}getLocalizationWithParameter(t,e,s){return this._localization.getValueWithParameter(t,e,s)}getLocalizationWithParameters(t,e,s){return this._localization.getValueWithParameters(t,e,s)}addLinkEventTracker(t){this._linkTrackers.indexOf(t)>=0||this._linkTrackers.push(t)}removeLinkEventTracker(t){const e=this._linkTrackers.indexOf(t);e!==-1&&this._linkTrackers.splice(e,1)}createLinkEvent(t){if(!(!t||t===""))for(const e of this._linkTrackers){if(!e)continue;const s=e.eventUrlPrefix;s.length>0?t.substr(0,s.length)===s&&e.linkReceived(t):e.linkReceived(t)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){Xl.sendHeartBeat()}get application(){return this._application}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get cameraManager(){return this._cameraManager}get soundManager(){return this._soundManager}get width(){return this._application.renderer.width}get height(){return this._application.renderer.height}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}};nu.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST";nu.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE";nu.READY="NE_READY!";nu.INSTANCE=null;let Q=nu;const Ls=class Ut{static format(t,e="",s=3){return t>s*Ut.YEAR?Ut.getLocalization("friendlytime.years"+e,Math.round(t/Ut.YEAR)):t>s*Ut.MONTH?Ut.getLocalization("friendlytime.months"+e,Math.round(t/Ut.MONTH)):t>s*Ut.DAY?Ut.getLocalization("friendlytime.days"+e,Math.round(t/Ut.DAY)):t>s*Ut.HOUR?Ut.getLocalization("friendlytime.hours"+e,Math.round(t/Ut.HOUR)):t>s*Ut.MINUTE?Ut.getLocalization("friendlytime.minutes"+e,Math.round(t/Ut.MINUTE)):Ut.getLocalization("friendlytime.seconds"+e,Math.round(t))}static shortFormat(t,e="",s=3){return t>s*Ut.YEAR?Ut.getLocalization("friendlytime.years.short"+e,Math.round(t/Ut.YEAR)):t>s*Ut.MONTH?Ut.getLocalization("friendlytime.months.short"+e,Math.round(t/Ut.MONTH)):t>s*Ut.DAY?Ut.getLocalization("friendlytime.days.short"+e,Math.round(t/Ut.DAY)):t>s*Ut.HOUR?Ut.getLocalization("friendlytime.hours.short"+e,Math.round(t/Ut.HOUR)):t>s*Ut.MINUTE?Ut.getLocalization("friendlytime.minutes.short"+e,Math.round(t/Ut.MINUTE)):Ut.getLocalization("friendlytime.seconds.short"+e,Math.round(t))}static getLocalization(t,e){return Q.instance.getLocalizationWithParameter(t,"amount",e.toString())}};Ls.MINUTE=60;Ls.HOUR=60*Ls.MINUTE;Ls.DAY=24*Ls.HOUR;Ls.WEEK=7*Ls.DAY;Ls.MONTH=30*Ls.DAY;Ls.YEAR=365*Ls.DAY;let Hst=Ls;const I0=class T0{static isBuilderClubId(t){return t>=T0.BUILDER_CLUB_FURNI_ID_BASE}};I0.BUILDER_CLUB_FURNI_ID_BASE=2147418112;let MI=I0;const dst=r=>r>>>0,R0=r=>{const t=dst(r);return t>=Math.pow(2,31)?t-Math.pow(2,32):t};class kE{constructor(t){if(this._id=t.id,this._isMain=t.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],t.avatarSets&&t.avatarSets.length>0)for(const s of t.avatarSets){if(!s)continue;const i=new kE(s);this._avatarSets.set(i.id,i)}if(t.bodyParts&&t.bodyParts.length>0)for(const s of t.bodyParts)s&&this._bodyParts.push(s.id);let e=this._bodyParts.concat();for(const s of this._avatarSets.values())s&&(e=e.concat(s.getBodyParts()));this._allBodyParts=e}findAvatarSet(t){if(t===this._id)return this;for(const e of this._avatarSets.values())if(e&&e.findAvatarSet(t))return e;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const t of this._avatarSets.values())if(t&&t.isMain)return!0;return!1}}class Os{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){const s=new Os;return s.x=t.y*e.z-t.z*e.y,s.y=t.z*e.x-t.x*e.z,s.z=t.x*e.y-t.y*e.x,s}static subtract(t,e){return new Os(t.x-e.x,t.y-e.y,t.z-e.z)}dot(t){return this._x*t.x+this._y*t.y+this._z*t.z}cross(t){const e=new Os;return e.x=this._y*t.z-this._z*t.y,e.y=this._z*t.x-this._x*t.z,e.z=this._x*t.y-this._y*t.x,e}subtract(t){this._x=this._x-t.x,this._y=this._y-t.y,this._z=this._z-t.z}add(t){this._x=this._x+t.x,this._y=this._y+t.y,this._z=this._z+t.z}normalize(){const t=1/this.length();this._x=this._x*t,this._y=this._y*t,this._z=this._z*t}scaleBy(t){this._x*=t,this._y*=t,this._z*=t}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}}class O0{constructor(t,e,s){this._location=new Os(t,e,s),this._transformedLocation=new Os,this._needsTransformation=!1,(t!=0||e!=0||s!=0)&&(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(t){this._needsTransformation&&(this._transformedLocation=t.vectorMultiplication(this._location))}}class CI extends O0{constructor(t,e=!1){super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._normal=new Os(parseFloat(t.nx),parseFloat(t.ny),parseFloat(t.nz)),this._isDoubleSided=t.double||!1,this._isDynamic=e}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this.transformedLocation}get isDynamic(){return this._isDynamic}}class fst extends O0{constructor(t){if(super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._parts=new Map,this._dynamicParts=new Map,t.items&&t.items.length>0)for(const e of t.items){if(!e)continue;const s=new CI(e);this._parts.set(s.id,s)}}getDynamicParts(t){const e=this._dynamicParts.get(t),s=[];if(e)for(const i in e){const n=e[i];n&&s.push(n)}return s}getPartIds(t){const e=[];for(const s of this._parts.values())s&&e.push(s.id);if(t){const s=this._dynamicParts.get(t);if(s)for(const i in s){const n=s[i];n&&e.push(n.id)}}return e}removeDynamicParts(t){return this._dynamicParts.delete(t),!0}addPart(t,e){if(this.hasPart(t.id,e))return!1;let s=this._dynamicParts.get(e);return s||(s={},this._dynamicParts.set(e,s)),s[t.id]=new CI(t,!0),!0}hasPart(t,e){let s=this._parts.get(t)||null;return!s&&this._dynamicParts.get(e)!==void 0&&(s=this._dynamicParts.get(e)[t]||null),s!==null}getParts(t,e,s,i){const n=[];for(const h of this._parts.values())h&&(h.applyTransform(t),n.push([h.getDistance(e),h]));const a=this._dynamicParts.get(i);if(a)for(const h in a){const u=a[h];u&&(u.applyTransform(t),n.push([u.getDistance(e),u]))}n.sort((h,u)=>{const c=h[0],l=u[0];return c<l?-1:c>l?1:0});const o=[];for(const h of n)h&&o.push(h[1].id);return o}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get radius(){return this._radius}}const Kl=class Gr{constructor(t=0,e=0,s=0,i=0,n=0,a=0,o=0,h=0,u=0){this._data=[t,e,s,i,n,a,o,h,u]}static getXRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Gr(1,0,0,0,s,-i,0,i,s)}static getYRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Gr(s,0,i,0,1,0,-i,0,s)}static getZRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Gr(s,-i,0,i,s,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(t){const e=t.x*this._data[0]+t.y*this._data[3]+t.z*this._data[6],s=t.x*this._data[1]+t.y*this._data[4]+t.z*this._data[7],i=t.x*this._data[2]+t.y*this._data[5]+t.z*this._data[8];return new Os(e,s,i)}multiply(t){const e=this._data[0]*t.data[0]+this._data[1]*t.data[3]+this._data[2]*t.data[6],s=this._data[0]*t.data[1]+this._data[1]*t.data[4]+this._data[2]*t.data[7],i=this._data[0]*t.data[2]+this._data[1]*t.data[5]+this._data[2]*t.data[8],n=this._data[3]*t.data[0]+this._data[4]*t.data[3]+this._data[5]*t.data[6],a=this._data[3]*t.data[1]+this._data[4]*t.data[4]+this._data[5]*t.data[7],o=this._data[3]*t.data[2]+this._data[4]*t.data[5]+this._data[5]*t.data[8],h=this._data[6]*t.data[0]+this._data[7]*t.data[3]+this._data[8]*t.data[6],u=this._data[6]*t.data[1]+this._data[7]*t.data[4]+this._data[8]*t.data[7],c=this._data[6]*t.data[2]+this._data[7]*t.data[5]+this._data[8]*t.data[8];return new Gr(e,s,i,n,a,o,h,u,c)}scalarMultiply(t){let e=0;for(;e<this._data.length;)this._data[e]=this._data[e]*t,e++}rotateX(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Gr(1,0,0,0,s,-i,0,i,s).multiply(this)}rotateY(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Gr(s,0,i,0,1,0,-i,0,s).multiply(this)}rotateZ(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Gr(s,-i,0,i,s,0,0,0,1).multiply(this)}skew(){}transpose(){return new Gr(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(t){return!1}get data(){return this._data}};Kl.IDENTITY=new Kl(1,0,0,0,1,0,0,0,1);Kl.TOLERANS=1e-18;let id=Kl;class gst{constructor(t){this._camera=new Os(0,0,10),this._avatarSet=new kE(t.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new id,this._canvases=new Map;const e=t.camera;if(e&&(this._camera.x=parseFloat(e.x),this._camera.y=parseFloat(e.y),this._camera.z=parseFloat(e.z)),t.canvases&&t.canvases.length>0)for(const s of t.canvases){if(!s)continue;const i=s.scale,n=new Map;if(s.geometries&&s.geometries.length>0)for(const a of s.geometries){if(!a)continue;const o=new Iw(a,i);n.set(o.id,o)}this._canvases.set(i,n)}if(t.types&&t.types.length>0)for(const s of t.types){if(!s)continue;const i=new Map,n=new Map;if(s.bodyParts&&s.bodyParts.length>0)for(const a of s.bodyParts){if(!a)continue;const o=new fst(a);i.set(o.id,o);for(const h of o.getPartIds(null))n.set(h,o)}this._geometryTypes.set(s.id,i),this._itemIdToBodyPartMap.set(s.id,n)}}removeDynamicItems(t){for(const e of this._geometryTypes.values())if(e)for(const s of e.values())s&&s.removeDynamicParts(t)}getBodyPartIdsInAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.getBodyParts():[]}isMainAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.isMain:!1}getCanvas(t,e){const s=this._canvases.get(t);return s&&s.get(e)||null}typeExists(t){return!!this._geometryTypes.get(t)}hasBodyPart(t,e){if(this.typeExists(t)){const s=this._geometryTypes.get(t);if(s&&s.get(e))return!0}return!1}getBodyPartIDs(t){const e=this.getBodyPartsOfType(t),s=[];if(e)for(const i of e.values())i&&s.push(i.id);return s}getBodyPartsOfType(t){return this.typeExists(t)?this._geometryTypes.get(t):new Map}getBodyPart(t,e){return this.getBodyPartsOfType(t).get(e)||null}getBodyPartOfItem(t,e,s){const i=this._itemIdToBodyPartMap.get(t);if(i){const n=i.get(e);if(n)return n;const a=this.getBodyPartsOfType(t);if(a){for(const o of a.values())if(o&&o.hasPart(e,s))return o}}return null}getBodyPartsInAvatarSet(t,e){const s=this.getBodyPartIdsInAvatarSet(e),i=[];for(const n of s){if(!n)continue;const a=t.get(n);a&&i.push(a)}return i}getBodyPartsAtAngle(t,e,s){if(!s)return[];const i=this.getBodyPartsOfType(s),n=this.getBodyPartsInAvatarSet(i,t),a=[],o=[];this._transformation=id.getYRotationMatrix(e);for(const h of n.values())h&&(h.applyTransform(this._transformation),a.push([h.getDistance(this._camera),h]));a.sort((h,u)=>{const c=h[0],l=u[0];return c<l?-1:c>l?1:0});for(const h of a)h&&o.push(h[1].id);return o}getParts(t,e,s,i,n){if(this.hasBodyPart(t,e)){const a=this.getBodyPartsOfType(t).get(e);return this._transformation=id.getYRotationMatrix(s),a.getParts(this._transformation,this._camera,i,n)}return[]}}class Est extends vs{constructor(t){super(),this._renderManager=t,this._geometry=null,this._figureData=new vw,this._partSetsData=new Aw,this._animationData=new mw,this._animationManager=new lw,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}initGeometry(t){t&&(this._geometry=new gst(t))}initActions(t,e){e&&(this._actionManager=new sw(t,e),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(t){this._actionManager.updateActions(t),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(t){return t&&this._partSetsData.parse(t)?(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0):!1}initAnimation(t){return t?this._animationData.parse(t):!1}initFigureData(t){return t?this._figureData.parse(t):!1}injectFigureData(t){this._figureData.injectJSON(t)}registerAnimations(t,e="fx",s=200){let i=0;for(;i<s;){const n=t.getCollection(e+i);if(n){const a=n.data;this._animationManager.registerAnimation(this,a.animations)}i++}}registerAnimation(t){this._animationManager.registerAnimation(this,t)}getPartColor(t,e,s=0){const i=t.getPartColorIds(e);if(!i||i.length<s)return null;const n=this._figureData.getSetType(e);if(n==null)return null;const a=this._figureData.getPalette(n.paletteID);return a?a.getColor(i[s]):null}getBodyPartData(t,e,s){return this._animationManager.getLayerData(t,e,s)}getAnimation(t){return this._animationManager.getAnimation(t)}getActionDefinition(t){return this._actionManager.getActionDefinition(t)}getActionDefinitionWithState(t){return this._actionManager.getActionDefinitionWithState(t)}isMainAvatarSet(t){return this._geometry.isMainAvatarSet(t)}sortActions(t){return this._actionManager.sortActions(t)}maxFrames(t){let e=0;for(const s of t)e=Math.max(e,this._animationData.getFrameCount(s.definition));return e}getMandatorySetTypeIds(t,e){return this._mandatorySetTypeIds[t]||(this._mandatorySetTypeIds[t]=[]),this._mandatorySetTypeIds[t][e]?this._mandatorySetTypeIds[t][e]:(this._mandatorySetTypeIds[t][e]=this._figureData.getMandatorySetTypeIds(t,e),this._mandatorySetTypeIds[t][e])}getDefaultPartSet(t,e){return this._figureData.getDefaultPartSet(t,e)}getCanvasOffsets(t,e,s){return this._actionManager.getCanvasOffsets(t,e,s)}getCanvas(t,e){return this._geometry.getCanvas(t,e)}removeDynamicItems(t){this._geometry.removeDynamicItems(t)}getActiveBodyPartIds(t,e){let s=[];const i=[],n=t.definition.geometryType;if(t.definition.isAnimation){const a=t.definition.state+"."+t.actionParameter,o=this._animationManager.getAnimation(a);if(o&&(s=o.getAnimatedBodyPartIds(0,t.overridingAction),o.hasAddData())){const h={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},u={setType:""};for(const c of o.addData){const l=this._geometry.getBodyPart(n,c.align);if(l){h.id=c.id,l.addPart(h,e),u.setType=c.id;const _=this._partSetsData.addPartDefinition(u);_.appendToFigure=!0,c.base===""&&(_.staticId=1),i.indexOf(l.id)===-1&&i.push(l.id)}}}for(const h of s){const u=this._geometry.getBodyPart(n,h);u&&i.indexOf(u.id)===-1&&i.push(u.id)}}else{s=this._partSetsData.getActiveParts(t.definition);for(const a of s){const o=this._geometry.getBodyPartOfItem(n,a,e);o&&i.indexOf(o.id)===-1&&i.push(o.id)}}return i}getBodyPartsUnordered(t){return this._geometry.getBodyPartIdsInAvatarSet(t)}getBodyParts(t,e,s){const i=_r.DIRECTION_TO_ANGLE[s];return this._geometry.getBodyPartsAtAngle(t,i,e)}getFrameBodyPartOffset(t,e,s,i){const n=this._animationData.getAction(t.definition);return n?n.getFrameBodyPartOffset(e,s,i):sf.DEFAULT_OFFSET}getParts(t,e,s,i,n,a,o,h=null){let u=null,c=[],l=null;if(!s==null)return[];const _=this._partSetsData.getActiveParts(s.definition),d=[];let f=[0];const m=this._animationData.getAction(s.definition);if(s.definition.isAnimation){const O=s.definition.state+"."+s.actionParameter,A=this._animationManager.getAnimation(O);if(A){f=this.getPopulatedArray(A.frameCount(s.overridingAction));for(const y of A.getAnimatedBodyPartIds(0,s.overridingAction))if(y===t){const M=this._geometry.getBodyPart(i,y);if(M)for(const N of M.getDynamicParts(o))_.push(N.id)}}}const p=this._geometry.getParts(i,t,n,_,o),T=e.getPartTypeIds();for(const O of T){if(h&&h.get(O))continue;const A=e.getPartSetId(O),y=e.getPartColorIds(O),M=this._figureData.getSetType(O);if(M){const N=this._figureData.getPalette(M.paletteID);if(N){const P=M.getPartSet(A);if(P){a=a.concat(P.hiddenLayers);for(const b of P.parts)if(p.indexOf(b.type)>-1){if(m){const ct=m.getPart(b.type);ct?c=ct.frames:c=f}else c=f;u=s.definition,_.indexOf(b.type)===-1&&(u=this._defaultAction);const D=this._partSetsData.getPartDefinition(b.type);let x=D?D.flippedSetType:b.type;(!x||x==="")&&(x=b.type),y&&y.length>b.colorLayerIndex-1&&(l=N.getColor(y[b.colorLayerIndex-1]));const V=b.colorLayerIndex>0,J=new jc(t,b.type,b.id.toString(),l,c,u,V,b.paletteMap,x);d.push(J)}}}}}const v=[];for(const O of p){let A=null,y=!1;const M=h&&h.get(O);for(const N of d)N.partType===O&&(M?A=N.color:(y=!0,a.indexOf(O)===-1&&v.push(N)));if(!y){if(M){const N=h.get(O);let P=0,b=0;for(;b<N.length;)P=P+N.charCodeAt(b),b++;if(m){const x=m.getPart(O);x?c=x.frames:c=f}else c=f;const D=new jc(t,O,N,A,c,s.definition,A!=null,-1,O,!1,1);v.push(D)}else if(_.indexOf(O)>-1){const N=this._geometry.getBodyPartOfItem(i,O,o);if(t===N.id){const P=this._partSetsData.getPartDefinition(O);let b=!1,D=1;if(P.appendToFigure){let x="1";if(s.actionParameter!==""&&(x=s.actionParameter),P.hasStaticId()&&(x=P.staticId.toString()),m){const J=m.getPart(O);J?c=J.frames:c=f}else c=f;const V=new jc(t,O,x,null,c,s.definition,!1,-1,O,b,D);v.push(V)}}}}}return v}getPopulatedArray(t){const e=[];let s=0;for(;s<t;)e.push(s),s++;return e}getItemIds(){if(this._actionManager){const t=this._actionManager.getActionDefinition("CarryItem").params,e=[];for(const s of t.values())e.push(s);return e}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const pst={animations:[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}]},mst={geometry:{direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]}},Ist={partSets:{partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]}},au=class Br extends vs{constructor(t,e,s,i){super(),this._state=Br.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=i,this._assets=s,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=Br.LOADED)}async downloadAsset(){if(!this._assets||this._state===Br.LOADING||this._state===Br.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=Br.LOADED,this.dispatchEvent(new Ta(Ta.DOWNLOAD_COMPLETE,this));return}if(this._state=Br.LOADING,!await this._assets.downloadAsset(this._downloadUrl))return;this._state=Br.LOADED;const s=this._assets.getCollection(this._libraryName);s&&(this._animation=s.data.animations),this.dispatchEvent(new Ta(Ta.DOWNLOAD_COMPLETE,this))}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===Br.LOADED}};au.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE";au.NOT_LOADED=0;au.LOADING=1;au.LOADED=2;let Tst=au;const q_=class pg extends vs{constructor(t,e){super(),this._assets=t,this._structure=e,this._missingMandatoryLibs=at.getValue("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(l_.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const t=new XMLHttpRequest;try{t.open("GET",at.getValue("avatar.effectmap.url")),t.send(),t.onloadend=e=>{if(t.responseText){const s=JSON.parse(t.responseText);this.processEffectMap(s.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new It(pg.DOWNLOADER_READY))}},t.onerror=e=>{throw new Error("invalid_avatar_effect_map")}}catch(e){Y.error(e)}}processEffectMap(t){if(t)for(const e of t){if(!e)continue;const s=e.id,i=e.lib,n=e.revision||"";if(this._libraryNames.indexOf(i)>=0)continue;this._libraryNames.push(i);const a=new Tst(i,n,this._assets,at.getValue("avatar.asset.effect.url"));a.addEventListener(Ta.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let o=this._effectMap.get(s);o||(o=[]),o.push(a),this._effectMap.set(s,o)}}downloadAvatarEffect(t,e){if(!this._isReady||!this._structure.renderManager.isReady){this._initDownloadBuffer.push([t,e]);return}const s=this.getAvatarEffectPendingLibraries(t);if(s&&s.length){if(e&&!e.disposed){let i=this._effectListeners.get(t.toString());i||(i=[]),i.push(e),this._effectListeners.set(t.toString(),i)}this._incompleteEffects.set(t.toString(),s);for(const i of s)i&&this.downloadLibrary(i)}else e&&!e.disposed&&e.resetEffect(t)}onAvatarRenderReady(t){if(t){for(const[e,s]of this._initDownloadBuffer)this.downloadAvatarEffect(e,s);this._initDownloadBuffer=[]}}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];this._structure.registerAnimation(t.library.animation);for(const[i,n]of this._incompleteEffects.entries()){let a=!0;for(const o of n)if(!(!o||o.isLoaded)){a=!1;break}if(a){e.push(i);const o=this._effectListeners.get(i);for(const h of o)!h||h.disposed||h.resetEffect(parseInt(i));this._effectListeners.delete(i),this.dispatchEvent(new It(pg.LIBRARY_LOADED))}}for(const i of e)this._incompleteEffects.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const s=this._effectMap.get(e);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarEffectReady(t){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarEffectPendingLibraries(t).length}getAvatarEffectPendingLibraries(t){const e=[];if(!this._structure)return e;const s=this._effectMap.get(t.toString());if(s)for(const i of s)!i||i.isLoaded||e.indexOf(i)===-1&&e.push(i);return e}downloadLibrary(t){!t||t.isLoaded||this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};q_.DOWNLOADER_READY="EADM_DOWNLOADER_READY";q_.LIBRARY_LOADED="EADM_LIBRARY_LOADED";q_.MAX_DOWNLOADS=2;let Ro=q_;class Rst extends PO{constructor(t,e,s,i,n){super(t,e,s,i,n,null)}isPlaceholder(){return!0}}const v0=class A0 extends Rr{constructor(){super(),this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new Est(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new iw(this,Cs()),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new mo(Cs(),this._structure),this._avatarAssetDownloadManager.addEventListener(mo.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(mo.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new Ro(Cs(),this._structure),this._effectAssetDownloadManager.addEventListener(Ro.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(Ro.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(mo.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(mo.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(Ro.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(Ro.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure.initGeometry(mst.geometry),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure.initPartSets(Ist.partSets),this._partSetsReady=!0,this.checkReady())}loadActions(){const t=at.getValue("avatar.default.actions");t&&this._structure.initActions(Cs(),t);const e=new XMLHttpRequest;try{e.open("GET",at.getValue("avatar.actions.url")),e.send(),e.onloadend=s=>{this._structure&&(this._structure.updateActions(JSON.parse(e.responseText)),this._actionsReady=!0,this.checkReady())},e.onerror=s=>{throw new Error("invalid_avatar_actions")}}catch(s){Y.error(s)}}loadAnimations(){this._structure&&(this._structure.initAnimation(pst.animations),this._animationsReady=!0,this.checkReady())}loadFigureData(){const t=at.getValue("avatar.default.figuredata");if(!t||typeof t=="string"){Y.error("XML figuredata is no longer supported");return}this._structure&&this._structure.initFigureData(t),new Jm(at.getValue("avatar.figuredata.url"),this._structure.figureData).addEventListener(Jm.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(t){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(t){t&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(t){t&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(t){t&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(t){t&&this._aliasCollection.reset()}checkReady(){this._isReady||!this._geometryReady||!this._partSetsReady||!this._actionsReady||!this._animationsReady||!this._figureMapReady||!this._effectMapReady||!this._structureReady||(this._isReady=!0,this.events&&this.events.dispatchEvent(new It(l_.AVATAR_RENDER_READY)))}createFigureContainer(t){return new qu(t)}isFigureContainerReady(t){return this._avatarAssetDownloadManager?this._avatarAssetDownloadManager.isAvatarFigureContainerReady(t):!1}createAvatarImage(t,e,s,i=null,n=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const a=new qu(t);return s&&this.validateAvatarFigure(a,s),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(a)?new PO(this._structure,this._aliasCollection,a,e,this._effectAssetDownloadManager,n):(this._placeHolderFigure||(this._placeHolderFigure=new qu(A0.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(a,i),new Rst(this._structure,this._aliasCollection,this._placeHolderFigure,e,this._effectAssetDownloadManager))}downloadAvatarFigure(t,e){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(t,e)}validateAvatarFigure(t,e){let s=!1;const i=this._structure.getMandatorySetTypeIds(e,2);if(i){const n=this._structure.figureData;for(const a of i)if(t.hasPartType(a)){const o=n.getSetType(a);if(o&&!o.getPartSet(t.getPartSetId(a))){const u=this._structure.getDefaultPartSet(a,e);u&&(t.updatePart(a,u.id,[0]),s=!0)}}else{const o=this._structure.getDefaultPartSet(a,e);o&&(t.updatePart(a,o.id,[0]),s=!0)}}return!s}getFigureClubLevel(t,e,s=null){if(!this._structure)return 0;const i=this._structure.figureData,n=Array.from(t.getPartTypeIds());let a=0;for(const o of n){const h=i.getSetType(o);if(!h)continue;const u=t.getPartSetId(o),c=h.getPartSet(u);if(c){a=Math.max(c.clubLevel,a);const l=i.getPalette(h.paletteID),_=t.getPartColorIds(o);for(const d of _){const f=l.getColor(d);f&&(a=Math.max(f.clubLevel,a))}}}s||(s=this._structure.getBodyPartsUnordered(Je.FULL));for(const o of s){const h=i.getSetType(o);h&&n.indexOf(o)===-1&&(a=Math.max(h.optionalFromClubLevel(e),a))}return a}isValidFigureSetForGender(t,e){const i=this.structureData.getFigurePartSet(t);return!!(i&&(i.gender.toUpperCase()==="U"||i.gender.toUpperCase()===e.toUpperCase()))}getFigureStringWithFigureIds(t,e,s){const i=new Sw;i.loadAvatarData(t,e);const n=this.resolveFigureSets(s);for(const a of n)i.savePartData(a.type,a.id,i.getColourIds(a.type));return i.getFigureString()}resolveFigureSets(t){const e=this.structureData,s=[];for(const i of t){const n=e.getFigurePartSet(i);n&&s.push(n)}return s}getMandatoryAvatarPartSetIds(t,e){return this._structure?this._structure.getMandatorySetTypeIds(t,e):null}getAssetByName(t){return this._aliasCollection.getAsset(t)}get assets(){return Cs()}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}};v0.DEFAULT_FIGURE="hd-99999-99999";let Ost=v0;class vst{constructor(t,e,s){this._layerId=t,this._partId=e,this._paletteId=s}get layerId(){return this._layerId}set layerId(t){this._layerId=t}get partId(){return this._partId}set partId(t){this._partId=t}get paletteId(){return this._paletteId}set paletteId(t){this._paletteId=t}}class ql{constructor(t){this._typeId=this.getTypeId(t),this._paletteId=this.getPaletteId(t),this._color=this.getColor(t),this._headOnly=this.getHeadOnly(t);const e=this.getCustomData(t);this._customLayerIds=this.getCustomLayerIds(e),this._customPartIds=this.getCustomPartIds(e),this._customPaletteIds=this.getCustomPaletteIds(e),this._customParts=[];let s=0;for(;s<this._customLayerIds.length;)this._customParts.push(new vst(this._customLayerIds[s],this._customPartIds[s],this._customPaletteIds[s])),s++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(t){if(this._customParts){for(const e of this._customParts)if(e.layerId===t)return e}return null}get hasCustomParts(){return this._customLayerIds!=null&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let t=this.typeId+" "+this.paletteId+" "+this.color.toString(16);t=t+(" "+this.customParts.length);for(const e of this.customParts)t=t+(" "+e.layerId+" "+e.partId+" "+e.paletteId);return t}getCustomData(t){let e=[];if(t){const s=t.split(" "),i=this._headOnly?1:0,n=4+i;if(s.length>n){const a=3+i,o=parseInt(s[a]);e=s.slice(n,n+o*3)}}return e}getCustomLayerIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+0])),s=s+3;return e}getCustomPartIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+1])),s=s+3;return e}getCustomPaletteIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+2])),s=s+3;return e}getTypeId(t){if(t){const e=t.split(" ");if(e.length>=1)return parseInt(e[0])}return 0}getPaletteId(t){if(t){const e=t.split(" ");if(e.length>=2)return parseInt(e[1])}return 0}getColor(t){if(t){const e=t.split(" ");if(e.length>=3)return parseInt(e[2],16)}return 16777215}getHeadOnly(t){if(t){const e=t.split(" ");if(e.length>=4)return e[3]==="head"}return!1}}class Q_{constructor(t){this._complete=!0,this._target=t}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(t){this._target=t}get target(){return this._target}set tag(t){this._tag=t}get tag(){return this._tag}start(){this._running=!0}update(t){}stop(){this._target=null,this._running=!1}tick(t){}}class Vst extends Q_{constructor(t){super(t)}tick(t){super.tick(t),this.target&&(this.target.remove(),this.target=null)}}class jE extends Q_{constructor(t,e){super(t),this._complete=!1,this._duration=e}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=ft()}tick(t){super.tick(t);const e=(t-this._startTimeMs)/this._duration;e<1?this.update(e):(this.update(1),this._complete=!0)}}class kst extends jE{constructor(t,e,s){super(t,e),this._height=s}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(t){super.update(t),this.target.style.top=this._offset-this._height+this.getBounceOffset(t)*this._height+"px"}getBounceOffset(t){return t<.364?7.5625*t*t:t<.727?(t=t-.545,7.5625*t*t+.75):t<.909?(t=t-.9091,7.5625*t*t+.9375):(t=t-.955,7.5625*t*t+.984375)}stop(){this.target.style.top=this._offset+"px",super.stop()}}class Ast extends jE{constructor(t){super(t.target,t.duration),this._interval=t}start(){super.start(),this._interval.start()}update(t){super.update(t),this._interval.update(t)}stop(){super.stop(),this._interval.stop()}}class Sst extends Ast{constructor(t,e){super(t),this._rate=e}}class jst extends Sst{constructor(t,e){super(t,e)}update(t){this._interval.update(Math.pow(t,1/this._rate))}}class zst extends jE{constructor(t,e,s,i,n,a){super(t,e),this._deltaX=s,this._deltaY=i,this._height=-n,this._numJumps=a}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(t){super.update(t),this.target.style.left=this._startX+this._deltaX*t+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(t*Math.PI*this._numJumps))+this._deltaY*t+"px"}}const uo=class dt{static get TIMER_TIME(){return 1e3/Z1()}static runMotion(t){return dt._RUNNING_MOTIONS.indexOf(t)===-1&&dt._QUEUED_MOTIONS.indexOf(t)===-1&&(dt._IS_UPDATING?dt._QUEUED_MOTIONS.push(t):(dt._RUNNING_MOTIONS.push(t),t.start()),dt.startTimer()),t}static removeMotion(t){let e=dt._RUNNING_MOTIONS.indexOf(t);e>-1?dt._IS_UPDATING?(e=dt._REMOVED_MOTIONS.indexOf(t),e==-1&&dt._REMOVED_MOTIONS.push(t)):(dt._RUNNING_MOTIONS.splice(e,1),t.running&&t.stop(),dt._RUNNING_MOTIONS.length||dt.stopTimer()):(e=dt._QUEUED_MOTIONS.indexOf(t),e>-1&&dt._QUEUED_MOTIONS.splice(e,1))}static getMotionByTag(t){for(const e of dt._RUNNING_MOTIONS)if(e.tag==t)return e;for(const e of dt._QUEUED_MOTIONS)if(e.tag==t)return e;return null}static getMotionByTarget(t){for(const e of dt._RUNNING_MOTIONS)if(e.target==t)return e;for(const e of dt._QUEUED_MOTIONS)if(e.target==t)return e;return null}static getMotionByTagAndTarget(t,e){for(const s of dt._RUNNING_MOTIONS)if(s.tag==t&&s.target==e)return s;for(const s of dt._QUEUED_MOTIONS)if(s.tag==t&&s.target==e)return s;return null}static get isRunning(){return!!dt._TIMER}static get isUpdating(){return dt._IS_UPDATING}static onTick(){dt._IS_UPDATING=!0;const t=ft();let e=null;for(;e=dt._QUEUED_MOTIONS.pop();)dt._RUNNING_MOTIONS.push(e);for(;e=dt._REMOVED_MOTIONS.pop();)dt._RUNNING_MOTIONS.splice(dt._RUNNING_MOTIONS.indexOf(e),1),e.running&&e.stop();for(e of dt._RUNNING_MOTIONS)e.running?(e.tick(t),e.complete&&dt.removeMotion(e)):dt.removeMotion(e);dt._RUNNING_MOTIONS.length||dt.stopTimer(),dt._IS_UPDATING=!1}static startTimer(){dt._TIMER||(dt._TIMER=setInterval(dt.onTick,dt.TIMER_TIME))}static stopTimer(){dt._TIMER&&(clearInterval(dt._TIMER),dt._TIMER=null)}getNumRunningMotions(t){let e=0;for(const s of dt._RUNNING_MOTIONS)s.target===t&&e++;return e}};uo._QUEUED_MOTIONS=[];uo._RUNNING_MOTIONS=[];uo._REMOVED_MOTIONS=[];uo._TIMER=null;uo._IS_UPDATING=!1;let Yst=uo;class Wst extends Q_{constructor(...t){super(t?t[0].target:null),this._queue=[];for(const e of t)this._queue.push(e);this._motion=t[0],this._complete=!this._motion}get running(){return this._running&&this._motion?this._motion.running:!1}start(){super.start(),this._motion.start()}update(t){super.update(t),this._motion.running&&this._motion.update(t)}stop(){super.stop(),this._motion.stop()}tick(t){if(super.tick(t),this._motion.tick(t),this._motion.complete){this._motion.stop();const e=this._queue.indexOf(this._motion);e<this._queue.length-1?(this._motion=this._queue[e+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class Xst extends Q_{constructor(t){super(null),this._waitTimeMs=t}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=ft()}tick(t){super.tick(t),this._complete=t-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}export{qW as $,q as A,kq as B,af as C,PK as D,vs as E,rZ as F,eK as G,Xl as H,It as I,Ce as J,EF as K,Rt as L,k as M,Q as N,Pi as O,ql as P,Gh as Q,I as R,Al as S,Dh as T,qZ as U,S as V,eF as W,yl as X,bst as Y,Xr as Z,KW as _,at as a,E5 as a$,QW as a0,S8 as a1,OY as a2,U8 as a3,Wd as a4,mA as a5,UX as a6,bX as a7,CX as a8,PX as a9,WY as aA,JY as aB,VY as aC,d8 as aD,BY as aE,F4 as aF,xY as aG,UY as aH,MY as aI,CY as aJ,AF as aK,G8 as aL,w8 as aM,Rs as aN,uK as aO,_S as aP,q8 as aQ,W8 as aR,k8 as aS,B8 as aT,Bst as aU,ot as aV,Ef as aW,y5 as aX,C5 as aY,GK as aZ,v5 as a_,W4 as aa,NX as ab,J4 as ac,aY as ad,E4 as ae,FX as af,GX as ag,xX as ah,FY as ai,hY as aj,z4 as ak,wX as al,oY as am,nY as an,DX as ao,BX as ap,Ci as aq,Rf as ar,Y as as,j8 as at,DY as au,PY as av,qY as aw,XY as ax,KY as ay,jY as az,Ts as b,K9 as b$,p5 as b0,I5 as b1,Ov as b2,HK as b3,wK as b4,FK as b5,YK as b6,kK as b7,UK as b8,LK as b9,_Y as bA,fY as bB,cI as bC,a4 as bD,o4 as bE,h4 as bF,u4 as bG,l4 as bH,G9 as bI,g4 as bJ,f4 as bK,p4 as bL,dI as bM,m4 as bN,hv as bO,I4 as bP,T4 as bQ,R4 as bR,O4 as bS,A4 as bT,S4 as bU,y4 as bV,M4 as bW,C4 as bX,Y9 as bY,Q9 as bZ,k9 as b_,M5 as ba,jK as bb,V5 as bc,N5 as bd,k5 as be,vv as bf,r7 as bg,Av as bh,I7 as bi,E9 as bj,CW as bk,YW as bl,_9 as bm,yW as bn,SW as bo,MW as bp,AW as bq,pY as br,HX as bs,Z9 as bt,J9 as bu,r4 as bv,s4 as bw,F9 as bx,w9 as by,cY as bz,Yr as c,NK as c$,j9 as c0,z9 as c1,Y4 as c2,V4 as c3,K4 as c4,k4 as c5,H4 as c6,j4 as c7,EY as c8,gY as c9,E8 as cA,Fh as cB,p8 as cC,$Z as cD,JZ as cE,OX as cF,XO as cG,Kd as cH,RF as cI,At as cJ,$ as cK,Eh as cL,hR as cM,X1 as cN,zt as cO,ut as cP,G as cQ,fZ as cR,We as cS,I6 as cT,st as cU,CK as cV,u5 as cW,l5 as cX,c5 as cY,_5 as cZ,yK as c_,AX as ca,iX as cb,Wq as cc,Yq as cd,wl as ce,qs as cf,hA as cg,u6 as ch,Ot as ci,f6 as cj,m_ as ck,g6 as cl,Dv as cm,pf as cn,gf as co,ff as cp,gX as cq,mX as cr,MX as cs,yX as ct,lX as cu,dX as cv,wh as cw,h6 as cx,EX as cy,g8 as cz,BE as d,OZ as d$,qd as d0,vF as d1,nZ as d2,O6 as d3,T6 as d4,R6 as d5,DK as d6,oZ as d7,gE as d8,hZ as d9,Nz as dA,DZ as dB,YF as dC,VF as dD,jF as dE,Sl as dF,pt as dG,QQ as dH,Fst as dI,xst as dJ,Qs as dK,Xs as dL,fs as dM,vl as dN,Qet as dO,OF as dP,d6 as dQ,Si as dR,Zr as dS,vX as dT,Dt as dU,Aa as dV,IS as dW,jr as dX,zr as dY,Tv as dZ,o8 as d_,xZ as da,BZ as db,si as dc,ast as dd,Ho as de,vi as df,Qd as dg,y6 as dh,tZ as di,m6 as dj,aZ as dk,EZ as dl,P6 as dm,b6 as dn,N6 as dp,gZ as dq,pZ as dr,w6 as ds,L6 as dt,U6 as du,x6 as dv,Pz as dw,PZ as dx,bz as dy,LZ as dz,L as e,i7 as e$,_r as e0,N8 as e1,KZ as e2,n4 as e3,T8 as e4,C8 as e5,IY as e6,mY as e7,TY as e8,P8 as e9,oq as eA,eq as eB,w4 as eC,P4 as eD,zZ as eE,r8 as eF,iK as eG,gK as eH,U4 as eI,nq as eJ,uq as eK,Me as eL,Cs as eM,Pst as eN,nr as eO,D6 as eP,Gf as eQ,IZ as eR,mZ as eS,TZ as eT,wf as eU,kf as eV,T5 as eW,BK as eX,zK as eY,VK as eZ,XK as e_,L8 as ea,D8 as eb,Gst as ec,x8 as ed,F8 as ee,AY as ef,SY as eg,hK as eh,GY as ei,YZ as ej,QY as ek,sK as el,lK as em,Z6 as en,FZ as eo,Ze as ep,X8 as eq,s5 as er,e5 as es,dK as et,BG as eu,G4 as ev,D4 as ew,lq as ex,hq as ey,rq as ez,Nst as f,N4 as f$,JK as f0,a7 as f1,P7 as f2,D7 as f3,L7 as f4,v7 as f5,iW as f6,R7 as f7,T7 as f8,b7 as f9,KX as fA,UW as fB,FW as fC,Cv as fD,HW as fE,BW as fF,GW as fG,yv as fH,Mv as fI,wW as fJ,Hst as fK,I8 as fL,tJ as fM,c9 as fN,dE as fO,y8 as fP,uY as fQ,M8 as fR,i9 as fS,e9 as fT,s9 as fU,r9 as fV,a9 as fW,yY as fX,H8 as fY,JX as fZ,DQ as f_,aW as fa,U7 as fb,ed as fc,uW as fd,M7 as fe,oW as ff,nW as fg,Hh as fh,p7 as fi,m7 as fj,C7 as fk,N7 as fl,O7 as fm,hW as fn,x7 as fo,R9 as fp,T9 as fq,O9 as fr,C9 as fs,VW as ft,A9 as fu,m9 as fv,I9 as fw,M9 as fx,Fs as fy,S9 as fz,mg as g,Yg as g$,$9 as g0,W9 as g1,X9 as g2,Nv as g3,Q4 as g4,Eq as g5,X4 as g6,fq as g7,Xh as g8,Tq as g9,gs as gA,K6 as gB,WQ as gC,B6 as gD,qQ as gE,XQ as gF,k6 as gG,H6 as gH,V6 as gI,ZQ as gJ,WA as gK,YQ as gL,Y6 as gM,JQ as gN,iQ as gO,Uq as gP,_K as gQ,nK as gR,$Y as gS,df as gT,lW as gU,CF as gV,wq as gW,QX as gX,$Q as gY,vst as gZ,wst as g_,B4 as ga,dq as gb,N_ as gc,Cq as gd,Mq as ge,Yh as gf,$4 as gg,mq as gh,cq as gi,Oq as gj,yq as gk,Rq as gl,Yn as gm,vq as gn,Iq as go,Z4 as gp,pq as gq,q4 as gr,gq as gs,xq as gt,Vq as gu,bZ as gv,TQ as gw,RQ as gx,aQ as gy,OQ as gz,zs as h,iS as h0,Oh as h1,bA as h2,KA as h3,Bn as h4,zF as h5,WF as h6,UF as h7,n8 as h8,QZ as h9,lA as hA,jS as hB,a8 as hC,h8 as hD,eJ as hE,rJ as hF,sJ as hG,iJ as hH,Qo as hI,Oa as hJ,ke as hK,Mi as hL,AZ as ha,q9 as hb,vZ as hc,SZ as hd,l6 as he,KQ as hf,DF as hg,sX as hh,tX as hi,eX as hj,Nq as hk,uZ as hl,RZ as hm,E6 as hn,vQ as ho,_Q as hp,Di as hq,Zt as hr,Km as hs,Yst as ht,Wst as hu,Xst as hv,kst as hw,jst as hx,zst as hy,Vst as hz,te as i,Qt as j,As as k,Gn as l,cr as m,Je as n,Xu as o,ft as p,Vg as q,Ys as r,de as s,f_ as t,qu as u,CO as v,S7 as w,F7 as x,A7 as y,y7 as z};
