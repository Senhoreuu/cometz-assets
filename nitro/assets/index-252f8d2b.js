import{r as i,j as t,a as l,F as hn,b as Xm,c as Vi,d as Hi,e as Wi,f as V,E as Sr,g as xr,T as Qm,u as Jm,h as ct,i as Zm,k as ji,l as eg,m as Kr,R as tg,C as Sl,n as Cu,o as Dt,p as ng,q as rg,s as sg,t as Jt,v as Zt,w as io,x as Js,y as _u,z as bu,A as Su,B as ag,D as Nu,G as og,H as ig,I as Tu,P as ps,O as vu,J as lg,K as cg,L as lo,M as Ei,N as ug,Q as dg,S as mg,U as gg,V as hg,W as qi,X as zi,Y as fg,Z as pg,_ as Ig,$ as Eg,a0 as Nl,a1 as Cg,a2 as _g,a3 as wu,a4 as bg,a5 as Po,a6 as Do,a7 as Mo,a8 as Sg}from"./vendor-0ff889d5.js";import{N as is,a as hr,H as Zs,M as Re,T as In,R as ae,b as nt,A as ms,d as dn,G as Ng,e as Q,D as Tg,C as cn,f as vg,h as wg,i as za,j as rr,k as We,l as Ir,m as Yi,n as Ya,E as Rg,o as Tl,p as yn,q as Vs,r as pt,F as Wa,s as Hs,S as ea,t as Ps,u as yg,v as Ru,w as Ws,x as Og,y as kg,z as Ag,B as $a,I as Ln,J as gr,O as yu,V as wt,K as Lo,P as Is,L as Ut,Q as Fn,U as Pg,W as Dg,X as Uo,Y as Ou,Z as Er,_ as Mg,$ as Lg,a0 as Ug,a1 as xg,a2 as Fg,a3 as Bg,a4 as Gg,a5 as Vg,a6 as Hg,a7 as Wg,a8 as jg,a9 as qg,aa as zg,ab as ku,ac as Yg,ad as $g,ae as Kg,af as Xg,ag as Qg,ah as Jg,ai as Zg,aj as eh,ak as th,al as nh,am as rh,an as sh,ao as ah,ap as oh,aq as Ci,ar as ih,as as Au,at as lh,au as ch,av as uh,aw as dh,ax as mh,ay as gh,az as hh,aA as fh,aB as ph,aC as Ih,aD as Eh,aE as Ch,aF as _h,aG as Pu,aH as bh,aI as Sh,aJ as Nh,aK as vl,aL as Th,aM as vh,aN as wh,aO as co,aP as Rh,aQ as yh,aR as Du,aS as Oh,aT as kh,aU as Ka,aV as jt,aW as ws,aX as Mu,aY as Lu,aZ as Ah,a_ as Ph,a$ as Dh,b0 as Mh,b1 as Lh,b2 as Uh,b3 as xh,b4 as Fh,b5 as $i,b6 as Ls,b7 as Uu,b8 as wl,b9 as Bh,ba as Gh,bb as Vh,bc as Hh,bd as Wh,be as jh,bf as qh,bg as zh,bh as Yh,bi as $h,bj as Kh,bk as Xh,bl as Qh,bm as Jh,bn as Zh,bo as ef,bp as tf,bq as nf,br as rf,bs as sf,bt as af,bu as of,bv as lf,bw as cf,bx as uf,by as df,bz as mf,bA as gf,bB as hf,bC as ff,bD as xu,bE as _i,bF as pf,bG as Fu,bH as If,bI as Ef,bJ as Cf,bK as _f,bL as bf,bM as Sf,bN as Nf,bO as Tf,bP as vf,bQ as wf,bR as Rf,bS as yf,bT as Of,bU as kf,bV as Af,bW as Pf,bX as Df,bY as Mf,bZ as Lf,b_ as Uf,b$ as xf,c0 as Ff,c1 as Bf,c2 as Gf,c3 as Vf,c4 as Hf,c5 as Wf,c6 as jf,c7 as qf,c8 as zf,c9 as Yf,ca as $f,cb as Kf,cc as Xf,cd as Bu,ce as Gu,cf as js,cg as Qf,ch as Jf,ci as qs,cj as Vu,ck as st,cl as Zf,cm as ep,cn as tp,co as np,cp as rp,cq as sp,cr as ap,cs as op,ct as ip,cu as lp,cv as cp,cw as xo,cx as up,cy as dp,cz as mp,cA as gp,cB as hp,cC as fp,cD as Rl,cE as pp,cF as Ip,cG as jr,cH as Ep,cI as Cp,cJ as En,cK as It,cL as _p,cM as bp,cN as Sp,cO as ga,cP as Vn,cQ as ve,cR as Np,cS as Mt,cT as Tp,cU as vp,cV as wp,cW as Rp,cX as yp,cY as Op,cZ as kp,c_ as Ap,c$ as Pp,d0 as Dp,d1 as Mp,d2 as Lp,d3 as Up,d4 as xp,d5 as Fp,d6 as Bp,d7 as Gp,d8 as bi,d9 as Vp,da as Hp,db as Wp,dc as Hu,dd as jp,de as qp,df as yl,dg as zp,dh as Yp,di as $p,dj as Kp,dk as Si,dl as Xp,dm as Qp,dn as Jp,dp as Zp,dq as ha,dr as Ol,ds as eI,dt as tI,du as nI,dv as rI,dw as Wu,dx as sI,dy as ju,dz as aI,dA as qu,dB as oI,dC as iI,dD as lI,dE as cI,dF as kl,dG as Rn,dH as zu,dI as Ni,dJ as er,dK as Al,dL as Pl,dM as Et,dN as vr,dO as uI,dP as dI,dQ as mI,dR as gI,dS as Fo,dT as hI,dU as Dl,dV as Ml,dW as fI,dX as Bo,dY as Go,dZ as pI,d_ as Yu,d$ as II,e0 as fa,e1 as EI,e2 as $u,e3 as CI,e4 as _I,e5 as bI,e6 as SI,e7 as NI,e8 as TI,e9 as vI,ea as wI,eb as RI,ec as Vo,ed as yI,ee as OI,ef as kI,eg as AI,eh as PI,ei as DI,ej as Ku,ek as MI,el as LI,em as UI,en as xI,eo as FI,ep as Us,eq as BI,er as GI,es as VI,et as HI,eu as Ll,ev as WI,ew as jI,ex as qI,ey as zI,ez as YI,eA as $I,eB as Ul,eC as KI,eD as XI,eE as QI,eF as JI,eG as ZI,eH as eE,eI as tE,eJ as nE,eK as rE,eL as sE,eM as Xu,eN as aE,eO as oE,eP as iE,eQ as lE,eR as cE,eS as uE,eT as Qu,eU as dE,eV as mE,eW as gE,eX as hE,eY as fE,eZ as pE,e_ as IE,e$ as EE,f0 as CE,f1 as _E,f2 as bE,f3 as SE,f4 as NE,f5 as TE,f6 as vE,f7 as wE,f8 as RE,f9 as Ki,fa as ta,fb as yE,fc as Ho,fd as OE,fe as xl,ff as kE,fg as AE,fh as Qt,fi as PE,fj as DE,fk as ME,fl as LE,fm as UE,fn as xE,fo as FE,fp as BE,fq as GE,fr as VE,fs as HE,ft as WE,fu as jE,fv as qE,fw as zE,fx as YE,fy as Ju,fz as Fl,fA as Zu,fB as $E,fC as KE,fD as XE,fE as QE,fF as JE,fG as ZE,fH as eC,fI as tC,fJ as nC,fK as jn,fL as rC,fM as sC,fN as aC,fO as oC,fP as iC,fQ as lC,fR as cC,fS as uC,fT as dC,fU as mC,fV as gC,fW as hC,fX as fC,fY as pC,fZ as IC,f_ as EC,f$ as CC,g0 as _C,g1 as Bl,g2 as bC,g3 as SC,g4 as NC,g5 as TC,g6 as vC,g7 as wC,g8 as pa,g9 as Gl,ga as RC,gb as yC,gc as Ia,gd as ed,ge as OC,gf as Wo,gg as kC,gh as AC,gi as PC,gj as td,gk as DC,gl as MC,gm as LC,gn as UC,go as xC,gp as FC,gq as BC,gr as GC,gs as VC,gt as HC,gu as WC,gv as jC,gw as qC,gx as zC,gy as Es,gz as YC,gA as Vl,gB as $C,gC as KC,gD as XC,gE as nd,gF as QC,gG as JC,gH as ZC,gI as e_,gJ as t_,gK as n_,gL as r_,gM as s_,gN as a_,gO as o_,gP as i_,gQ as l_,gR as rd,gS as c_,gT as sd,gU as u_,gV as d_,gW as m_,gX as g_,gY as mr,gZ as jo,g_ as h_,g$ as Hl,h0 as f_,h1 as p_,h2 as Xi,h3 as ad,h4 as Bn,h5 as I_,h6 as E_,h7 as C_,h8 as od,h9 as id,ha as __,hb as b_,hc as S_,hd as ld,he as N_,hf as T_,hg as v_,hh as w_,hi as R_,hj as y_,hk as O_,hl as k_,hm as A_,hn as P_,ho as D_,hp as M_,hq as Ea,hr as ht,hs as L_,ht as qo,hu as Wl,hv as U_,hw as x_,hx as F_,hy as B_,hz as G_,hA as V_,hB as H_,hC as W_,hD as j_,hE as q_,hF as z_,hG as Y_,hH as $_,hI as K_,hJ as jl,hK as Qn,hL as Ca}from"./nitro-renderer-a8aa42a7.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const c of a.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=n(s);fetch(s.href,a)}})();function _e(){return is.instance}function ut(o){_e().addLinkEventTracker(o)}function Nt(){return _e().avatar}function ql(o){return Nt().structureData.getPalette(o)}function zl(o){return Nt().structureData.getSetType(o)}function xs(){return _e().cameraManager}function X_(){return _e().core}function Q_(){return X_().configuration}function ee(o){o=o.startsWith("event:")?o.substring(6):o,_e().createLinkEvent(o)}function zs(){var o;return(o=_e())==null?void 0:o.communication}function K(o,e=null){return hr.getValue(o,e)}function Ti(){var o;return(o=zs())==null?void 0:o.connection}function cd(){return _e().localization}const Xr=o=>{!o||!o.length||(o.startsWith("http")?Zs.openWebPage(o):ee(o))};function dt(o){_e().removeLinkEventTracker(o)}function $(){return _e().roomEngine}let zo=!1,_a=0,ba=0;const Sa=(o,e=1)=>{const n=o.clientX,r=o.clientY;let s=o.type;switch(s===Re.MOUSE_CLICK&&(_a&&(ba=1,_a>=Date.now()-300&&ba++),_a=Date.now(),ba===2&&(zo||(s=Re.DOUBLE_CLICK),ba=0,_a=null)),s){case Re.MOUSE_CLICK:break;case Re.DOUBLE_CLICK:break;case Re.MOUSE_MOVE:zo=!0;break;case Re.MOUSE_DOWN:zo=!1;break;case Re.MOUSE_UP:break;case Re.RIGHT_CLICK:break;default:return}$().dispatchMouseEvent(e,n,r,s,o.altKey,o.ctrlKey||o.metaKey,o.shiftKey,!1)};let Yo=!1,Na=0,Ta=0;const va=(o,e=1,n=!1,r=!1,s=!1,a=!1)=>{let c=0,u=0;o.touches[0]?(c=o.touches[0].clientX,u=o.touches[0].clientY):o.changedTouches[0]&&(c=o.changedTouches[0].clientX,u=o.changedTouches[0].clientY);let d=o.type;switch(n&&(d=In.TOUCH_LONG),(d===Re.MOUSE_CLICK||d===In.TOUCH_END)&&(d=Re.MOUSE_CLICK,Na&&(Ta=1,Na>=Date.now()-300&&Ta++),Na=Date.now(),Ta===2&&(Yo||(d=Re.DOUBLE_CLICK),Ta=0,Na=null)),d){case Re.MOUSE_CLICK:break;case Re.DOUBLE_CLICK:break;case In.TOUCH_START:d=Re.MOUSE_DOWN,Yo=!1;break;case In.TOUCH_MOVE:d=Re.MOUSE_MOVE,Yo=!0;break;case In.TOUCH_END:d=Re.MOUSE_UP;break;case In.TOUCH_LONG:d=Re.MOUSE_DOWN_LONG;break;default:return}d===In.TOUCH_START&&$().dispatchMouseEvent(e,c,u,d,r,s,a,!1),$().dispatchMouseEvent(e,c,u,d,r,s,a,!1)};function Ht(o){if(!o||!o.model)return!1;const e=q().userId,n=o.model.getValue(ae.FURNITURE_OWNER_ID);return e===n}function Ys(o,e,n){return o?o.isRoomOwner||o.controllerLevel>=nt.GUEST||q().isModerator||Ht($().getRoomObject(o.roomId,e,n)):!1}function Qr(){return _e().roomSessionManager}function qr(o,e=null){Qr().createSession(o,e)}function J_(){const o=Jr();return o?o.model.getValue(ae.FIGURE_CAN_STAND_UP):ms.POSTURE_STAND}function $o(){const o=Jr();if(!o)return!1;const n=o.model.getValue(ae.FIGURE_EFFECT);return!(n===29||n===30||n===185)}function q(){return _e().sessionDataManager}function Cn(){return K("hc.disabled",!1)?dn.VIP:q().clubLevel}class on{}on.OKAY=0;on.MISSING_OFFER=1;on.FURNI_LIMIT_REACHED=2;on.NOT_IN_ROOM=3;on.NOT_ROOM_OWNER=4;on.GUILD_ROOM=5;on.VISITORS_IN_ROOM=6;class Z_{constructor(e,n,r){this._depth=0,this._localization="",this._pageId=-1,this._pageName="",this._iconId=0,this._depth=n,this._parent=r,this._localization=e.localization,this._pageId=e.pageId,this._pageName=e.pageName,this._iconId=e.icon,this._children=[],this._offerIds=e.offerIds,this._isVisible=e.visible,this._isActive=!1,this._isOpen=!1}activate(){this._isActive=!0}deactivate(){this._isActive=!1}open(){this._isOpen=!0}close(){this._isOpen=!1}addChild(e){e&&this._children.push(e)}get depth(){return this._depth}get isBranch(){return this._children.length>0}get isLeaf(){return this._children.length===0}get localization(){return this._localization}get pageId(){return this._pageId}get pageName(){return this._pageName}get iconId(){return this._iconId}get children(){return this._children}get offerIds(){return this._offerIds}get parent(){return this._parent}get isVisible(){return this._isVisible}get isActive(){return this._isActive}get isOpen(){return this._isOpen}}const ud=class dd{constructor(e,n,r,s,a,c=-1){this._pageId=e,this._layoutCode=n,this._localization=r,this._offers=s,this._acceptSeasonCurrencyAsCredits=a;for(const u of s)u.page=this;c===-1?this._mode=dd.MODE_NORMAL:this._mode=c}get pageId(){return this._pageId}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get mode(){return this._mode}};ud.MODE_NORMAL=0;let md=ud;class mt{}mt.DUCKET_INFO="ducket_info";mt.CREDITS="credits";mt.AVATAR_EFFECTS="avatar_effects";mt.HC_MEMBERSHIP="hc_membership";mt.CLUB_GIFTS="club_gifts";mt.LIMITED_SOLD="limited_sold";mt.PET_ACCESSORIES="pet_accessories";mt.TRAX_SONGS="trax_songs";mt.NEW_ADDITIONS="new_additions";mt.QUEST_SHELL="quest_shell";mt.QUEST_SNOWFLAKES="quest_snowflakes";mt.VAL_QUESTS="val_quests";mt.GUILD_CUSTOM_FURNI="guild_custom_furni";mt.GIFT_SHOP="gift_shop";mt.HORSE_STYLES="horse_styles";mt.HORSE_SHOE="horse_shoe";mt.SET_EASTER="set_easter";mt.ECOTRON_TRANSFORM="ecotron_transform";mt.LOYALTY_INFO="loyalty_info";mt.ROOM_BUNDLES="room_bundles";mt.ROOM_BUNDLES_MOBILE="room_bundles_mobile";mt.HABBO_CLUB_DESKTOP="habbo_club_desktop";mt.MOBILE_SUBSCRIPTIONS="mobile_subscriptions";class eb{constructor(e,n){this.breed=e,this.palettes=n}}class Ve{}Ve.NONE=0;Ve.CONFIRM=1;Ve.PURCHASE=2;Ve.NO_CREDITS=3;Ve.NO_POINTS=4;Ve.SOLD_OUT=5;Ve.FAILED=6;class kn{}kn.NORMAL="NORMAL";kn.BUILDER="BUILDERS_CLUB";const tb=o=>"",nb=o=>"",Yl=(o,e)=>{const n=o.get(e),r=[];if(n&&n.length)for(const s of n)s.isVisible&&r.push(s);return r},gd=(o,e,n,r)=>{if(n.isVisible&&n.pageId>0){let s=!1;const a=[n.pageName,n.localization].join(" ").toLowerCase().replace(/ /gi,"");if(a.indexOf(o)>-1&&(r.push(n),s=!0),!s){for(const c of e)if(a.indexOf(c)>=0){r.push(n);break}}}for(const s of n.children)gd(o,e,s,r)};function rb(o){if(!o.length)return 0;let e=o.length-1;for(;e>=0&&!isNaN(parseInt(o.charAt(e)));)e--;return e>0?parseInt(o.substring(e+1)):-1}function sb(o,e){switch(o){case 0:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 1:return[[16743226],[16750435],[16764339],[16094464],[16498012],[16704690],[15586304],[16115545],[16513201],[8694111],[11585939],[14413767],[6664599],[9553845],[12971486],[8358322],[10002885],[13292268],[10780600],[12623573],[14403561],[12418717],[14327229],[15517403],[14515069],[15764368],[16366271],[11250603],[13948116],[16777215],[14256481],[14656129],[15848130],[14005087],[14337152],[15918540],[15118118],[15531929],[9764857],[11258085]];case 2:return[[16579283],[15378351],[8830016],[15257125],[9340985],[8949607],[6198292],[8703620],[9889626],[8972045],[12161285],[13162269],[8620113],[12616503],[8628101],[13827840],[9764857]];case 3:return[[16777215],[15658734],[14540253]];case 4:return[[16777215],[16053490],[15464440],[16248792],[15396319],[15007487]];case 5:return[[16777215],[15658734],[14540253]];case 6:return[[16777215],[15658734],[14540253],[16767177],[16770205],[16751331]];case 7:return[[13421772],[11447982],[16751331],[10149119],[16763290],[16743786]];default:{const n=[];for(const r of e){const s=$().getPetColorResult(o,r.paletteId);s&&(s.primaryColor===s.secondaryColor?n.push([s.primaryColor]):n.push([s.primaryColor,s.secondaryColor]))}return n}}}class de{}de.WALL="i";de.FLOOR="s";de.EFFECT="e";de.HABBO_CLUB="h";de.BADGE="b";de.GAME_TOKEN="GAME_TOKEN";de.PET="p";de.ROBOT="r";const hd=class fd{constructor(e,n,r,s,a,c,u=!1,d=0,h=0){this._productType=e.toLowerCase(),this._productClassId=n,this._extraParam=r,this._productCount=s,this._productData=a,this._furnitureData=c,this._isUniqueLimitedItem=u,this._uniqueLimitedItemSeriesSize=d,this._uniqueLimitedItemsLeft=h}static stripAddonProducts(e){return e.length===1?e:e.filter(n=>n.productType!==de.BADGE&&n.productType!==de.EFFECT&&n.productClassId!==fd.EFFECT_CLASSID_NINJA_DISAPPEAR)}getIconUrl(e=null,n=null){switch(this._productType){case de.FLOOR:return $().getFurnitureFloorIconUrl(this.productClassId);case de.WALL:{if(e&&this._furnitureData){let r="";switch(this._furnitureData.className){case"floor":r=["th",this._furnitureData.className,e.product.extraParam].join("_");break;case"wallpaper":r=["th","wall",e.product.extraParam].join("_");break;case"landscape":r=["th",this._furnitureData.className,(e.product.extraParam||"").replace(".","_"),"001"].join("_");break}if(r!=="")return`${K("catalog.asset.url")}/${r}.png`}return $().getFurnitureWallIconUrl(this.productClassId,this._extraParam)}case de.EFFECT:return tb(this.productClassId);case de.HABBO_CLUB:return nb(this.productClassId);case de.BADGE:return q().getBadgeUrl(this._extraParam);case de.ROBOT:return null}return null}get productType(){return this._productType}get productClassId(){return this._productClassId}get extraParam(){return this._extraParam}set extraParam(e){this._extraParam=e}get productCount(){return this._productCount}get productData(){return this._productData}get furnitureData(){return this._furnitureData}get isUniqueLimitedItem(){return this._isUniqueLimitedItem}get uniqueLimitedItemSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}set uniqueLimitedItemsLeft(e){this._uniqueLimitedItemsLeft=e}};hd.EFFECT_CLASSID_NINJA_DISAPPEAR=108;let gs=hd;const or=class Jn{constructor(e,n,r,s,a,c,u,d,h,g){this._clubLevel=0,this._bundlePurchaseAllowed=!1,this._offerId=e,this._localizationId=n,this._isRentOffer=r,this._priceInCredits=s,this._priceInActivityPoints=a,this._activityPointType=c,this._giftable=u,this._clubLevel=d,this._products=h,this._bundlePurchaseAllowed=g,this.setPricingModelForProducts(),this.setPricingType();for(const f of h)if(f.productType===de.BADGE){this._badgeCode=f.extraParam;break}}activate(){}get clubLevel(){return this._clubLevel}get page(){return this._page}set page(e){this._page=e}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get giftable(){return this._giftable}get product(){if(!this._products||!this._products.length)return null;if(this._products.length===1)return this._products[0];const e=gs.stripAddonProducts(this._products);return e.length?e[0]:null}get pricingModel(){return this._pricingModel}get priceType(){return this._priceType}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isRentOffer(){return this._isRentOffer}get badgeCode(){return this._badgeCode}get localizationName(){const e=hs(this._localizationId);return e?e.name:m(this._localizationId)}get localizationDescription(){const e=hs(this._localizationId);return e?e.description:m(this._localizationId)}get isLazy(){return!1}get products(){return this._products}setPricingModelForProducts(){const e=gs.stripAddonProducts(this._products);e.length===1?e[0].productCount===1?this._pricingModel=Jn.PRICING_MODEL_SINGLE:this._pricingModel=Jn.PRICING_MODEL_MULTI:e.length>1?this._pricingModel=Jn.PRICING_MODEL_BUNDLE:this._pricingModel=Jn.PRICING_MODEL_UNKNOWN}setPricingType(){this._priceInCredits>0&&this._priceInActivityPoints>0?this._priceType=Jn.PRICE_TYPE_CREDITS_ACTIVITYPOINTS:this._priceInCredits>0?this._priceType=Jn.PRICE_TYPE_CREDITS:this._priceInActivityPoints>0?this._priceType=Jn.PRICE_TYPE_ACTIVITYPOINTS:this._priceType=Jn.PRICE_TYPE_NONE}clone(){const e=[],n=hs(this.localizationId);for(const s of this._products){const a=vi(s.productClassId,s.productType);e.push(new gs(s.productType,s.productClassId,s.extraParam,s.productCount,n,a))}const r=new Jn(this.offerId,this.localizationId,this.isRentOffer,this.priceInCredits,this.priceInActivityPoints,this.activityPointType,this.giftable,this.clubLevel,e,this.bundlePurchaseAllowed);return r.page=this.page,r}};or.PRICING_MODEL_UNKNOWN="pricing_model_unknown";or.PRICING_MODEL_SINGLE="pricing_model_single";or.PRICING_MODEL_MULTI="pricing_model_multi";or.PRICING_MODEL_BUNDLE="pricing_model_bundle";or.PRICING_MODEL_FURNITURE="pricing_model_furniture";or.PRICE_TYPE_NONE="price_type_none";or.PRICE_TYPE_CREDITS="price_type_credits";or.PRICE_TYPE_ACTIVITYPOINTS="price_type_activitypoints";or.PRICE_TYPE_CREDITS_ACTIVITYPOINTS="price_type_credits_and_activitypoints";let zt=or;class ab{constructor(e){this._furniData=e,this._product=new gs(this._furniData.type,this._furniData.id,this._furniData.customParams,1,hs(this._furniData.className),this._furniData)}activate(){A(new Ng(this._furniData.rentOfferId>-1?this._furniData.rentOfferId:this._furniData.purchaseOfferId))}get offerId(){return this.isRentOffer?this._furniData.rentOfferId:this._furniData.purchaseOfferId}get priceInActivityPoints(){return 0}get activityPointType(){return 0}get priceInCredits(){return 0}get page(){return this._page}set page(e){this._page=e}get priceType(){return""}get product(){return this._product}get products(){return[this._product]}get localizationId(){return"roomItem.name."+this._furniData.id}get bundlePurchaseAllowed(){return!1}get isRentOffer(){return this._furniData.rentOfferId>-1}get giftable(){return!1}get pricingModel(){return zt.PRICING_MODEL_FURNITURE}get clubLevel(){return 0}get badgeCode(){return""}get localizationName(){return this._furniData.name}get localizationDescription(){return this._furniData.description}get isLazy(){return!0}}const ob=(o,e,n=null)=>{let r=null;switch(o.toLocaleLowerCase()){case de.FLOOR:r=$().getFurnitureFloorIconUrl(e);break;case de.WALL:r=$().getFurnitureWallIconUrl(e,n);break}return r};class ib{constructor(e){this._isEnabled=!1,this._price=null,this._stuffTypes=null,this._boxTypes=null,this._ribbonTypes=null,this._defaultStuffTypes=null,this._isEnabled=e.isEnabled,this._price=e.price,this._boxTypes=e.boxTypes,this._ribbonTypes=e.ribbonTypes,this._stuffTypes=e.giftWrappers,this._defaultStuffTypes=e.giftFurnis}get isEnabled(){return this._isEnabled}get price(){return this._price}get stuffTypes(){return this._stuffTypes}get boxTypes(){return this._boxTypes}get ribbonTypes(){return this._ribbonTypes}get defaultStuffTypes(){return this._defaultStuffTypes}}class na{constructor(e,n,r,s,a,c,u,d,h=-1){this._timeLeftMinutes=-1,this._offerId=e,this._furniId=n,this._furniType=r,this._extraData=s,this._stuffData=a,this._price=c,this._status=u,this._averagePrice=d,this._offerCount=h}get offerId(){return this._offerId}set offerId(e){this._offerId=e}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}set price(e){this._price=e}get averagePrice(){return this._averagePrice}get image(){return this._image}set image(e){this._image=e}get imageCallback(){return this._imageCallback}set imageCallback(e){this._imageCallback=e}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}set timeLeftMinutes(e){this._timeLeftMinutes=e}get offerCount(){return this._offerCount}set offerCount(e){this._offerCount=e}get isUniqueLimitedItem(){return this.stuffData&&this.stuffData.uniqueSeries>0}}na.TYPE_FLOOR=1;na.TYPE_WALL=2;class $r{}$r.ONGOING=1;$r.ONGOING_OWN=1;$r.SOLD=2;$r.EXPIRED=3;class Lt{}Lt.BY_ACTIVITY=1;Lt.BY_VALUE=2;Lt.ADVANCED=3;class pd{constructor(e,n){this._images=e,this._texts=n}getText(e){let n=this._texts[e]||"";return n&&n.length&&(n=n.replace(/\r\n|\r|\n/g,"<br />")),n}getImage(e){const n=this._images[e]||"";if(!n||!n.length)return null;let r=K("catalog.asset.image.url");return r=r.replace("%name%",n),r}}class lb{constructor(e,n,r,s,a,c,u,d){this.roomId=e,this.objectId=n,this.category=r,this.wallLocation=s,this.x=a,this.y=c,this.direction=u,this.offer=d}get offerId(){return this.offer.offerId}get productClassId(){return this.offer.product.productClassId}get productData(){return this.offer.product.productData}get furniData(){return this.offer.product.furnitureData}get extraParam(){return this.offer.product.extraParam}}const ra=class ls{constructor(){this._requestType=ls.REQUEST_TYPE_NONE}resetRequest(){this._requestType=ls.REQUEST_TYPE_NONE,this._requestById=-1,this._requestedByOfferId=-1,this._requestByName=null}get requestType(){return this._requestType}get requestById(){return this._requestById}set requestById(e){this._requestType=ls.REQUEST_TYPE_ID,this._requestById=e}get requestedByOfferId(){return this._requestedByOfferId}set requestedByOfferId(e){this._requestType=ls.REQUEST_TYPE_OFFER,this._requestedByOfferId=e}get requestByName(){return this._requestByName}set requestByName(e){this._requestType=ls.REQUEST_TYPE_NAME,this._requestByName=e}};ra.REQUEST_TYPE_NONE=0;ra.REQUEST_TYPE_ID=1;ra.REQUEST_TYPE_OFFER=2;ra.REQUEST_TYPE_NAME=3;let Ds=ra;class cb{constructor(e,n,r){this.searchValue=e,this.offers=n,this.filteredNodes=r}}function vi(o,e){let n=null;switch(e.toLowerCase()){case de.FLOOR:n=q().getFloorItemData(o);break;case de.WALL:n=q().getWallItemData(o);break}return n}function uo(o,e,n){const r=$().getRoomObject(o,e,n);if(!r)return;const s=r.model.getValue(ae.FURNITURE_TYPE_ID);switch(n){case Q.FLOOR:return q().getFloorItemData(s);case Q.WALL:return q().getWallItemData(s)}return null}function ub(){const o=Jr();return o?o.model.getValue(ae.FIGURE_POSTURE):ms.POSTURE_STAND}function hs(o){return o?q().getProductData(o):null}function Oe(){return Qr().getSession(-1)}function wi(){A(new Tg)}function zr(){return q().clubLevel>=dn.CLUB}function wa(){return q().clubLevel>=dn.VIP}function db(o){const e=$().getRoomObject(Oe().roomId,o,Q.FLOOR);if(!e||!e.model)return!1;const n=q().userId,r=e.model.getValue(ae.FURNITURE_OWNER_ID);return n===r}function mb(){const o=Jr();return o?o.model.getValue(ae.FIGURE_EFFECT)===77:!1}function gb(o){Qr().startSession(o)}const Qi=()=>{Oe()&&(wi(),Qr().removeSession(-1))};function Jr(){const o=q().userId,e=$().activeRoomId,n=Q.UNIT,r=$().getTotalObjectsForManager(e,n);let s=0;for(;s<r;){const a=$().getRoomObjectByIndex(e,s,n);if(a){const c=Oe().userDataManager.getUserDataByIndex(a.id);if(c&&c.webID===o)return a}s++}return null}const Ji=(o,e,n,r=1)=>{const s=$().getRoomObjectBoundingRectangle(o,e,n,r);return s?(s.x=Math.round(s.x),s.y=Math.round(s.y),s):null},Id=(o,e,n,r=1)=>{const s=$().getRoomObjectScreenLocation(o,e,n,r);return s?(s.x=Math.round(s.x),s.y=Math.round(s.y),s):null},hb=(o,e,n=1)=>{const r=$(),s=r.activeRoomId;r.initializeRoomInstanceRenderingCanvas(s,n,o,e)};function fb(o){let e=!1;const n=$().getRoomObject(o.roomId,o.objectId,o.category);return n&&n.model.getValue(ae.FURNITURE_SELECTION_DISABLED)===1&&(e=!0,q().isModerator&&(e=!1)),e}function us(o,e,n){$().processRoomObjectOperation(o,e,n)}function $l(o){$().setActiveRoomId(o)}const A=o=>Ti().send(o);class un{static getAchievementBadgeCode(e){if(!e)return null;let n=e.badgeId;return e.finalLevel||(n=cd().getPreviousLevelBadgeId(n)),n}static getAchievementCategoryImageUrl(e,n=null,r=!1){const s=K("achievements.images.url");let a=r?"achicon_":"achcategory_";return a+=e.code,n!==null&&(a+=`_${n>0?"active":"inactive"}`),s.replace("%image%",a)}static getAchievementCategoryMaxProgress(e){if(!e)return 0;let n=0;for(const r of e.achievements)n+=r.levelCount;return n}static getAchievementCategoryProgress(e){if(!e)return 0;let n=0;for(const r of e.achievements)n+=r.finalLevel?r.level:r.level-1;return n}static getAchievementCategoryTotalUnseen(e){if(!e)return 0;let n=0;for(const r of e.achievements)r.unseen>0&&n++;return n}static getAchievementHasStarted(e){return e?!!(e.finalLevel||e.level-1>0):!1}static getAchievementIsIgnored(e){if(!e)return!1;const n=K("achievements.unseen.ignored"),r=e.badgeId.replace(/[0-9]/g,"");return n.indexOf(r)>=0}static getAchievementLevel(e){return e?e.finalLevel?e.level:e.level-1:0}}class Kl{constructor(e){this._code=e,this._achievements=[]}getProgress(){return un.getAchievementCategoryProgress(this)}getMaxProgress(){return un.getAchievementCategoryMaxProgress(this)}get code(){return this._code}get achievements(){return this._achievements}set achievements(e){this._achievements=e}}class On{}On.ACTION_SAVE="AEA_ACTION_SAVE";On.ACTION_CLEAR="AEA_ACTION_CLEAR";On.ACTION_RESET="AEA_ACTION_RESET";On.ACTION_RANDOMIZE="AEA_ACTION_RANDOMIZE";class pb{constructor(e,n=!1){this._partColor=e,this._isDisabled=n,this._isHC=this._partColor.clubLevel>0,this._isSelected=!1}dispose(){this._partColor=null}get partColor(){return this._partColor}get color(){return cn.int2rgb(this._partColor.rgb)}get isDisabled(){return this._isDisabled}get isHC(){return this._isHC}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}}class Zi{constructor(e,n,r){this._selectedPartIndex=-1,this._name=e,this._parts=n,this._palettes=r,this._selectedPartIndex=-1}static defaultColorId(e,n){if(!e||!e.length)return-1;let r=0;for(;r<e.length;){const s=e[r];if(s.partColor&&s.partColor.clubLevel<=n)return s.partColor.id;r++}return-1}init(){for(const e of this._parts)e&&e.init()}dispose(){if(this._parts){for(const e of this._parts)e.dispose();this._parts=null}if(this._palettes){for(const e of this._palettes)for(const n of e)n.dispose();this._palettes=null}this._selectedPartIndex=-1,this._paletteIndexes=null}selectPartId(e){if(!this._parts)return;let n=0;for(;n<this._parts.length;){if(this._parts[n].id===e){this.selectPartIndex(n);return}n++}}selectColorIds(e){if(!e||!this._palettes)return;this._paletteIndexes=new Array(e.length);let n=0;for(;n<this._palettes.length;){const r=this.getPalette(n);if(r){let s=0;if(e.length>n)s=e[n];else{const c=r[0];c&&c.partColor&&(s=c.partColor.id)}let a=0;for(;a<r.length;){const c=r[a];c.partColor.id===s?(this._paletteIndexes[n]=a,c.isSelected=!0):c.isSelected=!1,a++}}n++}this.updatePartColors()}selectPartIndex(e){if(!this._parts)return null;if(this._selectedPartIndex>=0&&this._parts.length>this._selectedPartIndex){const n=this._parts[this._selectedPartIndex];n&&(n.isSelected=!1)}if(this._parts.length>e){const n=this._parts[e];if(n)return n.isSelected=!0,this._selectedPartIndex=e,n}return null}selectColorIndex(e,n){const r=this.getPalette(n);if(!r||r.length<=e)return null;this.deselectColorIndex(this._paletteIndexes[n],n),this._paletteIndexes[n]=e;const s=r[e];return s?(s.isSelected=!0,this.updatePartColors(),s):null}getCurrentColorIndex(e){return this._paletteIndexes[e]}deselectColorIndex(e,n){const r=this.getPalette(n);if(!r||r.length<=e)return;const s=r[e];s&&(s.isSelected=!1)}getSelectedColorIds(){if(!this._paletteIndexes||!this._paletteIndexes.length||!this._palettes||!this._palettes.length)return null;const e=this._palettes[0];if(!e||!e.length)return null;const n=e[0];if(!n||!n.partColor)return null;const r=n.partColor.id,s=[];let a=0;for(;a<this._paletteIndexes.length;){const u=this._palettes[a];if(!(!u||u.length<=a))if(u.length>this._paletteIndexes[a]){const d=u[this._paletteIndexes[a]];d&&d.partColor?s.push(d.partColor.id):s.push(r)}else s.push(r);a++}const c=this.getCurrentPart();return c?s.slice(0,Math.max(c.maxColorIndex,1)):null}getSelectedColors(){const e=[];let n=0;for(;n<this._paletteIndexes.length;){const r=this.getSelectedColor(n);r?e.push(r.partColor):e.push(null),n++}return e}getSelectedColor(e){const n=this.getPalette(e);return!n||n.length<=this._paletteIndexes[e]?null:n[this._paletteIndexes[e]]}getSelectedColorId(e){const n=this.getSelectedColor(e);return n&&n.partColor?n.partColor.id:0}getPalette(e){return!this._paletteIndexes||!this._palettes||this._palettes.length<=e?null:this._palettes[e]}getCurrentPart(){return this._parts[this._selectedPartIndex]}updatePartColors(){const e=this.getSelectedColors();for(const n of this._parts)n&&(n.partColors=e)}hasClubSelectionsOverLevel(e){let n=!1;const r=this.getSelectedColors();if(r){let a=0;for(;a<r.length;){const c=r[a];c&&c.clubLevel>e&&(n=!0),a++}}const s=this.getCurrentPart();if(s&&s.partSet){const a=s.partSet;a&&a.clubLevel>e&&(n=!0)}return n}hasInvalidSelectedItems(e){const n=this.getCurrentPart();if(!n)return!1;const r=n.partSet;if(!(!r||!r.isSellable))return e.indexOf(r.id)>-1}stripClubItemsOverLevel(e){const n=this.getCurrentPart();if(n&&n.partSet&&n.partSet.clubLevel>e){const s=this.selectPartIndex(0);return s&&!s.partSet&&this.selectPartIndex(1),!0}return!1}stripClubColorsOverLevel(e){const n=[],r=this.getSelectedColors(),s=this.getPalette(0);let a=!1;const c=Zi.defaultColorId(s,e);if(c===-1)return!1;let u=0;for(;u<r.length;){const d=r[u];d?d.clubLevel>e?(n.push(c),a=!0):n.push(d.id):(n.push(c),a=!0),u++}return a&&this.selectColorIds(n),a}get name(){return this._name}get parts(){return this._parts}get selectedPartIndex(){return this._selectedPartIndex}}class ft{static getGender(e){switch(e){case ye.MALE:case"m":case"M":e=ye.MALE;break;case ye.FEMALE:case"f":case"F":e=ye.FEMALE;break;default:e=ye.MALE}return e}static hasFigureSetId(e){return this.FIGURE_SET_IDS.indexOf(e)>=0}static createCategory(e,n){if(!e||!n||!this.CURRENT_FIGURE)return null;const r=[],s=[];let a=0;for(;a<this.MAX_PALETTES;)s.push([]),a++;const c=zl(n);if(!c)return null;const u=ql(c.paletteID);if(!u)return null;let d=this.CURRENT_FIGURE.getColorIds(n);d||(d=[]);const h=new Array(d.length),g=this.clubItemsDimmed,f=Cn();for(const b of u.colors.getValues())if(b.isSelectable&&(g||f>=b.clubLevel)){let N=0;for(;N<this.MAX_PALETTES;){const v=f<b.clubLevel,O=new pb(b,v);s[N].push(O),N++}if(n!==ye.FACE){let v=0;for(;v<d.length;)b.id===d[v]&&(h[v]=b),v++}}let p=[];if(g?p=Nt().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,2):p=Nt().getMandatoryAvatarPartSetIds(this.CURRENT_FIGURE.gender,f),p.indexOf(n)===-1){const b=new Xl(null,null,!1);b.isClear=!0,r.push(b)}const E=n!==ye.FACE,_=c.partSets;for(a=_.length-1;a>=0;){const b=_.getWithIndex(a);let N=!1;if((b.gender===ye.UNISEX||b.gender===this.CURRENT_FIGURE.gender)&&(N=!0),b.isSelectable&&N&&(g||f>=b.clubLevel)){const v=f<b.clubLevel;let O=!0;b.isSellable&&(O=this.hasFigureSetId(b.id)),O&&r.push(new Xl(b,h,E,v))}a--}for(r.sort(this.clubItemsFirst?this.clubSorter:this.noobSorter),a=0;a<this.MAX_PALETTES;)s[a].sort(this.colorSorter),a++;return new Zi(n,r,s)}static clubSorter(e,n){const r=e.partSet?e.partSet.clubLevel:9999999999,s=n.partSet?n.partSet.clubLevel:9999999999,a=e.partSet?e.partSet.isSellable:!1,c=n.partSet?n.partSet.isSellable:!1;return a&&!c?1:c&&!a||r>s?-1:r<s?1:e.partSet.id>n.partSet.id?-1:e.partSet.id<n.partSet.id?1:0}static colorSorter(e,n){const r=e.partColor?e.partColor.clubLevel:-1,s=n.partColor?n.partColor.clubLevel:-1;return r<s?-1:r>s?1:e.partColor.index<n.partColor.index?-1:e.partColor.index>n.partColor.index?1:0}static noobSorter(e,n){const r=e.partSet?e.partSet.clubLevel:-1,s=n.partSet?n.partSet.clubLevel:-1,a=e.partSet?e.partSet.isSellable:!1,c=n.partSet?n.partSet.isSellable:!1;return a&&!c?1:c&&!a||r<s?-1:r>s?1:e.partSet.id<n.partSet.id?-1:e.partSet.id>n.partSet.id?1:0}static avatarSetFirstSelectableColor(e){const n=zl(e);if(!n)return-1;const r=ql(n.paletteID);if(!r)return-1;for(const s of r.colors.getValues())if(!(!s.isSelectable||Cn()<s.clubLevel))return s.id;return-1}static get clubItemsFirst(){return K("avatareditor.show.clubitems.first",!0)}static get clubItemsDimmed(){return K("avatareditor.show.clubitems.dimmed",!0)}}ft.MAX_PALETTES=2;ft.CURRENT_FIGURE=null;ft.FIGURE_SET_IDS=[];ft.BOUND_FURNITURE_NAMES=[];const Fe=class Ke{constructor(){this._gender="M",this._direction=Ke.DEFAULT_DIRECTION,this._avatarEffectType=-1,this._notifier=null}loadAvatarData(e,n){this._data=new Map,this._colors=new Map,this._gender=n,this.parseFigureString(e),this.updateView()}parseFigureString(e){if(!e)return;const n=e.split(".");if(!(!n||!n.length))for(const r of n){const s=r.split("-");if(!s.length)continue;const a=s[0],c=parseInt(s[1]),u=[];let d=2;for(;d<s.length;)u.push(parseInt(s[d])),d++;u.length||u.push(0),this.savePartSetId(a,c,!1),this.savePartSetColourId(a,u,!1)}}getPartSetId(e){const n=this._data.get(e);return n!==void 0?n:-1}getColorIds(e){const n=this._colors.get(e);return n!==void 0?n:[ft.avatarSetFirstSelectableColor(e)]}getFigureString(){let e="";const n=[];for(const[s,a]of this._data.entries()){const c=this._colors.get(s);let u=s+"-"+a;if(c&&c.length){let d=0;for(;d<c.length;)u=u+("-"+c[d]),d++}n.push(u)}let r=0;for(;r<n.length;)e=e+n[r],r<n.length-1&&(e=e+"."),r++;return e}savePartData(e,n,r,s=!1){this.savePartSetId(e,n,s),this.savePartSetColourId(e,r,s)}savePartSetId(e,n,r=!0){switch(e){case Ke.FACE:case Ke.HAIR:case Ke.HAT:case Ke.HEAD_ACCESSORIES:case Ke.EYE_ACCESSORIES:case Ke.FACE_ACCESSORIES:case Ke.SHIRT:case Ke.JACKET:case Ke.CHEST_ACCESSORIES:case Ke.CHEST_PRINTS:case Ke.TROUSERS:case Ke.SHOES:case Ke.TROUSER_ACCESSORIES:n>=0?this._data.set(e,n):this._data.delete(e);break}r&&this.updateView()}savePartSetColourId(e,n,r=!0){switch(e){case Ke.FACE:case Ke.HAIR:case Ke.HAT:case Ke.HEAD_ACCESSORIES:case Ke.EYE_ACCESSORIES:case Ke.FACE_ACCESSORIES:case Ke.SHIRT:case Ke.JACKET:case Ke.CHEST_ACCESSORIES:case Ke.CHEST_PRINTS:case Ke.TROUSERS:case Ke.SHOES:case Ke.TROUSER_ACCESSORIES:this._colors.set(e,n);break}r&&this.updateView()}getFigureStringWithFace(e,n=!0){let r="";const s=[Ke.FACE],a=[];for(const u of s){const d=this._colors.get(u);if(!d)continue;let h=this._data.get(u);u===Ke.FACE&&n&&(h=e);let g=u+"-"+h;if(h>=0){let f=0;for(;f<d.length;)g=g+("-"+d[f]),f++}a.push(g)}let c=0;for(;c<a.length;)r=r+a[c],c<a.length-1&&(r=r+"."),c++;return r}updateView(){this.notify&&this.notify()}get gender(){return this._gender}get direction(){return this._direction}set direction(e){this._direction=e,this.updateView()}set avatarEffectType(e){this._avatarEffectType=e}get avatarEffectType(){return this._avatarEffectType}get notify(){return this._notifier}set notify(e){this._notifier=e}};Fe.DEFAULT_DIRECTION=4;Fe.MALE="M";Fe.FEMALE="F";Fe.UNISEX="U";Fe.SCALE="h";Fe.STD="std";Fe.DEFAULT_FRAME="0";Fe.FACE="hd";Fe.HAIR="hr";Fe.HAT="ha";Fe.HEAD_ACCESSORIES="he";Fe.EYE_ACCESSORIES="ea";Fe.FACE_ACCESSORIES="fa";Fe.JACKET="cc";Fe.SHIRT="ch";Fe.CHEST_ACCESSORIES="ca";Fe.CHEST_PRINTS="cp";Fe.TROUSERS="lg";Fe.SHOES="sh";Fe.TROUSER_ACCESSORIES="wa";Fe.SET_TYPES=[Fe.FACE,Fe.HAIR,Fe.HAT,Fe.HEAD_ACCESSORIES,Fe.EYE_ACCESSORIES,Fe.FACE_ACCESSORIES,Fe.JACKET,Fe.SHIRT,Fe.CHEST_ACCESSORIES,Fe.CHEST_PRINTS,Fe.TROUSERS,Fe.SHOES,Fe.TROUSERS];let ye=Fe;const mo=class cs{constructor(e,n,r=!0,s=!1){if(this._renderManager=Nt(),this._partSet=e,this._partColors=n,this._useColors=r,this._isDisabled=s,this._thumbContainer=null,this._imageUrl=null,this._maxColorIndex=0,this._isValidFigure=!1,this._isHC=!1,this._isSellable=!1,this._isClear=!1,this._isSelected=!1,this._disposed=!1,this._isInitalized=!1,e){const a=e.parts;for(const c of a)this._maxColorIndex=Math.max(this._maxColorIndex,c.colorLayerIndex)}}init(){this._isInitalized||(this._isInitalized=!0,this.update())}dispose(){this._disposed||(this._renderManager=null,this._partSet=null,this._partColors=null,this._imageUrl=null,this._disposed=!0,this._isInitalized=!1,this._thumbContainer&&(this._thumbContainer.destroy(),this._thumbContainer=null))}update(){this.updateThumbVisualization()}analyzeFigure(){if(!this._renderManager||!this._partSet||!this._partSet.parts||!this._partSet.parts.length)return!1;const e=this._renderManager.createFigureContainer(this.partSet.type+"-"+this.partSet.id);return this._renderManager.isFigureContainerReady(e)?(this._isValidFigure=!0,!0):(this._renderManager.downloadAvatarFigure(e,this),!1)}renderThumb(){if(!this._renderManager||!this._partSet||!this._isValidFigure&&!this.analyzeFigure())return null;const e=this._partSet.parts.concat().sort(this.sortByDrawOrder),n=new wg;for(const r of e){if(!r)continue;let s=null,a=0,c=!1;for(;!c&&a<cs.THUMB_DIRECTIONS.length;){const f=ye.SCALE+"_"+ye.STD+"_"+r.type+"_"+r.id+"_"+cs.THUMB_DIRECTIONS[a]+"_"+ye.DEFAULT_FRAME;s=this._renderManager.getAssetByName(f),s&&s.texture?c=!0:a++}if(!c)continue;const u=s.offsetX,d=s.offsetY;let h=null;if(this._useColors&&r.colorLayerIndex>0){const f=this._partColors[r.colorLayerIndex-1];f&&(h=f)}const g=new za(s.texture);g.position.set(u,d),h&&(g.tint=h.rgb),n.addChild(g)}return n}updateThumbVisualization(){if(!this._isInitalized)return;let e=this._thumbContainer;e||(e=this.renderThumb()),e&&(this._partSet?(this._isHC=this._partSet.clubLevel>0,this._isSellable=this._partSet.isSellable):(this._isHC=!1,this._isSellable=!1),this._isDisabled&&this.setAlpha(e,.2),this._imageUrl=rr.generateImageUrl(e),this.notify&&this.notify())}setAlpha(e,n){return e.filters=[cs.ALPHA_FILTER],e}sortByDrawOrder(e,n){const r=cs.DRAW_ORDER.indexOf(e.type),s=cs.DRAW_ORDER.indexOf(n.type);return r<s?-1:r>s?1:e.index<n.index?-1:e.index>n.index?1:0}resetFigure(e){this.analyzeFigure()&&this.update()}get disposed(){return this._disposed}get id(){return this._partSet?this._partSet.id:-1}get partSet(){return this._partSet}set partColors(e){this._partColors=e,this.update()}get isDisabled(){return this._isDisabled}set thumbContainer(e){this._thumbContainer=e,this.update()}get imageUrl(){return this._imageUrl}get maxColorIndex(){return this._maxColorIndex}get isHC(){return this._isHC}get isSellable(){return this._isSellable}get isClear(){return this._isClear}set isClear(e){this._isClear=e}get isSelected(){return this._isSelected}set isSelected(e){this._isSelected=e,this.notify&&this.notify()}get notify(){return this._notifier}set notify(e){this._notifier=e}};mo.ALPHA_FILTER=new vg(.2);mo.THUMB_DIRECTIONS=[2,6,0,4,3,1];mo.DRAW_ORDER=[We.LEFT_HAND_ITEM,We.LEFT_HAND,We.LEFT_SLEEVE,We.LEFT_COAT_SLEEVE,We.BODY,We.SHOES,We.LEGS,We.CHEST,We.CHEST_ACCESSORY,We.COAT_CHEST,We.CHEST_PRINT,We.WAIST_ACCESSORY,We.RIGHT_HAND,We.RIGHT_SLEEVE,We.RIGHT_COAT_SLEEVE,We.HEAD,We.FACE,We.EYES,We.HAIR,We.HAIR_BIG,We.FACE_ACCESSORY,We.EYE_ACCESSORY,We.HEAD_ACCESSORY,We.HEAD_ACCESSORY_EXTRA,We.RIGHT_HAND_ITEM];let Xl=mo;class go{constructor(){this._isInitalized=!1,this._maxPaletteCount=0}dispose(){this._categories=null,this._disposed=!0}get disposed(){return this._disposed}init(){this._categories||(this._categories=new Map)}reset(){if(this._isInitalized=!1,this._categories)for(const e of this._categories.values())e&&e.dispose();this._categories=new Map}addCategory(e){let n=this._categories.get(e);n||(n=ft.createCategory(this,e),n&&(this._categories.set(e,n),this.updateSelectionsFromFigure(e)))}updateSelectionsFromFigure(e){const n=this._categories.get(e);if(!n)return;const r=ft.CURRENT_FIGURE.getPartSetId(e);let s=ft.CURRENT_FIGURE.getColorIds(e);s||(s=[]),n.selectPartId(r),n.selectColorIds(s)}hasClubSelectionsOverLevel(e){if(!this._categories)return!1;for(const n of this._categories.values())if(n&&n.hasClubSelectionsOverLevel(e))return!0;return!1}hasInvalidSelectedItems(e){if(!this._categories)return!1;for(const n of this._categories.values())if(n.hasInvalidSelectedItems(e))return!0;return!1}stripClubItemsOverLevel(e){if(!this._categories)return!1;let n=!1;for(const[r,s]of this._categories.entries()){let a=!1;if(s.stripClubItemsOverLevel(e)&&(a=!0),s.stripClubColorsOverLevel(e)&&(a=!0),a){const c=s.getCurrentPart();c&&ft.CURRENT_FIGURE&&ft.CURRENT_FIGURE.savePartData(r,c.id,s.getSelectedColorIds(),!0),n=!0}}return n}stripInvalidSellableItems(){if(!this._categories)return!1;let e=!1;for(const[n,r]of this._categories.entries());return e}selectPart(e,n){const r=this._categories.get(e);if(!r)return;const s=r.selectedPartIndex;r.selectPartIndex(n);const a=r.getCurrentPart();if(a){if(a.isDisabled){r.selectPartIndex(s);return}this._maxPaletteCount=a.maxColorIndex,ft.CURRENT_FIGURE.savePartData(e,a.id,r.getSelectedColorIds(),!0)}}selectColor(e,n,r){const s=this._categories.get(e);if(!s)return;const a=s.getCurrentColorIndex(r);if(s.selectColorIndex(n,r),s.getSelectedColor(r).isDisabled){s.selectColorIndex(a,r);return}ft.CURRENT_FIGURE.savePartSetColourId(e,s.getSelectedColorIds(),!0)}getCategoryData(e){return this._isInitalized||this.init(),this._categories?this._categories.get(e):null}get categories(){return this._categories}get canSetGender(){return!1}get maxPaletteCount(){return this._maxPaletteCount||1}set maxPaletteCount(e){this._maxPaletteCount=e}get name(){return null}}class Ib extends go{constructor(){super(...arguments),this._imageCallBackHandled=!1}init(){super.init(),this.addCategory(ye.FACE),this._isInitalized=!0}selectColor(e,n,r){super.selectColor(e,n,r),this.updateSelectionsFromFigure(ye.FACE)}updateSelectionsFromFigure(e){if(!this._categories||!ft.CURRENT_FIGURE)return;const n=this._categories.get(e);if(!n)return;const r=ft.CURRENT_FIGURE.getPartSetId(e);let s=ft.CURRENT_FIGURE.getColorIds(e);s||(s=[]),n.selectPartId(r),n.selectColorIds(s);for(const a of n.parts){const c=u=>{const d=ft.CURRENT_FIGURE.getFigureStringWithFace(a.id),h=Nt().createAvatarImage(d,Yi.LARGE,null,{resetFigure:c,dispose:null,disposed:!1}),g=h.getImageAsSprite(Ya.HEAD);g&&(g.y=10,a.thumbContainer=g,setTimeout(()=>h.dispose(),0))};c()}}get canSetGender(){return!0}get name(){return Ir.GENERIC}}const Kt=o=>{if(o==null||typeof o!="object")return o;const e=new o.constructor;for(const n in o)o.hasOwnProperty(n)&&(e[n]=o[n]);return e};class en{static makeColorHex(e){return"#"+e}static makeColorNumberHex(e){return"#"+e.toString(16).padStart(6,"0")}static convertFromHex(e){return parseInt(e.replace("#",""),16)}static uintHexColor(e){const n=e>>>0;return en.makeColorHex(n.toString(16).substring(2))}static int_to_8BitVals(e){const n=e>>24&255,r=e>>16&255,s=e>>8&255,a=e&255;return[n,r,s,a]}static eight_bitVals_to_int(e,n,r,s){return(e<<24)+(n<<16)+(r<<8)+(s|0)}static int2rgb(e){e>>>=0;const n=e&255,r=(e&65280)>>>8;return"rgba("+[(e&16711680)>>>16,r,n,1].join(",")+")"}}const Fr=o=>{let e=Math.floor(o/86400),n=Math.floor(o%86400/3600),r=Math.floor(o%86400%3600/60),s=o%86400%3600%60;return e.toString().padStart(2,"0")+":"+n.toString().padStart(2,"0")+":"+r.toString().padStart(2,"0")+":"+s.toString().padStart(2,"0")},Xa=o=>{try{JSON.parse(window.localStorage.getItem(o))}catch{return null}},el=o=>{let e=_e().localization.getBadgeDesc(o);return(!e||!e.length)&&(e=`badge_desc_${o}`),e},sa=o=>{let e=_e().localization.getBadgeName(o);return(!e||!e.length)&&(e=`badge_name_${o}`),e};function Qa(o){return!o||isNaN(o)?"0":o.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")}function Eb(o){if(!o||isNaN(o))return"0";let e=Math.abs(o);const n=Math.pow(10,1),r=o<0;let s="";const a=[{key:"Q",value:Math.pow(10,15)},{key:"T",value:Math.pow(10,12)},{key:"B",value:Math.pow(10,9)},{key:"M",value:Math.pow(10,6)},{key:"K",value:1e3}];for(const c of a){let u=e/c.value;if(u=Math.round(u*n)/n,u>=1){e=u,s=c.key;break}}return(r?"-":"")+e+s}function m(o,e=null,n=null){return _e().getLocalizationWithParameters(o,e,n)}class aa{}aa.CATALOG_PLACE_MULTIPLE_OBJECTS="catalogPlaceMultipleObjects";aa.CATALOG_SKIP_PURCHASE_CONFIRMATION="catalogSkipPurchaseConfirmation";const Ed=(o,e)=>o.dispatchEvent(e),Ri=o=>Ed(_e().events,o),sr=new Rg,St=o=>Ed(sr,o);let Cd=!1;const ar=o=>{Cd&&Ri(new Tl(Tl.PLAY_SOUND,o))},Ql=[Re.MOUSE_CLICK],Cb=()=>{const o=()=>Ql.forEach(n=>window.removeEventListener(n,e)),e=n=>(Cd=!0)&&o();Ql.forEach(n=>window.addEventListener(n,e))};Cb();class Z{}Z.DEFAULT=1;Z.WALL_PAPER=2;Z.FLOOR=3;Z.LANDSCAPE=4;Z.POST_IT=5;Z.POSTER=6;Z.SOUND_SET=7;Z.TRAX_SONG=8;Z.PRESENT=9;Z.ECOTRON_BOX=10;Z.TROPHY=11;Z.CREDIT_FURNI=12;Z.PET_SHAMPOO=13;Z.PET_CUSTOM_PART=14;Z.PET_CUSTOM_PART_SHAMPOO=15;Z.PET_SADDLE=16;Z.GUILD_FURNI=17;Z.GAME_FURNI=18;Z.MONSTERPLANT_SEED=19;Z.MONSTERPLANT_REVIVAL=20;Z.MONSTERPLANT_REBREED=21;Z.MONSTERPLANT_FERTILIZE=22;Z.FIGURE_PURCHASABLE_SET=23;class $s{constructor(e){e&&(this._locked=!1,this._id=e.itemId,this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem)}get rentable(){return this._isRented}get id(){return this._id}get ref(){return this._ref}get category(){return this._category}get type(){return this._type}get stuffData(){return this._stuffData}set stuffData(e){this._stuffData=e}get extra(){return this._extra}get recyclable(){return this._recyclable}get isTradable(){return this._tradeable}get isGroupable(){return this._groupable}get sellable(){return this._sellable}get secondsToExpiration(){if(this._secondsToExpiration===-1)return-1;let e=-1;return this._hasRentPeriodStarted?(e=this._secondsToExpiration-(yn()-this._expirationTimeStamp)/1e3,e<0&&(e=0)):e=this._secondsToExpiration,e}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get slotId(){return this._slotId}get songId(){return this._songId}get locked(){return this._locked}set locked(e){this._locked=e}get flatId(){return this._flatId}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}update(e){this._type=e.spriteId,this._ref=e.ref,this._category=e.category,this._groupable=e.isGroupable&&!e.rentable,this._tradeable=e.tradable,this._recyclable=e.isRecycleable,this._sellable=e.sellable,this._stuffData=e.stuffData,this._extra=e.extra,this._secondsToExpiration=e.secondsToExpiration,this._expirationTimeStamp=e.expirationTimeStamp,this._hasRentPeriodStarted=e.hasRentPeriodStarted,this._creationDay=e.creationDay,this._creationMonth=e.creationMonth,this._creationYear=e.creationYear,this._slotId=e.slotId,this._songId=e.songId,this._flatId=e.flatId,this._isRented=e.rentable,this._isWallItem=e.isWallItem}clone(){const e=new $s(null);return e._expirationTimeStamp=this._expirationTimeStamp,e._isWallItem=this._isWallItem,e._songId=this._songId,e._locked=this._locked,e._id=this._id,e._ref=this._ref,e._category=this._category,e._type=this._type,e._stuffData=this._stuffData,e._extra=this._extra,e._recyclable=this._recyclable,e._tradeable=this._tradeable,e._groupable=this._groupable,e._sellable=this._sellable,e._secondsToExpiration=this._secondsToExpiration,e._hasRentPeriodStarted=this._hasRentPeriodStarted,e._creationDay=this._creationDay,e._creationMonth=this._creationMonth,e._creationYear=this._creationYear,e._slotId=this._slotId,e._isRented=this._isRented,e._flatId=this._flatId,e}}class tl{constructor(e=-1,n=-1,r=null,s=null,a=-1){this._type=e,this._category=n,this._roomEngine=r,this._stuffData=s,this._extra=a,this._isWallItem=!1,this._iconUrl=null,this._name=null,this._description=null,this._locked=!1,this._selected=!1,this._hasUnseenItems=!1,this._items=[]}clone(){const e=new tl;return e._type=this._type,e._category=this._category,e._roomEngine=this._roomEngine,e._stuffData=this._stuffData,e._extra=this._extra,e._isWallItem=this._isWallItem,e._iconUrl=this._iconUrl,e._name=this._name,e._description=this._description,e._locked=this._locked,e._selected=this._selected,e._hasUnseenItems=this._hasUnseenItems,e._items=this._items,e}prepareGroup(){this.setIcon(),this.setName(),this.setDescription()}dispose(){}getItemByIndex(e){return this._items[e]}getItemById(e){for(const n of this._items)if(n.id===e)return n;return null}getTradeItems(e){const n=[],r=this.getLastItem();if(!r)return n;let s=0,a=0;for(;a<this._items.length&&!(s>=e);){const c=this.getItemByIndex(a);!c.locked&&c.isTradable&&c.type===r.type&&(n.push(c),s++),a++}return n}push(e){const n=[...this._items];let r=0;for(;r<n.length;){let s=n[r];if(s.id===e.id){s=s.clone(),s.locked=!1,n.splice(r,1),n.push(s),this._items=n;return}r++}n.push(e),this._items=n,this._items.length===1&&this.prepareGroup()}pop(){const e=[...this._items];let n=null;if(e.length>0){const r=e.length-1;n=e[r],e.splice(r,1)}return this._items=e,n}remove(e){const n=[...this._items];let r=0;for(;r<n.length;){let s=n[r];if(s.id===e)return n.splice(r,1),this._items=n,s;r++}return null}getTotalCount(){if(this._category===Z.POST_IT){let e=0,n=0;for(;n<this._items.length;){const r=this.getItemByIndex(n);e=e+parseInt(r.stuffData.getLegacyString()),n++}return e}return this._items.length}getUnlockedCount(){if(this.category===Z.POST_IT)return this.getTotalCount();let e=0,n=0;for(;n<this._items.length;)this.getItemByIndex(n).locked||e++,n++;return e}getLastItem(){return this._items.length?this.getItemByIndex(this._items.length-1):null}unlockAllItems(){const e=[...this._items];let n=0;for(;n<e.length;){const r=e[n];if(r.locked){const s=r.clone();s.locked=!1,e[n]=s}n++}this._items=e}lockItemIds(e){const n=[...this._items];let r=0,s=!1;for(;r<n.length;){const a=n[r],c=e.indexOf(a.ref)>=0;if(a.locked!==c){s=!0;const u=a.clone();u.locked=c,n[r]=u}r++}return this._items=n,s}setName(){const e=this.getLastItem();if(!e){this._name="";return}let n="";switch(this._category){case Z.POSTER:n="poster_"+e.stuffData.getLegacyString()+"_name";break;case Z.TRAX_SONG:this._name="SONG_NAME";return;default:this.isWallItem?n="wallItem.name."+e.type:n="roomItem.name."+e.type}this._name=m(n)}setDescription(){this._description=""}setIcon(){if(this._iconUrl)return;let e=null;this.isWallItem?e=this._roomEngine.getFurnitureWallIconUrl(this._type,this._stuffData.getLegacyString()):e=this._roomEngine.getFurnitureFloorIconUrl(this._type),e&&(this._iconUrl=e)}get type(){return this._type}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get iconUrl(){return this._iconUrl}get name(){return this._name}get description(){return this._description}get hasUnseenItems(){return this._hasUnseenItems}set hasUnseenItems(e){this._hasUnseenItems=e}get locked(){return this._locked}set locked(e){this._locked=e}get selected(){return this._selected}set selected(e){this._selected=e}get isWallItem(){const e=this.getItemByIndex(0);return e?e.isWallItem:!1}get isGroupable(){const e=this.getItemByIndex(0);return e?e.isGroupable:!1}get isSellable(){const e=this.getItemByIndex(0);return e?e.sellable:!1}get items(){return this._items}set items(e){this._items=e}}const nl=(o,e,n,r=NaN)=>new tl(o,e,$(),n,r),_b=(o,e,n)=>{const r=[];for(const a of o)a.type===e.type&&r.push(a);for(const a of r)if(a.getItemById(e.id))return a;const s=nl(e.type,e.category,e.stuffData,e.extra);return s.push(e),n?(s.hasUnseenItems=!0,o.unshift(s)):o.push(s),s},bb=(o,e,n)=>{let r=null;for(const s of o)if(s.type===e.type&&s.isWallItem===e.isWallItem&&s.isGroupable)if(e.category===Z.POSTER){if(s.stuffData.getLegacyString()===e.stuffData.getLegacyString()){r=s;break}}else if(e.category===Z.GUILD_FURNI){if(e.stuffData.compare(s.stuffData)){r=s;break}}else{r=s;break}if(r){if(r.push(e),n){r.hasUnseenItems=!0;const s=o.indexOf(r);s>=0&&o.splice(s,1),o.unshift(r)}return r}return r=nl(e.type,e.category,e.stuffData,e.extra),r.push(e),n?(r.hasUnseenItems=!0,o.unshift(r)):o.push(r),r},Jl=(o,e,n)=>{e.isGroupable?bb(o,e,n):_b(o,e,n)},Sb=(o,e,n,r)=>{if(e===1)return o;r[n]=o;for(const a of r)if(!a)return null;const s=new Map;for(const a of r){for(const[c,u]of a)s.set(c,u);a.clear()}return r=null,s},Nb=o=>{const e=[];for(const n of o){let r=n.getTotalCount();n.category===Z.POST_IT&&(r=1);let s=0;for(;s<r;)e.push(n.getItemByIndex(s).id),s++}return e};let _d=!1,bd=-1;const Tb=()=>_d,oa=o=>_d=o,Cs=()=>bd,ho=o=>bd=o,Ks=()=>{Cs()!==-1&&($().cancelRoomObjectPlacement(),ho(-1),oa(!1))},yi=(o,e=!1)=>{const n=o.petData;if(!n)return!1;const r=Qr().getSession(1);return!r||!r.isRoomOwner&&!r.allowPets?!1:(ee("inventory/hide"),$().processRoomObjectPlacement(Vs.INVENTORY,-n.id,Q.UNIT,pt.PET,n.figureData.figuredata)&&(ho(n.id),oa(!0)),!0)},_s=(o,e=!1)=>{if(!o||!o.getUnlockedCount())return!1;const n=o.getLastItem();if(!n)return!1;if(n.category===Z.FLOOR||n.category===Z.WALL_PAPER||n.category===Z.LANDSCAPE)return e||A(new Wa(n.id)),!1;{ee("inventory/hide");let r=0,s=!1;n.isWallItem?r=Q.WALL:r=Q.FLOOR,n.category===Z.POSTER?s=$().processRoomObjectPlacement(Vs.INVENTORY,n.id,r,n.type,n.stuffData.getLegacyString()):s=$().processRoomObjectPlacement(Vs.INVENTORY,n.id,r,n.type,n.extra.toString(),n.stuffData),s&&(ho(n.ref),oa(!0))}return!0},Oi=(o,e=!1)=>{const n=o.botData;if(!n)return!1;const r=Qr().getSession(1);return!r||!r.isRoomOwner?!1:(ee("inventory/hide"),$().processRoomObjectPlacement(Vs.INVENTORY,-n.id,Q.UNIT,pt.RENTABLE_BOT,n.figure)&&(ho(n.id),oa(!0)),!0)};class ze{}ze.FURNI=1;ze.RENTABLE=2;ze.PET=3;ze.BADGE=4;ze.BOT=5;ze.GAMES=6;const vb=o=>o.map(e=>e.petData.id),Sd=(o,e,n=!0)=>{const r={petData:o};return n?e.unshift(r):e.push(r),r},Nd=(o,e)=>{let n=0;for(;n<e.length;){const r=e[n];if(r&&r.petData.id===o)return Cs()===r.petData.id&&(Ks(),ee("inventory/open")),e.splice(n,1),r;n++}return null},wb=(o,e,n)=>{const r=vb(o),s=[],a=[];for(const c of e.keys())r.indexOf(c)===-1&&s.push(c);for(const c of r)!e.get(c)&&a.push(c);r.length;for(const c of a)Nd(c,o);for(const c of s){const u=e.get(c);u&&Sd(u,o,n(ze.PET,u.id))}return o},Rb=(o,e,n,r)=>{if(e===1)return o;r[n]=o;for(const a of r)if(!a)return null;const s=new Map;for(const a of r){for(const[c,u]of a)s.set(c,u);a.clear()}return r=null,s};class rt{}rt.TRADING_STATE_READY=0;rt.TRADING_STATE_RUNNING=1;rt.TRADING_STATE_COUNTDOWN=2;rt.TRADING_STATE_CONFIRMING=3;rt.TRADING_STATE_CONFIRMED=4;rt.TRADING_STATE_COMPLETED=5;rt.TRADING_STATE_CANCELLED=6;class Zl{constructor(e=-1,n="",r=new Hs,s=0,a=0,c=!1,u=!1){this.userId=e,this.userName=n,this.userItems=r,this.itemCount=s,this.creditsCount=a,this.accepts=c,this.canTrade=u}}class _t{}_t.ALERT_SCAM=0;_t.HOTEL_TRADING_DISABLED=1;_t.YOU_NOT_ALLOWED=2;_t.THEY_NOT_ALLOWED=4;_t.ROOM_DISABLED=6;_t.YOU_OPEN=7;_t.THEY_OPEN=8;_t.ERROR_WHILE_COMMIT=9;_t.THEY_CANCELLED=10;const ec=o=>{var e;return((e=q().getWallItemData(o))==null?void 0:e.isExternalImage)||!1},tc=o=>{const e=new Hs;if(o.length)for(const r of o){const s=r.spriteId,a=r.category;let c=r.furniType+s;(!r.isGroupable||ec(s))&&(c="itemid"+r.itemId),r.category===Z.POSTER?c=r.itemId+"poster"+r.stuffData.getLegacyString():r.category===Z.GUILD_FURNI&&(c="");let u=r.isGroupable&&!ec(r.spriteId)?e.getValue(c):null;u||(u=nl(s,a,r.stuffData),e.add(c,u)),u.push(new $s(r))}return e},yb=(o,e)=>{let n=o.toString();if(!(e instanceof ea))return n;let r=1;for(;r<5;)n=n+(","+e.getValue(r)),r++;return n};class ja{static getProductImageUrl(e,n,r){let s=null;switch(e){case Ps.S:s=$().getFurnitureFloorIconUrl(n);break;case Ps.I:this.getProductCategory(Ps.I,n)===1&&(s=$().getFurnitureWallIconUrl(n,r));break}return s}static getProductCategory(e,n){if(e===Ps.S)return 1;if(e===Ps.I){if(n===3001)return Z.WALL_PAPER;if(n===3002)return Z.FLOOR;if(n===4057)return Z.LANDSCAPE}return 1}}class Ja{static getRandomNumber(e){return Math.floor(Math.random()*e)}static getRandomElement(e){return e[this.getRandomNumber(e.length)]}static getRandomElements(e,n){const r=new Array(n);let s=e.length;const a=new Array(s);for(;n--;){var c=this.getRandomNumber(s);r[n]=e[c in a?a[c]:c],a[c]=--s in a?a[s]:s}return r}}const Tt=new Map;Tt.set("r","red");Tt.set("b","blue");Tt.set("g","green");Tt.set("y","yellow");Tt.set("w","white");Tt.set("o","orange");Tt.set("c","cyan");Tt.set("br","brown");Tt.set("pr","purple");Tt.set("pk","pink");Tt.set("red","red");Tt.set("blue","blue");Tt.set("green","green");Tt.set("yellow","yellow");Tt.set("white","white");Tt.set("orange","orange");Tt.set("cyan","cyan");Tt.set("brown","brown");Tt.set("purple","purple");Tt.set("pink","pink");const Ob=o=>o.replace(/([\u00A0-\u9999<>&])(.|$)/g,(e,n,r)=>n!=="&"||r!=="#"?(/[\u00A0-\u9999<>&]/.test(r)&&(r="&#"+r.charCodeAt(0)+";"),"&#"+n.charCodeAt(0)+";"+r):e),kb=o=>{let e="";if(o=Ob(o),o.includes("giphy.com/media")){console.log(o);const n=/^https:\/\/[a-zA-Z0-9.-]+\.giphy\.com\/media\/[a-zA-Z0-9]+\/[0-9]+$/;o.includes("@")?n.test(o.split("@")[2])?o="<img src='"+o.split("@")[2]+".gif' style='max-width: 150px; object-fit: contain;'/>":o="Message not allowed.":n.test(o)?o="<img src='"+o+".gif' style='max-width: 150px; object-fit: contain;'/>":o="Message not allowed."}if(o.includes("localhost/c_images/emojis/emoji")&&!o.includes("<img")&&(/^http:\/\/localhost\/c_images\/[a-zA-Z0-9/]+\.png$/.test(o)?o=o:o="Message not allowed."),o.startsWith("@")&&o.indexOf("@",1)>-1){let n=null;for(;(n=/@[a-zA-Z]+@/g.exec(o))!==null;){const r=n[0].toString(),s=r.substr(1,r.length-2),a=o.replace(r,"");Tt.has(s)?e='<span style="color: '+Tt.get(s)+'">'+a+"</span>":e=a;break}}else e=o;return e},Td=(o,e)=>window.localStorage.setItem(o,JSON.stringify(e));class mn{}mn.CAMERA_SHUTTER="camera_shutter";mn.CREDITS="credits";mn.DUCKETS="duckets";mn.MESSENGER_NEW_THREAD="messenger_new_thread";mn.MESSENGER_MESSAGE_RECEIVED="messenger_message_received";mn.MODTOOLS_NEW_TICKET="modtools_new_ticket";function Ab(o){const e=o.parts;let n=0;for(const r of e)n=Math.max(n,r.colorLayerIndex);return n}function Pb(o,e){return e=e.filter(n=>o.indexOf(n)===-1),[...o,...Ja.getRandomElements(e,Ja.getRandomNumber(e.length)+1)]}function Db(o,e,n=0,r=[]){if(!o)return null;const s=o.partSets.getValues().filter(a=>!a.isSelectable||a.gender!=="U"&&a.gender!==e||a.clubLevel>n||a.isSellable&&r.indexOf(a.id)===-1?null:a);return!s||!s.length?null:Ja.getRandomElement(s)}function Mb(o,e,n=0){if(!o)return[];const r=o.colors.getValues().filter(s=>!s.isSelectable||s.clubLevel>n?null:s);return!r||!r.length?null:Ja.getRandomElements(r,Ab(e))}function Lb(o,e,n=0,r=[],s=[]){const a=Nt().structure,c=new yg(""),u=Pb(a.getMandatorySetTypeIds(e,n),ye.SET_TYPES);for(const d of s){const h=o.getPartSetId(d),g=o.getColorIds(d);c.updatePart(d,h,g)}for(const d of u){if(c.hasPartType(d))continue;const h=a.figureData.getSetType(d),g=Db(h,e,n,r);if(!g)continue;let f=[];g.isColorable&&(f=Mb(a.figureData.getPalette(h.paletteID),g,n).map(p=>p.id)),c.updatePart(h.type,g.id,f)}return c.getFigureString()}class Ub extends go{init(){super.init(),this.addCategory(ye.HAIR),this.addCategory(ye.HAT),this.addCategory(ye.HEAD_ACCESSORIES),this.addCategory(ye.EYE_ACCESSORIES),this.addCategory(ye.FACE_ACCESSORIES),this._isInitalized=!0}get name(){return Ir.HEAD}}class xb extends go{init(){super.init(),this.addCategory(ye.TROUSERS),this.addCategory(ye.SHOES),this.addCategory(ye.TROUSER_ACCESSORIES),this._isInitalized=!0}get name(){return Ir.LEGS}}class Fb extends go{init(){super.init(),this.addCategory(ye.SHIRT),this.addCategory(ye.CHEST_PRINTS),this.addCategory(ye.JACKET),this.addCategory(ye.CHEST_ACCESSORIES),this._isInitalized=!0}get name(){return Ir.TORSO}}class Xs{}Xs.COLORMATRIX="colormatrix";Xs.COMPOSITE="composite";class Bb{constructor(e,n){this.texture=e,this.imageUrl=n}}class Gb{constructor(e,n){this.effectName=e,this.thumbnailUrl=n}}class Vb{constructor(e,n,r){this._productName=e,this._customImage=n,this._furnitureClassName=r}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class xt{}xt.STATE_UNLOCKED=1;xt.STATE_LOCKED_AVAILABLE=2;xt.STATE_LOCKED_EXPIRED=3;xt.STATE_LOCKED_FUTURE=4;class Dn{}Dn.TYPE_CHAT=1;Dn.TYPE_ROOM_INFO=2;Dn.TYPE_IM=3;const vd=()=>{const o=new Date;return`${o.getHours().toString().padStart(2,"0")}:${o.getMinutes().toString().padStart(2,"0")}`},nc=(o=0)=>{const e=o?new Date(Date.now()-o*1e3):new Date;return`${e.getHours().toString().padStart(2,"0")}:${e.getMinutes().toString().padStart(2,"0")}`},wd=o=>{if(!o||!o.length)return null;const e=o.split("/"),n=e[0],r=e[1],s=parseInt(e[2]);return{username:n,figure:r,userId:s}};class Wt{constructor(){this.id=-1,this.name=null,this.gender=0,this.online=!1,this.followingAllowed=!1,this.figure=null,this.categoryId=0,this.motto=null,this.realName=null,this.lastAccess=null,this.persistedMessageUser=!1,this.vipMember=!1,this.pocketHabboUser=!1,this.relationshipStatus=-1,this.unread=0}populate(e){this.id=e.id,this.name=e.name,this.gender=e.gender,this.online=e.online,this.followingAllowed=e.followingAllowed,this.figure=e.figure,this.categoryId=e.categoryId,this.motto=e.motto,this.realName=e.realName,this.lastAccess=e.lastAccess,this.persistedMessageUser=e.persistedMessageUser,this.vipMember=e.vipMember,this.pocketHabboUser=e.pocketHabboUser,this.relationshipStatus=e.relationshipStatus}}Wt.RELATIONSHIP_NONE=0;Wt.RELATIONSHIP_HEART=1;Wt.RELATIONSHIP_SMILE=2;Wt.RELATIONSHIP_BOBBA=3;class Yr{}Yr.GROUP_CHAT=0;Yr.PRIVATE_CHAT=1;class qn{}qn.HIDDEN=0;qn.SHOW=1;qn.UNREAD=2;class rc{populate(e){return e?(this._id=e.requestId,this._name=e.requesterName,this._figureString=e.figureString,this._requesterUserId=e.requesterUserId,!0):!1}get id(){return this._id}get name(){return this._name}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class Hb{constructor(e=0,n=0,r=0,s=[]){this.userFriendLimit=e,this.normalFriendLimit=n,this.extendedFriendLimit=r,this.categories=s}}class zn{constructor(e,n,r=0,s=null,a=0){this._type=a,this._senderId=e,this._message=n,this._secondsSinceSent=r,this._extraData=s,this._date=new Date}get type(){return this._type}get senderId(){return this._senderId}get message(){return this._message}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}get date(){return this._date}}zn.CHAT=0;zn.ROOM_INVITE=1;zn.STATUS_NOTIFICATION=2;zn.SECURITY_NOTIFICATION=3;class Wb{constructor(e,n=Yr.PRIVATE_CHAT){this._userId=e,this._chats=[],this._type=n}addChat(e){this._chats.push(e)}get userId(){return this._userId}get chats(){return this._chats}get type(){return this._type}set type(e){this._type=e}}const rl=class Rd{constructor(e){this._threadId=++Rd.THREAD_ID,this._participant=e,this._groups=[],this._lastUpdated=new Date,this._unreadCount=0}addMessage(e,n,r=0,s=null,a=0){const c=e<0&&s,u=c?wd(s).userId:e,d=this.getLastGroup(u);if(!d)return;c&&(d.type=Yr.GROUP_CHAT);const h=new zn(e,n,r,s,a);return d.addChat(h),this._lastUpdated=new Date,this._unreadCount++,h}getLastGroup(e){let n=this._groups[this._groups.length-1];return n&&n.userId===e||(n=new Wb(e),this._groups.push(n)),n}setRead(){this._unreadCount=0}get threadId(){return this._threadId}get participant(){return this._participant}get groups(){return this._groups}get lastUpdated(){return this._lastUpdated}get unreadCount(){return this._unreadCount}get unread(){return this._unreadCount>0}};rl.MESSAGE_RECEIVED="MT_MESSAGE_RECEIVED";rl.THREAD_ID=0;let jb=rl;function fo(o=0){ee(o===0?"friends-messenger/toggle":`friends-messenger/${o}`)}const qb=()=>Ru.RENDERER_VERSION,yd=()=>"2.2.0";function ia(o){A(new Ws(o,!0))}function Od(o){ee(`groups/manage/${o}`)}function sc(o,e){ee(e?`group-members/${o}/${e}`:`group-members/${o}`)}const sl=class ki{constructor(e,n,r,s){this.type=e,this.key=n||0,this.color=r||0,this.position=s||4}get code(){return this.key===0&&this.type!==ki.BASE?null:ki.getCode(this.type,this.key,this.color,this.position)}static getCode(e,n,r,s){return e+(n<10?"0":"")+n+(r<10?"0":"")+r+s}};sl.BASE="b";sl.SYMBOL="s";let sn=sl;class vt{}vt.NOT_MEMBER=0;vt.MEMBER=1;vt.REQUEST_PENDING=2;class ln{}ln.REGULAR=0;ln.EXCLUSIVE=1;ln.PRIVATE=2;const zb=o=>{A(o.favourite?new Og(o.groupId):new kg(o.groupId))},al=o=>A(new Ag(o));class ge{}ge.NONE="NONE";ge.ERROR="ERROR";ge.REJECTED="REJECTED";ge.USER_CREATE="USER_CREATE";ge.USER_PENDING="USER_PENDING";ge.USER_ONGOING="USER_ONGOING";ge.USER_FEEDBACK="USER_FEEDBACK";ge.USER_NO_HELPERS="USER_NO_HELPERS";ge.USER_SOMETHING_WRONG="USER_SOMETHING_WRONG";ge.USER_THANKS="USER_THANKS";ge.USER_GUIDE_DISCONNECTED="USER_GUIDE_DISCONNECTED";ge.GUIDE_TOOL_MENU="GUIDE_TOOL_MENU";ge.GUIDE_ACCEPT="GUIDE_ACCEPT";ge.GUIDE_ONGOING="GUIDE_ONGOING";ge.GUIDE_CLOSED="GUIDE_CLOSED";ge.GUARDIAN_CHAT_REVIEW_ACCEPT="GUARDIAN_CHAT_REVIEW_ACCEPT";ge.GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_VOTERS";ge.GUARDIAN_CHAT_REVIEW_VOTE="GUARDIAN_CHAT_REVIEW_VOTE";ge.GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS="GUARDIAN_CHAT_REVIEW_WAIT_FOR_RESULTS";ge.GUARDIAN_CHAT_REVIEW_RESULTS="GUARDIAN_CHAT_REVIEW_RESULTS";class ac{constructor(e,n){this._message=e,this._roomId=n}get message(){return this._message}get roomId(){return this._roomId}}class oc{constructor(e){this._userId=e,this._messages=[]}addChat(e){this._messages.push(e)}get userId(){return this._userId}get messages(){return this._messages}}class Hn{}Hn.ACTIVE="active";Hn.NONE="none";Hn.EXPIRED="expired";const Yb="HC1",$b=["ACH_VipHC1","ACH_VipHC2","ACH_VipHC3","ACH_VipHC4","ACH_VipHC5","HC1","HC2","HC3","HC4","HC5"],Kb=o=>{let e=null;return $b.forEach(n=>o.indexOf(n)>-1&&(e=n)),e||Yb};class Za{}Za.TOO_MANY_PENDING_CALLS_CODE=1;Za.HAS_ABUSIVE_CALL_CODE=2;const Xb=o=>o===1?"useless":o===2?"abusive":"resolved";class Pt{}Pt.SELECT_USER=0;Pt.SELECT_CHATS=1;Pt.SELECT_TOPICS=2;Pt.INPUT_REPORT_MESSAGE=3;Pt.REPORT_SUMMARY=4;class He{}He.EMERGENCY=1;He.GUIDE=2;He.IM=3;He.ROOM=4;He.BULLY=6;He.THREAD=7;He.MESSAGE=8;He.PHOTO=9;const Qb=o=>{switch(o){case 1:case 2:return"Normal";case 3:return"Automatic";case 4:return"Automatic IM";case 5:return"Guide System";case 6:return"IM";case 7:return"Room";case 8:return"Panic";case 9:return"Guardian";case 10:return"Automatic Helper";case 11:return"Discussion";case 12:return"Selfie";case 14:return"Photo";case 15:return"Ambassador"}return"Unknown"};class Ue{constructor(e,n,r,s,a){this._actionId=e,this._name=n,this._actionType=r,this._sanctionTypeId=s,this._actionLengthHours=a}get actionId(){return this._actionId}get name(){return this._name}get actionType(){return this._actionType}get sanctionTypeId(){return this._sanctionTypeId}get actionLengthHours(){return this._actionLengthHours}}Ue.ALERT=1;Ue.MUTE=2;Ue.BAN=3;Ue.KICK=4;Ue.TRADE_LOCK=5;Ue.MESSAGE=6;class De{}De.NONE=0;De.START_DOORBELL=1;De.START_PASSWORD=2;De.STATE_PENDING_SERVER=3;De.UPDATE_STATE=4;De.STATE_WAITING=5;De.STATE_NO_ANSWER=6;De.STATE_WRONG_PASSWORD=7;De.STATE_ACCEPTED=8;class fr{}fr.LIST=0;fr.THUMBNAILS=1;fr.FORCED_THUMBNAILS=2;const Jb=()=>{const o=[];for(let e=10;e<=100;e=e+10)o.push(e);return o},ic=Jb(),rs=[{name:"anything",query:null},{name:"room.name",query:"roomname"},{name:"owner",query:"owner"},{name:"tag",query:"tag"},{name:"group",query:"group"}];function _n(o){A(new $a(o,!1,!0))}class ue{}ue.DEFAULT="default";ue.MOTD="motd";ue.MODERATION="moderation";ue.EVENT="event";ue.NITRO="nitro";ue.SEARCH="search";ue.ALERT="alert";ue.ALERT_TOP="alert_top";const kd=class Ai{constructor(e,n=ue.DEFAULT,r=null,s=null,a=null,c=null){Ai.ITEM_ID+=1,this._id=Ai.ITEM_ID,this._messages=e,this._alertType=n,this._clickUrl=r,this._clickUrlText=s,this._title=a,this._imageUrl=c}get id(){return this._id}get messages(){return this._messages}set alertType(e){this._alertType=e}get alertType(){return this._alertType}get clickUrl(){return this._clickUrl}get clickUrlText(){return this._clickUrlText}get title(){return this._title}get imageUrl(){return this._imageUrl}};kd.ITEM_ID=-1;let Ko=kd;class Xe{}Xe.FRIENDOFFLINE="friendoffline";Xe.FRIENDONLINE="friendonline";Xe.THIRDPARTYFRIENDOFFLINE="thirdpartyfriendoffline";Xe.THIRDPARTYFRIENDONLINE="thirdpartyfriendonline";Xe.ACHIEVEMENT="achievement";Xe.BADGE_RECEIVED="badge_received";Xe.INFO="info";Xe.RECYCLEROK="recyclerok";Xe.RESPECT="respect";Xe.CLUB="club";Xe.SOUNDMACHINE="soundmachine";Xe.PETLEVEL="petlevel";Xe.CLUBGIFT="clubgift";Xe.BUYFURNI="buyfurni";Xe.VIP="vip";Xe.ROOMMESSAGESPOSTED="roommessagesposted";const Ad=class Pi{constructor(e,n=Xe.INFO,r=null,s=null){Pi.ITEM_ID+=1,this._id=Pi.ITEM_ID,this._message=e,this._notificationType=n,this._iconUrl=r,this._linkUrl=s}get id(){return this._id}get message(){return this._message}get notificationType(){return this._notificationType}get iconUrl(){return this._iconUrl}get linkUrl(){return this._linkUrl}};Ad.ITEM_ID=-1;let Zb=Ad;const Pd=class Di{constructor(e,n,r,s,a,c,u){Di.ITEM_ID+=1,this._id=Di.ITEM_ID,this._confirmType=e,this._message=n,this._onConfirm=r,this._onCancel=s,this._confirmText=a,this._cancelText=c,this._title=u}get id(){return this._id}get confirmType(){return this._confirmType}get message(){return this._message}get onConfirm(){return this._onConfirm}get onCancel(){return this._onCancel}get confirmText(){return this._confirmText}get cancelText(){return this._cancelText}get title(){return this._title}};Pd.ITEM_ID=-1;let eS=Pd;class ol{constructor(){this._credits=0,this._activityPoints=new Map,this._clubDays=0,this._clubPeriods=0,this._isVIP=!1,this._pastClubDays=0,this._pastVipDays=0,this._isExpiring=!1,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,this._lastUpdated=0}static from(e){const n=new ol;return n._credits=e._credits,n._activityPoints=e._activityPoints,n._clubDays=e._clubDays,n._clubPeriods=e._clubPeriods,n._isVIP=e._isVIP,n._pastClubDays=e._pastClubDays,n._pastVipDays=e._pastVipDays,n._isExpiring=e._isExpiring,n._minutesUntilExpiration=e._minutesUntilExpiration,n._minutesSinceLastModified=e._minutesSinceLastModified,n._lastUpdated=e._lastUpdated,n}get credits(){return this._credits}set credits(e){this._lastUpdated=yn(),this._credits=e}get activityPoints(){return this._activityPoints}set activityPoints(e){this._lastUpdated=yn(),this._activityPoints=e}get clubDays(){return this._clubDays}set clubDays(e){this._lastUpdated=yn(),this._clubDays=e}get clubPeriods(){return this._clubPeriods}set clubPeriods(e){this._lastUpdated=yn(),this._clubPeriods=e}get hasClubLeft(){return this._clubDays>0||this._clubPeriods>0}get isVip(){return this._isVIP}set isVip(e){this._isVIP=e}get pastClubDays(){return this._pastClubDays}set pastClubDays(e){this._lastUpdated=yn(),this._pastClubDays=e}get pastVipDays(){return this._pastVipDays}set pastVipDays(e){this._lastUpdated=yn(),this._pastVipDays=e}get isExpiring(){return this._isExpiring}set isExpiring(e){this._isExpiring=e}get minutesUntilExpiration(){var e=(yn()-this._lastUpdated)/6e4,n=this._minutesUntilExpiration-e;return n>0?n:0}set minutesUntilExpiration(e){this._lastUpdated=yn(),this._minutesUntilExpiration=e}get minutesSinceLastModified(){return this._minutesSinceLastModified}set minutesSinceLastModified(e){this._lastUpdated=yn(),this._minutesSinceLastModified=e}get lastUpdated(){return this._lastUpdated}get clubLevel(){return this.clubDays===0&&this.clubPeriods===0?dn.NO_CLUB:this.isVip?dn.VIP:dn.CLUB}}class la extends Ln{}class pr extends la{constructor(e,n){super(e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._pollType="",this._npsPoll=!1,this._id=n}get id(){return this._id}get summary(){return this._summary}set summary(e){this._summary=e}get headline(){return this._headline}set headline(e){this._headline=e}get numQuestions(){return this._numQuestions}set numQuestions(e){this._numQuestions=e}get startMessage(){return this._startMessage}set startMessage(e){this._startMessage=e}get endMessage(){return this._endMessage}set endMessage(e){this._endMessage=e}get questionArray(){return this._questionArray}set questionArray(e){this._questionArray=e}get pollType(){return this._pollType}set pollType(e){this._pollType=e}get npsPoll(){return this._npsPoll}set npsPoll(e){this._npsPoll=e}}pr.OFFER="RWPUW_OFFER";pr.ERROR="RWPUW_ERROR";pr.CONTENT="RWPUW_CONTENT";class Tr extends la{constructor(e,n=0,r=0,s=0){super(e),this._hue=n,this._saturation=r,this._lightness=s}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}Tr.PREVIEW="RWUBCPE_PREVIEW";Tr.CLEAR_PREVIEW="RWUBCPE_CLEAR_PREVIEW";const po=class Dd extends la{constructor(e,n){super(Dd.CHAT_INPUT_CONTENT),this._chatMode="",this._userName="",this._chatMode=e,this._userName=n}get chatMode(){return this._chatMode}get userName(){return this._userName}};po.CHAT_INPUT_CONTENT="RWUCICE_CHAT_INPUT_CONTENT";po.WHISPER="whisper";po.SHOUT="shout";let Fs=po;const Md=class Ld extends la{constructor(e,n,r,s,a,c,u){super(Ld.UPDATE_CHAT),this._objectId=e,this._category=n,this._botId=r,this._chat=s,this._automaticChat=a,this._chatDelay=c,this._mixSentences=u}get objectId(){return this._objectId}get category(){return this._category}get botId(){return this._botId}get chat(){return this._chat}get automaticChat(){return this._automaticChat}get chatDelay(){return this._chatDelay}get mixSentences(){return this._mixSentences}};Md.UPDATE_CHAT="RWURBCE_UPDATE_CHAT";let Ud=Md;class we extends la{constructor(e,n,r,s){super(e),this._id=n,this._category=r,this._roomId=s}get id(){return this._id}get category(){return this._category}get roomId(){return this._roomId}}we.OBJECT_SELECTED="RWUROE_OBJECT_SELECTED";we.OBJECT_DESELECTED="RWUROE_OBJECT_DESELECTED";we.USER_REMOVED="RWUROE_USER_REMOVED";we.FURNI_REMOVED="RWUROE_FURNI_REMOVED";we.FURNI_ADDED="RWUROE_FURNI_ADDED";we.USER_ADDED="RWUROE_USER_ADDED";we.OBJECT_ROLL_OVER="RWUROE_OBJECT_ROLL_OVER";we.OBJECT_ROLL_OUT="RWUROE_OBJECT_ROLL_OUT";we.OBJECT_REQUEST_MANIPULATION="RWUROE_OBJECT_REQUEST_MANIPULATION";we.OBJECT_DOUBLE_CLICKED="RWUROE_OBJECT_DOUBLE_CLICKED";class bs{constructor(e){this.type=e,this.id=0,this.category=0,this.name="",this.description="",this.image=null,this.isWallItem=!1,this.isStickie=!1,this.isRoomOwner=!1,this.roomControllerLevel=0,this.isAnyRoomController=!1,this.expiration=-1,this.purchaseCatalogPageId=-1,this.purchaseOfferId=-1,this.extraParam="",this.isOwner=!1,this.stuffData=null,this.groupId=0,this.ownerId=0,this.ownerName="",this.usagePolicy=0,this.rentCatalogPageId=-1,this.rentOfferId=-1,this.purchaseCouldBeUsedForBuyout=!1,this.rentCouldBeUsedForBuyout=!1,this.availableForBuildersClub=!1,this.tileSizeX=1,this.tileSizeY=1}}bs.FURNI="IFI_FURNI";class xd{constructor(e,n,r,s,a,c=!1){this.roomIndex=e,this.category=n,this.id=r,this.name=s,this.userType=a,this.isFriend=c}}class Ss{constructor(e){this.type=e,this.level=0,this.maximumLevel=0,this.experience=0,this.levelExperienceGoal=0,this.energy=0,this.maximumEnergy=0,this.happyness=0,this.maximumHappyness=0,this.respectsPetLeft=0,this.respect=0,this.age=0,this.name="",this.id=-1,this.image=null,this.petType=0,this.petBreed=0,this.petFigure="",this.posture="std",this.isOwner=!1,this.ownerId=-1,this.ownerName="",this.canRemovePet=!1,this.roomIndex=0,this.unknownRarityLevel=0,this.saddle=!1,this.rider=!1,this.breedable=!1,this.skillTresholds=[],this.publiclyRideable=0,this.fullyGrown=!1,this.dead=!1,this.rarityLevel=0,this.maximumTimeToLive=0,this.remainingTimeToLive=0,this.remainingGrowTime=0,this.publiclyBreedable=!1}}Ss.PET_INFO="IPI_PET_INFO";class Ns{constructor(e){this.type=e,this.name="",this.motto="",this.webID=0,this.figure="",this.badges=[],this.carryItem=0,this.roomIndex=0,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.ownerId=-1,this.ownerName="",this.botSkills=[]}}Ns.RENTABLE_BOT="IRBI_RENTABLE_BOT";const kr=class Fd{constructor(e){this.type=e,this.name="",this.motto="",this.achievementScore=0,this.webID=0,this.xp=0,this.userType=-1,this.figure="",this.badges=[],this.groupId=0,this.groupName="",this.groupBadgeId="",this.carryItem=0,this.roomIndex=0,this.isSpectatorMode=!1,this.allowNameChange=!1,this.amIOwner=!1,this.amIAnyRoomController=!1,this.roomControllerLevel=0,this.canBeKicked=!1,this.canBeBanned=!1,this.canBeMuted=!1,this.respectLeft=0,this.isIgnored=!1,this.isGuildRoom=!1,this.canTrade=!1,this.canTradeReason=0,this.targetRoomControllerLevel=0,this.isAmbassador=!1}get isOwnUser(){return this.type===Fd.OWN_USER}};kr.OWN_USER="IUI_OWN_USER";kr.PEER="IUI_PEER";kr.BOT="IUI_BOT";kr.TRADE_REASON_OK=0;kr.TRADE_REASON_SHUTDOWN=2;kr.TRADE_REASON_NO_TRADING=3;kr.DEFAULT_BOT_BADGE_ID="BOT";let At=kr;class ss{static getObjectName(e,n){const r=Oe();let s=-1,a=null,c=0;switch(n){case Q.FLOOR:case Q.WALL:{const u=$().getRoomObject(r.roomId,e,n);if(!u)break;if(u.type.indexOf("poster")===0)a=m("${poster_"+parseInt(u.type.replace("poster",""))+"_name}");else{let d=null;const h=u.model.getValue(ae.FURNITURE_TYPE_ID);if(n===Q.FLOOR?d=q().getFloorItemData(h):n===Q.WALL&&(d=q().getWallItemData(h)),!d)break;s=d.id,a=d.name}break}case Q.UNIT:{const u=r.userDataManager.getUserDataByIndex(e);if(!u)break;s=u.webID,a=u.name,c=u.type;break}}return!a||!a.length?null:new xd(e,n,s,a,c)}static getFurniInfo(e,n){const r=Oe(),s=new bs(bs.FURNI);s.id=e,s.category=n;const a=$().getRoomObject(r.roomId,e,n);if(!a)return;const c=a.model;c.getValue(gr.INFOSTAND_EXTRA_PARAM)&&(s.extraParam=c.getValue(gr.INFOSTAND_EXTRA_PARAM));const u=c.getValue(ae.FURNITURE_DATA_FORMAT),d=yu.getData(u);d.initializeFromRoomObjectModel(c),s.stuffData=d;const h=a.type;if(h.indexOf("poster")===0){const E=parseInt(h.replace("poster",""));s.name=m("${poster_"+E+"_name}"),s.description=m("${poster_"+E+"_desc}")}else{const E=c.getValue(ae.FURNITURE_TYPE_ID);let _=null;n===Q.FLOOR?_=q().getFloorItemData(E):n===Q.WALL&&(_=q().getWallItemData(E)),_&&(s.name=_.name,s.description=_.description,s.purchaseOfferId=_.purchaseOfferId,s.purchaseCouldBeUsedForBuyout=_.purchaseCouldBeUsedForBuyout,s.rentOfferId=_.rentOfferId,s.rentCouldBeUsedForBuyout=_.rentCouldBeUsedForBuyout,s.availableForBuildersClub=_.availableForBuildersClub,s.tileSizeX=_.tileSizeX,s.tileSizeY=_.tileSizeY)}h.indexOf("post_it")>-1&&(s.isStickie=!0);const g=c.getValue(ae.FURNITURE_EXPIRY_TIME),f=c.getValue(ae.FURNITURE_EXPIRTY_TIMESTAMP);s.expiration=g<0?g:Math.max(0,g-(yn()-f)/1e3);let p=$().getRoomObjectImage(r.roomId,e,n,new wt(180),64,null);(!p.data||p.data.width>140||p.data.height>200)&&(p=$().getRoomObjectImage(r.roomId,e,n,new wt(180),1,null)),s.image=p.getImage(),s.isWallItem=n===Q.WALL,s.isRoomOwner=r.isRoomOwner,s.roomControllerLevel=r.controllerLevel,s.isAnyRoomController=q().isModerator,s.ownerId=c.getValue(ae.FURNITURE_OWNER_ID),s.ownerName=c.getValue(ae.FURNITURE_OWNER_NAME),s.usagePolicy=c.getValue(ae.FURNITURE_USAGE_POLICY);const C=c.getValue(ae.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID);return C!==0&&(s.groupId=C),Ht(a)&&(s.isOwner=!0),s}static getUserInfo(e,n){const r=Oe();let s=At.OWN_USER;n.webID!==q().userId&&(s=At.PEER);const a=new At(s);a.isSpectatorMode=r.isSpectator,a.name=n.name,a.motto=n.custom,a.achievementScore=n.activityPoints,a.webID=n.webID,a.roomIndex=n.roomIndex,a.userType=pt.USER;const c=$().getRoomObject(r.roomId,n.roomIndex,e);if(c&&(a.carryItem=c.model.getValue(ae.FIGURE_CARRY_OBJECT)||0),s===At.OWN_USER&&(a.allowNameChange=q().canChangeName),a.amIOwner=r.isRoomOwner,a.isGuildRoom=r.isGuildRoom,a.roomControllerLevel=r.controllerLevel,a.amIAnyRoomController=q().isModerator,a.isAmbassador=q().isAmbassador,s===At.PEER){if(c){const h=c.model.getValue(ae.FIGURE_FLAT_CONTROL);h!==null&&(a.targetRoomControllerLevel=h),a.canBeMuted=this.canBeMuted(a),a.canBeKicked=this.canBeKicked(a),a.canBeBanned=this.canBeBanned(a)}a.isIgnored=q().isUserIgnored(n.name),a.respectLeft=q().respectsLeft;const u=q().isSystemShutdown,d=r.tradeMode;if(u)a.canTrade=!1;else switch(d){case Lo.ROOM_CONTROLLER_REQUIRED:{const h=a.roomControllerLevel!==nt.NONE&&a.roomControllerLevel!==nt.GUILD_MEMBER,g=a.targetRoomControllerLevel!==nt.NONE&&a.targetRoomControllerLevel!==nt.GUILD_MEMBER;a.canTrade=h||g;break}case Lo.NO_TRADING:a.canTrade=!0;break;default:a.canTrade=!1;break}a.canTradeReason=At.TRADE_REASON_OK,u&&(a.canTradeReason=At.TRADE_REASON_SHUTDOWN),d!==Lo.FREE_TRADING&&(a.canTradeReason=At.TRADE_REASON_NO_TRADING)}return a.groupId=n.groupId,a.groupBadgeId=q().getGroupBadge(a.groupId),a.groupName=n.groupName,a.badges=r.userDataManager.getUserBadges(n.webID),a.figure=n.figure,a}static getBotInfo(e,n){const r=Oe(),s=new At(At.BOT);s.name=n.name,s.motto=n.custom,s.webID=n.webID,s.roomIndex=n.roomIndex,s.userType=n.type;const a=$().getRoomObject(r.roomId,n.roomIndex,e);return a&&(s.carryItem=a.model.getValue(ae.FIGURE_CARRY_OBJECT)||0),s.amIOwner=r.isRoomOwner,s.isGuildRoom=r.isGuildRoom,s.roomControllerLevel=r.controllerLevel,s.amIAnyRoomController=q().isModerator,s.isAmbassador=q().isAmbassador,s.badges=[At.DEFAULT_BOT_BADGE_ID],s.figure=n.figure,s}static getRentableBotInfo(e,n){const r=Oe(),s=new Ns(Ns.RENTABLE_BOT);s.name=n.name,s.motto=n.custom,s.webID=n.webID,s.roomIndex=n.roomIndex,s.ownerId=n.ownerId,s.ownerName=n.ownerName,s.botSkills=n.botSkills;const a=$().getRoomObject(r.roomId,n.roomIndex,e);return a&&(s.carryItem=a.model.getValue(ae.FIGURE_CARRY_OBJECT)||0),s.amIOwner=r.isRoomOwner,s.roomControllerLevel=r.controllerLevel,s.amIAnyRoomController=q().isModerator,s.badges=[At.DEFAULT_BOT_BADGE_ID],s.figure=n.figure,s}static getPetInfo(e){const n=Oe(),r=n.userDataManager.getPetData(e.id);if(!r)return;const s=new Is(r.figure);let a=null;s.typeId===Ut.MONSTERPLANT&&(e.level>=e.adultLevel?a="std":a="grw"+e.level);const c=e.ownerId===q().userId,u=new Ss(Ss.PET_INFO);return u.name=r.name,u.id=e.id,u.ownerId=e.ownerId,u.ownerName=e.ownerName,u.rarityLevel=e.rarityLevel,u.petType=s.typeId,u.petBreed=s.paletteId,u.petFigure=r.figure,u.posture=a,u.isOwner=c,u.roomIndex=r.roomIndex,u.level=e.level,u.maximumLevel=e.maximumLevel,u.experience=e.experience,u.levelExperienceGoal=e.levelExperienceGoal,u.energy=e.energy,u.maximumEnergy=e.maximumEnergy,u.happyness=e.happyness,u.maximumHappyness=e.maximumHappyness,u.respect=e.respect,u.respectsPetLeft=q().respectsPetLeft,u.age=e.age,u.saddle=e.saddle,u.rider=e.rider,u.breedable=e.breedable,u.fullyGrown=e.fullyGrown,u.dead=e.dead,u.rarityLevel=e.rarityLevel,u.skillTresholds=e.skillTresholds,u.canRemovePet=!1,u.publiclyRideable=e.publiclyRideable,u.maximumTimeToLive=e.maximumTimeToLive,u.remainingTimeToLive=e.remainingTimeToLive,u.remainingGrowTime=e.remainingGrowTime,u.publiclyBreedable=e.publiclyBreedable,(c||n.isRoomOwner||q().isModerator||n.controllerLevel>=nt.GUEST)&&(u.canRemovePet=!0),u}static checkGuildSetting(e){return e.isGuildRoom?e.roomControllerLevel>=nt.GUILD_ADMIN:e.roomControllerLevel>=nt.GUEST}static isValidSetting(e,n){const r=Oe();if(!r.isPrivateRoom)return!1;const s=r.moderationSettings;let a=!1;return s&&(a=n(e,s)),a&&e.targetRoomControllerLevel<nt.ROOM_OWNER}static canBeMuted(e){const n=(r,s)=>{switch(s.allowMute){case Fn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=nt.ROOM_OWNER}};return this.isValidSetting(e,n)}static canBeKicked(e){const n=(r,s)=>{switch(s.allowKick){case Fn.MODERATION_LEVEL_ALL:return!0;case Fn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=nt.ROOM_OWNER}};return this.isValidSetting(e,n)}static canBeBanned(e){const n=(r,s)=>{switch(s.allowBan){case Fn.MODERATION_LEVEL_USER_WITH_RIGHTS:return this.checkGuildSetting(r);default:return r.roomControllerLevel>=nt.ROOM_OWNER}};return this.isValidSetting(e,n)}}class Ne{}Ne.GENERIC_SKILL=0;Ne.DRESS_UP=1;Ne.SETUP_CHAT=2;Ne.RANDOM_WALK=3;Ne.DANCE=4;Ne.CHANGE_BOT_NAME=5;Ne.SERVE_BEVERAGE=6;Ne.INCLIENT_LINK=7;Ne.NUX_PROCEED=8;Ne.CHANGE_BOT_MOTTO=9;Ne.NUX_TAKE_TOUR=10;Ne.NO_PICK_UP=12;Ne.NAVIGATOR_SEARCH=14;Ne.DONATE_TO_USER=24;Ne.DONATE_TO_ALL=25;const Bd=class Gd{constructor(e=-1,n=-1,r=-1,s="",a="",c="",u=null,d=0,h=0,g=null,f=null){this.senderId=e,this.senderCategory=n,this.roomId=r,this.text=s,this.formattedText=a,this.username=c,this.location=u,this.type=d,this.styleId=h,this.imageUrl=g,this.color=f,this.id=-1,this.width=0,this.height=0,this.elementRef=null,this.skipMovement=!1,this._top=0,this._left=0,this.id=++Gd.BUBBLE_COUNTER}get top(){return this._top}set top(e){this._top=e,this.elementRef&&(this.elementRef.style.top=this._top+"px")}get left(){return this._left}set left(e){this._left=e,this.elementRef&&(this.elementRef.style.left=this._left+"px")}};Bd.BUBBLE_COUNTER=0;let tS=Bd;class Wn{}Wn.CHAT_DEFAULT=0;Wn.CHAT_WHISPER=1;Wn.CHAT_SHOUT=2;class lc{constructor(e=0,n=0,r=0,s=0){this.id=e,this.type=n,this.color=r,this.light=s}}const nS=(o,e,n,r=0)=>!(o.left+r+o.width<e.left+r||o.left+r>e.left+r+e.width||o.top+o.height<e.top+n||o.top>e.top+n+e.height);class an{static savePreset(e,n,r,s,a){Oe().updateMoodlightData(e,n,r,s,a)}static changeState(){Oe().toggleMoodlightState()}static previewDimmer(e,n,r){$().updateObjectRoomColor(Oe().roomId,e,n,r)}static scaleBrightness(e){return~~((e-this.MIN_BRIGHTNESS)*(100-0)/(this.MAX_BRIGHTNESS-this.MIN_BRIGHTNESS)+0)}}an.AVAILABLE_COLORS=[7665141,21495,15161822,15353138,15923281,8581961,0];an.HTML_COLORS=["#74F5F5","#0053F7","#E759DE","#EA4532","#F2F851","#82F349","#000000"];an.MIN_BRIGHTNESS=76;an.MAX_BRIGHTNESS=255;const rS=130,sS=100,aS=130,oS=100,iS=130,lS=100,Vd=o=>{let e=0,n=0,r=0,s=0;for(;s<o.length;){switch(s%3){case 0:e=e+o.charCodeAt(s)*37;break;case 1:n=n+o.charCodeAt(s)*37;break;case 2:r=r+o.charCodeAt(s)*37;break}s++}return e=e%sS+rS,n=n%oS+aS,r=r%lS+iS,`rgb(${e},${n},${r})`};class fs{static getMergedMannequinFigureContainer(e,n){const r=Nt().createFigureContainer(e),s=Nt().createFigureContainer(n);for(const a of this.MANNEQUIN_CLOTHING_PART_TYPES)r.removePart(a);for(const a of s.getPartTypeIds())r.updatePart(a,s.getPartSetId(a),s.getPartColorIds(a));return r}static transformAsMannequinFigure(e){for(const n of e.getPartTypeIds())this.MANNEQUIN_CLOTHING_PART_TYPES.indexOf(n)>=0||e.removePart(n);e.updatePart(this.MANNEQUIN_FIGURE[0],this.MANNEQUIN_FIGURE[1],this.MANNEQUIN_FIGURE[2])}}fs.MANNEQUIN_FIGURE=["hd",99999,[99998]];fs.MANNEQUIN_CLOTHING_PART_TYPES=[We.CHEST_ACCESSORY,We.COAT_CHEST,We.CHEST,We.LEGS,We.SHOES,We.WAIST_ACCESSORY];class eo{}eo.POSTURE_STAND=0;eo.POSTURE_SIT=1;class ds{constructor(e,n,r){this._id=e,this._category=n,this._name=r}get id(){return this._id}get category(){return this._category}get name(){return this._name}}class cS{constructor(e,n,r,s,a,c,u){this.id=e,this.category=n,this.name=r,this.requestRoomObjectId=s,this.targetRoomObjectId=a,this.requestInventoryStripId=c,this.replace=u}}const to="0",Hd="1";class An{}An.UNSTARTED=-1;An.ENDED=0;An.PLAYING=1;An.PAUSED=2;An.BUFFERING=3;An.CUED=5;function tn(o){A(new Pg(o))}const ca=o=>{const e=Math.floor(o/2);return o%2?(e+.5).toString():e.toString()};class fe{}fe.TOGGLE_FURNI_STATE=0;fe.RESET=1;fe.SET_FURNI_STATE=3;fe.MOVE_FURNI=4;fe.GIVE_SCORE=6;fe.CHAT=7;fe.TELEPORT=8;fe.JOIN_TEAM=9;fe.LEAVE_TEAM=10;fe.CHASE=11;fe.FLEE=12;fe.MOVE_AND_ROTATE_FURNI=13;fe.GIVE_SCORE_TO_PREDEFINED_TEAM=14;fe.TOGGLE_TO_RANDOM_STATE=15;fe.MOVE_FURNI_TO=16;fe.GIVE_REWARD=17;fe.CALL_ANOTHER_STACK=18;fe.KICK_FROM_ROOM=19;fe.MUTE_USER=20;fe.BOT_TELEPORT=21;fe.BOT_MOVE=22;fe.BOT_TALK=23;fe.BOT_GIVE_HAND_ITEM=24;fe.BOT_FOLLOW_AVATAR=25;fe.BOT_CHANGE_FIGURE=26;fe.BOT_TALK_DIRECT_TO_AVTR=27;class he{}he.STATES_MATCH=0;he.FURNIS_HAVE_AVATARS=1;he.ACTOR_IS_ON_FURNI=2;he.TIME_ELAPSED_MORE=3;he.TIME_ELAPSED_LESS=4;he.USER_COUNT_IN=5;he.ACTOR_IS_IN_TEAM=6;he.HAS_STACKED_FURNIS=7;he.STUFF_TYPE_MATCHES=8;he.STUFFS_IN_FORMATION=9;he.ACTOR_IS_GROUP_MEMBER=10;he.ACTOR_IS_WEARING_BADGE=11;he.ACTOR_IS_WEARING_EFFECT=12;he.NOT_STATES_MATCH=13;he.FURNI_NOT_HAVE_HABBO=14;he.NOT_ACTOR_ON_FURNI=15;he.NOT_USER_COUNT_IN=16;he.NOT_ACTOR_IN_TEAM=17;he.NOT_HAS_STACKED_FURNIS=18;he.NOT_FURNI_IS_OF_TYPE=19;he.NOT_STUFFS_IN_FORMATION=20;he.NOT_ACTOR_IN_GROUP=21;he.NOT_ACTOR_WEARS_BADGE=22;he.NOT_ACTOR_WEARING_EFFECT=23;he.DATE_RANGE_ACTIVE=24;he.ACTOR_HAS_HANDITEM=25;he.SELECT_FURNI_AND_TEAM=26;const cc=o=>`${o.getFullYear()}/${("0"+(o.getMonth()+1)).slice(-2)}/${("0"+o.getDate()).slice(-2)} ${("0"+o.getHours()).slice(-2)}:${("0"+o.getMinutes()).slice(-2)}`;class le{}le.STUFF_SELECTION_OPTION_NONE=0;le.STUFF_SELECTION_OPTION_BY_ID=1;le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE=2;le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT=3;const uS=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,dS=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform vec3 lineColor;
uniform vec3 color;
void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec3 colorLine = lineColor * currentColor.a;
    vec3 colorOverlay = color * currentColor.a;

    if(currentColor.r == 0.0 && currentColor.g == 0.0 && currentColor.b == 0.0 && currentColor.a > 0.0) {
        gl_FragColor = vec4(colorLine.r, colorLine.g, colorLine.b, currentColor.a);
    } else if(currentColor.a > 0.0) {
        gl_FragColor = vec4(colorOverlay.r, colorOverlay.g, colorOverlay.b, currentColor.a);
    }
}`;class mS extends Dg{constructor(e,n){super(uS,dS),this.uniforms.lineColor=new Float32Array(3),this.uniforms.color=new Float32Array(3),this.lineColor=e,this.color=n}get lineColor(){return this._lineColor}set lineColor(e){const n=this.uniforms.lineColor;typeof e=="number"?(cn.hex2rgb(e,n),this._lineColor=e):(n[0]=e[0],n[1]=e[1],n[2]=e[2],this._lineColor=cn.rgb2hex(n))}get color(){return this._color}set color(e){const n=this.uniforms.color;typeof e=="number"?(cn.hex2rgb(e,n),this._color=e):(n[0]=e[0],n[1]=e[1],n[2]=e[2],this._color=cn.rgb2hex(n))}}const Wd=class Zn{static show(e){Zn.applySelectionShader(Zn.getRoomObject(e))}static hide(e){Zn.clearSelectionShader(Zn.getRoomObject(e))}static clearSelectionShaderFromFurni(e){for(const n of e)Zn.clearSelectionShader(Zn.getRoomObject(n))}static applySelectionShaderToFurni(e){for(const n of e)Zn.applySelectionShader(Zn.getRoomObject(n))}static getRoomObject(e){const n=$();return n.getRoomObject(n.activeRoomId,e,Q.FLOOR)}static applySelectionShader(e){if(!e)return;const n=e.visualization;if(n)for(const r of n.sprites)r.blendMode!==1&&(r.filters=[Zn._selectionShader])}static clearSelectionShader(e){if(!e)return;const n=e.visualization;if(n)for(const r of n.sprites)r.filters=[]}};Wd._selectionShader=new mS([1,1,1],[.6,.6,.6]);let Bs=Wd;const Ts="	";class et{}et.AVATAR_SAYS_SOMETHING=0;et.AVATAR_WALKS_ON_FURNI=1;et.AVATAR_WALKS_OFF_FURNI=2;et.EXECUTE_ONCE=3;et.TOGGLE_FURNI=4;et.EXECUTE_PERIODICALLY=6;et.AVATAR_ENTERS_ROOM=7;et.GAME_STARTS=8;et.GAME_ENDS=9;et.SCORE_ACHIEVED=10;et.COLLISION=11;et.EXECUTE_PERIODICALLY_LONG=12;et.BOT_REACHED_STUFF=13;et.BOT_REACHED_AVATAR=14;const P=o=>{const{ref:e=null,innerRef:n=null,display:r=null,fit:s=!1,fitV:a=!1,grow:c=!1,shrink:u=!1,fullWidth:d=!1,fullHeight:h=!1,overflow:g=null,position:f=null,float:p=null,pointer:C=!1,visible:E=null,textColor:_=null,classNames:I=[],className:b="",style:N={},children:v=null,...O}=o,R=i.useMemo(()=>{const k=[];return r&&r.length&&k.push("d-"+r),(s||d)&&k.push("w-100"),(s||h)&&k.push("h-100"),a&&k.push("vw-100","vh-100"),c&&k.push("flex-grow-1"),u&&k.push("flex-shrink-0"),g&&k.push("overflow-"+g),f&&k.push("position-"+f),p&&k.push("float-"+p),C&&k.push("cursor-pointer"),E!==null&&k.push(E?"visible":"invisible"),_&&k.push("text-"+_),I.length&&k.push(...I),k},[r,s,a,c,u,d,h,g,f,p,C,E,_,I]),y=i.useMemo(()=>{let k=R.join(" ");return b.length&&(k+=" "+b),k.trim()},[R,b]),G=i.useMemo(()=>{let k={};return Object.keys(N).length&&(k={...k,...N}),k},[N]);return t("div",{ref:n,className:y,style:G,...O,children:v})},jd=i.createContext({isCssGrid:!1}),gS=o=>t(jd.Provider,{value:o.value,children:o.children}),hS=()=>i.useContext(jd),se=o=>{const{inline:e=!1,gap:n=2,maxContent:r=!1,columnCount:s=0,center:a=!1,alignSelf:c=null,alignItems:u=null,justifyContent:d=null,fullHeight:h=!0,classNames:g=[],style:f={},...p}=o,C=i.useMemo(()=>{const _=[];return e?_.push("inline-grid"):_.push("grid"),n?_.push("gap-"+n):n===0&&_.push("gap-0"),r&&_.push("flex-basis-max-content"),c&&_.push("align-self-"+c),u&&_.push("align-items-"+u),d&&_.push("justify-content-"+d),!u&&!d&&a&&_.push("align-items-center","justify-content-center"),g.length&&_.push(...g),_},[e,n,r,c,u,d,a,g]),E=i.useMemo(()=>{let _={};return s&&(_["--bs-columns"]=s.toString()),Object.keys(f).length&&(_={..._,...f}),_},[s,f]);return t(gS,{value:{isCssGrid:!0},children:t(P,{fullHeight:h,classNames:C,style:E,...p})})},ke=o=>{const{columnMinWidth:e=40,columnMinHeight:n=40,columnCount:r=0,fullHeight:s=!1,maxContent:a=!0,overflow:c="auto",style:u={},...d}=o,h=i.useMemo(()=>{let g={};return g["--nitro-grid-column-min-height"]=n+"px",r>1&&(g.gridTemplateColumns=`repeat(auto-fill, minmax(${e}px, 1fr))`),Object.keys(u).length&&(g={...g,...u}),g},[e,n,r,u]);return t(se,{columnCount:r,fullHeight:s,overflow:c,style:h,...d})},w=o=>{const{display:e="flex",column:n=void 0,reverse:r=!1,gap:s=null,center:a=!1,alignSelf:c=null,alignItems:u=null,justifyContent:d=null,classNames:h=[],...g}=o,f=i.useMemo(()=>{const p=[];return n?r?p.push("flex-column-reverse"):p.push("flex-column"):r&&p.push("flex-row-reverse"),s&&p.push("gap-"+s),c&&p.push("align-self-"+c),u&&p.push("align-items-"+u),d&&p.push("justify-content-"+d),!u&&!d&&a&&p.push("align-items-center","justify-content-center"),h.length&&p.push(...h),p},[n,r,s,a,c,u,d,h]);return t(P,{display:e,classNames:f,...g})},D=o=>{const{variant:e="primary",size:n="sm",active:r=!1,disabled:s=!1,classNames:a=[],...c}=o,u=i.useMemo(()=>{const d=["btn"];return e&&d.push("btn-"+e),n&&d.push("btn-"+n),r&&d.push("active"),s&&d.push("disabled"),a.length&&d.push(...a),d},[e,n,r,s,a]);return t(w,{center:!0,classNames:u,...c})},nr=o=>{const{classNames:e=[],...n}=o,r=i.useMemo(()=>{const s=["btn-group"];return e.length&&s.push(...e),s},[e]);return t(P,{classNames:r,...n})},re=o=>{const{overflow:e="auto",classNames:n=[],...r}=o,s=i.useMemo(()=>{const a=["container-fluid","content-area"];return n.length&&a.push(...n),a},[n]);return t(T,{classNames:s,overflow:e,...r})},fS=i.createContext({theme:null}),pS=o=>t(fS.Provider,{value:o.value,children:o.children}),IS=o=>{const{headerText:e=null,noCloseButton:n=!1,onCloseClick:r=null,justifyContent:s="center",alignItems:a="center",classNames:c=[],children:u=null,...d}=o,h=i.useMemo(()=>{const f=["drag-handler","container-fluid","nitro-card-header-top-alert"];return c.length&&f.push(...c),f},[c]);return t(T,{center:!0,position:"relative",classNames:h,...d,children:l(w,{fullWidth:!0,center:!0,children:[t("span",{className:"nitro-card-header-top-alert-text",children:e}),t(w,{center:!0,position:"absolute",className:"end-2",onMouseDownCapture:f=>{f.stopPropagation(),f.nativeEvent.stopImmediatePropagation()},onClick:r,style:{cursor:"pointer"},children:t(hn,{className:"fa-icon w-12 h-12"})})]})})},ie=o=>{const{headerText:e=null,isGalleryPhoto:n=!1,noCloseButton:r=!1,onReportPhoto:s=null,onCloseClick:a=null,justifyContent:c="center",alignItems:u="center",classNames:d=[],children:h=null,...g}=o,f=i.useMemo(()=>{const C=["drag-handler","container-fluid","nitro-card-header"];return d.length&&C.push(...d),C},[d]);return t(T,{center:!0,position:"relative",classNames:f,...g,children:l(w,{fullWidth:!0,center:!0,children:[t("span",{className:"nitro-card-header-text",children:e}),n&&t(P,{position:"absolute",className:"end-4 nitro-card-header-report-camera",onClick:s,children:t(Xm,{className:"fa-icon"})}),t(w,{center:!0,position:"absolute",className:"end-2 nitro-card-header-close",onMouseDownCapture:C=>{C.stopPropagation(),C.nativeEvent.stopImmediatePropagation()},onClick:a,children:t(hn,{className:"fa-icon w-12 h-12"})})]})})},qd=o=>{const{justifyContent:e="center",classNames:n=[],variant:r="muted",...s}=o,a=i.useMemo(()=>{const c=["container-fluid","p-1"];return n.length&&c.push(...n),c.push("bg-"+r),c},[n,r]);return t(w,{justifyContent:e,classNames:a,...s})};class Rt{}Rt.CENTER="DWP_CENTER";Rt.TOP_CENTER="DWP_TOP_CENTER";Rt.TOP_LEFT="DWP_TOP_LEFT";Rt.NOTHING="DWP_NOTHING";const dr=[],uc=0,dc=0,Ar=o=>{const{uniqueKey:e=null,handleSelector:n=".drag-handler",windowPosition:r=Rt.CENTER,disableDrag:s=!1,dragStyle:a={},children:c=null,offsetLeft:u=0,offsetTop:d=0}=o,[h,g]=i.useState(null),[f,p]=i.useState(null),[C,E]=i.useState({x:0,y:0}),[_,I]=i.useState(!1),[b,N]=i.useState(null),v=i.useRef(),O=i.useCallback(()=>{let H=400;for(const te of dr)H+=1,te.style.zIndex=H.toString()},[]),R=i.useCallback(()=>{const H=dr.indexOf(v.current);if(H===-1)dr.push(v.current);else{if(H===dr.length-1)return;H>=0&&(dr.splice(H,1),dr.push(v.current))}O()},[O]),y=i.useCallback(H=>{R()},[R]),G=i.useCallback(H=>{R()},[R]),k=i.useCallback((H,te)=>{E({x:H,y:te}),I(!0)},[]),B=i.useCallback(H=>{k(H.clientX,H.clientY)},[k]),M=i.useCallback(H=>{const te=H.touches[0];k(te.clientX,te.clientY)},[k]),U=i.useCallback(H=>{g({x:H.clientX-C.x,y:H.clientY-C.y})},[C]),W=i.useCallback(H=>{const te=H.touches[0];g({x:te.clientX-C.x,y:te.clientY-C.y})},[C]),L=i.useCallback(()=>{if(!v.current||!b)return;let H=f.x+h.x,te=f.y+h.y;const ne=v.current.offsetLeft+H,Ce=v.current.offsetTop+te;if(Ce<uc?te=-v.current.offsetTop:Ce+b.offsetHeight>=document.body.offsetHeight-uc&&(te=document.body.offsetHeight-v.current.offsetHeight-v.current.offsetTop),ne+v.current.offsetWidth<dc?H=-v.current.offsetLeft:ne>=document.body.offsetWidth-dc&&(H=document.body.offsetWidth-v.current.offsetWidth-v.current.offsetLeft),g({x:0,y:0}),p({x:H,y:te}),I(!1),e!==null){const Me={...Xa(`nitro.windows.${e}`)};Me.offset={x:H,y:te},Td(`nitro.windows.${e}`,Me)}},[b,h,f,e]),x=i.useCallback(H=>{L()},[L]),j=i.useCallback(H=>{L()},[L]);return i.useEffect(()=>{const H=v.current;if(!H)return;if(dr.push(H),O(),!s){const Ce=H.querySelector(n);Ce&&N(Ce)}let te=0,ne=0;switch(r){case Rt.TOP_CENTER:H.style.top=50+d+"px",H.style.left=`calc(50vw - ${H.offsetWidth/2+u}px)`;break;case Rt.CENTER:H.style.top=`calc(50vh - ${H.offsetHeight/2+d}px)`,H.style.left=`calc(50vw - ${H.offsetWidth/2+u}px)`;break;case Rt.TOP_LEFT:H.style.top=50+d+"px",H.style.left=50+u+"px";break}return g({x:0,y:0}),p({x:te,y:ne}),()=>{const Ce=dr.indexOf(H);Ce>=0&&dr.splice(Ce,1)}},[n,r,e,s,u,d,O]),i.useEffect(()=>{if(!f&&!h)return;const H=v.current;H&&(H.style.transform=`translate(${f.x+h.x}px, ${f.y+h.y}px)`,H.style.visibility="visible")},[f,h]),i.useEffect(()=>{if(b)return b.addEventListener(Re.MOUSE_DOWN,B),b.addEventListener(In.TOUCH_START,M),()=>{b.removeEventListener(Re.MOUSE_DOWN,B),b.removeEventListener(In.TOUCH_START,M)}},[b,B,M]),i.useEffect(()=>{if(_)return document.addEventListener(Re.MOUSE_UP,x),document.addEventListener(In.TOUCH_END,j),document.addEventListener(Re.MOUSE_MOVE,U),document.addEventListener(In.TOUCH_MOVE,W),()=>{document.removeEventListener(Re.MOUSE_UP,x),document.removeEventListener(In.TOUCH_END,j),document.removeEventListener(Re.MOUSE_MOVE,U),document.removeEventListener(In.TOUCH_MOVE,W)}},[_,x,U,j,W]),i.useEffect(()=>{if(!e)return;const H=Xa(`nitro.windows.${e}`);!H||!H.offset||(g({x:0,y:0}),H.offset&&p(H.offset))},[e]),Vi.createPortal(t(P,{position:"absolute",innerRef:v,className:"draggable-window",onMouseDownCapture:y,onTouchStartCapture:G,style:a,children:c}),document.getElementById("draggable-windows-container"))},oe=o=>{const{theme:e="primary",uniqueKey:n=null,handleSelector:r=".drag-handler",windowPosition:s=Rt.CENTER,disableDrag:a=!1,overflow:c="hidden",position:u="relative",gap:d=0,classNames:h=[],...g}=o,f=i.useRef(),p=i.useMemo(()=>{const C=["nitro-card","rounded","shadow"];return C.push(`theme-${e||"primary"}`),h.length&&C.push(...h),C},[e,h]);return t(pS,{value:{theme:e},children:t(Ar,{uniqueKey:n,handleSelector:r,windowPosition:s,disableDrag:a,children:t(T,{innerRef:f,overflow:c,position:u,gap:d,classNames:p,...g})})})},zd=i.createContext({closers:null,setClosers:null,closeAll:null}),ES=o=>t(zd.Provider,{...o}),CS=()=>i.useContext(zd),no=o=>{const{alignItems:e="center",gap:n=1,children:r=null,...s}=o;return t(w,{alignItems:e,gap:n,...s,children:r})},ro=o=>{const{headerText:e="",isExpanded:n=!1,gap:r=0,classNames:s=[],children:a=null,...c}=o,[u,d]=i.useState(!1),{setClosers:h=null,closeAll:g=null}=CS(),f=()=>{g(),d(E=>!E)},p=i.useCallback(()=>d(!1),[]),C=i.useMemo(()=>{const E=["nitro-card-accordion-set"];return u&&E.push("active"),s&&s.length&&E.push(...s),E},[u,s]);return i.useEffect(()=>{d(n)},[n]),i.useEffect(()=>{const E=p;return h(_=>{const I=[..._];return I.push(E),I}),()=>{h(_=>{const I=[..._],b=I.indexOf(E);return b>=0&&I.splice(b,1),I})}},[p,h]),l(T,{classNames:C,gap:r,...c,children:[l(w,{pointer:!0,justifyContent:"between",className:"nitro-card-accordion-set-header px-2 py-1",onClick:f,children:[t(S,{children:e}),u&&t(Hi,{className:"fa-icon"}),!u&&t(Wi,{className:"fa-icon"})]}),u&&t(T,{fullHeight:!0,overflow:"auto",gap:0,className:"nitro-card-accordion-set-content",children:a})]})},_S=o=>{const{...e}=o,[n,r]=i.useState([]),s=i.useCallback(()=>{for(const a of n)a()},[n]);return t(ES,{value:{closers:n,setClosers:r,closeAll:s},children:t(T,{gap:0,...e})})},ot=o=>{const{figure:e="",gender:n="M",headOnly:r=!1,direction:s=0,scale:a=1,classNames:c=[],style:u={},...d}=o,[h,g]=i.useState(null),[f,p]=i.useState(-1),C=i.useRef(!1),E=i.useMemo(()=>{const I=["avatar-image"];return c.length&&I.push(...c),I},[c]),_=i.useMemo(()=>{let I={};return h&&h.length&&(I.backgroundImage=`url('${h}')`),a!==1&&(I.transform=`scale(${a})`,a%1||(I.imageRendering="pixelated")),Object.keys(u).length&&(I={...I,...u}),I},[h,a,u]);return i.useEffect(()=>{const I=Nt().createAvatarImage(e,Yi.LARGE,n,{resetFigure:v=>{C.current||p(Math.random())},dispose:()=>{},disposed:!1},null);if(!I)return;let b=Ya.FULL;r&&(b=Ya.HEAD),I.setDirection(b,s);const N=I.getCroppedImage(b);N&&g(N.src),I.dispose()},[e,n,s,r,f]),i.useEffect(()=>(C.current=!1,()=>{C.current=!0}),[]),t(P,{classNames:E,style:_,...d})},Yd=o=>{const{imageUrl:e=null,fit:n=!0,style:r=null,...s}=o,a=i.useMemo(()=>{const c={...r};return e&&(c.background=`url(${e}) center no-repeat`),c},[r,e]);return t(P,{fit:n,style:a,...s})},qe=o=>{const{badgeCode:e=null,isGroup:n=!1,showInfo:r=!1,customTitle:s=null,isGrayscale:a=!1,scale:c=1,classNames:u=[],style:d={},children:h=null,...g}=o,[f,p]=i.useState(null),C=i.useMemo(()=>{const _=["badge-image"];return n&&_.push("group-badge"),a&&_.push("grayscale"),u.length&&_.push(...u),_},[u,n,a]),E=i.useMemo(()=>{let _={};return f&&(_.backgroundImage=`url(${n?f.src:K("badge.asset.url").replace("%badgename%",e.toString())})`,_.width=f.width,_.height=f.height,c!==1&&(_.transform=`scale(${c})`,c%1||(_.imageRendering="pixelated"),_.width=f.width*c,_.height=f.height*c)),Object.keys(d).length&&(_={..._,...d}),_},[f,c,d]);return i.useEffect(()=>{if(!e||!e.length)return;let _=!1;const I=N=>{if(N.badgeId!==e)return;const v=rr.generateImage(new za(N.image));v.onload=()=>p(v),_=!0,q().events.removeEventListener(Uo.IMAGE_READY,I)};q().events.addEventListener(Uo.IMAGE_READY,I);const b=n?q().getGroupBadgeImage(e):q().getBadgeImage(e);if(b&&!_){const N=rr.generateImage(new za(b));N.onload=()=>p(N)}return()=>q().events.removeEventListener(Uo.IMAGE_READY,I)},[e,n]),l(P,{classNames:C,style:E,...g,children:[r&&K("badge.descriptions.enabled",!0)&&l(P,{className:"badge-information text-black py-1 px-2 small",children:[t("div",{className:"fw-bold mb-1",children:n?s:sa(e)}),t("div",{children:n?m("group.badgepopup.body"):el(e)})]}),h]})},bS=o=>{const{day:e="00",hour:n="00",minutes:r="00",seconds:s="00",classNames:a=[],children:c=null,...u}=o,d=i.useMemo(()=>{const h=["nitro-counter-time"];return a.length&&h.push(...a),h},[a]);return l(w,{gap:1,children:[t(P,{classNames:d,...u,children:l("div",{children:[e!="00"?e:n,e!="00"?m("countdown_clock_unit_days"):m("countdown_clock_unit_hours")]})}),t(P,{style:{marginTop:"3px"},children:":"}),t(P,{classNames:d,...u,children:l("div",{children:[r,m("countdown_clock_unit_minutes")]})}),t(P,{style:{marginTop:"3px"},children:":"}),t(P,{classNames:d,...u,children:l("div",{children:[s,m("countdown_clock_unit_seconds")]})}),c]})},at=o=>{const{type:e="",classNames:n=[],style:r={},...s}=o,a=i.useMemo(()=>{const d=["nitro-currency-icon"];return n.length&&d.push(...n),d},[n]),c=i.useMemo(()=>{let d=K("currency.asset.icon.url","");return d=d.replace("%type%",e.toString()),`url(${d})`},[e]),u=i.useMemo(()=>{let d={};return d.backgroundImage=c,Object.keys(r).length&&(d={...d,...r}),d},[r,c]);return t(P,{classNames:a,style:u,...s})},il=o=>{const{productType:e="s",productClassId:n=-1,direction:r=2,extraData:s="",scale:a=1,style:c={},...u}=o,[d,h]=i.useState(null),g=i.useMemo(()=>{var p;let f={};return(p=d==null?void 0:d.src)!=null&&p.length&&(f.backgroundImage=`url('${d.src}')`,f.width=d.width,f.height=d.height),a!==1&&(f.transform=`scale(${a})`,a%1||(f.imageRendering="pixelated")),Object.keys(c).length&&(f={...f,...c}),f},[d,a,c]);return i.useEffect(()=>{let f=null;const p={imageReady:(C,E,_)=>{!_&&E&&(_=rr.generateImage(E)),_.onload=()=>h(_)},imageFailed:null};switch(e.toLocaleLowerCase()){case de.FLOOR:f=$().getFurnitureFloorImage(n,new wt(r),64,p,0,s);break;case de.WALL:f=$().getFurnitureWallImage(n,new wt(r),64,p,0,s);break}if(f){const C=f.getImage();C.onload=()=>h(C)}},[e,n,r,s]),d?t(P,{classNames:["furni-image"],style:g,...u}):null},$d=o=>{const{figure:e=null,userName:n=null,message:r=null,editable:s=!1,onChange:a=null}=o;return l(w,{overflow:"hidden",className:"nitro-gift-card text-black",children:[l("div",{className:"d-flex align-items-center justify-content-center gift-face flex-shrink-0",children:[!n&&t("div",{className:"gift-incognito"}),e&&t("div",{className:"gift-avatar",children:t(ot,{figure:e,direction:2,headOnly:!0})})]}),t(w,{overflow:"hidden",className:"w-100 pt-4 pb-4 pe-4 ps-3",children:l(T,{grow:!0,overflow:"auto",justifyContent:"between",children:[!s&&t(S,{textBreak:!0,className:"gift-message",children:r}),s&&a!==null&&t("textarea",{className:"gift-message h-100",maxLength:140,value:r,onChange:c=>a(c.target.value),placeholder:m("catalog.gift_wrapping_new.message_hint")}),n&&t(S,{italics:!0,textEnd:!0,className:"pe-1",children:m("catalog.gift_wrapping_new.message_from",["name"],[n])})]})})]})},T=o=>{const{size:e=0,offset:n=0,column:r=!0,gap:s=2,classNames:a=[],...c}=o,{isCssGrid:u=!1}=hS(),d=i.useMemo(()=>{const h=[];if(e){let g=`col-${e}`;u&&(g=`g-${g}`),h.push(g)}if(n){let g=`offset-${n}`;u&&(g=`g-start-${n}`),h.push(g)}return a.length&&h.push(...a),h},[e,n,u,a]);return t(w,{classNames:d,column:r,gap:s,...c})},wr=o=>{const{count:e=0,position:n="absolute",classNames:r=[],children:s=null,...a}=o,c=i.useMemo(()=>{const u=["badge","border","border-black","bg-danger","px-1","nitro-item-count"];return r.length&&u.push(...r),u},[r]);return l(P,{position:"absolute",classNames:c,...a,children:[e,s]})},Qs=o=>{const{value:e=0}=o,n=e.toString().split("");return t(V,{children:n.map((r,s)=>t("i",{className:"limited-edition-number n-"+r},s))})},Kd=o=>{const{uniqueNumber:e=0,uniqueSeries:n=0,classNames:r=[],children:s=null,...a}=o,c=i.useMemo(()=>{const u=["unique-compact-plate","z-index-1"];return r.length&&u.push(...r),u},[r]);return l(P,{classNames:c,...a,children:[t("div",{children:t(Qs,{value:e})}),t("div",{children:t(Qs,{value:n})}),s]})},SS=o=>{const{uniqueLimitedItemsLeft:e=0,uniqueLimitedSeriesSize:n=0,classNames:r=[],...s}=o,a=i.useMemo(()=>{const c=["unique-complete-plate"];return r.length&&c.push(...r),c},[r]);return t(P,{classNames:a,...s,children:l(T,{className:"plate-container",gap:0,children:[l(w,{justifyContent:"between",alignItems:"center",children:[m("unique.items.left"),t("div",{children:t(Qs,{value:e})})]}),l(w,{justifyContent:"between",alignItems:"center",children:[m("unique.items.number.sold"),t("div",{children:t(Qs,{value:n})})]})]})})},Ie=o=>{const{itemImage:e=void 0,itemColor:n=void 0,itemActive:r=!1,itemCount:s=1,itemCountMinimum:a=1,itemUniqueSoldout:c=!1,itemUniqueNumber:u=-2,itemUnseen:d=!1,itemHighlight:h=!1,disabled:g=!1,center:f=!0,column:p=!0,style:C={},classNames:E=[],position:_="relative",overflow:I="hidden",children:b=null,...N}=o,v=i.useMemo(()=>{const R=["layout-grid-item","border","border-2","border-muted","rounded"];return r&&R.push("active"),(c||u>0)&&R.push("unique-item"),c&&R.push("sold-out"),d&&R.push("unseen"),h&&R.push("has-highlight"),g&&R.push("disabled"),e===null&&R.push("icon","loading-icon"),E.length&&R.push(...E),R},[r,c,u,d,h,g,e,E]),O=i.useMemo(()=>{let R={...C};return e&&!(c||u>0)&&(R.backgroundImage=`url(${e})`),n&&(R.backgroundColor=n),Object.keys(C).length&&(R={...R,...C}),R},[C,e,n,c,u]);return l(T,{center:f,pointer:!0,position:_,overflow:I,column:p,classNames:v,style:O,...N,children:[s>a&&t(wr,{count:s}),u>0&&l(V,{children:[t(P,{fit:!0,className:"unique-bg-override",style:{backgroundImage:`url(${e})`}}),t("div",{className:"position-absolute bottom-0 unique-item-counter",children:t(Qs,{value:u})})]}),b]})},ir=o=>{const{imageUrl:e=null,className:n="",...r}=o;return t("img",{src:e,className:"no-select "+n,alt:"",...r})},ll=o=>{const{...e}=o;return l(P,{classNames:["spinner-container"],...e,children:[t(P,{className:"spinner"}),t(P,{className:"spinner"}),t(P,{className:"spinner"})]})},NS=o=>{const{roomId:e=-1,textureReceiver:n=null,onClose:r=null}=o,s=i.useRef(),a=()=>{if(!s||!s.current)return null;const u=s.current.getBoundingClientRect();return new Ou(Math.floor(u.x),Math.floor(u.y),Math.floor(u.width),Math.floor(u.height))},c=()=>{ar(mn.CAMERA_SHUTTER),n($().createTextureFromRoom(e,1,a()))};return t(Ar,{handleSelector:".nitro-room-thumbnail-camera",children:l("div",{className:"nitro-room-thumbnail-camera px-2",children:[t("div",{ref:s,className:"camera-frame"}),l("div",{className:"d-flex align-items-end h-100 pb-2",children:[t("button",{className:"btn btn-sm btn-danger w-100 mb-1 me-2",onClick:r,children:m("cancel")}),t("button",{className:"btn btn-sm btn-success w-100 mb-1",onClick:c,children:m("navigator.thumbeditor.save")})]})]})})},Io=o=>{const{title:e="",onClose:n=null,classNames:r=[],children:s=null,type:a=ue.DEFAULT,...c}=o,u=i.useMemo(()=>{const d=["nitro-alert"];return d.push("nitro-alert-"+a),r.length&&d.push(...r),d},[r,a]);return l(oe,{classNames:u,theme:"primary-slim",...c,children:[t(ie,{headerText:e,onCloseClick:n}),t(re,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-black",gap:0,children:s})]})};class bt{}bt.BOUNCE="bounce";bt.SLIDE_LEFT="slideLeft";bt.SLIDE_RIGHT="slideRight";bt.FLIP_X="flipX";bt.FADE_IN="fadeIn";bt.FADE_DOWN="fadeDown";bt.FADE_UP="fadeUp";bt.HEAD_SHAKE="headShake";function TS(o,e,n=300){switch(o){case bt.BOUNCE:switch(e){default:return{};case Sr:return{animationName:"bounceIn",animationDuration:`${n}ms`};case xr:return{animationName:"bounceOut",animationDuration:`${n}ms`}}case bt.SLIDE_LEFT:switch(e){default:return{};case Sr:return{animationName:"slideInLeft",animationDuration:`${n}ms`};case xr:return{animationName:"slideOutLeft",animationDuration:`${n}ms`}}case bt.SLIDE_RIGHT:switch(e){default:return{};case Sr:return{animationName:"slideInRight",animationDuration:`${n}ms`};case xr:return{animationName:"slideOutRight",animationDuration:`${n}ms`}}case bt.FLIP_X:switch(e){default:return{};case Sr:return{animationName:"flipInX",animationDuration:`${n}ms`};case xr:return{animationName:"flipOutX",animationDuration:`${n}ms`}}case bt.FADE_UP:switch(e){default:return{};case Sr:return{animationName:"fadeInUp",animationDuration:`${n}ms`};case xr:return{animationName:"fadeOutDown",animationDuration:`${n}ms`}}case bt.FADE_IN:switch(e){default:return{};case Sr:return{animationName:"fadeIn",animationDuration:`${n}ms`};case xr:return{animationName:"fadeOut",animationDuration:`${n}ms`}}case bt.FADE_DOWN:switch(e){default:return{};case Sr:return{animationName:"fadeInDown",animationDuration:`${n}ms`};case xr:return{animationName:"fadeOutUp",animationDuration:`${n}ms`}}case bt.HEAD_SHAKE:switch(e){default:return{};case Sr:return{animationName:"headShake",animationDuration:`${n}ms`}}}return null}const Rs=o=>{const{type:e=null,inProp:n=!1,timeout:r=300,className:s=null,children:a=null}=o,[c,u]=i.useState(!1),d=i.useRef(null);return i.useEffect(()=>{let h=null;return n?u(!0):h=setTimeout(()=>{u(!1),clearTimeout(r)},r),()=>{h&&clearTimeout(h)}},[n,r]),t(Qm,{in:n,timeout:r,nodeRef:d,children:h=>t("div",{ref:d,className:(s??"")+" animate__animated",style:{...TS(e,h,r)},children:c&&a})})},cl=o=>{const{fadesOut:e=!0,timeoutMs:n=8e3,onClose:r=null,overflow:s="hidden",classNames:a=[],...c}=o,[u,d]=i.useState(!1),h=i.useMemo(()=>{const g=["nitro-notification-bubble","rounded"];return a.length&&g.push(...a),g},[a]);return i.useEffect(()=>(d(!0),()=>d(!1)),[]),i.useEffect(()=>{if(!e)return;const g=setTimeout(()=>{d(!1),setTimeout(()=>r(),300)},n);return()=>clearTimeout(g)},[e,n,r]),t(Rs,{type:bt.FADE_IN,inProp:u,timeout:300,children:t(w,{overflow:s,classNames:h,onClick:r,...c})})},tr=o=>{const{figure:e="",typeId:n=-1,paletteId:r=-1,petColor:s=16777215,customParts:a=[],posture:c="std",headOnly:u=!1,direction:d=0,scale:h=1,style:g={},...f}=o,[p,C]=i.useState(null),[E,_]=i.useState(0),[I,b]=i.useState(0),N=i.useRef(!1),v=i.useMemo(()=>{let O={};return p&&p.length&&(O.backgroundImage=`url(${p})`),h!==1&&(O.transform=`scale(${h})`,h%1||(O.imageRendering="pixelated")),O.width=E,O.height=I,Object.keys(g).length&&(O={...O,...g}),O},[p,h,g,E,I]);return i.useEffect(()=>{let O=n,R=r,y=s,G=a,k=u;if(e&&e.length){const M=new Is(e);O=M.typeId,R=M.paletteId,y=M.color,G=M.customParts}O===16&&(k=!1);const B=$().getRoomObjectPetImage(O,R,y,new wt(d*45),64,{imageReady:(M,U,W)=>{N.current||(W?(C(W.src),_(W.width),b(W.height)):U&&(C(rr.generateImageUrl(U)),_(U.width),b(U.height)))},imageFailed:M=>{}},k,0,G,c);if(B){const M=B.getImage();M&&(C(M.src),_(M.width),b(M.height))}},[e,n,r,s,a,c,u,d]),i.useEffect(()=>(N.current=!1,()=>{N.current=!0}),[]),t(P,{classNames:["pet-image"],style:v,...f})},ul=o=>{const{text:e="",progress:n=0,maxProgress:r=100,position:s="relative",justifyContent:a="center",classNames:c=[],children:u=null,...d}=o,h=i.useMemo(()=>{const g=["nitro-progress-bar","text-white"];return c.length&&g.push(...c),g},[c]);return l(T,{position:s,justifyContent:a,classNames:h,...d,children:[e&&e.length>0&&t(w,{fit:!0,center:!0,position:"absolute",className:"nitro-progress-bar-text small",children:e}),t(P,{className:"nitro-progress-bar-inner",style:{width:~~((n-0)*(100-0)/(r-0)+0)+"%"}}),u]})},dl=o=>{const{level:e=0,classNames:n=[],children:r=null,...s}=o,a=i.useMemo(()=>{const c=["nitro-rarity-level"];return n.length&&c.push(...n),c},[n]);return l(P,{classNames:a,...s,children:[t("div",{children:e}),r]})},Eo=o=>{const{roomPreviewer:e=null,height:n=0,children:r=null}=o,[s,a]=i.useState(null),c=i.useRef(),u=d=>{e&&(d.shiftKey?e.changeRoomObjectDirection():e.changeRoomObjectState())};return i.useEffect(()=>{if(!e)return;const d=g=>{!e||!s||!c.current||(e.updatePreviewRoomView(),s.canvasUpdated&&(c.current.style.backgroundImage=`url(${rr.generateImageUrl(s.master)})`))};if(!s&&c.current&&e){let f=document.defaultView.getComputedStyle(c.current,null).backgroundColor;f=cn.rgbStringToHex(f),f=f.replace("#","0x"),e.backgroundColor=parseInt(f,16);const p=c.current.parentElement.clientWidth;e.getRoomCanvas(p,n);const C=e.getRenderingCanvas();a(C),C.canvasUpdated=!0,d()}Er().add(d);const h=new ResizeObserver(()=>{if(!e||!c.current)return;const g=c.current.parentElement.offsetWidth;e.modifyRoomCanvas(g,n),d()});return h.observe(c.current),()=>{h.disconnect(),Er().remove(d)}},[s,e,c,n]),l("div",{className:"room-preview-container",children:[t("div",{ref:c,className:"room-preview-image",style:{height:n},onClick:u}),r]})},Co=o=>{const{roomId:e=-1,customUrl:n=null,shrink:r=!0,overflow:s="hidden",classNames:a=[],children:c=null,...u}=o,d=i.useMemo(()=>{const g=["room-thumbnail","rounded","border"];return a.length&&g.push(...a),g},[a]),h=i.useMemo(()=>n&&n.length?K("image.library.url")+n:K("thumbnails.url").replace("%thumbnail%",e.toString()),[n,e]);return l(P,{shrink:r,overflow:s,classNames:d,...u,children:[h&&t("img",{alt:"",src:h}),c]})},Xd=o=>{const{color:e="",message:n="",date:r="",senderName:s="",customTitle:a=null,onCloseClick:c=null}=o;return t(Ar,{handleSelector:".drag-handler",children:l(T,{gap:0,alignItems:"center",className:`nitro-layout-trophy trophy-${e}`,children:[l(w,{center:!0,fullWidth:!0,position:"relative",className:"trophy-header drag-handler",children:[t(P,{position:"absolute",pointer:!0,className:"trophy-close",onClick:c}),t(S,{bold:!0,children:m("widget.furni.trophy.title")})]}),l(T,{className:"trophy-content py-1",gap:1,children:[a&&t(S,{bold:!0,children:a}),n]}),l(w,{alignItems:"center",justifyContent:"between",className:"trophy-footer mt-1",children:[t(S,{bold:!0,children:r}),t(S,{bold:!0,children:s})]})]})})},bn=o=>{const{userId:e=0,userName:n=null,classNames:r=[],pointer:s=!0,children:a=null,...c}=o,u=i.useMemo(()=>{const d=["nitro-friends-spritesheet","icon-profile-sm"];return r.length&&d.push(...r),d},[r]);return t(P,{classNames:u,pointer:s,onClick:d=>tn(e),...c,children:a})},Mn=o=>{const{isActive:e=!1,count:n=0,overflow:r="hidden",position:s="relative",pointer:a=!0,classNames:c=[],children:u=null,...d}=o,h=i.useMemo(()=>{const g=["nav-item","rounded-top","border"];return e&&g.push("active"),c.length&&g.push(...c),g},[e,c]);return l(w,{overflow:r,pointer:a,position:s,classNames:h,...d,children:[t(w,{shrink:!0,center:!0,children:u}),n>0&&t(wr,{count:n})]})},lr=o=>{const{justifyContent:e="center",gap:n=1,classNames:r=[],children:s=null,...a}=o,c=i.useMemo(()=>{const u=["container-fluid","nitro-card-tabs","pt-1"];return r.length&&u.push(...r),u},[r]);return t(w,{justifyContent:e,gap:n,classNames:c,...a,children:s})},Gt=(...o)=>o.filter(Boolean).join(" "),vS=o=>{const{classNames:e=[],...n}=o,r=i.useMemo(()=>{const s=["form-group"];return e.length&&s.push(...e),s},[e]);return t(w,{classNames:r,...n})},wS=o=>{const{variant:e="black",height:n=1,classNames:r=[],style:s={},...a}=o,c=i.useMemo(()=>{const d=[];return e&&d.push("bg-"+e),r.length&&d.push(...r),d},[e,r]),u=i.useMemo(()=>{let d={display:"list-item"};return n>0&&(d.height=n),Object.keys(s).length&&(d={...d,...s}),d},[n,s]);return t(P,{classNames:c,style:u,...a})},_o=o=>{var C,E;const{rows:e=[],overscan:n=5,scrollToBottom:r=!1,rowRender:s=null}=o,[a,c]=i.useState(e.length-1),u=i.useRef(null),{virtualItems:d=[],totalSize:h=0,scrollToIndex:g=null}=Jm({parentRef:u,size:e.length,overscan:n}),f=d.length>0&&((C=d==null?void 0:d[0])==null?void 0:C.start)||0,p=d.length>0?h-(((E=d==null?void 0:d[d.length-1])==null?void 0:E.end)||0):0;return i.useEffect(()=>{r&&g(a)},[r,a,g]),l(P,{fit:!0,innerRef:u,position:"relative",overflow:"auto",children:[f>0&&t("div",{style:{minHeight:`${f}px`}}),d.map(_=>{const I=e[_.index];return I?t("div",{"data-index":_.index,ref:_.measureRef,children:s(I)},_.key):t(i.Fragment,{},_.key)}),p>0&&t("div",{style:{minHeight:`${p}px`}})]})},S=o=>{const{variant:e="black",fontWeight:n=null,fontSize:r=0,align:s=null,bold:a=!1,underline:c=!1,italics:u=!1,truncate:d=!1,center:h=!1,textEnd:g=!1,small:f=!1,wrap:p=!1,noWrap:C=!1,textBreak:E=!1,..._}=o,I=i.useMemo(()=>{const b=["d-inline"];return e&&b.push("text-"+e),a&&b.push("fw-bold"),n&&b.push("fw-"+n),r&&b.push("fs-"+r),s&&b.push("text-"+s),c&&b.push("text-decoration-underline"),u&&b.push("fst-italic"),d&&b.push("text-truncate"),h&&b.push("text-center"),g&&b.push("text-end"),f&&b.push("small"),p&&b.push("text-wrap"),C&&b.push("text-nowrap"),E&&b.push("text-break"),b},[e,n,r,s,a,c,u,d,h,g,f,p,C,E]);return t(P,{classNames:I,..._})},RS=o=>{const{isError:e=!1,message:n="",percent:r=0}=o;return t(T,{fullHeight:!0,position:"relative",className:"nitro-loading",children:t(P,{fullHeight:!0,className:"container h-100",children:l(T,{fullHeight:!0,alignItems:"center",justifyContent:"end",children:[t(P,{className:"connecting-duck"}),t(T,{size:6,className:"text-center py-4",children:e&&n&&n.length?t(P,{className:"fs-4 text-shadow",children:n}):l(V,{children:[l(S,{fontSize:4,variant:"white",className:"text-shadow",children:[r.toFixed(),"%"]}),t(ul,{progress:r,className:"mt-2 large"})]})})]})})})},Cr=(o,e,n,r=!0)=>{i.useEffect(()=>{if(r)return Array.isArray(o)?o.map(s=>e.addEventListener(s,n)):e.addEventListener(o,n),()=>{Array.isArray(o)?o.map(s=>e.removeEventListener(s,n)):e.removeEventListener(o,n)}},[o,e,r,n])},mc=(o,e)=>Cr(o,Q_().events,e),yS=(o,e)=>Cr(o,_e().cameraManager.events,e),OS=(o,e)=>Cr(o,_e().localization.events,e),Br=(o,e)=>Cr(o,_e().events,e),Te=(o,e)=>Cr(o,$().events,e),Ye=(o,e)=>Cr(o,Qr().events,e),kS=(o,e)=>Cr(o,q().events,e),Wr=(o,e,n=!0)=>Cr(o,_e().soundManager.events,e,n),F=(o,e)=>{i.useEffect(()=>{const n=new o(e);return zs().registerMessageEvent(n),()=>zs().removeMessageEvent(n)},[o,e])},lt=(o,e,n=!0)=>Cr(o,sr,e,n),AS=()=>{const[o,e]=i.useState(!0),[n,r]=i.useState([]),[s,a]=i.useState(null),[c,u]=i.useState(-1),[d,h]=i.useState(0),g=i.useMemo(()=>{let b=0;return n.forEach(N=>b+=un.getAchievementCategoryTotalUnseen(N)),b},[n]),f=i.useMemo(()=>{let b=0;return n.forEach(N=>b+=N.getProgress()),b},[n]),p=i.useMemo(()=>{let b=0;return n.forEach(N=>b+=N.getMaxProgress()),b},[n]),C=i.useMemo(()=>~~((f-0)*(100-0)/(p-0)+0),[f,p]),E=i.useMemo(()=>s===null?null:n.find(b=>b.code===s),[n,s]),_=i.useMemo(()=>c===-1||!E?null:E.achievements.find(b=>b.achievementId===c),[E,c]),I=i.useCallback((b,N)=>{r(v=>{const O=[...v];for(const R of O)if(R.code===b)for(const y of R.achievements)y.achievementId===N&&(y.unseen=0);return O})},[]);return F(Mg,b=>{const v=b.getParser().achievement;r(O=>{const R=[...O],y=R.findIndex(G=>G.code===v.category);if(y===-1){const G=new Kl(v.category);G.achievements.push(v),R.push(G)}else{const G=Kt(R[y]),k=[...G.achievements],B=k.findIndex(U=>U.achievementId===v.achievementId);let M=null;B===-1?k.push(v):(M=k[B],k[B]=v),un.getAchievementIsIgnored(v)||(v.unseen++,M&&(v.unseen+=M.unseen)),G.achievements=k,R[y]=G}return R})}),F(Lg,b=>{const N=b.getParser(),v=[];for(const O of N.achievements){const R=O.category;let y=v.find(G=>G.code===R);y||(y=new Kl(R),v.push(y)),y.achievements.push(O)}r(v)}),F(Ug,b=>{const N=b.getParser();h(N.score)}),i.useEffect(()=>{o&&(A(new xg),e(!1))},[o]),i.useEffect(()=>{!s||c===-1||I(s,c)},[s,c,I]),{achievementCategories:n,selectedCategoryCode:s,setSelectedCategoryCode:a,selectedAchievementId:c,setSelectedAchievementId:u,achievementScore:d,getTotalUnseen:g,getProgress:f,getMaxProgress:p,scaledProgressPercent:C,selectedCategory:E,selectedAchievement:_,setAchievementSeen:I}},bo=()=>ct(AS),PS=()=>{const[o,e]=i.useState([]),[n,r]=i.useState([]),[s,a]=i.useState(-1),[c,u]=i.useState(10),[d,h]=i.useState(null);return yS(Gg.INITIALIZED,g=>{e(Array.from(xs().effects.values()))}),F(Fg,g=>{const f=g.getParser();h({credits:f.creditPrice,duckets:f.ducketPrice,publishDucketPrice:f.publishDucketPrice})}),i.useEffect(()=>{if(!xs().isLoaded){xs().init(),A(new Bg);return}},[]),{availableEffects:o,cameraRoll:n,setCameraRoll:r,selectedPictureIndex:s,setSelectedPictureIndex:a,myLevel:c,price:d}},Qd=()=>ct(PS);class gn extends Ln{}gn.SHOW_CATALOG="CE_SHOW_CATALOG";gn.HIDE_CATALOG="CE_HIDE_CATALOG";gn.TOGGLE_CATALOG="CE_TOGGLE_CATALOG";gn.SOLD_OUT="CE_SOLD_OUT";gn.APPROVE_NAME_RESULT="CE_APPROVE_NAME_RESULT";gn.PURCHASE_APPROVED="CE_PURCHASE_APPROVED";gn.INIT_GIFT="CE_INIT_GIFT";gn.CATALOG_RESET="CE_RESET";gn.CATALOG_INVISIBLE_PAGE_VISITED="CE_CATALOG_INVISIBLE_PAGE_VISITED";class DS extends gn{constructor(e,n,r){super(gn.INIT_GIFT),this._pageId=e,this._offerId=n,this._extraData=r}get pageId(){return this._pageId}get offerId(){return this._offerId}get extraData(){return this._extraData}}const Jd=class Zd extends gn{constructor(e){super(Zd.POST_MARKETPLACE),this._item=e}get item(){return this._item}};Jd.POST_MARKETPLACE="CE_POST_MARKETPLACE";let em=Jd;const tm=class nm extends Ln{constructor(e){super(nm.PURCHASE_SUCCESS),this._purchase=e}get purchase(){return this._purchase}};tm.PURCHASE_SUCCESS="CPE_PURCHASE_SUCCESS";let yr=tm;const rm=class sm extends Ln{constructor(e){super(sm.PURCHASE_FAILED),this._code=e}get code(){return this._code}};rm.PURCHASE_FAILED="CPFE_PURCHASE_FAILED";let vs=rm;const am=class om extends Ln{constructor(e){super(om.NOT_ALLOWED),this._code=e}get code(){return this._code}};am.NOT_ALLOWED="CPNAE_NOT_ALLOWED";let Mi=am;class yt extends Ln{}yt.WIDGETS_INITIALIZED="CWE_CWE_WIDGETS_INITIALIZED";yt.SELECT_PRODUCT="CWE_SELECT_PRODUCT";yt.SET_EXTRA_PARM="CWE_CWE_SET_EXTRA_PARM";yt.PURCHASE="CWE_PURCHASE";yt.COLOUR_ARRAY="CWE_COLOUR_ARRAY";yt.MULTI_COLOUR_ARRAY="CWE_MULTI_COLOUR_ARRAY";yt.COLOUR_INDEX="CWE_COLOUR_INDEX";yt.TEXT_INPUT="CWE_TEXT_INPUT";yt.DROPMENU_SELECT="CWE_CWE_DROPMENU_SELECT";yt.PURCHASE_OVERRIDE="CWE_PURCHASE_OVERRIDE";yt.SELLABLE_PET_PALETTES="CWE_SELLABLE_PET_PALETTES";yt.UPDATE_ROOM_PREVIEW="CWE_UPDATE_ROOM_PREVIEW";yt.GUILD_SELECTED="CWE_GUILD_SELECTED";yt.TOTAL_PRICE_WIDGET_INITIALIZED="CWE_TOTAL_PRICE_WIDGET_INITIALIZED";yt.PRODUCT_OFFER_UPDATED="CWE_CWE_PRODUCT_OFFER_UPDATED";yt.SET_PREVIEWER_STUFFDATA="CWE_CWE_SET_PREVIEWER_STUFFDATA";yt.EXTRA_PARAM_REQUIRED_FOR_BUY="CWE_CWE_EXTRA_PARAM_REQUIRED_FOR_BUY";yt.TOGGLE="CWE_CWE_TOGGLE";yt.BUILDER_SUBSCRIPTION_UPDATED="CWE_CWE_BUILDER_SUBSCRIPTION_UPDATED";yt.ROOM_CHANGED="CWE_CWE_ROOM_CHANGED";yt.SHOW_WARNING_TEXT="CWE_CWE_SHOW_WARNING_TEXT";const im=class lm extends Ln{constructor(){super(lm.SOLD_OUT)}};im.SOLD_OUT="CPSOE_SOLD_OUT";let Li=im;const MS=class cm extends Ln{constructor(e,n){super(cm.UPDATE_STUFF_DATA),this._offer=e,this._stuffData=n}get offer(){return this._offer}get stuffData(){return this._stuffData}};MS.UPDATE_STUFF_DATA="SRPSA_UPDATE_STUFF_DATA";class Vt extends Ln{}Vt.SHOW_GUIDE_TOOL="GTE_SHOW_GUIDE_TOOL";Vt.HIDE_GUIDE_TOOL="GTE_HIDE_GUIDE_TOOL";Vt.TOGGLE_GUIDE_TOOL="GTE_TOGGLE_GUIDE_TOOL";Vt.CREATE_HELP_REQUEST="GTE_CREATE_HELP_REQUEST";Vt.CREATE_BULLY_REQUEST="GTE_CREATE_BULLY_REQUEST";class so extends Ln{}so.INIT="HC_NAME_CHANGE_INIT";const um=class dm extends Ln{constructor(e,n,r){super(dm.FURNI_ADDED),this.id=e,this.spriteId=n,this.category=r}};um.FURNI_ADDED="IFAE_FURNI_ADDED";let Ui=um;class Gn extends Ln{}Gn.SHOW_THUMBNAIL="NE_SHOW_THUMBNAIL";Gn.HIDE_THUMBNAIL="NE_HIDE_THUMBNAIL";Gn.TOGGLE_THUMBNAIL="NE_TOGGLE_THUMBNAIL";const Xo=o=>o&&o.length?o.replace(/\\r/g,"\r"):"",gc=o=>{const e="0"+o;return e.substr(e.length-2,e.length)};let Ms=null;const LS=()=>{const[o,e]=i.useState([]),[n,r]=i.useState([]),[s,a]=i.useState([]),[c,u]=i.useState(!1),[d,h]=i.useState(!1),[g,f]=i.useState([]),p=()=>K("notification",{}),C=L=>{const x=p();return x?x[L]:null},E=(L,x,j,H)=>{if(L.has(j))return L.get(j);const te=["notification",x,j].join(".");return _e().localization.hasValue(te)||H?m(te,Array.from(L.keys()),Array.from(L.values())):null},_=(L,x)=>{let j=L.get("image");return j||(j=K("image.library.notifications.url","").replace("%image%",x.replace(/\./g,"_"))),m(j)},I=i.useCallback((L,x=null,j=null,H=null,te=null,ne=null)=>{(!te||!te.length)&&(te=m("notifications.broadcast.title")),(!x||!x.length)&&(x=ue.DEFAULT);const Ce=new Ko([Xo(L)],x,j,H,te,ne);e(Me=>[Ce,...Me])},[]),b=i.useCallback((L,x=null,j=null,H=null,te=null,ne=null)=>{(!te||!te.length)&&(te=m("notifications.broadcast.title")),(!x||!x.length)&&(x=ue.DEFAULT);const Ce=new Ko([Xo(L)],x,j,H,te,ne);f(Me=>[Ce,...Me])},[]),N=i.useCallback(()=>I(null,ue.NITRO),[I]),v=i.useCallback((L,x,j=null,H=null)=>{if(c)return;const te=new Zb(L,x,j,H);r(ne=>[te,...ne])},[c]),O=(L,x=null)=>{x||(x=new Map);const j=C("notification."+L);if(j)for(const Ze in j)x.set(Ze,j[Ze]);L==="floorplan_editor.error"&&x.set("message",x.get("message").replace(/[^a-zA-Z._ ]/g,""));const H=E(x,L,"title",!0),te=E(x,L,"message",!0).replace(/\\r/g,"\r"),ne=E(x,L,"linkTitle",!1),Ce=E(x,L,"linkUrl",!1),Me=_(x,L);x.get("display")==="BUBBLE"?v(m(te),Xe.INFO,Me,Ce):I(m(te),L,Ce,ne,H,Me),x.get("sound")&&ar(x.get("sound"))},R=i.useCallback((L,x,j,H=null,te=null,ne=null,Ce=null)=>{(!H||!H.length)&&(H=m("generic.confirm")),(!te||!te.length)&&(te=m("generic.cancel")),(!ne||!ne.length)&&(ne=m("notifications.broadcast.title"));const Me=new eS(Ce,L,x,j,H,te,ne);a(Ze=>[Me,...Ze])},[]),y=(L,x=null,j=!0)=>{I(L,ue.DEFAULT,x,m("mod.alert.link"),m("mod.alert.title"))},G=i.useCallback((L,x="")=>{switch(L){case _t.ALERT_SCAM:I(m("inventory.trading.warning.other_not_offering"),null,null,null,m("inventory.trading.notification.title"));return;case _t.HOTEL_TRADING_DISABLED:case _t.YOU_NOT_ALLOWED:case _t.THEY_NOT_ALLOWED:case _t.ROOM_DISABLED:case _t.YOU_OPEN:case _t.THEY_OPEN:I(m(`inventory.trading.openfail.${L}`,["otherusername"],[x]),null,null,null,m("inventory.trading.openfail.title"));return;case _t.ERROR_WHILE_COMMIT:I(`${m("inventory.trading.notification.caption")}, ${m("inventory.trading.notification.commiterror.info")}`,null,null,null,m("inventory.trading.notification.title"));return;case _t.THEY_CANCELLED:I(m("inventory.trading.info.closed"),null,null,null,m("inventory.trading.notification.title"));return}},[I]),k=i.useCallback(L=>{e(x=>{const j=[...x],H=j.findIndex(te=>L===te);return H>=0&&j.splice(H,1),j})},[]),B=i.useCallback(L=>{f(x=>{const j=[...x],H=j.findIndex(te=>L===te);return H>=0&&j.splice(H,1),j})},[]),M=i.useCallback(L=>{r(x=>{const j=[...x],H=j.findIndex(te=>L===te);return H>=0&&j.splice(H,1),j})},[]),U=i.useCallback(L=>{a(x=>{const j=[...x],H=j.findIndex(te=>L===te);return H>=0&&j.splice(H,1),j})},[]);F(Vg,L=>{const x=L.getParser();if(x.userId!==q().userId)return;const j=m("notifications.text.respect.1"),H=m("notifications.text.respect.2",["count"],[x.respectsReceived.toString()]);v(j,Xe.RESPECT),v(H,Xe.RESPECT)}),F(Hg,L=>{const x=L.getParser();I(x.message.replace(/\\r/g,"\r"),null,null,m("notifications.broadcast.title"))}),F(Wg,L=>{const x=L.getParser(),j=x.link.length!=0?x.link:null,H=x.image.length!=0?K("image.library.notifications.url","").replace("%image%",x.image.replace(/\./g,"_")):null;b(x.message,ue.ALERT_TOP,j,null,null,H)}),F(jg,L=>{const x=L.getParser(),j=m("achievements.levelup.desc"),H=sa(x.data.badgeCode),te=q().getBadgeUrl(x.data.badgeCode),ne="questengine/achievements/"+x.data.category;v(j+" "+H,Xe.ACHIEVEMENT,te,ne)}),F(qg,L=>{const x=L.getParser();x.numGifts<=0||v(x.numGifts.toString(),Xe.CLUBGIFT,null,"catalog/open/"+K("catalog.links")["hc.hc_gifts"])}),F(zg,L=>{const x=L.getParser();y(x.message,x.url,!1)}),F(ku,L=>{const x=L.getParser();if(x.amountChanged<=0||x.type!==5)return;const j=K("currency.asset.icon.url","").replace("%type%",x.type.toString());v(m("notifications.text.loyalty.received",["AMOUNT"],[x.amountChanged.toString()]),Xe.INFO,j)}),F(Yg,L=>{const x=L.getParser();y(x.message)}),F($g,L=>{const x=L.getParser();I(m("opening.hours."+(x.userThrowOutAtClose?"disconnected":"closed"),["h","m"],[gc(x.openHour),gc(x.openMinute)]),ue.DEFAULT,null,null,m("opening.hours.title"))}),F(Kg,L=>{const x=L.getParser(),j=m("notifications.text."+(x.boughtAsGift?"petbought":"petreceived"));let H=null;const te=$().getRoomObjectPetImage(x.pet.typeId,x.pet.paletteId,parseInt(x.pet.color,16),new wt(45*3),64,null,!0);te&&(H=te.getImage().src),v(j,Xe.PETLEVEL,H)}),F(Xg,L=>{const j=L.getParser().messages.map(te=>Xo(te)),H=new Ko(j,ue.MOTD,null,null,m("notifications.motd.title"));e(te=>[H,...te])}),F(Qg,L=>{const x=L.getParser();let j=null;const H=$().getRoomObjectPetImage(x.figureData.typeId,x.figureData.paletteId,parseInt(x.figureData.color,16),new wt(45*3),64,null,!0);H&&(j=H.getImage().src),v(m("notifications.text.petlevel",["pet_name","level"],[x.petName,x.level.toString()]),Xe.PETLEVEL,j)}),F(Jg,L=>{const x=L.getParser();u(!x.enabled)}),F(Zg,L=>{const x=L.getParser();if(!x.products||!x.products.length)return;const j=x.products[0];j&&v(m("notifications.text.club_gift.selected"),Xe.INFO,ja.getProductImageUrl(j.productType,j.furniClassId,j.extraParam))}),F(eh,L=>{const x=L.getParser();I(m("maintenance.shutdown",["m","d"],[x.minutesUntilMaintenance.toString(),x.duration.toString()]),ue.DEFAULT,null,null,m("opening.hours.title"))}),F(th,L=>{const x=L.getParser();y(x.message,x.url)}),F(nh,L=>{const x=L.getParser();O(x.type,x.parameters)}),F(rh,L=>{const x=L.getParser();I(m("opening.hours.shutdown",["m"],[x.openMinute.toString()]),ue.DEFAULT,null,null,m("opening.hours.title"))}),F(sh,L=>{const x=L.getParser();I(m("opening.hours.disconnected",["h","m"],[x.openHour.toString(),x.openMinute.toString()]),ue.DEFAULT,null,null,m("opening.hours.title"))}),F(ah,L=>{const x=L.getParser();switch(x.errorCode){default:case 0:I(m("connection.server.error.desc",["errorCode"],[x.errorCode.toString()]),ue.ALERT,null,null,m("connection.server.error.title"));break;case 1001:case 1002:case 1003:case 1004:case 1005:case 1006:case 1007:case 1008:case 1009:case 1010:case 1011:case 1012:case 1013:case 1014:case 1015:case 1016:case 1017:case 1018:case 1019:L.connection.dispose();break;case 4013:I(m("connection.room.maintenance.desc"),ue.ALERT,null,null,m("connection.room.maintenance.title"));break}}),F(oh,L=>{const x=L.getParser();I(m(x.alertMessage),ue.DEFAULT,null,null,m(x.titleMessage?x.titleMessage:"notifications.broadcast.title"))});const W=i.useCallback(()=>{if(!d)if(Ci.isRunning()){if(Ms)return;Ms=setTimeout(()=>{W()},Ci.totalRunningTime+5e3)}else Ms&&(clearTimeout(Ms),Ms=null),v(m("mod.chatdisclaimer"),Xe.INFO),h(!0)},[d,v]);return F(ih,W),{alerts:o,bubbleAlerts:n,confirms:s,simpleAlert:I,showNitroAlert:N,showTradeAlert:G,showConfirm:R,showSingleBubble:v,closeAlert:k,closeBubbleAlert:M,closeConfirm:U,alertTops:g,setAlertTops:f,closeAlertTop:B}},Je=()=>ct(LS),US=(o,e)=>{const[n,r]=i.useState(()=>{if(typeof window>"u")return e;try{return Xa(o)??e}catch{return e}});return[n,a=>{try{const c=a instanceof Function?a(n):a;r(c),typeof window<"u"&&Td(o,c)}catch(c){Au.error(c)}}]},So=US,xS=()=>So(aa.CATALOG_PLACE_MULTIPLE_OBJECTS,!1),mm=()=>ct(xS),FS=()=>So(aa.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1),gm=()=>ct(FS),BS=-12345678,GS=()=>{const[o,e]=i.useState(!1),[n,r]=i.useState(!1),[s,a]=i.useState(-1),[c,u]=i.useState(-1),[d,h]=i.useState(kn.NORMAL),[g,f]=i.useState(null),[p,C]=i.useState(null),[E,_]=i.useState(null),[I,b]=i.useState(null),[N,v]=i.useState([]),[O,R]=i.useState(null),[y,G]=i.useState([]),[k,B]=i.useState(null),[M,U]=i.useState(!1),[W,L]=i.useState({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null}),[x,j]=i.useState({}),[H,te]=i.useState(!1),[ne,Ce]=mm(),[Me,Ze]=gm(),[tt,Ft]=i.useState(null),[je,qt]=i.useState(null),[Tn,Ge]=i.useState(0),[Ee,$e]=i.useState(0),[Ot,me]=i.useState(0),[Ae,it]=i.useState(0),[nn,pe]=i.useState(0),[Le,vn]=i.useState(0),{simpleAlert:Dr=null}=Je(),rn=i.useRef(new Ds),ma=i.useCallback(()=>{a(-1),u(-1),f(null),C(null),_(null),b(null),v([]),R(null),G([]),e(!1)},[]),Os=i.useCallback(Y=>{if(!Y)return on.MISSING_OFFER;if(Tn<0||Tn>=Ee)return on.FURNI_LIMIT_REACHED;const X=Oe();if(!X)return on.NOT_IN_ROOM;if(!X.isRoomOwner)return on.NOT_ROOM_OWNER;if(Ae<=0){const J=$();let ce=J.getRoomObjectCount(X.roomId,Q.UNIT);for(;ce>0;){const Pe=J.getRoomObjectByIndex(X.roomId,ce,Q.UNIT),Qe=X.userDataManager.getUserDataByIndex(Pe.id);if(Qe&&Qe.type===pt.USER&&Qe.roomIndex!==X.ownRoomIndex&&!Qe.isModerator)return on.VISITORS_IN_ROOM;ce--}}return on.OKAY},[Tn,Ee,Ae]),Mr=i.useCallback(Y=>{const X=Oe();return!!((X&&Y.page&&Y.page.layoutCode!=="sold_ltd_items"&&d===kn.NORMAL&&(X.isRoomOwner||X.isGuildRoom&&X.controllerLevel>=nt.GUILD_MEMBER)||d===kn.BUILDER&&Os(Y)===on.OKAY)&&Y.pricingModel!==zt.PRICING_MODEL_BUNDLE&&Y.product.productType!==de.EFFECT&&Y.product.productType!==de.HABBO_CLUB)},[d,Os]),Lr=i.useCallback(Y=>{if(!Mr(Y))return;const X=Y.product;if(!X)return;let J=0;switch(X.productType){case de.FLOOR:J=Q.FLOOR;break;case de.WALL:J=Q.WALL;break}$().processRoomObjectPlacement(Vs.CATALOG,-Y.offerId,J,X.productClassId,X.extraParam)&&(Ft(Y),te(!0),e(!1))},[Mr]),ts=i.useCallback((Y,X)=>{const J=$();let ce=J.getRoomInstanceVariable(J.activeRoomId,ae.ROOM_WALL_TYPE),Pe=J.getRoomInstanceVariable(J.activeRoomId,ae.ROOM_FLOOR_TYPE),Qe=J.getRoomInstanceVariable(J.activeRoomId,ae.ROOM_LANDSCAPE_TYPE);switch(ce=ce&&ce.length?ce:"101",Pe=Pe&&Pe.length?Pe:"101",Qe=Qe&&Qe.length?Qe:"1.1",Y){case"floor":J.updateRoomInstancePlaneType(J.activeRoomId,X,ce,Qe,!0);return;case"wallpaper":J.updateRoomInstancePlaneType(J.activeRoomId,Pe,X,Qe,!0);return;case"landscape":J.updateRoomInstancePlaneType(J.activeRoomId,Pe,ce,X,!0);return;default:J.updateRoomInstancePlaneType(J.activeRoomId,Pe,ce,Qe,!0);return}},[]),ks=i.useCallback(()=>{tt&&($().cancelRoomObjectInsert(),te(!1),Ft(null))},[tt]),br=i.useCallback((Y=!0)=>{te(X=>(X&&Y&&ee("catalog/open"),!1))},[]),Ur=i.useCallback((Y=!1)=>{Y||br(),qt(X=>{if(X)switch(X.category){case Q.FLOOR:$().removeRoomObjectFloor(X.roomId,X.objectId);break;case Q.WALL:{switch(X.furniData.className){case"floor":case"wallpaper":case"landscape":ts("reset","");break;default:$().removeRoomObjectWall(X.roomId,X.objectId);break}break}default:$().deleteRoomObject(X.objectId,X.category);break}return null})},[br,ts]),Bt=i.useCallback((Y,X)=>{if(X.pageId===Y&&X!==g)return X;for(const J of X.children){const ce=Bt(Y,J);if(ce)return ce}return null},[g]),Kn=i.useCallback((Y,X)=>{if(X.pageName===Y&&X!==g)return X;for(const J of X.children){const ce=Kn(Y,J);if(ce)return ce}return null},[g]),ns=i.useCallback((Y,X=!1)=>{if(!p||!p.size)return null;if(X){const J=[],ce=p.get(Y);if(ce&&ce.length)for(const Pe of ce)Pe.isVisible&&J.push(Pe);if(J.length)return J}return p.get(Y)},[p]),Xn=i.useCallback((Y,X)=>{Y<0||(r(!0),a(Y),Y>-1&&A(new lh(Y,X,d)))},[d]),Km=i.useCallback((Y,X,J,ce,Pe,Qe)=>{const kt=new md(Y,X,J,ce,Qe);if(_(kt),u(be=>Y!==-1?Y:be),U(!1),Pe>-1&&kt.offers.length){for(const be of kt.offers)if(be.offerId===Pe){b(be);break}}},[]),ur=i.useCallback((Y,X=-1)=>{if(ks(),Y.parent.pageName==="root"&&Y.children.length){for(const Pe of Y.children)if(Pe.isVisible){Y=Pe;break}}const J=[];let ce=Y;for(;ce&&ce.pageName!=="root";)J.push(ce),ce=ce.parent;J.reverse(),v(Pe=>{const Qe=Pe.indexOf(Y)>=0,kt=Y.isOpen;for(const be of Pe)be.deactivate(),J.indexOf(be)===-1&&be.close();for(const be of J)be.activate(),be.parent&&be.open(),be===Y.parent&&be.children.length&&be.open();return Qe&&kt?Y.close():Y.open(),J}),Y.pageId>-1&&Xn(Y.pageId,X)},[v,Xn,ks]),As=i.useCallback(Y=>{if(Y!==-1&&R(null),!o)rn.current.requestById=Y,e(!0);else{const X=Bt(Y,g);X&&ur(X)}},[o,g,Bt,ur]),ko=i.useCallback(Y=>{if(R(null),!o)rn.current.requestByName=Y,e(!0);else{const X=Kn(Y,g);X&&ur(X)}},[o,g,Kn,ur]),Ao=i.useCallback(Y=>{if(R(null),!o)rn.current.requestedByOfferId=Y,e(!0);else{const X=ns(Y);if(!X||!X.length)return;ur(X[0],Y)}},[o,ns,ur]),bl=i.useCallback(()=>{},[]);return F(ch,Y=>{const X=Y.getParser(),J=new Map,ce=(Pe,Qe,kt)=>{const be=new Z_(Pe,Qe,kt);for(const wn of be.offerIds)J.has(wn)?J.get(wn).push(be):J.set(wn,[be]);Qe++;for(const wn of Pe.children)be.addChild(ce(wn,Qe,be));return be};f(ce(X.root,0,null)),C(J)}),F(uh,Y=>{const X=Y.getParser();if(X.catalogType!==d)return;const J=[];for(const ce of X.offers){const Pe=[],Qe=hs(ce.localizationId);for(const be of ce.products){const wn=vi(be.furniClassId,be.productType);Pe.push(new gs(be.productType,be.furniClassId,be.extraParam,be.productCount,Qe,wn,be.uniqueLimitedItem,be.uniqueLimitedSeriesSize,be.uniqueLimitedItemsLeft))}if(!Pe.length)continue;const kt=new zt(ce.offerId,ce.localizationId,ce.rent,ce.priceCredits,ce.priceActivityPoints,ce.priceActivityPointsType,ce.giftable,ce.clubLevel,Pe,ce.bundlePurchaseAllowed);(d===kn.NORMAL||kt.pricingModel!==zt.PRICING_MODEL_BUNDLE&&kt.pricingModel!==zt.PRICING_MODEL_MULTI)&&J.push(kt)}X.frontPageItems&&X.frontPageItems.length&&G(X.frontPageItems),r(!1),s===X.pageId&&Km(X.pageId,X.layoutCode,new pd(X.localization.images.concat(),X.localization.texts.concat()),J,X.offerId,X.acceptSeasonCurrencyAsCredits)}),F(dh,Y=>{const X=Y.getParser();St(new yr(X.offer))}),F(mh,Y=>{const X=Y.getParser();St(new vs(X.code))}),F(gh,Y=>{const X=Y.getParser();St(new Mi(X.code))}),F(hh,Y=>{Y.getParser(),St(new Li)}),F(fh,Y=>{const J=Y.getParser().offer;if(!J||!J.products.length)return;J.products[0].uniqueLimitedItem;const Pe=[],Qe=hs(J.localizationId);for(const be of J.products){const wn=vi(be.furniClassId,be.productType);Pe.push(new gs(be.productType,be.furniClassId,be.extraParam,be.productCount,Qe,wn,be.uniqueLimitedItem,be.uniqueLimitedSeriesSize,be.uniqueLimitedItemsLeft))}const kt=new zt(J.offerId,J.localizationId,J.rent,J.priceCredits,J.priceActivityPoints,J.priceActivityPointsType,J.giftable,J.clubLevel,Pe,J.bundlePurchaseAllowed);(d===kn.NORMAL||kt.pricingModel!==zt.PRICING_MODEL_BUNDLE&&kt.pricingModel!==zt.PRICING_MODEL_MULTI)&&(kt.page=E,b(kt),kt.product&&kt.product.productType===de.WALL&&L(be=>{const wn={...be};return wn.extraData=kt.product.extraParam||null,wn}))}),F(ph,Y=>{const X=Y.getParser(),J=new eb(X.productCode,X.palettes.slice());j(ce=>{const Pe=[];ce.petPalettes&&Pe.push(...ce.petPalettes);for(let Qe=0;Qe<Pe.length;Qe++)if(Pe[Qe].breed===J.breed){Pe.splice(Qe,1);break}return Pe.push(J),{...ce,petPalettes:Pe}})}),F(Ih,Y=>{const X=Y.getParser();j(J=>{const ce=X.offers;return{...J,clubOffers:ce}})}),F(Eh,Y=>{const X=Y.getParser();j(J=>{const ce=X.groups;return{...J,groups:ce}})}),F(Ch,Y=>{const X=Y.getParser();j(J=>{const ce=new ib(X);return{...J,giftConfiguration:ce}})}),F(_h,Y=>{const X=Y.getParser();if(!X)return;let J="";X.result===1?J=m("inventory.marketplace.result.title.success"):J=m("inventory.marketplace.result.title.failure");const ce=m(`inventory.marketplace.result.${X.result}`);Dr(ce,ue.DEFAULT,null,null,J)}),F(Pu,Y=>{const X=Y.getParser();j(J=>({...J,clubGifts:X}))}),F(bh,Y=>{const X=o;ma(),X&&Dr(m("catalog.alert.published.description"),ue.ALERT,null,null,m("catalog.alert.published.title"))}),F(Sh,Y=>{const X=Y.getParser();Ge(X.furniCount),bl()}),F(Nh,Y=>{const X=Y.getParser();$e(X.furniLimit),me(X.maxFurniLimit),it(X.secondsLeft),pe(yn()),vn(X.secondsLeftWithGrace),bl()}),lt(yr.PURCHASE_SUCCESS,Y=>ar(mn.CREDITS)),Te(vl.PLACED,Y=>{if(!H||Y.type!==vl.PLACED)return;if(Ur(!0),!tt){br();return}let X=!1;const J=tt.product;if(Y.category===Q.WALL)switch(J.furnitureData.className){case"floor":case"wallpaper":case"landscape":X=Y.placedOnFloor||Y.placedOnWall;break;default:X=Y.placedInRoom;break}else X=Y.placedInRoom;if(!X){br();return}switch(qt(new lb(Y.roomId,Y.objectId,Y.category,Y.wallLocation,Y.x,Y.y,Y.direction,tt)),d){case kn.NORMAL:{switch(Y.category){case Q.FLOOR:$().addFurnitureFloor(Y.roomId,Y.objectId,J.productClassId,new wt(Y.x,Y.y,Y.z),new wt(Y.direction),0,new wh);break;case Q.WALL:switch(J.furnitureData.className){case"floor":case"wallpaper":case"landscape":ts(J.furnitureData.className,J.extraParam);break;default:$().addFurnitureWall(Y.roomId,Y.objectId,J.productClassId,new wt(Y.x,Y.y,Y.z),new wt(Y.direction*45),0,Y.instanceData,0);break}}const ce=$().getRoomObject(Y.roomId,Y.objectId,Y.category);ce&&ce.model.setValue(ae.FURNITURE_ALPHA_MULTIPLIER,.5),Me&&A(new co(s,tt.offerId,J.extraParam,1)),ne&&Lr(tt);break}case kn.BUILDER:{let ce=tt.page.pageId;switch(ce===BS&&(ce=-1),Y.category){case Q.FLOOR:A(new vh(ce,tt.offerId,J.extraParam,Y.x,Y.y,Y.direction));break;case Q.WALL:A(new Th(ce,tt.offerId,J.extraParam,Y.wallLocation));break}ne&&Lr(tt);break}}}),lt(Ui.FURNI_ADDED,Y=>{const X=$();if(!(!je||je.productClassId!==Y.spriteId||je.roomId!==X.activeRoomId)){switch(Y.category){case Z.FLOOR:{const J=X.getRoomInstanceVariable(X.activeRoomId,ae.ROOM_FLOOR_TYPE);je.extraParam!==J&&A(new Wa(Y.id));break}case Z.WALL_PAPER:{const J=X.getRoomInstanceVariable(X.activeRoomId,ae.ROOM_WALL_TYPE);je.extraParam!==J&&A(new Wa(Y.id));break}case Z.LANDSCAPE:{const J=X.getRoomInstanceVariable(X.activeRoomId,ae.ROOM_LANDSCAPE_TYPE);je.extraParam!==J&&A(new Wa(Y.id));break}default:A(new Rh(Y.id,je.category,je.wallLocation,je.x,je.y,je.direction))}ne||Ur()}}),i.useEffect(()=>()=>b(null),[E]),i.useEffect(()=>{if(!(!o||!g||!p||!rn.current))switch(rn.current.requestType){case Ds.REQUEST_TYPE_NONE:if(E)return;if(g.isBranch){for(const Y of g.children)if(Y&&Y.isVisible){ur(Y);return}}return;case Ds.REQUEST_TYPE_ID:As(rn.current.requestById),rn.current.resetRequest();return;case Ds.REQUEST_TYPE_OFFER:Ao(rn.current.requestedByOfferId),rn.current.resetRequest();return;case Ds.REQUEST_TYPE_NAME:ko(rn.current.requestByName),rn.current.resetRequest();return}},[o,g,p,E,ur,As,Ao,ko]),i.useEffect(()=>{!O&&E&&E.pageId===-1&&As(c)},[O,E,c,As]),i.useEffect(()=>{I&&L({quantity:1,extraData:null,extraParamRequired:!1,previewStuffData:null})},[I]),i.useEffect(()=>{!o||g||(A(new yh),A(new Du),A(new Oh(d)),A(new kh))},[o,g,d]),i.useEffect(()=>(B(new Ka($(),++Ka.PREVIEW_COUNTER)),()=>{B(Y=>(Y.dispose(),null))}),[]),{isVisible:o,setIsVisible:e,isBusy:n,pageId:s,previousPageId:c,currentType:d,rootNode:g,offersToNodes:p,currentPage:E,setCurrentPage:_,currentOffer:I,setCurrentOffer:b,activeNodes:N,searchResult:O,setSearchResult:R,frontPageItems:y,roomPreviewer:k,navigationHidden:M,setNavigationHidden:U,purchaseOptions:W,setPurchaseOptions:L,catalogOptions:x,setCatalogOptions:j,getNodeById:Bt,getNodeByName:Kn,activateNode:ur,openPageById:As,openPageByName:ko,openPageByOfferId:Ao,requestOfferToMover:Lr}},Be=()=>ct(GS),VS=1e3,HS=10,WS=1e3;let jS=0,qS=0;const zS=()=>{const[o,e]=i.useState([]),[n,r]=i.useState([]),[s,a]=i.useState([]),[c,u]=i.useState(!1),d=f=>{f.id=jS++,e(p=>{const C=[...p];return C.push(f),C.length>VS&&C.shift(),C})},h=f=>{r(p=>{const C=[...p];return C.push(f),C.length>HS&&C.shift(),C})},g=f=>{f.id=qS++,a(p=>{const C=[...p];return C.push(f),C.length>WS&&C.shift(),C})};return Ye(jt.STARTED,f=>u(!0)),F(ws,f=>{if(!c)return;const p=f.getParser();n.length&&n[n.length-1].id===p.data.roomId||(d({id:-1,webId:-1,entityId:-1,name:p.data.roomName,timestamp:vd(),type:Dn.TYPE_ROOM_INFO,roomId:p.data.roomId}),h({id:p.data.roomId,name:p.data.roomName}),u(!1))}),F(Mu,f=>{const p=f.getParser();g({id:-1,webId:p.senderId,entityId:-1,name:"",message:p.messageText,roomId:-1,timestamp:nc(p.secondsSinceSent),type:Dn.TYPE_IM})}),F(Lu,f=>{const p=f.getParser();g({id:-1,webId:p.senderId,entityId:-1,name:"",message:p.messageText,roomId:-1,timestamp:nc(),type:Dn.TYPE_IM})}),{addChatEntry:d,chatHistory:o,roomHistory:n,messengerHistory:s}},No=()=>ct(zS),YS=()=>{const[o,e]=i.useState([]),[n,r]=i.useState([]),[s,a]=i.useState([]),[c,u]=i.useState([]),[d,h]=i.useState(null),g=i.useMemo(()=>{const N=o.filter(v=>v.online);return N.sort((v,O)=>v.name<O.name?-1:v.name>O.name?1:0),N},[o]),f=i.useMemo(()=>{const N=o.filter(v=>!v.online);return N.sort((v,O)=>v.name<O.name?-1:v.name>O.name?1:0),N},[o]),p=N=>A(new $i(N.id)),C=(N,v)=>v!==N.relationshipStatus&&A(new Ls(N.id,v)),E=N=>{for(const v of o)if(v.id===N)return v;return null},_=N=>!(N===q().userId||E(N)||n.find(v=>v.requesterUserId===N)||s.indexOf(N)>=0),I=(N,v)=>{if(!_(N))return!1;a(O=>{const R=[...O];return R.push(N),R}),A(new Uu(v))},b=(N,v)=>{N===-1&&!v?(A(new wl(!0)),r([])):r(O=>{const R=[...O],y=R.findIndex(G=>G.id===N);return y===-1?O:(A(v?new Bh(R[y].id):new wl(!1,R[y].id)),R.splice(y,1),R)})};return F(Ph,N=>{const v=N.getParser();h(new Hb(v.userFriendLimit,v.normalFriendLimit,v.extendedFriendLimit,v.categories)),A(new Ah)}),F(Dh,N=>{const v=N.getParser();e(O=>{const R=[...O];for(const y of v.fragment){const G=R.findIndex(B=>B.id===y.id),k=new Wt;k.populate(y),G>-1?R[G]=k:R.push(k)}return R})}),F(Mh,N=>{const v=N.getParser();e(O=>{const R=[...O],y=G=>{const k=R.findIndex(B=>B.id===G.id);if(k===-1){const B=new Wt;B.populate(G),R.unshift(B)}else R[k].populate(G)};for(const G of v.addedFriends)y(G);for(const G of v.updatedFriends)y(G);for(const G of v.removedFriendIds){const k=R.findIndex(B=>B.id===G);k>-1&&R.splice(k,1)}return R})}),F(Lh,N=>{const v=N.getParser();r(O=>{const R=[...O];for(const y of v.requests){const G=R.findIndex(k=>k.requesterUserId===y.requesterUserId);if(G>0)R[G]=Kt(R[G]),R[G].populate(y);else{const k=new rc;k.populate(y),R.push(k)}}return R})}),F(Uh,N=>{const O=N.getParser().request;r(R=>{const y=[...R];if(y.findIndex(k=>k.requesterUserId===O.requesterUserId)===-1){const k=new rc;k.populate(O),y.push(k)}return y})}),i.useEffect(()=>{A(new xh);const N=setInterval(()=>A(new Fh),12e4);return()=>{clearInterval(N)}},[]),{friends:o,requests:n,sentRequests:s,dismissedRequestIds:c,setDismissedRequestIds:u,settings:d,onlineFriends:g,offlineFriends:f,getFriend:E,canRequestFriend:_,requestFriend:I,requestResponse:b,followFriend:p,updateRelationship:C}},fn=()=>ct(YS),$S=()=>{const[o,e]=i.useState([]),[n,r]=i.useState(-1),[s,a]=i.useState([]),[c,u]=i.useState(qn.HIDDEN),{getFriend:d=null}=fn(),{simpleAlert:h=null}=Je(),g=i.useMemo(()=>o.filter(_=>s.indexOf(_.threadId)===-1),[o,s]),f=i.useMemo(()=>n>0&&g.find(_=>_.threadId===n||null),[n,g]),p=_=>{let I=o.find(b=>b.participant&&b.participant.id===_);if(I){const b=s.indexOf(I.threadId);b>=0&&a(N=>{const v=[...N];return v.splice(b,1),v})}else{const b=d(_);if(!b)return null;I=new jb(b),I.addMessage(null,m("messenger.moderationinfo"),0,null,zn.SECURITY_NOTIFICATION),I.setRead(),e(N=>{const v=[...N];return v.push(I),v})}return I},C=_=>{a(I=>{const b=[...I];return b.indexOf(_)>=0?I:(b.push(_),b)}),n===_&&r(-1)},E=(_,I,b,N=0,v=null,O=zn.CHAT)=>{if(!_||!b||!b.length)return;const R=I===q().userId;R&&b.length<=255&&A(new Vh(_.participant.id,b)),e(y=>{const G=[...y],k=G.findIndex(B=>B.threadId===_.threadId);return k===-1?y:(_=Kt(G[k]),R&&_.groups.length===1&&ar(mn.MESSENGER_NEW_THREAD),_.addMessage(O===zn.ROOM_INVITE?null:I,b,N,v,O),n===_.threadId&&_.setRead(),G[k]=_,!R&&_.unread&&ar(mn.MESSENGER_MESSAGE_RECEIVED),G)})};return F(Mu,_=>{const I=_.getParser(),b=p(I.senderId);b&&E(b,I.senderId,I.messageText,I.secondsSinceSent,I.extraData)}),F(Lu,_=>{const I=_.getParser(),b=p(I.senderId);b&&E(b,I.senderId,I.messageText,0,null,zn.ROOM_INVITE)}),F(Gh,_=>{const I=_.getParser();h(`Received room invite error: ${I.errorCode},recipients: ${I.failedRecipients}`,ue.DEFAULT,null,null,m("friendlist.alert.title"))}),i.useEffect(()=>{n<=0||e(_=>{const I=[..._],b=I.findIndex(N=>N.threadId===n);return b>=0&&(I[b]=Kt(I[b]),I[b].setRead()),I})},[n]),i.useEffect(()=>{u(_=>{if(!g.length)return qn.HIDDEN;let I=!1;for(const b of g)if(b.unreadCount>0){I=!0;break}return I?qn.UNREAD:qn.SHOW})},[g]),{messageThreads:o,activeThread:f,iconState:c,visibleThreads:g,getMessageThread:p,setActiveThreadId:r,closeThread:C,sendMessage:E}},hm=()=>ct($S),KS=()=>{const[o,e]=i.useState(!1),[n,r]=i.useState(null),[s,a]=i.useState(null),[c,u]=i.useState(null),[d,h]=i.useState(!1),[g,f]=i.useState(null);return F(Hh,p=>{let C=p.getParser();!C||C&&!C.games.length||(a(C.games[0]),r(C.games))}),F(Wh,p=>{let C=p.getParser();C&&u(C)}),F(jh,p=>{let C=p.getParser();C&&h(C.isInMaintenance)}),F(qh,p=>{let C=p.getParser();if(C)switch(C.gameTypeId){case 2:return console.log("snowwar");default:return f(C.url)}}),i.useEffect(()=>{o&&(A(new zh),Qi())},[o]),{isVisible:o,setIsVisible:e,games:n,accountStatus:c,selectedGame:s,setSelectedGame:a,gameOffline:d,gameURL:g,setGameURL:f}},To=()=>ct(KS),XS=()=>{const[o,e]=i.useState(null);return F(Yh,n=>{const r=n.getParser(),s={badgeBases:[],badgeSymbols:[],badgePartColors:[],groupColorsA:[],groupColorsB:[]};r.bases.forEach((c,u)=>s.badgeBases.push({id:u,images:c})),r.symbols.forEach((c,u)=>s.badgeSymbols.push({id:u,images:c})),r.partColors.forEach((c,u)=>s.badgePartColors.push({id:u,color:c})),r.colorsA.forEach((c,u)=>s.groupColorsA.push({id:u,color:c})),r.colorsB.forEach((c,u)=>s.groupColorsB.push({id:u,color:c}));const a=(c,u)=>c.id<u.id?-1:c.id>u.id?1:0;s.badgeBases.sort(a),s.badgeSymbols.sort(a),s.badgePartColors.sort(a),s.groupColorsA.sort(a),s.groupColorsB.sort(a),e(s)}),i.useEffect(()=>{A(new $h)},[]),{groupCustomize:o}},ua=()=>ct(XS),QS=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(null),{simpleAlert:s=null,showConfirm:a=null}=Je(),c=(u,d)=>{const h={reportType:u,reportedUserId:-1,reportedChats:[],cfhCategory:-1,cfhTopic:-1,roomId:-1,roomName:"",messageId:-1,threadId:-1,groupId:-1,extraData:"",roomObjectId:-1,message:"",currentStep:0};switch(u){case He.BULLY:case He.EMERGENCY:case He.IM:h.reportedUserId=d.reportedUserId,h.currentStep=Pt.SELECT_CHATS;break;case He.ROOM:h.roomId=d.roomId,h.roomName=d.roomName,h.currentStep=Pt.SELECT_TOPICS;break;case He.THREAD:h.groupId=d.groupId,h.threadId=d.threadId,h.currentStep=Pt.SELECT_TOPICS;break;case He.MESSAGE:h.groupId=d.groupId,h.threadId=d.threadId,h.messageId=d.messageId,h.currentStep=Pt.SELECT_TOPICS;break;case He.PHOTO:h.extraData=d.extraData,h.roomId=d.roomId,h.reportedUserId=d.reportedUserId,h.roomObjectId=d.roomObjectId,h.currentStep=Pt.SELECT_TOPICS;break}e(h)};return F(Xh,u=>{const d=u.getParser();let h=d.messageText;switch(d.resultType){case Za.TOO_MANY_PENDING_CALLS_CODE:A(new Kh),s(m("help.cfh.error.pending"),ue.MODERATION,null,null,m("help.cfh.error.title"));break;case Za.HAS_ABUSIVE_CALL_CODE:s(m("help.cfh.error.abusive"),ue.MODERATION,null,null,m("help.cfh.error.title"));break;default:h.trim().length===0&&(h=m("help.cfh.sent.text")),s(h,ue.MODERATION,null,null,m("help.cfh.sent.title"))}}),F(Qh,u=>{const d=u.getParser(),h=d.messageText.length===0?m("help.cfh.closed."+Xb(d.closeReason)):d.messageText;s(h,ue.MODERATION,null,null,m("mod.alert.title"))}),F(Zh,u=>{const d=u.getParser();d.count>0&&a(m("help.emergency.pending.title")+`
`+d.pendingCalls[0].message,()=>{A(new Jh)},null,m("help.emergency.pending.button.discard"),m("help.emergency.pending.button.keep"),m("help.emergency.pending.message.subtitle"))}),F(ef,u=>{s("Your pending calls were deleted",ue.MODERATION,null,null,m("mod.alert.title"))}),F(tf,u=>{const d=u.getParser();s(d.message,ue.MODERATION,null,null,m("help.cfh.reply.title"))}),F(nf,u=>{const d=u.getParser();s(m("help.emergency.global_mute.message"),ue.MODERATION,d.infoUrl,m("help.emergency.global_mute.link"),m("help.emergency.global_mute.subtitle"))}),F(rf,u=>{const d=u.getParser();r(d)}),{activeReport:o,setActiveReport:e,sanctionInfo:n,setSanctionInfo:r,report:c}},Un=()=>ct(QS),vo=()=>{const[o,e]=i.useState([]),n=i.useMemo(()=>!!o.length,[o]),r=i.useCallback(()=>{let a=-1;return e(c=>{const u=[...c];return a=u.length?u[u.length-1]+1:0,u.push(a),u}),a},[]),s=i.useCallback(a=>{e(c=>{const u=[...c],d=u.indexOf(a);return d===-1?c:(u.splice(d,1),u)})},[]);return{isVisible:n,activate:r,deactivate:s}},JS=o=>A(new af(o)),ZS=(o,e)=>A(new of(o,...e)),eN=()=>{const[o,e]=i.useState(new Map),n=i.useCallback(d=>{var h;return((h=o.get(d))==null?void 0:h.length)||0},[o]),r=i.useMemo(()=>{let d=0;for(const h of o.keys())d+=n(h);return d},[o,n]),s=i.useCallback(d=>{let h=!0;return e(g=>{if(!g.has(d))return h=!1,g;const f=new Map(g);return f.delete(d),JS(d),f}),h},[]),a=i.useCallback((d,h)=>{let g=!0;return e(f=>{if(!f.has(d))return g=!1,f;const p=new Map(f),C=p.get(d);if(C)for(const E of h)C.splice(C.indexOf(E),1);return ZS(d,h),p}),g},[]),c=i.useCallback((d,h)=>o.has(d)?o.get(d).indexOf(h)>=0:!1,[o]),u=i.useCallback((d,h)=>{e(g=>{if(!g.has(d))return g;const f=new Map(g),p=f.get(d),C=p.indexOf(h);return C>=0&&p.splice(C,1),f})},[]);return F(sf,d=>{const h=d.getParser();e(g=>{const f=new Map(g);for(const p of h.categories){let C=f.get(p);C||(C=[],f.set(p,C));const E=h.getItemsByCategory(p);for(const _ of E)C.indexOf(_)===-1&&C.push(_)}return f})}),{getCount:n,getFullCount:r,resetCategory:s,resetItems:a,isUnseen:c,removeUnseen:u}},Sn=()=>ct(eN),tN=()=>{const[o,e]=i.useState(!0),[n,r]=i.useState([]),[s,a]=i.useState(new Map),[c,u]=i.useState([]),[d,h]=i.useState(null),{isVisible:g=!1,activate:f=null,deactivate:p=null}=vo(),{isUnseen:C=null,resetCategory:E=null}=Sn(),_=K("user.badges.max.slots",5),I=O=>c.indexOf(O)>=0,b=()=>c.length<_,N=O=>{u(R=>{const y=[...R],G=y.indexOf(O);if(G===-1){if(!b())return R;y.push(O)}else y.splice(G,1);const k=new df;for(let B=0;B<_;B++)k.addActivatedBadge(y[B]??"");return A(k),y})},v=O=>n.indexOf(O)===-1?0:s.get(O)??0;return F(lf,O=>{const R=O.getParser(),y=[];a(G=>{const k=new Map(G);return R.getAllBadgeCodes().forEach(B=>{const M=n.indexOf(B)>=0,U=R.getBadgeId(B);k.set(B,U),!M&&y.push(B)}),k}),u(R.getActiveBadgeCodes()),r(G=>[...G,...y])}),F(cf,O=>{const R=O.getParser(),y=C(ze.BADGE,R.badgeId);r(G=>{const k=[...G];return y?k.unshift(R.badgeCode):k.push(R.badgeCode),k}),a(G=>{const k=new Map(G);return k.set(R.badgeCode,R.badgeId),k})}),i.useEffect(()=>{!n||!n.length||h(O=>{let R=O;return R&&n.indexOf(R)===-1&&(R=null),R||(R=n[0]),R})},[n]),i.useEffect(()=>{if(g)return()=>{E(ze.BADGE)}},[g,E]),i.useEffect(()=>{!g||!o||(A(new uf),e(!1))},[g,o]),{badgeCodes:n,activeBadgeCodes:c,selectedBadgeCode:d,setSelectedBadgeCode:h,isWearingBadge:I,canWearBadges:b,toggleBadge:N,getBadgeId:v,activate:f,deactivate:p}},wo=()=>ct(tN),nN=()=>{const[o,e]=i.useState(!0),[n,r]=i.useState([]),[s,a]=i.useState(null),{isVisible:c=!1,activate:u=null,deactivate:d=null}=vo(),{isUnseen:h=null,resetCategory:g=null}=Sn();return F(mf,f=>{const p=f.getParser();r(C=>{const E=[...C],_=E.map(b=>b.botData.id),I=[];for(const b of p.items.values())_.indexOf(b.id)===-1&&I.push(b);for(const b of _){let N=!0;for(const R of p.items.values())if(R.id===b){N=!1;break}if(!N)continue;const v=E.findIndex(R=>R.botData.id===b),O=E[v];v===-1||!O||(Cs()===O.botData.id&&(Ks(),ee("inventory/open")),E.splice(v,1))}for(const b of I){const N={botData:b};h(ze.BOT,b.id)?E.unshift(N):E.push(N)}return E})}),F(gf,f=>{const p=f.getParser();r(C=>{const E=[...C];if(E.findIndex(N=>N.botData.id===p.item.id)>=0)return C;const I={botData:p.item};return h(ze.BOT,I.botData.id)?E.unshift(I):E.push(I),E})}),F(hf,f=>{const p=f.getParser();r(C=>{const E=[...C],_=E.findIndex(I=>I.botData.id===p.itemId);return _===-1?C:(E.splice(_,1),Cs()===p.itemId&&(Ks(),ee("inventory/show")),E)})}),i.useEffect(()=>{!n||!n.length||a(f=>{let p=f;return p&&n.indexOf(p)===-1&&(p=null),p||(p=n[0]),p})},[n]),i.useEffect(()=>{if(c)return()=>{g(ze.BOT)}},[c,g]),i.useEffect(()=>{!c||!o||(A(new ff),e(!1))},[c,o]),{botItems:n,selectedBot:s,setSelectedBot:a,activate:u,deactivate:d}},fm=()=>ct(nN);let Ra=null;const rN=()=>{const[o,e]=i.useState(!0),[n,r]=i.useState([]),[s,a]=i.useState(null),{isVisible:c=!1,activate:u=null,deactivate:d=null}=vo(),{isUnseen:h=null,resetCategory:g=null}=Sn(),f=E=>{if(!(!n||!n.length))return n.filter(_=>_.type===E)},p=E=>{if(!(!n||!n.length)){for(const _ of n){const I=_.getItemById(E);if(I&&I.isWallItem)return _}return null}},C=E=>{if(!(!n||!n.length)){for(const _ of n){const I=_.getItemById(E);if(I&&!I.isWallItem)return _}return null}};return F(xu,E=>{const _=E.getParser();r(I=>{const b=[...I];for(const N of _.items){let v=0,O=null;for(;v<b.length;){const R=b[v];let y=0;for(;y<R.items.length;){const G=R.items[y];if(G.id===N.itemId){G.update(N);const k=[...R.items];k[y]=G,R.items=k,O=R;break}y++}if(O)break;v++}if(O)O.hasUnseenItems=!0,b[v]=Kt(O);else{const R=new $s(N);Jl(b,R,h(ze.FURNI,N.itemId)),St(new Ui(R.id,R.type,R.category))}}return b})}),F(_i,E=>{const _=E.getParser();Ra||(Ra=new Array(_.totalFragments));const I=Sb(_.fragment,_.totalFragments,_.fragmentNumber,Ra);I&&(r(b=>{const N=[...b],v=Nb(N);for(const O of v){if(I.get(O))continue;let R=0;for(;R<N.length;){const y=N[R],G=y.remove(O);if(!G){R++;continue}Cs()===G.ref&&(Ks(),_s(y)||ee("inventory/show")),y.getTotalCount()<=0&&(N.splice(R,1),y.dispose());break}}for(const O of I.keys()){if(v.indexOf(O)>=0)continue;const R=I.get(O);if(!R)continue;const y=new $s(R);Jl(N,y,h(ze.FURNI,O)),St(new Ui(y.id,y.type,y.category))}return N}),Ra=null)}),F(pf,E=>{e(!0)}),F(Fu,E=>{const _=E.getParser();r(I=>{const b=[...I];let N=0;for(;N<b.length;){const v=b[N],O=v.remove(_.itemId);if(!O){N++;continue}Cs()===O.ref&&(Ks(),_s(v)||ee("inventory/show")),v.getTotalCount()<=0&&(b.splice(N,1),v.dispose());break}return b})}),F(If,E=>{}),i.useEffect(()=>{!n||!n.length||a(E=>{let _=E;return _&&n.indexOf(_)===-1&&(_=null),_||(_=n[0]),_})},[n]),i.useEffect(()=>{if(c)return()=>{g(ze.FURNI)&&r(E=>{const _=[...E];for(const I of _)I.hasUnseenItems=!1;return _})}},[c,g]),i.useEffect(()=>{!c||!o||(A(new Ef),e(!1))},[c,o]),{isVisible:c,groupItems:n,setGroupItems:r,selectedItem:s,setSelectedItem:a,activate:u,deactivate:d,getWallItemById:p,getFloorItemById:C,getItemsByType:f}},Zr=()=>ct(rN);let ya=null;const sN=()=>{const[o,e]=i.useState(!0),[n,r]=i.useState([]),[s,a]=i.useState(null),{isVisible:c=!1,activate:u=null,deactivate:d=null}=vo(),{isUnseen:h=null,resetCategory:g=null}=Sn();return F(Cf,f=>{const p=f.getParser();ya||(ya=new Array(p.totalFragments));const C=Rb(p.fragment,p.totalFragments,p.fragmentNumber,ya);C&&(r(E=>{const _=[...E];return wb(_,C,h),_}),ya=null)}),F(_f,f=>{const p=f.getParser();r(C=>{const E=[...C];return Sd(p.pet,E,h(ze.PET,p.pet.id)),E})}),F(bf,f=>{const p=f.getParser();r(C=>{const E=[...C];return Nd(p.petId,E),E})}),i.useEffect(()=>{!n||!n.length||a(f=>{let p=f;return p&&n.indexOf(p)===-1&&(p=null),p||(p=n[0]),p})},[n]),i.useEffect(()=>{if(c)return()=>{g(ze.PET)}},[c,g]),i.useEffect(()=>{!c||!o||(A(new Sf),e(!1))},[c,o]),{petItems:n,selectedPet:s,setSelectedPet:a,activate:u,deactivate:d}},pm=()=>ct(sN),aN=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(null),[s,a]=i.useState(rt.TRADING_STATE_READY),{groupItems:c=[],setGroupItems:u=null,activate:d=null,deactivate:h=null}=Zr(),{simpleAlert:g=null,showTradeAlert:f=null}=Je(),p=s>=rt.TRADING_STATE_RUNNING,C=()=>{switch(s){case rt.TRADING_STATE_RUNNING:!n.itemCount&&!o.accepts&&g(m("inventory.trading.warning.other_not_offering"),null,null,null),o.accepts?A(new Lf):A(new Uf);return;case rt.TRADING_STATE_CONFIRMING:A(new Mf),a(rt.TRADING_STATE_CONFIRMED);return}},E=I=>{const b=I.getLastItem();b&&A(new xf(b.id))},_=()=>{if(p)switch(s){case rt.TRADING_STATE_RUNNING:A(new Bf);return;default:A(new Ff);return}};return F(Nf,I=>{const b=I.getParser();!o||!n||(o.userId===b.userID?e(N=>{const v=Kt(N);return v.accepts=b.userAccepts,v}):n.userId===b.userID&&r(N=>{const v=Kt(N);return v.accepts=b.userAccepts,v}))}),F(vf,I=>{const b=I.getParser();b.reason===Tf.ERROR_WHILE_COMMIT?f(_t.ERROR_WHILE_COMMIT):o&&b.userID!==o.userId&&f(_t.THEY_CANCELLED),e(null),r(null),a(rt.TRADING_STATE_READY)}),F(wf,I=>{I.getParser(),e(null),r(null),a(rt.TRADING_STATE_READY)}),F(Rf,I=>{I.getParser(),a(rt.TRADING_STATE_COUNTDOWN)}),F(yf,I=>{const b=I.getParser(),N=tc(b.firstUserItemArray),v=tc(b.secondUserItemArray);e(O=>{const R=Kt(O);R.userId===b.firstUserID?(R.creditsCount=b.firstUserNumCredits,R.itemCount=b.firstUserNumItems,R.userItems=N):(R.creditsCount=b.secondUserNumCredits,R.itemCount=b.secondUserNumItems,R.userItems=v);const y=[];for(const G of R.userItems.getValues()){let k=0;for(;k<G.getTotalCount();){const B=G.getItemByIndex(k);B&&y.push(B.ref),k++}}return u(G=>{const k=[...G];for(const B of k)B.lockItemIds(y);return k}),R}),r(O=>{const R=Kt(O);return R.userId===b.firstUserID?(R.creditsCount=b.firstUserNumCredits,R.itemCount=b.firstUserNumItems,R.userItems=N):(R.creditsCount=b.secondUserNumCredits,R.itemCount=b.secondUserNumItems,R.userItems=v),R})}),F(Of,I=>{I.getParser()}),F(kf,I=>{const b=I.getParser(),N=new Zl,v=Oe().userDataManager.getUserData(b.userID);N.userItems=new Hs;const O=new Zl,R=Oe().userDataManager.getUserData(b.otherUserID);O.userItems=new Hs,v.webID===q().userId?(N.userId=v.webID,N.userName=v.name,N.canTrade=b.userCanTrade,O.userId=R.webID,O.userName=R.name,O.canTrade=b.otherUserCanTrade):R.webID===q().userId&&(N.userId=R.webID,N.userName=R.name,N.canTrade=b.otherUserCanTrade,O.userId=v.webID,O.userName=v.name,O.canTrade=b.userCanTrade),e(N),r(O),a(rt.TRADING_STATE_RUNNING)}),F(Af,I=>{const b=I.getParser();f(b.reason,b.otherUserName)}),F(Pf,I=>{I.getParser(),f(_t.THEY_NOT_ALLOWED)}),F(Df,I=>{I.getParser(),f(_t.YOU_NOT_ALLOWED)}),i.useEffect(()=>{if(s===rt.TRADING_STATE_READY)return;const I=d();return()=>h(I)},[s,d,h]),{ownUser:o,otherUser:n,tradeState:s,setTradeState:a,isTrading:p,groupItems:c,progressTrade:C,removeItem:E,stopTrading:_}},Im=()=>ct(aN),oN=()=>{const[o,e]=i.useState(null),[n,r]=i.useState([]),[s,a]=i.useState([]),[c,u]=i.useState([]),[d,h]=i.useState([]),[g,f]=i.useState([]),[p,C]=i.useState([]),{simpleAlert:E=null}=Je(),_=U=>{n.indexOf(U)>=0||r(W=>[...W,U])},I=U=>{r(W=>{const L=[...W],x=L.indexOf(U);return x>=0&&L.splice(x),L})},b=U=>{n.indexOf(U)>=0?I(U):_(U)},N=U=>{s.indexOf(U)>=0||a(W=>[...W,U])},v=U=>{a(W=>{const L=[...W],x=L.indexOf(U);return x>=0&&L.splice(x),L})},O=U=>{s.indexOf(U)>=0?v(U):N(U)},R=U=>{c.indexOf(U)>=0||u(W=>[...W,U])},y=U=>{u(W=>{const L=[...W],x=L.indexOf(U);return x>=0&&L.splice(x),L})},G=U=>{c.indexOf(U)>=0?y(U):R(U)},k=U=>{d.indexOf(U)>=0||h(W=>[...W,U])},B=U=>{h(W=>{const L=[...W],x=L.indexOf(U);return x>=0&&L.splice(x),L})},M=U=>{s.indexOf(U)>=0?B(U):k(U)};return F(Gf,U=>{const L=U.getParser().data;e(L),f(L.issues)}),F(Vf,U=>{const W=U.getParser();f(L=>{const x=[...L],j=x.findIndex(H=>H.issueId===W.issueData.issueId);return j>=0?x[j]=W.issueData:(x.push(W.issueData),ar(mn.MODTOOLS_NEW_TICKET)),x})}),F(Hf,U=>{U.getParser()}),F(Wf,U=>{U.getParser()&&E("Failed to pick issue",ue.DEFAULT,null,null,"Error")}),F(jf,U=>{const W=U.getParser();f(L=>{const x=[...L],j=x.findIndex(H=>H.issueId===W.issueId);return j>=0&&x.splice(j,1),x})}),F(qf,U=>{U.getParser().success?E("Moderation action was successfull",ue.MODERATION,null,null,"Success"):E("There was a problem applying tht moderation action",ue.MODERATION,null,null,"Error")}),F(zf,U=>{const W=U.getParser();C(W.callForHelpCategories)}),F(Yf,U=>{U.getParser()}),{settings:o,openRooms:n,openRoomChatlogs:s,openUserChatlogs:d,openUserInfos:c,cfhCategories:p,tickets:g,openRoomInfo:_,closeRoomInfo:I,toggleRoomInfo:b,openRoomChatlog:N,closeRoomChatlog:v,toggleRoomChatlog:O,openUserInfo:R,closeUserInfo:y,toggleUserInfo:G,openUserChatlog:k,closeUserChatlog:B,toggleUserChatlog:M}},ys=()=>ct(oN),iN=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(null),[s,a]=i.useState(null),[c,u]=i.useState(null),[d,h]=i.useState({roomInfo:null,state:De.NONE}),[g,f]=i.useState(null),[p,C]=i.useState({settingsReceived:!1,homeRoomId:0,enteredGuestRoom:null,currentRoomOwner:!1,currentRoomId:0,currentRoomIsStaffPick:!1,currentRoomIsWelcome:!1,createdFlatId:0,avatarId:0,roomPicker:!1,eventMod:!1,currentRoomRating:0,canRate:!0}),{simpleAlert:E=null}=Je();return F($f,_=>{const I=_.getParser();A(new $a(I.roomId,!1,!1))}),F(Kf,_=>{const I=_.getParser();I.canCreate||E(m(`navigator.cannotcreateevent.error.${I.errorCode}`),null,null,null,m("navigator.cannotcreateevent.title"))}),F(Gu,_=>{A(new Xf),A(new Bu)}),F(Qf,_=>{const I=_.getParser();C(b=>{const N={...b};return N.eventMod=I.securityLevel>=js.MODERATOR,N.roomPicker=I.securityLevel>=js.COMMUNITY,N})}),F(Jf,_=>{const I=_.getParser();_n(I.roomId)}),F(Vu,_=>{const I=_.getParser();C(b=>{const N={...b};return N.enteredGuestRoom=null,N.currentRoomOwner=I.isOwner,N.currentRoomId=I.roomId,N}),A(new $a(I.roomId,!0,!1)),qs.available&&qs.call("legacyTrack","navigator","private",[I.roomId])}),F(ws,_=>{const I=_.getParser();if(I.roomEnter)h({roomInfo:null,state:De.NONE}),C(b=>{const N={...b};return N.enteredGuestRoom=I.data,N.currentRoomIsStaffPick=I.staffPick,N.currentRoomIsWelcome=I.isWelcomeRoom,!(N.createdFlatId===I.data.roomId)&&I.data.displayRoomEntryAd&&K("roomenterad.habblet.enabled",!1)&&Zs.openRoomEnterAd(),N.createdFlatId=0,N.enteredGuestRoom&&N.enteredGuestRoom.habboGroupId>0,N});else if(I.roomForward){if(I.data.ownerName!==q().userName&&!I.isGroupMember)switch(I.data.doorMode){case st.DOORBELL_STATE:h(b=>{const N={...b};return N.roomInfo=I.data,N.state=De.START_DOORBELL,N});return;case st.PASSWORD_STATE:h(b=>{const N={...b};return N.roomInfo=I.data,N.state=De.START_PASSWORD,N});return}if(I.data.doorMode===st.NOOB_STATE&&!q().isAmbassador&&!q().isRealNoob&&!q().isModerator)return;qr(I.data.roomId)}else C(b=>{const N={...b};return N.enteredGuestRoom=I.data,N.currentRoomIsStaffPick=I.staffPick,N.currentRoomIsWelcome=I.isWelcomeRoom,N})}),F(Zf,_=>{const I=_.getParser();C(b=>{const N={...b};return N.currentRoomRating=I.totalLikes,N.canRate=I.canLike,N})}),F(ep,_=>{const I=_.getParser();(!I.userName||I.userName.length===0)&&h(b=>{const N={...b};return N.state=De.STATE_WAITING,N})}),F(tp,_=>{const I=_.getParser();(!I.userName||I.userName.length===0)&&h(b=>{const N={...b};return N.state=De.STATE_ACCEPTED,N})}),F(np,_=>{const I=_.getParser();(!I.userName||I.userName.length===0)&&h(b=>{const N={...b};return N.state=De.STATE_NO_ANSWER,N})}),F(rp,_=>{switch(_.getParser().errorCode){case-100002:h(b=>{const N={...b};return N.state=De.STATE_WRONG_PASSWORD,N});return;case 4009:E(m("navigator.alert.need.to.be.vip"),ue.DEFAULT,null,null,m("generic.alert.title"));return;case 4010:E(m("navigator.alert.invalid_room_name"),ue.DEFAULT,null,null,m("generic.alert.title"));return;case 4011:E(m("navigator.alert.cannot_perm_ban"),ue.DEFAULT,null,null,m("generic.alert.title"));return;case 4013:E(m("navigator.alert.room_in_maintenance"),ue.DEFAULT,null,null,m("generic.alert.title"));return}}),F(sp,_=>{const I=_.getParser();u(I.topLevelContexts),a(I.topLevelContexts.length?I.topLevelContexts[0]:null)}),F(ap,_=>{const I=_.getParser();a(b=>{let N=b;if(N||(N=c&&c.length&&c[0]||null),!N)return null;if(I.result.code!==N.code&&c&&c.length)for(const v of c)v.code===I.result.code&&(N=v);for(const v of c)v.code===I.result.code&&(N=v);return N}),f(I.result)}),F(op,_=>{const I=_.getParser();e(I.categories)}),F(ip,_=>{const I=_.getParser();r(I.categories)}),F(lp,_=>{const I=_.getParser();qr(I.roomId)}),F(cp,_=>{const I=_.getParser();let b=!1;if(C(O=>{b=O.settingsReceived;const R={...O};return R.homeRoomId=I.homeRoomId,R.settingsReceived=!0,R}),b)return;let N=-1,v=-1;K("friend.id")!==void 0&&parseInt(K("friend.id"))>0&&(N=0,A(new $i(parseInt(K("friend.id"))))),K("forward.type")!==void 0&&K("forward.id")!==void 0&&(N=parseInt(K("forward.type")),v=parseInt(K("forward.id"))),N===2?_n(v):N===-1&&I.roomIdToEnter>0&&(ee("navigator/close"),I.roomIdToEnter!==I.homeRoomId?qr(I.roomIdToEnter):qr(I.homeRoomId))}),F(up,_=>{const I=_.getParser();switch(I.reason){case xo.REASON_FULL:E(m("navigator.guestroomfull.text"),ue.DEFAULT,null,null,m("navigator.guestroomfull.title"));break;case xo.REASON_QUEUE_ERROR:E(m(`room.queue.error.${I.parameter}`),ue.DEFAULT,null,null,m("room.queue.error.title"));break;case xo.REASON_BANNED:E(m("navigator.banned.text"),ue.DEFAULT,null,null,m("navigator.banned.title"));break;default:E(m("room.queue.error.title"),ue.DEFAULT,null,null,m("room.queue.error.title"));break}Qi()}),F(dp,_=>ee("navigator/show")),{categories:o,doorData:d,setDoorData:h,topLevelContext:s,topLevelContexts:c,searchResult:g,navigatorData:p}},xn=()=>ct(iN),lN=()=>{const[o,e]=i.useState(new ol),n=i.useMemo(()=>K("hc.disabled",!1),[]),r=i.useMemo(()=>n||o.clubDays>0?Hn.ACTIVE:o.pastVipDays>0||o.pastVipDays>0?Hn.EXPIRED:Hn.NONE,[o,n]),s=a=>{if(a===-1)return o.credits;for(const[c,u]of o.activityPoints.entries())if(c===a)return u;return 0};return F(mp,a=>{const c=a.getParser();e(u=>{const d=Kt(u);return d.credits=parseFloat(c.credits),u.credits!==d.credits&&ar(mn.CREDITS),d})}),F(gp,a=>{const c=a.getParser();e(u=>{const d=Kt(u);return d.activityPoints=c.currencies,d})}),F(ku,a=>{const c=a.getParser();e(u=>{const d=Kt(u);return d.activityPoints=new Map(d.activityPoints),d.activityPoints.set(c.type,c.amount),c.type===0&&ar(mn.DUCKETS),d})}),F(fp,a=>{const c=a.getParser(),u=c.productName;u!=="club_habbo"&&u!=="habbo_club"||e(d=>{const h=Kt(d);return h.clubDays=Math.max(0,c.daysToPeriodEnd),h.clubPeriods=Math.max(0,c.periodsSubscribedAhead),h.isVip=c.isVip,h.pastClubDays=c.pastClubDays,h.pastVipDays=c.pastVipDays,h.isExpiring=c.responseType===hp.RESPONSE_TYPE_DISCOUNT_AVAILABLE,h.minutesUntilExpiration=c.minutesUntilExpiration,h.minutesSinceLastModified=c.minutesSinceLastModified,h})}),i.useEffect(()=>{if(n)return;A(new Rl("habbo_club"));const a=setInterval(()=>A(new Rl("habbo_club")),5e4);return()=>clearInterval(a)},[n]),i.useEffect(()=>{A(new pp)},[]),{purse:o,hcDisabled:n,clubStatus:r,getCurrencyAmount:s}},es=()=>ct(lN),cN=(o,e)=>{i.useEffect(()=>{if(!o)return;const n=r=>e(r);return sr.addEventListener(we.FURNI_ADDED,n),()=>{sr.removeEventListener(we.FURNI_ADDED,n)}},[o,e])},Nn=(o,e)=>{i.useEffect(()=>{if(!o)return;const n=r=>e(r);return sr.addEventListener(we.FURNI_REMOVED,n),()=>{sr.removeEventListener(we.FURNI_REMOVED,n)}},[o,e])},uN=o=>{lt(we.OBJECT_DESELECTED,o)},dN=o=>{lt(we.OBJECT_ROLL_OUT,o)},mN=o=>{lt(we.OBJECT_ROLL_OVER,o)},ml=o=>{lt(we.OBJECT_SELECTED,o)},Em=(o,e)=>{i.useEffect(()=>{if(!o)return;const n=r=>e(r);return sr.addEventListener(we.USER_ADDED,n),()=>{sr.removeEventListener(we.USER_ADDED,n)}},[o,e])},Cm=(o,e)=>{i.useEffect(()=>{if(!o)return;const n=r=>e(r);return sr.addEventListener(we.USER_REMOVED,n),()=>{sr.removeEventListener(we.USER_REMOVED,n)}},[o,e])},gN=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(!1);return F(Ip,s=>{const a=s.getParser();a&&e(a)}),{promoteInformation:o,isExtended:n,setPromoteInformation:e,setIsExtended:r}},gl=()=>ct(gN),hN=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(null),[s,a]=i.useState(null),[c,u]=i.useState(0),d=(g,f,p,C=!1)=>{if(!n)return;const E=cn.hslToRGB(((g&255)<<16)+((f&255)<<8)+(p&255));C&&u(E),!g&&!f&&!p?n.tint=0:n.tint=E},h=g=>{if(!s)return;const f=g>>16&255,p=g>>8&255,C=g&255;s.red=f/255,s.green=p/255,s.blue=C/255};return lt(Tr.PREVIEW,g=>d(g.hue,g.saturation,g.lightness)),lt(Tr.CLEAR_PREVIEW,g=>{n&&(n.tint=c)}),Te(Ep.ROOM_BACKGROUND_COLOR,g=>{jr.isRoomPreviewerId(g.roomId)||(g.enable?d(g.hue,g.saturation,g.lightness,!0):d(0,0,0,!0))}),Te(Cp.ROOM_COLOR,g=>{if(jr.isRoomPreviewerId(g.roomId))return;let f=0,p=255;g.bgOnly||(f=g.color,p=g.brightness),h(cn.hslToRGB((cn.rgbToHSL(f)&16776960)+p))}),Te([En.INITIALIZED,En.DISPOSED],g=>{if(jr.isRoomPreviewerId(g.roomId))return;const f=Oe();if(f)switch(g.type){case En.INITIALIZED:$l(g.roomId),e(f);return;case En.DISPOSED:e(null);return}}),Ye([jt.CREATED,jt.ENDED],g=>{switch(g.type){case jt.CREATED:gb(g.session);return;case jt.ENDED:e(null);return}}),Te([It.SELECTED,It.DESELECTED,It.ADDED,It.REMOVED,It.PLACED,It.REQUEST_MOVE,It.REQUEST_ROTATE,It.MOUSE_ENTER,It.MOUSE_LEAVE,It.DOUBLE_CLICK],g=>{if(jr.isRoomPreviewerId(g.roomId))return;let f=null;switch(g.type){case It.SELECTED:fb(g)||(f=new we(we.OBJECT_SELECTED,g.objectId,g.category,g.roomId));break;case It.DESELECTED:f=new we(we.OBJECT_DESELECTED,g.objectId,g.category,g.roomId);break;case It.ADDED:{let p=null;switch(g.category){case Q.FLOOR:case Q.WALL:p=we.FURNI_ADDED;break;case Q.UNIT:p=we.USER_ADDED;break}p&&(f=new we(p,g.objectId,g.category,g.roomId));break}case It.REMOVED:{let p=null;switch(g.category){case Q.FLOOR:case Q.WALL:p=we.FURNI_REMOVED;break;case Q.UNIT:p=we.USER_REMOVED;break}p&&(f=new we(p,g.objectId,g.category,g.roomId));break}case It.REQUEST_MOVE:Ys(o,g.objectId,g.category)&&us(g.objectId,g.category,Vn.OBJECT_MOVE);break;case It.REQUEST_ROTATE:Ys(o,g.objectId,g.category)&&us(g.objectId,g.category,Vn.OBJECT_ROTATE_POSITIVE);break;case It.MOUSE_ENTER:f=new we(we.OBJECT_ROLL_OVER,g.objectId,g.category,g.roomId);break;case It.MOUSE_LEAVE:f=new we(we.OBJECT_ROLL_OUT,g.objectId,g.category,g.roomId);break;case It.DOUBLE_CLICK:f=new we(we.OBJECT_DOUBLE_CLICKED,g.objectId,g.category,g.roomId);break}f&&St(f)}),i.useEffect(()=>{if(!o)return;const g=_e(),f=$(),p=o.roomId,C=1,E=Math.floor(window.innerWidth),_=Math.floor(window.innerHeight),I=g.application.renderer;I&&(I.view.style.width=`${E}px`,I.view.style.height=`${_}px`,I.resolution=window.devicePixelRatio,I.resize(E,_));const b=f.getRoomInstanceDisplay(p,C,E,_,_p.SCALE_ZOOMED_IN),N=$().getRoomInstanceRenderingCanvas(p,C);if(!b||!N)return;const v=new za(bp.WHITE),O=new Sp,R=N.master;v.tint=0,v.width=E,v.height=_,R.addChildAt(v,0),R.filters=[O],r(v),a(O);const y=f.getRoomInstanceGeometry(p,C);if(y){const B=f.getRoomInstanceVariable(p,ga.ROOM_MIN_X)||0,M=f.getRoomInstanceVariable(p,ga.ROOM_MAX_X)||0,U=f.getRoomInstanceVariable(p,ga.ROOM_MIN_Y)||0,W=f.getRoomInstanceVariable(p,ga.ROOM_MAX_Y)||0;let L=(B+M)/2,x=(U+W)/2;const j=20;L=L+(j-1),x=x+(j-1);const H=Math.sqrt(j*j+j*j)*Math.tan(30/180*Math.PI);y.location=new wt(L,x,H)}const G=g.application.stage;if(!G)return;G.addChild(b),$l(o.roomId);const k=B=>{const M=Math.floor(window.innerWidth),U=Math.floor(window.innerHeight);I.view.style.width=`${M}px`,I.view.style.height=`${U}px`,I.resolution=window.devicePixelRatio,I.resize(M,U),v.width=M,v.height=U,hb(M,U,1),g.application.render()};return window.addEventListener("resize",k),()=>{r(null),a(null),u(0),window.removeEventListener("resize",k)}},[o]),{roomSession:o}},xe=()=>ct(hN),fN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(0),{roomSession:c=null}=xe(),u=()=>{const g=cn.rgbToHSL(s),[f,p,C,E]=en.int_to_8BitVals(g);A(new Np(o,p,C,E))},d=()=>c.useMultistateItem(o),h=()=>{St(new Tr(Tr.CLEAR_PREVIEW)),e(-1),r(-1),a(0)};return Te(ve.REQUEST_BACKGROUND_COLOR,g=>{if(!Ys(c,g.objectId,g.category))return;const p=$().getRoomObject(g.roomId,g.objectId,g.category).model;e(g.objectId),r(g.category);const C=parseInt(p.getValue(ae.FURNITURE_ROOM_BACKGROUND_COLOR_HUE)),E=parseInt(p.getValue(ae.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION)),_=parseInt(p.getValue(ae.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS)),I=en.eight_bitVals_to_int(0,C,E,_),b=cn.hslToRGB(I);a(b)}),Nn(o!==-1&&n!==-1,g=>{g.id!==o||g.category!==n||h()}),i.useEffect(()=>{if(o===-1||n===-1)return;const g=cn.rgbToHSL(s),[f,p,C,E]=en.int_to_8BitVals(g);St(new Tr(Tr.PREVIEW,p,C,E))},[o,n,s]),{objectId:o,color:s,setColor:a,applyToner:u,toggleToner:d,onClose:h}},pN=fN,IN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState("1"),[c,u]=i.useState(""),[d,h]=i.useState(""),[g,f]=i.useState(""),[p,C]=i.useState(""),{simpleAlert:E=null}=Je(),_=()=>{e(-1),r(-1),a("1"),u(""),h(""),f(""),C("")};return Te([ve.REQUEST_BADGE_DISPLAY_ENGRAVING,ve.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING],I=>{const b=$().getRoomObject(I.roomId,I.objectId,I.category);if(!b)return;const N=new ea;N.initializeFromRoomObjectModel(b.model),e(I.objectId),r(I.category),a("1"),u(sa(N.getValue(1))),h(el(N.getValue(1))),f(N.getValue(2)),C(N.getValue(3))}),Te(ve.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,I=>{const b=$().getRoomObject(I.roomId,I.objectId,I.category);!b||b.model.getValue(ae.FURNITURE_OWNER_ID)!==q().userId||E(`${m("resolution.failed.subtitle")} ${m("resolution.failed.text")}`,null,null,null,m("resolution.failed.title"))}),Nn(o!==-1&&n!==-1,I=>{I.id!==o||I.category!==n||_()}),{objectId:o,category:n,color:s,badgeName:c,badgeDesc:d,date:g,senderName:p,onClose:_}},EN=IN,xi="MONSTERPLANT_SEED_CONFIRMATION",Fi="PURCHASABLE_CLOTHING_CONFIRMATION",_m="GROUP_FURNITURE",bm="EFFECTBOX_OPEN",Bi="MYSTERYTROPHY_OPEN_DIALOG",CN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(null),[s,a]=i.useState(null),[c,u]=i.useState(-1),[d,h]=i.useState(null),[g,f]=i.useState(!1),[p,C]=i.useState(-1),{roomSession:E=null}=xe(),_=()=>{e(-1),h(null),f(!1),r(null)},I=()=>{a(null),u(-1)},b=N=>{if(N)switch(N){case"use_friend_furni":E.useMultistateItem(o);break;case"use_monsterplant_seed":a(xi),u(o);break;case"use_random_teleport":$().useRoomObject(o,Q.FLOOR);break;case"use_purchaseable_clothing":a(Fi),u(o);break;case"use_mystery_box":E.useMultistateItem(o);break;case"use_mystery_trophy":a(Bi),u(o);break;case"join_group":al(d.guildId),f(!0);return;case"go_to_group_homeroom":d&&_n(d.guildHomeRoomId);break}_()};return Te([ve.OPEN_FURNI_CONTEXT_MENU,ve.CLOSE_FURNI_CONTEXT_MENU,ve.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,ve.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,ve.REQUEST_EFFECTBOX_OPEN_DIALOG,ve.REQUEST_MYSTERYBOX_OPEN_DIALOG,ve.REQUEST_MYSTERYTROPHY_OPEN_DIALOG],N=>{const v=$().getRoomObject(E.roomId,N.objectId,N.category);if(v)switch(C(v.model.getValue(ae.FURNITURE_OWNER_ID)),N.type){case ve.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:if(!Ht(v))return;u(v.id),a(xi),_();return;case ve.REQUEST_EFFECTBOX_OPEN_DIALOG:if(!Ht(v))return;u(v.id),a(bm),_();return;case ve.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:if(!Ht(v))return;u(v.id),a(Fi),_();return;case ve.REQUEST_MYSTERYBOX_OPEN_DIALOG:E.useMultistateItem(v.id),_();return;case ve.REQUEST_MYSTERYTROPHY_OPEN_DIALOG:if(!Ht(v))return;u(v.id),a(Bi),_();return;case ve.OPEN_FURNI_CONTEXT_MENU:switch(e(v.id),N.contextMenu){case Mt.FRIEND_FURNITURE:r(Mt.FRIEND_FURNITURE);return;case Mt.MONSTERPLANT_SEED:Ht(v)&&r(Mt.MONSTERPLANT_SEED);return;case Mt.MYSTERY_BOX:r(Mt.MYSTERY_BOX);return;case Mt.MYSTERY_TROPHY:Ht(v)&&r(Mt.MYSTERY_TROPHY);return;case Mt.RANDOM_TELEPORT:r(Mt.RANDOM_TELEPORT);return;case Mt.PURCHASABLE_CLOTHING:Ht(v)&&r(Mt.PURCHASABLE_CLOTHING);return}return;case ve.CLOSE_FURNI_CONTEXT_MENU:v.id===o&&_();return}}),F(Tp,N=>{const v=N.getParser();e(v.objectId),h(v),f(v.userIsMember),r(_m)}),{objectId:o,mode:n,confirmMode:s,confirmingObjectId:c,groupData:d,isGroupMember:g,objectOwnerId:p,closeConfirm:I,processAction:b,onClose:_}},_N=CN,bN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState([]),[s,a]=i.useState(null),[c,u]=i.useState([]),[d,h]=i.useState(null),[g,f]=i.useState(new Map),[p,C]=i.useState(!1),{groupItems:E=[],getItemsByType:_=null,activate:I=null,deactivate:b=null}=Zr(),{simpleAlert:N=null}=Je(),v=s&&g.get(s.name)||null,O=()=>{r([]),a(null),u([]),f(new Map)},R=()=>{e(-1),O()},y=()=>{C(!0),A(new Ap(o,s.name))},G=k=>{a(k),g.get(k.name)||A(new Pp(k.name))};return Te(ve.OPEN_WIDGET,k=>{k.widget===vp.CRAFTING&&(e(k.objectId),O(),A(new wp(k.objectId)))}),F(Rp,k=>{const B=k.getParser();if(!B.isActive()){e(-1);return}r(M=>{const U=[];for(const W of B.recipes){const L=$().roomContentLoader._activeObjectTypeIds.get(W.itemName),x=$().getFurnitureFloorIconUrl(L);U.push({name:W.recipeName,localizedName:m("roomItem.name."+L),iconUrl:x})}return U}),h(B.ingredients)}),F(yp,k=>{const B=k.getParser();f(M=>{const U=new Map(M);return U.set(s.name,B.ingredients),U})}),F(Op,k=>{a(null),C(!1),k.getParser().result&&N(m("crafting.info.result.ok"))}),F(kp,k=>{}),i.useEffect(()=>{!d||!d.length||u(k=>{const B=[];for(const M of d){const U=$().roomContentLoader._activeObjectTypeIds.get(M),W=$().getFurnitureFloorIconUrl(U),L=_(U);let x=0;if(L)for(const j of L)x+=j.items.length;B.push({name:M,iconUrl:W,count:x})}return B})},[E,d,_]),i.useEffect(()=>{if(o===-1)return;const k=I();return()=>b(k)},[o,I,b]),{objectId:o,recipes:n,ingredients:c,selectedRecipe:s,requiredIngredients:v,isCrafting:p,selectRecipe:G,craft:y,onClose:R}},SN=bN,NN=()=>{const[o,e]=i.useState([]),[n,r]=i.useState(0),[s,a]=i.useState(0),[c,u]=i.useState(0),[d,h]=i.useState(0),[g,f]=i.useState(16777215),[p,C]=i.useState(255),[E,_]=i.useState(0),[I,b]=i.useState(0),[N,v]=i.useState(0),{roomSession:O=null}=xe(),R=()=>O.isRoomOwner||O.controllerLevel>=nt.GUEST||q().isModerator,y=k=>{const B=o[k-1];B&&(r(B.id),_(B.type),b(B.color),v(B.light))},G=()=>{if(s===0)return;const k=n-1;if(n<1||n>o.length)return;const B=o[k];!B||E===B.type&&I===B.color&&N===B.light||(e(M=>{const U=[...M];return U[k]=new lc(B.id,E,I,N),U}),an.savePreset(B.id,E,I,N,!0))};return Te(ve.REQUEST_DIMMER,k=>{R()&&O.requestMoodlightSettings()}),Ye(Dp.ROOM_DIMMER_PRESETS,k=>{const B=[];let M=0;for(;M<k.presetCount;){const U=k.getPreset(M);U&&B.push(new lc(U.id,U.type,U.color,U.brightness)),M++}e(B),r(k.selectedPresetId)}),Te(Mp.ROOM_COLOR,k=>{jr.isRoomPreviewerId(k.roomId)||(u(s),a(k.state),r(k.presetId),h(k.effectId),_(k.effectId),f(k.color),b(k.color),C(k.brightness),v(k.brightness))}),i.useEffect(()=>{s===0&&c===0||an.previewDimmer(I,N,E===2)},[s,c,I,N,E]),{presets:o,selectedPresetId:n,dimmerState:s,lastDimmerState:c,effectId:d,color:g,brightness:p,selectedEffectId:E,setSelectedEffectId:_,selectedColor:I,setSelectedColor:b,selectedBrightness:N,setSelectedBrightness:v,selectPresetId:y,applyChanges:G}},TN=NN,vN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(0),c=()=>{e(-1),r(-1),a(0)},u=()=>{Oe().connection.send(new Lp(o)),c()};return Te(ve.REQUEST_CREDITFURNI,d=>{const h=$().getRoomObject(d.roomId,d.objectId,d.category);!h||!Ht(h)||(e(d.objectId),r(d.category),a(h.model.getValue(ae.FURNITURE_CREDIT_VALUE)||0))}),Nn(o!==-1&&n!==-1,d=>{d.id!==o||d.category!==n||c()}),{objectId:o,value:s,redeem:u,onClose:c}},wN=vN,RN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(-1),[c,u]=i.useState([]),{roomSession:d=null}=xe(),h=()=>{e(-1),r(-1),a(-1),u([])};return Te(ve.REQUEST_EXTERNAL_IMAGE,g=>{const f=$().getRoomObject(g.roomId,g.objectId,g.category),p=$().getRoomObjects(d==null?void 0:d.roomId,Q.WALL);if(!f)return;const C=[];p.forEach(_=>{if(_.type!=="external_image_wallitem_poster_small"&&_.type!=="external_image_wallitem_poster")return null;const I=_.model.getValue(ae.FURNITURE_DATA),b=JSON.parse(I);C.push(b)}),e(g.objectId),r(g.category),u(C);const E=JSON.parse(f.model.getValue(ae.FURNITURE_DATA));a(_=>{let I=0;return E&&(I=C.findIndex(b=>b.u===E.u)),I<0&&(I=0),I})}),Nn(o!==-1&&n!==-1,g=>{g.id!==o||g.category!==n||h()}),{objectId:o,currentPhotoIndex:s,currentPhotos:c,onClose:h}},yN=RN,ON=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(0),[c,u]=i.useState([]),[d,h]=i.useState([]),[g,f]=i.useState(null),[p,C]=i.useState(0),E=()=>{e(-1),r(-1),a(0),u([]),h([]),f(null)},_=I=>{Oe().connection.send(new Bp(o,I)),E()};return F(Up,I=>{const b=I.getParser();e(b.furniId),C(b.start?1:2)}),F(xp,I=>E()),F(Fp,I=>E()),Te(ve.REQUEST_FRIEND_FURNITURE_ENGRAVING,I=>{const b=$().getRoomObject(I.roomId,I.objectId,I.category);if(!b)return;const N=b.model.getValue(ae.FURNITURE_DATA),v=b.model.getValue(ae.FURNITURE_FRIENDFURNI_ENGRAVING);N[0]!=="1"||N.length!==6||(e(I.objectId),r(I.category),a(v),u([N[1],N[2]]),h([N[3],N[4]]),f(N[5]),C(0))}),Nn(o!==-1&&n!==-1,I=>{I.id!==o||I.category!==n||E()}),{objectId:o,type:s,usernames:c,figures:d,date:g,stage:p,onClose:E,respond:_}},kN=ON,AN=["perteam","mostwins","classic"],PN=["alltime","daily","weekly","monthly"],DN=()=>{const[o,e]=i.useState(new Map),{roomSession:n=null}=xe(),r=a=>AN[a],s=a=>PN[a];return Te(ve.REQUEST_HIGH_SCORE_DISPLAY,a=>{const c=$().getRoomObject(a.roomId,a.objectId,a.category);if(!c)return;const u=c.model.getValue(ae.FURNITURE_DATA_FORMAT),d=yu.getData(u);d.initializeFromRoomObjectModel(c.model),e(h=>{const g=new Map(h);return g.set(c.id,d),g})}),Te(ve.REQUEST_HIDE_HIGH_SCORE_DISPLAY,a=>{a.roomId===n.roomId&&e(c=>{const u=new Map(c);return u.delete(a.objectId),u})}),{stuffDatas:o,getScoreType:r,getClearType:s}},MN=DN,LN="internalLink",UN=()=>(Te(ve.REQUEST_INTERNAL_LINK,o=>{const e=$().getRoomObject(o.roomId,o.objectId,o.category);if(!e)return;let r=e.model.getValue(ae.FURNITURE_DATA)[LN];(!r||!r.length)&&(r=e.model.getValue(ae.FURNITURE_INTERNAL_LINK)),r&&r.length&&ee(r)}),{}),xN=UN,FN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(null),[c,u]=i.useState(null),[d,h]=i.useState(dn.NO_CLUB),[g,f]=i.useState(null),p=()=>{e(-1),r(-1),a(null),u(null),f(null)},C=()=>{o!==-1&&(A(new Gp(o)),p())},E=()=>{o!==-1&&(A(new bi(o)),p())},_=()=>{o!==-1&&A(new Vp(o,g))};return Te(ve.REQUEST_MANNEQUIN,I=>{const b=$().getRoomObject(I.roomId,I.objectId,I.category);if(!b)return;const N=b.model,v=N.getValue(ae.FURNITURE_MANNEQUIN_FIGURE)||null,O=N.getValue(ae.FURNITURE_MANNEQUIN_GENDER)||null,R=Nt().createFigureContainer(v),y=Nt().getFigureClubLevel(R,O,fs.MANNEQUIN_CLOTHING_PART_TYPES);e(I.objectId),r(I.category),a(v),u(O),h(y),f(N.getValue(ae.FURNITURE_MANNEQUIN_NAME)||null)}),Nn(o!==-1&&n!==-1,I=>{I.id!==o||I.category!==n||p()}),{objectId:o,figure:s,gender:c,clubLevel:d,name:g,setName:f,saveFigure:C,wearFigure:E,saveName:_,onClose:p}},BN=FN,GN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(-1),[c,u]=i.useState(new Hs),[d,h]=i.useState([]),{roomSession:g=null}=xe(),{showSingleBubble:f=null,simpleAlert:p=null}=Je(),C=()=>{e(-1),r(-1)},E=i.useCallback((N,v)=>A(new Hp(N,v)),[]),_=i.useCallback(N=>A(new Wp(N)),[]),I=i.useCallback((N,v)=>A(new bi(N,v)),[]);Te(ve.REQUEST_PLAYLIST_EDITOR,N=>{var O,R,y;const v=$().getRoomObject(N.roomId,N.objectId,N.category);if(v){if(Ht(v)){e(N.objectId),r(N.category),(O=_e().soundManager.musicController)==null||O.requestUserSongDisks(),(y=(R=_e().soundManager.musicController)==null?void 0:R.getRoomItemPlaylist())==null||y.requestPlayList();return}(g.isRoomOwner||g.controllerLevel>=nt.GUEST||q().isModerator)&&A(new bi(N.objectId,-2))}}),Nn(o!==-1&&n!==-1,N=>{N.id!==o||N.category!==n||C()}),Wr(Hu.NPE_SONG_CHANGED,N=>{a(N.position)}),Wr(jp.NOTIFY_PLAYED_SONG,N=>{f(m("soundmachine.notification.playing",["songname","songauthor"],[N.name,N.creator]),Xe.SOUNDMACHINE)}),Wr(qp.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT,N=>{var v;u((v=_e().soundManager.musicController)==null?void 0:v.songDiskInventory.clone())}),Wr(yl.PLUE_PLAY_LIST_UPDATED,N=>{var v,O;h((O=(v=_e().soundManager.musicController)==null?void 0:v.getRoomItemPlaylist())==null?void 0:O.entries.concat())}),Wr(yl.PLUE_PLAY_LIST_FULL,N=>{p(m("playlist.editor.alert.playlist.full"),ue.ALERT,"","",m("playlist.editor.alert.playlist.full.title"))});const b=N=>{var v,O;o!==-1&&(N instanceof _i?N.getParser().fragmentNumber===0&&((v=_e().soundManager.musicController)==null||v.requestUserSongDisks()):(O=_e().soundManager.musicController)==null||O.requestUserSongDisks())};return F(_i,b),F(Fu,b),F(xu,b),{objectId:o,diskInventory:c,playlist:d,currentPlayingIndex:s,onClose:C,addToPlaylist:E,removeFromPlaylist:_,togglePlayPause:I}},VN=GN,hc="floor",HN="wallpaper",fc="landscape",WN="poster",jN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(null),[c,u]=i.useState(null),[d,h]=i.useState(!1),[g,f]=i.useState(null),[p,C]=i.useState(null),[E,_]=i.useState(-1),[I,b]=i.useState(null),[N,v]=i.useState(!1),[O,R]=i.useState(null),{roomSession:y=null}=xe(),G=()=>{e(-1),r(-1),a(null),u(null),h(!1),f(null),C(null),_(-1),b(null),v(!1),R(null)},k=()=>{o!==-1&&(y.openGift(o),$().changeObjectModelData($().activeRoomId,o,Q.FLOOR,ae.FURNITURE_DISABLE_PICKING_ANIMATION,1))},B=i.useMemo(()=>({imageReady:(M,U,W)=>{!W&&U&&(W=rr.generateImage(U)),R(W.src)},imageFailed:null}),[]);return Ye(zp.RSPE_PRESENT_OPENED,M=>{let U=null;M.itemType===de.FLOOR?U=q().getFloorItemData(M.classId):M.itemType===de.WALL&&(U=q().getWallItemData(M.classId));let W=!1;if(M.placedInRoom){const L=$().getRoomObject(y.roomId,M.placedItemId,Q.FLOOR);L&&(W=Ht(L))}switch(M.itemType){case de.WALL:{if(U)switch(U.className){case hc:case fc:case HN:let L=null;U.className===hc?L=m("inventory.furni.item.floor.name"):U.className===fc?L=m("inventory.furni.item.landscape.name"):L=m("inventory.furni.item.wallpaper.name"),u(L);break;case WN:{const x=M.productCode;let j=null;x.indexOf("poster")===0&&(j=x.replace("poster",""));const H=q().getProductData(x);let te=null;H?te=H.name:U&&(te=U.name),u(te),R($().getFurnitureWallIconUrl(M.classId,j));break}default:{u(U.name||null),R($().getFurnitureWallIconUrl(M.classId));break}}break}case de.HABBO_CLUB:u(m("widget.furni.present.hc"));break;default:{if(M.placedItemType===de.PET){const x=M.petFigureString;if(x&&x.length){const j=new Is(x),H=$().getRoomObjectPetImage(j.typeId,j.paletteId,j.color,new wt(90),64,B,!0,0,j.customParts);H&&R(H.getImage().src)}}else{const x=$().getFurnitureFloorImage(M.classId,new wt(90),64,B);x&&R(x.getImage().src)}const L=q().getProductData(M.productCode);u(L&&L.name||U.name);break}}e(0),r(M.classId),a(M.itemType),h(W),_(M.placedItemId),b(M.placedItemType),v(M.placedInRoom)}),Te(ve.REQUEST_PRESENT,M=>{const U=$().getRoomObject(M.roomId,M.objectId,M.category);if(!U)return null;G(),e(M.objectId),r(-1),u(U.model.getValue(ae.FURNITURE_DATA)||""),h(Ht(U)),f(U.model.getValue(ae.FURNITURE_PURCHASER_NAME)||null),C(U.model.getValue(ae.FURNITURE_PURCHASER_FIGURE)||null)}),Nn(o!==-1,M=>{M.id===o&&G(),M.id===E&&N&&v(!1)}),{objectId:o,classId:n,itemType:s,text:c,isOwnerOfFurniture:d,senderName:g,senderFigure:p,placedItemId:E,placedItemType:I,placedInRoom:N,imageUrl:O,openPresent:k,onClose:G}},qN=jN,zN="internalLink",YN=()=>{const[o,e]=i.useState(0);return Te(ve.REQUEST_ROOM_LINK,n=>{const r=$().getRoomObject(n.roomId,n.objectId,n.category);if(!r)return;let a=r.model.getValue(ae.FURNITURE_DATA)[zN];(!a||!a.length)&&(a=r.model.getValue(ae.FURNITURE_INTERNAL_LINK)),!(!a||!a.length)&&(a=parseInt(a,10),!isNaN(a)&&(e(a),A(new $a(a,!1,!1))))}),F(ws,n=>{!o||n.getParser().data.roomId!==o||e(0)}),{}},$N=YN,KN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(""),[c,u]=i.useState(""),[d,h]=i.useState("0"),[g,f]=i.useState(""),[p,C]=i.useState(!1),{getWallItemById:E=null}=Zr(),_=()=>{A(new $p(o,c,d,g)),e(-1),r(-1),a(""),u(""),h("0"),f(""),C(!1)};return F(Yp,I=>{const b=I.getParser();e(b.itemId),r(Q.WALL);const N=E(b.itemId);let v="post_it";if(N){const O=$().getFurnitureWallName(N.type);O.match("post_it_")&&(v=O)}a(v),u(b.location),h("FFFF33"),f(""),C(!0)}),{objectId:o,color:d,setColor:h,text:g,setText:f,canModify:p,onClose:_}},XN=KN,Qo=40,QN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(0),[c,u]=i.useState(-1),d=()=>{e(-1),r(-1),a(0),u(-1)},h=(g,f=!1)=>{g||(g=0),g=Math.abs(g),f||g>Qo&&(g=Qo),a(parseFloat(g.toFixed(2))),f||u(g*100)};return F(Kp,g=>{const f=g.getParser();o===f.furniId&&h(f.height,!0)}),Te(ve.REQUEST_STACK_HEIGHT,g=>{if(!Ys(Oe(),g.objectId,g.category))return;const f=$().getRoomObject(g.roomId,g.objectId,g.category);f&&(e(g.objectId),r(g.category),a(f.getLocation().z),u(-1))}),Nn(o!==-1&&n!==-1,g=>{g.id!==o||g.category!==n||d()}),i.useEffect(()=>{if(o===-1||c===-1)return;const g=setTimeout(()=>A(new Si(o,~~c)),10);return()=>clearTimeout(g)},[o,c]),{objectId:o,height:s,maxHeight:Qo,onClose:d,updateHeight:h}},JN=QN,ZN=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState("0"),[c,u]=i.useState(""),[d,h]=i.useState(""),[g,f]=i.useState(!1),p=()=>{e(-1),r(-1),a("0"),u(""),h(""),f(!1)},C=I=>{I!==s&&(a(I),$().modifyRoomObjectData(o,n,I,c))},E=I=>{u(I),$().modifyRoomObjectData(o,n,s,I)},_=()=>$().deleteRoomObject(o,n);return Te(ve.REQUEST_STICKIE,I=>{const b=$().getRoomObject(I.roomId,I.objectId,I.category);if(!b)return;const N=b.model.getValue(ae.FURNITURE_ITEMDATA);if(N.length<6)return;let v=null,O=null;N.indexOf(" ")>0?(v=N.slice(0,N.indexOf(" ")),O=N.slice(N.indexOf(" ")+1,N.length)):v=N,e(I.objectId),r(I.category),a(v||"0"),u(O||""),h(b.type||"post_it"),f(Oe().isRoomOwner||q().isModerator||Ht(b))}),Nn(o!==-1&&n!==-1,I=>{I.id!==o||I.category!==n||p()}),{objectId:o,color:s,text:c,type:d,canModify:g,updateColor:C,updateText:E,trash:_,onClose:p}},eT=ZN,tT=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState("1"),[c,u]=i.useState(""),[d,h]=i.useState(""),[g,f]=i.useState(""),p=()=>{e(-1),r(-1),a("1"),u(""),h(""),f("")};return Te(ve.REQUEST_TROPHY,C=>{const E=$().getRoomObject(C.roomId,C.objectId,C.category);if(!E)return;let _=E.model.getValue(ae.FURNITURE_DATA);E.model.getValue(ae.FURNITURE_EXTRAS),e(C.objectId),r(C.category),a(E.model.getValue(ae.FURNITURE_COLOR)||"1");const I=_.substring(0,_.indexOf("	"));_=_.substring(I.length+1,_.length);const b=_.substring(0,_.indexOf("	")),N=_.substr(b.length+1,_.length);u(I),h(b),f(N)}),Nn(o!==-1&&n!==-1,C=>{C.id!==o||C.category!==n||p()}),{objectId:o,color:s,senderName:c,date:d,message:g,onClose:p}},nT=tT,rT=0,sT=1,aT=2,oT=3,iT=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(-1),[s,a]=i.useState(null),[c,u]=i.useState(null),[d,h]=i.useState(null),[g,f]=i.useState(-1),[p,C]=i.useState(null),[E,_]=i.useState(null),[I,b]=i.useState(!1),N=()=>{e(-1),r(-1),a(null),u(null),h(null),f(-1),C(null),_(null),b(!1)},v=()=>A(new ha(o,rT)),O=()=>A(new ha(o,sT)),R=()=>I&&s&&s.length&&A(new ha(o,aT)),y=()=>I&&s&&s.length&&A(new ha(o,oT)),G=k=>{if(p===k){C(null),A(new Ol(o,""));return}C(k),A(new Ol(o,k))};return Te(ve.REQUEST_YOUTUBE,k=>{if(jr.isRoomPreviewerId(k.roomId))return;const B=$().getRoomObject(k.roomId,k.objectId,k.category);B&&(e(k.objectId),r(k.category),b(q().hasSecurity(js.EMPLOYEE)||Ht(B)),A(new Xp(k.objectId)))}),F(Qp,k=>{const B=k.getParser();o===-1||o!==B.furniId||(a(B.videoId),u(B.startAtSeconds),h(B.endAtSeconds),f(B.state))}),F(Jp,k=>{const B=k.getParser();o===-1||o!==B.furniId||(_(B.playlists),C(B.selectedPlaylistId),a(null),f(-1),h(null),u(null))}),F(Zp,k=>{const B=k.getParser();if(!(o===-1||o!==B.furniId))switch(B.commandId){case 1:f(An.PLAYING);break;case 2:f(An.PAUSED);break}}),Nn(o!==-1&&n!==-1,k=>{k.id!==o||k.category!==n||N()}),{objectId:o,videoId:s,videoStart:c,videoEnd:d,currentVideoState:g,selectedVideo:p,playlists:E,onClose:N,previous:v,next:O,pause:R,play:y,selectVideo:G}},lT=iT,cT=()=>{const[o,e]=i.useState(null),[n,r]=i.useState([]),[s,a]=i.useState(""),[c,u]=i.useState([]),[d,h]=i.useState(0),[g,f]=i.useState(le.STUFF_SELECTION_OPTION_NONE),{showConfirm:p=null}=Je(),C=()=>{const _=I=>{I&&(I instanceof Wu?A(new sI(I.id,n,s,c,d,I.stuffTypeSelectionCode)):I instanceof ju?A(new aI(I.id,n,s,c,I.stuffTypeSelectionCode)):I instanceof qu&&A(new oI(I.id,n,s,c,I.stuffTypeSelectionCode)))};db(o.id)?_(o):p(m("wiredfurni.nonowner.change.confirm.body"),()=>{_(o)},null,null,null,m("wiredfurni.nonowner.change.confirm.title"))},E=(_,I)=>{!o||!g||_<=0||u(b=>{const N=[...b],v=b.indexOf(_);return v>=0?(N.splice(v,1),Bs.hide(_)):N.length<o.maximumItemSelectionCount&&(N.push(_),Bs.show(_)),N})};return F(eI,_=>{_.getParser(),e(null)}),F(tI,_=>{const I=_.getParser();e(I.definition)}),F(nI,_=>{const I=_.getParser();e(I.definition)}),F(rI,_=>{const I=_.getParser();e(I.definition)}),i.useEffect(()=>{if(o)return()=>{r([]),a(""),h(0),u(_=>(_&&_.length&&Bs.clearSelectionShaderFromFurni(_),[])),f(le.STUFF_SELECTION_OPTION_NONE)}},[o]),{trigger:o,setTrigger:e,intParams:n,setIntParams:r,stringParam:s,setStringParam:a,furniIds:c,setFurniIds:u,actionDelay:d,setActionDelay:h,setAllowsFurni:f,saveWired:C,selectObjectForWired:E}},Se=()=>ct(cT),uT=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(null),[s,a]=i.useState([]),[c,u]=i.useState([]),[d,h]=i.useState(null),[g,f]=i.useState(-1),[p,C]=i.useState(!1),{friends:E=[]}=fn(),{selectObjectForWired:_=null}=Se(),{roomSession:I=null}=xe(),b=y=>{a(G=>{const k=[...G];return k.splice(y,1),k})},N=y=>{u(G=>{const k=[...G],B=k.splice(y,1)[0];return d===B&&h(null),k})},v=y=>{h(y),u([])},O=(y,G)=>{const k=ss.getObjectName(y,G);k&&(r(k),G!==Q.UNIT&&u([]))},R=(y,G)=>{let k=null;switch(G){case Q.FLOOR:case Q.WALL:k=ss.getFurniInfo(y,G),k&&_(y,G);break;case Q.UNIT:{const B=I.userDataManager.getUserDataByIndex(y);if(!B)break;switch(B.type){case pt.PET:I.userDataManager.requestPetInfo(B.webID),f(B.webID);break;case pt.USER:k=ss.getUserInfo(G,B);break;case pt.BOT:k=ss.getBotInfo(G,B);break;case pt.RENTABLE_BOT:k=ss.getRentableBotInfo(G,B);break}}}k&&e(k)};return Ye(iI.USER_DATA_UPDATED,y=>{if(!y.addedUsers.length)return;let G=[];y.addedUsers.forEach(k=>{k.webID!==q().userId&&E.find(B=>B.id===k.webID)&&G.push(new xd(k.roomIndex,Q.UNIT,k.webID,k.name,k.type,!0))}),G.length&&a(k=>{const B=[...k];return G.forEach(M=>{const U=B.findIndex(W=>W.id===M.id);U>-1&&B.splice(U,1),B.push(M)}),B})}),Ye(lI.PET_INFO,y=>{const G=y.petInfo;if(!G||G.id!==g)return;const k=ss.getPetInfo(G);k&&(e(k),f(-1))}),Ye(cI.PET_STATUS_UPDATE,y=>{}),Te(kl.USE_PRODUCT_FROM_INVENTORY,y=>{}),Te(kl.USE_PRODUCT_FROM_ROOM,y=>{const G=$().getRoomObject(I.roomId,y.objectId,Q.FLOOR);if(!G||!Ht(G))return;const k=G.model.getValue(ae.FURNITURE_OWNER_ID),B=G.model.getValue(ae.FURNITURE_TYPE_ID),M=q().getFloorItemData(B),U=M.customParams.split(" "),W=U.length?parseInt(U[0]):-1;if(W===-1)return;const L=[],x=$().getRoomObjects(I.roomId,Q.UNIT);for(const j of x){const H=I.userDataManager.getUserDataByIndex(j.id);let te=!1;if(!(!H||H.type!==pt.PET)){if(H.ownerId===k){H.hasSaddle&&M.specialType===Z.PET_SADDLE&&(te=!0);const ne=H.figure.split(" ");if((ne.length?parseInt(ne[0]):-1)===W){if(M.specialType===Z.MONSTERPLANT_REVIVAL&&!H.canRevive||M.specialType===Z.MONSTERPLANT_REBREED&&(H.petLevel<7||H.canRevive||H.canBreed)||M.specialType===Z.MONSTERPLANT_FERTILIZE&&(H.petLevel>=7||H.canRevive))continue;L.push(new cS(H.roomIndex,Q.UNIT,H.name,y.objectId,j.id,-1,te))}}}}h(null),L.length&&u(L)}),Te(It.REQUEST_MANIPULATION,y=>{Ys(I,y.objectId,y.category)&&C(!0)}),ml(y=>{R(y.id,y.category)}),uN(y=>{e(null),u([])}),mN(y=>{o||y.category!==Q.UNIT||O(y.id,y.category)}),dN(y=>{!n||y.category!==Q.UNIT||n.roomIndex!==y.id||r(null)}),lt([we.FURNI_REMOVED,we.USER_REMOVED],y=>{if(n&&n.category===y.category&&n.roomIndex===y.id&&r(null),y.category===Q.UNIT){let G=s.findIndex(k=>k.roomIndex===y.id);G>-1&&a(k=>k.filter(B=>B.roomIndex===y.id)),G=c.findIndex(k=>k.id===y.id),G>-1&&u(k=>k.filter(B=>B.id!==y.id))}else y.category===Q.FLOOR&&c.findIndex(k=>k.id===y.id)>-1&&u(k=>k.filter(B=>B.requestRoomObjectId!==y.id));o&&(o instanceof bs?o.id===y.id&&e(null):(o instanceof At||o instanceof Ns||o instanceof Ss)&&o.roomIndex===y.id&&e(null))}),i.useEffect(()=>{o&&(r(null),a([]),u([]))},[o]),i.useEffect(()=>{n&&a([])},[n]),i.useEffect(()=>{I.isDecorating=p},[I,p]),{avatarInfo:o,setAvatarInfo:e,activeNameBubble:n,setActiveNameBubble:r,nameBubbles:s,productBubbles:c,confirmingProduct:d,isDecorating:p,setIsDecorating:C,removeNameBubble:b,removeProductBubble:N,updateConfirmingProduct:v,getObjectName:O}},dT=uT,mT=()=>{const[o,e]=i.useState(""),[n,r]=i.useState(!1),[s,a]=i.useState(!1),[c,u]=i.useState(!1),[d,h]=i.useState(!1),[g,f]=i.useState(0),{showNitroAlert:p=null,showConfirm:C=null}=Je(),{roomSession:E=null}=xe(),_=(I,b,N="",v=0)=>{if(I==="")return null;const O=I.split(" ");if(O.length>0){const R=O[0];let y="";if(O.length>1&&(y=O[1]),R.charAt(0)===":"&&y==="x"){const G=$().selectedAvatarId;if(G>-1){const k=E.userDataManager.getUserDataByIndex(G);k&&(y=k.name,I=I.replace(" x"," "+k.name))}}switch(R.toLowerCase()){case":shake":return Pl.init(2500,5e3),Pl.turnVisualizationOn(),null;case":rotate":return Al.init(2500,5e3),Al.turnVisualizationOn(),null;case":d":case";d":Cn()===dn.VIP&&E.sendExpressionMessage(er.LAUGH.ordinal);break;case"o/":case"_o/":return E.sendExpressionMessage(er.WAVE.ordinal),null;case":kiss":if(Cn()===dn.VIP)return E.sendExpressionMessage(er.BLOW.ordinal),null;break;case":jump":if(Cn()===dn.VIP)return E.sendExpressionMessage(er.JUMP.ordinal),null;break;case":idle":return E.sendExpressionMessage(er.IDLE.ordinal),null;case"_b":return E.sendExpressionMessage(er.RESPECT.ordinal),null;case":sign":return E.sendSignMessage(parseInt(y)),null;case":iddqd":case":flip":return $().events.dispatchEvent(new Ni(E.roomId,-1,!0)),null;case":zoom":return $().events.dispatchEvent(new Ni(E.roomId,parseFloat(y),!1)),null;case":screenshot":const G=$().createTextureFromRoom(E.roomId,1),k=new Image;return k.src=rr.generateImageUrl(G),window.open("").document.write(k.outerHTML),null;case":pickall":return(E.isRoomOwner||q().isModerator)&&C(m("room.confirm.pick_all"),()=>{q().sendSpecialCommandMessage(":pickall")},null,null,null,m("generic.alert.title")),null;case":ejectall":return(E.isRoomOwner||q().isModerator||E.controllerLevel>=nt.GUEST)&&C(m("room.confirm.eject_all"),()=>{q().sendSpecialCommandMessage(":ejectall")},null,null,null,m("generic.alert.title")),null;case":furni":return ee("furni-chooser/"),null;case":chooser":return ee("user-chooser/"),null;case":floor":case":bcfloor":return E.controllerLevel>=nt.ROOM_OWNER&&ee("floor-editor/show"),null;case":togglefps":return Er().maxFPS>0?Er().maxFPS=0:Er().maxFPS=K("system.animation.fps"),null;case":client":case":nitro":case":billsonnn":return p(),null;case":settings":return(E.isRoomOwner||q().isModerator)&&A(new zu(E.roomId)),null}}switch(b){case Wn.CHAT_DEFAULT:E.sendChatMessage(I,v);break;case Wn.CHAT_SHOUT:E.sendShoutMessage(I,v);break;case Wn.CHAT_WHISPER:E.sendWhisperMessage(N,I,v);break}};return Ye(Rn.FLOOD_EVENT,I=>{h(!0),f(parseFloat(I.message))}),ml(I=>{if(I.category!==Q.UNIT)return;const b=E.userDataManager.getUserDataByIndex(I.id);b&&e(b.name)}),Te(It.DESELECTED,I=>e("")),i.useEffect(()=>{if(!d)return;let I=0;const b=setInterval(()=>{f(N=>(I=(N||0)-1,I)),I<0&&(clearInterval(b),h(!1))},1e3);return()=>clearInterval(b)},[d]),i.useEffect(()=>{if(!c)return;let I=null;return c&&(I=setTimeout(()=>{u(!1),r(!1)},1e4)),()=>clearTimeout(I)},[c]),i.useEffect(()=>{n?s||(a(!0),E.sendChatTypingMessage(n)):s&&(a(!1),E.sendChatTypingMessage(n))},[E,n,s]),{selectedUsername:o,floodBlocked:d,floodBlockedSeconds:g,setIsTyping:r,setIsIdle:u,sendChat:_}},gT=mT,pc=new Map,Ic=new Map,Ec=new Map,hT=()=>{const[o,e]=i.useState([]),[n,r]=i.useState({mode:Et.CHAT_MODE_FREE_FLOW,weight:Et.CHAT_BUBBLE_WIDTH_NORMAL,speed:Et.CHAT_SCROLL_SPEED_NORMAL,distance:50,protection:Et.FLOOD_FILTER_NORMAL}),{roomSession:s=null}=xe(),{addChatEntry:a}=No(),c=i.useRef(!1),u=i.useMemo(()=>{if(!n)return 6e3;switch(n.speed){case Et.CHAT_SCROLL_SPEED_FAST:return 3e3;case Et.CHAT_SCROLL_SPEED_NORMAL:return 6e3;case Et.CHAT_SCROLL_SPEED_SLOW:return 12e3}},[n]),d=f=>{const p=Nt().createAvatarImage(f,Yi.LARGE,null,{resetFigure:_=>{c.current||d(_)},dispose:()=>{},disposed:!1});if(!p)return;const C=p.getCroppedImage(Ya.HEAD),E=p.getPartColor(We.CHEST);return pc.set(f,E&&E.rgb||16777215),p.dispose(),Ic.set(f,C.src),C.src},h=f=>{let p=Ic.get(f);return p||(p=d(f)),p},g=(f,p,C,E=64,_=null)=>{let I=Ec.get(f+_);if(I)return I;const b=new Is(f),N=b.typeId,v=$().getRoomObjectPetImage(N,b.paletteId,b.color,new wt(p*45),E,null,!1,0,b.customParts,_);return v&&(I=rr.generateImageUrl(v.data),Ec.set(f+_,I)),I};return Ye(Rn.CHAT_EVENT,f=>{const p=$().getRoomObject(s.roomId,f.objectId,Q.UNIT),C=p?Id(s.roomId,p==null?void 0:p.id,Q.UNIT):new vr,E=p?s.userDataManager.getUserDataByIndex(f.objectId):new uI(-1);let _="",I=0,b=null,N=f.chatType,v=f.style,O=0,R=f.message;if(E){O=E.type;const B=E.figure;switch(O){case pt.PET:b=g(B,2,!0,64,p.model.getValue(ae.FIGURE_POSTURE)),new Is(B).typeId;break;case pt.USER:b=h(B);break;case pt.RENTABLE_BOT:case pt.BOT:v=gI.BOT;break}I=pc.get(B),_=E.name}switch(N){case Rn.CHAT_TYPE_RESPECT:R=m("widgets.chatbubble.respect",["username"],[_]),K("respect.options").enabled&&ar(K("respect.options").sound);break;case Rn.CHAT_TYPE_PETREVIVE:case Rn.CHAT_TYPE_PET_REBREED_FERTILIZE:case Rn.CHAT_TYPE_PET_SPEED_FERTILIZE:{let B="widget.chatbubble.petrevived";N===Rn.CHAT_TYPE_PET_REBREED_FERTILIZE?B="widget.chatbubble.petrefertilized;":N===Rn.CHAT_TYPE_PET_SPEED_FERTILIZE&&(B="widget.chatbubble.petspeedfertilized");let M=null;if($().getRoomObject(s.roomId,f.extraParam,Q.UNIT)){const W=s.userDataManager.getUserDataByIndex(p.id);W&&(M=W.name)}R=m(B,["petName","userName"],[_,M]);break}case Rn.CHAT_TYPE_PETRESPECT:R=m("widget.chatbubble.petrespect",["petname"],[_]);break;case Rn.CHAT_TYPE_PETTREAT:R=m("widget.chatbubble.pettreat",["petname"],[_]);break;case Rn.CHAT_TYPE_HAND_ITEM_RECEIVED:R=m("widget.chatbubble.handitem",["username","handitem"],[_,m("handitem"+f.extraParam)]);break;case Rn.CHAT_TYPE_MUTE_REMAINING:{const B=(f.extraParam>0?Math.floor(f.extraParam/3600):0).toString(),M=(f.extraParam>0?Math.floor(f.extraParam%3600/60):0).toString(),U=(f.extraParam%60).toString();R=m("widget.chatbubble.mutetime",["hours","minutes","seconds"],[B,M,U]);break}}const y=kb(R),G=I&&("#"+I.toString(16).padStart(6,"0")||null),k=new tS(E.roomIndex,Q.UNIT,s.roomId,R,y,_,new vr(C.x,C.y),N,v,b,G);e(B=>[...B,k]),a({id:-1,webId:E.webID,entityId:E.roomIndex,name:_,imageUrl:b,style:v,chatType:N,entityType:E.type,message:y,timestamp:vd(),type:Dn.TYPE_CHAT,roomId:s.roomId,color:G})}),Te(dI.ROOM_DRAG,f=>{if(!o.length||f.roomId!==s.roomId)return;const p=f.offsetX;o.forEach(C=>C.elementRef&&(C.left+=p))}),F(ws,f=>{const p=f.getParser();p.roomEnter&&r(p.chat)}),F(mI,f=>{const p=f.getParser();r(p.chat)}),i.useEffect(()=>(c.current=!1,()=>{c.current=!0}),[]),{chatMessages:o,setChatMessages:e,chatSettings:n,getScrollSpeed:u}},fT=hT,pT=()=>{const[o,e]=i.useState([]),n=a=>{o.indexOf(a)>=0||e([...o,a])},r=a=>{const c=o.indexOf(a);if(c===-1)return;const u=[...o];u.splice(c,1),e(u)},s=(a,c)=>{Oe().sendDoorbellApprovalMessage(a,c),r(a)};return Ye(Fo.DOORBELL,a=>n(a.userName)),Ye(Fo.RSDE_REJECTED,a=>r(a.userName)),Ye(Fo.RSDE_ACCEPTED,a=>r(a.userName)),{users:o,addUser:n,removeUser:r,answer:s}},IT=pT,ET=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(!1),s=()=>r(!1);return F(hI,a=>{const c=a.getParser();r(!0),e(c.words)}),{wordsFilter:o,isVisible:n,setWordsFilter:e,onClose:s}},CT=ET,_T=()=>{const[o,e]=i.useState([]),{requests:n=[],dismissedRequestIds:r=[],setDismissedRequestIds:s=null}=fn(),a=i.useMemo(()=>o.filter(u=>r.indexOf(u.request.requesterUserId)===-1),[o,r]),c=u=>{s(d=>{if(d.indexOf(u)>=0)return d;const h=[...d];return h.push(u),h})};return Em(!0,u=>{if(u.category!==Q.UNIT)return;const d=Oe().userDataManager.getUserDataByIndex(u.id);if(!d||d.type!==Dl.getTypeNumber(Dl.USER))return;const h=n.find(f=>f.requesterUserId===d.webID);if(!h||o.find(f=>f.request.requesterUserId===d.webID))return;const g=[...o];g.push({roomIndex:d.roomIndex,request:h}),e(g)}),Cm(!0,u=>{if(u.category!==Q.UNIT)return;const d=o.findIndex(g=>g.roomIndex===u.id);if(d===-1)return;const h=[...o];h.splice(d,1),e(h)}),i.useEffect(()=>{const u=[];for(const d of n){const h=Oe().userDataManager.getUserData(d.requesterUserId);h&&u.push({roomIndex:h.roomIndex,request:d})}e(u)},[n]),{displayedRequests:a,hideFriendRequest:c}},bT=_T,ST=()=>{const[o,e]=i.useState(null),{roomSession:n=null}=xe(),r=()=>e(null),s=c=>c&&$().selectRoomObject(Oe().roomId,c.id,c.category),a=()=>{const c=q(),u=$().getRoomObjects(n.roomId,Q.WALL),d=$().getRoomObjects(n.roomId,Q.FLOOR),h=u.map(f=>{if(f.id<0)return null;let p=f.type;if(p.startsWith("poster"))p=m(`poster_${p.replace("poster","")}_name`);else{const C=f.model.getValue(ae.FURNITURE_TYPE_ID),E=c.getWallItemData(C);E&&E.name.length&&(p=E.name)}return new ds(f.id,Q.WALL,p)}),g=d.map(f=>{if(f.id<0)return null;let p=f.type;const C=f.model.getValue(ae.FURNITURE_TYPE_ID),E=c.getFloorItemData(C);return E&&E.name.length&&(p=E.name),new ds(f.id,Q.FLOOR,p)});e([...h,...g].sort((f,p)=>f.name<p.name?-1:1))};return cN(!!o,c=>{if(c.id<0)return;const u=$().getRoomObject(Oe().roomId,c.id,c.category);if(!u)return;let d=null;switch(c.category){case Q.WALL:{let h=u.type;if(h.startsWith("poster"))h=m(`poster_${h.replace("poster","")}_name`);else{const g=u.model.getValue(ae.FURNITURE_TYPE_ID),f=q().getWallItemData(g);f&&f.name.length&&(h=f.name)}d=new ds(u.id,Q.WALL,h);break}case Q.FLOOR:{let h=u.type;const g=u.model.getValue(ae.FURNITURE_TYPE_ID),f=q().getFloorItemData(g);f&&f.name.length&&(h=f.name),d=new ds(u.id,Q.FLOOR,h)}}e(h=>[...h,d].sort((g,f)=>g.name<f.name?-1:1))}),Nn(!!o,c=>{c.id<0||e(u=>{const d=[...u];for(let h=0;h<d.length;h++){const g=d[h];if(!(g.id!==c.id||g.category!==c.category)){d.splice(h,1);break}}return d})}),{items:o,onClose:r,selectItem:s,populateChooser:a}},NT=ST,TT=()=>{const[o,e]=i.useState(!1),[n,r]=i.useState(-1),[s,a]=i.useState(""),[c,u]=i.useState(""),[d,h]=i.useState(""),g=()=>{h(""),u(""),a(""),r(-1),e(!1)},f=()=>{A(new fI(n,c))},p=E=>{u(E),d.length>0&&h("")},C=E=>{if(!(!E||E===0))switch(E){case 1:return m("catalog.alert.petname.long");case 2:return m("catalog.alert.petname.short");case 3:return m("catalog.alert.petname.chars");case 4:default:return m("catalog.alert.petname.bobba")}};return Ye(Ml.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,E=>{if(!E)return;const _=$().getRoomObject(E.session.roomId,E.objectId,Q.FLOOR);r(E.objectId),a(_.type),e(!0)}),Ye(Ml.RSOPPE_OPEN_PET_PACKAGE_RESULT,E=>{E&&(E.nameValidationStatus===0&&g(),E.nameValidationStatus!==0&&h(C(E.nameValidationStatus)))}),{isVisible:o,errorResult:d,petName:c,objectType:s,onChangePetName:p,onConfirm:f,onClose:g}},vT=TT,wT=()=>{const{roomSession:o=null}=xe(),e=s=>o.sendPollStartMessage(s),n=s=>o.sendPollRejectMessage(s),r=(s,a,c)=>o.sendPollAnswerMessage(s,a,c);return Ye(Bo.OFFER,s=>{const a=new pr(pr.OFFER,s.id);a.summary=s.summary,a.headline=s.headline,St(a)}),Ye(Bo.ERROR,s=>{const a=new pr(pr.ERROR,s.id);a.summary=s.summary,a.headline=s.headline,St(a)}),Ye(Bo.CONTENT,s=>{const a=new pr(pr.CONTENT,s.id);a.startMessage=s.startMessage,a.endMessage=s.endMessage,a.numQuestions=s.numQuestions,a.questionArray=s.questionArray,a.npsPoll=s.npsPoll,St(a)}),{startPoll:e,rejectPoll:n,answerPoll:r}},RT=wT,yT=()=>{const[o,e]=i.useState(null);xe();const n=()=>e(null),r=a=>a&&$().selectRoomObject(Oe().roomId,a.id,a.category),s=()=>{const a=Oe(),c=$().getRoomObjects(a.roomId,Q.UNIT);e(c.map(u=>{if(u.id<0)return null;const d=a.userDataManager.getUserDataByIndex(u.id);return d?new ds(d.roomIndex,Q.UNIT,d.name):null}).sort((u,d)=>u.name<d.name?-1:1))};return Em(!!o,a=>{if(a.id<0)return;const c=Oe().userDataManager.getUserDataByIndex(a.id);c&&e(u=>{const d=[...u];return d.push(new ds(c.roomIndex,Q.UNIT,c.name)),d.sort((h,g)=>h.name<g.name?-1:1),d})}),Cm(!!o,a=>{a.id<0||e(c=>{const u=[...c];for(let d=0;d<u.length;d++){const h=u[d];if(!(h.id!==a.id||h.category!==a.category)){u.splice(d,1);break}}return u})}),{items:o,onClose:n,selectItem:r,populateChooser:s}},OT=yT,Cc=4e3,kT=3,AT=()=>{const[o,e]=i.useState(-1),[n,r]=i.useState(null),[s,a]=i.useState(!1),[c,u]=i.useState(null),[d,h]=i.useState(new Map),[g,f]=i.useState(new Map),{answerPoll:p=null}=RT(),{roomSession:C=null}=xe(),E=()=>{e(-1),r(null)},_=I=>{s||!n||(p(o,n.id,[I]),a(!0))};return Ye(Go.ANSWERED,I=>{const b=C.userDataManager.getUserData(I.userId);b&&(h(I.answerCounts),f(N=>{if(!N.has(b.roomIndex)){const v=new Map(g);return v.set(b.roomIndex,{value:I.value,secondsLeft:kT}),v}return N}),$().updateRoomObjectUserGesture(C.roomId,b.roomIndex,ms.getGestureId(I.value==="0"?ms.GESTURE_SAD:ms.GESTURE_SMILE)))}),Ye(Go.FINISHED,I=>{n&&n.id===I.questionId&&(h(I.answerCounts),a(!0),u(b=>(b&&clearTimeout(b),setTimeout(()=>E(),Cc)))),f(new Map)}),Ye(Go.QUESTION,I=>{e(I.id),r(I.question),a(!1),h(new Map),f(new Map),u(b=>{if(b&&clearTimeout(b),I.duration>0){const N=I.duration<1e3?Cc:I.duration;return setTimeout(()=>E(),N)}return null})}),i.useEffect(()=>{const I=()=>{f(N=>{const v=[];if(N.forEach((R,y)=>{R.secondsLeft--,R.secondsLeft<=0&&v.push(y)}),v.length===0)return N;const O=new Map(N);return v.forEach(R=>O.delete(R)),O})},b=setInterval(()=>I(),1e3);return()=>clearInterval(b)},[]),i.useEffect(()=>()=>{u(I=>(I&&clearTimeout(I),null))},[]),{question:n,answerSent:s,answerCounts:d,userAnswers:g,vote:_}},PT=AT,DT=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(null),[s,a]=i.useState(0),[c,u]=i.useState(0),[d,h]=i.useState(0),[g,f]=So("nitro.screensize",{width:window.innerWidth,height:window.innerHeight}),p=_=>{a(_),A(new II(_))},C=_=>{q().giveRespect(_),u(q().respectsLeft)},E=_=>{q().givePetRespect(_),h(q().respectsPetLeft)};return F(Gu,_=>{const I=_.getParser();e(I.userInfo),r(I.userInfo.figure),u(I.userInfo.respectsRemaining),h(I.userInfo.respectsPetRemaining)}),F(pI,_=>{const I=_.getParser();r(I.figure)}),F(Yu,_=>{const I=_.getParser();a(I.chatType)}),i.useEffect(()=>{const _=Xa("nitro.screensize");if(_&&(_.width!==window.innerWidth||_.height!==window.innerHeight)){let b=window.localStorage.length;for(;b>0;){const N=window.localStorage.key(b);N&&N.startsWith("nitro.window")&&window.localStorage.removeItem(N),b--}}const I=b=>f({width:window.innerWidth,height:window.innerHeight});return window.addEventListener("resize",I),()=>{window.removeEventListener("resize",I)}},[f]),{userInfo:o,userFigure:n,chatStyleId:s,userRespectRemaining:c,petRespectRemaining:d,respectUser:C,respectPet:E,updateChatStyleId:p}},Yn=()=>ct(DT),MT=o=>i.useEffect(o,[]),Sm=o=>MT(()=>o());class LT{constructor(e){this.handler="sso",this.ssoTicket=e}}class UT{constructor(){this.handler="ping"}}const Nm=o=>{const{achievement:e=null,scale:n=1,...r}=o;return e?t(qe,{badgeCode:un.getAchievementBadgeCode(e),isGrayscale:!un.getAchievementHasStarted(e),scale:n,...r}):null},xT=o=>{const{achievement:e=null}=o,{selectedAchievement:n=null,setSelectedAchievementId:r=null}=bo();return e?t(Ie,{itemActive:n===e,itemUnseen:e.unseen>0,onClick:s=>r(e.achievementId),children:t(Nm,{achievement:e})}):null},FT=o=>{const{achievements:e=null}=o;return t(ke,{columnCount:6,columnMinWidth:50,columnMinHeight:50,children:e&&e.length>0&&e.map((n,r)=>t(xT,{achievement:n},r))})},BT=o=>{const{achievement:e=null}=o;return e?l(w,{shrink:!0,className:"bg-muted rounded p-2 text-black",gap:2,overflow:"hidden",children:[l(T,{center:!0,gap:1,children:[t(Nm,{className:"nitro-achievements-badge-image",achievement:e,scale:2}),t(S,{fontWeight:"bold",children:m("achievements.details.level",["level","limit"],[un.getAchievementLevel(e).toString(),e.levelCount.toString()])})]}),l(T,{fullWidth:!0,justifyContent:"center",overflow:"hidden",children:[l(T,{gap:1,children:[t(S,{fontWeight:"bold",truncate:!0,children:sa(un.getAchievementBadgeCode(e))}),t(S,{textBreak:!0,children:el(un.getAchievementBadgeCode(e))})]}),(e.levelRewardPoints>0||e.scoreLimit>0)&&l(T,{gap:1,children:[e.levelRewardPoints>0&&l(w,{alignItems:"center",gap:1,children:[t(S,{truncate:!0,className:"small",children:m("achievements.details.reward")}),l(w,{center:!0,className:"fw-bold small",gap:1,children:[e.levelRewardPoints,t(at,{type:e.levelRewardPointType})]})]}),e.scoreLimit>0&&t(ul,{text:m("achievements.details.progress",["progress","limit"],[(e.currentPoints+e.scoreAtStartOfLevel).toString(),(e.scoreLimit+e.scoreAtStartOfLevel).toString()]),progress:e.currentPoints+e.scoreAtStartOfLevel,maxProgress:e.scoreLimit+e.scoreAtStartOfLevel})]})]})]}):null},GT=o=>{const{category:e=null}=o,{selectedAchievement:n=null,setSelectedAchievementId:r=null}=bo();return i.useEffect(()=>{var s,a;e&&(n||r((a=(s=e==null?void 0:e.achievements)==null?void 0:s[0])==null?void 0:a.achievementId))},[e,n,r]),e?l(T,{fullHeight:!0,justifyContent:"between",children:[t(FT,{achievements:e.achievements}),!!n&&t(BT,{achievement:n})]}):null},VT=o=>{const{category:e=null,selectedCategoryCode:n=null,setSelectedCategoryCode:r=null}=o;if(!e)return null;const s=un.getAchievementCategoryProgress(e),a=un.getAchievementCategoryMaxProgress(e),c=un.getAchievementCategoryImageUrl(e,s),u=un.getAchievementCategoryTotalUnseen(e);return l(Ie,{itemActive:n===e.code,itemCount:u,itemCountMinimum:0,gap:1,onClick:d=>r(e.code),children:[t(S,{fullWidth:!0,center:!0,small:!0,className:"pt-1",children:m(`quests.${e.code}.name`)}),t(Yd,{position:"relative",imageUrl:c,children:l(S,{fullWidth:!0,center:!0,position:"absolute",variant:"white",style:{fontSize:12,bottom:9},children:[s," / ",a]})})]})},HT=o=>{const{categories:e=null,selectedCategoryCode:n=null,setSelectedCategoryCode:r=null}=o;return t(ke,{columnCount:3,columnMinWidth:90,columnMinHeight:100,children:e&&e.length>0&&e.map((s,a)=>t(VT,{category:s,selectedCategoryCode:n,setSelectedCategoryCode:r},a))})},WT=o=>{const[e,n]=i.useState(!1),{achievementCategories:r=[],selectedCategoryCode:s=null,setSelectedCategoryCode:a=null,achievementScore:c=0,getProgress:u=0,getMaxProgress:d=0,selectedCategory:h=null}=bo();return i.useEffect(()=>{const g={linkReceived:f=>{const p=f.split("/");if(!(p.length<2))switch(p[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(C=>!C);return}},eventUrlPrefix:"achievements/"};return ut(g),()=>dt(g)},[]),e?l(oe,{uniqueKey:"achievements",className:"nitro-achievements",theme:"primary-slim",children:[t(ie,{headerText:m("inventory.achievements"),onCloseClick:g=>n(!1)}),h&&l(qd,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",gap:3,children:[t(P,{onClick:g=>a(null),className:"nitro-achievements-back-arrow"}),l(T,{grow:!0,gap:0,children:[t(S,{fontSize:4,fontWeight:"bold",className:"text-small",children:m(`quests.${h.code}.name`)}),t(S,{children:m("achievements.details.categoryprogress",["progress","limit"],[h.getProgress().toString(),h.getMaxProgress().toString()])})]}),t(ir,{imageUrl:un.getAchievementCategoryImageUrl(h,null,!0)})]}),l(re,{gap:1,children:[!h&&l(V,{children:[t(HT,{categories:r,selectedCategoryCode:s,setSelectedCategoryCode:a}),l(T,{grow:!0,justifyContent:"end",gap:1,children:[t(S,{small:!0,center:!0,children:m("achievements.categories.score",["score"],[c.toString()])}),t(ul,{text:m("achievements.categories.totalprogress",["progress","limit"],[u.toString(),d.toString()]),progress:u,maxProgress:d})]})]}),h&&t(GT,{category:h})]})]}):null},Rr=o=>{const{icon:e=null,selected:n=!1,classNames:r=[],children:s=null,...a}=o,c=i.useMemo(()=>{const u=["nitro-avatar-editor-spritesheet"];return e&&e.length&&u.push(e+"-icon"),n&&u.push("selected"),r.length&&u.push(...r),u},[e,n,r]);return t(P,{classNames:c,...a})},jT=o=>{const{figureData:e=null}=o,[n,r]=i.useState(-1),s=a=>{a<fa.MIN_DIRECTION&&(a=fa.MAX_DIRECTION+(a+1)),a>fa.MAX_DIRECTION&&(a=a-(fa.MAX_DIRECTION+1)),e.direction=a};return i.useEffect(()=>{if(e)return e.notify=()=>r(a=>a+1),()=>{e.notify=null}},[e]),l(T,{className:"figure-preview-container",overflow:"hidden",position:"relative",children:[t(ot,{figure:e.getFigureString(),direction:e.direction,scale:2}),t(Rr,{className:"avatar-spotlight",icon:"spotlight"}),t(P,{className:"avatar-shadow"}),l(P,{className:"arrow-container",children:[t(Rr,{pointer:!0,icon:"arrow-left",onClick:a=>s(e.direction+1)}),t(Rr,{pointer:!0,icon:"arrow-right",onClick:a=>s(e.direction-1)})]})]})},qT=o=>{const{partItem:e=null,children:n=null,...r}=o,[s,a]=i.useState(-1),c=K("hc.disabled",!1);return i.useEffect(()=>{const u=()=>a(d=>d+1);return e.notify=u,()=>e.notify=null},[e]),l(Ie,{itemImage:e.isClear?void 0:e.imageUrl,itemActive:e.isSelected,...r,children:[!c&&e.isHC&&t(at,{className:"position-absolute end-1 bottom-1",type:"hc"}),e.isClear&&t(Rr,{icon:"clear"}),e.isSellable&&t(Rr,{icon:"sellable",position:"absolute",className:"end-1 bottom-1"}),n]})},zT=o=>{const{model:e=null,category:n=null,setMaxPaletteCount:r=null}=o,s=i.useRef(null),a=i.useCallback(c=>{const u=n.parts.indexOf(c);if(u===-1)return;e.selectPart(n.name,u);const d=n.getCurrentPart();r(d.maxColorIndex||1)},[e,n,r]);return i.useEffect(()=>{!e||!n||!s||!s.current||(s.current.scrollTop=0)},[e,n]),t(ke,{innerRef:s,columnCount:3,columnMinHeight:50,children:n.parts.length>0&&n.parts.map((c,u)=>t(qT,{partItem:c,onClick:d=>a(c)},u))})},YT=o=>{const{colorItem:e=null,children:n=null,...r}=o,[s,a]=i.useState(-1),c=K("hc.disabled",!1);return i.useEffect(()=>{const u=()=>a(d=>d+1);return e.notify=u,()=>e.notify=null},[e]),l(Ie,{itemHighlight:!0,itemColor:e.color,itemActive:e.isSelected,className:"clear-bg",...r,children:[!c&&e.isHC&&t(at,{className:"position-absolute end-1 bottom-1",type:"hc"}),n]})},_c=o=>{const{model:e=null,category:n=null,paletteSet:r=[],paletteIndex:s=-1}=o,a=i.useRef(null),c=i.useCallback(u=>{const d=r.indexOf(u);d!==-1&&e.selectColor(n.name,d,s)},[e,n,r,s]);return i.useEffect(()=>{!e||!n||!a||!a.current||(a.current.scrollTop=0)},[e,n]),t(ke,{innerRef:a,gap:1,columnCount:5,columnMinWidth:30,children:r.length>0&&r.map((u,d)=>t(YT,{colorItem:u,onClick:h=>c(u)},d))})},$T=o=>{const{model:e=null,gender:n=null,setGender:r=null}=o,[s,a]=i.useState(null),[c,u]=i.useState(1),d=i.useCallback(h=>{const g=e.categories.get(h);if(g){g.init(),a(g);for(const f of g.parts)if(!(!f||!f.isSelected)){u(f.maxColorIndex||1);break}}},[e]);return i.useEffect(()=>{e.init();for(const h of e.categories.keys()){d(h);break}},[e,d]),!e||!s?null:l(se,{children:[l(T,{size:2,children:[e.canSetGender&&l(V,{children:[t(w,{center:!0,pointer:!0,className:"category-item",onClick:h=>r(ye.MALE),children:t(Rr,{icon:"male",selected:n===ye.MALE})}),t(w,{center:!0,pointer:!0,className:"category-item",onClick:h=>r(ye.FEMALE),children:t(Rr,{icon:"female",selected:n===ye.FEMALE})})]}),!e.canSetGender&&e.categories&&e.categories.size>0&&Array.from(e.categories.keys()).map(h=>{const g=e.categories.get(h);return t(w,{center:!0,pointer:!0,className:"category-item",onClick:f=>d(h),children:t(Rr,{icon:g.name,selected:s===g})},h)})]}),t(T,{size:5,overflow:"hidden",children:t(zT,{model:e,category:s,setMaxPaletteCount:u})}),l(T,{size:5,overflow:"hidden",children:[c>=1&&t(_c,{model:e,category:s,paletteSet:s.getPalette(0),paletteIndex:0}),c===2&&t(_c,{model:e,category:s,paletteSet:s.getPalette(1),paletteIndex:1})]})]})},KT=o=>{const{figureData:e=null,savedFigures:n=[],setSavedFigures:r=null,loadAvatarInEditor:s=null}=o,a=K("hc.disabled",!1),c=i.useCallback(h=>{if(h>=n.length||h<0)return;const[g,f]=n[h];s(g.getFigureString(),f)},[n,s]),u=i.useCallback(h=>{if(!e||h>=n.length||h<0)return;const g=[...n],f=e.getFigureString(),p=e.gender;g[h]=[Nt().createFigureContainer(f),p],r(g),A(new EI(h+1,f,p))},[e,n,r]),d=i.useMemo(()=>{if(!n||!n.length)return[];const h=[];return n.forEach(([g,f],p)=>{let C=0;g&&(C=Nt().getFigureClubLevel(g,f)),h.push(l(Ie,{position:"relative",overflow:"hidden",className:"nitro-avatar-editor-wardrobe-figure-preview",children:[g&&t(ot,{figure:g.getFigureString(),gender:f,direction:2}),t(P,{className:"avatar-shadow"}),!a&&C>0&&t(at,{className:"position-absolute top-1 start-1",type:"hc"}),l(w,{gap:1,className:"button-container",children:[t(D,{variant:"link",fullWidth:!0,onClick:E=>u(p),children:m("avatareditor.wardrobe.save")}),g&&t(D,{variant:"link",fullWidth:!0,onClick:E=>c(p),disabled:C>Cn(),children:m("generic_usable.button.use")})]})]},p))}),h},[n,a,u,c]);return t(ke,{columnCount:5,columnMinWidth:80,columnMinHeight:140,children:d})},XT="hr-100.hd-180-7.ch-215-66.lg-270-79.sh-305-62.ha-1002-70.wa-2007",QT="hr-515-33.hd-600-1.ch-635-70.lg-716-66-62.sh-735-68",JT=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(null),[a,c]=i.useState(null),[u,d]=i.useState(null),[h,g]=i.useState(null),[f,p]=i.useState([]),[C,E]=i.useState([]),[_,I]=i.useState([]),[b,N]=i.useState(!1),[v,O]=i.useState(null),[R,y]=i.useState(null),[G,k]=i.useState(!0),[B,M]=i.useState(!1),U=i.useMemo(()=>K("avatar.wardrobe.max.slots",10),[]);F(CI,ne=>{const Ce=ne.getParser();p(Ce.figureSetIds),E(Ce.boundsFurnitureNames)}),F(_I,ne=>{const Ce=ne.getParser(),Me=[];let Ze=0;for(;Ze<U;)Me.push([null,null]),Ze++;for(let[tt,[Ft,je]]of Ce.looks.entries()){const qt=Nt().createFigureContainer(Ft);Me[tt-1]=[qt,je]}I(Me)});const W=i.useCallback(ne=>{u&&g(u.get(ne))},[u]),L=i.useCallback(()=>{const ne=new Map;ne.set(Ir.GENERIC,new Ib),ne.set(Ir.HEAD,new Ub),ne.set(Ir.TORSO,new Fb),ne.set(Ir.LEGS,new xb),d(ne)},[]),x=i.useCallback(()=>{const ne=new Map,Ce=new ye,Me=new ye;Ce.loadAvatarData(XT,ye.MALE),Me.loadAvatarData(QT,ye.FEMALE),ne.set(ye.MALE,Ce),ne.set(ye.FEMALE,Me),s(ne),c(ne.get(ye.MALE))},[]),j=i.useCallback((ne,Ce,Me=!0)=>{Ce=ft.getGender(Ce);let Ze=a;Ce!==Ze.gender&&(Ze=r.get(Ce)),ne!==Ze.getFigureString()&&Ze.loadAvatarData(ne,Ce),Ze!==a&&c(Ze),Me&&(O(a.getFigureString()),y(a.gender))},[r,a]),H=i.useCallback(ne=>{switch(ne){case On.ACTION_CLEAR:j(a.getFigureStringWithFace(0,!1),a.gender,!1),L();return;case On.ACTION_RESET:j(v,R),L();return;case On.ACTION_RANDOMIZE:const Ce=Lb(a,a.gender,Cn(),f,[ye.FACE]);j(Ce,a.gender,!1),L();return;case On.ACTION_SAVE:A(new $u(a.gender,a.getFigureString())),n(!1);return}},[a,v,R,f,j,L]),te=i.useCallback(ne=>{ne=ft.getGender(ne),c(r.get(ne))},[r]);return i.useEffect(()=>{const ne={linkReceived:Ce=>{const Me=Ce.split("/");if(!(Me.length<2))switch(Me[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(Ze=>!Ze);return}},eventUrlPrefix:"avatar-editor/"};return ut(ne),()=>dt(ne)},[]),i.useEffect(()=>{I(new Array(U))},[U]),i.useEffect(()=>{b&&(g(null),A(new bI))},[b]),i.useEffect(()=>{h&&N(!1)},[h]),i.useEffect(()=>{u&&W(Ir.GENERIC)},[u,W]),i.useEffect(()=>{if(a)return ft.CURRENT_FIGURE=a,L(),()=>ft.CURRENT_FIGURE=null},[a,L]),i.useEffect(()=>(ft.FIGURE_SET_IDS=f,ft.BOUND_FURNITURE_NAMES=C,L(),()=>{ft.FIGURE_SET_IDS=null,ft.BOUND_FURNITURE_NAMES=null}),[f,C,L]),i.useEffect(()=>{if(e&&!r){x(),M(!0);return}},[e,r,x]),i.useEffect(()=>{!e||!B||!G||(j(q().figure,q().gender),k(!1))},[e,B,G,j]),i.useEffect(()=>{if(!e)return()=>{k(!0)}},[e]),!e||!a?null:l(oe,{uniqueKey:"avatar-editor",className:"nitro-avatar-editor",children:[t(ie,{headerText:m("avatareditor.title"),onCloseClick:ne=>n(!1)}),l(lr,{children:[u&&u.size>0&&Array.from(u.keys()).map(ne=>{const Ce=h&&h.name===ne;return t(Mn,{isActive:Ce,onClick:Me=>W(ne),children:m(`avatareditor.category.${ne}`)},ne)}),t(Mn,{isActive:b,onClick:ne=>N(!0),children:m("avatareditor.category.wardrobe")})]}),t(re,{children:l(se,{children:[l(T,{size:9,overflow:"hidden",children:[h&&!b&&t($T,{model:h,gender:a.gender,setGender:te}),b&&t(KT,{figureData:a,savedFigures:_,setSavedFigures:I,loadAvatarInEditor:j})]}),l(T,{size:3,overflow:"hidden",children:[t(jT,{figureData:a}),l(T,{grow:!0,gap:1,children:[l(nr,{children:[t(D,{variant:"secondary",onClick:ne=>H(On.ACTION_RESET),children:t(Zm,{className:"fa-icon"})}),t(D,{variant:"secondary",onClick:ne=>H(On.ACTION_CLEAR),children:t(ji,{className:"fa-icon"})}),t(D,{variant:"secondary",onClick:ne=>H(On.ACTION_RANDOMIZE),children:t(eg,{className:"fa-icon"})})]}),t(D,{className:"w-100",variant:"success",onClick:ne=>H(On.ACTION_SAVE),children:m("avatareditor.save")})]})]})]})})]})};class bc{constructor(e){this.handler="changeBanner",this.session=new URLSearchParams(window.location.search).get("sso"),this.bannerName=e}}class ZT{constructor(){this.handler="getBanners",this.session=new URLSearchParams(window.location.search).get("sso")}}const ev=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState([]),[a,c]=i.useState([]),{sendMessage:u,lastMessage:d,readyState:h}=Kr(K("external.websocket"),{share:!0});return i.useEffect(()=>{const g={linkReceived:f=>{const p=f.split("/");if(!(p.length<2))switch(p[1]){case"show":n(!0),u(JSON.stringify(new ZT));return;case"hide":n(!1);return}},eventUrlPrefix:"banners/"};return ut(g),()=>dt(g)},[n]),i.useEffect(()=>{if(d!==null){var g=JSON.parse(d.data);g.header==="bannersResponse"&&g.data!==null&&s(g.data.banners)}},[d,c]),t(V,{children:e&&l(oe,{style:{height:"400px",width:"500px"},children:[t(ie,{headerText:"Banners",onCloseClick:g=>n(!1)}),l(re,{children:[t("div",{className:"alert alert-primary text-center",children:t("b",{children:"Selecciona el banner que mas te guste, aparecer en tu perfil."})}),l(tg,{children:[l(Sl,{className:"text-center",md:2,style:{marginBottom:20},onClick:()=>u(JSON.stringify(new bc("default"))),children:[t("img",{src:`${K("banners.url")}/default.png`,style:{marginLeft:2,cursor:"pointer"}}),t("br",{})]}),r.map((g,f)=>l(Sl,{className:"text-center",md:2,style:{marginBottom:20},onClick:()=>u(JSON.stringify(new bc(g.bannerName))),children:[t("img",{src:`${K("banners.url")}/`+g.bannerName+".png",style:{marginLeft:2,cursor:"pointer"}}),t("br",{})]},f))]})]})]})})},tv=5,nv=o=>{const{onClose:e=null,onEdit:n=null,onDelete:r=null}=o,{cameraRoll:s=null,setCameraRoll:a=null,selectedPictureIndex:c=-1,setSelectedPictureIndex:u=null}=Qd(),{simpleAlert:d=null}=Je(),h=i.useRef(),g=c>-1?s[c]:null,f=()=>{if(!h||!h.current)return null;const C=h.current.getBoundingClientRect();return new Ou(Math.floor(C.x),Math.floor(C.y),Math.floor(C.width),Math.floor(C.height))},p=()=>{if(c>-1){u(-1);return}const C=$().createTextureFromRoom(Oe().roomId,1,f()),E=[...s];E.length>=tv&&(d(m("camera.full.body")),E.pop()),ar(mn.CAMERA_SHUTTER),E.push(new Bb(C,rr.generateImageUrl(C))),a(E)};return t(Ar,{uniqueKey:"nitro-camera-capture",children:l(T,{center:!0,className:"nitro-camera-capture",gap:0,children:[g&&t("img",{alt:"",className:"camera-area",src:g.imageUrl}),l("div",{className:"camera-canvas drag-handler",children:[t("div",{className:"position-absolute header-close",onClick:e,children:t(hn,{className:"fa-icon"})}),!g&&t("div",{ref:h,className:"camera-area camera-view-finder"}),g&&t("div",{className:"camera-area camera-frame",children:l("div",{className:"camera-frame-preview-actions w-100 position-absolute bottom-0 py-2 text-center",children:[t("button",{className:"btn btn-success me-3",title:m("camera.editor.button.tooltip"),onClick:n,children:m("camera.editor.button.text")}),t("button",{className:"btn btn-danger",onClick:r,children:m("camera.delete.button.text")})]})}),t("div",{className:"d-flex justify-content-center",children:t("div",{className:"camera-button",title:m("camera.take.photo.button.tooltip"),onClick:p})})]}),s.length>0&&t(w,{gap:2,justifyContent:"center",className:"camera-roll d-flex justify-content-center py-2",children:s.map((C,E)=>t("img",{alt:"",src:C.imageUrl,onClick:_=>u(E)},E))})]})})},rv=o=>{const{base64Url:e=null,onCloseClick:n=null,onCancelClick:r=null,price:s=null}=o,[a,c]=i.useState(null),[u,d]=i.useState(null),[h,g]=i.useState(0),[f,p]=i.useState(0),[C,E]=i.useState(!1),[_,I]=i.useState(!1),[b,N]=i.useState(0),v=i.useMemo(()=>K("camera.publish.disabled",!1),[]);F(SI,R=>{g(y=>y+1),I(!1)}),F(NI,R=>{const y=R.getParser();d(y.extraDataId),N(y.secondsToWait),E(y.ok),I(!1)}),F(TI,R=>{const y=R.getParser();c(K("camera.url")+"/"+y.url)});const O=(R,y=null)=>{switch(R){case"close":n();return;case"buy":if(_)return;I(!0),A(new RI(""));return;case"buy_xxl":if(_)return;I(!0),A(new wI("")),p(G=>G+1),I(!1);return;case"publish":if(_)return;I(!0),A(new vI);return;case"cancel":r();return}};return i.useEffect(()=>{e&&$().saveBase64AsScreenshot(e)},[e]),s?l(oe,{className:"nitro-camera-checkout",theme:"primary-slim",children:[t(ie,{headerText:m("camera.confirm_phase.title"),onCloseClick:R=>O("close")}),l(re,{children:[l(w,{center:!0,children:[a&&a.length&&t(ir,{className:"picture-preview border",imageUrl:a}),(!a||!a.length)&&t(w,{center:!0,className:"picture-preview border",children:t(S,{bold:!0,children:m("camera.loading")})})]}),l(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[l(T,{size:v?10:6,gap:1,children:[t(S,{bold:!0,children:m("camera.purchase.header")}),(s.credits>0||s.duckets>0)&&l(w,{gap:1,children:[t(S,{children:m("catalog.purchase.confirmation.dialog.cost")}),s.credits>0&&l(w,{gap:1,children:[t(S,{bold:!0,children:s.credits}),t(at,{type:-1})]}),s.duckets>0&&l(w,{gap:1,children:[t(S,{bold:!0,children:s.duckets}),t(at,{type:5})]})]}),h>0&&l(S,{children:[t(S,{bold:!0,children:m("camera.purchase.count.info")})," ",h,t("u",{className:"ms-1 cursor-pointer",onClick:()=>ee("inventory/toggle"),children:m("camera.open.inventory")})]})]}),t(w,{alignItems:"center",children:t(D,{variant:"success",disabled:_,onClick:R=>O("buy"),children:m(h?"camera.buy.another.button.text":"buy")})})]}),l(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[l(T,{size:v?10:6,gap:1,children:[t(S,{bold:!0,children:"Comprar poster XXL"}),(s.credits>0||s.duckets>0)&&l(w,{gap:1,children:[t(S,{children:m("catalog.purchase.confirmation.dialog.cost")}),s.credits>0&&l(w,{gap:1,children:[t(S,{bold:!0,children:s.credits}),t(at,{type:-1})]}),s.duckets>0&&l(w,{gap:1,children:[t(S,{bold:!0,children:s.duckets}),t(at,{type:5})]})]}),f>0&&l(S,{children:[t(S,{bold:!0,children:m("camera.purchase.count.info")})," ",f,t("u",{className:"ms-1 cursor-pointer",onClick:()=>ee("inventory/toggle"),children:m("camera.open.inventory")})]})]}),t(w,{alignItems:"center",children:t(D,{variant:"success",disabled:_,onClick:R=>O("buy_xxl"),children:m(f?"camera.buy.another.button.text":"buy")})})]}),!v&&l(w,{justifyContent:"between",alignItems:"center",className:"bg-muted rounded p-2",children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m(C?"camera.publish.successful":"camera.publish.explanation")}),t(S,{children:m(C?"camera.publish.success.short.info":"camera.publish.detailed.explanation")}),C&&t("a",{href:u,rel:"noreferrer",target:"_blank",children:m("camera.link.to.published")}),!C&&s.publishDucketPrice>0&&l(w,{gap:1,children:[t(S,{children:m("catalog.purchase.confirmation.dialog.cost")}),l(w,{gap:1,children:[t(S,{bold:!0,children:s.publishDucketPrice}),t(at,{type:5})]})]}),b>0&&t("div",{className:"mt-1 text-center fw-bold",children:m("camera.publish.wait",["minutes"],[Math.ceil(b/60).toString()])})]}),!C&&t(w,{className:"d-flex align-items-end",children:t(D,{variant:"success",disabled:_||b>0,onClick:R=>O("publish"),children:m("camera.publish.button.text")})})]}),t(S,{center:!0,children:m("camera.warning.disclaimer")}),t(w,{justifyContent:"end",children:t(D,{onClick:R=>O("cancel"),children:m("generic.cancel")})})]})]}):null},sv=o=>{const{effect:e=null,thumbnailUrl:n=null,isActive:r=!1,isLocked:s=!1,selectEffect:a=null,removeEffect:c=null}=o;return l(Ie,{title:m(s?`camera.effect.required.level ${e.minLevel}`:`camera.effect.name.${e.name}`),itemActive:r,onClick:u=>!r&&a(),children:[r&&t(D,{variant:"danger",className:"rounded-circle remove-effect",onClick:c,children:t(hn,{className:"fa-icon"})}),!s&&n&&n.length>0&&t("div",{className:"effect-thumbnail-image border",children:t("img",{alt:"",src:n})}),s&&l(S,{center:!0,bold:!0,children:[t("div",{children:t(Cu,{className:"fa-icon"})}),e.minLevel]})]})},av=o=>{const{myLevel:e=0,selectedEffects:n=[],effects:r=[],thumbnails:s=[],processAction:a=null}=o;return t(se,{columnCount:3,overflow:"auto",children:r&&r.length>0&&r.map((c,u)=>{const d=s.find(g=>g.effectName===c.name),h=n.findIndex(g=>g.effect.name===c.name)>-1;return t(sv,{effect:c,thumbnailUrl:d&&d.thumbnailUrl||null,isActive:h,isLocked:c.minLevel>e,selectEffect:()=>a("select_effect",c.name),removeEffect:()=>a("remove_effect",c.name)},u)})})},Sc=[Xs.COLORMATRIX,Xs.COMPOSITE],ov=o=>{const{picture:e=null,availableEffects:n=null,myLevel:r=1,onClose:s=null,onCancel:a=null,onCheckout:c=null}=o,[u,d]=i.useState(Sc[0]),[h,g]=i.useState(null),[f,p]=i.useState([]),[C,E]=i.useState([]),[_,I]=i.useState(!1),b=i.useMemo(()=>n.filter(M=>M.colorMatrix),[n]),N=i.useMemo(()=>n.filter(M=>M.texture),[n]),v=i.useCallback(()=>u===Xs.COLORMATRIX?b:N,[u,b,N]),O=i.useCallback(M=>!M||!M.length||!f||!f.length?-1:f.findIndex(U=>U.effect.name===M),[f]),R=i.useMemo(()=>O(h),[h,O]),y=i.useMemo(()=>h&&f[R]||null,[h,R,f]),G=i.useCallback(M=>{const U=R;U!==-1&&p(W=>{const L=[...W],x=L[U];return L[R]=new Vo(x.effect,M),L})},[R,p]),k=i.useMemo(()=>xs().applyEffects(e.texture,f,_).src,[e,f,_]),B=i.useCallback((M,U=null)=>{switch(M){case"close":s();return;case"cancel":a();return;case"checkout":c(k);return;case"change_tab":d(String(U));return;case"select_effect":{if(O(U)>=0)return;const L=n.find(x=>x.name===U);if(!L)return;p(x=>[...x,new Vo(L,1)]),g(L.name);return}case"remove_effect":{let W=O(U);if(W===-1)return;p(L=>{const x=[...L];return x.splice(W,1),x}),h===U&&g(null);return}case"clear_effects":g(null),p([]);return;case"download":{const W=new Image;W.src=k,window.open("").document.write(W.outerHTML);return}case"zoom":I(!_);return}},[_,n,h,k,O,a,c,s,I,p]);return i.useEffect(()=>{const M=[];for(const U of n)M.push(new Gb(U.name,xs().applyEffects(e.texture,[new Vo(U,1)],!1).src));E(M)},[e,n]),l(oe,{className:"nitro-camera-editor",children:[t(ie,{headerText:m("camera.editor.button.text"),onCloseClick:M=>B("close")}),t(lr,{children:Sc.map(M=>t(Mn,{isActive:u===M,onClick:U=>B("change_tab",M),children:t("i",{className:"icon icon-camera-"+M})},M))}),t(re,{children:l(se,{children:[t(T,{size:5,overflow:"hidden",children:t(av,{myLevel:r,selectedEffects:f,effects:v(),thumbnails:C,processAction:B})}),l(T,{size:7,justifyContent:"between",overflow:"hidden",children:[l(T,{center:!0,children:[t(ir,{imageUrl:k,className:"picture-preview"}),h&&l(T,{center:!0,fullWidth:!0,gap:1,children:[t(S,{children:m("camera.effect.name."+h)}),t(Dt,{className:"nitro-slider",min:0,max:1,step:.01,value:y.alpha,onChange:M=>G(M),renderThumb:(M,U)=>t("div",{...M,children:U.valueNow})})]})]}),l(w,{justifyContent:"between",children:[l(nr,{children:[t(D,{onClick:M=>B("clear_effects"),children:t(ji,{className:"fa-icon"})}),t(D,{onClick:M=>B("download"),children:t(ng,{className:"fa-icon"})}),l(D,{onClick:M=>B("zoom"),children:[_&&t(rg,{className:"fa-icon"}),!_&&t(sg,{className:"fa-icon"})]})]}),l(w,{gap:1,children:[t(D,{onClick:M=>B("cancel"),children:m("generic.cancel")}),t(D,{onClick:M=>B("checkout"),children:m("camera.preview.button.text")})]})]})]})]})})]})},as=0,Oa=1,Nc=2,Tc=3,iv=o=>{const[e,n]=i.useState(as),[r,s]=i.useState(null),{availableEffects:a=[],selectedPictureIndex:c=-1,cameraRoll:u=[],setCameraRoll:d=null,myLevel:h=0,price:g={credits:0,duckets:0,publishDucketPrice:0}}=Qd(),f=C=>{switch(C){case"close":n(as);return;case"edit":n(Nc);return;case"delete":d(E=>{const _=[...E];return _.splice(c,1),_});return;case"editor_cancel":n(Oa);return}},p=C=>{s(C),n(Tc)};return Ye(jt.ENDED,C=>n(as)),i.useEffect(()=>{const C={linkReceived:E=>{const _=E.split("/");if(!(_.length<2))switch(_[1]){case"show":n(Oa);return;case"hide":n(as);return;case"toggle":n(I=>I?as:Oa);return}},eventUrlPrefix:"camera/"};return ut(C),()=>dt(C)},[]),e===as?null:l(V,{children:[e===Oa&&t(nv,{onClose:()=>f("close"),onEdit:()=>f("edit"),onDelete:()=>f("delete")}),e===Nc&&t(ov,{picture:u[c],myLevel:h,onClose:()=>f("close"),onCancel:()=>f("editor_cancel"),onCheckout:p,availableEffects:a}),e===Tc&&t(rv,{base64Url:r,onCloseClick:()=>f("close"),onCancelClick:()=>f("editor_cancel"),price:g})]})},lv=o=>{const{itemId:e=-1,state:n=null,product:r=null,active:s=!1,onClick:a=null}=o,c=u=>{let d=q().getFloorItemDataByName(u),h=null;return d?h=$().getFurnitureFloorIconUrl(d.id):(d=q().getWallItemDataByName(u),d&&(h=$().getFurnitureWallIconUrl(d.id))),h};return l(T,{fit:!0,center:!0,pointer:!0,className:`campaign-spritesheet campaign-day-generic-bg rounded calendar-item ${s?"active":""}`,onClick:()=>a(e),children:[n===xt.STATE_UNLOCKED&&t(w,{center:!0,className:"campaign-spritesheet unlocked-bg",children:t(w,{center:!0,className:"campaign-spritesheet campaign-opened",children:r&&t(ir,{imageUrl:r.customImage?K("image.library.url")+r.customImage:c(r.productName)})})}),n!==xt.STATE_UNLOCKED&&l(w,{center:!0,className:"campaign-spritesheet locked-bg",children:[n===xt.STATE_LOCKED_AVAILABLE&&t(P,{className:"campaign-spritesheet available"}),(n===xt.STATE_LOCKED_EXPIRED||n===xt.STATE_LOCKED_FUTURE)&&t(P,{className:"campaign-spritesheet unavailable"})]})]})},Jo=5,cv=o=>{const{onClose:e=null,campaignName:n=null,currentDay:r=null,numDays:s=null,missedDays:a=null,openedDays:c=null,openPackage:u=null,receivedProducts:d=null}=o,[h,g]=i.useState(r),[f,p]=i.useState(Math.max(0,h-1)),C=v=>c.includes(v)?xt.STATE_UNLOCKED:v>r?xt.STATE_LOCKED_FUTURE:a.includes(v)?xt.STATE_LOCKED_EXPIRED:xt.STATE_LOCKED_AVAILABLE,E=v=>{switch(C(v)){case xt.STATE_UNLOCKED:return m("campaign.calendar.info.unlocked");case xt.STATE_LOCKED_FUTURE:return m("campaign.calendar.info.future");case xt.STATE_LOCKED_EXPIRED:return m("campaign.calendar.info.expired");default:return m("campaign.calendar.info.available.desktop")}},_=()=>{const v=h+1;v!==s&&(g(v),f+Jo<v+1&&p(f+1))},I=()=>{const v=h-1;v<0||(g(v),f>v&&p(f-1))},b=v=>{if(h===v){C(v)===xt.STATE_LOCKED_AVAILABLE&&u(v,!1);return}g(v)},N=()=>{const v=h;C(v)!==xt.STATE_UNLOCKED&&u(v,!0)};return l(oe,{className:"nitro-campaign-calendar",theme:"primary-slim",children:[t(ie,{headerText:m(`campaign.calendar.${n}.title`),onCloseClick:e}),l(re,{children:[l(se,{fullHeight:!1,justifyContent:"between",alignItems:"center",children:[t(T,{size:1}),t(T,{size:10,children:l(w,{justifyContent:"between",alignItems:"center",gap:1,children:[l(T,{gap:1,children:[t(S,{fontSize:3,children:m("campaign.calendar.heading.day",["number"],[(h+1).toString()])}),t(S,{children:E(h)})]}),t("div",{children:q().isModerator&&t(D,{variant:"danger",onClick:N,children:"Force open"})})]})}),t(T,{size:1})]}),l(w,{fullHeight:!0,gap:2,children:[t(w,{center:!0,children:t(P,{pointer:!0,className:"campaign-spritesheet prev",onClick:I})}),t(T,{center:!0,fullWidth:!0,children:t(se,{fit:!0,columnCount:Jo,gap:1,children:[...Array(Jo)].map((v,O)=>{const R=f+O;return t(T,{overflow:"hidden",children:t(lv,{itemId:R,state:C(R),active:h===R,product:d.has(R)?d.get(R):null,onClick:b})},O)})})}),t(w,{center:!0,children:t(P,{pointer:!0,className:"campaign-spritesheet next",onClick:_})})]})]})]})},uv=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(-1),[a,c]=i.useState(new Map),[u,d]=i.useState(!1),h=(g,f=!1)=>{e&&(s(g),A(f?new yI(e.campaignName,g):new OI(e.campaignName,g)))};return F(kI,g=>{const f=g.getParser();f&&n(f.calendarData)}),F(AI,g=>{const f=g.getParser();if(!f)return;const p=r;f.doorOpened&&(n(C=>{const E=C.clone();return E.openedDays.push(r),E}),c(C=>{const E=new Map(C);return E.set(p,new Vb(f.productName,f.customImage,f.furnitureClassName)),E})),s(-1)}),i.useEffect(()=>{const g={linkReceived:f=>{const p=f.split("/");if(!(p.length<2))switch(p[1]){case"calendar":d(!0);break}},eventUrlPrefix:"openView/"};return ut(g),()=>dt(g)},[]),t(V,{children:e&&u&&t(cv,{onClose:()=>d(!1),campaignName:e.campaignName,currentDay:e.currentDay,numDays:e.campaignDays,openedDays:e.openedDays,missedDays:e.missedDays,openPackage:h,receivedProducts:a})})},Tm=o=>{const{icon:e=0}=o,n=i.useMemo(()=>K("catalog.asset.icon.url").replace("%name%",e.toString()),[e]);return t(ir,{imageUrl:n,style:{width:20,height:20}})},dv=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(0),[a,c]=i.useState(0),[u,d]=i.useState(""),[h,g]=i.useState(""),[f,p]=i.useState(!0),[C,E]=i.useState(""),[_,I]=i.useState([]),[b,N]=i.useState(0),[v,O]=i.useState(0),[R,y]=i.useState(0),[G,k]=i.useState(0),[B,M]=i.useState(0),[U,W]=i.useState(!1),{catalogOptions:L=null}=Be(),{friends:x}=fn(),{giftConfiguration:j=null}=L,[H,te]=i.useState([]),[ne,Ce]=i.useState([]),[Me,Ze]=i.useState(!0),tt=i.useCallback(()=>{n(!1),s(0),c(0),d(""),g(""),p(!0),E(""),N(0),O(0),Ze(!1),Ce([]),_.length&&y(_[0].id)},[_]),Ft=i.useMemo(()=>j?j.defaultStuffTypes.findIndex(pe=>pe===H[b])>-1:!1,[H,j,b]),je=i.useMemo(()=>j?(H[b]*1e3+j.ribbonTypes[v]).toString():"",[j,b,v,H]),qt=i.useMemo(()=>{if(!j||Ft)return!1;const pe=H[b];return!(pe===8||pe>=3&&pe<=6)},[j,b,Ft,H]),Tn=i.useMemo(()=>Ft?H[b]:R,[Ft,H,b,R]),Ge=x.filter(pe=>pe.id!==-1),Ee=pe=>{const Le=pe.target.value;let vn=[];Le.length>0&&(vn=Ge.sort().filter(Dr=>Dr.name.includes(Le))),g(Le),Ze(!0),Ce(vn)},$e=pe=>{g(pe),Ze(!1)},Ot=i.useCallback(pe=>{switch(pe){case"prev_box":N(Le=>Le===0?G:Le-1);return;case"next_box":N(Le=>Le===G?0:Le+1);return;case"prev_ribbon":O(Le=>Le===0?B:Le-1);return;case"next_ribbon":O(Le=>Le===B?0:Le+1);return;case"buy":if(!h||h.length===0){W(!0);return}A(new PI(r,a,u,h,C,Tn,b,v,f));return}},[Tn,u,G,B,C,a,r,h,b,v,f]);F(DI,pe=>W(!0)),lt([yr.PURCHASE_SUCCESS,gn.INIT_GIFT],pe=>{switch(pe.type){case yr.PURCHASE_SUCCESS:tt();return;case gn.INIT_GIFT:const Le=pe;tt(),s(Le.pageId),c(Le.offerId),d(Le.extraData),n(!0);return}}),i.useEffect(()=>{W(!1)},[h]);const me=i.useCallback(()=>{j&&te(pe=>{let Le=[...j.boxTypes];return Le.push(j.defaultStuffTypes[Math.floor(Math.random()*(j.defaultStuffTypes.length-1))]),k(Le.length-1),M(Le.length-1),Le})},[j]);if(i.useEffect(()=>{if(!j)return;const pe=[];for(const Le of j.stuffTypes){const vn=q().getFloorItemData(Le);vn&&vn.colors&&vn.colors.length>0&&pe.push({id:Le,color:en.makeColorNumberHex(vn.colors[0])})}me(),pe.length&&(y(pe[0].id),I(pe))},[j,me]),i.useEffect(()=>{e&&me()},[me,e]),!j||!j.isEnabled||!e)return null;const Ae="catalog.gift_wrapping_new.box."+(Ft?"default":H[b]),it=`catalog.gift_wrapping_new.ribbon.${v}`,nn="catalog.gift_wrapping_new."+(Ft?"freeprice":"price");return l(oe,{uniqueKey:"catalog-gift",className:"nitro-catalog-gift",theme:"primary-slim",children:[t(ie,{headerText:m("catalog.gift_wrapping.title"),onCloseClick:tt}),l(re,{className:"text-black",children:[l(vS,{column:!0,children:[t(S,{children:m("catalog.gift_wrapping.receiver")}),t("input",{type:"text",className:Gt("form-control form-control-sm",U&&"is-invalid"),value:h,onChange:pe=>Ee(pe)}),ne.length>0&&Me&&t(T,{className:"autocomplete-gift-container",children:ne.map(pe=>t(P,{className:"autocomplete-gift-item",onClick:Le=>$e(pe.name),children:pe.name},pe.id))}),U&&t(P,{className:"invalid-feedback",children:m("catalog.gift_wrapping.receiver_not_found.title")})]}),t($d,{figure:q().figure,userName:q().userName,message:C,editable:!0,onChange:pe=>E(pe)}),l(P,{className:"form-check",children:[t("input",{className:"form-check-input",type:"checkbox",name:"showMyFace",checked:f,onChange:pe=>p(Le=>!Le)}),t("label",{className:"form-check-label",children:m("catalog.gift_wrapping.show_face.title")})]}),l(w,{alignItems:"center",gap:2,children:[R&&t(P,{className:"gift-preview",children:t(il,{productType:de.FLOOR,productClassId:Tn,extraData:je})}),l(T,{gap:1,children:[l(w,{gap:2,children:[l(nr,{children:[t(D,{variant:"primary",onClick:()=>Ot("prev_box"),children:t(Jt,{className:"fa-icon"})}),t(D,{variant:"primary",onClick:()=>Ot("next_box"),children:t(Zt,{className:"fa-icon"})})]}),l(T,{gap:1,children:[t(S,{fontWeight:"bold",children:m(Ae)}),l(w,{alignItems:"center",gap:1,children:[m(nn,["price"],[j.price.toString()]),t(at,{type:-1})]})]})]}),l(w,{alignItems:"center",gap:2,className:qt?"":"opacity-50 pointer-events-none",children:[l(nr,{children:[t(D,{variant:"primary",onClick:()=>Ot("prev_ribbon"),children:t(Jt,{className:"fa-icon"})}),t(D,{variant:"primary",onClick:()=>Ot("next_ribbon"),children:t(Zt,{className:"fa-icon"})})]}),t(S,{fontWeight:"bold",children:m(it)})]})]})]}),l(T,{gap:1,className:qt?"":"opacity-50 pointer-events-none",children:[t(S,{fontWeight:"bold",children:m("catalog.gift_wrapping.pick_color")}),t(nr,{fullWidth:!0,children:_.map(pe=>t(D,{variant:"dark",active:pe.id===R,disabled:!qt,style:{backgroundColor:pe.color},onClick:()=>y(pe.id)},pe.id))})]}),l(w,{justifyContent:"between",alignItems:"center",children:[t(D,{variant:"link",onClick:tt,className:"text-black",children:m("cancel")}),t(D,{variant:"success",onClick:()=>Ot("buy"),children:m("catalog.gift_wrapping.give_gift")})]})]})]})},mv=o=>{const[e,n]=i.useState(""),{currentType:r=null,rootNode:s=null,offersToNodes:a=null,searchResult:c=null,setSearchResult:u=null,setCurrentPage:d=null}=Be();return i.useEffect(()=>{let h=e==null?void 0:e.toLocaleLowerCase().replace(" ","");if(!h||!h.length){u(null);return}const g=setTimeout(()=>{const f=q().getAllFurnitureData({loadFurnitureData:null});if(!f||!f.length)return;const p=[],C=[];for(const I of f){if(r===kn.BUILDER&&!I.availableForBuildersClub||r===kn.NORMAL&&I.excludeDynamic)continue;const b=[I.className,I.name,I.description].join(" ").replace(/ /gi,"").toLowerCase();if(r===kn.BUILDER&&I.purchaseOfferId===-1&&I.rentOfferId===-1)I.furniLine!==""&&C.indexOf(I.furniLine)<0&&b.indexOf(h)>=0&&C.push(I.furniLine);else if([...Yl(a,I.purchaseOfferId),...Yl(a,I.rentOfferId)].length&&(b.indexOf(h)>=0&&p.push(I),p.length===250))break}const E=[];for(const I of p)E.push(new ab(I));let _=[];gd(h,C,s,_),u(new cb(h,E,_.filter(I=>I.isVisible))),d(new md(-1,"default_3x3",new pd([],[]),E,!1,1))},300);return()=>clearTimeout(g)},[a,r,s,e,d,u]),l(w,{gap:1,children:[t(w,{fullWidth:!0,alignItems:"center",position:"relative",children:t("input",{type:"text",className:"form-control form-control-sm",placeholder:m("generic.search"),value:e,onChange:h=>n(h.target.value)})}),(!e||!e.length)&&t(D,{variant:"primary",className:"catalog-search-button",children:t(io,{className:"fa-icon"})}),e&&!!e.length&&t(D,{variant:"primary",className:"catalog-search-button",onClick:h=>n(""),children:t(hn,{className:"fa-icon"})})]})},vm=o=>{const{node:e=null,child:n=!1}=o;return t(V,{children:e&&e.children.length>0&&e.children.map((r,s)=>r.isVisible?t(wm,{node:r,child:n},s):null)})},wm=o=>{const{node:e=null,child:n=!1}=o,{activateNode:r=null}=Be();return l(P,{className:"nitro-catalog-navigation-section",children:[l(Ie,{gap:1,column:!1,itemActive:e.isActive,onClick:s=>r(e),className:n?"inset":"",children:[t(Tm,{icon:e.iconId}),t(S,{grow:!0,truncate:!0,children:e.localization}),e.isBranch&&l(V,{children:[e.isOpen&&t(Hi,{className:"fa-icon"}),!e.isOpen&&t(Wi,{className:"fa-icon"})]})]}),e.isOpen&&e.isBranch&&t(vm,{node:e,child:!0})]})},gv=o=>{const{node:e=null}=o,{searchResult:n=null}=Be();return l(V,{children:[t(mv,{}),t(T,{fullHeight:!0,className:"nitro-catalog-navigation-grid-container rounded p-1",overflow:"hidden",children:l(ke,{id:"nitro-catalog-main-navigation",gap:1,columnCount:1,children:[n&&n.filteredNodes.length>0&&n.filteredNodes.map((r,s)=>t(wm,{node:r},s)),!n&&t(vm,{node:e})]})})]})},hv=o=>{const{columnCount:e=5,...n}=o,[r,s]=i.useState(!1),[a,c]=i.useState(null),{currentOffer:u=null,setPurchaseOptions:d=null}=Be(),{badgeCodes:h=[],activate:g=null,deactivate:f=null}=wo(),p=i.useMemo(()=>{if(!a)return null;const C=new ea;return C.setValue(["0",a,"",""]),C},[a]);return i.useEffect(()=>{u&&d(C=>{const E={...C};return E.extraParamRequired=!0,E.extraData=p&&p.getValue(1)||null,E.previewStuffData=p,E})},[u,p,d]),i.useEffect(()=>{if(!r)return;const C=g();return()=>f(C)},[r,g,f]),i.useEffect(()=>(s(!0),()=>s(!1)),[]),t(ke,{columnCount:e,...n,children:h&&h.length>0&&h.map((C,E)=>t(Ie,{itemActive:a===C,onClick:_=>c(C),children:t(qe,{badgeCode:C})},E))})},Ro=o=>{const{currentPage:e=null,setCurrentOffer:n=null}=Be();return i.useEffect(()=>{!e||!e.offers.length||n(e.offers[0])},[e,n]),null},hl=o=>{const{offer:e=null,selectOffer:n=null,itemActive:r=!1,...s}=o,[a,c]=i.useState(!1),{requestOfferToMover:u=null}=Be(),{isVisible:d=!1}=Zr(),h=i.useMemo(()=>e.pricingModel===zt.PRICING_MODEL_BUNDLE?null:e.product.getIconUrl(e),[e]),g=p=>{switch(p.type){case Re.MOUSE_DOWN:n(e),c(!0);return;case Re.MOUSE_UP:c(!1);return;case Re.ROLL_OUT:if(!a||!r||!d)return;u(e);return}},f=e.product;return f?t(Ie,{itemImage:h,itemCount:e.pricingModel===zt.PRICING_MODEL_MULTI?f.productCount:1,itemUniqueSoldout:f.uniqueLimitedItemSeriesSize&&!f.uniqueLimitedItemsLeft,itemUniqueNumber:f.uniqueLimitedItemSeriesSize,itemActive:r,onMouseDown:g,onMouseUp:g,onMouseOut:g,...s,children:e.product.productType===de.ROBOT&&t(ot,{figure:e.product.extraParam,headOnly:!0,direction:3})}):null},da=o=>{const{columnCount:e=5,children:n=null,...r}=o,{currentOffer:s=null,setCurrentOffer:a=null,currentPage:c=null,setPurchaseOptions:u=null}=Be(),d=i.useRef();if(i.useEffect(()=>{d&&d.current&&(d.current.scrollTop=0)},[c]),!c)return null;const h=g=>{g.activate(),!g.isLazy&&(a(g),g.product&&g.product.productType===de.WALL&&u(f=>{const p={...f};return p.extraData=g.product.extraParam||null,p}))};return l(ke,{innerRef:d,columnCount:e,...r,children:[c.offers&&c.offers.length>0&&c.offers.map((g,f)=>t(hl,{itemActive:s&&s.offerId===g.offerId,offer:g,selectOffer:h},f)),n]})},yo=o=>{const{children:e=null,...n}=o,{currentOffer:r=null}=Be();return!r||r.pricingModel!==zt.PRICING_MODEL_SINGLE||!r.product.isUniqueLimitedItem?null:l(P,{...n,children:[t(SS,{className:"mx-auto",uniqueLimitedItemsLeft:r.product.uniqueLimitedItemsLeft,uniqueLimitedSeriesSize:r.product.uniqueLimitedItemSeriesSize}),e]})},$n=o=>{const{noGiftOption:e=!1,purchaseCallback:n=null}=o;i.useState(!1);const[r,s]=i.useState(Ve.NONE);So(aa.CATALOG_SKIP_PURCHASE_CONFIRMATION,!1);const{currentOffer:a=null,currentPage:c=null,purchaseOptions:u=null,setPurchaseOptions:d=null}=Be(),{getCurrencyAmount:h=null}=es(),g=i.useCallback(E=>{switch(E.type){case yr.PURCHASE_SUCCESS:s(Ve.NONE);return;case vs.PURCHASE_FAILED:s(Ve.FAILED);return;case Mi.NOT_ALLOWED:s(Ve.FAILED);return;case Li.SOLD_OUT:s(Ve.SOLD_OUT);return}},[]);lt(yr.PURCHASE_SUCCESS,g),lt(vs.PURCHASE_FAILED,g),lt(Mi.NOT_ALLOWED,g),lt(Li.SOLD_OUT,g);const f=i.useMemo(()=>{if(!a||u.extraParamRequired&&(!u.extraData||!u.extraData.length))return!1;if(a.pricingModel===zt.PRICING_MODEL_SINGLE){const E=a.product;if(E&&E.isUniqueLimitedItem)return!E.uniqueLimitedItemsLeft}return!1},[a,u]),p=(E=!1)=>{if(!a)return;if(Cn()<a.clubLevel){ee("habboUI/open/hccenter");return}if(E){St(new DS(a.page.pageId,a.offerId,u.extraData));return}if(s(Ve.PURCHASE),n){n();return}let _=a.page.pageId;A(new co(_,a.offerId,u.extraData,u.quantity))};return i.useEffect(()=>{a&&s(Ve.NONE)},[a,d]),i.useEffect(()=>{let E=null;return(r===Ve.CONFIRM||r===Ve.FAILED)&&(E=setTimeout(()=>s(Ve.NONE),3e3)),()=>{E&&clearTimeout(E)}},[r]),a?l(V,{children:[t(()=>{const E=a.priceInCredits*u.quantity,_=a.priceInActivityPoints*u.quantity;if(Cn()<a.clubLevel)return t(D,{variant:"danger",disabled:!0,children:m("catalog.alert.hc.required")});if(f)return t(D,{variant:"danger",disabled:!0,children:m("catalog.alert.limited_edition_sold_out.title")});if(E>h(-1))return t(D,{variant:"danger",disabled:!0,children:m("catalog.alert.notenough.title")});if(_>h(a.activityPointType))return t(D,{variant:"danger",disabled:!0,children:m("catalog.alert.notenough.activitypoints.title."+a.activityPointType)});switch(r){case Ve.CONFIRM:return t(D,{variant:"warning",onClick:I=>p(),children:m("catalog.marketplace.confirm_title")});case Ve.PURCHASE:return t(D,{disabled:!0,children:t(ll,{})});case Ve.FAILED:return t(D,{variant:"danger",children:m("generic.failed")});case Ve.SOLD_OUT:return t(D,{variant:"danger",children:m("generic.failed")+" - "+m("catalog.alert.limited_edition_sold_out.title")});case Ve.NONE:default:return t(D,{disabled:u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:I=>s(Ve.CONFIRM),children:m("catalog.purchase_confirmation."+(a.isRentOffer?"rent":"buy"))})}},{}),!e&&!a.isRentOffer&&t(D,{disabled:u.quantity>1||!a.giftable||f||u.extraParamRequired&&(!u.extraData||!u.extraData.length),onClick:E=>p(!0),children:m("catalog.purchase_confirmation.gift")})]}):null},Rm=o=>{const{offer:e=null,separator:n=!1}=o,{purchaseOptions:r=null}=Be(),{quantity:s=1}=r;return e?l(V,{children:[e.priceInCredits>0&&l(w,{alignItems:"center",gap:1,children:[t(S,{bold:!0,children:e.priceInCredits*s}),t(at,{type:-1})]}),n&&e.priceInCredits>0&&e.priceInActivityPoints>0&&t(Js,{size:"xs",color:"black",className:"fa-icon"}),e.priceInActivityPoints>0&&l(w,{alignItems:"center",gap:1,children:[t(S,{bold:!0,children:e.priceInActivityPoints*s}),t(at,{type:e.activityPointType})]})]}):null},_r=o=>{const{gap:e=1,...n}=o,{currentOffer:r=null}=Be();return t(T,{gap:e,...n,children:t(Rm,{offer:r})})},Pr=o=>{const{currentOffer:e=null,roomPreviewer:n=null,purchaseOptions:r=null}=Be(),{previewStuffData:s=null}=r;return i.useEffect(()=>{if(!e||e.pricingModel===zt.PRICING_MODEL_BUNDLE||!n)return;const a=e.product;if(a)switch(n.reset(!1),a.productType){case de.FLOOR:{if(!a.furnitureData)return;if(a.furnitureData.specialType===Z.FIGURE_PURCHASABLE_SET){const u=q().getFloorItemData(a.furnitureData.id).customParams.split(",").map(g=>parseInt(g)),d=[];for(const g of u)Nt().isValidFigureSetForGender(g,q().gender)&&d.push(g);const h=Nt().getFigureStringWithFigureIds(q().figure,q().gender,d);n.addAvatarIntoRoom(h,a.productClassId)}else n.addFurnitureIntoRoom(a.productClassId,new wt(90),s,a.extraParam);return}case de.WALL:{if(!a.furnitureData)return;switch(a.furnitureData.specialType){case Z.FLOOR:n.updateObjectRoom(a.extraParam);return;case Z.WALL_PAPER:n.updateObjectRoom(null,a.extraParam);return;case Z.LANDSCAPE:{n.updateObjectRoom(null,null,a.extraParam);const c=q().getWallItemDataByName("window_double_default");c&&n.addWallItemIntoRoom(c.id,new wt(90),c.customParams);return}default:n.updateObjectRoom("default","default","default"),n.addWallItemIntoRoom(a.productClassId,new wt(90),a.extraParam);return}}case de.ROBOT:n.addAvatarIntoRoom(a.extraParam,0);return;case de.EFFECT:n.addAvatarIntoRoom(q().figure,a.productClassId);return}},[e,s,n]),e?e.pricingModel===zt.PRICING_MODEL_BUNDLE?t(T,{fit:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(ke,{fullWidth:!0,columnCount:4,className:"nitro-catalog-layout-bundle-grid",children:e.products.length>0&&e.products.map((a,c)=>t(Ie,{itemImage:a.getIconUrl(e),itemCount:a.productCount},c))})}):t(Eo,{roomPreviewer:n,height:140}):null},fv=o=>{const{page:e=null}=o,{currentOffer:n=null}=Be();return l(V,{children:[t(Ro,{}),l(se,{children:[l(T,{size:7,overflow:"hidden",children:[t(da,{shrink:!0}),l(T,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:m("catalog_selectbadge")}),t(hv,{})]})]}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(V,{children:[t(P,{position:"relative",overflow:"hidden",children:t(Pr,{})}),l(T,{grow:!0,gap:1,children:[t(yo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:n.localizationName}),t(w,{justifyContent:"end",children:t(_r,{alignItems:"end"})}),t($n,{})]})]})]})]})]})},Or=o=>{const{...e}=o,{currentOffer:n=null}=Be();return!n||!n.badgeCode||!n.badgeCode.length?null:t(qe,{badgeCode:n.badgeCode,...e})},pv=1,Iv=100,fl=o=>{const{currentOffer:e=null,purchaseOptions:n=null,setPurchaseOptions:r=null}=Be(),{quantity:s=1}=n,a=c=>{isNaN(c)&&(c=1),c=Math.max(c,pv),c=Math.min(c,Iv),c!==s&&r(u=>{const d={...u};return d.quantity=c,d})};return!e||!e.bundlePurchaseAllowed?null:l(V,{children:[t(S,{children:m("catalog.bundlewidget.spinner.select.amount")}),l(w,{alignItems:"center",gap:1,children:[t(_u,{className:"text-black cursor-pointer fa-icon",onClick:c=>a(s-1)}),t("input",{type:"number",className:"form-control form-control-sm quantity-input",value:s,onChange:c=>a(c.target.valueAsNumber)}),t(bu,{className:"text-black cursor-pointer fa-icon",onClick:c=>a(s+1)})]})]})},Ev=o=>{const{page:e=null}=o,[n,r]=i.useState(new Map),{currentOffer:s=null,setCurrentOffer:a=null}=Be(),[c,u]=i.useState(!1),d=(C,E)=>!C.product.furnitureData.colorIndex||!E.product.furnitureData.colorIndex||C.product.furnitureData.colorIndex>E.product.furnitureData.colorIndex?1:C==E?0:-1,h=(C,E)=>C.product.furnitureData.className>E.product.furnitureData.className?1:C==E?0:-1,g=C=>{C.activate(),a(C)},f=(C,E)=>{const _=`${E}*${C}`,I=e.offers.findIndex(b=>b.product.furnitureData.fullName===_);I>-1&&g(e.offers[I])},p=i.useMemo(()=>{const C=[],E=new Map,_=new Map;return e.offers.sort(d),e.offers.forEach(I=>{if(!I.product)return;const b=I.product.furnitureData;if(!b||!b.hasIndexedColor)C.push(I);else{const N=b.className,v=b.colorIndex;_.has(N)||_.set(N,[]);let O=16777215;if(b.colors){for(let R of b.colors)R!==16777215&&(O=R);_.get(N).indexOf(O)===-1&&(_.get(N)[v]=O)}E.has(N)||(C.push(I),E.set(N,!0))}}),C.sort(h),r(_),C},[e.offers]);return l(se,{children:[t(T,{size:7,overflow:"hidden",children:l(ke,{columnCount:5,children:[(!c||!s||!n.has(s.product.furnitureData.className))&&p.map((C,E)=>t(hl,{itemActive:s&&(s.product.furnitureData.hasIndexedColor?s.product.furnitureData.className===C.product.furnitureData.className:s.offerId===C.offerId),offer:C,selectOffer:g},E)),c&&s&&n.has(s.product.furnitureData.className)&&n.get(s.product.furnitureData.className).map((C,E)=>t(Ie,{itemHighlight:!0,itemActive:s.product.furnitureData.colorIndex===E,itemColor:cn.int2rgb(C),className:"clear-bg",onClick:_=>f(E,s.product.furnitureData.className)},E))]})}),l(T,{center:!s,size:5,overflow:"hidden",children:[!s&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),s&&l(V,{children:[l(P,{position:"relative",overflow:"hidden",children:[t(Pr,{}),t(Or,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),s.product.furnitureData.hasIndexedColor&&t(D,{position:"absolute",className:"bottom-1 start-1",onClick:C=>u(E=>!E),children:t(Su,{className:"fa-icon"})})]}),l(T,{grow:!0,gap:1,children:[t(yo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:s.localizationName}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(fl,{})}),t(_r,{justifyContent:"end",alignItems:"end"})]}),t($n,{})]})]})]})]})},ym=o=>{const{imageUrl:e=null}=o,[n,r]=i.useState("");return i.useEffect(()=>{r(e??K("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder"))},[e]),t(w,{center:!0,fullWidth:!0,className:"nitro-catalog-header",children:t("img",{src:n,onError:({currentTarget:s})=>{s.src=K("catalog.asset.image.url").replace("%name%","catalog_header_roombuilder")}})})},Cv=o=>{const{page:e=null}=o,{currentOffer:n=null,currentPage:r=null}=Be();return t(V,{children:l(se,{children:[l(T,{size:7,overflow:"hidden",children:[K("catalog.headers")&&t(ym,{imageUrl:r.localization.getImage(0)}),t(da,{})]}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(V,{children:[!!e.localization.getImage(1)&&t(ir,{imageUrl:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(V,{children:[l(w,{center:!0,overflow:"hidden",style:{height:140},children:[n.product.productType!==de.BADGE&&l(V,{children:[t(Pr,{}),t(Or,{className:"bg-muted rounded bottom-1 end-1"})]}),n.product.productType===de.BADGE&&t(Or,{className:"scale-2"})]}),l(T,{grow:!0,gap:1,children:[t(yo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:n.localizationName}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(fl,{})}),t(_r,{justifyContent:"end",alignItems:"end"})]}),t($n,{})]})]})]})]})})},_v=o=>{const{...e}=o,{currentOffer:n=null,purchaseOptions:r=null}=Be(),{previewStuffData:s=null}=r,a=i.useMemo(()=>{if(!n||!s)return null;const c=s.getValue(2);return!c||!c.length?null:c},[n,s]);return a?t(qe,{badgeCode:a,isGroup:!0,...e}):null},Om=o=>{const[e,n]=i.useState(0),{currentOffer:r=null,catalogOptions:s=null,setPurchaseOptions:a=null}=Be(),{groups:c=null}=s,u=i.useMemo(()=>{if(!c||!c.length)return null;const h=c[e];if(!h)return null;const g=new ea;return g.setValue(["0",h.groupId.toString(),h.badgeCode,h.colorA,h.colorB]),g},[e,c]);if(i.useEffect(()=>{r&&a(h=>{const g={...h};return g.extraParamRequired=!0,g.extraData=u&&u.getValue(1)||null,g.previewStuffData=u,g})},[r,u,a]),i.useEffect(()=>{A(new Ku)},[]),!c||!c.length)return l(P,{className:"bg-muted rounded p-1 text-black text-center",children:[m("catalog.guild_selector.members_only"),t(D,{className:"mt-1",children:m("catalog.guild_selector.find_groups")})]});const d=c[e];return l(w,{gap:1,children:[!!d&&l(w,{overflow:"hidden",className:"rounded border",children:[t(P,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+d.colorA}}),t(P,{fullHeight:!0,style:{width:"20px",backgroundColor:"#"+d.colorB}})]}),t("select",{className:"form-select form-select-sm",value:e,onChange:h=>n(parseInt(h.target.value)),children:c.map((h,g)=>t("option",{value:g,children:h.groupName},g))})]})},bv=o=>{const{page:e=null}=o,{currentOffer:n=null}=Be();return l(se,{children:[t(T,{size:7,overflow:"hidden",children:t(da,{})}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(V,{children:[l(P,{position:"relative",overflow:"hidden",children:[t(Pr,{}),t(_v,{position:"absolute",className:"bottom-1 end-1"})]}),l(T,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:n.localizationName}),t(P,{grow:!0,children:t(Om,{})}),t(w,{justifyContent:"end",children:t(_r,{alignItems:"end"})}),t($n,{})]})]})]})]})},Sv=o=>{const{page:e=null}=o;i.useState(0);const{currentOffer:n=null,setCurrentOffer:r=null,catalogOptions:s=null}=Be();return i.useEffect(()=>{A(new Ku)},[e]),l(V,{children:[t(Ro,{}),l(se,{children:[t(T,{className:"bg-muted rounded p-2 text-black",size:7,overflow:"hidden",children:t(P,{className:"overflow-auto",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})}),t(T,{size:5,overflow:"hidden",gap:1,children:!!n&&t(V,{children:l(T,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:n.localizationName}),t(P,{grow:!0,children:t(Om,{})}),t(w,{justifyContent:"end",children:t(_r,{alignItems:"end"})}),t($n,{noGiftOption:!0})]})})})]})]})},Nv=o=>{const{page:e=null}=o;return l(se,{children:[l(T,{size:7,overflow:"hidden",className:"bg-muted rounded p-2 text-black",children:[t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(P,{overflow:"auto",dangerouslySetInnerHTML:{__html:e.localization.getText(0)}}),t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),l(T,{center:!0,size:5,overflow:"hidden",children:[t(ir,{imageUrl:e.localization.getImage(1)}),t(D,{onClick:()=>ee("groups/create"),children:m("catalog.start.guild.purchase.button")})]})]})},Tv=o=>{const{page:e=null}=o;return t("div",{className:"h-100 nitro-catalog-layout-info-loyalty text-black d-flex flex-row",children:t("div",{className:"overflow-auto h-100 d-flex flex-column info-loyalty-content",children:t("div",{dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})})})},km=o=>{const{page:e=null}=o,n=e.localization.getImage(1);return l(T,{grow:!0,className:"bg-muted rounded text-black p-2",overflow:"hidden",children:[l(w,{alignItems:"center",gap:2,children:[n&&t("img",{alt:"",src:n}),t(P,{className:"fs-5",dangerouslySetInnerHTML:{__html:e.localization.getText(1)}})]}),t(T,{grow:!0,alignItems:"center",overflow:"auto",children:t(P,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}})}),t(w,{alignItems:"center",children:t(P,{className:"fw-bold",dangerouslySetInnerHTML:{__html:e.localization.getText(3)}})})]})},vv=o=>t(km,{...o}),wv=o=>{const{page:e=null}=o,[n,r]=i.useState(""),[s,a]=i.useState(""),[c,u]=i.useState(-1),[d,h]=i.useState([]),[g,f]=i.useState(!1),[p,C]=i.useState(1),{categories:E=null}=xn(),{setIsVisible:_=null}=Be(),{promoteInformation:I,isExtended:b,setIsExtended:N}=gl();i.useEffect(()=>{b&&(u(I.data.flatId),r(I.data.eventName),a(I.data.eventDescription),C(I.data.categoryId),f(b),N(!1))},[b,n,s,p]);const v=()=>{u(-1),r(""),a(""),C(1),N(!1),_(!1)},O=()=>{const R=e.pageId,y=e.offers.length>=1?e.offers[0].offerId:-1,G=c,k=n,B=s,M=p;A(new UI(R,y,G,k,g,B,M)),v()};return F(MI,R=>{const y=R.getParser();y&&h(y.rooms)}),i.useEffect(()=>{A(new LI),A(new Bu)},[]),l(V,{children:[t(S,{bold:!0,center:!0,children:m("roomad.catalog_header")}),l(T,{size:12,overflow:"hidden",className:"text-black",children:[t(P,{children:m("roomad.catalog_text",["duration"],["120"])}),l(P,{className:"bg-muted rounded p-1",children:[l(T,{gap:2,children:[t(S,{bold:!0,children:m("navigator.category")}),t("select",{className:"form-select form-select-sm",value:p,onChange:R=>C(parseInt(R.target.value)),disabled:g,children:E&&E.map((R,y)=>t("option",{value:R.id,children:m(R.name)},y))})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("roomad.catalog_name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:64,value:n,onChange:R=>r(R.target.value),readOnly:g})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("roomad.catalog_description")}),t("textarea",{className:"form-control form-control-sm",maxLength:64,value:s,onChange:R=>a(R.target.value),readOnly:g})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("roomad.catalog_roomname")}),l("select",{className:"form-select form-select-sm",value:c,onChange:R=>u(parseInt(R.target.value)),disabled:g,children:[t("option",{value:-1,disabled:!0,children:m("roomad.catalog_roomname")}),d&&d.map((R,y)=>t("option",{value:R.roomId,children:R.roomName},y))]})]}),t(T,{gap:1,children:t(D,{variant:!n||!s||c===-1?"danger":"success",onClick:O,disabled:!n||!s||c===-1,children:m(g?"roomad.extend.event":"buy")})})]})]})]})},Am=o=>{const{columnCount:e=5,children:n=null,...r}=o,{currentOffer:s=null}=Be(),a=i.useRef();return i.useEffect(()=>{a&&a.current&&(a.current.scrollTop=0)},[s]),s?l(ke,{innerRef:a,columnCount:5,...r,children:[s.products&&s.products.length>0&&s.products.map((c,u)=>t(Ie,{itemImage:c.getIconUrl(),itemCount:c.productCount},u)),n]}):null},Pm=o=>{const{gap:e=1,...n}=o,{currentOffer:r=null}=Be();return t(w,{gap:e,alignItems:"center",classNames:["bg-muted","p-1","rounded"],...n,children:t(Rm,{separator:!0,offer:r})})},Rv=o=>{const{page:e=null}=o;return l(V,{children:[t(Ro,{}),l(se,{children:[l(T,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&t(S,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(T,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(Am,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),l(T,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&t(S,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),l(T,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&t("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),t(Or,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),t(Pm,{position:"absolute",className:"bottom-0 end-0"})]}),t(T,{gap:1,children:t($n,{})})]})]})]})},yv=o=>{const{page:e=null}=o;return l(V,{children:[t(Ro,{}),l(se,{children:[l(T,{size:7,overflow:"hidden",children:[!!e.localization.getText(2)&&t(S,{dangerouslySetInnerHTML:{__html:e.localization.getText(2)}}),t(T,{grow:!0,overflow:"hidden",className:"bg-muted p-2 rounded",children:t(Am,{fullWidth:!0,className:"nitro-catalog-layout-bundle-grid"})})]}),l(T,{size:5,overflow:"hidden",gap:1,children:[!!e.localization.getText(1)&&t(S,{center:!0,small:!0,overflow:"auto",children:e.localization.getText(1)}),l(T,{grow:!0,position:"relative",overflow:"hidden",gap:0,children:[!!e.localization.getImage(1)&&t("img",{alt:"",className:"flex-grow-1",src:e.localization.getImage(1)}),t(Or,{position:"absolute",className:"bg-muted rounded bottom-0 start-0"}),t(Pm,{position:"absolute",className:"bottom-0 end-0"})]}),t(T,{gap:1,children:t($n,{})})]})]})]})},Ov=o=>{const{page:e=null}=o,[n,r]=i.useState(-1),[s,a]=i.useState(""),{currentOffer:c=null,currentPage:u=null}=Be(),d=h=>{var g;return(g=_e().soundManager.musicController)==null?void 0:g.playSong(h,Us.PRIORITY_PURCHASE_PREVIEW,15,0,0,0)};return F(xI,h=>{const g=h.getParser();g.officialSongId===s&&r(g.songId)}),i.useEffect(()=>{if(!c)return;const h=c.product;if(h){if(h.extraParam.length>0){const g=parseInt(h.extraParam);g>0?r(g):(a(h.extraParam),A(new FI(h.extraParam)))}else a(""),r(-1);return()=>{var g;return(g=_e().soundManager.musicController)==null?void 0:g.stop(Us.PRIORITY_PURCHASE_PREVIEW)}}},[c]),i.useEffect(()=>()=>{var h;return(h=_e().soundManager.musicController)==null?void 0:h.stop(Us.PRIORITY_PURCHASE_PREVIEW)},[]),t(V,{children:l(se,{children:[l(T,{size:7,overflow:"hidden",children:[K("catalog.headers")&&t(ym,{imageUrl:u.localization.getImage(0)}),t(da,{})]}),l(T,{center:!c,size:5,overflow:"hidden",children:[!c&&l(V,{children:[!!e.localization.getImage(1)&&t(ir,{imageUrl:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),c&&l(V,{children:[l(w,{center:!0,overflow:"hidden",style:{height:140},children:[c.product.productType!==de.BADGE&&l(V,{children:[t(Pr,{}),t(Or,{className:"bg-muted rounded bottom-1 end-1"})]}),c.product.productType===de.BADGE&&t(Or,{className:"scale-2"})]}),l(T,{grow:!0,gap:1,children:[t(yo,{fullWidth:!0}),t(S,{grow:!0,truncate:!0,children:c.localizationName}),n>-1&&t(D,{onClick:()=>d(n),children:m("play_preview_button")}),l(w,{justifyContent:"between",children:[t(T,{gap:1,children:t(fl,{})}),t(_r,{justifyContent:"end",alignItems:"end"})]}),t($n,{})]})]})]})]})})},kv=["floors","walls","views"],Av=o=>{const{columnCount:e=5,children:n=null,...r}=o,[s,a]=i.useState(null),[c,u]=i.useState(-1),[d,h]=i.useState(null),{currentPage:g=null,currentOffer:f=null,setCurrentOffer:p=null,setPurchaseOptions:C=null}=Be(),E=i.useRef(),_=b=>{b&&h(N=>{const v=[...N];return v[c]=b,v})};if(i.useEffect(()=>{if(!g)return;const b=[[],[],[]];for(const N of g.offers){if(N.pricingModel!==zt.PRICING_MODEL_SINGLE&&N.pricingModel!==zt.PRICING_MODEL_MULTI)continue;const v=N.product;if(!v||v.productType!==de.WALL&&v.productType!==de.FLOOR||!v.furnitureData)continue;switch(v.furnitureData.className){case"floor":b[0].push(N);break;case"wallpaper":b[1].push(N);break;case"landscape":b[2].push(N);break}}a(b),u(0),h([b[0][0],b[1][0],b[2][0]])},[g]),i.useEffect(()=>{c===-1||!d||p(d[c])},[c,d,p]),i.useEffect(()=>{c===-1||!d||!f||C(b=>{const N={...b};return N.extraData=d[c].product.extraParam,N.extraParamRequired=!0,N})},[f,c,d,C]),i.useEffect(()=>{E&&E.current&&(E.current.scrollTop=0)},[c]),!s||c===-1)return null;const I=s[c];return l(V,{children:[t(nr,{children:kv.map((b,N)=>t(D,{active:c===N,onClick:v=>u(N),children:m(`catalog.spaces.tab.${b}`)},N))}),l(ke,{innerRef:E,columnCount:e,...r,children:[I&&I.length>0&&I.map((b,N)=>t(hl,{itemActive:f&&f===b,offer:b,selectOffer:v=>_(v)},N)),n]})]})},Pv=o=>{const{page:e=null}=o,{currentOffer:n=null,roomPreviewer:r=null}=Be();return i.useEffect(()=>{r.updatePreviewObjectBoundingRectangle(new vr)},[r]),l(se,{children:[t(T,{size:7,overflow:"hidden",children:t(Av,{})}),l(T,{center:!n,size:5,overflow:"hidden",children:[!n&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),n&&l(V,{children:[t(P,{position:"relative",overflow:"hidden",children:t(Pr,{})}),l(T,{grow:!0,gap:1,children:[t(S,{grow:!0,truncate:!0,children:n.localizationName}),t(w,{justifyContent:"end",children:t(_r,{alignItems:"end"})}),t($n,{})]})]})]})]})},Dv=o=>{const{page:e=null}=o,[n,r]=i.useState(""),{currentOffer:s=null,setPurchaseOptions:a=null}=Be();return i.useEffect(()=>{s&&a(c=>{const u={...c};return u.extraData=n,u})},[s,n,a]),l(se,{children:[l(T,{size:7,overflow:"hidden",children:[t(da,{}),t("textarea",{className:"flex-grow-1 form-control w-100",defaultValue:n||"",onChange:c=>r(c.target.value)})]}),l(T,{center:!s,size:5,overflow:"hidden",children:[!s&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),s&&l(V,{children:[t(Pr,{}),l(T,{grow:!0,gap:1,children:[t(S,{grow:!0,truncate:!0,children:s.localizationName}),t(w,{justifyContent:"end",children:t(_r,{alignItems:"end"})}),t($n,{})]})]})]})]})},Mv=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(Ve.NONE),{currentPage:a=null,catalogOptions:c=null}=Be(),{purse:u=null,getCurrencyAmount:d=null}=es(),{clubOffers:h=null}=c,g=i.useCallback(N=>{switch(N.type){case yr.PURCHASE_SUCCESS:s(Ve.NONE);return;case vs.PURCHASE_FAILED:s(Ve.FAILED);return}},[]);lt(yr.PURCHASE_SUCCESS,g),lt(vs.PURCHASE_FAILED,g);const f=i.useCallback(N=>{let v="";return N.months>0&&(v=m("catalog.vip.item.header.months",["num_months"],[N.months.toString()])),N.extraDays>0&&(v!==""&&(v+=" "),v+=" "+m("catalog.vip.item.header.days",["num_days"],[N.extraDays.toString()])),v},[]),p=i.useCallback(()=>{if(!u)return"";const N=u.clubDays>0||u.clubPeriods>0?"extension.":"subscription.",v=e.months===0?"days":"months",O=e.months===0?e.extraDays:e.months;return m("catalog.vip.buy.confirm."+N+v).replace("%NUM_"+v.toUpperCase()+"%",O.toString())},[e,u]),C=i.useCallback(()=>{let N=m("catalog.vip.buy.confirm.end_date");return N=N.replace("%month%",e.month.toString()),N=N.replace("%day%",e.day.toString()),N=N.replace("%year%",e.year.toString()),N},[e]),E=i.useMemo(()=>{const N=u.clubDays,O=u.clubPeriods*31+N;return m("catalog.vip.extend.info",["days"],[O.toString()])},[u]),_=i.useCallback(()=>{e&&(s(Ve.PURCHASE),A(new co(a.pageId,e.offerId,null,1)))},[e,a]),I=i.useCallback(N=>{s(Ve.NONE),n(N)},[]),b=i.useCallback(()=>{if(!e)return null;if(e.priceCredits>d(-1))return t(D,{fullWidth:!0,variant:"danger",children:m("catalog.alert.notenough.title")});if(e.priceActivityPoints>d(e.priceActivityPointsType))return t(D,{fullWidth:!0,variant:"danger",children:m("catalog.alert.notenough.activitypoints.title."+e.priceActivityPointsType)});switch(r){case Ve.CONFIRM:return t(D,{fullWidth:!0,variant:"warning",onClick:_,children:m("catalog.marketplace.confirm_title")});case Ve.PURCHASE:return t(D,{fullWidth:!0,variant:"primary",disabled:!0,children:t(ll,{})});case Ve.FAILED:return t(D,{fullWidth:!0,variant:"danger",disabled:!0,children:m("generic.failed")});case Ve.NONE:default:return t(D,{fullWidth:!0,variant:"success",onClick:()=>s(Ve.CONFIRM),children:m("buy")})}},[e,r,_,d]);return i.useEffect(()=>{h||A(new BI(1))},[h]),l(se,{children:[l(T,{fullHeight:!0,size:7,overflow:"hidden",justifyContent:"between",children:[t(ke,{columnCount:1,className:"nitro-catalog-layout-vip-buy-grid",children:h&&h.length>0&&h.map((N,v)=>l(Ie,{column:!1,center:!1,alignItems:"center",justifyContent:"between",itemActive:e===N,className:"p-1",onClick:()=>I(N),children:[t("i",{className:"icon-hc-banner"}),l(T,{justifyContent:"end",gap:0,children:[t(S,{textEnd:!0,children:f(N)}),l(w,{justifyContent:"end",gap:1,children:[N.priceCredits>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:N.priceCredits}),t(at,{type:-1})]}),N.priceActivityPoints>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:N.priceActivityPoints}),t(at,{type:N.priceActivityPointsType})]})]})]})]},v))}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:m("catalog.vip.buy.hccenter")}})]}),l(T,{size:5,overflow:"hidden",children:[l(T,{fullHeight:!0,center:!0,overflow:"hidden",children:[a.localization.getImage(1)&&t("img",{alt:"",src:a.localization.getImage(1)}),t(S,{center:!0,overflow:"auto",dangerouslySetInnerHTML:{__html:E}})]}),e&&l(T,{fullWidth:!0,grow:!0,justifyContent:"end",children:[l(w,{alignItems:"end",children:[l(T,{grow:!0,gap:0,children:[t(S,{fontWeight:"bold",children:p()}),t(S,{children:C()})]}),l(T,{gap:1,children:[e.priceCredits>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:e.priceCredits}),t(at,{type:-1})]}),e.priceActivityPoints>0&&l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(S,{children:e.priceActivityPoints}),t(at,{type:e.priceActivityPointsType})]})]})]}),b()]})]})]})},Lv=o=>{const{text:e=null}=o,[n,r]=i.useState(""),[s,a]=i.useState(!1),{simpleAlert:c=null}=Je(),u=()=>{!n||!n.length||s||(A(new HI(n)),a(!0))};return F(GI,d=>{const h=d.getParser();let g=m("catalog.alert.voucherredeem.ok.description");h.productName&&(g=m("catalog.alert.voucherredeem.ok.description.furni",["productName","productDescription"],[h.productName,h.productDescription])),c(g,null,null,null,m("catalog.alert.voucherredeem.ok.title")),a(!1),r("")}),F(VI,d=>{const h=d.getParser();c(m(`catalog.alert.voucherredeem.error.description.${h.errorCode}`),null,null,null,m("catalog.alert.voucherredeem.error.title")),a(!1)}),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:e,value:n,onChange:d=>r(d.target.value)}),t(D,{variant:"primary",onClick:u,disabled:s,children:t(ag,{className:"fa-icon"})})]})},ka=o=>{const{item:e=null,position:n="relative",pointer:r=!0,overflow:s="hidden",fullHeight:a=!0,classNames:c=[],children:u=null,...d}=o,h=i.useMemo(()=>{const f=["rounded","nitro-front-page-item"];return c.length&&f.push(...c),f},[c]);if(!e)return null;const g=K("image.library.url")+e.itemPromoImage;return l(Yd,{imageUrl:g,classNames:h,position:n,fullHeight:a,pointer:r,overflow:s,...d,children:[t(S,{position:"absolute",variant:"white",className:"bg-dark rounded p-2 m-2 bottom-0",children:e.itemName}),u]})},Uv=o=>{const{page:e=null,hideNavigation:n=null}=o,{frontPageItems:r=[]}=Be(),s=i.useCallback(a=>{switch(a.type){case Ll.ITEM_CATALOGUE_PAGE:ee(`catalog/open/${a.catalogPageLocation}`);return;case Ll.ITEM_PRODUCT_OFFER:ee(`catalog/open/${a.productOfferId}`);return}},[]);return i.useEffect(()=>{n()},[e,n]),l(se,{children:[t(T,{size:4,children:r[0]&&t(ka,{item:r[0],onClick:a=>s(r[0])})}),l(T,{size:8,children:[r[1]&&t(ka,{item:r[1],onClick:a=>s(r[1])}),r[2]&&t(ka,{item:r[2],onClick:a=>s(r[2])}),r[3]&&t(ka,{item:r[3],onClick:a=>s(r[3])}),t(Lv,{text:e.localization.getText(1)})]})]})},Gi=1,qa=2,Dm=o=>{const{offerData:e=null,type:n=qa,onClick:r=null}=o,s=i.useMemo(()=>e?m((e.furniType===2?"wallItem":"roomItem")+`.name.${e.furniId}`):"",[e]),a=i.useCallback(()=>{if(!e)return"";if(e.status===$r.SOLD)return m("catalog.marketplace.offer.sold");if(e.timeLeftMinutes<=0)return m("catalog.marketplace.offer.expired");const c=Math.max(1,e.timeLeftMinutes),u=Math.floor(c/60);let h=c-u*60+" "+m("catalog.marketplace.offer.minutes");return u>0&&(h=u+" "+m("catalog.marketplace.offer.hours")+" "+h),m("catalog.marketplace.offer.time_left",["time"],[h])},[e]);return l(Ie,{shrink:!0,center:!1,column:!1,alignItems:"center",className:"p-1",children:[t(T,{style:{width:40,height:40},children:t(Ie,{column:!1,itemImage:ob(e.furniType===na.TYPE_FLOOR?de.FLOOR:de.WALL,e.furniId,e.extraData),itemUniqueNumber:e.isUniqueLimitedItem?e.stuffData.uniqueNumber:0})}),l(T,{grow:!0,gap:0,children:[t(S,{fontWeight:"bold",children:s}),n===Gi&&l(V,{children:[t(S,{children:m("catalog.marketplace.offer.price_own_item",["price"],[e.price.toString()])}),t(S,{children:a()})]}),n===qa&&l(V,{children:[t(S,{children:m("catalog.marketplace.offer.price_public_item",["price","average"],[e.price.toString(),e.averagePrice>0?e.averagePrice.toString():"-"])}),t(S,{children:m("catalog.marketplace.offer_count",["count"],[e.offerCount.toString()])})]})]}),l(T,{gap:1,children:[n===Gi&&e.status!==$r.SOLD&&t(D,{variant:"secondary",onClick:()=>r(e),children:m("catalog.marketplace.offer.pick")}),n===qa&&l(V,{children:[t(D,{variant:"secondary",onClick:()=>r(e),children:m("buy")}),t(D,{variant:"secondary",disabled:!0,children:m("catalog.marketplace.view_more")})]})]})]})},xv=o=>{const[e,n]=i.useState(0),[r,s]=i.useState([]),{simpleAlert:a=null}=Je();F(WI,h=>{const g=h.getParser();if(!g)return;const f=g.offers.map(p=>{const C=new na(p.offerId,p.furniId,p.furniType,p.extraData,p.stuffData,p.price,p.status,p.averagePrice,p.offerCount);return C.timeLeftMinutes=p.timeLeftMinutes,C});n(g.creditsWaiting),s(f)}),F(jI,h=>{const g=h.getParser();if(g){if(!g.success){a(m("catalog.marketplace.cancel_failed"),ue.DEFAULT,null,null,m("catalog.marketplace.operation_failed.topic"));return}s(f=>f.filter(p=>p.offerId!==g.offerId))}});const c=i.useMemo(()=>r.filter(h=>h.status===$r.SOLD),[r]),u=i.useCallback(()=>{s(h=>{const g=c.map(f=>f.offerId);return h.filter(f=>g.indexOf(f.offerId)===-1)}),A(new qI)},[c]),d=h=>{A(new YI(h.offerId))};return i.useEffect(()=>{A(new zI)},[]),l(T,{overflow:"hidden",children:[e<=0&&t(S,{center:!0,className:"bg-muted rounded p-1",children:m("catalog.marketplace.redeem.no_sold_items")}),e>0&&l(T,{center:!0,gap:1,className:"bg-muted rounded p-2",children:[t(S,{children:m("catalog.marketplace.redeem.get_credits",["count","credits"],[c.length.toString(),e.toString()])}),t(D,{className:"mt-1",onClick:u,children:m("catalog.marketplace.offer.redeem")})]}),l(T,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:m("catalog.marketplace.items_found",["count"],[r.length.toString()])}),t(T,{overflow:"auto",className:"nitro-catalog-layout-marketplace-grid",children:r.length>0&&r.map(h=>t(Dm,{offerData:h,type:Gi,onClick:d},h.offerId))})]})]})},Fv=o=>{const{searchType:e=null,sortTypes:n=null,onSearch:r=null}=o,[s,a]=i.useState(n?n[0]:3),[c,u]=i.useState(""),[d,h]=i.useState(0),[g,f]=i.useState(0),p=i.useCallback(E=>{a(E),(e===Lt.BY_ACTIVITY||e===Lt.BY_VALUE)&&r({minPrice:-1,maxPrice:-1,query:"",type:E})},[r,e]),C=i.useCallback(()=>{const E=d>0?d:-1,_=g>0?g:-1;r({minPrice:E,maxPrice:_,type:s,query:c})},[g,d,r,c,s]);return i.useEffect(()=>{if(!n||!n.length)return;const E=n[0];a(E),(e===Lt.BY_ACTIVITY||Lt.BY_VALUE===e)&&r({minPrice:-1,maxPrice:-1,query:"",type:E})},[r,e,n]),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("catalog.marketplace.sort_order")}),t("select",{className:"form-select form-select-sm",value:s,onChange:E=>p(parseInt(E.target.value)),children:n.map(E=>t("option",{value:E,children:m(`catalog.marketplace.sort.${E}`)},E))})]}),e===Lt.ADVANCED&&l(V,{children:[l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("catalog.marketplace.search_name")}),t("input",{className:"form-control form-control-sm",type:"text",value:c,onChange:E=>u(E.target.value)})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("catalog.marketplace.search_price")}),l(w,{fullWidth:!0,gap:1,children:[t("input",{className:"form-control form-control-sm",type:"number",min:0,value:d,onChange:E=>h(E.target.valueAsNumber)}),t("input",{className:"form-control form-control-sm",type:"number",min:0,value:g,onChange:E=>f(E.target.valueAsNumber)})]})]}),t(D,{variant:"secondary",className:"mx-auto",onClick:C,children:m("generic.search")})]})]})},Bv=[1,2],Gv=[3,4,5,6],Vv=[1,2,3,4,5,6],Hv=o=>{const[e,n]=i.useState(Lt.BY_ACTIVITY),[r,s]=i.useState(0),[a,c]=i.useState(new Map),[u,d]=i.useState({minPrice:-1,maxPrice:-1,query:"",type:3}),{getCurrencyAmount:h=null}=es(),{simpleAlert:g=null,showConfirm:f=null}=Je(),p=i.useCallback(_=>{d(_),A(new $I(_.minPrice,_.maxPrice,_.query,_.type))},[]),C=i.useMemo(()=>{switch(e){case Lt.BY_ACTIVITY:return Gv;case Lt.BY_VALUE:return Bv;case Lt.ADVANCED:return Vv}return[]},[e]),E=i.useCallback(_=>{if(_.price>h(-1)){g(m("catalog.alert.notenough.credits.description"),ue.DEFAULT,null,null,m("catalog.alert.notenough.title"));return}const I=_.offerId;f(m("catalog.marketplace.confirm_header"),()=>{A(new Ul(I))},null,null,null,m("catalog.marketplace.confirm_title"))},[h,g,f]);return F(KI,_=>{const I=_.getParser();if(!I)return;const b=new Map;I.offers.forEach(N=>{const v=new na(N.offerId,N.furniId,N.furniType,N.extraData,N.stuffData,N.price,N.status,N.averagePrice,N.offerCount);v.timeLeftMinutes=N.timeLeftMinutes,b.set(N.offerId,v)}),s(I.totalItemsFound),c(b)}),F(XI,_=>{const I=_.getParser();if(I)switch(I.result){case 1:p(u);break;case 2:c(b=>{const N=new Map(b);return N.delete(I.requestedOfferId),N}),g(m("catalog.marketplace.not_available_header"),ue.DEFAULT,null,null,m("catalog.marketplace.not_available_title"));break;case 3:c(b=>{const N=new Map(b),v=N.get(I.requestedOfferId);return v&&(v.offerId=I.offerId,v.price=I.newPrice,v.offerCount--,N.set(v.offerId,v)),N.delete(I.requestedOfferId),N}),f(m("catalog.marketplace.confirm_higher_header")+`
`+m("catalog.marketplace.confirm_price",["price"],[I.newPrice.toString()]),()=>{A(new Ul(I.offerId))},null,null,null,m("catalog.marketplace.confirm_higher_title"));break;case 4:g(m("catalog.alert.notenough.credits.description"),ue.DEFAULT,null,null,m("catalog.alert.notenough.title"));break}}),l(V,{children:[l(nr,{children:[t(D,{active:e===Lt.BY_ACTIVITY,onClick:()=>n(Lt.BY_ACTIVITY),children:m("catalog.marketplace.search_by_activity")}),t(D,{active:e===Lt.BY_VALUE,onClick:()=>n(Lt.BY_VALUE),children:m("catalog.marketplace.search_by_value")}),t(D,{active:e===Lt.ADVANCED,onClick:()=>n(Lt.ADVANCED),children:m("catalog.marketplace.search_advanced")})]}),t(Fv,{sortTypes:C,searchType:e,onSearch:p}),l(T,{gap:1,overflow:"hidden",children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:m("catalog.marketplace.items_found",["count"],[a.size.toString()])}),t(T,{className:"nitro-catalog-layout-marketplace-grid",overflow:"auto",children:Array.from(a.values()).map((_,I)=>t(Dm,{offerData:_,type:qa,onClick:E},I))})]})]})},Wv=o=>{const{page:e=null}=o,[n,r]=i.useState(-1),[s,a]=i.useState([]),[c,u]=i.useState(-1),[d,h]=i.useState([]),[g,f]=i.useState(-1),[p,C]=i.useState(!1),[E,_]=i.useState("");i.useState(!0);const[I,b]=i.useState(-1),{currentOffer:N=null,setCurrentOffer:v=null,setPurchaseOptions:O=null,catalogOptions:R=null,roomPreviewer:y=null}=Be(),{petPalettes:G=null}=R,k=i.useMemo(()=>!d.length||g===-1?16777215:d[g][0],[d,g]),B=i.useMemo(()=>n===-1||!s.length||c===-1?"":m(`pet.breed.${n}.${s[c].breedId}`),[n,s,c]),M=i.useMemo(()=>{if(!s.length||c===-1)return"";const L=s[c].paletteId;let x=16777215;if(n<=7){if(g===-1)return"";x=d[g][0]}let j=x.toString(16).toUpperCase();for(;j.length<6;)j="0"+j;return`${L}
${j}`},[s,c,n,d,g]),U=i.useMemo(()=>{let L="";switch(I){case 1:L="catalog.alert.petname.long";break;case 2:L="catalog.alert.petname.short";break;case 3:L="catalog.alert.petname.chars";break;case 4:L="catalog.alert.petname.bobba";break}return!L||!L.length?"":m(L)},[I]),W=i.useCallback(()=>{if(I===-1){A(new QI(E,1));return}if(I===0){A(new co(e.pageId,N.offerId,`${E}
${M}`,1));return}},[e,N,E,M,I]);return F(JI,L=>{const x=L.getParser();b(x.result),x.result===0?W():St(new vs(-1))}),i.useEffect(()=>{if(!e||!e.offers.length)return;const L=e.offers[0];v(L),r(rb(L.localizationId)),C(!1)},[e,v]),i.useEffect(()=>{if(!N)return;const L=N.product.productData;if(L){if(G)for(const x of G){if(x.breed!==L.type)continue;const j=[];for(const H of x.palettes)H.sellable&&j.push(H);u(j.length?0:-1),a(j);return}u(-1),a([]),A(new ZI(L.type))}},[N,G]),i.useEffect(()=>{if(n===-1)return;const L=sb(n,s);f(L.length?0:-1),h(L)},[n,s]),i.useEffect(()=>{if(!y||(y.reset(!1),n===-1||!s.length||c===-1))return;let L=`${n} ${s[c].paletteId}`;n<=7&&(L+=` ${k.toString(16)}`),y.addPetIntoRoom(L)},[y,n,s,c,k]),i.useEffect(()=>{b(-1)},[E]),N?l(se,{children:[t(T,{size:7,overflow:"hidden",children:l(ke,{columnCount:5,children:[!p&&s.length>0&&s.map((L,x)=>t(Ie,{itemActive:c===x,onClick:j=>u(x),children:t(tr,{typeId:n,paletteId:L.paletteId,direction:2,headOnly:!0})},x)),p&&d.length>0&&d.map((L,x)=>t(Ie,{itemHighlight:!0,itemActive:g===x,itemColor:cn.int2rgb(L[0]),className:"clear-bg",onClick:j=>f(x)},x))]})}),l(T,{center:!N,size:5,overflow:"hidden",children:[!N&&l(V,{children:[!!e.localization.getImage(1)&&t("img",{alt:"",src:e.localization.getImage(1)}),t(S,{center:!0,dangerouslySetInnerHTML:{__html:e.localization.getText(0)}})]}),N&&l(V,{children:[l(P,{position:"relative",overflow:"hidden",children:[t(Pr,{}),t(Or,{position:"absolute",className:"bg-muted rounded bottom-1 end-1"}),n>-1&&n<=7&&t(D,{position:"absolute",className:"bottom-1 start-1",onClick:L=>C(!p),children:t(Su,{className:"fa-icon"})})]}),l(T,{grow:!0,gap:1,children:[t(S,{truncate:!0,children:B}),l(T,{grow:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:m("widgets.petpackage.name.title"),value:E,onChange:L=>_(L.target.value)}),I>0&&t(P,{className:"invalid-feedback d-block m-0",children:U})]}),t(w,{justifyContent:"end",children:t(_r,{justifyContent:"end",alignItems:"end"})}),t($n,{purchaseCallback:W})]})]})]})]}):null},jv=o=>{const{offer:e=null,isAvailable:n=!1,daysRequired:r=0,onSelect:s=null}=o,a=i.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0];return ja.getProductImageUrl(u.productType,u.furniClassId,u.extraParam)},[e]),c=i.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0],d=ja.getProductCategory(u.productType,u.furniClassId)===2?"wallItem.name."+u.furniClassId:"roomItem.name."+u.furniClassId;return m(d)},[e]);return i.useCallback(()=>{if(!e||!e.products.length)return"";const u=e.products[0],d=ja.getProductCategory(u.productType,u.furniClassId)===2?"wallItem.desc."+u.furniClassId:"roomItem.desc."+u.furniClassId;return m(d)},[e]),i.useCallback(()=>Math.floor(r/31),[r]),l(Ie,{center:!1,column:!1,alignItems:"center",className:"p-1",children:[t(ir,{imageUrl:a()}),t(S,{grow:!0,fontWeight:"bold",children:c()}),t(D,{variant:"secondary",onClick:()=>s(e.localizationId),disabled:!n,children:m("catalog.club_gift.select")})]})},qv=o=>{const{purse:e=null}=es(),{catalogOptions:n=null,setCatalogOptions:r=null}=Be(),{clubGifts:s=null}=n,{showConfirm:a=null}=Je(),c=i.useCallback(()=>s?s.giftsAvailable>0?m("catalog.club_gift.available",["amount"],[s.giftsAvailable.toString()]):s.daysUntilNextGift>0?m("catalog.club_gift.days_until_next",["days"],[s.daysUntilNextGift.toString()]):e.isVip?m("catalog.club_gift.not_available"):m("catalog.club_gift.no_club"):"",[s,e]),u=i.useCallback(h=>{a(m("catalog.club_gift.confirm"),()=>{A(new eE(h)),r(g=>(g.clubGifts.giftsAvailable--,{...g}))},null)},[r,a]),d=i.useMemo(()=>s.offers.sort((g,f)=>s.getOfferExtraData(g.offerId).daysRequired-s.getOfferExtraData(f.offerId).daysRequired),[s]);return l(V,{children:[t(S,{truncate:!0,shrink:!0,fontWeight:"bold",children:c()}),t(ke,{columnCount:1,className:"nitro-catalog-layout-vip-gifts-grid",children:s.offers.length>0&&d.map(h=>t(jv,{offer:h,isAvailable:s.getOfferExtraData(h.offerId).isSelectable&&s.giftsAvailable>0,onSelect:u,daysRequired:s.getOfferExtraData(h.offerId).daysRequired},h.offerId))})]})},zv=(o,e)=>{if(!o)return null;const n={page:o,hideNavigation:e};switch(o.layoutCode){case"frontpage_featured":return null;case"frontpage4":return t(Uv,{...n});case"pets":return t(Wv,{...n});case"pets2":return t(vv,{...n});case"pets3":return t(km,{...n});case"vip_buy":return t(Mv,{...n});case"guild_frontpage":return t(Nv,{...n});case"guild_forum":return t(Sv,{...n});case"guild_custom_furni":return t(bv,{...n});case"club_gifts":return t(qv,{...n});case"marketplace_own_items":return t(xv,{...n});case"marketplace":return t(Hv,{...n});case"single_bundle":return t(yv,{...n});case"room_bundle":return t(Rv,{...n});case"spaces_new":return t(Pv,{...n});case"trophies":return t(Dv,{...n});case"info_loyalty":return t(Tv,{...n});case"badge_display":return t(fv,{...n});case"roomads":return t(wv,{...n});case"default_3x3_color_grouping":return t(Ev,{...n});case"soundmachine":return t(Ov,{...n});case"bots":case"default_3x3":default:return t(Cv,{...n})}},Yv=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(0),[a,c]=i.useState("0"),{catalogOptions:u=null,setCatalogOptions:d=null}=Be(),{marketplaceConfiguration:h=null}=u,{showConfirm:g=null}=Je(),f=I=>{c(I);const b=parseInt(I);isNaN(b)||b===r||s(parseInt(I))};if(F(tE,I=>{const b=I.getParser();d(N=>{const v={...N};return v.marketplaceConfiguration=b,v})}),lt(em.POST_MARKETPLACE,I=>n(I.item)),i.useEffect(()=>{!e||h||A(new nE)},[e,h]),i.useEffect(()=>{if(e)return()=>s(0)},[e]),!h||!e)return null;const p=e?m(e.isWallItem?"wallItem.name."+e.type:"roomItem.name."+e.type):"",C=e?m(e.isWallItem?"wallItem.desc."+e.type:"roomItem.desc."+e.type):"",E=()=>Math.max(Math.ceil(h.commission*.01*r),1),_=()=>{!e||r<h.minimumPrice||g(m("inventory.marketplace.confirm_offer.info",["furniname","price"],[p,r.toString()]),()=>{A(new rE(r,e.isWallItem?2:1,e.id)),n(null)},()=>{n(null)},null,null,m("inventory.marketplace.confirm_offer.title"))};return l(oe,{className:"nitro-catalog-layout-marketplace-post-offer",theme:"primary-slim",children:[t(ie,{headerText:m("inventory.marketplace.make_offer.title"),onCloseClick:I=>n(null)}),t(re,{overflow:"hidden",children:l(se,{fullHeight:!0,children:[t(T,{center:!0,className:"bg-muted rounded p-2",size:4,overflow:"hidden",children:t(il,{productType:e.isWallItem?de.WALL:de.FLOOR,productClassId:e.type,extraData:e.extra.toString()})}),l(T,{size:8,justifyContent:"between",overflow:"hidden",children:[l(T,{grow:!0,gap:1,children:[t(S,{fontWeight:"bold",children:p}),t(S,{truncate:!0,shrink:!0,children:C})]}),l(T,{overflow:"auto",children:[t(S,{italics:!0,children:m("inventory.marketplace.make_offer.expiration_info",["time"],[h.offerTime.toString()])}),l("div",{className:"input-group has-validation",children:[t("input",{className:"form-control form-control-sm",type:"number",min:0,value:a,onChange:I=>f(I.target.value),placeholder:m("inventory.marketplace.make_offer.price_request")}),(r<h.minimumPrice||isNaN(r))&&t(P,{className:"invalid-feedback d-block",children:m("inventory.marketplace.make_offer.min_price",["minprice"],[h.minimumPrice.toString()])}),r>h.maximumPrice&&!isNaN(r)&&t(P,{className:"invalid-feedback d-block",children:m("inventory.marketplace.make_offer.max_price",["maxprice"],[h.maximumPrice.toString()])}),!(r<h.minimumPrice||r>h.maximumPrice||isNaN(r))&&t(P,{className:"invalid-feedback d-block",children:m("inventory.marketplace.make_offer.final_price",["commission","finalprice"],[E().toString(),(r+E()).toString()])})]}),t(D,{disabled:r<h.minimumPrice||r>h.maximumPrice||isNaN(r),onClick:_,children:m("inventory.marketplace.make_offer.post")})]})]})]})})]})},$v=o=>{const{isVisible:e=!1,setIsVisible:n=null,rootNode:r=null,currentPage:s=null,navigationHidden:a=!1,setNavigationHidden:c=null,activeNodes:u=[],searchResult:d=null,setSearchResult:h=null,openPageByName:g=null,openPageByOfferId:f=null,activateNode:p=null,getNodeById:C}=Be();return i.useEffect(()=>{const E={linkReceived:_=>{const I=_.split("/");if(!(I.length<2))switch(I[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(b=>!b);return;case"open":if(I.length>2)if(I.length===4)switch(I[2]){case"offerId":f(parseInt(I[3]));return}else g(I[2]);else n(!0);return}},eventUrlPrefix:"catalog/"};return ut(E),()=>dt(E)},[n,f,g]),l(V,{children:[e&&l(oe,{uniqueKey:"catalog",className:"nitro-catalog",style:K("catalog.headers")?{width:710}:{},children:[t(ie,{headerText:m("catalog.title"),onCloseClick:E=>n(!1)}),t(lr,{children:r&&r.children.length>0&&r.children.map(E=>E.isVisible?t(Mn,{isActive:E.isActive,onClick:_=>{d&&h(null),p(E)},children:l(w,{gap:K("catalog.tab.icons")?1:0,alignItems:"center",children:[K("catalog.tab.icons")&&t(Tm,{icon:E.iconId}),E.localization]})},E.pageId):null)}),t(re,{children:l(se,{children:[!a&&t(T,{size:3,overflow:"hidden",children:u&&u.length>0&&t(gv,{node:u[0]})}),t(T,{size:a?12:9,overflow:"hidden",children:zv(s,()=>c(!0))})]})})]}),t(dv,{}),t(Yv,{})]})},Kv=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(""),{chatHistory:a=[]}=No(),c=i.useRef(null),u=i.useMemo(()=>{if(r.length===0)return a;let d=r.toLowerCase();return a.filter(h=>h.message&&h.message.toLowerCase().includes(d)||h.name&&h.name.toLowerCase().includes(d))},[a,r]);return i.useEffect(()=>{c&&c.current&&e&&(c.current.scrollTop=c.current.scrollHeight)},[e]),i.useEffect(()=>{const d={linkReceived:h=>{const g=h.split("/");if(!(g.length<2))switch(g[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(f=>!f);return}},eventUrlPrefix:"chat-history/"};return ut(d),()=>dt(d)},[]),e?l(oe,{uniqueKey:"chat-history",className:"nitro-chat-history",theme:"primary-slim",children:[t(ie,{headerText:m("room.chathistory.button.text"),onCloseClick:d=>n(!1)}),l(re,{innerRef:c,overflow:"hidden",gap:2,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:m("generic.search"),value:r,onChange:d=>s(d.target.value)}),t(_o,{rows:u,scrollToBottom:!0,rowRender:d=>l(w,{alignItems:"center",className:"p-1",gap:2,children:[t(S,{variant:"muted",children:d.timestamp}),d.type===Dn.TYPE_CHAT&&l("div",{className:"bubble-container",style:{position:"relative"},children:[d.style===0&&t("div",{className:"user-container-bg",style:{backgroundColor:d.color}}),l("div",{className:`chat-bubble bubble-${d.style} type-${d.chatType}`,style:{maxWidth:"100%"},children:[t("div",{className:"user-container",children:d.imageUrl&&d.imageUrl.length>0&&t("div",{className:"user-image",style:{backgroundImage:`url(${d.imageUrl})`}})}),l("div",{className:"chat-content",children:[t("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${d.name}: `}}),t("span",{className:"message",dangerouslySetInnerHTML:{__html:`${d.message}`}})]})]})]}),d.type===Dn.TYPE_ROOM_INFO&&l(V,{children:[t("i",{className:"icon icon-small-room"}),t(S,{textBreak:!0,wrap:!0,grow:!0,children:d.name})]})]})})]})]}):null},Pn=32,Gr=64,Gs="x0123456789abcdefghijklmnopq";class Ct{}Ct.DOOR=0;Ct.UP=1;Ct.DOWN=2;Ct.SET=3;Ct.UNSET=4;const Xv={x:"101010",0:"0065ff",1:"0091ff",2:"00bcff",3:"00e8ff",4:"00ffea",5:"00ffbf",6:"00ff93",7:"00ff68",8:"00ff3d",9:"19ff00",a:"44ff00",b:"70ff00",c:"9bff00",d:"f2ff00",e:"ffe000",f:"ffb500",g:"ff8900",h:"ff5e00",i:"ff3200",j:"ff0700",k:"ff0023",l:"ff007a",m:"ff00a5",n:"ff00d1",o:"ff00fc",p:"d600ff",q:"aa00ff"};class Qv{constructor(){this._currentAction=Ct.SET,this._currentHeight=Gs[1]}get currentAction(){return this._currentAction}set currentAction(e){this._currentAction=e}get currentHeight(){return this._currentHeight}set currentHeight(e){this._currentHeight=e}clear(){this._currentAction=Ct.SET,this._currentHeight=Gs[1]}}class Aa{constructor(e,n){this._height=e,this._isBlocked=n}get height(){return this._height}set height(e){this._height=e}get isBlocked(){return this._isBlocked}set isBlocked(e){this._isBlocked=e}}const Jv=(o,e)=>{let n=o*Pn/2-e*Pn/2;const r=o*Pn/4+e*Pn/4;return n=n+1024,[n,r]},Zv=(o,e)=>{const n=o-1024,r=(n/(Pn/2)+e/(Pn/4))/2,s=(e/(Pn/4)-n/(Pn/2))/2;return[r,s]},ao=o=>{switch(o=parseInt(o.toString()),o){case 0:return-2;case 1:return-1;case 3:return 1;default:return 0}},Pa=o=>{switch(o){case .25:return 0;case .5:return 1;case 2:return 3;default:return 2}},Oo=class Hr extends sE{constructor(){const e=Pn*Gr+20,n=Pn*Gr/2+100;super({width:e,height:n,backgroundColor:0,antialias:!0,autoDensity:!0,resolution:1,sharedLoader:!0,sharedTicker:!0}),this._tilemap=[],this._doorLocation=new vr(0,0),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile=new vr(-1,-1),this._actionSettings=new Qv}initialize(){if(this._isInitialized)return;const e=Xu().getCollection("floor_editor");e&&(this._assetCollection=e,this._tilemapRenderer=new aE(e.baseTexture),this.registerEventListeners(),this.stage.addChild(this._tilemapRenderer),this._isInitialized=!0)}registerEventListeners(){const e=new vr;this._tilemapRenderer.containsPoint=n=>(this._tilemapRenderer.worldTransform.applyInverse(n,e),this.tileHitDetection(e,!1)),this._tilemapRenderer.on("pointerup",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerout",()=>{this._isHolding=!1}),this._tilemapRenderer.on("pointerdown",n=>{if(!(n.data.originalEvent instanceof PointerEvent)&&!(n.data.originalEvent instanceof TouchEvent))return;const r=n.data.originalEvent;if(r instanceof MouseEvent&&r.button===2)return;const s=n.data.global;this.tileHitDetection(s,!0)}),this._tilemapRenderer.on("click",n=>{if(!(n.data.originalEvent instanceof PointerEvent)||n.data.originalEvent.button===2)return;const s=n.data.global;this.tileHitDetection(s,!0,!0)})}tileHitDetection(e,n,r=!1){const s=this._tilemapRenderer.pointsBuf,a=oE,c=s.length;n&&(this._isHolding=!0);for(let u=0;u<c;u+=a){const d=u+a,h=s.slice(u,d),g=Pn,f=Pn/2,p=Math.floor(e.x),C=Math.floor(e.y),E=h[2],_=h[3],I=E+g/2,b=_+f/2,N=Math.abs(p-I),v=Math.abs(C-b);if(N/(g*.5)+v/(f*.5)<=1){if(this._isHolding){const[R,y]=Zv(E,_);r?this.onClick(R,y):(this._lastUsedTile.x!==R||this._lastUsedTile.y!==y)&&(this._lastUsedTile.x=R,this._lastUsedTile.y=y,this.onClick(R,y))}return!0}}return!1}onClick(e,n){const r=this._tilemap[n][e],s=Gs.indexOf(r.height);let a=0;switch(this._actionSettings.currentAction){case Ct.DOOR:r.height!=="x"&&(this._doorLocation.x=e,this._doorLocation.y=n,this.renderTiles());return;case Ct.UP:if(r.height==="x")return;a=s+1;break;case Ct.DOWN:if(r.height==="x"||s<=1)return;a=s-1;break;case Ct.SET:a=Gs.indexOf(this._actionSettings.currentHeight);break;case Ct.UNSET:a=0;break}if(a===-1||s===a)return;a>0&&(e+1>this._width&&(this._width=e+1),n+1>this._height&&(this._height=n+1));const c=Gs[a];c&&(r.isBlocked||(this._tilemap[n][e].height=c,this.renderTiles()))}renderTiles(){this.tilemapRenderer.clear();for(let e=0;e<this._tilemap.length;e++)for(let n=0;n<this.tilemap[e].length;n++){const r=this.tilemap[e][n];let s=r.height;this._doorLocation.x===n&&this._doorLocation.y===e&&(s=Hr.TILE_DOOR),r.isBlocked&&(s=Hr.TILE_BLOCKED);const[a,c]=Jv(n,e);this._tilemapRenderer.tile(this._assetCollection.getTexture(`floor_editor_${s}`),a,c)}}setTilemap(e,n){this._tilemap=[];const r=e.split("\r");let s=0,a=r.length;for(let c=0;c<a;c++){const u=r[c];if(u.length===0){r.splice(c,1),a=r.length,c--;continue}u.length>s&&(s=u.length)}for(let c=0;c<a;c++){this._tilemap[c]=[];const u=r[c];for(let d=0;d<s;d++){const h=n[c]&&n[c][d]||!1,g=u[d];g!=="x"&&g!=="X"&&g?this._tilemap[c][d]=new Aa(g,h):this._tilemap[c][d]=new Aa("x",h)}for(let d=s;d<Gr;d++)this.tilemap[c][d]=new Aa("x",!1)}for(let c=a;c<Gr;c++){this.tilemap[c]||(this.tilemap[c]=[]);for(let u=0;u<Gr;u++)this.tilemap[c][u]=new Aa("x",!1)}this._width=s,this._height=a}getCurrentTilemapString(){if(this._tilemap[this._height-1][this._width-1].height==="x"){this._width=-1,this._height=-1;for(let r=Gr-1;r>=0;r--)if(this._tilemap[r])for(let s=Gr-1;s>=0;s--){if(!this._tilemap[r][s])continue;this._tilemap[r][s].height!=="x"&&(s+1>this._width&&(this._width=s+1),r+1>this._height&&(this._height=r+1))}}const n=[];for(let r=0;r<this._height;r++){const s=[];for(let a=0;a<this._width;a++){const c=this._tilemap[r][a];s[a]=c.height}n[r]=s.join("")}return n.join("\r")}clear(){this._tilemapRenderer.interactive=!1,this._tilemap=[],this._doorLocation.set(-1,-1),this._width=0,this._height=0,this._isHolding=!1,this._lastUsedTile.set(-1,-1),this._actionSettings.clear(),this._tilemapRenderer.clear()}get tilemapRenderer(){return this._tilemapRenderer}get tilemap(){return this._tilemap}get doorLocation(){return this._doorLocation}set doorLocation(e){this._doorLocation=e}get actionSettings(){return this._actionSettings}static get instance(){return Hr._INSTANCE||(Hr._INSTANCE=new Hr),Hr._INSTANCE}};Oo._INSTANCE=null;Oo.TILE_BLOCKED="r_blocked";Oo.TILE_DOOR="r_door";let Yt=Oo;const Mm=i.createContext({originalFloorplanSettings:null,setOriginalFloorplanSettings:null,visualizationSettings:null,setVisualizationSettings:null}),ew=o=>t(Mm.Provider,{...o}),pl=()=>i.useContext(Mm),tw=o=>{const{gap:e=1,children:n=null,...r}=o,[s,a]=i.useState(!1),[c,u]=i.useState(!1),{originalFloorplanSettings:d=null,setOriginalFloorplanSettings:h=null,setVisualizationSettings:g=null}=pl(),f=i.useRef(null);F(iE,C=>{const E=C.getParser();h(_=>{const I={..._};return I.reservedTiles=E.blockedTilesMap,Yt.instance.setTilemap(I.tilemap,I.reservedTiles),I}),a(!0),f.current.scrollTo(Yt.instance.view.width/3,0)}),F(lE,C=>{const E=C.getParser();h(_=>{const I={..._};return I.entryPoint=[E.x,E.y],I.entryPointDir=E.direction,I}),g(_=>{const I={..._};return I.entryPointDir=E.direction,I}),Yt.instance.doorLocation=new vr(E.x,E.y),u(!0)});const p=C=>{const E=f.current;if(E)switch(C){case"up":E.scrollBy({top:-10});break;case"down":E.scrollBy({top:10});break;case"left":E.scrollBy({left:-10});break;case"right":E.scrollBy({left:10});break}};return i.useEffect(()=>()=>{Yt.instance.clear(),g(C=>({wallHeight:d.wallHeight,thicknessWall:d.thicknessWall,thicknessFloor:d.thicknessFloor,entryPointDir:C.entryPointDir}))},[d.thicknessFloor,d.thicknessWall,d.wallHeight,g]),i.useEffect(()=>{!c||!s||Yt.instance.renderTiles()},[c,s]),i.useEffect(()=>{A(new cE),A(new uE),Yt.instance.tilemapRenderer.interactive=!0,f.current&&f.current.appendChild(Yt.instance.renderer.view)},[]),l(T,{gap:e,...r,children:[l(se,{overflow:"hidden",gap:1,children:[t(T,{center:!0,size:1,children:t(D,{className:"d-md-none",onClick:C=>p("left"),children:t(Nu,{className:"fa-icon"})})}),l(T,{overflow:"hidden",size:10,gap:1,children:[t(w,{justifyContent:"center",className:"d-md-none",children:t(D,{shrink:!0,onClick:C=>p("up"),children:t(og,{className:"fa-icon"})})}),t(P,{overflow:"auto",innerRef:f}),t(w,{justifyContent:"center",className:"d-md-none",children:t(D,{shrink:!0,onClick:C=>p("down"),children:t(ig,{className:"fa-icon"})})})]}),t(T,{center:!0,size:1,children:t(D,{className:"d-md-none",onClick:C=>p("right"),children:t(Tu,{className:"fa-icon"})})})]}),n]})},vc=o=>o.replace(/\r\n|\r|\n/g,`
`).toLowerCase(),nw=o=>{const{onCloseClick:e=null}=o,[n,r]=i.useState(""),{originalFloorplanSettings:s=null}=pl(),a=()=>{A(new Qu(n.split(`
`).join("\r"),s.entryPoint[0],s.entryPoint[1],s.entryPointDir,ao(s.thicknessWall),ao(s.thicknessFloor),s.wallHeight-1))};return Sm(()=>{r(vc(s.tilemap))}),l(oe,{theme:"primary-slim",className:"floorplan-import-export",children:[t(ie,{headerText:m("floor.plan.editor.import.export"),onCloseClick:e}),l(re,{children:[t("textarea",{className:"h-100",value:n,onChange:c=>r(c.target.value)}),l(w,{justifyContent:"between",children:[t(D,{onClick:c=>r(vc(s.tilemap)),children:m("floor.plan.editor.revert.to.last.received.map")}),t(D,{onClick:a,children:m("floor.plan.editor.save")})]})]})]})},wc=0,Da=16,rw=0,sw=26,aw=o=>{const{visualizationSettings:e=null,setVisualizationSettings:n=null}=pl(),[r,s]=i.useState(Ct.SET),[a,c]=i.useState(0),u=_=>{s(_),Yt.instance.actionSettings.currentAction=_},d=()=>{n(_=>{const I={..._};return I.entryPointDir<7?++I.entryPointDir:I.entryPointDir=0,I})},h=_=>{(isNaN(_)||_<=0)&&(_=0),_>26&&(_=26),c(_),Yt.instance.actionSettings.currentHeight=_.toString(36)},g=_=>{n(I=>{const b={...I};return b.thicknessFloor=_,b})},f=_=>{n(I=>{const b={...I};return b.thicknessWall=_,b})},p=_=>{(isNaN(_)||_<=0)&&(_=wc),_>Da&&(_=Da),n(I=>{const b={...I};return b.wallHeight=_,b})},C=()=>{let _=e.wallHeight+1;_>Da&&(_=Da),p(_)},E=()=>{let _=e.wallHeight-1;_<=0&&(_=wc),p(_)};return l(T,{children:[l(w,{gap:1,children:[l(T,{size:5,gap:1,children:[t(S,{bold:!0,children:m("floor.plan.editor.draw.mode")}),l(w,{gap:3,children:[l(w,{gap:1,children:[t(Ie,{itemActive:r===Ct.SET,onClick:_=>u(Ct.SET),children:t("i",{className:"icon icon-set-tile"})}),t(Ie,{itemActive:r===Ct.UNSET,onClick:_=>u(Ct.UNSET),children:t("i",{className:"icon icon-unset-tile"})})]}),l(w,{gap:1,children:[t(Ie,{itemActive:r===Ct.UP,onClick:_=>u(Ct.UP),children:t("i",{className:"icon icon-increase-height"})}),t(Ie,{itemActive:r===Ct.DOWN,onClick:_=>u(Ct.DOWN),children:t("i",{className:"icon icon-decrease-height"})})]}),t(Ie,{itemActive:r===Ct.DOOR,onClick:_=>u(Ct.DOOR),children:t("i",{className:"icon icon-set-door"})})]})]}),l(T,{alignItems:"center",size:4,children:[t(S,{bold:!0,children:m("floor.plan.editor.enter.direction")}),t("i",{className:`icon icon-door-direction-${e.entryPointDir} cursor-pointer`,onClick:d})]}),l(T,{size:3,children:[t(S,{bold:!0,children:m("floor.editor.wall.height")}),l(w,{alignItems:"center",gap:1,children:[t(_u,{className:"cursor-pointer fa-icon",onClick:E}),t("input",{type:"number",className:"form-control form-control-sm quantity-input",value:e.wallHeight,onChange:_=>p(_.target.valueAsNumber)}),t(bu,{className:"cursor-pointer fa-icon",onClick:C})]})]})]}),l(w,{gap:1,children:[l(T,{size:6,children:[l(S,{bold:!0,children:[m("floor.plan.editor.tile.height"),": ",a]}),t(Dt,{className:"nitro-slider",min:rw,max:sw,step:1,value:a,onChange:_=>h(_),renderThumb:({style:_,...I},b)=>t("div",{style:{backgroundColor:`#${Xv[b.valueNow.toString(33)]}`,..._},...I,children:b.valueNow})})]}),l(T,{size:6,children:[t(S,{bold:!0,children:m("floor.plan.editor.room.options")}),l(w,{className:"align-items-center",children:[l("select",{className:"form-control form-control-sm",value:e.thicknessWall,onChange:_=>f(parseInt(_.target.value)),children:[t("option",{value:0,children:m("navigator.roomsettings.wall_thickness.thinnest")}),t("option",{value:1,children:m("navigator.roomsettings.wall_thickness.thin")}),t("option",{value:2,children:m("navigator.roomsettings.wall_thickness.normal")}),t("option",{value:3,children:m("navigator.roomsettings.wall_thickness.thick")})]}),l("select",{className:"form-control form-control-sm",value:e.thicknessFloor,onChange:_=>g(parseInt(_.target.value)),children:[t("option",{value:0,children:m("navigator.roomsettings.floor_thickness.thinnest")}),t("option",{value:1,children:m("navigator.roomsettings.floor_thickness.thin")}),t("option",{value:2,children:m("navigator.roomsettings.floor_thickness.normal")}),t("option",{value:3,children:m("navigator.roomsettings.floor_thickness.thick")})]})]})]})]})]})},ow=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(!1),[a,c]=i.useState({tilemap:"",reservedTiles:[],entryPoint:[0,0],entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),[u,d]=i.useState({entryPointDir:2,wallHeight:-1,thicknessWall:1,thicknessFloor:1}),h=()=>{A(new Qu(Yt.instance.getCurrentTilemapString(),Yt.instance.doorLocation.x,Yt.instance.doorLocation.y,u.entryPointDir,ao(u.thicknessWall),ao(u.thicknessFloor),u.wallHeight-1))},g=()=>{d({wallHeight:a.wallHeight,thicknessWall:a.thicknessWall,thicknessFloor:a.thicknessFloor,entryPointDir:a.entryPointDir}),Yt.instance.doorLocation=new vr(a.entryPoint[0],a.entryPoint[1]),Yt.instance.setTilemap(a.tilemap,a.reservedTiles),Yt.instance.renderTiles()};return Te(En.DISPOSED,f=>n(!1)),F(dE,f=>{const p=f.getParser();c(C=>{const E={...C};return E.tilemap=p.model,E.wallHeight=p.wallHeight+1,E}),d(C=>{const E={...C};return E.wallHeight=p.wallHeight+1,E})}),F(mE,f=>{const p=f.getParser();c(C=>{const E={...C};return E.thicknessFloor=Pa(p.thicknessFloor),E.thicknessWall=Pa(p.thicknessWall),E}),d(C=>{const E={...C};return E.thicknessFloor=Pa(p.thicknessFloor),E.thicknessWall=Pa(p.thicknessWall),E})}),i.useEffect(()=>{const f={linkReceived:p=>{const C=p.split("/");if(!(C.length<2))switch(C[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(E=>!E);return}},eventUrlPrefix:"floor-editor/"};return ut(f),()=>dt(f)},[]),i.useEffect(()=>{Yt.instance.initialize()},[]),l(ew,{value:{originalFloorplanSettings:a,setOriginalFloorplanSettings:c,visualizationSettings:u,setVisualizationSettings:d},children:[e&&l(oe,{uniqueKey:"floorpan-editor",className:"nitro-floorplan-editor",theme:"primary-slim",children:[t(ie,{headerText:m("floor.plan.editor.title"),onCloseClick:()=>n(!1)}),l(re,{overflow:"hidden",children:[t(aw,{}),t(tw,{overflow:"hidden"}),l(w,{justifyContent:"between",children:[t(D,{onClick:g,children:m("floor.plan.editor.reload")}),l(nr,{children:[t(D,{disabled:!0,children:m("floor.plan.editor.preview")}),t(D,{onClick:f=>s(!0),children:m("floor.plan.editor.import.export")}),t(D,{onClick:h,children:m("floor.plan.editor.save")})]})]})]})]}),r&&t(nw,{onCloseClick:()=>s(!1)})]})},iw=o=>{const{friend:e=null}=o,[n,r]=i.useState(!1),{followFriend:s=null}=fn(),a=i.useRef();return i.useEffect(()=>{const c=u=>{const d=a.current;d&&u.target!==d&&!d.contains(u.target)&&r(!1)};return document.addEventListener(Re.MOUSE_CLICK,c),()=>document.removeEventListener(Re.MOUSE_CLICK,c)},[]),e?l("div",{ref:a,className:"btn btn-success friend-bar-item "+(n?"friend-bar-item-active":""),onClick:c=>r(u=>!u),children:[l("div",{className:`friend-bar-item-head position-absolute ${e.id>0?"avatar":"group"}`,children:[e.id>0&&t(ot,{headOnly:!0,figure:e.figure,direction:2}),e.id<=0&&t(qe,{isGroup:!0,badgeCode:e.figure})]}),t("div",{className:"text-truncate",children:e.name}),n&&l("div",{className:"d-flex justify-content-between",children:[t(P,{className:"nitro-friends-spritesheet icon-friendbar-chat cursor-pointer",onClick:c=>fo(e.id)}),e.followingAllowed&&t(P,{className:"nitro-friends-spritesheet icon-friendbar-visit cursor-pointer",onClick:c=>s(e)}),t(P,{className:"nitro-friends-spritesheet icon-profile cursor-pointer",onClick:c=>tn(e.id)})]})]}):l("div",{ref:a,className:"btn btn-primary friend-bar-item friend-bar-search",children:[t("div",{className:"friend-bar-item-head position-absolute"}),t("div",{className:"text-truncate",children:m("friend.bar.find.title")})]})},Zo=3,lw=o=>{const{onlineFriends:e=null}=o,[n,r]=i.useState(0),s=i.useRef();return l(w,{innerRef:s,alignItems:"center",className:"friend-bar",children:[t(D,{variant:"black",className:"friend-bar-button",disabled:n<=0,onClick:a=>r(n-1),children:t(Jt,{className:"fa-icon"})}),Array.from(Array(Zo),(a,c)=>t(iw,{friend:e[n+c]||null},c)),t(D,{variant:"black",className:"friend-bar-button",disabled:!(e.length>Zo&&n+Zo<=e.length-1),onClick:a=>r(n+1),children:t(Zt,{className:"fa-icon"})})]})},cw=o=>{const{friend:e=null,selected:n=!1,selectFriend:r=null}=o,[s,a]=i.useState(!1),{followFriend:c=null,updateRelationship:u=null}=fn(),d=C=>{C.stopPropagation(),c(e)},h=C=>{C.stopPropagation(),fo(e.id)},g=C=>{C.stopPropagation(),a(!0)},f=(C,E)=>{C.stopPropagation(),u(e,E),a(!1)},p=()=>{if(!e)return"none";switch(e.relationshipStatus){case Wt.RELATIONSHIP_HEART:return"heart";case Wt.RELATIONSHIP_SMILE:return"smile";case Wt.RELATIONSHIP_BOBBA:return"bobba";default:return"none"}};return e?l(no,{justifyContent:"between",className:`px-2 py-1 ${n&&"bg-primary text-white"}`,onClick:C=>r(e.id),children:[l(w,{alignItems:"center",gap:1,children:[t(P,{onClick:C=>C.stopPropagation(),children:t(bn,{userId:e.id})}),t("div",{children:e.name})]}),l(w,{alignItems:"center",gap:1,children:[!s&&l(V,{children:[e.followingAllowed&&t(P,{pointer:!0,onClick:d,className:"nitro-friends-spritesheet icon-follow",title:m("friendlist.tip.follow")}),e.online&&t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-chat",onClick:h,title:m("friendlist.tip.im")}),e.id>0&&t(P,{className:`nitro-friends-spritesheet icon-${p()} cursor-pointer`,onClick:g,title:m("infostand.link.relationship")})]}),s&&l(V,{children:[t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-heart",onClick:C=>f(C,Wt.RELATIONSHIP_HEART)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-smile",onClick:C=>f(C,Wt.RELATIONSHIP_SMILE)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba",onClick:C=>f(C,Wt.RELATIONSHIP_BOBBA)}),t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-none",onClick:C=>f(C,Wt.RELATIONSHIP_NONE)})]})]})]}):null},Rc=o=>{const{list:e=null,selectedFriendsIds:n=null,selectFriend:r=null}=o;return!e||!e.length?null:t(V,{children:e.map((s,a)=>t(cw,{friend:s,selected:n&&n.indexOf(s.id)>=0,selectFriend:r},a))})},uw=o=>{const{request:e=null}=o,{requestResponse:n=null}=fn();return e?l(no,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:e.id}),t("div",{children:e.name})]}),l(w,{alignItems:"center",gap:1,children:[t(P,{className:"nitro-friends-spritesheet icon-accept cursor-pointer",onClick:r=>n(e.id,!0)}),t(P,{className:"nitro-friends-spritesheet icon-deny cursor-pointer",onClick:r=>n(e.id,!1)})]})]}):null},dw=o=>{const{children:e=null,...n}=o,{requests:r=[],requestResponse:s=null}=fn();return r.length?l(ro,{...n,children:[l(T,{fullHeight:!0,justifyContent:"between",gap:1,children:[t(T,{gap:0,children:r.map((a,c)=>t(uw,{request:a},c))}),t(w,{justifyContent:"center",className:"px-2 py-1",children:t(D,{onClick:a=>s(-1,!1),children:m("friendlist.requests.dismissall")})})]}),e]}):null},mw=o=>{const{selectedFriendsIds:e=null,removeFriendsText:n=null,removeSelectedFriends:r=null,onCloseClick:s=null}=o;return l(oe,{className:"nitro-friends-remove-confirmation",theme:"primary-slim",children:[t(ie,{headerText:m("friendlist.removefriendconfirm.title"),onCloseClick:s}),l(re,{className:"text-black",children:[t("div",{children:n}),l(w,{gap:1,children:[t(D,{fullWidth:!0,variant:"danger",disabled:e.length===0,onClick:r,children:m("generic.ok")}),t(D,{fullWidth:!0,onClick:s,children:m("generic.cancel")})]})]})]})},gw=o=>{const{selectedFriendsIds:e=null,onCloseClick:n=null,sendRoomInvite:r=null}=o,[s,a]=i.useState("");return l(oe,{className:"nitro-friends-room-invite",uniqueKey:"nitro-friends-room-invite",theme:"primary-slim",children:[t(ie,{headerText:m("friendlist.invite.title"),onCloseClick:n}),l(re,{className:"text-black",children:[m("friendlist.invite.summary",["count"],[e.length.toString()]),t("textarea",{className:"form-control",value:s,maxLength:255,onChange:c=>a(c.target.value)}),t(S,{center:!0,className:"bg-muted rounded p-1",children:m("friendlist.invite.note")}),l(w,{gap:1,children:[t(D,{fullWidth:!0,variant:"success",disabled:s.length===0||e.length===0,onClick:()=>r(s),children:m("friendlist.invite.send")}),t(D,{fullWidth:!0,onClick:n,children:m("generic.cancel")})]})]})]})},hw=o=>{const{...e}=o,[n,r]=i.useState(""),[s,a]=i.useState(null),[c,u]=i.useState(null),{canRequestFriend:d=null,requestFriend:h=null}=fn();return F(gE,g=>{const f=g.getParser();a(f.friends),u(f.others)}),i.useEffect(()=>{if(!n||!n.length)return;const g=setTimeout(()=>{!n||!n.length||A(new hE(n))},500);return()=>clearTimeout(g)},[n]),l(ro,{...e,children:[t("input",{type:"text",className:"search-input form-control form-control-sm w-100 rounded-0",placeholder:m("generic.search"),value:n,maxLength:50,onChange:g=>r(g.target.value)}),l(T,{children:[s&&l(V,{children:[s.length===0&&t(S,{bold:!0,small:!0,className:"px-2 py-1",children:m("friendlist.search.nofriendsfound")}),s.length>0&&l(T,{gap:0,children:[t(S,{bold:!0,small:!0,className:"px-2 py-1",children:m("friendlist.search.friendscaption",["cnt"],[s.length.toString()])}),t("hr",{className:"mx-2 mt-0 mb-1 text-black"}),t(T,{gap:0,children:s.map(g=>l(no,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:g.avatarId}),t("div",{children:g.avatarName})]}),t(w,{alignItems:"center",gap:1,children:g.isAvatarOnline&&t(P,{className:"nitro-friends-spritesheet icon-chat cursor-pointer",onClick:f=>fo(g.avatarId),title:m("friendlist.tip.im")})})]},g.avatarId))})]})]}),c&&l(V,{children:[c.length===0&&t(S,{bold:!0,small:!0,className:"px-2 py-1",children:m("friendlist.search.noothersfound")}),c.length>0&&l(T,{gap:0,children:[t(S,{bold:!0,small:!0,className:"px-2 py-1",children:m("friendlist.search.otherscaption",["cnt"],[c.length.toString()])}),t("hr",{className:"mx-2 mt-0 mb-1 text-black"}),t(T,{gap:0,children:c.map(g=>l(no,{justifyContent:"between",className:"px-2 py-1",children:[l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:g.avatarId}),t("div",{children:g.avatarName})]}),t(w,{alignItems:"center",gap:1,children:d(g.avatarId)&&t(P,{className:"nitro-friends-spritesheet icon-add cursor-pointer",onClick:f=>h(g.avatarId,g.avatarName),title:m("friendlist.tip.addfriend")})})]},g.avatarId))})]})]})]})]})},fw=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState([]),[a,c]=i.useState(!1),[u,d]=i.useState(!1),{onlineFriends:h=[],offlineFriends:g=[],requests:f=[],requestFriend:p=null}=fn(),C=i.useMemo(()=>{if(!r||!r.length)return"";const b=[];for(const N of r){let v=h.find(O=>O.id===N);v||(v=g.find(O=>O.id===N)),v&&b.push(v.name)}return m("friendlist.removefriendconfirm.userlist",["user_names"],[b.join(", ")])},[g,h,r]),E=i.useCallback(b=>{b<0||s(N=>{const v=[...N],O=v.indexOf(b);return O>-1?v.splice(O,1):v.push(b),v})},[s]),_=b=>{!r.length||!b||!b.length||b.length>255||(A(new fE(b,r)),c(!1))},I=()=>{r.length!==0&&(s(b=>(A(new pE(...b)),[])),d(!1))};return i.useEffect(()=>{const b={linkReceived:N=>{const v=N.split("/");if(!(v.length<2))switch(v[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(O=>!O);return;case"request":if(v.length<4)return;p(parseInt(v[2]),v[3])}},eventUrlPrefix:"friends/"};return ut(b),()=>dt(b)},[p]),e?l(V,{children:[l(oe,{className:"nitro-friends",uniqueKey:"nitro-friends",theme:"primary-slim",children:[t(ie,{headerText:m("friendlist.friends"),onCloseClick:b=>n(!1)}),l(re,{overflow:"hidden",gap:1,className:"text-black p-0",children:[l(_S,{fullHeight:!0,overflow:"hidden",children:[t(ro,{headerText:m("friendlist.friends")+` (${h.length})`,isExpanded:!0,children:t(Rc,{list:h,selectedFriendsIds:r,selectFriend:E})}),t(ro,{headerText:m("friendlist.friends.offlinecaption")+` (${g.length})`,children:t(Rc,{list:g,selectedFriendsIds:r,selectFriend:E})}),t(dw,{headerText:m("friendlist.tab.friendrequests")+` (${f.length})`,isExpanded:!0}),t(hw,{headerText:m("people.search.title")})]}),r&&r.length>0&&l(w,{gap:1,className:"p-1",children:[t(D,{fullWidth:!0,onClick:()=>c(!0),children:m("friendlist.tip.invite")}),t(D,{fullWidth:!0,variant:"danger",onClick:b=>d(!0),children:m("generic.delete")})]})]})]}),a&&t(gw,{selectedFriendsIds:r,onCloseClick:()=>c(!1),sendRoomInvite:_}),u&&t(mw,{selectedFriendsIds:r,removeFriendsText:C,onCloseClick:()=>d(!1),removeSelectedFriends:I})]}):null},pw=o=>{const{thread:e=null,group:n=null}=o,r=i.useMemo(()=>n.type===Yr.GROUP_CHAT&&wd(n.chats[0].extraData),[n]),s=i.useMemo(()=>!e||!n?!1:!!(n.type===Yr.PRIVATE_CHAT&&n.userId===q().userId||r&&n.chats.length&&r.userId===q().userId),[e,n,r]);return!e||!n?null:n.userId?l(w,{fullWidth:!0,justifyContent:s?"end":"start",gap:2,children:[l(P,{shrink:!0,className:"message-avatar",children:[n.type===Yr.PRIVATE_CHAT&&!s&&t(ot,{figure:e.participant.figure,direction:2}),r&&!s&&t(ot,{figure:r.figure,direction:2})]}),l(P,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(s?"right":"left"),children:[l(P,{className:"fw-bold",children:[s&&q().userName,!s&&(r?r.username:e.participant.name)]}),n.chats.map((a,c)=>t(P,{className:"text-break",children:a.message},c))]}),s&&t(P,{shrink:!0,className:"message-avatar",children:t(ot,{figure:q().figure,direction:4})})]}):t(V,{children:n.chats.map((a,c)=>t(w,{fullWidth:!0,gap:2,justifyContent:"start",children:l(P,{className:"w-100 text-break",children:[a.type===zn.SECURITY_NOTIFICATION&&l(w,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-muted",children:[t(P,{className:"nitro-friends-spritesheet icon-warning flex-shrink-0"}),t(P,{children:a.message})]}),a.type===zn.ROOM_INVITE&&l(w,{gap:2,alignItems:"center",className:"bg-light rounded mb-2 px-2 py-1 small text-black",children:[t(P,{className:"messenger-notification-icon flex-shrink-0"}),l(P,{children:[m("messenger.invitation")+" ",a.message]})]})]})},c))})},Iw=o=>{const{thread:e=null}=o;return e.setRead(),t(V,{children:e.groups.length>0&&e.groups.map((n,r)=>t(pw,{thread:e,group:n},r))})},Ew=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(-1),[a,c]=i.useState(""),{visibleThreads:u=[],activeThread:d=null,getMessageThread:h=null,sendMessage:g=null,setActiveThreadId:f=null,closeThread:p=null}=hm(),{report:C=null}=Un(),E=i.useRef(),_=()=>d&&d.participant&&A(new $i(d.participant.id)),I=()=>d&&d.participant&&tn(d.participant.id),b=()=>{!d||!a.length||(g(d,q().userId,a),c(""))},N=v=>{v.key==="Enter"&&b()};return i.useEffect(()=>{const v={linkReceived:O=>{const R=O.split("/");if(R.length===2){if(R[1]==="open"){n(!0);return}if(R[1]==="toggle"){n(G=>!G);return}const y=h(parseInt(R[1]));if(!y)return;f(y.threadId),n(!0)}},eventUrlPrefix:"friends-messenger/"};return ut(v),()=>dt(v)},[h,f]),i.useEffect(()=>{!e||!d||(E.current.scrollTop=E.current.scrollHeight)},[e,d]),i.useEffect(()=>{if(e&&!d){r>0?f(r):u.length>0&&f(u[0].threadId);return}!e&&d&&(s(d.threadId),f(-1))},[e,d,r,u,f]),e?l(oe,{className:"nitro-friends-messenger",uniqueKey:"nitro-friends-messenger",theme:"primary-slim",children:[t(ie,{headerText:m("messenger.window.title",["OPEN_CHAT_COUNT"],[u.length.toString()]),onCloseClick:v=>n(!1)}),t(re,{children:l(se,{overflow:"hidden",children:[l(T,{size:4,overflow:"hidden",children:[t(S,{bold:!0,children:m("toolbar.icon.label.messenger")}),t(T,{fit:!0,overflow:"auto",children:t(T,{children:u&&u.length>0&&u.map(v=>l(Ie,{itemActive:d===v,onClick:O=>f(v.threadId),children:[v.unread&&t(wr,{count:v.unreadCount}),l(w,{fullWidth:!0,alignItems:"center",gap:1,children:[l(w,{alignItems:"center",className:"friend-head px-1",children:[v.participant.id>0&&t(ot,{figure:v.participant.figure,headOnly:!0,direction:3}),v.participant.id<=0&&t(qe,{isGroup:!0,badgeCode:v.participant.figure})]}),t(S,{truncate:!0,grow:!0,children:v.participant.name})]})]},v.threadId))})})]}),t(T,{size:8,overflow:"hidden",children:d&&l(V,{children:[t(S,{bold:!0,center:!0,children:m("messenger.window.separator",["FRIEND_NAME"],[d.participant.name])}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[l(w,{gap:1,children:[l(nr,{children:[t(D,{onClick:_,children:t(P,{className:"nitro-friends-spritesheet icon-follow"})}),t(D,{onClick:I,children:t(P,{className:"nitro-friends-spritesheet icon-profile-sm"})})]}),t(D,{variant:"danger",onClick:()=>C(He.IM,{reportedUserId:d.participant.id}),children:m("messenger.window.button.report")})]}),t(D,{onClick:v=>p(d.threadId),children:t(hn,{className:"fa-icon"})})]}),t(T,{fit:!0,className:"bg-muted p-2 rounded chat-messages",children:t(T,{innerRef:E,overflow:"auto",children:t(Iw,{thread:d})})}),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",maxLength:255,placeholder:m("messenger.window.input.default",["FRIEND_NAME"],[d.participant.name]),value:a,onChange:v=>c(v.target.value),onKeyDown:N}),t(D,{variant:"success",onClick:b,children:m("widgets.chatinput.say")})]})]})})]})})]}):null},Cw=o=>{const{settings:e=null,onlineFriends:n=[]}=fn();return e?l(V,{children:[Vi.createPortal(t(lw,{onlineFriends:n}),document.getElementById("toolbar-friend-bar-container")),t(fw,{}),t(Ew,{})]}):null},_w=()=>{const{games:o,selectedGame:e,setSelectedGame:n}=To(),r=a=>{let c=["game-icon"];return e===a&&c.push("selected"),c.join(" ")},s=a=>`url(${a.assetUrl}${a.gameNameId}_icon.png)`;return l(P,{fullWidth:!0,className:"gameList-container bg-dark p-1",children:[m("gamecenter.game_list_title"),t(w,{gap:3,children:o&&o.map((a,c)=>t(P,{className:r(a),onClick:u=>n(a),style:{backgroundImage:s(a)}},c))})]})},bw=()=>{const{gameURL:o,setGameURL:e}=To(),[n,r]=i.useState(0),s=i.useRef();return i.useEffect(()=>{if(!s||s&&!s.current)return;r(0);let a=document.createElement("iframe");a.src=o,a.classList.add("game-center-stage"),a.classList.add("h-100"),a.onload=()=>{r(c=>c+=1)},s.current.innerHTML="",s.current.appendChild(a)},[s,o]),i.useEffect(()=>{n>1&&(e(null),A(new IE))},[n,e]),o?t(P,{innerRef:s,className:"game-center-stage"}):null},Sw=()=>{const{selectedGame:o,accountStatus:e}=To();i.useEffect(()=>{o&&(A(new EE(o.gameId)),A(new CE(o.gameId)))},[o]);const n=()=>en.uintHexColor(o.bgColor),r=()=>`url(${o.assetUrl}${o.gameNameId}_theme.png)`,s=()=>en.uintHexColor(o.textColor),a=()=>{A(new _E(o.gameId))};return l(w,{className:"game-view py-4",fullHeight:!0,style:{backgroundColor:n(),backgroundImage:r(),color:s()},children:[l(w,{className:"w-75",column:!0,alignItems:"center",gap:2,children:[t(S,{bold:!0,children:m(`gamecenter.${o.gameNameId}.description_title`)}),t("img",{src:o.assetUrl+o.gameNameId+"_logo.png"}),(e.hasUnlimitedGames||e.freeGamesLeft>0)&&t(V,{children:l(D,{variant:"light",position:"relative",className:"px-4",onClick:a,children:[m("gamecenter.play_now"),!e.hasUnlimitedGames&&t(wr,{className:"me-n1 mt-n1",count:e.freeGamesLeft})]})}),t(S,{bold:!0,className:"w-50",center:!0,children:m(`gamecenter.${o.gameNameId}.description_content`)})]}),t(P,{className:"w-25"})]})},Nw=()=>{const{isVisible:o,setIsVisible:e,games:n,accountStatus:r}=To();if(i.useEffect(()=>{const s=()=>{e(c=>!c)},a={linkReceived:c=>{switch(c.split("/")[1]){case"toggle":s();break}},eventUrlPrefix:"games/"};return ut(a),()=>dt(a)},[]),!(!o||!n||!r))return l(w,{position:"absolute",className:"top-0 bottom-0 start-0 end-0 bg-black",justifyContent:"center",children:[l(w,{className:"game-center-main",column:!0,children:[t(Sw,{}),t(_w,{})]}),t(bw,{})]})},Tw=[0,1,2,3,4,5,6,7,8],vw=o=>{const{badgeParts:e=[],setBadgeParts:n=null}=o,[r,s]=i.useState(-1),{groupCustomize:a=null}=ua(),c=(u,d,h)=>{const g=[...e];g[u][d]=h,n(g),d==="key"&&s(-1)};return!e||!e.length?null:l(V,{children:[r<0&&e&&e.length>0&&e.map((u,d)=>l(w,{alignItems:"center",justifyContent:"between",gap:2,className:"bg-muted rounded px-2 py-1",children:[l(w,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:h=>s(d),children:[e[d].code&&e[d].code.length>0&&t(qe,{badgeCode:e[d].code,isGroup:!0}),(!e[d].code||!e[d].code.length)&&t(w,{center:!0,className:"badge-image group-badge",children:t(Js,{className:"fa-icon"})})]}),u.type!==sn.BASE&&t(se,{gap:1,columnCount:3,children:Tw.map((h,g)=>t(P,{pointer:!0,className:`group-badge-position-swatch ${e[d].position===h?"active":""}`,onClick:f=>c(d,"position",h)},g))}),t(se,{gap:1,columnCount:8,children:a.badgePartColors.length>0&&a.badgePartColors.map((h,g)=>t(P,{pointer:!0,className:`group-badge-color-swatch ${e[d].color===g+1?"active":""}`,style:{backgroundColor:"#"+h.color},onClick:f=>c(d,"color",g+1)},g))})]},d)),r>=0&&l(se,{gap:1,columnCount:5,children:[e[r].type===sn.SYMBOL&&t(T,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:u=>c(r,"key",0),children:t(w,{center:!0,className:"badge-image group-badge",children:t(hn,{className:"fa-icon"})})}),(e[r].type===sn.BASE?a.badgeBases:a.badgeSymbols).map((u,d)=>t(T,{pointer:!0,center:!0,className:"bg-muted rounded p-1",onClick:h=>c(r,"key",u.id),children:t(qe,{badgeCode:sn.getCode(e[r].type,u.id,e[r].color,4),isGroup:!0})},d))]})]})},Lm=o=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null,skipDefault:s=null}=o,[a,c]=i.useState(null),{groupCustomize:u=null}=ua(),d=()=>{if(!a||!a.length)return"";let g="";return a.forEach(f=>f.code&&(g+=f.code)),g},h=i.useCallback(()=>{if(!e||!a||!a.length)return!1;if(e.groupBadgeParts===a)return!0;if(e.groupId<=0)return n(f=>{const p={...f};return p.groupBadgeParts=a,p}),!0;const g=[];return a.forEach(f=>{f.code&&(g.push(f.key),g.push(f.color),g.push(f.position))}),A(new bE(e.groupId,g)),!0},[e,a,n]);return i.useEffect(()=>{if(e.groupBadgeParts)return;const g=[new sn(sn.BASE,u.badgeBases[0].id,u.badgePartColors[0].id),new sn(sn.SYMBOL,0,u.badgePartColors[0].id),new sn(sn.SYMBOL,0,u.badgePartColors[0].id),new sn(sn.SYMBOL,0,u.badgePartColors[0].id),new sn(sn.SYMBOL,0,u.badgePartColors[0].id)];n(f=>({...f,groupBadgeParts:g}))},[e.groupBadgeParts,u,n]),i.useEffect(()=>{if(e.groupId<=0){c(e.groupBadgeParts?[...e.groupBadgeParts]:null);return}c(e.groupBadgeParts)},[e]),i.useEffect(()=>(r({action:h}),()=>r(null)),[r,h]),l(se,{overflow:"hidden",gap:1,children:[t(T,{size:2,children:t(w,{center:!0,className:"bg-muted rounded p-1",children:t(qe,{badgeCode:d(),isGroup:!0})})}),t(T,{size:10,overflow:"auto",children:t(vw,{badgeParts:a,setBadgeParts:c})})]})},Um=o=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null}=o,[s,a]=i.useState(null),{groupCustomize:c=null}=ua(),u=g=>g===0?c.groupColorsA.find(f=>f.id===s[g]).color:c.groupColorsB.find(f=>f.id===s[g]).color,d=(g,f)=>{a(p=>{const C=[...p];return C[g]=f,C})},h=i.useCallback(()=>!e||!s||!s.length?!1:e.groupColors===s?!0:e.groupId<=0?(n(g=>{const f={...g};return f.groupColors=[...s],f}),!0):(A(new SE(e.groupId,s[0],s[1])),!0),[e,s,n]);return i.useEffect(()=>{if(!c.groupColorsA||!c.groupColorsB||e.groupColors)return;const g=[c.groupColorsA[0].id,c.groupColorsB[0].id];n(f=>({...f,groupColors:g}))},[c,e.groupColors,n]),i.useEffect(()=>{if(e.groupId<=0){a(e.groupColors?[...e.groupColors]:null);return}a(e.groupColors)},[e]),i.useEffect(()=>(r({action:h}),()=>r(null)),[r,h]),s?l(se,{overflow:"hidden",children:[l(T,{size:2,gap:1,children:[t(S,{bold:!0,children:m("group.edit.color.guild.color")}),e.groupColors&&e.groupColors.length>0&&l(w,{overflow:"hidden",className:"rounded border",children:[t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+u(0)}}),t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+u(1)}})]})]}),l(T,{size:5,gap:1,overflow:"hidden",children:[t(S,{bold:!0,children:m("group.edit.color.primary.color")}),t(ke,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&c.groupColorsA&&c.groupColorsA.map((g,f)=>t("div",{className:Gt("group-badge-color-swatch cursor-pointer",e.groupColors[0]===g.id&&"active"),style:{backgroundColor:"#"+g.color},onClick:()=>d(0,g.id)},f))})]}),l(T,{size:5,gap:1,overflow:"hidden",children:[t(S,{bold:!0,children:m("group.edit.color.secondary.color")}),t(ke,{gap:1,columnCount:7,columnMinWidth:16,columnMinHeight:16,children:e.groupColors&&c.groupColorsB&&c.groupColorsB.map((g,f)=>t("div",{className:Gt("group-badge-color-swatch cursor-pointer",e.groupColors[1]===g.id&&"active"),style:{backgroundColor:"#"+g.color},onClick:()=>d(1,g.id)},f))})]})]}):null},ww=o=>{const{groupData:e=null,setGroupData:n=null,purchaseCost:r=0}=o,{groupCustomize:s=null}=ua(),a=()=>{if(!e||!e.groupBadgeParts||!e.groupBadgeParts.length)return"";let u="";return e.groupBadgeParts.forEach(d=>d.code&&(u+=d.code)),u},c=u=>u===0?s.groupColorsA.find(d=>d.id===e.groupColors[u]).color:s.groupColorsB.find(d=>d.id===e.groupColors[u]).color;return e?l(se,{overflow:"hidden",gap:1,children:[l(T,{size:3,children:[l(T,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[t(S,{bold:!0,center:!0,children:m("group.create.confirm.guildbadge")}),t(qe,{badgeCode:a(),isGroup:!0})]}),l(T,{center:!0,className:"bg-muted rounded p-1",gap:2,children:[t(S,{bold:!0,center:!0,children:m("group.edit.color.guild.color")}),l(w,{overflow:"hidden",className:"rounded border",children:[t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+c(0)}}),t(P,{className:"group-color-swatch",style:{backgroundColor:"#"+c(1)}})]})]})]}),l(T,{size:9,justifyContent:"between",children:[l(T,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:e.groupName}),t(S,{children:e.groupDescription})]}),t(S,{overflow:"auto",children:m("group.create.confirm.info")})]}),t(S,{center:!0,variant:"white",className:"bg-primary rounded p-1",children:m("group.create.confirm.buyinfo",["amount"],[r.toString()])})]})]}):null},xm=o=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null,onClose:s=null,isCreator:a=!1,availableRooms:c=[]}=o,[u,d]=i.useState(""),[h,g]=i.useState(""),[f,p]=i.useState(-1),{showConfirm:C=null}=Je(),E=()=>{!e||e.groupId<=0||C(m("group.deleteconfirm.desc"),()=>{A(new TE(e.groupId)),s&&s()},null,null,null,m("group.deleteconfirm.title"))},_=i.useCallback(()=>!e||!u||!u.length?!1:u===e.groupName&&h===e.groupDescription?!0:e.groupId<=0?f<=0?!1:(n(I=>{const b={...I};return b.groupName=u,b.groupDescription=h,b.groupHomeroomId=f,b}),!0):(A(new NE(e.groupId,u,h||"")),!0),[e,u,h,f,n]);return i.useEffect(()=>{d(e.groupName||""),g(e.groupDescription||""),p(e.groupHomeroomId)},[e]),i.useEffect(()=>(r({action:_}),()=>r(null)),[r,_]),e?l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:m("group.edit.name")}),t("input",{type:"text",className:"form-control form-control-sm",value:u,maxLength:29,onChange:I=>d(I.target.value)})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:m("group.edit.desc")}),t("textarea",{className:"form-control form-control-sm",value:h,maxLength:254,onChange:I=>g(I.target.value)})]}),a&&l(V,{children:[l(w,{alignItems:"center",gap:1,children:[t(S,{center:!0,className:"col-3",children:m("group.edit.base")}),t(T,{fullWidth:!0,gap:1,children:l("select",{className:"form-select form-select-sm",value:f,onChange:I=>p(parseInt(I.target.value)),children:[t("option",{value:-1,disabled:!0,children:m("group.edit.base.select.room")}),c&&c.map((I,b)=>t("option",{value:I.id,children:I.name},b))]})})]}),l(w,{gap:1,children:[t(P,{className:"col-3",children:""}),t(S,{small:!0,children:m("group.edit.base.warning")})]})]})]}),!a&&t(D,{variant:"danger",onClick:E,children:m("group.delete")}),a&&t(S,{underline:!0,center:!0,fullWidth:!0,pointer:!0,onClick:I=>ee("navigator/create"),children:m("group.createroom")})]}):null},Rw=[1,2,3,4],yw=o=>{const{onClose:e=null}=o,[n,r]=i.useState(1),[s,a]=i.useState(null),[c,u]=i.useState(null),[d,h]=i.useState(null),[g,f]=i.useState(0),p=()=>{a(null),u(null),e&&e()},C=()=>{if(!c)return;const I=[];c.groupBadgeParts.forEach(b=>{b.code&&(I.push(b.key),I.push(b.color),I.push(b.position))}),A(new RE(c.groupName,c.groupDescription,c.groupHomeroomId,c.groupColors[0],c.groupColors[1],I))},E=()=>{if(!(s&&s.action&&!s.action())){if(n===1){e();return}r(I=>I-1)}},_=()=>{if(!(s&&s.action&&!s.action())){if(n===4){C();return}r(I=>I===4?I:I+1)}};return F(vE,I=>{const b=I.getParser(),N=[];b.availableRooms.forEach((v,O)=>N.push({id:O,name:v})),h(N),f(b.groupCost)}),i.useEffect(()=>{r(1),u({groupId:-1,groupName:null,groupDescription:null,groupHomeroomId:-1,groupState:1,groupCanMembersDecorate:!0,groupColors:null,groupBadgeParts:null}),A(new wE)},[u]),c?l(oe,{className:"nitro-group-creator",theme:"primary-slim",children:[t(ie,{headerText:m("group.create.title"),onCloseClick:p}),l(re,{children:[t(w,{center:!0,className:"creator-tabs",children:Rw.map((I,b)=>t(w,{center:!0,className:`tab tab-${I===1?"blue-flat":I===4?"yellow":"blue-arrow"} ${n===I?"active":""}`,children:t(S,{variant:"white",children:m(`group.create.steplabel.${I}`)})},b))}),l(T,{overflow:"hidden",children:[l(w,{alignItems:"center",gap:2,children:[t(P,{className:`nitro-group-tab-image tab-${n}`}),l(T,{grow:!0,gap:0,children:[t(S,{bold:!0,fontSize:4,children:m(`group.create.stepcaption.${n}`)}),t(S,{children:m(`group.create.stepdesc.${n}`)})]})]}),l(T,{overflow:"hidden",children:[n===1&&t(xm,{groupData:c,setGroupData:u,setCloseAction:a,onClose:null,isCreator:!0,availableRooms:d}),n===2&&t(Lm,{groupData:c,setGroupData:u,setCloseAction:a}),n===3&&t(Um,{groupData:c,setGroupData:u,setCloseAction:a}),n===4&&t(ww,{groupData:c,setGroupData:u,purchaseCost:g})]}),l(w,{justifyContent:"between",children:[t(D,{variant:"link",className:"text-black",onClick:E,children:m(n===1?"generic.cancel":"group.create.previousstep")}),t(D,{disabled:n===4&&!zr(),variant:n===4?zr()?"success":"danger":"primary",onClick:_,children:m(n===4?zr()?"group.create.confirm.buy":"group.create.confirm.viprequired":"group.create.nextstep")})]})]})]})]}):null},Ow=["regular","exclusive","private"],Fm=o=>{const{groupInformation:e=null,onClose:n=null,overflow:r="hidden",...s}=o,{showConfirm:a=null}=Je(),c=e&&e.ownerName===q().userName,u=()=>e&&al(e.id),d=()=>{a(m("group.leaveconfirm.desc"),()=>{A(new Ki(e.id,q().userId)),n&&n()},null)},h=()=>e.membershipType===vt.NOT_MEMBER||e.membershipType===vt.REQUEST_PENDING?null:c?t("i",{className:"icon icon-group-owner",title:m("group.youareowner")}):e.isAdmin?t("i",{className:"icon icon-group-admin",title:m("group.youareadmin")}):t("i",{className:"icon icon-group-member",title:m("group.youaremember")}),g=()=>{if(c)return"group.youareowner";if(e.type===ln.PRIVATE&&e.membershipType!==vt.MEMBER)return"";if(e.membershipType===vt.MEMBER)return"group.leave";if(e.membershipType===vt.NOT_MEMBER&&e.type===ln.REGULAR)return"group.join";if(e.membershipType===vt.REQUEST_PENDING)return"group.membershippending";if(e.membershipType===vt.NOT_MEMBER&&e.type===ln.EXCLUSIVE)return"group.requestmembership"},f=()=>{if(!(e.type===ln.PRIVATE&&e.membershipType===vt.NOT_MEMBER)){if(e.membershipType===vt.MEMBER){d();return}u()}},p=C=>{switch(C){case"members":sc(e.id);break;case"members_pending":sc(e.id,2);break;case"manage":Od(e.id);break;case"homeroom":_n(e.roomId);break;case"furniture":ee("catalog/open/"+mt.GUILD_CUSTOM_FURNI);break;case"popular_groups":ee("navigator/search/groups");break}};return e?l(se,{overflow:r,...s,children:[l(T,{center:!0,size:3,overflow:"hidden",children:[t(w,{alignItems:"center",overflow:"hidden",className:"group-badge",children:t(qe,{badgeCode:e.badge,isGroup:!0,scale:2})}),l(T,{alignItems:"center",gap:1,children:[t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>p("members"),children:m("group.membercount",["totalMembers"],[e.membersCount.toString()])}),e.pendingRequestsCount>0&&t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>p("members_pending"),children:m("group.pendingmembercount",["amount"],[e.pendingRequestsCount.toString()])}),e.isOwner&&t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>p("manage"),children:m("group.manage")})]}),h()]}),l(T,{size:9,justifyContent:"between",overflow:"auto",children:[l(T,{overflow:"hidden",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,children:e.title}),l(w,{gap:1,children:[t("i",{className:"icon icon-group-type-"+e.type,title:m(`group.edit.settings.type.${Ow[e.type]}.help`)}),e.canMembersDecorate&&t("i",{className:"icon icon-group-decorate",title:m("group.memberscandecorate")})]})]}),t(S,{small:!0,children:m("group.created",["date","owner"],[e.createdAt,e.ownerName])})]}),t(S,{small:!0,overflow:"auto",className:"group-description",children:e.description})]}),l(T,{children:[l(T,{gap:1,children:[t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>p("homeroom"),children:m("group.linktobase")}),t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>p("furniture"),children:m("group.buyfurni")}),t(S,{small:!0,underline:!0,pointer:!0,onClick:()=>p("popular_groups"),children:m("group.showgroups")})]}),(e.type!==ln.PRIVATE||e.type===ln.PRIVATE&&e.membershipType===vt.MEMBER)&&t(D,{disabled:e.membershipType===vt.REQUEST_PENDING||c,onClick:f,children:m(g())})]})]})]}):null},kw=o=>{const[e,n]=i.useState(null);return F(ta,r=>{const s=r.getParser();(e&&e.id===s.id||s.flag)&&n(s)}),e?l(oe,{className:"nitro-group-information-standalone",theme:"primary-slim",children:[t(ie,{headerText:m("group.window.title"),onCloseClick:r=>n(null)}),t(re,{children:t(Fm,{groupInformation:e,onClose:()=>n(null)})})]}):null},Aw=["regular","exclusive","private"],Pw=o=>{const{groupData:e=null,setGroupData:n=null,setCloseAction:r=null}=o,[s,a]=i.useState(e.groupState),[c,u]=i.useState(e.groupCanMembersDecorate),d=i.useCallback(()=>e?s===e.groupState&&c===e.groupCanMembersDecorate?!0:e.groupId<=0?(n(h=>{const g={...h};return g.groupState=s,g.groupCanMembersDecorate=c,g}),!0):(A(new yE(e.groupId,s,c?0:1)),!0):!1,[e,s,c,n]);return i.useEffect(()=>{a(e.groupState),u(e.groupCanMembersDecorate)},[e]),i.useEffect(()=>(r({action:d}),()=>r(null)),[r,d]),l(T,{overflow:"auto",children:[t(T,{children:Aw.map((h,g)=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"groupState",checked:s===g,onChange:f=>a(g)}),l(T,{gap:0,children:[l(w,{gap:1,children:[t("i",{className:`icon icon-group-type-${g}`}),t(S,{bold:!0,children:m(`group.edit.settings.type.${h}.label`)})]}),t(S,{children:m(`group.edit.settings.type.${h}.help`)})]})]},g))}),t(wS,{}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:c,onChange:h=>u(g=>!g)}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("group.edit.settings.rights.caption")}),t(S,{children:m("group.edit.settings.rights.members.help")})]})]})]})},Dw=[1,2,3,5],Mw=o=>{const[e,n]=i.useState(1),[r,s]=i.useState(null),[a,c]=i.useState(null),u=()=>{s(h=>(h&&h.action&&h.action(),null)),c(null)},d=h=>{r&&r.action&&r.action(),n(h)};return F(ta,h=>{const g=h.getParser();!a||a.groupId!==g.id||c(f=>{const p={...f};return p.groupName=g.title,p.groupDescription=g.description,p.groupState=g.type,p.groupCanMembersDecorate=g.canMembersDecorate,p})}),F(OE,h=>{const g=h.getParser(),f=[];g.badgeParts.forEach((p,C)=>{f.push(new Ho(p.isBase?Ho.BASE:Ho.SYMBOL,p.key,p.color,p.position))}),c({groupId:g.id,groupName:g.title,groupDescription:g.description,groupHomeroomId:g.roomId,groupState:g.state,groupCanMembersDecorate:g.canMembersDecorate,groupColors:[g.colorA,g.colorB],groupBadgeParts:f})}),!a||a.groupId<=0?null:l(oe,{className:"nitro-group-manager",children:[t(ie,{headerText:m("group.window.title"),onCloseClick:u}),t(lr,{children:Dw.map(h=>t(Mn,{isActive:e===h,onClick:()=>d(h),children:m(`group.edit.tab.${h}`)},h))}),l(re,{children:[l(w,{alignItems:"center",gap:2,children:[t(P,{className:`nitro-group-tab-image tab-${e}`}),l(T,{grow:!0,gap:0,children:[t(S,{bold:!0,fontSize:4,children:m(`group.edit.tabcaption.${e}`)}),t(S,{children:m(`group.edit.tabdesc.${e}`)})]})]}),l(T,{grow:!0,overflow:"hidden",children:[e===1&&t(xm,{groupData:a,setGroupData:c,setCloseAction:s,onClose:u}),e===2&&t(Lm,{groupData:a,setGroupData:c,setCloseAction:s,skipDefault:!0}),e===3&&t(Um,{groupData:a,setGroupData:c,setCloseAction:s}),e===5&&t(Pw,{groupData:a,setGroupData:c,setCloseAction:s})]})]})]})},Lw=o=>{const[e,n]=i.useState(-1),[r,s]=i.useState(-1),[a,c]=i.useState(null),[u,d]=i.useState(-1),[h,g]=i.useState(0),[f,p]=i.useState(""),[C,E]=i.useState(null),{showConfirm:_=null}=Je(),I=R=>{if(R.rank===Qt.OWNER)return"group.members.owner";if(a.admin){if(R.rank===Qt.ADMIN)return"group.members.removerights";if(R.rank===Qt.MEMBER)return"group.members.giverights"}return""},b=i.useCallback(()=>{e===-1||r===-1||u===-1||A(new xl(e,u,f,r))},[e,r,u,f]),N=R=>{!a.admin||R.rank===Qt.OWNER||(R.rank!==Qt.ADMIN?A(new PE(a.groupId,R.id)):A(new DE(a.groupId,R.id)),b())},v=R=>{!a.admin||R.rank!==Qt.REQUESTED||(A(new ME(a.groupId,R.id)),b())},O=R=>{if(a.admin){if(R.rank===Qt.REQUESTED){A(new LE(a.groupId,R.id)),b();return}E(R.name),A(new UE(a.groupId,R.id))}};return F(kE,R=>{const y=R.getParser();c(y),s(y.level),g(Math.ceil(y.totalMembersCount/y.pageSize))}),F(AE,R=>{const y=R.getParser();_(m(y.furnitureCount>0?"group.kickconfirm.desc":"group.kickconfirm_nofurni.desc",["user","amount"],[C,y.furnitureCount.toString()]),()=>{A(new Ki(a.groupId,y.userId)),b()},null),E(null)}),i.useEffect(()=>{const R={linkReceived:y=>{const G=y.split("/");if(G.length<2)return;const k=parseInt(G[1])||-1,B=parseInt(G[2])||3;n(k),s(B),d(0)},eventUrlPrefix:"group-members/"};return ut(R),()=>dt(R)},[]),i.useEffect(()=>{d(0)},[e,r,f]),i.useEffect(()=>{e===-1||r===-1||u===-1||A(new xl(e,u,f,r))},[e,r,u,f]),i.useEffect(()=>{e!==-1&&(s(-1),c(null),g(0),p(""),E(null))},[e]),e===-1||!a?null:l(oe,{className:"nitro-group-members",theme:"primary-slim",children:[t(ie,{headerText:m("group.members.title",["groupName"],[a?a.groupTitle:""]),onCloseClick:R=>n(-1)}),l(re,{overflow:"hidden",children:[l(w,{gap:2,children:[t(w,{center:!0,className:"group-badge",children:t(qe,{badgeCode:a.badge,isGroup:!0,className:"mx-auto d-block"})}),l(T,{fullWidth:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm w-100",placeholder:m("group.members.searchinfo"),value:f,onChange:R=>p(R.target.value)}),l("select",{className:"form-select form-select-sm w-100",value:r,onChange:R=>s(parseInt(R.target.value)),children:[t("option",{value:"0",children:m("group.members.search.all")}),t("option",{value:"1",children:m("group.members.search.admins")}),t("option",{value:"2",children:m("group.members.search.pending")})]})]})]}),t(se,{columnCount:2,overflow:"auto",className:"nitro-group-members-list-grid",children:a.result.map((R,y)=>l(w,{gap:2,alignItems:"center",overflow:"hidden",className:"member-list-item bg-white rounded p-2",children:[t("div",{className:"avatar-head cursor-pointer",onClick:()=>tn(R.id),children:t(ot,{figure:R.figure,headOnly:!0,direction:2})}),l(T,{grow:!0,gap:1,children:[t(S,{bold:!0,small:!0,pointer:!0,onClick:G=>tn(R.id),children:R.name}),R.rank!==Qt.REQUESTED&&t(S,{small:!0,italics:!0,variant:"muted",children:m("group.members.since",["date"],[R.joinedAt])})]}),l(T,{gap:1,children:[R.rank!==Qt.REQUESTED&&t(w,{center:!0,children:t(P,{pointer:a.admin,className:`icon icon-group-small-${R.rank===Qt.OWNER?"owner":R.rank===Qt.ADMIN?"admin":a.admin&&R.rank===Qt.MEMBER?"not-admin":""}`,title:m(I(R)),onClick:G=>N(R)})}),a.admin&&R.rank===Qt.REQUESTED&&t(w,{alignItems:"center",children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-accept",title:m("group.members.accept"),onClick:G=>v(R)})}),a.admin&&R.rank!==Qt.OWNER&&R.id!==q().userId&&t(w,{alignItems:"center",children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-deny",title:m(R.rank===Qt.REQUESTED?"group.members.reject":"group.members.kick"),onClick:G=>O(R)})})]})]},y))}),l(w,{gap:1,justifyContent:"between",alignItems:"center",children:[t(D,{disabled:a.pageIndex===0,onClick:R=>d(y=>y-1),children:t(Jt,{className:"fa-icon"})}),t(S,{small:!0,children:m("group.members.pageinfo",["amount","page","totalPages"],[a.totalMembersCount.toString(),(a.pageIndex+1).toString(),h.toString()])}),t(D,{disabled:a.pageIndex===h-1,onClick:R=>d(y=>y+1),children:t(Zt,{className:"fa-icon"})})]})]})]})},Uw=o=>{const[e,n]=i.useState(!1);return ua(),F(xE,r=>{const s=r.getParser();n(!1),_n(s.roomId)}),i.useEffect(()=>{const r={linkReceived:s=>{const a=s.split("/");if(!(a.length<2))switch(a[1]){case"create":n(!0);return;case"manage":if(!a[2])return;n(!1),A(new FE(Number(a[2])));return}},eventUrlPrefix:"groups/"};return ut(r),()=>dt(r)},[]),l(V,{children:[e&&t(yw,{onClose:()=>n(!1)}),!e&&t(Mw,{}),t(Lw,{}),t(kw,{})]})},xw=o=>{const{helpRequestDescription:e=null,helpRequestAverageTime:n=0}=o,r=s=>A(new BE(s));return l(T,{children:[l(T,{gap:0,className:"bg-muted p-2 rounded",children:[t(S,{bold:!0,children:m("guide.help.request.guide.accept.request.title")}),t(S,{variant:"muted",children:m("guide.help.request.type.1")}),t(S,{wrap:!0,textBreak:!0,children:e})]}),l(T,{gap:1,children:[t(D,{variant:"success",onClick:s=>r(!0),children:m("guide.help.request.guide.accept.accept.button")}),t(D,{variant:"danger",onClick:s=>r(!1),children:m("guide.help.request.guide.accept.skip.link")})]})]})},Fw=o=>{const{isOnDuty:e=!1,isHandlingGuideRequests:n=!1,setIsHandlingGuideRequests:r=null,isHandlingHelpRequests:s=!1,setIsHandlingHelpRequests:a=null,isHandlingBullyReports:c=!1,setIsHandlingBullyReports:u=null,guidesOnDuty:d=0,helpersOnDuty:h=0,guardiansOnDuty:g=0,processAction:f=null}=o;return l(T,{children:[l(w,{alignItems:"center",gap:2,className:"bg-muted p-2 rounded",children:[t(P,{className:"duty-switch"+(e?"":" off"),onClick:p=>f("toggle_duty")}),l(T,{gap:0,children:[t(S,{bold:!0,children:m("guide.help.guide.tool.yourstatus")}),t(S,{children:m(`guide.help.guide.tool.duty.${e?"on":"off"}`)})]})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("guide.help.guide.tool.tickettypeselection.caption")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:n,onChange:p=>r(p.target.checked)}),t(S,{children:m("guide.help.guide.tool.tickettypeselection.guiderequests")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:s,onChange:p=>a(p.target.checked)}),t(S,{children:m("guide.help.guide.tool.tickettypeselection.onlyhelprequests")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",disabled:e,type:"checkbox",checked:c,onChange:p=>u(p.target.checked)}),t(S,{children:m("guide.help.guide.tool.tickettypeselection.bullyreports")})]})]}),t("hr",{className:"bg-dark m-0"}),l(w,{center:!0,gap:2,children:[t(P,{className:"info-icon"}),l(T,{gap:1,children:[t(P,{dangerouslySetInnerHTML:{__html:m("guide.help.guide.tool.guidesonduty",["amount"],[d.toString()])}}),t(P,{dangerouslySetInnerHTML:{__html:m("guide.help.guide.tool.helpersonduty",["amount"],[h.toString()])}}),t(P,{dangerouslySetInnerHTML:{__html:m("guide.help.guide.tool.guardiansonduty",["amount"],[g.toString()])}})]})]}),t("hr",{className:"bg-dark m-0"}),l(w,{justifyContent:"between",gap:2,children:[t(D,{disabled:!0,onClick:p=>f("forum_link"),children:m("guide.help.guide.tool.forum.link")}),t(D,{disabled:!0,children:m("guide.help.guide.tool.skill.link")})]})]})},Bw=o=>{const e=i.useRef(null),{isGuide:n=!1,userId:r=0,userName:s=null,userFigure:a=null,isTyping:c=!1,messageGroups:u=[]}=o,[d,h]=i.useState("");i.useEffect(()=>{var I;(I=e.current)==null||I.scrollIntoView({block:"end",behavior:"smooth"})},[u]);const g=i.useCallback(()=>{A(new GE)},[]),f=i.useCallback(()=>{A(new VE)},[]),p=i.useCallback(()=>{A(new HE)},[]);F(WE,I=>{const b=I.getParser();_n(b.requesterRoomId)});const C=i.useCallback(()=>{!d||!d.length||(A(new jE(d)),h(""))},[d]),E=i.useCallback(I=>{I.key==="Enter"&&C()},[C]),_=i.useCallback(I=>I===q().userId,[]);return l(T,{fullHeight:!0,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[n&&l(nr,{children:[t(D,{onClick:g,children:m("guide.help.request.guide.ongoing.visit.button")}),t(D,{onClick:f,children:m("guide.help.request.guide.ongoing.invite.button")})]}),!n&&l(T,{gap:0,children:[t(S,{bold:!0,children:s}),t(S,{children:m("guide.help.request.user.ongoing.guide.desc")})]}),t(D,{variant:"danger",disabled:!0,children:m("guide.help.common.report.link")})]}),t(T,{overflow:"hidden",gap:1,className:"bg-muted rounded chat-messages p-2",children:l(T,{overflow:"auto",children:[u.map((I,b)=>l(w,{fullWidth:!0,justifyContent:_(I.userId)?"end":"start",gap:2,children:[t(P,{shrink:!0,className:"message-avatar",children:!_(I.userId)&&t(ot,{figure:a,direction:2})}),l(P,{className:"bg-light text-black border-radius mb-2 rounded py-1 px-2 messages-group-"+(_(I.userId)?"right":"left"),children:[l(S,{bold:!0,children:[_(I.userId)&&q().userName,!_(I.userId)&&s]}),I.messages.map((N,v)=>t(P,{pointer:!!N.roomId,className:N.roomId?"text-break text-underline":"text-break",onClick:()=>N.roomId?_n(N.roomId):null,children:N.message},v))]}),_(I.userId)&&t(P,{className:"message-avatar flex-shrink-0",children:t(ot,{figure:q().figure,direction:4})})]},b)),t("div",{ref:e})]})}),l(T,{gap:1,children:[l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:m("guide.help.request.guide.ongoing.input.empty",["name"],[s]),value:d,onChange:I=>h(I.target.value),onKeyDown:E}),t(D,{variant:"success",onClick:C,children:m("widgets.chatinput.say")})]}),c&&t(S,{variant:"muted",children:m("guide.help.common.typing")})]}),t(D,{fullWidth:!0,variant:"success",onClick:p,children:m("guide.help.request."+(n?"guide":"user")+".ongoing.close.link")})]})},Gw=15,Vw=o=>{const{userRequest:e="",setUserRequest:n=null}=o,[r,s]=i.useState(!1),a=()=>{s(!0),A(new qE(1,e))};return l(T,{children:[t(S,{children:m("guide.help.request.user.create.help")}),t("textarea",{className:"request-message",maxLength:140,value:e,onChange:c=>n(c.target.value),placeholder:m("guide.help.request.user.create.input.help")}),t(D,{fullWidth:!0,variant:"success",disabled:e.length<Gw||r,onClick:a,children:m("guide.help.request.user.create.input.button")})]})},Hw=o=>{const{userName:e=null}=o,n=r=>A(new zE(r));return l(T,{children:[l(w,{justifyContent:"between",gap:1,className:"bg-muted p-2 rounded",children:[l(T,{gap:0,children:[t(S,{bold:!0,children:e}),t(S,{children:m("guide.help.request.user.feedback.guide.desc")})]}),t(D,{variant:"danger",disabled:!0,children:m("guide.help.common.report.link")})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("guide.help.request.user.feedback.closed.title")}),t(S,{children:m("guide.help.request.user.feedback.closed.desc")})]}),e&&e.length>0&&l(V,{children:[t("hr",{className:"bg-dark m-0 mt-auto"}),l(T,{children:[t(S,{center:!0,bold:!0,children:m("guide.help.request.user.feedback.question")}),l(w,{gap:1,children:[t(D,{fullWidth:!0,variant:"success",onClick:r=>n(!0),children:m("guide.help.request.user.feedback.positive.button")}),t(D,{fullWidth:!0,variant:"danger",onClick:r=>n(!1),children:m("guide.help.request.user.feedback.negative.button")})]})]})]})]})},Ww=o=>l(T,{gap:1,children:[t(S,{bold:!0,children:m("guide.help.request.no_tour_guides.title")}),t(S,{children:m("guide.help.request.no_tour_guides.message")})]}),jw=o=>{const{helpRequestDescription:e=null,helpRequestAverageTime:n=0}=o,r=()=>A(new YE);return l(T,{children:[l(T,{gap:0,className:"bg-muted rounded p-2",children:[t(S,{bold:!0,children:m("guide.help.request.guide.accept.request.title")}),t(S,{variant:"muted",children:m("guide.help.request.type.1")}),t(S,{wrap:!0,textBreak:!0,children:e})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("guide.help.request.user.pending.info.title")}),t(S,{children:m("guide.help.request.user.pending.info.message")}),t(S,{children:m("guide.help.request.user.pending.info.waiting",["waitingtime"],[n.toString()])})]}),t(D,{variant:"danger",onClick:r,children:m("guide.help.request.user.pending.cancel.button")})]})},qw=o=>t(T,{gap:1,children:t(S,{children:m("guide.help.request.user.guide.disconnected.error.desc")})}),zw=o=>l(T,{gap:1,children:[t(S,{bold:!0,children:m("guide.help.request.user.thanks.info.title")}),t(S,{children:m("guide.help.request.user.thanks.info.desc")})]}),Yw=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(m("guide.help.guide.tool.title")),[a,c]=i.useState(!1),[u,d]=i.useState(ge.GUIDE_TOOL_MENU),[h,g]=i.useState(!1),[f,p]=i.useState(!1),[C,E]=i.useState(!1),[_,I]=i.useState(!1),[b,N]=i.useState(0),[v,O]=i.useState(0),[R,y]=i.useState(0),[G,k]=i.useState(""),[B,M]=i.useState(null),[U,W]=i.useState(0),[L,x]=i.useState(0),[j,H]=i.useState(null),[te,ne]=i.useState(null),[Ce,Me]=i.useState(!1),[Ze,tt]=i.useState([]),{simpleAlert:Ft=null}=Je(),je=i.useCallback((Ge,Ee)=>{switch(Ge){case ge.GUIDE_TOOL_MENU:s(m("guide.help.guide.tool.title")),c(!1);break;case ge.GUIDE_ACCEPT:s(m("guide.help.request.guide.accept.title")),c(!0);break;case ge.GUIDE_ONGOING:s(m("guide.help.request.guide.ongoing.title",["name"],[Ee])),c(!0);break;case ge.USER_CREATE:s(m("guide.help.request.user.create.title")),c(!1);break;case ge.USER_PENDING:s(m("guide.help.request.user.pending.title")),c(!0);break;case ge.USER_ONGOING:s(m("guide.help.request.user.ongoing.title",["name"],[Ee])),c(!0);break;case ge.USER_FEEDBACK:s(m("guide.help.request.user.feedback.title")),c(!0);break;case ge.USER_THANKS:s(m("guide.help.request.user.thanks.title")),c(!1);break;case ge.USER_NO_HELPERS:s(m("guide.help.request.no_tour_guides.heading")),c(!1);break;case ge.USER_SOMETHING_WRONG:s(m("guide.help.request.user.guide.disconnected.error.heading")),c(!1);break}d(Ge),n(!0)},[]),qt=i.useCallback(Ge=>{switch(Ge.type){case Vt.SHOW_GUIDE_TOOL:n(!0);return;case Vt.HIDE_GUIDE_TOOL:n(!1);return;case Vt.TOGGLE_GUIDE_TOOL:n(Ee=>!Ee);return;case Vt.CREATE_HELP_REQUEST:je(ge.USER_CREATE);return}},[je]);lt(Vt.SHOW_GUIDE_TOOL,qt),lt(Vt.HIDE_GUIDE_TOOL,qt),lt(Vt.TOGGLE_GUIDE_TOOL,qt),lt(Vt.CREATE_HELP_REQUEST,qt),F(Zu,Ge=>{!Ge.getParser().isAllowed(Ju.USE_GUIDE_TOOL)&&h&&(g(!1),A(new Fl(!1,!1,!1,!1)))}),F($E,Ge=>{const Ee=Ge.getParser();g(Ee.onDuty),O(Ee.guidesOnDuty),N(Ee.helpersOnDuty),y(Ee.guardiansOnDuty)}),F(KE,Ge=>{const Ee=Ge.getParser();M(Ee.helpRequestDescription),W(Ee.roleSpecificWaitTime),Ee.asGuide&&h&&je(ge.GUIDE_ACCEPT),Ee.asGuide||je(ge.USER_PENDING)}),F(XE,Ge=>{const Ee=Ge.getParser();h?(x(Ee.requesterUserId),H(Ee.requesterName),ne(Ee.requesterFigure),je(ge.GUIDE_ONGOING,Ee.requesterName)):(x(Ee.guideUserId),H(Ee.guideName),ne(Ee.guideFigure),je(ge.USER_ONGOING,Ee.guideName))}),F(QE,Ge=>{const Ee=Ge.getParser();Me(Ee.isTyping)}),F(JE,Ge=>{const Ee=Ge.getParser(),$e=[...Ze];let Ot=$e[$e.length-1];(!Ot||Ot.userId!==Ee.senderId)&&(Ot=new oc(Ee.senderId),$e.push(Ot)),Ot.addChat(new ac(Ee.chatMessage)),tt($e)}),F(ZE,Ge=>{const Ee=Ge.getParser();if(Ee.roomId!==0){const $e=[...Ze];let Ot=$e[$e.length-1];const me=h?q().userId:L;(!Ot||Ot.userId!==me)&&(Ot=new oc(me),$e.push(Ot)),Ot.addChat(new ac(Ee.roomName,Ee.roomId)),tt($e)}}),F(eC,Ge=>{h?(x(0),H(null),ne(null),Me(!1),tt([]),je(ge.GUIDE_TOOL_MENU)):je(ge.USER_FEEDBACK)}),F(tC,Ge=>{switch(Ge.getParser().errorCode){case 0:je(ge.USER_SOMETHING_WRONG);break;case 1:case 2:je(ge.USER_NO_HELPERS);break}}),F(nC,Ge=>{x(0),H(null),ne(null),Me(!1),tt([]),je(h?ge.GUIDE_TOOL_MENU:ge.USER_THANKS)}),i.useEffect(()=>{const Ge={linkReceived:Ee=>{const $e=Ee.split("/");if(!($e.length<2))switch($e[1]){case"tour":return}},eventUrlPrefix:"help/"};return ut(Ge),()=>dt(Ge)},[]);const Tn=i.useCallback(Ge=>{switch(Ge){case"close":n(!1),k(""),d(ge.GUIDE_TOOL_MENU);return;case"toggle_duty":if(!f&&!C&&!_){Ft(m("guide.help.guide.tool.noqueueselected.message"),null,null,null,m("guide.help.guide.tool.noqueueselected.caption"),null);return}g($e=>(A(new Fl(!$e,$e?!1:C,$e?!1:_,$e?!1:f)),!$e));return;case"forum_link":const Ee=K("group.homepage.url","").replace("%groupid%",K("guide.help.alpha.groupid","0"));window.open(Ee);return}},[f,C,_,Ft]);return e?l(oe,{className:"nitro-guide-tool",theme:"primary-slim",children:[t(ie,{headerText:r,onCloseClick:Ge=>Tn("close"),noCloseButton:a}),l(re,{className:"text-black",children:[u===ge.GUIDE_TOOL_MENU&&t(Fw,{isOnDuty:h,isHandlingGuideRequests:C,setIsHandlingGuideRequests:E,isHandlingHelpRequests:_,setIsHandlingHelpRequests:I,isHandlingBullyReports:f,setIsHandlingBullyReports:p,guidesOnDuty:v,helpersOnDuty:b,guardiansOnDuty:R,processAction:Tn}),u===ge.GUIDE_ACCEPT&&t(xw,{helpRequestDescription:B,helpRequestAverageTime:U}),[ge.GUIDE_ONGOING,ge.USER_ONGOING].includes(u)&&t(Bw,{isGuide:h,userId:L,userName:j,userFigure:te,isTyping:Ce,messageGroups:Ze}),u===ge.USER_CREATE&&t(Vw,{userRequest:G,setUserRequest:k}),u===ge.USER_PENDING&&t(jw,{helpRequestDescription:B,helpRequestAverageTime:U}),u===ge.USER_FEEDBACK&&t(Hw,{userName:j}),u===ge.USER_THANKS&&t(zw,{}),u===ge.USER_NO_HELPERS&&t(Ww,{}),u===ge.USER_SOMETHING_WRONG&&t(qw,{})]})]}):null},$w=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(null),[a,c]=i.useState(0),[u,d]=i.useState(null),{userFigure:h=null}=Yn(),{purse:g=null,clubStatus:f=null}=es(),{badgeCodes:p=[],activate:C=null,deactivate:E=null}=wo(),_=()=>g.clubDays<=0?m("purse.clubdays.zero.amount.text"):g.minutesUntilExpiration>-1&&g.minutesUntilExpiration<60*24?jn.shortFormat(g.minutesUntilExpiration*60):jn.shortFormat((g.clubPeriods*31+g.clubDays)*86400),I=()=>{switch(f){case Hn.ACTIVE:return m(`hccenter.status.${f}.info`,["timeleft","joindate","streakduration"],[_(),r==null?void 0:r.firstSubscriptionDate,jn.shortFormat((r==null?void 0:r.currentHcStreak)*86400)]);case Hn.EXPIRED:return m(`hccenter.status.${f}.info`,["joindate"],[r==null?void 0:r.firstSubscriptionDate]);default:return m(`hccenter.status.${f}.info`)}},b=()=>!r||r.timeUntilPayday<60?m("hccenter.special.time.soon"):jn.shortFormat(r.timeUntilPayday*60),N=()=>m("hccenter.special.sum",["credits"],[((r==null?void 0:r.creditRewardForStreakBonus)+(r==null?void 0:r.creditRewardForMonthlySpent)).toString()]);if(F(Pu,O=>{const R=O.getParser();c(R.giftsAvailable)}),F(rC,O=>{const R=O.getParser();s(R.data)}),i.useEffect(()=>{const O={linkReceived:R=>{const y=R.split("/");if(!(y.length<2))switch(y[1]){case"open":if(y.length>2)switch(y[2]){case"hccenter":n(!0);break}return}},eventUrlPrefix:"habboUI/"};return ut(O),()=>dt(O)},[]),i.useEffect(()=>{d(Kb(p))},[p]),i.useEffect(()=>{if(!e)return;const O=C();return()=>E(O)},[e,C,E]),i.useEffect(()=>{A(new Du),A(new sC)},[]),!e)return null;const v=t(ps,{id:"popover-basic",children:l(ps.Body,{className:"text-black py-2 px-3",children:[t("h5",{children:m("hccenter.breakdown.title")}),t("div",{children:m("hccenter.breakdown.creditsspent",["credits"],[r==null?void 0:r.totalCreditsSpent.toString()])}),t("div",{children:m("hccenter.breakdown.paydayfactor.percent",["percent"],[((r==null?void 0:r.kickbackPercentage)*100).toString()])}),t("div",{children:m("hccenter.breakdown.streakbonus",["credits"],[r==null?void 0:r.creditRewardForStreakBonus.toString()])}),t("hr",{className:"w-100 text-black my-1"}),t("div",{children:m("hccenter.breakdown.total",["credits","actual"],[N(),(((r==null?void 0:r.kickbackPercentage)*(r==null?void 0:r.totalCreditsSpent)+(r==null?void 0:r.creditRewardForStreakBonus))*100/100).toString()])}),t("div",{className:"btn btn-link text-primary p-0",onClick:()=>ee("habbopages/"+K("hc.center")["payday.habbopage"]),children:m("hccenter.special.infolink")})]})});return l(oe,{theme:"primary-slim",className:"nitro-hc-center",children:[t(ie,{headerText:m("generic.hccenter"),onCloseClick:()=>n(!1)}),l(w,{position:"relative",className:"bg-muted p-2",children:[l(T,{gap:1,children:[t("div",{className:"hc-logo"}),t(w,{children:t(D,{variant:"success",onClick:O=>ee("catalog/open/"+K("catalog.links")["hc.buy_hc"]),children:m(f===Hn.ACTIVE?"hccenter.btn.extend":"hccenter.btn.buy")})})]}),t(P,{position:"absolute",className:"end-0 p-4 top-0 habbo-avatar",children:t(ot,{figure:h,direction:4,scale:2})})]}),l(re,{children:[l(w,{gap:2,children:[t(qe,{badgeCode:u,className:"align-self-center flex-shrink-0 me-1"}),l(T,{size:5,className:"streak-info",gap:0,children:[t(S,{children:m("hccenter.status."+f)}),t(S,{dangerouslySetInnerHTML:{__html:I()}})]})]}),K("hc.center")["payday.info"]&&l(w,{alignItems:"center",children:[l(T,{className:"rounded-start bg-primary p-2 payday-special mb-1",children:[t("h4",{className:"mb-1",children:m("hccenter.special.title")}),t("div",{children:m("hccenter.special.info")}),t("div",{className:"btn btn-link text-white p-0 mt-auto align-self-baseline",onClick:()=>ee("habbopages/"+K("hc.center")["payday.habbopage"]),children:m("hccenter.special.infolink")})]}),l("div",{className:"payday flex-shrink-0 p-2",children:[t("h5",{className:"mb-2 ms-2",children:m("hccenter.special.time.title")}),l("div",{className:"d-flex flex-row mb-2",children:[t("div",{className:"clock me-2"}),t("h6",{className:"mb-0 align-self-center",children:b()})]}),f===Hn.ACTIVE&&l("div",{className:"pe-3",children:[t("h5",{className:"ms-2 mb-1 bolder",children:m("hccenter.special.amount.title")}),l("div",{className:"d-flex flex-column",children:[t("div",{className:"w-100 text-center ms-4n",children:N()}),t(vu,{trigger:["hover","focus"],placement:"left",overlay:v,children:t("div",{className:"btn btn-link align-self-end text-primary",children:m("hccenter.breakdown.infolink")})})]})]})]})]}),K("hc.center")["gift.info"]&&l("div",{className:"rounded bg-success p-2 d-flex flex-row mb-0",children:[l("div",{children:[t("h4",{className:"mb-1",children:m("hccenter.gift.title")}),t("div",{dangerouslySetInnerHTML:{__html:a>0?m("hccenter.unclaimedgifts",["unclaimedgifts"],[a.toString()]):m("hccenter.gift.info")}})]}),t("button",{className:"btn btn-primary btn-lg align-self-center ms-auto",onClick:()=>ee("catalog/open/"+K("catalog.links")["hc.hc_gifts"]),children:m(f===Hn.ACTIVE?"hccenter.btn.gifts.redeem":"hccenter.btn.gifts.view")})]}),K("hc.center")["benefits.info"]&&l("div",{className:"benefits text-black py-2",children:[t("h5",{className:"mb-1 text-primary",children:m("hccenter.general.title")}),t("div",{className:"mb-2",dangerouslySetInnerHTML:{__html:m("hccenter.general.info")}}),t("button",{className:"btn btn-link p-0 text-primary",onClick:()=>ee("habbopages/"+K("hc.center")["benefits.habbopage"]),children:m("hccenter.general.infolink")})]})]})]})},Kw=o=>{const[e,n]=i.useState(""),{activeReport:r=null,setActiveReport:s=null}=Un(),a=()=>{e.length<15||s(u=>{const d=Pt.REPORT_SUMMARY;return{...u,message:e,currentStep:d}})},c=()=>{s(u=>({...u,currentStep:u.currentStep-1}))};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:m("help.emergency.chat_report.subtitle")}),t(S,{children:m("help.cfh.input.text")})]}),t("textarea",{className:"form-control h-100",value:e,onChange:u=>n(u.target.value)}),l(w,{gap:2,justifyContent:"between",children:[t(D,{variant:"secondary",disabled:!(r.reportType===He.BULLY||r.reportType===He.EMERGENCY),onClick:c,children:m("generic.back")}),t(D,{disabled:e.length<15,onClick:a,children:m("help.emergency.main.submit.button")})]})]})},Xw=o=>{const{setActiveReport:e=null}=Un(),n=()=>{e(r=>{const s=Pt.SELECT_USER,a=He.BULLY;return{...r,currentStep:s,reportType:a}})};return l(V,{children:[l(T,{grow:!0,center:!0,gap:1,children:[t(S,{fontSize:3,children:m("help.main.frame.title")}),t(S,{children:m("help.main.self.description")})]}),l(T,{gap:1,children:[t(D,{onClick:n,children:m("help.main.bully.subtitle")}),t(D,{onClick:()=>St(new Vt(Vt.CREATE_HELP_REQUEST)),disabled:!K("guides.enabled"),children:m("help.main.help.title")}),t(D,{disabled:!0,children:m("help.main.self.tips.title")})]}),t(D,{variant:"link",textColor:"black",onClick:()=>A(new aC(!1)),children:m("help.main.my.sanction.status")})]})},Qw=o=>{const{username:e="",onAction:n=null}=o,[r,s]=i.useState(!1),a=()=>{r||(s(!0),A(new iC(e)))};return F(oC,c=>{const u=c.getParser();u&&u.webId===q().userId&&n("close")}),l("div",{className:"d-flex flex-column gap-4 h-100",children:[t("div",{className:"bg-muted rounded p-2 text-center",children:m("tutorial.name_change.info.confirm")}),l("div",{className:"d-flex flex-column align-items-center gap-1 h-100",children:[t("div",{children:m("tutorial.name_change.confirm")}),t("div",{className:"fw-bold",children:e})]}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",disabled:r,onClick:a,children:m("generic.ok")}),t("button",{className:"btn btn-primary w-100",onClick:()=>n("close"),children:m("cancel")})]})]})},Jw=o=>{const{onAction:e=null}=o;return l("div",{className:"d-flex flex-column gap-4 h-100",children:[t("div",{className:"bg-muted rounded p-2 text-center",children:m("tutorial.name_change.info.main")}),t("div",{className:"fw-bold d-flex align-items-center justify-content-center h-100 w-100",children:m("tutorial.name_change.current",["name"],[q().userName])}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",onClick:()=>e("start"),children:m("tutorial.name_change.change")}),t("button",{className:"btn btn-primary w-100",onClick:()=>e("confirmation",q().userName),children:m("tutorial.name_change.keep")})]})]})},Zw=0,eR=2,tR=3,nR=4,rR=5,sR=6,aR=o=>{const{onAction:e=null}=o,[n,r]=i.useState(""),[s,a]=i.useState(!1),[c,u]=i.useState(!1),[d,h]=i.useState(null),[g,f]=i.useState([]),p=()=>{n!==""&&(a(!1),f([]),h(null),u(!0),A(new cC(n)))},C=E=>{a(!1),f([]),h(null),r(E)};return F(lC,E=>{u(!1);const _=E.getParser();if(_)switch(_.resultCode){case Zw:a(!0);break;case eR:h("short");break;case tR:h("long");break;case nR:h("invalid");break;case rR:f(_.nameSuggestions),h("taken");break;case sR:h("change_not_allowed")}}),l("div",{className:"d-flex flex-column gap-3 h-100",children:[t("div",{children:m("tutorial.name_change.info.select")}),l("div",{className:"d-flex gap-2",children:[t("input",{type:"text",className:"form-control form-control-sm",value:n,onChange:E=>C(E.target.value)}),t("button",{className:"btn btn-primary",disabled:n===""||c,onClick:p,children:m("tutorial.name_change.check")})]}),!d&&!s&&t("div",{className:"bg-muted rounded p-2 text-center",children:m("help.tutorial.name.info")}),d&&t("div",{className:"bg-danger rounded p-2 text-center text-white",children:m(`help.tutorial.name.${d}`,["name"],[n])}),s&&t("div",{className:"bg-success rounded p-2 text-center text-white",children:m("help.tutorial.name.available",["name"],[n])}),g&&t("div",{className:"d-flex flex-column gap-2",children:g.map((E,_)=>t("div",{className:"col bg-muted rounded p-1 cursor-pointer",onClick:()=>C(E),children:E},_))}),l("div",{className:"d-flex gap-2",children:[t("button",{className:"btn btn-success w-100",disabled:!s,onClick:()=>e("confirmation",n),children:m("tutorial.name_change.pick")}),t("button",{className:"btn btn-primary w-100",onClick:()=>e("close"),children:m("cancel")})]})]})},Ma="INIT",ei="INPUT",ti="CONFIRMATION",oR=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(Ma),[a,c]=i.useState(""),u=(h,g)=>{switch(h){case"start":s(ei);break;case"confirmation":c(g),s(ti);break;case"close":c(""),n(!1);break}},d=i.useMemo(()=>{switch(r){case Ma:return"tutorial.name_change.title.main";case ei:return"tutorial.name_change.title.select";case ti:return"tutorial.name_change.title.confirm"}},[r]);return lt(so.INIT,h=>{s(Ma),n(!0)}),e?l(oe,{className:"nitro-change-username",theme:"primary-slim",children:[t(ie,{headerText:m(d),onCloseClick:()=>u("close")}),l(re,{className:"text-black",children:[r===Ma&&t(Jw,{onAction:u}),r===ei&&t(aR,{onAction:u}),r===ti&&t(Qw,{username:a,onAction:u})]})]}):null},iR=o=>{const{activeReport:e=null,setActiveReport:n=null}=Un(),r=()=>{const s=[];switch(e.reportType){case He.BULLY:case He.EMERGENCY:case He.ROOM:{const a=e.roomId<=0?e.reportedChats[0].roomId:e.roomId;e.reportedChats.forEach(c=>s.push(c.webId,c.message)),A(new hC(e.message,e.cfhTopic,e.reportedUserId,a,s));break}case He.IM:e.reportedChats.forEach(a=>s.push(a.webId,a.message)),A(new gC(e.message,e.cfhTopic,e.reportedUserId,s));break;case He.THREAD:A(new mC(e.groupId,e.threadId,e.cfhTopic,e.message));break;case He.MESSAGE:A(new dC(e.groupId,e.threadId,e.messageId,e.cfhTopic,e.message));break;case He.PHOTO:A(new uC(e.extraData,e.roomId,e.reportedUserId,e.cfhTopic,e.roomObjectId));break}n(null)};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:m("help.cfh.button.send")}),t(S,{children:m("help.main.summary")})]}),t(D,{variant:"success",onClick:r,children:m("guide.help.request.emergency.submit.button")})]})},lR=o=>{const{sanctionInfo:e=null,setSanctionInfo:n=null}=Un(),r=(s,a,c)=>{let u=`help.sanction.${s}`;switch(a){case"ALERT":u=u+".alert";break;case"MUTE":u=u+".mute";break;case"BAN_PERMANENT":u=u+".permban";break;default:if(u=u+".ban",c>24)return u=u+".days",m(u,["days"],[(c/24).toString()])}return m(u,["hours"],[c.toString()])};return e?l(oe,{className:"nitro-help",theme:"primary-slim",children:[t(ie,{headerText:m("help.sanction.info.title"),onCloseClick:()=>n(null)}),t(re,{className:"text-black",children:l(se,{children:[t(T,{center:!0,size:5,overflow:"hidden",children:t(P,{className:"index-image"})}),l(T,{justifyContent:"between",size:7,overflow:"hidden",children:[e.sanctionReason==="cfh.reason.EMPTY"?t("div",{className:"col-12 fw-bold",children:m("help.sanction.current.none")}):l(V,{children:[(e.probationHoursLeft>0||e.isSanctionActive)&&t("div",{className:"col-12 fw-bold",children:m("help.sanction.probation.reminder")}),l("div",{className:`col-12 fw-bold ${e.isSanctionNew?"text-danger":""}`,children:[m("help.sanction.last.sanction")," ",r("current",e.sanctionName,e.sanctionLengthHours)]}),l("div",{className:"col-12",children:[m("generic.start.time")," ",e.sanctionCreationTime]}),l("div",{className:"col-12",children:[m("generic.reason")," ",e.sanctionReason]}),l("div",{className:"col-12",children:[m("help.sanction.probation.days.left")," ",Math.trunc(e.probationHoursLeft/24)+1]})]}),e.hasCustomMute&&!e.isSanctionActive&&t("div",{className:"col-12 fw-bold",children:m("help.sanction.custom.mute")}),e.tradeLockExpiryTime&&e.tradeLockExpiryTime.length>0&&l("div",{className:"col-12 fw-bold",children:[m("trade.locked.until")," ",e.tradeLockExpiryTime]}),t("div",{className:"col-12",children:r("next",e.nextSanctionName,e.nextSanctionLengthHours)}),t(D,{variant:"success",onClick:s=>n(null),children:m("habbo.way.ok.button")})]})]})})]}):null},cR=o=>{const[e,n]=i.useState([]),{activeReport:r=null,setActiveReport:s=null}=Un(),{chatHistory:a=[],messengerHistory:c=[]}=No(),u=i.useMemo(()=>{switch(r.reportType){case He.BULLY:case He.EMERGENCY:return a.filter(f=>f.type===Dn.TYPE_CHAT&&f.webId===r.reportedUserId&&f.entityType===pt.USER);case He.IM:return c.filter(f=>f.webId===r.reportedUserId&&f.type===Dn.TYPE_IM)}return[]},[r,a,c]),d=f=>{n(p=>{const C=[...p],E=C.indexOf(f);return E>=0?C.splice(E,1):C.push(f),C})},h=()=>{!e||e.length<=0||s(f=>({...f,reportedChats:e,currentStep:Pt.SELECT_TOPICS}))},g=()=>{s(f=>({...f,currentStep:f.currentStep-1}))};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:m("help.emergency.chat_report.subtitle")}),t(S,{children:m("help.emergency.chat_report.description")})]}),l(T,{gap:1,overflow:"hidden",children:[!u||!u.length&&t(S,{children:m("help.cfh.error.no_user_data")}),u.length>0&&t(ke,{gap:1,columnCount:1,columnMinHeight:25,overflow:"auto",children:u.map((f,p)=>t(Ie,{onClick:C=>d(f),itemActive:e.indexOf(f)>=0,children:t(S,{children:f.message})},f.id))})]}),l(w,{gap:2,justifyContent:"between",children:[t(D,{variant:"secondary",onClick:g,disabled:r.reportType===He.IM,children:m("generic.back")}),t(D,{disabled:e.length<=0,onClick:h,children:m("help.emergency.main.submit.button")})]})]})},uR=o=>{const[e,n]=i.useState(-1),{chatHistory:r=[]}=No(),{activeReport:s=null,setActiveReport:a=null}=Un(),c=i.useMemo(()=>{const g=new Map;return r.forEach(f=>{f.type===Dn.TYPE_CHAT&&f.entityType===pt.USER&&f.webId!==q().userId&&!g.has(f.webId)&&g.set(f.webId,{id:f.webId,username:f.name})}),Array.from(g.values())},[r]),u=g=>{g<=0||a(f=>({...f,reportedUserId:g,currentStep:Pt.SELECT_CHATS}))},d=g=>{n(f=>g===f?-1:g)},h=()=>{a(g=>({...g,currentStep:g.currentStep-1}))};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:m("help.emergency.main.step.two.title")}),c.length>0&&t(S,{children:m("report.user.pick.user")})]}),l(T,{gap:1,overflow:"hidden",children:[!c.length&&t(S,{children:m("report.user.error.nolist")}),c.length>0&&t(ke,{columnCount:1,columnMinHeight:25,gap:1,children:c.map((g,f)=>t(Ie,{onClick:p=>d(g.id),itemActive:e===g.id,children:t("span",{dangerouslySetInnerHTML:{__html:g.username}})},g.id))})]}),l(w,{gap:2,justifyContent:"between",children:[t(D,{variant:"secondary",onClick:h,children:m("generic.back")}),t(D,{disabled:e<=0,onClick:()=>u(e),children:m("help.emergency.main.submit.button")})]})]})},dR=o=>{const[e,n]=i.useState(-1),[r,s]=i.useState(-1),{setActiveReport:a=null}=Un(),{cfhCategories:c=[]}=ys(),u=()=>{e<0||r<0||a(h=>({...h,cfhCategory:e,cfhTopic:c[e].topics[r].id,currentStep:Pt.INPUT_REPORT_MESSAGE}))},d=()=>{a(h=>({...h,currentStep:h.currentStep-1}))};return l(V,{children:[l(T,{gap:1,children:[t(S,{fontSize:4,children:m("help.emergency.chat_report.subtitle")}),t(S,{children:m("help.cfh.pick.topic")})]}),l(T,{gap:1,overflow:"auto",children:[e<0&&c.map((h,g)=>t(D,{variant:"danger",onClick:f=>n(g),children:m(`help.cfh.reason.${h.name}`)},g)),e>=0&&c[e].topics.map((h,g)=>t(D,{variant:"danger",onClick:f=>s(g),active:r===g,children:m(`help.cfh.topic.${h.id}`)},g))]}),l(w,{gap:2,justifyContent:"between",children:[t(D,{variant:"secondary",onClick:d,children:m("generic.back")}),t(D,{disabled:r<0,onClick:u,children:m("help.emergency.main.submit.button")})]})]})},mR=o=>{const[e,n]=i.useState(!1),{activeReport:r=null,setActiveReport:s=null,report:a=null}=Un(),c=()=>{s(null),n(!1)};i.useEffect(()=>{const d={linkReceived:h=>{const g=h.split("/");if(!(g.length<2))switch(g[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(f=>!f);return;case"tour":return;case"report":g.length>=5&&g[2]==="room"&&(parseInt(g[3]),unescape(g.splice(4).join("/")));return}},eventUrlPrefix:"help/"};return ut(d),()=>dt(d)},[]),i.useEffect(()=>{r&&n(!0)},[r]);const u=()=>{if(r)switch(r.currentStep){case Pt.SELECT_USER:return t(uR,{});case Pt.SELECT_CHATS:return t(cR,{});case Pt.SELECT_TOPICS:return t(dR,{});case Pt.INPUT_REPORT_MESSAGE:return t(Kw,{});case Pt.REPORT_SUMMARY:return t(iR,{})}return t(Xw,{})};return l(V,{children:[e&&l(oe,{className:"nitro-help",theme:"primary-slim",children:[t(ie,{headerText:m("help.button.cfh"),onCloseClick:c}),t(re,{className:"text-black",children:l(se,{children:[t(T,{center:!0,size:5,overflow:"hidden",children:t(P,{className:"index-image"})}),t(T,{justifyContent:"between",size:7,overflow:"hidden",children:t(u,{})})]})})]}),t(lR,{}),t(oR,{})]})},gR=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(null),[a,c]=i.useState(null),[u,d]=i.useState(null);return F(fC,h=>{const g=h.getParser();n(g.productType),s(g.productClassId),c(g.totalCoinsForBonus),d(g.coinsStillRequiredToBuy)}),i.useEffect(()=>{A(new pC)},[]),e?l("div",{className:"bonus-rare widget d-flex",children:[e,l("div",{className:"bg-light-dark rounded overflow-hidden position-relative bonus-bar-container",children:[t("div",{className:"d-flex justify-content-center align-items-center w-100 h-100 position-absolute small top-0",children:a-u+"/"+a}),t("div",{className:"small bg-info rounded position-absolute top-0 h-100",style:{width:(a-u)/a*100+"%"}})]})]}):null},hR=o=>{const{data:e=null,level:n=0}=o;return l("div",{className:"hof-user-container",children:[l("div",{className:"hof-tooltip",children:[l("div",{className:"hof-header",children:[n,". ",e.userName," ",t(bn,{userId:e.userId})]}),t("div",{className:"small text-center text-white",children:m("landing.view.competition.hof.points",["points"],[Qa(e.currentScore).toString()])})]}),t(ot,{figure:e.figure,direction:2})]})},fR=o=>{const{slot:e=-1,conf:n=null}=o,[r,s]=i.useState(null);return F(IC,a=>{const c=a.getParser();s(c.data)}),i.useEffect(()=>{const a=n?n.campaign:"";A(new EC(a))},[n]),r?t("div",{className:"hall-of-fame d-flex",children:r.hof&&r.hof.length>0&&r.hof.map((a,c)=>t(hR,{data:a,level:c+1},c))}):null},pR=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(0);return F(CC,a=>{const c=a.getParser();n(c.articles)}),i.useEffect(()=>{A(new _C)},[]),e?l("div",{className:"promo-articles widget mb-2",children:[l("div",{className:"d-flex flex-row align-items-center w-100 mb-1",children:[t("small",{className:"flex-shrink-0 pe-1",children:m("landing.view.promo.article.header")}),t("hr",{className:"w-100 my-0"})]}),t("div",{className:"d-flex flex-row mb-1",children:e&&e.length>0&&e.map((a,c)=>t("div",{className:"promo-articles-bullet cursor-pointer "+(a===e[r]?"promo-articles-bullet-active":""),onClick:u=>s(c)},a.id))}),e&&e[r]&&l("div",{className:"promo-article d-flex flex-row row mx-0",children:[t("div",{className:"promo-article-image",style:{backgroundImage:`url(${e[r].imageUrl})`}}),l("div",{className:"col-3 d-flex flex-column h-100",children:[t("h3",{className:"my-0",children:e[r].title}),t("b",{children:e[r].bodyText}),t("button",{className:"btn btn-sm mt-auto btn-gainsboro",onClick:a=>Xr(e[r].linkContent),children:e[r].buttonText})]})]})]}):null},IR=o=>{const{conf:e=null}=o,n=r=>{const s=e[r];if(!s)return null;switch(r){case"image":return hr.interpolate(s)}return s};return l("div",{className:"widgetcontainer widget d-flex flex-row overflow-hidden",children:[t("div",{className:"widgetcontainer-image flex-shrink-0",style:{backgroundImage:`url(${n("image")})`}}),l("div",{className:"d-flex flex-column align-self-center",children:[t("h3",{className:"my-0",children:m(`landing.view.${n("texts")}.header`)}),t("i",{children:m(`landing.view.${n("texts")}.body`)}),t("button",{className:"btn btn-sm btn-gainsboro align-self-start px-3 mt-auto",onClick:r=>Xr(n("btnLink")),children:m(`landing.view.${n("texts")}.button`)})]})]})},ER=o=>{switch(o.widgetType){case"promoarticle":return t(pR,{});case"achievementcompetition_hall_of_fame":return t(fR,{slot:o.slot,conf:o.widgetConf});case"bonusrare":return t(gR,{});case"widgetcontainer":return t(IR,{conf:o.widgetConf});default:return null}},Vr=o=>{const{widgetType:e=null,widgetSlot:n=0,widgetConf:r=null,className:s="",...a}=o;return t("div",{className:`widget-slot slot-${n} ${s||""}`,...a,children:t(ER,{widgetType:e,slot:n,widgetConf:r})})},CR=o=>{const[e,n]=i.useState(!0),{userFigure:r=null}=Yn();if(Ye([jt.CREATED,jt.ENDED],f=>{switch(f.type){case jt.CREATED:n(!1);return;case jt.ENDED:n(f.openLandingView);return}}),!e)return null;const s=K("hotelview").images["background.colour"],a=hr.interpolate(K("hotelview").images.background),c=hr.interpolate(K("hotelview").images.sun),u=hr.interpolate(K("hotelview").images.drape),d=hr.interpolate(K("hotelview").images.left),h=hr.interpolate(K("hotelview").images["right.repeat"]),g=hr.interpolate(K("hotelview").images.right);return l("div",{className:"nitro-hotel-view",style:s&&s?{background:s}:{},children:[t("div",{className:"container h-100 py-3 overflow-hidden landing-widgets",children:l("div",{className:"row h-100",children:[l("div",{className:"col-9 h-100 d-flex flex-column",children:[t(Vr,{widgetSlot:1,widgetType:K("hotelview").widgets["slot.1.widget"],widgetConf:K("hotelview").widgets["slot.1.conf"],className:"col-6"}),l("div",{className:"col-12 row mx-0",children:[t(Vr,{widgetSlot:2,widgetType:K("hotelview").widgets["slot.2.widget"],widgetConf:K("hotelview").widgets["slot.2.conf"],className:"col-7"}),t(Vr,{widgetSlot:3,widgetType:K("hotelview").widgets["slot.3.widget"],widgetConf:K("hotelview").widgets["slot.3.conf"],className:"col-5"}),t(Vr,{widgetSlot:4,widgetType:K("hotelview").widgets["slot.4.widget"],widgetConf:K("hotelview").widgets["slot.4.conf"],className:"col-7"}),t(Vr,{widgetSlot:5,widgetType:K("hotelview").widgets["slot.5.widget"],widgetConf:K("hotelview").widgets["slot.5.conf"],className:"col-5"})]}),t(Vr,{widgetSlot:6,widgetType:K("hotelview").widgets["slot.6.widget"],widgetConf:K("hotelview").widgets["slot.6.conf"],className:"mt-auto"})]}),t("div",{className:"col-3 h-100",children:t(Vr,{widgetSlot:7,widgetType:K("hotelview").widgets["slot.7.widget"],widgetConf:K("hotelview").widgets["slot.7.conf"]})})]})}),t("div",{className:"background position-absolute",style:a&&a.length?{backgroundImage:`url(${a})`}:{}}),t("div",{className:"sun position-absolute",style:c&&c.length?{backgroundImage:`url(${c})`}:{}}),t("div",{className:"drape position-absolute",style:u&&u.length?{backgroundImage:`url(${u})`}:{}}),t("div",{className:"left position-absolute",style:d&&d.length?{backgroundImage:`url(${d})`}:{}}),t("div",{className:"right-repeat position-absolute",style:h&&h.length?{backgroundImage:`url(${h})`}:{}}),t("div",{className:"right position-absolute",style:g&&g.length?{backgroundImage:`url(${g})`}:{}}),K("hotelview")["show.avatar"]&&t("div",{className:"avatar-image",children:t(ot,{figure:r,direction:2})})]})},yc=o=>{const{badgeCode:e=null,children:n=null,...r}=o,{selectedBadgeCode:s=null,setSelectedBadgeCode:a=null,toggleBadge:c=null,getBadgeId:u=null}=wo(),{isUnseen:d=null}=Sn(),h=d(ze.BADGE,u(e));return l(Ie,{itemActive:s===e,itemUnseen:h,onMouseDown:g=>a(e),onDoubleClick:g=>c(s),...r,children:[t(qe,{badgeCode:e}),n]})},_R=o=>{const[e,n]=i.useState(!1),{badgeCodes:r=[],activeBadgeCodes:s=[],selectedBadgeCode:a=null,isWearingBadge:c=null,canWearBadges:u=null,toggleBadge:d=null,getBadgeId:h=null,activate:g=null,deactivate:f=null}=wo(),{isUnseen:p=null,removeUnseen:C=null}=Sn();return i.useEffect(()=>{!a||!p(ze.BADGE,h(a))||C(ze.BADGE,h(a))},[a,p,C,h]),i.useEffect(()=>{if(!e)return;const E=g();return()=>f(E)},[e,g,f]),i.useEffect(()=>(n(!0),()=>n(!1)),[]),l(se,{children:[t(T,{size:7,overflow:"hidden",children:t(ke,{columnCount:4,children:r&&r.length>0&&r.map((E,_)=>c(E)?null:t(yc,{badgeCode:E},_))})}),l(T,{className:"justify-content-between",size:5,overflow:"auto",children:[l(T,{overflow:"hidden",gap:2,children:[t(S,{children:m("inventory.badges.activebadges")}),t(ke,{columnCount:3,children:s&&s.length>0&&s.map((E,_)=>t(yc,{badgeCode:E},_))})]}),!!a&&l(T,{grow:!0,justifyContent:"end",gap:2,children:[l(w,{alignItems:"center",gap:2,children:[t(qe,{shrink:!0,badgeCode:a}),t(S,{children:sa(a)})]}),t(D,{variant:c(a)?"danger":"success",disabled:!c(a)&&!u(),onClick:E=>d(a),children:m(c(a)?"inventory.badges.clearbadge":"inventory.badges.wearbadge")})]})]})]})},Il=o=>{const{title:e="",desc:n="",children:r=null,...s}=o;return l(se,{...s,children:[t(T,{center:!0,size:5,overflow:"hidden",children:t("div",{className:"empty-image"})}),l(T,{justifyContent:"center",size:7,overflow:"hidden",children:[t(S,{fontWeight:"bold",fontSize:5,overflow:"unset",truncate:!0,children:e}),t(S,{overflow:"auto",children:n})]}),r]})},bR=o=>{const{botItem:e=null,children:n=null,...r}=o,[s,a]=i.useState(!1),{selectedBot:c=null,setSelectedBot:u=null}=fm(),{isUnseen:d=null}=Sn(),h=d(ze.BOT,e.botData.id),g=f=>{switch(f.type){case Re.MOUSE_DOWN:u(e),a(!0);return;case Re.MOUSE_UP:a(!1);return;case Re.ROLL_OUT:if(!s||c!==e)return;Oi(e);return;case"dblclick":Oi(e);return}};return l(Ie,{itemActive:c===e,itemUnseen:h,onMouseDown:g,onMouseUp:g,onMouseOut:g,onDoubleClick:g,...r,children:[t(ot,{figure:e.botData.figure,direction:3,headOnly:!0}),n]})},SR=o=>{const{roomSession:e=null,roomPreviewer:n=null}=o,[r,s]=i.useState(!1),{botItems:a=[],selectedBot:c=null,activate:u=null,deactivate:d=null}=fm(),{isUnseen:h=null,removeUnseen:g=null}=Sn();return i.useEffect(()=>{if(!c||!n)return;const f=c.botData,p=$();let C=p.getRoomInstanceVariable(p.activeRoomId,ae.ROOM_WALL_TYPE),E=p.getRoomInstanceVariable(p.activeRoomId,ae.ROOM_FLOOR_TYPE),_=p.getRoomInstanceVariable(p.activeRoomId,ae.ROOM_LANDSCAPE_TYPE);C=C&&C.length?C:"101",E=E&&E.length?E:"101",_=_&&_.length?_:"1.1",n.reset(!1),n.updateRoomWallsAndFloorVisibility(!0,!0),n.updateObjectRoom(E,C,_),n.addAvatarIntoRoom(f.figure,0)},[n,c]),i.useEffect(()=>{!c||!h(ze.BOT,c.botData.id)||g(ze.BOT,c.botData.id)},[c,h,g]),i.useEffect(()=>{if(!r)return;const f=u();return()=>d(f)},[r,u,d]),i.useEffect(()=>(s(!0),()=>s(!1)),[]),!a||!a.length?t(Il,{title:m("inventory.empty.bots.title"),desc:m("inventory.empty.bots.desc")}):l(se,{children:[t(T,{size:7,overflow:"hidden",children:t(ke,{columnCount:5,children:a&&a.length>0&&a.map(f=>t(bR,{botItem:f},f.botData.id))})}),l(T,{size:5,overflow:"auto",children:[t(T,{overflow:"hidden",position:"relative",children:t(Eo,{roomPreviewer:n,height:140})}),c&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:c.botData.name}),!!e&&t(D,{variant:"success",onClick:f=>Oi(c),children:m("inventory.furni.placetoroom")})]})]})]})},La=o=>{const{groupItem:e=null,...n}=o,[r,s]=i.useState(!1),{selectedItem:a=null,setSelectedItem:c=null}=Zr(),u=h=>{switch(h.type){case Re.MOUSE_DOWN:c(e),s(!0);return;case Re.MOUSE_UP:s(!1);return;case Re.ROLL_OUT:if(!r||e!==a)return;_s(e);return;case"dblclick":_s(e);return}},d=e.getUnlockedCount();return t(Ie,{className:d?"":"opacity-0-5 ",itemImage:e.iconUrl,itemCount:e.getUnlockedCount(),itemActive:e===a,itemUniqueNumber:e.stuffData.uniqueNumber,itemUnseen:e.hasUnseenItems,onMouseDown:u,onMouseUp:u,onMouseOut:u,onDoubleClick:u,...n})},Bm=o=>{const{groupItems:e=[],setGroupItems:n=null}=o,[r,s]=i.useState("");return i.useEffect(()=>{let a=[...e];if(r&&r.length){const c=r.toLocaleLowerCase();a=e.filter(u=>c&&c.length&&u.name.toLocaleLowerCase().includes(c)?u:null)}n(a)},[e,n,r]),l(w,{gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:m("generic.search"),value:r,onChange:a=>s(a.target.value)}),t(D,{variant:"primary",children:t(io,{className:"fa-icon"})})]})},NR=o=>{const e=o.getLastItem();if(!e||!e.sellable)return!1;St(new em(e))},TR=o=>{const{roomSession:e=null,roomPreviewer:n=null}=o,[r,s]=i.useState(!1),[a,c]=i.useState([]),{groupItems:u=[],selectedItem:d=null,activate:h=null,deactivate:g=null}=Zr(),{resetItems:f=null}=Sn();return i.useEffect(()=>{if(!d||!n)return;const p=d.getLastItem();if(!p)return;const C=$();let E=C.getRoomInstanceVariable(C.activeRoomId,ae.ROOM_WALL_TYPE),_=C.getRoomInstanceVariable(C.activeRoomId,ae.ROOM_FLOOR_TYPE),I=C.getRoomInstanceVariable(C.activeRoomId,ae.ROOM_LANDSCAPE_TYPE);if(E=E&&E.length?E:"101",_=_&&_.length?_:"101",I=I&&I.length?I:"1.1",n.reset(!1),n.updateObjectRoom(_,E,I),n.updateRoomWallsAndFloorVisibility(!0,!0),p.category===Z.WALL_PAPER||p.category===Z.FLOOR||p.category===Z.LANDSCAPE){if(_=p.category===Z.FLOOR?d.stuffData.getLegacyString():_,E=p.category===Z.WALL_PAPER?d.stuffData.getLegacyString():E,I=p.category===Z.LANDSCAPE?d.stuffData.getLegacyString():I,n.updateObjectRoom(_,E,I),p.category===Z.LANDSCAPE){const b=q().getWallItemDataByName("window_double_default");b&&n.addWallItemIntoRoom(b.id,new wt(90,0,0),b.customParams)}}else d.isWallItem?n.addWallItemIntoRoom(d.type,new wt(90),p.stuffData.getLegacyString()):n.addFurnitureIntoRoom(d.type,new wt(90),d.stuffData,p.extra.toString())},[n,d]),i.useEffect(()=>{!d||!d.hasUnseenItems||(f(ze.FURNI,d.items.map(p=>p.id)),d.hasUnseenItems=!1)},[d,f]),i.useEffect(()=>{if(!r)return;const p=h();return()=>g(p)},[r,h,g]),i.useEffect(()=>(s(!0),()=>s(!1)),[]),!u||!u.length?t(Il,{title:m("inventory.empty.title"),desc:m("inventory.empty.desc")}):l(se,{children:[l(T,{size:7,overflow:"hidden",children:[t(Bm,{groupItems:u,setGroupItems:c}),l(V,{children:[l(w,{gap:1,children:[t("button",{onClick:()=>o.setActualCategory("all"),className:`btn btn-${o.actualCategory==="all"?"success":"primary"} color-white btn-sm w-100`,children:"Todos"}),t("button",{onClick:()=>o.setActualCategory("wall"),className:`btn btn-${o.actualCategory==="wall"?"success":"primary"} color-white btn-sm w-100`,children:"Pared"}),t("button",{onClick:()=>o.setActualCategory("floor"),className:`btn btn-${o.actualCategory==="floor"?"success":"primary"} color-white btn-sm w-100`,children:"Suelo"}),t("button",{onClick:()=>o.setActualCategory("wireds"),className:`btn btn-${o.actualCategory==="wireds"?"success":"primary"} color-white btn-sm w-100`,children:"Wireds"})]}),o.actualCategory==="all"&&t(ke,{columnCount:5,children:a&&a.length>0&&a.map((p,C)=>t(La,{groupItem:p},C))}),o.actualCategory==="wall"&&t(ke,{columnCount:5,children:a&&a.length>0&&a.filter(p=>p.isWallItem).map((p,C)=>t(La,{groupItem:p},C))}),o.actualCategory==="floor"&&t(ke,{columnCount:5,children:a&&a.length>0&&a.filter(p=>!p.isWallItem).map((p,C)=>t(La,{groupItem:p},C))}),o.actualCategory==="wireds"&&t(ke,{columnCount:5,children:a&&a.length>0&&a.filter(p=>p.iconUrl!=null&&p.iconUrl.includes("wf_")).map((p,C)=>t(La,{groupItem:p},C))})]})]}),l(T,{size:5,overflow:"auto",children:[l(T,{overflow:"hidden",position:"relative",children:[t(Eo,{roomPreviewer:n,height:140}),d&&d.stuffData.isUnique&&t(Kd,{className:"top-2 end-2",position:"absolute",uniqueNumber:d.stuffData.uniqueNumber,uniqueSeries:d.stuffData.uniqueSeries}),d&&d.stuffData.rarityLevel>-1&&t(dl,{className:"top-2 end-2",position:"absolute",level:d.stuffData.rarityLevel})]}),d&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:d.name}),l(T,{gap:1,children:[!!e&&t(D,{variant:"success",onClick:p=>_s(d),children:m("inventory.furni.placetoroom")}),d&&d.isSellable&&t(D,{onClick:p=>NR(d),children:m("inventory.marketplace.sell")})]})]})]})]})},ni=9,vR=o=>{const{cancelTrade:e=null}=o,[n,r]=i.useState(null),[s,a]=i.useState(null),[c,u]=i.useState(null),[d,h]=i.useState(null),[g,f]=i.useState(3),[p,C]=i.useState(1),{ownUser:E=null,otherUser:_=null,groupItems:I=[],tradeState:b=rt.TRADING_STATE_READY,progressTrade:N=null,removeItem:v=null,setTradeState:O=null}=Im(),{simpleAlert:R=null}=Je(),y=(U,W,L,x,j)=>{if(!E||E.accepts||!E.userItems)return!1;if(E.userItems.length<ni)return!0;if(!x)return!1;let H=W.toString();return L===Z.POSTER?H=H+"poster"+j.getLegacyString():L===Z.GUILD_FURNI?H=yb(W,j):H=(U?"I":"S")+H,!!E.userItems.getValue(H)},G=U=>{if(!n)return;const W=n.getTradeItems(U);if(!W||!W.length)return;let L=null;const x=[];for(const H of W)x.push(H.id),L||(L=H);if(E.userItems.length+x.length<=1500)if(!L.isGroupable&&x.length)A(new Bl(x.pop()));else{const H=[];for(const te of x)y(L.isWallItem,L.type,L.category,L.isGroupable,L.stuffData)&&H.push(te);H.length&&(H.length===1?A(new Bl(H.pop())):A(new bC(...H)))}else R(m("trading.items.too_many_items.desc"),ue.DEFAULT,null,null,m("trading.items.too_many_items.title"))},k=U=>U?t(Cu,{className:"text-success fa-icon"}):t(lg,{className:"text-danger fa-icon"}),B=(U,W)=>{(isNaN(Number(U))||Number(U)<0||!U)&&(U=1),U=Math.max(Number(U),1),U=Math.min(Number(U),W),U!==p&&C(U)},M=U=>{B(p,U),G(p)};return i.useEffect(()=>{C(1)},[n]),i.useEffect(()=>{if(b!==rt.TRADING_STATE_COUNTDOWN)return;f(3);const U=setInterval(()=>{f(W=>{const L=W-1;return L===0&&clearInterval(U),L})},1e3);return()=>clearInterval(U)},[b,O]),i.useEffect(()=>{g===0&&O(rt.TRADING_STATE_CONFIRMING)},[g,O]),b===rt.TRADING_STATE_READY||!E||!_?null:l(se,{children:[l(T,{size:4,overflow:"hidden",children:[t(Bm,{groupItems:I,setGroupItems:h}),l(w,{column:!0,fullHeight:!0,justifyContent:"between",overflow:"hidden",gap:2,children:[t(ke,{columnCount:3,children:d&&d.length>0&&d.map((U,W)=>{const L=U.getUnlockedCount();return t(Ie,{className:L?"":"opacity-0-5 ",itemImage:U.iconUrl,itemCount:L,itemActive:n===U,itemUniqueNumber:U.stuffData.uniqueNumber,onClick:x=>L&&r(U),onDoubleClick:x=>G(1),children:L>0&&n===U&&t(D,{position:"absolute",variant:"success",className:"trade-button bottom-1 end-1",onClick:x=>G(1),children:t(Zt,{className:"fa-icon"})})},W)})}),l(T,{gap:1,alignItems:"end",children:[l(se,{overflow:"hidden",children:[t(T,{size:6,overflow:"hidden",children:t("input",{type:"number",className:"form-control form-control-sm quantity-input",placeholder:m("catalog.bundlewidget.spinner.select.amount"),disabled:!n,value:p,onChange:U=>C(U.target.valueAsNumber)})}),t(T,{size:6,overflow:"hidden",children:t(D,{variant:"secondary",disabled:!n,onClick:U=>M(n.getUnlockedCount()),children:m("inventory.trading.areoffering")})})]}),t(P,{fullWidth:!0,className:"badge bg-muted",children:n?n.name:m("catalog_selectproduct")})]})]})]}),l(T,{size:8,overflow:"hidden",children:[l(se,{overflow:"hidden",children:[l(T,{size:6,overflow:"hidden",children:[l(w,{justifyContent:"between",alignItems:"center",children:[l(S,{children:[m("inventory.trading.you")," ",m("inventory.trading.areoffering"),":"]}),k(E.accepts)]}),t(ke,{columnCount:3,children:Array.from(Array(ni),(U,W)=>{const L=E.userItems.getWithIndex(W)||null;return L?t(Ie,{itemActive:s===L,itemImage:L.iconUrl,itemCount:L.getTotalCount(),itemUniqueNumber:L.stuffData.uniqueNumber,onClick:x=>a(L),onDoubleClick:x=>v(L),children:s===L&&t(D,{position:"absolute",variant:"danger",className:"trade-button bottom-1 start-1",onClick:x=>v(L),children:t(Jt,{className:"fa-icon"})})},W):t(Ie,{},W)})}),t(P,{fullWidth:!0,className:"badge bg-muted",children:s?s.name:m("catalog_selectproduct")})]}),l(T,{size:6,overflow:"hidden",children:[l(w,{justifyContent:"between",alignItems:"center",children:[l(S,{children:[_.userName," ",m("inventory.trading.isoffering"),":"]}),k(_.accepts)]}),t(ke,{columnCount:3,children:Array.from(Array(ni),(U,W)=>{const L=_.userItems.getWithIndex(W)||null;return L?t(Ie,{itemActive:c===L,itemImage:L.iconUrl,itemCount:L.getTotalCount(),itemUniqueNumber:L.stuffData.uniqueNumber,onClick:x=>u(L)},W):t(Ie,{},W)})}),t(P,{fullWidth:!0,className:"badge bg-muted w-100",children:c?c.name:m("catalog_selectproduct")})]})]}),l(w,{grow:!0,justifyContent:"between",children:[t(D,{variant:"danger",onClick:e,children:m("generic.cancel")}),b===rt.TRADING_STATE_READY&&t(D,{variant:"secondary",disabled:!E.itemCount&&!_.itemCount,onClick:N,children:m("inventory.trading.accept")}),b===rt.TRADING_STATE_RUNNING&&t(D,{variant:"secondary",disabled:!E.itemCount&&!_.itemCount,onClick:N,children:m(E.accepts?"inventory.trading.modify":"inventory.trading.accept")}),b===rt.TRADING_STATE_COUNTDOWN&&t(D,{variant:"secondary",disabled:!0,children:m("inventory.trading.countdown",["counter"],[g.toString()])}),b===rt.TRADING_STATE_CONFIRMING&&t(D,{variant:"secondary",onClick:N,children:m("inventory.trading.button.restore")}),b===rt.TRADING_STATE_CONFIRMED&&t(D,{variant:"secondary",children:m("inventory.trading.info.waiting")})]})]})]})},wR=o=>{const{petItem:e=null,children:n=null,...r}=o,[s,a]=i.useState(!1),{selectedPet:c=null,setSelectedPet:u=null}=pm(),{isUnseen:d}=Sn(),h=d(ze.PET,e.petData.id),g=f=>{switch(f.type){case Re.MOUSE_DOWN:u(e),a(!0);return;case Re.MOUSE_UP:a(!1);return;case Re.ROLL_OUT:if(!s||e!==c)return;yi(e);return;case"dblclick":yi(e);return}};return l(Ie,{itemActive:e===c,itemUnseen:h,onMouseDown:g,onMouseUp:g,onMouseOut:g,onDoubleClick:g,...r,children:[t(tr,{figure:e.petData.figureData.figuredata,direction:3,headOnly:!0}),n]})},RR=o=>{const{roomSession:e=null,roomPreviewer:n=null}=o,[r,s]=i.useState(!1),{petItems:a=null,selectedPet:c=null,activate:u=null,deactivate:d=null}=pm(),{isUnseen:h=null,removeUnseen:g=null}=Sn();return i.useEffect(()=>{if(!c||!n)return;const f=c.petData,p=$();let C=p.getRoomInstanceVariable(p.activeRoomId,ae.ROOM_WALL_TYPE),E=p.getRoomInstanceVariable(p.activeRoomId,ae.ROOM_FLOOR_TYPE),_=p.getRoomInstanceVariable(p.activeRoomId,ae.ROOM_LANDSCAPE_TYPE);C=C&&C.length?C:"101",E=E&&E.length?E:"101",_=_&&_.length?_:"1.1",n.reset(!1),n.updateRoomWallsAndFloorVisibility(!0,!0),n.updateObjectRoom(E,C,_),n.addPetIntoRoom(f.figureString)},[n,c]),i.useEffect(()=>{!c||!h(ze.PET,c.petData.id)||g(ze.PET,c.petData.id)},[c,h,g]),i.useEffect(()=>{if(!r)return;const f=u();return()=>d(f)},[r,u,d]),i.useEffect(()=>(s(!0),()=>s(!1)),[]),!a||!a.length?t(Il,{title:m("inventory.empty.pets.title"),desc:m("inventory.empty.pets.desc")}):l(se,{children:[t(T,{size:7,overflow:"hidden",children:t(ke,{columnCount:5,children:a&&a.length>0&&a.map(f=>t(wR,{petItem:f},f.petData.id))})}),l(T,{size:5,overflow:"auto",children:[t(T,{overflow:"hidden",position:"relative",children:t(Eo,{roomPreviewer:n,height:140})}),c&&c.petData&&l(T,{grow:!0,justifyContent:"between",gap:2,children:[t(S,{grow:!0,truncate:!0,children:c.petData.name}),!!e&&t(D,{variant:"success",onClick:f=>yi(c),children:m("inventory.furni.placetoroom")})]})]})]})},Gm="inventory.furni",Vm="inventory.bots",Hm="inventory.furni.tab.pets",Wm="inventory.badges",Oc=[Gm,Vm,Hm,Wm],yR=[ze.FURNI,ze.BOT,ze.PET,ze.BADGE],OR=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(Oc[0]),[a,c]=i.useState(null),[u,d]=i.useState(null),{isTrading:h=!1,stopTrading:g=null}=Im(),{getCount:f=null,resetCategory:p=null}=Sn(),C=()=>{h&&g(),n(!1)};return Te(It.PLACED,E=>{Tb()&&(oa(!1),E.placedInRoom||n(!0))}),Ye([jt.CREATED,jt.ENDED],E=>{switch(E.type){case jt.CREATED:c(E.session);return;case jt.ENDED:c(null),n(!1);return}}),F(SC,E=>{const _=E.getParser();for(const I of _.data)cd().setBadgePointLimit(I.badgeId,I.limit)}),i.useEffect(()=>{const E={linkReceived:_=>{const I=_.split("/");if(!(I.length<2))switch(I[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(b=>!b);return}},eventUrlPrefix:"inventory/"};return ut(E),()=>dt(E)},[]),i.useEffect(()=>(d(new Ka($(),++Ka.PREVIEW_COUNTER)),()=>{d(E=>(E.dispose(),null))}),[]),i.useEffect(()=>{!e&&h&&n(!0)},[e,h]),e?l(oe,{uniqueKey:"inventory",className:"nitro-inventory",theme:h?"primary-slim":"",children:[t(ie,{headerText:m("inventory.title"),onCloseClick:C}),!h&&l(V,{children:[t(lr,{children:Oc.map((E,_)=>t(Mn,{isActive:r===E,onClick:I=>s(E),count:f(yR[_]),children:m(E)},_))}),l(re,{children:[r===Gm&&t(TR,{roomSession:a,roomPreviewer:u,actualCategory:o.actualCategory,setActualCategory:o.setActualCategory}),r===Vm&&t(SR,{roomSession:a,roomPreviewer:u}),r===Hm&&t(RR,{roomSession:a,roomPreviewer:u}),r===Wm&&t(_R,{})]})]}),h&&t(re,{children:t(vR,{cancelTrade:C})})]}):null},El=o=>{const{records:e=null}=o,{openRoomInfo:n=null}=ys(),r=i.useMemo(()=>{const a=[];return e.forEach(c=>{a.push({isRoomInfo:!0,roomId:c.roomId,roomName:c.roomName}),c.chatlog.forEach(u=>{a.push({timestamp:u.timestamp,habboId:u.userId,username:u.userName,hasHighlighting:u.hasHighlighting,message:u.message,isRoomInfo:!1})})}),a},[e]),s=a=>l(w,{gap:2,alignItems:"center",justifyContent:"between",className:"bg-muted rounded p-1",children:[l(w,{gap:1,children:[t(S,{bold:!0,children:"Room name:"}),t(S,{children:a.roomName})]}),l(w,{gap:1,children:[t(D,{onClick:c=>_n(a.roomId),children:"Visit Room"}),t(D,{onClick:c=>n(a.roomId),children:"Room Tools"})]})]});return t(V,{children:l(T,{fit:!0,gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(se,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Time"}),t(P,{className:"g-col-3",children:"User"}),t(P,{className:"g-col-7",children:"Message"})]})}),e&&e.length>0&&t(_o,{rows:r,rowRender:a=>l(V,{children:[a.isRoomInfo&&t(s,{roomId:a.roomId,roomName:a.roomName}),!a.isRoomInfo&&l(se,{fullHeight:!1,gap:1,alignItems:"center",className:"log-entry py-1 border-bottom",children:[t(S,{className:"g-col-2",children:a.timestamp}),t(S,{className:"g-col-3",bold:!0,underline:!0,pointer:!0,onClick:c=>ee(`mod-tools/open-user-info/${a.habboId}`),children:a.username}),t(S,{textBreak:!0,wrap:!0,className:"g-col-7",children:a.message})]})]})})]})})},kR=o=>{const{roomId:e=null,onCloseClick:n=null}=o,[r,s]=i.useState(null);return F(NC,a=>{const c=a.getParser();!c||c.data.roomId!==e||s(c.data)}),i.useEffect(()=>{A(new TC(e))},[e]),r?l(oe,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:Rt.TOP_LEFT,children:[t(ie,{headerText:`Room Chatlog ${r.roomName}`,onCloseClick:n}),t(re,{className:"text-black",overflow:"hidden",children:r&&t(El,{records:[r]})})]}):null},AR=o=>{const{roomId:e=null,onCloseClick:n=null}=o,[r,s]=i.useState(!1),[a,c]=i.useState(null),[u,d]=i.useState(null),[h,g]=i.useState(null),[f,p]=i.useState(null),[C,E]=i.useState(!1),[_,I]=i.useState(0),[b,N]=i.useState(!1),[v,O]=i.useState(!1),[R,y]=i.useState(!1),[G,k]=i.useState(""),B=(M,U)=>{if(M)switch(M){case"alert_only":if(G.trim().length===0)return;A(new pa(pa.ACTION_ALERT,G,"")),A(new Gl(e,v?1:0,R?1:0,b?1:0));return;case"send_message":if(G.trim().length===0)return;A(new pa(pa.ACTION_MESSAGE,G,"")),A(new Gl(e,v?1:0,R?1:0,b?1:0));return}};return F(vC,M=>{const U=M.getParser();!U||U.data.flatId!==e||(c(U.data.flatId),d(U.data.room.name),g(U.data.ownerId),p(U.data.ownerName),E(U.data.ownerInRoom),I(U.data.userCount))}),i.useEffect(()=>{r||(A(new wC(e)),s(!0))},[e,r,s]),l(oe,{className:"nitro-mod-tools-room",theme:"primary-slim",windowPosition:Rt.TOP_LEFT,children:[t(ie,{headerText:"Room Info"+(u?": "+u:""),onCloseClick:M=>n()}),l(re,{className:"text-black",children:[l(w,{gap:2,children:[l(T,{justifyContent:"center",grow:!0,gap:1,children:[l(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Room Owner:"}),t(S,{underline:!0,pointer:!0,truncate:!0,children:f})]}),l(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Users in room:"}),t(S,{children:_})]}),l(w,{alignItems:"center",gap:2,children:[t(S,{bold:!0,align:"end",className:"col-7",children:"Owner in room:"}),t(S,{children:C?"Yes":"No"})]})]}),l(T,{gap:1,children:[t(D,{onClick:M=>_n(e),children:"Visit Room"}),t(D,{onClick:M=>ee(`mod-tools/open-room-chatlog/${e}`),children:"Chatlog"})]})]}),l(T,{className:"bg-muted rounded p-2",gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:b,onChange:M=>N(M.target.checked)}),t(S,{small:!0,children:"Kick everyone out"})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:v,onChange:M=>O(M.target.checked)}),t(S,{small:!0,children:"Enable the doorbell"})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:R,onChange:M=>y(M.target.checked)}),t(S,{small:!0,children:"Change room name"})]})]}),t("textarea",{className:"form-control",placeholder:"Type a mandatory message to the users in this text box...",value:G,onChange:M=>k(M.target.value)}),l(w,{justifyContent:"between",children:[t(D,{variant:"danger",onClick:M=>B("send_message"),children:"Send Caution"}),t(D,{onClick:M=>B("alert_only"),children:"Send Alert only"})]})]})]})},PR=o=>{const{onCloseClick:e=null,issueId:n=null}=o,[r,s]=i.useState(null);return F(RC,a=>{const c=a.getParser();!c||c.data.issueId!==n||s(c.data)}),i.useEffect(()=>{A(new yC(n))},[n]),l(oe,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",children:[t(ie,{headerText:"Issue Chatlog",onCloseClick:e}),t(re,{className:"text-black",children:r&&t(El,{records:[r.chatRecord]})})]})},DR=o=>{const{issueId:e=null,onIssueInfoClosed:n=null}=o,[r,s]=i.useState(!1),{tickets:a=[],openUserInfo:c=null}=ys(),u=a.find(g=>g.issueId===e),d=g=>{A(new ed([g])),n(g)},h=g=>{A(new Ia([e],g)),n(e)};return l(V,{children:[l(oe,{className:"nitro-mod-tools-handle-issue",theme:"primary-slim",children:[t(ie,{headerText:"Resolving issue "+e,onCloseClick:()=>n(e)}),l(re,{className:"text-black",children:[t(S,{fontSize:4,children:"Issue Information"}),l(se,{overflow:"auto",children:[t(T,{size:8,children:t("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:l("tbody",{children:[l("tr",{children:[t("th",{children:"Source"}),t("td",{children:Qb(u.categoryId)})]}),l("tr",{children:[t("th",{children:"Category"}),t("td",{className:"text-break",children:m("help.cfh.topic."+u.reportedCategoryId)})]}),l("tr",{children:[t("th",{children:"Description"}),t("td",{className:"text-break",children:u.message})]}),l("tr",{children:[t("th",{children:"Caller"}),t("td",{children:t(S,{bold:!0,underline:!0,pointer:!0,onClick:g=>c(u.reporterUserId),children:u.reporterUserName})})]}),l("tr",{children:[t("th",{children:"Reported User"}),t("td",{children:t(S,{bold:!0,underline:!0,pointer:!0,onClick:g=>c(u.reportedUserId),children:u.reportedUserName})})]})]})})}),l(T,{size:4,gap:1,children:[t(D,{variant:"secondary",onClick:()=>s(!r),children:"Chatlog"}),t(D,{onClick:g=>h(Ia.RESOLUTION_USELESS),children:"Close as useless"}),t(D,{variant:"danger",onClick:g=>h(Ia.RESOLUTION_ABUSIVE),children:"Close as abusive"}),t(D,{variant:"success",onClick:g=>h(Ia.RESOLUTION_RESOLVED),children:"Close as resolved"}),t(D,{variant:"secondary",onClick:g=>d(e),children:"Release"})]})]})]})]}),r&&t(PR,{issueId:e,onCloseClick:()=>s(!1)})]})},MR=o=>{const{myIssues:e=null,handleIssue:n=null}=o;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(se,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-3",children:"Opened"}),t(P,{className:"g-col-2"}),t(P,{className:"g-col-2"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(r=>l(se,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:r.categoryId}),t(P,{className:"g-col-3",children:r.reportedUserName}),t(P,{className:"g-col-3",children:new Date(Date.now()-r.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-2",children:t(D,{variant:"primary",onClick:s=>n(r.issueId),children:"Handle"})}),t(P,{className:"g-col-2",children:t(D,{variant:"danger",onClick:s=>A(new ed([r.issueId])),children:"Release"})})]},r.issueId))})]})},LR=o=>{const{openIssues:e=null}=o;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(se,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-4",children:"Opened"}),t(P,{className:"g-col-3"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(n=>l(se,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:n.categoryId}),t(P,{className:"g-col-3",children:n.reportedUserName}),t(P,{className:"g-col-4",children:new Date(Date.now()-n.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-3",children:t(D,{variant:"success",onClick:r=>A(new OC([n.issueId],!1,0,"pick issue button")),children:"Pick Issue"})})]},n.issueId))})]})},UR=o=>{const{pickedIssues:e=null}=o;return l(T,{gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(se,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Type"}),t(P,{className:"g-col-3",children:"Room/Player"}),t(P,{className:"g-col-4",children:"Opened"}),t(P,{className:"g-col-3",children:"Picker"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:e&&e.length>0&&e.map(n=>l(se,{gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[t(P,{className:"g-col-2",children:n.categoryId}),t(P,{className:"g-col-3",children:n.reportedUserName}),t(P,{className:"g-col-4",children:new Date(Date.now()-n.issueAgeInMilliseconds).toLocaleTimeString()}),t(P,{className:"g-col-3",children:n.pickerUserName})]},n.issueId))})]})},xR=["Open Issues","My Issues","Picked Issues"],FR=o=>{const{onCloseClick:e=null}=o,[n,r]=i.useState(0),[s,a]=i.useState([]),{tickets:c=[]}=ys(),u=c.filter(C=>C.state===Wo.STATE_OPEN),d=c.filter(C=>C.state===Wo.STATE_PICKED&&C.pickerUserId===q().userId),h=c.filter(C=>C.state===Wo.STATE_PICKED),g=C=>{a(E=>{const _=[...E],I=_.indexOf(C);return I>=0&&_.splice(I,1),_})},f=C=>{a(E=>{const _=[...E],I=_.indexOf(C);return I===-1?_.push(C):_.splice(I,1),_})},p=()=>{switch(n){case 0:return t(LR,{openIssues:u});case 1:return t(MR,{myIssues:d,handleIssue:f});case 2:return t(UR,{pickedIssues:h})}return null};return l(V,{children:[l(oe,{className:"nitro-mod-tools-tickets",children:[t(ie,{headerText:"Tickets",onCloseClick:e}),t(lr,{children:xR.map((C,E)=>t(Mn,{isActive:n===E,onClick:_=>r(E),children:C},E))}),t(re,{gap:1,children:t(p,{})})]}),s&&s.length>0&&s.map(C=>t(DR,{issueId:C,onIssueInfoClosed:g},C))]})},BR=o=>{const{userId:e=null,onCloseClick:n=null}=o,[r,s]=i.useState(null),[a,c]=i.useState(null);return F(kC,u=>{const d=u.getParser();!d||d.data.userId!==e||(c(d.data.username),s(d.data.roomChatlogs))}),i.useEffect(()=>{A(new AC(e))},[e]),l(oe,{className:"nitro-mod-tools-chatlog",theme:"primary-slim",windowPosition:Rt.TOP_LEFT,children:[t(ie,{headerText:`User Chatlog: ${a||""}`,onCloseClick:n}),t(re,{className:"text-black h-100",children:r&&t(El,{records:r})})]})},kc=[new Ue(1,"Alert",Ue.ALERT,1,0),new Ue(2,"Mute 1h",Ue.MUTE,2,0),new Ue(3,"Ban 18h",Ue.BAN,3,0),new Ue(4,"Ban 7 days",Ue.BAN,4,0),new Ue(5,"Ban 30 days (step 1)",Ue.BAN,5,0),new Ue(7,"Ban 30 days (step 2)",Ue.BAN,7,0),new Ue(6,"Ban 100 years",Ue.BAN,6,0),new Ue(106,"Ban avatar-only 100 years",Ue.BAN,6,0),new Ue(101,"Kick",Ue.KICK,0,0),new Ue(102,"Lock trade 1 week",Ue.TRADE_LOCK,0,168),new Ue(104,"Lock trade permanent",Ue.TRADE_LOCK,0,876e3),new Ue(105,"Message",Ue.MESSAGE,0,0)],GR=o=>{const{user:e=null,onCloseClick:n=null}=o,[r,s]=i.useState(-1),[a,c]=i.useState(-1),[u,d]=i.useState(""),{cfhCategories:h=null,settings:g=null}=ys(),{simpleAlert:f=null}=Je(),p=i.useMemo(()=>{const I=[];if(h&&h.length)for(const b of h)for(const N of b.topics)I.push(N);return I},[h]),C=I=>f(I,ue.DEFAULT,null,null,"Error"),E=()=>{let I=null;const b=p[r];if(r===-1&&(I="You must select a CFH topic"),I)return C(I);const N=u.trim().length===0?m(`help.cfh.topic.${b.id}`):u;A(new PC(e.userId,r,N)),n()},_=()=>{let I=null;const b=p[r],N=kc[a];if(r===-1||a===-1?I="You must select a CFH topic and Sanction":!g||!g.cfhPermission?I="You do not have permission to do this":b?N||(I="You must select a sanction"):I="You must select a CFH topic",I){C(I);return}const v=u.trim().length===0?m(`help.cfh.topic.${b.id}`):u;switch(N.actionType){case Ue.ALERT:{if(!g.alertPermission){C("You have insufficient permissions");return}A(new xC(e.userId,v,b.id));break}case Ue.MUTE:A(new UC(e.userId,v,b.id));break;case Ue.BAN:{if(!g.banPermission){C("You have insufficient permissions");return}A(new LC(e.userId,v,b.id,a,N.actionId===106));break}case Ue.KICK:{if(!g.kickPermission){C("You have insufficient permissions");return}A(new MC(e.userId,v,b.id));break}case Ue.TRADE_LOCK:{const O=N.actionLengthHours*60;A(new DC(e.userId,v,O,b.id));break}case Ue.MESSAGE:{if(u.trim().length===0){C("Please write a message to user");return}A(new td(e.userId,u,b.id));break}}n()};return e?l(oe,{className:"nitro-mod-tools-user-action",theme:"primary-slim",windowPosition:Rt.TOP_LEFT,children:[t(ie,{headerText:"Mod Action: "+(e?e.username:""),onCloseClick:()=>n()}),l(re,{className:"text-black",children:[l("select",{className:"form-select form-select-sm",value:r,onChange:I=>s(parseInt(I.target.value)),children:[t("option",{value:-1,disabled:!0,children:"CFH Topic"}),p.map((I,b)=>t("option",{value:b,children:m("help.cfh.topic."+I.id)},b))]}),l("select",{className:"form-select form-select-sm",value:a,onChange:I=>c(parseInt(I.target.value)),children:[t("option",{value:-1,disabled:!0,children:"Sanction Type"}),kc.map((I,b)=>t("option",{value:b,children:I.name},b))]}),l(T,{gap:1,children:[t(S,{small:!0,children:"Optional message type, overrides default"}),t("textarea",{className:"form-control",value:u,onChange:I=>d(I.target.value)})]}),l(w,{justifyContent:"between",gap:1,children:[t(D,{variant:"primary",onClick:E,children:"Default Sanction"}),t(D,{variant:"success",onClick:_,children:"Sanction"})]})]})]}):null},VR=o=>{const{userId:e=null,onCloseClick:n=null}=o,[r,s]=i.useState(null);return F(FC,a=>{const c=a.getParser();c.data.userId===e&&s(c.data)}),i.useEffect(()=>{A(new BC(e))},[e]),e?l(oe,{className:"nitro-mod-tools-user-visits",theme:"primary-slim",windowPosition:Rt.TOP_LEFT,children:[t(ie,{headerText:"User Visits",onCloseClick:n}),t(re,{className:"text-black",gap:1,children:l(T,{fullHeight:!0,gap:0,overflow:"hidden",children:[t(T,{gap:2,children:l(se,{gap:1,className:"text-black fw-bold border-bottom pb-1",children:[t(P,{className:"g-col-2",children:"Time"}),t(P,{className:"g-col-7",children:"Room name"}),t(P,{className:"g-col-3",children:"Visit"})]})}),t(_o,{rows:(r==null?void 0:r.rooms)??[],rowRender:a=>l(se,{fullHeight:!1,gap:1,alignItems:"center",className:"text-black py-1 border-bottom",children:[l(S,{className:"g-col-2",children:[a.enterHour.toString().padStart(2,"0"),": ",a.enterMinute.toString().padStart(2,"0")]}),t(S,{className:"g-col-7",children:a.roomName}),t(S,{bold:!0,underline:!0,pointer:!0,variant:"primary",className:"g-col-3",onClick:c=>_n(a.roomId),children:"Visit Room"})]})})]})})]}):null},HR=o=>{const{user:e=null,onCloseClick:n=null}=o,[r,s]=i.useState(""),{simpleAlert:a=null}=Je();if(!e)return null;const c=()=>{if(r.trim().length===0){a("Please write a message to user.",null,null,null,"Error",null);return}A(new td(e.userId,r,-999)),n()};return l(oe,{className:"nitro-mod-tools-user-message",theme:"primary-slim",windowPosition:Rt.TOP_LEFT,children:[t(ie,{headerText:"Send Message",onCloseClick:()=>n()}),l(re,{className:"text-black",children:[l(S,{children:["Message To: ",e.username]}),t("textarea",{className:"form-control",value:r,onChange:u=>s(u.target.value)}),t(D,{fullWidth:!0,onClick:c,children:"Send message"})]})]})},WR=o=>{const{onCloseClick:e=null,userId:n=null}=o,[r,s]=i.useState(null),[a,c]=i.useState(!1),[u,d]=i.useState(!1),[h,g]=i.useState(!1),f=i.useMemo(()=>r?[{localeKey:"modtools.userinfo.userName",value:r.userName,showOnline:!0},{localeKey:"modtools.userinfo.cfhCount",value:r.cfhCount.toString()},{localeKey:"modtools.userinfo.abusiveCfhCount",value:r.abusiveCfhCount.toString()},{localeKey:"modtools.userinfo.cautionCount",value:r.cautionCount.toString()},{localeKey:"modtools.userinfo.banCount",value:r.banCount.toString()},{localeKey:"modtools.userinfo.lastSanctionTime",value:r.lastSanctionTime},{localeKey:"modtools.userinfo.tradingLockCount",value:r.tradingLockCount.toString()},{localeKey:"modtools.userinfo.tradingExpiryDate",value:r.tradingExpiryDate},{localeKey:"modtools.userinfo.minutesSinceLastLogin",value:jn.format(r.minutesSinceLastLogin*60,".ago",2)},{localeKey:"modtools.userinfo.lastPurchaseDate",value:r.lastPurchaseDate},{localeKey:"modtools.userinfo.primaryEmailAddress",value:r.primaryEmailAddress},{localeKey:"modtools.userinfo.identityRelatedBanCount",value:r.identityRelatedBanCount.toString()},{localeKey:"modtools.userinfo.registrationAgeInMinutes",value:jn.format(r.registrationAgeInMinutes*60,".ago",2)},{localeKey:"modtools.userinfo.userClassification",value:r.userClassification}]:null,[r]);return F(GC,p=>{const C=p.getParser();!C||C.data.userId!==n||s(C.data)}),i.useEffect(()=>{A(new VC(n))},[n]),r?l(V,{children:[l(oe,{className:"nitro-mod-tools-user",theme:"primary-slim",windowPosition:Rt.TOP_LEFT,children:[t(ie,{headerText:m("modtools.userinfo.title",["username"],[r.userName]),onCloseClick:()=>e()}),t(re,{className:"text-black",children:l(se,{overflow:"hidden",children:[t(T,{size:8,overflow:"auto",children:t("table",{className:"table table-striped table-sm table-text-small text-black m-0",children:t("tbody",{children:f.map((p,C)=>l("tr",{children:[t("th",{scope:"row",children:m(p.localeKey)}),l("td",{children:[p.value,p.showOnline&&t("i",{className:`icon icon-pf-${r.online?"online":"offline"} ms-2`})]})]},C))})})}),l(T,{size:4,gap:1,children:[t(D,{onClick:p=>ee(`mod-tools/open-user-chatlog/${n}`),children:"Room Chat"}),t(D,{onClick:p=>c(!a),children:"Send Message"}),t(D,{onClick:p=>g(!h),children:"Room Visits"}),t(D,{onClick:p=>d(!u),children:"Mod Action"})]})]})})]}),a&&t(HR,{user:{userId:n,username:r.userName},onCloseClick:()=>c(!1)}),u&&t(GR,{user:{userId:n,username:r.userName},onCloseClick:()=>d(!1)}),h&&t(VR,{userId:n,onCloseClick:()=>g(!1)})]}):null},jR=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(-1),[a,c]=i.useState(null),[u,d]=i.useState(!1),{openRooms:h=[],openRoomChatlogs:g=[],openUserChatlogs:f=[],openUserInfos:p=[],openRoomInfo:C=null,closeRoomInfo:E=null,toggleRoomInfo:_=null,openRoomChatlog:I=null,closeRoomChatlog:b=null,toggleRoomChatlog:N=null,openUserInfo:v=null,closeUserInfo:O=null,toggleUserInfo:R=null,openUserChatlog:y=null,closeUserChatlog:G=null,toggleUserChatlog:k=null}=ys(),B=i.useRef(null);return Te([En.INITIALIZED,En.DISPOSED],M=>{if(!jr.isRoomPreviewerId(M.roomId))switch(M.type){case En.INITIALIZED:s(M.roomId);return;case En.DISPOSED:s(-1);return}}),ml(M=>{if(M.category!==Q.UNIT)return;const U=Oe();if(!U)return;const W=U.userDataManager.getUserDataByIndex(M.id);!W||W.type!==pt.USER||c({userId:W.webID,username:W.name})}),i.useEffect(()=>{const M={linkReceived:U=>{const W=U.split("/");if(!(W.length<2))switch(W[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(L=>!L);return;case"open-room-info":C(Number(W[2]));return;case"close-room-info":E(Number(W[2]));return;case"toggle-room-info":_(Number(W[2]));return;case"open-room-chatlog":I(Number(W[2]));return;case"close-room-chatlog":b(Number(W[2]));return;case"toggle-room-chatlog":N(Number(W[2]));return;case"open-user-info":v(Number(W[2]));return;case"close-user-info":O(Number(W[2]));return;case"toggle-user-info":R(Number(W[2]));return;case"open-user-chatlog":y(Number(W[2]));return;case"close-user-chatlog":G(Number(W[2]));return;case"toggle-user-chatlog":k(Number(W[2]));return}},eventUrlPrefix:"mod-tools/"};return ut(M),()=>dt(M)},[C,E,_,I,b,N,v,O,R,y,G,k]),l(V,{children:[e&&l(oe,{uniqueKey:"mod-tools",className:"nitro-mod-tools",windowPosition:Rt.TOP_LEFT,theme:"primary-slim",children:[t(ie,{headerText:"Mod Tools",onCloseClick:M=>n(!1)}),l(re,{className:"text-black",gap:1,children:[l(D,{gap:1,onClick:M=>ee(`mod-tools/toggle-room-info/${r}`),disabled:r<=0,className:"position-relative",children:[t(P,{className:"icon icon-small-room position-absolute start-1"})," Room Tool"]}),l(D,{innerRef:B,gap:1,onClick:M=>ee(`mod-tools/toggle-room-chatlog/${r}`),disabled:r<=0,className:"position-relative",children:[t(P,{className:"icon icon-chat-history position-absolute start-1"})," Chatlog Tool"]}),l(D,{gap:1,onClick:()=>ee(`mod-tools/toggle-user-info/${a.userId}`),disabled:!a,className:"position-relative",children:[t(P,{className:"icon icon-user position-absolute start-1"})," User: ",a?a.username:""]}),l(D,{gap:1,onClick:()=>d(M=>!M),className:"position-relative",children:[t(P,{className:"icon icon-tickets position-absolute start-1"})," Report Tool"]})]})]}),h.length>0&&h.map(M=>t(AR,{roomId:M,onCloseClick:()=>ee(`mod-tools/close-room-info/${M}`)},M)),g.length>0&&g.map(M=>t(kR,{roomId:M,onCloseClick:()=>ee(`mod-tools/close-room-chatlog/${M}`)},M)),p.length>0&&p.map(M=>t(WR,{userId:M,onCloseClick:()=>ee(`mod-tools/close-user-info/${M}`)},M)),f.length>0&&f.map(M=>t(BR,{userId:M,onCloseClick:()=>ee(`mod-tools/close-user-chatlog/${M}`)},M)),u&&t(FR,{onCloseClick:()=>d(!1)})]})},qR=[De.START_DOORBELL,De.STATE_WAITING,De.STATE_NO_ANSWER,De.START_PASSWORD,De.STATE_WRONG_PASSWORD],zR=[De.START_DOORBELL,De.STATE_WAITING,De.STATE_NO_ANSWER],YR=o=>{const[e,n]=i.useState(""),{doorData:r=null,setDoorData:s=null}=xn(),a=()=>{r&&r.state===De.STATE_WAITING&&wi(),s(null)},c=()=>{!r||!r.roomInfo||(qr(r.roomInfo.roomId),s(h=>{const g={...h};return g.state=De.STATE_PENDING_SERVER,g}))},u=()=>{!r||!r.roomInfo||(qr(r.roomInfo.roomId,e),s(h=>{const g={...h};return g.state=De.STATE_PENDING_SERVER,g}))};if(i.useEffect(()=>{!r||r.state!==De.STATE_NO_ANSWER||wi()},[r]),!r||r.state===De.NONE||qR.indexOf(r.state)===-1)return null;const d=zR.indexOf(r.state)>=0;return l(oe,{className:"nitro-navigator-doorbell",theme:"primary-slim",children:[t(ie,{headerText:m(d?"navigator.doorbell.title":"navigator.password.title"),onCloseClick:a}),l(re,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:r&&r.roomInfo&&r.roomInfo.roomName}),r.state===De.START_DOORBELL&&t(S,{children:m("navigator.doorbell.info")}),r.state===De.STATE_WAITING&&t(S,{children:m("navigator.doorbell.waiting")}),r.state===De.STATE_NO_ANSWER&&t(S,{children:m("navigator.doorbell.no.answer")}),r.state===De.START_PASSWORD&&t(S,{children:m("navigator.password.info")}),r.state===De.STATE_WRONG_PASSWORD&&t(S,{children:m("navigator.password.retryinfo")})]}),d&&l(T,{gap:1,children:[r.state===De.START_DOORBELL&&t(D,{variant:"success",onClick:c,children:m("navigator.doorbell.button.ring")}),t(D,{variant:"danger",onClick:a,children:m("generic.cancel")})]}),!d&&l(V,{children:[l(T,{gap:1,children:[t(S,{children:m("navigator.password.enter")}),t("input",{type:"password",className:"form-control form-control-sm",onChange:h=>n(h.target.value)})]}),l(T,{gap:1,children:[t(D,{variant:"success",onClick:u,children:m("navigator.password.button.try")}),t(D,{variant:"danger",onClick:a,children:m("generic.cancel")})]})]})]})]})},$R=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(null),[a,c]=i.useState(null),[u,d]=i.useState(null),[h,g]=i.useState(null),[f,p]=i.useState(0),[C,E]=i.useState([]),[_,I]=i.useState(""),{categories:b=null}=xn(),N=K("hc.disabled",!1),v=y=>K("images.url")+`/navigator/models/model_${y}.png`,O=(y,G)=>{!y||y.clubLevel>Cn()||I(C[G].name)},R=()=>{A(new HC(r,a,"model_"+_,Number(u),Number(h),f))};return i.useEffect(()=>{if(!e){const y=[];for(let G=10;G<=100;G=G+10)y.push(G);n(y),g(y[0])}},[e]),i.useEffect(()=>{b&&b.length&&d(b[0].id)},[b]),i.useEffect(()=>{const y=K("navigator.room.models");y&&y.length&&(E(y),I(y[0].name))},[]),l(T,{overflow:"hidden",children:[l(se,{overflow:"hidden",children:[l(T,{size:6,gap:1,overflow:"auto",children:[l(T,{gap:1,children:[t(S,{children:m("navigator.createroom.roomnameinfo")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:60,onChange:y=>s(y.target.value),placeholder:m("navigator.createroom.roomnameinfo")})]}),l(T,{grow:!0,gap:1,children:[t(S,{children:m("navigator.createroom.roomdescinfo")}),t("textarea",{className:"flex-grow-1 form-control form-control-sm w-100",maxLength:255,onChange:y=>c(y.target.value),placeholder:m("navigator.createroom.roomdescinfo")})]}),l(T,{gap:1,children:[t(S,{children:m("navigator.category")}),t("select",{className:"form-select form-select-sm",onChange:y=>d(Number(y.target.value)),children:b&&b.length>0&&b.map(y=>t("option",{value:y.id,children:m(y.name)},y.id))})]}),l(T,{gap:1,children:[t(S,{children:m("navigator.maxvisitors")}),t("select",{className:"form-select form-select-sm",onChange:y=>g(Number(y.target.value)),children:e&&e.map(y=>t("option",{value:y,children:y},y))})]}),l(T,{gap:1,children:[t(S,{children:m("navigator.tradesettings")}),l("select",{className:"form-select form-select-sm",onChange:y=>p(Number(y.target.value)),children:[t("option",{value:"0",children:m("navigator.roomsettings.trade_not_allowed")}),t("option",{value:"1",children:m("navigator.roomsettings.trade_not_with_Controller")}),t("option",{value:"2",children:m("navigator.roomsettings.trade_allowed")})]})]})]}),t(T,{size:6,gap:1,overflow:"auto",children:C.map((y,G)=>l(Ie,{fullHeight:!0,onClick:()=>O(y,G),itemActive:_===y.name,overflow:"unset",gap:0,className:"p-1",disabled:Cn()<y.clubLevel,children:[t(w,{fullHeight:!0,center:!0,overflow:"hidden",children:t("img",{alt:"",src:v(y.name)})}),l(S,{bold:!0,children:[y.tileSize," ",m("navigator.createroom.tilesize")]}),!N&&y.clubLevel>dn.NO_CLUB&&t(at,{position:"absolute",className:"top-1 end-1",type:"hc"})]},y.name))})]}),t(D,{fullWidth:!0,variant:!r||r.length<3?"danger":"success",onClick:R,disabled:!r||r.length<3,children:m("navigator.createroom.create")})]})},KR=o=>{const{onCloseClick:e=null}=o,[n,r]=i.useState(!1),[s,a]=i.useState(!1),[c,u]=i.useState(!1),{report:d=null}=Un(),{navigatorData:h=null}=xn(),g=p=>{switch(p){case"settings":return q().userId===h.enteredGuestRoom.ownerId||q().isModerator;case"staff_pick":return q().securityLevel>=js.COMMUNITY;case"welcome_room":return q().securityLevel>=js.COMMUNITY;default:return!1}},f=(p,C)=>{if(!(!h||!h.enteredGuestRoom))switch(p){case"set_home_room":let E=h.enteredGuestRoom.roomId;E>0&&A(new YC(E));return;case"navigator_search_tag":ee(`navigator/search/${C}`),A(new Es("hotel_view",`tag:${C}`));return;case"open_room_thumbnail_camera":St(new Gn(Gn.TOGGLE_THUMBNAIL));return;case"open_group_info":ia(h.enteredGuestRoom.habboGroupId);return;case"toggle_room_link":ee("navigator/toggle-room-link");return;case"open_room_settings":A(new zu(h.enteredGuestRoom.roomId));return;case"toggle_pick":r(_=>!_),A(new zC(h.enteredGuestRoom.roomId));return;case"set_welcome_room":A(new qC(h.enteredGuestRoom.roomId));return;case"toggle_mute":u(_=>!_),A(new jC);return;case"room_filter":A(new WC(h.enteredGuestRoom.roomId));return;case"open_floorplan_editor":ee("floor-editor/toggle");return;case"report_room":d(He.ROOM,{roomId:h.enteredGuestRoom.roomId,roomName:h.enteredGuestRoom.roomName});return;case"close":e();return}};return i.useEffect(()=>{h&&(r(h.currentRoomIsStaffPick),a(h.currentRoomIsWelcome),h.enteredGuestRoom&&u(h.enteredGuestRoom.allInRoomMuted))},[h]),h.enteredGuestRoom?l(oe,{className:"nitro-room-info",theme:"primary-slim",children:[t(ie,{headerText:m("navigator.roomsettings.roominfo"),onCloseClick:()=>f("close")}),t(re,{className:"text-black",children:h.enteredGuestRoom&&l(V,{children:[l(w,{gap:2,overflow:"hidden",children:[t(Co,{roomId:h.enteredGuestRoom.roomId,customUrl:h.enteredGuestRoom.officialRoomPicRef,children:g("settings")&&t("i",{className:"icon icon-camera-small position-absolute b-0 r-0 m-1 cursor-pointer top-0",onClick:()=>f("open_room_thumbnail_camera")})}),l(T,{grow:!0,gap:1,overflow:"hidden",children:[l(w,{gap:1,children:[l(T,{grow:!0,gap:1,children:[l(w,{gap:1,children:[t("i",{onClick:()=>f("set_home_room"),className:Gt("flex-shrink-0 icon icon-house-small cursor-pointer",h.homeRoomId!==h.enteredGuestRoom.roomId&&"gray")}),t(S,{bold:!0,children:h.enteredGuestRoom.roomName})]}),h.enteredGuestRoom.showOwner&&l(w,{alignItems:"center",gap:1,children:[t(S,{variant:"muted",children:m("navigator.roomownercaption")}),l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:h.enteredGuestRoom.ownerId}),t(S,{children:h.enteredGuestRoom.ownerName})]})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{variant:"muted",children:m("navigator.roomrating")}),t(S,{children:h.currentRoomRating})]}),h.enteredGuestRoom.tags.length>0&&t(w,{alignItems:"center",gap:1,children:h.enteredGuestRoom.tags.map(p=>l(S,{pointer:!0,className:"bg-muted rounded p-1",onClick:C=>f("navigator_search_tag",p),children:["#",p]},p))})]}),l(T,{alignItems:"center",gap:1,children:[g("settings")&&t("i",{className:"icon icon-cog cursor-pointer",title:m("navigator.room.popup.info.room.settings"),onClick:p=>f("open_room_settings")}),t(cg,{title:m("navigator.embed.caption"),className:"cursor-pointer fa-icon",onClick:p=>ee("navigator/toggle-room-link")})]})]}),t(S,{overflow:"auto",style:{maxHeight:50},children:h.enteredGuestRoom.description}),h.enteredGuestRoom.habboGroupId>0&&l(w,{pointer:!0,alignItems:"center",gap:1,onClick:()=>f("open_group_info"),children:[t(qe,{className:"flex-none",badgeCode:h.enteredGuestRoom.groupBadgeCode,isGroup:!0}),t(S,{underline:!0,children:m("navigator.guildbase",["groupName"],[h.enteredGuestRoom.groupName])})]})]})]}),l(T,{gap:1,children:[g("staff_pick")&&t(D,{onClick:()=>f("toggle_pick"),children:m(n?"navigator.staffpicks.unpick":"navigator.staffpicks.pick")}),g("welcome_room")&&t(D,{onClick:()=>f("set_welcome_room"),children:s?t(V,{children:"Quitar sala principal"}):t(V,{children:"Aadir sala principal"})}),t(D,{variant:"danger",onClick:()=>f("report_room"),children:m("help.emergency.main.report.room")}),g("settings")&&l(V,{children:[t(D,{onClick:()=>f("toggle_mute"),children:m(c?"navigator.muteall_on":"navigator.muteall_off")}),t(D,{onClick:()=>f("room_filter"),children:m("navigator.roomsettings.roomfilter")}),t(D,{onClick:()=>f("open_floorplan_editor"),children:m("open.floor.plan.editor")})]})]})]})})]}):null},XR=o=>{const{onCloseClick:e=null}=o,{navigatorData:n=null}=xn();return n.enteredGuestRoom?l(oe,{className:"nitro-room-link",theme:"primary-slim",children:[t(ie,{headerText:m("navigator.embed.title"),onCloseClick:e}),t(re,{className:"text-black d-flex align-items-center",children:l(w,{gap:2,children:[t(Co,{roomId:n.enteredGuestRoom.roomId,customUrl:n.enteredGuestRoom.officialRoomPicRef}),l(T,{children:[t(S,{bold:!0,fontSize:5,children:m("navigator.embed.headline")}),t(S,{children:m("navigator.embed.info")}),t("input",{type:"text",readOnly:!0,className:"form-control form-control-sm",value:m("navigator.embed.src",["roomId"],[n.enteredGuestRoom.roomId.toString()]).replace("${url.prefix}",K("url.prefix",""))})]})]})})]}):null},QR=o=>{const{roomData:e=null,handleChange:n=null}=o,[r,s]=i.useState(""),[a,c]=i.useState(""),[u,d]=i.useState(!1),h=()=>{!u||r.length<=0||a.length<=0||r!==a||n("password",r)};return i.useEffect(()=>{s(""),c(""),d(!1)},[e]),l(V,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.roomaccess.caption")}),t(S,{children:m("navigator.roomsettings.roomaccess.info")})]}),l(T,{overflow:"auto",children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.doormode")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===st.OPEN_STATE&&!u,onChange:g=>n("lock_state",st.OPEN_STATE)}),t(S,{children:m("navigator.roomsettings.doormode.open")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===st.DOORBELL_STATE&&!u,onChange:g=>n("lock_state",st.DOORBELL_STATE)}),t(S,{children:m("navigator.roomsettings.doormode.doorbell")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===st.INVISIBLE_STATE&&!u,onChange:g=>n("lock_state",st.INVISIBLE_STATE)}),t(S,{children:m("navigator.roomsettings.doormode.invisible")})]}),l(w,{fullWidth:!0,gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"lockState",checked:e.lockState===st.PASSWORD_STATE||u,onChange:g=>d(g.target.checked)}),!u&&e.lockState!==st.PASSWORD_STATE&&t(S,{children:m("navigator.roomsettings.doormode.password")}),(u||e.lockState===st.PASSWORD_STATE)&&l(T,{gap:1,children:[t(S,{children:m("navigator.roomsettings.doormode.password")}),t("input",{type:"password",className:"form-control form-control-sm col-4",value:r,onChange:g=>s(g.target.value),placeholder:m("navigator.roomsettings.password"),onFocus:g=>d(!0)}),u&&r.length<=0&&t(S,{bold:!0,small:!0,variant:"danger",children:m("navigator.roomsettings.passwordismandatory")}),t("input",{type:"password",className:"form-control form-control-sm col-4",value:a,onChange:g=>c(g.target.value),onBlur:h,placeholder:m("navigator.roomsettings.passwordconfirm")}),u&&r.length>0&&r!==a&&t(S,{bold:!0,small:!0,variant:"danger",children:m("navigator.roomsettings.invalidconfirm")})]})]})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.pets")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.allowPets,onChange:g=>n("allow_pets",g.target.checked)}),t(S,{children:m("navigator.roomsettings.allowpets")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.allowPetsEat,onChange:g=>n("allow_pets_eat",g.target.checked)}),t(S,{children:m("navigator.roomsettings.allowfoodconsume")})]})]})]})]})},Ac=3,Pc=60,Dc=255,Ua=15,JR=o=>{const{roomData:e=null,handleChange:n=null,onClose:r=null}=o,[s,a]=i.useState(""),[c,u]=i.useState(""),[d,h]=i.useState(""),[g,f]=i.useState(""),[p,C]=i.useState(0),[E,_]=i.useState(""),{showConfirm:I=null}=Je(),{categories:b=null}=xn();F($C,y=>{const G=y.getParser();if(G)switch(G.code){case Vl.ERROR_INVALID_TAG:_("navigator.roomsettings.unacceptablewords");case Vl.ERROR_NON_USER_CHOOSABLE_TAG:_("navigator.roomsettings.nonuserchoosabletag");break;default:_("");break}});const N=()=>{I(m("navigator.roomsettings.deleteroom.confirm.message",["room_name"],[e.roomName]),()=>{A(new KC(e.roomId)),r&&r(),ee("navigator/search/myworld_view")},null,null,null,m("navigator.roomsettings.deleteroom.confirm.title"))},v=()=>{s===e.roomName||s.length<Ac||s.length>Pc||n("name",s)},O=()=>{c===e.roomDescription||c.length>Dc||n("description",c)},R=y=>{y===0&&d===e.tags[0]||d.length>Ua||y===1&&g===e.tags[1]||g.length>Ua||(d===""&&g!==""&&f(""),_(""),C(y),n("tags",d===""&&g!==""?[g]:[d,g]))};return i.useEffect(()=>{a(e.roomName),u(e.roomDescription),h(e.tags.length>0&&e.tags[0]?e.tags[0]:""),f(e.tags.length>0&&e.tags[1]?e.tags[1]:"")},[e]),l(V,{children:[l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("navigator.roomname")}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:s,maxLength:Pc,onChange:y=>a(y.target.value),onBlur:v}),s.length<Ac&&t(S,{bold:!0,small:!0,variant:"danger",children:m("navigator.roomsettings.roomnameismandatory")})]})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("navigator.roomsettings.desc")}),t("textarea",{className:"form-control form-control-sm",value:c,maxLength:Dc,onChange:y=>u(y.target.value),onBlur:O})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("navigator.category")}),t("select",{className:"form-select form-select-sm",value:e.categoryId,onChange:y=>n("category",y.target.value),children:b&&b.map(y=>t("option",{value:y.id,children:m(y.name)},y.id))})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("navigator.maxvisitors")}),t("select",{className:"form-select form-select-sm",value:e.userCount,onChange:y=>n("max_visitors",y.target.value),children:ic&&ic.map(y=>t("option",{value:y,children:y},y))})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("navigator.tradesettings")}),l("select",{className:"form-select form-select-sm",value:e.tradeState,onChange:y=>n("trade_state",y.target.value),children:[t("option",{value:"0",children:m("navigator.roomsettings.trade_not_allowed")}),t("option",{value:"1",children:m("navigator.roomsettings.trade_not_with_Controller")}),t("option",{value:"2",children:m("navigator.roomsettings.trade_allowed")})]})]}),l(w,{alignItems:"center",gap:1,children:[t(S,{className:"col-3",children:m("navigator.tags")}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:d,onChange:y=>h(y.target.value),onBlur:()=>R(0)}),d.length>Ua&&t(S,{bold:!0,small:!0,variant:"danger",children:m("navigator.roomsettings.toomanycharacters")}),p===0&&E!=""&&t(S,{bold:!0,small:!0,variant:"danger",children:m(E)})]}),l(T,{fullWidth:!0,gap:0,children:[t("input",{className:"form-control form-control-sm",value:g,onChange:y=>f(y.target.value),onBlur:()=>R(1)}),g.length>Ua&&t(S,{bold:!0,small:!0,variant:"danger",children:m("navigator.roomsettings.toomanycharacters")}),p===1&&E!=""&&t(S,{bold:!0,small:!0,variant:"danger",children:m(E)})]})]}),l(w,{alignItems:"center",gap:1,children:[t(P,{className:"col-3"}),t("input",{className:"form-check-input",type:"checkbox",checked:e.allowWalkthrough,onChange:y=>n("allow_walkthrough",y.target.checked)}),t(S,{children:m("navigator.roomsettings.allow_walk_through")})]}),l(S,{variant:"danger",underline:!0,bold:!0,pointer:!0,className:"d-flex justify-content-center align-items-center gap-1",onClick:N,children:[t(hn,{className:"fa-icon"}),m("navigator.roomsettings.delete")]})]})},ZR=o=>{var d;const{roomData:e=null,handleChange:n=null}=o,[r,s]=i.useState(-1),[a,c]=i.useState([]),u=h=>{c(g=>{const f=[...g],p=f.findIndex(C=>C.userId===h);return p>=0&&f.splice(p,1),f}),A(new QC(h,e.roomId)),s(-1)};return F(XC,h=>{const g=h.getParser();!e||e.roomId!==g.roomId||c(g.bannedUsers)}),i.useEffect(()=>{A(new nd(e.roomId))},[e.roomId]),l(se,{overflow:"auto",children:[l(T,{size:6,children:[l(S,{bold:!0,children:[m("navigator.roomsettings.moderation.banned.users")," (",a.length,")"]}),t(w,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:t(T,{fullWidth:!0,overflow:"auto",gap:1,children:a&&a.length>0&&a.map((h,g)=>l(w,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[t(bn,{userName:h.userName}),l(S,{pointer:!0,grow:!0,onClick:f=>s(h.userId),children:[" ",h.userName]})]},g))})}),l(D,{disabled:r<=0,onClick:h=>u(r),children:[m("navigator.roomsettings.moderation.unban")," ",r>0&&((d=a.find(h=>h.userId===r))==null?void 0:d.userName)]})]}),l(T,{size:6,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.moderation.mute.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowMute,onChange:h=>n("moderation_mute",h.target.value),children:[t("option",{value:Fn.MODERATION_LEVEL_NONE,children:m("navigator.roomsettings.moderation.none")}),t("option",{value:Fn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:m("navigator.roomsettings.moderation.rights")})]})})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.moderation.kick.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowKick,onChange:h=>n("moderation_kick",h.target.value),children:[t("option",{value:Fn.MODERATION_LEVEL_NONE,children:m("navigator.roomsettings.moderation.none")}),t("option",{value:Fn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:m("navigator.roomsettings.moderation.rights")}),t("option",{value:Fn.MODERATION_LEVEL_ALL,children:m("navigator.roomsettings.moderation.all")})]})})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.moderation.ban.header")}),t(w,{alignItems:"center",gap:1,children:l("select",{className:"form-select form-select-sm",value:e.moderationSettings.allowBan,onChange:h=>n("moderation_ban",h.target.value),children:[t("option",{value:Fn.MODERATION_LEVEL_NONE,children:m("navigator.roomsettings.moderation.none")}),t("option",{value:Fn.MODERATION_LEVEL_USER_WITH_RIGHTS,children:m("navigator.roomsettings.moderation.rights")})]})})]})]})]})},ey=o=>{const{roomData:e=null}=o,[n,r]=i.useState(new Map);return F(JC,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(a.users)}),F(ZC,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(c=>{const u=new Map(c);return u.set(a.data.userId,a.data.userName),u})}),F(e_,s=>{const a=s.getParser();!e||e.roomId!==a.roomId||r(c=>{const u=new Map(c);return u.delete(a.userId),u})}),i.useEffect(()=>{A(new t_(e.roomId))},[e.roomId]),l(se,{children:[l(T,{size:6,children:[t(S,{bold:!0,children:m("navigator.flatctrls.userswithrights",["displayed","total"],[n.size.toString(),n.size.toString()])}),t(w,{overflow:"hidden",className:"bg-white rounded list-container p-2",children:t(T,{fullWidth:!0,overflow:"auto",gap:1,children:Array.from(n.entries()).map(([s,a],c)=>l(w,{shrink:!0,alignItems:"center",gap:1,overflow:"hidden",children:[t(bn,{userName:a}),l(S,{pointer:!0,grow:!0,onClick:u=>A(new n_(s)),children:[" ",a]})]},c))})})]}),t(T,{size:6,justifyContent:"end",children:t(D,{variant:"danger",disabled:!n.size,onClick:s=>A(new r_(e.roomId)),children:m("navigator.flatctrls.clear")})})]})},ty=o=>{const{roomData:e=null,handleChange:n=null}=o,[r,s]=i.useState(0);return i.useEffect(()=>{s(e.chatSettings.distance)},[e.chatSettings]),l(V,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.vip.caption")}),t(S,{children:m("navigator.roomsettings.vip.info")})]}),l(se,{overflow:"auto",children:[l(T,{size:6,gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.chat_settings")}),t(S,{children:m("navigator.roomsettings.chat_settings.info")}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.mode,onChange:a=>n("bubble_mode",a.target.value),children:[t("option",{value:Et.CHAT_MODE_FREE_FLOW,children:m("navigator.roomsettings.chat.mode.free.flow")}),t("option",{value:Et.CHAT_MODE_LINE_BY_LINE,children:m("navigator.roomsettings.chat.mode.line.by.line")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.weight,onChange:a=>n("chat_weight",a.target.value),children:[t("option",{value:Et.CHAT_BUBBLE_WIDTH_NORMAL,children:m("navigator.roomsettings.chat.bubbles.width.normal")}),t("option",{value:Et.CHAT_BUBBLE_WIDTH_THIN,children:m("navigator.roomsettings.chat.bubbles.width.thin")}),t("option",{value:Et.CHAT_BUBBLE_WIDTH_WIDE,children:m("navigator.roomsettings.chat.bubbles.width.wide")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.speed,onChange:a=>n("bubble_speed",a.target.value),children:[t("option",{value:Et.CHAT_SCROLL_SPEED_FAST,children:m("navigator.roomsettings.chat.speed.fast")}),t("option",{value:Et.CHAT_SCROLL_SPEED_NORMAL,children:m("navigator.roomsettings.chat.speed.normal")}),t("option",{value:Et.CHAT_SCROLL_SPEED_SLOW,children:m("navigator.roomsettings.chat.speed.slow")})]}),l("select",{className:"form-select form-select-sm",value:e.chatSettings.protection,onChange:a=>n("flood_protection",a.target.value),children:[t("option",{value:Et.FLOOD_FILTER_LOOSE,children:m("navigator.roomsettings.chat.flood.loose")}),t("option",{value:Et.FLOOD_FILTER_NORMAL,children:m("navigator.roomsettings.chat.flood.normal")}),t("option",{value:Et.FLOOD_FILTER_STRICT,children:m("navigator.roomsettings.chat.flood.strict")})]}),t(S,{children:m("navigator.roomsettings.chat_settings.hearing.distance")}),t("input",{type:"number",min:"0",className:"form-control form-control-sm",value:r,onChange:a=>s(a.target.valueAsNumber),onBlur:a=>n("chat_distance",r)})]}),l(T,{size:6,gap:1,children:[t(S,{bold:!0,children:m("navigator.roomsettings.vip_settings")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:e.hideWalls,onChange:a=>n("hide_walls",a.target.checked)}),t(S,{children:m("navigator.roomsettings.hide_walls")})]}),l("select",{className:"form-select form-select-sm",value:e.wallThickness,onChange:a=>n("wall_thickness",a.target.value),children:[t("option",{value:"0",children:m("navigator.roomsettings.wall_thickness.normal")}),t("option",{value:"1",children:m("navigator.roomsettings.wall_thickness.thick")}),t("option",{value:"-1",children:m("navigator.roomsettings.wall_thickness.thin")}),t("option",{value:"-2",children:m("navigator.roomsettings.wall_thickness.thinnest")})]}),l("select",{className:"form-select form-select-sm",value:e.floorThickness,onChange:a=>n("floor_thickness",a.target.value),children:[t("option",{value:"0",children:m("navigator.roomsettings.floor_thickness.normal")}),t("option",{value:"1",children:m("navigator.roomsettings.floor_thickness.thick")}),t("option",{value:"-1",children:m("navigator.roomsettings.floor_thickness.thin")}),t("option",{value:"-2",children:m("navigator.roomsettings.floor_thickness.thinnest")})]})]})]})]})},Nr=["navigator.roomsettings.tab.1","navigator.roomsettings.tab.2","navigator.roomsettings.tab.3","navigator.roomsettings.tab.4","navigator.roomsettings.tab.5"],ny=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(Nr[0]);F(s_,u=>{const d=u.getParser();if(!d)return;const h=d.data;n({roomId:h.roomId,roomName:h.name,roomDescription:h.description,categoryId:h.categoryId,userCount:h.maximumVisitorsLimit,tags:h.tags,tradeState:h.tradeMode,allowWalkthrough:h.allowWalkThrough,lockState:h.doorMode,password:null,allowPets:h.allowPets,allowPetsEat:h.allowFoodConsume,hideWalls:h.hideWalls,wallThickness:h.wallThickness,floorThickness:h.floorThickness,chatSettings:{mode:h.chatSettings.mode,weight:h.chatSettings.weight,speed:h.chatSettings.speed,distance:h.chatSettings.distance,protection:h.chatSettings.protection},moderationSettings:{allowMute:h.roomModerationSettings.allowMute,allowKick:h.roomModerationSettings.allowKick,allowBan:h.roomModerationSettings.allowBan}}),A(new nd(h.roomId))});const a=()=>{n(null),s(Nr[0])},c=(u,d)=>{n(h=>{const g={...h};switch(u){case"name":g.roomName=String(d);break;case"description":g.roomDescription=String(d);break;case"category":g.categoryId=Number(d);break;case"max_visitors":g.userCount=Number(d);break;case"trade_state":g.tradeState=Number(d);break;case"tags":g.tags=d;break;case"allow_walkthrough":g.allowWalkthrough=!!d;break;case"allow_pets":g.allowPets=!!d;break;case"allow_pets_eat":g.allowPetsEat=!!d;break;case"hide_walls":g.hideWalls=!!d;break;case"wall_thickness":g.wallThickness=Number(d);break;case"floor_thickness":g.floorThickness=Number(d);break;case"lock_state":g.lockState=Number(d);break;case"password":g.lockState=st.PASSWORD_STATE,g.password=String(d);break;case"moderation_mute":g.moderationSettings.allowMute=Number(d);break;case"moderation_kick":g.moderationSettings.allowKick=Number(d);break;case"moderation_ban":g.moderationSettings.allowBan=Number(d);break;case"bubble_mode":g.chatSettings.mode=Number(d);break;case"chat_weight":g.chatSettings.weight=Number(d);break;case"bubble_speed":g.chatSettings.speed=Number(d);break;case"flood_protection":g.chatSettings.protection=Number(d);break;case"chat_distance":g.chatSettings.distance=Number(d);break}return A(new a_(g.roomId,g.roomName,g.roomDescription,g.lockState,g.password,g.userCount,g.categoryId,g.tags.length,g.tags,g.tradeState,g.allowPets,g.allowPetsEat,g.allowWalkthrough,g.hideWalls,g.wallThickness,g.floorThickness,g.moderationSettings.allowMute,g.moderationSettings.allowKick,g.moderationSettings.allowBan,g.chatSettings.mode,g.chatSettings.weight,g.chatSettings.speed,g.chatSettings.distance,g.chatSettings.protection)),g})};return e?l(oe,{uniqueKey:"nitro-room-settings",className:"nitro-room-settings",children:[t(ie,{headerText:m("navigator.roomsettings"),onCloseClick:a}),t(lr,{children:Nr.map(u=>t(Mn,{isActive:r===u,onClick:d=>s(u),children:m(u)},u))}),l(re,{children:[r===Nr[0]&&t(JR,{roomData:e,handleChange:c,onClose:a}),r===Nr[1]&&t(QR,{roomData:e,handleChange:c}),r===Nr[2]&&t(ey,{roomData:e,handleChange:c}),r===Nr[3]&&t(ty,{roomData:e,handleChange:c}),r===Nr[4]&&t(ZR,{roomData:e,handleChange:c})]})]}):null},Mc=o=>{const{roomData:e=null}=o,[n,r]=i.useState(!1),s=i.useRef(),a=()=>{const c=100*(e.userCount/e.maxUserCount);let u="bg-primary";return c>=92?u="bg-danger":c>=50?u="bg-warning":c>0&&(u="bg-success"),u};return l(V,{children:[t(P,{pointer:!0,innerRef:s,className:"icon icon-navigator-info",onMouseOver:c=>r(!0),onMouseLeave:c=>r(!1)}),t(lo,{show:n,target:s.current,placement:"right",children:t(ps,{children:t(re,{overflow:"hidden",className:"room-info image-rendering-pixelated bg-transparent",children:l(w,{gap:2,overflow:"hidden",children:[l(Co,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&t(qe,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1 "}),e.doorMode!==st.OPEN_STATE&&t("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===st.DOORBELL_STATE?"locked":e.doorMode===st.PASSWORD_STATE?"password":e.doorMode===st.INVISIBLE_STATE?"invisible":"")})]}),l(T,{gap:1,children:[t(S,{bold:!0,truncate:!0,className:"flex-grow-1",style:{maxHeight:13},children:e.roomName}),l(w,{gap:2,children:[t(S,{italics:!0,variant:"muted",children:m("navigator.roomownercaption")}),l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:e.ownerId}),t(S,{italics:!0,children:e.ownerName})]})]}),t(S,{className:"flex-grow-1",children:e.description}),l(w,{className:"badge p-1 position-absolute m-1 bottom-0 end-0 m-2 "+a(),gap:1,children:[t(Ei,{className:"fa-icon"}),e.userCount]})]})]})})})})]})},Lc=o=>{const{roomData:e=null,children:n=null,thumbnail:r=!1,...s}=o,{setDoorData:a=null}=xn(),c=()=>{const d=100*(e.userCount/e.maxUserCount);let h="bg-primary";return d>=92?h="bg-danger":d>=50?h="bg-warning":d>0&&(h="bg-success"),h},u=d=>{if(e.ownerId!==q().userId){if(e.habboGroupId!==0){_n(e.roomId);return}switch(e.doorMode){case st.DOORBELL_STATE:a(h=>{const g={...h};return g.roomInfo=e,g.state=De.START_DOORBELL,g});return;case st.PASSWORD_STATE:a(h=>{const g={...h};return g.roomInfo=e,g.state=De.START_PASSWORD,g});return}}qr(e.roomId)};return r?l(T,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:u,gap:0,className:"navigator-item p-1 bg-light rounded-3 small mb-1 flex-column border border-muted",...s,children:[l(Co,{roomId:e.roomId,customUrl:e.officialRoomPicRef,className:"d-flex flex-column align-items-center justify-content-end mb-1",children:[e.habboGroupId>0&&t(qe,{badgeCode:e.groupBadgeCode,isGroup:!0,className:"position-absolute top-0 start-0 m-1"}),l(w,{center:!0,className:"badge p-1 position-absolute m-1 "+c(),gap:1,children:[t(Ei,{className:"fa-icon"}),e.userCount]}),e.doorMode!==st.OPEN_STATE&&t("i",{className:"position-absolute end-0 mb-1 me-1 icon icon-navigator-room-"+(e.doorMode===st.DOORBELL_STATE?"locked":e.doorMode===st.PASSWORD_STATE?"password":e.doorMode===st.INVISIBLE_STATE?"invisible":"")})]}),l(w,{className:"w-100",children:[t(S,{truncate:!0,className:"flex-grow-1",children:e.roomName}),t(w,{reverse:!0,alignItems:"center",gap:1,children:t(Mc,{roomData:e})}),n]})]}):l(w,{pointer:!0,overflow:"hidden",alignItems:"center",onClick:u,gap:2,className:"navigator-item px-2 py-1 small",...s,children:[l(w,{center:!0,className:"badge p-1 "+c(),gap:1,children:[t(Ei,{className:"fa-icon"}),e.userCount]}),t(S,{truncate:!0,grow:!0,children:e.roomName}),l(w,{reverse:!0,alignItems:"center",gap:1,children:[t(Mc,{roomData:e}),e.habboGroupId>0&&t("i",{className:"icon icon-navigator-room-group"}),e.doorMode!==st.OPEN_STATE&&t("i",{className:"icon icon-navigator-room-"+(e.doorMode===st.DOORBELL_STATE?"locked":e.doorMode===st.PASSWORD_STATE?"password":e.doorMode===st.INVISIBLE_STATE?"invisible":"")})]}),n]})},ry=o=>{const{searchResult:e=null,...n}=o,[r,s]=i.useState(!0),[a,c]=i.useState(0),{topLevelContext:u=null}=xn(),d=()=>{let p=e.code;return!p||!p.length||m("navigator.searchcode.title."+p)=="navigator.searchcode.title."+p?e.data:p.startsWith("${")?p.slice(2,p.length-1):"navigator.searchcode.title."+p},h=()=>{c(p=>p===fr.LIST?fr.THUMBNAILS:fr.LIST)},g=()=>{e.action==1?A(new Es(e.code,"")):e.action==2&&u&&A(new Es(u.code,""))};i.useEffect(()=>{e&&(s(!e.closed),c(e.mode))},[e]);const f=a>=fr.THUMBNAILS;return l(T,{className:"bg-white rounded border border-muted",gap:0,children:[l(w,{fullWidth:!0,alignItems:"center",justifyContent:"between",className:"px-2 py-1",children:[l(w,{grow:!0,pointer:!0,alignItems:"center",gap:1,onClick:p=>s(C=>!C),children:[r&&t(ug,{className:"text-secondary fa-icon"}),!r&&t(Js,{className:"text-secondary fa-icon"}),t(S,{children:m(d())})]}),l(w,{gap:2,children:[a===fr.LIST&&t(dg,{className:"text-secondary fa-icon",onClick:h}),a>=fr.THUMBNAILS&&t(mg,{className:"text-secondary fa-icon",onClick:h}),e.action>0&&e.action===1&&t(gg,{className:"text-secondary fa-icon",onClick:g}),e.action>0&&e.action!==1&&t(hg,{className:"text-secondary fa-icon",onClick:g})]})]})," ",r&&t(V,{children:f?t(ke,{columnCount:3,...n,columnMinWidth:110,columnMinHeight:130,className:"mx-2",children:e.rooms.length>0&&e.rooms.map((p,C)=>t(Lc,{roomData:p,thumbnail:!0},C))}):t(se,{columnCount:1,className:"navigator-grid",gap:0,children:e.rooms.length>0&&e.rooms.map((p,C)=>t(Lc,{roomData:p},C))})})]})},sy=o=>{const{sendSearch:e=null}=o,[n,r]=i.useState(0),[s,a]=i.useState(""),{topLevelContext:c=null,searchResult:u=null}=xn(),d=()=>{if(!c)return;let g=rs[n];g||(g=rs[0]);const f=(g.query?g.query+":":"")+s;e(f||"",c.code)},h=g=>{g.key==="Enter"&&d()};return i.useEffect(()=>{if(!u)return;const g=u.data.split(":");let f=null,p="";if(g.length>=2){const[C,...E]=g;f=rs.find(_=>_.query===C),p=E.join(":")}else p=u.data;f||(f=rs[0]),r(rs.findIndex(C=>C===f)),a(p)},[u]),l(w,{fullWidth:!0,gap:1,children:[t(w,{shrink:!0,children:t("select",{className:"form-select form-select-sm",value:n,onChange:g=>r(parseInt(g.target.value)),children:rs.map((g,f)=>t("option",{value:f,children:m("navigator.filter."+g.name)},f))})}),l(w,{fullWidth:!0,gap:1,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:m("navigator.filter.input.placeholder"),value:s,onChange:g=>a(g.target.value),onKeyDown:g=>h(g)}),t(D,{variant:"primary",onClick:d,children:t(io,{className:"fa-icon"})})]})]})},ay=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(!1),[a,c]=i.useState(!1),[u,d]=i.useState(!1),[h,g]=i.useState(!1),[f,p]=i.useState(!1),[C,E]=i.useState(!0),[_,I]=i.useState(!1),{searchResult:b=null,topLevelContext:N=null,topLevelContexts:v=null,navigatorData:O=null}=xn(),R=i.useRef(null),y=i.useRef();Ye(jt.CREATED,B=>{n(!1),c(!1)});const G=i.useCallback((B,M)=>{c(!1),A(new Es(M,B)),p(!0)},[]),k=i.useCallback(()=>{if(!r){I(!0);return}if(R.current){G(R.current.value,R.current.code),R.current=null;return}if(b){G(b.data,b.code);return}N&&G("",N.code)},[r,b,N,G]);return i.useEffect(()=>{const B={linkReceived:M=>{const U=M.split("/");if(!(U.length<2))switch(U[1]){case"show":{n(!0),I(!0);return}case"hide":n(!1);return;case"toggle":{if(e){n(!1);return}n(!0),I(!0);return}case"toggle-room-info":d(W=>!W);return;case"toggle-room-link":g(W=>!W);return;case"goto":if(U.length<=2)return;switch(U[2]){case"home":if(O.homeRoomId<=0)return;_n(O.homeRoomId);break;default:{const W=parseInt(U[2]);_n(W)}}return;case"create":n(!0),c(!0);return;case"search":if(U.length>2){const W=U[2];let L="";U.length>3&&(L=U[3]),R.current={value:L,code:W},n(!0),I(!0)}return}},eventUrlPrefix:"navigator/"};return ut(B),()=>dt(B)},[e,O]),i.useEffect(()=>{b&&(p(!1),y&&y.current&&(y.current.scrollTop=0))},[b]),i.useEffect(()=>{!e||!r||!_||(k(),I(!1))},[e,r,_,k]),i.useEffect(()=>{r||!N||s(!0)},[r,N]),i.useEffect(()=>{!e||!C||(A(new o_),E(!1))},[e,C]),i.useEffect(()=>{qs.addCallback(Zs.OPENROOM,(B,M=!1,U=null)=>A(new i_(B)))},[]),l(V,{children:[e&&l(oe,{uniqueKey:"navigator",className:"nitro-navigator",children:[t(ie,{headerText:m(a?"navigator.createroom.title":"navigator.title"),onCloseClick:B=>n(!1)}),l(lr,{children:[v&&v.length>0&&v.map((B,M)=>t(Mn,{isActive:N===B&&!a,onClick:U=>G("",B.code),children:m("navigator.toplevelview."+B.code)},M)),t(Mn,{isActive:a,onClick:B=>c(!0),children:t(Js,{className:"fa-icon"})})]}),l(re,{position:"relative",children:[f&&t(P,{fit:!0,position:"absolute",className:"top-0 start-0 z-index-1 bg-muted opacity-0-5"}),!a&&l(V,{children:[t(sy,{sendSearch:G}),t(T,{innerRef:y,overflow:"auto",children:b&&b.results.map((B,M)=>t(ry,{searchResult:B},M))})]}),a&&t($R,{})]})]}),t(YR,{}),u&&t(KR,{onCloseClick:()=>d(!1)}),h&&t(XR,{onCloseClick:()=>g(!1)}),t(ny,{})]})},oy=/\n\r|\n|\r/mg,iy=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(""),[a,c]=i.useState(null),u=i.useRef(null);return i.useEffect(()=>{const d=async g=>{try{const f=await fetch(g);if(!f)return;const C=(await f.text()).split(oy),E=C.shift().split("|");s(E[0]),c(_=>E[1]&&E[1].split(";").length===2?{width:parseInt(E[1].split(";")[0]),height:parseInt(E[1].split(";")[1])}:null),n(C.join(""))}catch{Au.error(`Failed to fetch ${g}`)}},h={linkReceived:g=>{const f=g.split("/");f.length<2||(f.shift(),d(K("habbopages.url")+f.join("/")))},eventUrlPrefix:"habbopages/"};return ut(h),()=>dt(h)},[]),i.useEffect(()=>{const d=h=>{if(!(h.target instanceof HTMLAnchorElement))return;h.preventDefault();const g=h.target.href;!g||!g.length||Xr(g)};return document.addEventListener("click",d),()=>{document.removeEventListener("click",d)}},[]),e?l(oe,{className:"nitropedia",theme:"primary-slim",style:a?{width:a.width,height:a.height}:{},children:[t(ie,{headerText:r,onCloseClick:()=>n(null)}),t(re,{children:t(P,{fit:!0,innerRef:u,className:"text-black",dangerouslySetInnerHTML:{__html:e}})})]}):null},ly=o=>{const{offer:e=null,setOpen:n=null}=o;if(e)return l(cl,{fadesOut:!1,onClose:null,onClick:r=>n(!0),gap:2,children:[t(P,{className:"nitro-targeted-offer-icon",style:{backgroundImage:`url(${K("image.library.url")+e.iconImageUrl})`}}),t(S,{variant:"light",className:"ubuntu-bold",children:e.title})]})},cy=o=>{const{offer:e=null,setOpen:n=null}=o,{getCurrencyAmount:r}=es(),[s,a]=i.useState(1),c=i.useMemo(()=>{let h=!1,g=!1,f=!1;return e.priceInCredits>0&&(h=r(-1)>=e.priceInCredits),e.priceInActivityPoints>0?g=r(e.activityPointType)>=e.priceInActivityPoints:g=!0,e.purchaseLimit>0&&(f=!0),h&&g&&f},[e,r]),u=()=>{let h=Math.max(0,(e.expirationTime-Date.now())/1e3);return jn.format(h)},d=()=>{A(new l_(e.id,s)),A(new rd)};if(e)return l(oe,{theme:"primary-slim",uniqueKey:"targeted-offer",className:"nitro-targeted-offer",children:[t(ie,{headerText:m(e.title),onCloseClick:h=>n(!1)}),t(qd,{position:"relative",className:"justify-content-center align-items-center cursor-pointer",variant:"danger",gap:3,children:m("targeted.offer.timeleft",["timeleft"],[u()])}),l(re,{gap:1,children:[l(w,{gap:1,fullHeight:!0,children:[l(w,{gap:1,column:!0,className:"w-75 text-black",children:[l(T,{className:"bg-warning p-2",fullHeight:!0,children:[t("h4",{children:m(e.title)}),t(P,{dangerouslySetInnerHTML:{__html:e.description}})]}),l(w,{alignSelf:"center",alignItems:"center",justifyContent:"center",gap:2,children:[e.purchaseLimit>1&&l(w,{gap:1,children:[t(S,{variant:"muted",children:m("catalog.bundlewidget.quantity")}),t("input",{type:"number",value:s,onChange:h=>a(parseInt(h.target.value)),min:1,max:e.purchaseLimit})]}),t(D,{variant:"primary",disabled:!c,onClick:()=>d(),children:m("targeted.offer.button.buy")})]})]}),t(P,{className:"w-50",fullHeight:!0,style:{background:`url(${K("image.library.url")+e.imageUrl}) no-repeat center`}})]}),l(w,{className:"price-ray position-absolute",alignItems:"center",justifyContent:"center",column:!0,children:[t(S,{children:m("targeted.offer.price.label")}),e.priceInCredits>0&&l(w,{gap:1,children:[t(S,{variant:"light",children:e.priceInCredits}),t(at,{type:-1})]}),e.priceInActivityPoints>0&&l(w,{gap:1,children:[l(S,{className:"ubuntu-bold",variant:"light",children:["+",e.priceInActivityPoints]})," ",t(at,{type:e.activityPointType})]})]})]})]})},uy=()=>{const[o,e]=i.useState(null),[n,r]=i.useState(!1);if(F(c_,s=>{let a=s.getParser();a&&e(a.data)}),Sm(()=>{A(new rd)}),!!o)return t(V,{children:n?t(cy,{offer:o,setOpen:r}):t(ly,{offer:o,setOpen:r})})},dy=o=>{const[e,n]=i.useState(0),[r,s]=i.useState(null),[a,c]=i.useState(!0),{showConfirm:u=null}=Je();F(sd,p=>{n(0),s(null)}),F(Vu,p=>{n(0),s(null)}),F(ws,p=>{const C=p.getParser();C.roomEnter&&(C.data.habboGroupId>0?(n(C.data.habboGroupId),A(new Ws(C.data.habboGroupId,!1))):(n(0),s(null)))}),F(u_,p=>{const C=p.getParser();!r||C.groupId!==r.id&&C.groupId!==e||(n(0),s(null))}),F(ta,p=>{const C=p.getParser();C.id===e&&s(C)});const d=()=>{u(m("group.leaveconfirm.desc"),()=>{A(new Ki(r.id,q().userId))},null)},h=r&&r.ownerName===q().userName,g=()=>{if(h)return"group.manage";if(r.type===ln.PRIVATE)return"";if(r.membershipType===vt.MEMBER)return"group.leave";if(r.membershipType===vt.NOT_MEMBER&&r.type===ln.REGULAR)return"group.join";if(r.membershipType===vt.REQUEST_PENDING)return"group.membershippending";if(r.membershipType===vt.NOT_MEMBER&&r.type===ln.EXCLUSIVE)return"group.requestmembership"},f=()=>{if(h)return Od(r.id);if(!(r.type===ln.PRIVATE&&r.membershipType===vt.NOT_MEMBER)){if(r.membershipType===vt.MEMBER){d();return}al(r.id)}};return r?t(P,{className:"nitro-notification-bubble rounded",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:p=>c(C=>!C),children:[t(S,{variant:"white",children:m("group.homeroominfo.title")}),a&&t(qi,{className:"fa-icon"}),!a&&t(zi,{className:"fa-icon"})]}),a&&l(V,{children:[l(w,{pointer:!0,alignItems:"center",gap:2,onClick:p=>ia(r.id),children:[t(P,{className:"group-badge",children:t(qe,{badgeCode:r.badge,isGroup:!0})}),t(S,{variant:"white",children:r.title})]}),(r.type!==ln.PRIVATE||h)&&t(D,{fullWidth:!0,variant:"success",disabled:r.membershipType===vt.REQUEST_PENDING,onClick:f,children:m(g())})]})]})}):null},my=o=>{const{title:e="Nitro",onClose:n=null,...r}=o;return t(Io,{title:e,onClose:n,...r,children:l(se,{children:[t(T,{center:!0,size:5,children:t("object",{data:"https://assets.nitrodev.co/logos/nitro-n-dark.svg",width:"100",height:"100",children:""})}),l(T,{size:7,children:[l(T,{alignItems:"center",gap:0,children:[t(S,{bold:!0,fontSize:4,children:"Nitro React"}),l(S,{children:["v",yd()]})]}),l(T,{alignItems:"center",children:[l(S,{children:[t("b",{children:"Renderer:"})," v",qb()]}),l(T,{fullWidth:!0,gap:1,children:[t(D,{fullWidth:!0,variant:"success",onClick:s=>window.open("https://discord.nitrodev.co"),children:"Discord"}),l(w,{gap:1,children:[t(D,{fullWidth:!0,onClick:s=>window.open("https://git.krews.org/nitro/nitro-react"),children:"Git"}),t(D,{fullWidth:!0,onClick:s=>window.open("https://git.krews.org/nitro/nitro-react/-/issues"),children:"Bug Report"})]})]})]})]})]})})},gy=o=>{const{item:e=null,title:n=o.item&&o.item.title||"",onClose:r=null,...s}=o,[a,c]=i.useState(!1),u=()=>{Xr(e.clickUrl),r()},d=e.alertType===ue.DEFAULT;return l(Io,{title:n,onClose:r,...s,type:d?ue.DEFAULT:e.alertType,children:[l(w,{fullHeight:!0,overflow:"auto",gap:d||e.imageUrl&&!a?2:0,children:[d&&!e.imageUrl&&t(P,{className:"notification-frank flex-shrink-0"}),e.imageUrl&&!a&&t("img",{src:e.imageUrl,alt:e.title,onError:()=>{c(!0)},className:"align-self-baseline"}),l(P,{classNames:["notification-text overflow-y-auto d-flex flex-column w-100",e.clickUrl&&!d?"justify-content-center":""],children:[e.messages.length>0&&e.messages.map((h,g)=>{const f=h.replace(/\r\n|\r|\n/g,"<br />");return t(P,{dangerouslySetInnerHTML:{__html:f}},g)}),e.clickUrl&&e.clickUrl.length>0&&e.imageUrl&&!a&&l(V,{children:[t("hr",{className:"my-2 w-100"}),t(D,{onClick:u,className:"align-self-center px-3",children:m(e.clickUrlText)})]})]})]}),(!e.imageUrl||e.imageUrl&&a)&&t(V,{children:l(T,{alignItems:"center",center:!0,gap:0,children:[t("hr",{className:"my-2 w-100"}),!e.clickUrl&&t(D,{onClick:r,children:m("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&t(D,{onClick:u,children:m(e.clickUrlText)})]})})]})},hy=o=>{const{item:e=null,title:n=o.item&&o.item.title||"",onClose:r=null,...s}=o,[a,c]=i.useState(""),[u,d]=i.useState([]),h=()=>{Xr(e.clickUrl),r()},g=p=>{let C=JSON.parse(e.messages[0]);d(C.filter(E=>E.includes(p))),c(p)};i.useEffect(()=>{d(JSON.parse(e.messages[0]))},[e]);const f=e.clickUrl&&e.clickUrl.startsWith("event:");return l(Io,{title:n,onClose:r,...s,children:[t(w,{fullWidth:!0,alignItems:"center",position:"relative",children:t("input",{type:"text",className:"form-control form-control-sm",placeholder:m("generic.search"),value:a,onChange:p=>g(p.target.value)})}),t(T,{fullHeight:!0,className:"py-1",overflow:"hidden",children:t(ke,{gap:1,columnCount:1,children:u&&u.map((p,C)=>t("span",{children:p},C))})}),t("hr",{className:"my-2"}),l(T,{alignItems:"center",center:!0,gap:1,children:[!f&&!e.clickUrl&&t(D,{onClick:r,children:m("generic.close")}),e.clickUrl&&e.clickUrl.length>0&&t(D,{onClick:h,children:m(e.clickUrlText)})]})]})},fy=o=>{const{fadesOut:e=!0,timeoutMs:n=8e3,item:r=null,onClose:s=null,...a}=o,[c,u]=i.useState(!1);var d=new Audio(K("url.sounds")+"notifications.mp3");return i.useEffect(()=>(u(!0),d.play(),()=>u(!1)),[]),i.useEffect(()=>{if(!e)return;const h=setTimeout(()=>{u(!1),setTimeout(()=>s(),300)},n);return()=>clearTimeout(h)},[e,n,s]),t(Rs,{type:bt.SLIDE_LEFT,inProp:c,timeout:300,children:l(oe,{className:"nitro-notification-top-container slideDown",style:{resize:"none",border:"1px solid #292826",overflow:"hidden"},disableDrag:!0,windowPosition:Rt.TOP_CENTER,overflow:"hidden",children:[t(IS,{headerText:"Mensaje de los Staffs",onCloseClick:s}),t(re,{grow:!0,justifyContent:"between",overflow:"hidden",className:"text-white",gap:2,style:{backgroundColor:"rgb(31 32 29 / 85%)",height:"100%",minHeight:"60px"},children:l(w,{fullHeight:!0,overflow:"auto",gap:2,children:[r.imageUrl!=null?t(V,{children:t("img",{className:"no-select",src:r.imageUrl,alt:""})}):t(V,{children:t("img",{className:"no-select",src:K("image.library.notifications.url","").replace("%image%","generic"),alt:""})}),t(P,{classNames:["notification-text d-flex flex-column w-100 justify-content-center"],children:r.messages.length>0&&r.messages.map((h,g)=>{const f=h.replace(/\r\n|\r|\n/g,"<br />");return t(P,{dangerouslySetInnerHTML:{__html:f}},g)})})]})})]})})},Uc=(o,e)=>{if(!o)return null;const n={key:o.id,item:o,onClose:e};switch(o.alertType){case ue.NITRO:return t(my,{...n});case ue.SEARCH:return t(hy,{...n});case ue.ALERT_TOP:return t(fy,{...n});default:return t(gy,{...n})}},py=o=>{const{item:e=null,onClose:n=null,...r}=o;return l(cl,{fadesOut:!1,className:"flex-column club-gift",onClose:n,...r,children:[l("div",{className:"d-flex align-items-center gap-2 mb-2",children:[t(at,{type:"hc",className:"flex-shrink-0"}),t("span",{className:"ms-1",children:m("notifications.text.club_gift")})]}),l("div",{className:"d-flex align-items-center justify-content-end gap-2",children:[t("button",{type:"button",className:"btn btn-success w-100 btn-sm",onClick:()=>Xr(e.linkUrl),children:m("notifications.button.show_gift_list")}),t("span",{className:"text-decoration-underline cursor-pointer text-nowrap",onClick:n,children:m("notifications.button.later")})]})]})},Iy=o=>{const{item:e=null,onClose:n=null,...r}=o,s=e.message.replace(/\r\n|\r|\n/g,"<br />");return l(cl,{onClose:n,gap:2,alignItems:"center",onClick:a=>e.linkUrl&&e.linkUrl.length&&Xr(e.linkUrl),...r,children:[t(w,{center:!0,className:"bubble-image-container",children:e.iconUrl&&e.iconUrl.length&&t("img",{className:"no-select",src:e.iconUrl,alt:""})}),t(S,{wrap:!0,variant:"white",dangerouslySetInnerHTML:{__html:s}})]})},Ey=(o,e)=>{if(!o)return null;const n={key:o.id,item:o,onClose:e};switch(o.notificationType){case Xe.CLUBGIFT:return t(py,{...n});default:return t(Iy,{...n})}},Cy=o=>{const{item:e=null,onClose:n=null,...r}=o,{message:s=null,onConfirm:a=null,onCancel:c=null,confirmText:u=null,cancelText:d=null,title:h=null}=e,g=()=>{a&&a(),n()},f=()=>{c&&c(),n()};return l(Io,{title:h,onClose:n,...r,type:ue.ALERT,children:[t(w,{grow:!0,center:!0,children:t(S,{children:s})}),l(w,{gap:1,children:[t(D,{fullWidth:!0,variant:"danger",onClick:f,children:d}),t(D,{fullWidth:!0,onClick:g,children:u})]})]})},_y=(o,e)=>{if(!o)return null;const n={key:o.id,item:o,onClose:e};switch(o.confirmType){default:return t(Cy,{...n})}},by=o=>{const{alerts:e=[],bubbleAlerts:n=[],confirms:r=[],closeAlert:s=null,closeBubbleAlert:a=null,closeConfirm:c=null,alertTops:u=[],closeAlertTop:d=null}=Je(),h=i.useMemo(()=>{if(!e||!e.length)return null;const C=[];for(const E of e){const _=Uc(E,()=>s(E));C.push(_)}return C},[e,s]),g=i.useMemo(()=>{if(!n||!n.length)return null;const C=[];for(const E of n){const _=Ey(E,()=>a(E));if(E.notificationType===Xe.CLUBGIFT){C.unshift(_);continue}C.push(_)}return C},[n,a]),f=i.useMemo(()=>{if(!r||!r.length)return null;const C=[];for(const E of r){const _=_y(E,()=>c(E));C.push(_)}return C},[r,c]),p=i.useMemo(()=>{if(!u||!u.length)return null;const C=[];for(const E of u){E.alertType=ue.ALERT_TOP;const _=Uc(E,()=>d(E));C.push(_)}return C},[u,d]);return l(V,{children:[t(T,{gap:1,children:g}),f,h,p]})},xc=o=>{const{type:e=-1,amount:n=-1,short:r=!1}=o,s=i.useMemo(()=>l(w,{justifyContent:"end",pointer:!0,gap:1,className:"nitro-purse-button rounded",children:[t(S,{truncate:!0,textEnd:!0,variant:"white",grow:!0,children:r?Eb(n):Qa(n)}),t(at,{type:e})]}),[n,r,e]);return r?t(vu,{placement:"left",overlay:t(fg,{id:`tooltip-${e}`,children:Qa(n)}),children:s}):s},Sy=o=>{const{type:e=-1,amount:n=-1}=o;return l(w,{fullWidth:!0,justifyContent:"between",className:"nitro-purse-seasonal-currency p-2 rounded",children:[t(S,{variant:"white",children:m(`purse.seasonal.currency.${e}`)}),l(w,{gap:1,children:[t(S,{variant:"white",children:Qa(n)}),t(at,{type:e})]})]})},Ny=o=>{const{purse:e=null,hcDisabled:n=!1}=es(),r=i.useMemo(()=>K("system.currency.types",[]),[]),s=i.useMemo(()=>K("currency.display.number.short",!1),[]),a=(()=>{if(!e)return null;const u=e.clubPeriods*31+e.clubDays,d=e.minutesUntilExpiration;return e.clubLevel===dn.NO_CLUB?m("purse.clubdays.zero.amount.text"):d>-1&&d<60*24?jn.shortFormat(d*60):jn.shortFormat(u*86400)})(),c=(u,d=-1,h=!1)=>{if(!e||!e.activityPoints||!e.activityPoints.size)return null;const g=Array.from(e.activityPoints.keys()).filter(C=>r.indexOf(C)>=0);let f=0;for(;f<u;)g.shift(),f++;f=0;const p=[];for(const C of g){if(d>-1&&f===d)break;h?p.push(t(Sy,{type:C,amount:e.activityPoints.get(C)},C)):p.push(t(xc,{type:C,amount:e.activityPoints.get(C),short:s},C)),f++}return p};return e?l(T,{alignItems:"end",className:"nitro-purse-container",gap:1,children:[t(w,{className:"nitro-purse rounded-bottom p-1",children:l(se,{fullWidth:!0,gap:1,children:[l(T,{justifyContent:"center",size:n?10:6,gap:0,children:[t(xc,{type:-1,amount:e.credits,short:s}),c(0,2)]}),!n&&l(T,{center:!0,pointer:!0,size:4,gap:1,className:"nitro-purse-subscription rounded",onClick:u=>ee("habboUI/open/hccenter"),children:[t(at,{type:"hc"}),t(S,{variant:"white",children:a})]}),l(T,{justifyContent:"center",size:2,gap:0,children:[t(w,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:u=>ee("help/show"),children:t("i",{className:"icon icon-help"})}),t(w,{center:!0,pointer:!0,fullHeight:!0,className:"nitro-purse-button p-1 rounded",onClick:u=>ee("user-settings/toggle"),children:t("i",{className:"icon icon-cog"})})]})]})}),c(2,-1,!0)]}):null},Ty={purple:9452386,blue:3891856,green:6459451,yellow:10658089,lilac:6897548,orange:10841125,turquoise:2661026,red:10104881},vy=o=>{const[e,n]=i.useState(!0),[r,s]=i.useState(""),[a,c]=i.useState("");kS(d_.MYSTERY_BOX_KEYS_UPDATE,d=>{s(d.keyColor),c(d.boxColor)});const u=d=>{const h=Ty[d];return en.int2rgb(h)};return r===""&&a===""?null:t(P,{className:"nitro-notification-bubble rounded mysterybox-extension",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:d=>n(h=>!h),children:[t(S,{variant:"white",children:m("mysterybox.tracker.title")}),e&&t(qi,{className:"fa-icon"}),!e&&t(zi,{className:"fa-icon"})]}),e&&l(V,{children:[t(S,{variant:"white",children:m("mysterybox.tracker.description")}),l(w,{justifyContent:"center",alignItems:"center",gap:2,children:[t(Ie,{className:"mysterybox-container",children:t("div",{className:"box-image flex-shrink-0",style:{backgroundColor:u(a)},children:t("div",{className:"chain-overlay-image"})})}),t(Ie,{className:"mysterybox-container",children:t("div",{className:"key-image flex-shrink-0",style:{backgroundColor:u(r)},children:t("div",{className:"key-overlay-image"})})})]})]})]})})},wy=o=>{const{eventId:e=-1,eventName:n="",eventDescription:r="",setIsEditingPromote:s=null}=o,[a,c]=i.useState(n),[u,d]=i.useState(r),h=()=>{A(new m_(e,a,u)),s(!1)};return l(oe,{className:"nitro-guide-tool",theme:"primary-slim",children:[t(ie,{headerText:m("navigator.eventsettings.editcaption"),onCloseClick:()=>s(!1)}),l(re,{className:"text-black",children:[l(T,{children:[t(S,{bold:!0,children:m("navigator.eventsettings.name")}),t("input",{type:"text",className:"form-control form-control-sm",placeholder:m("navigator.eventsettings.name"),maxLength:64,value:a,onChange:g=>c(g.target.value)})]}),l(T,{children:[t(S,{bold:!0,children:m("navigator.eventsettings.desc")}),t("textarea",{className:"form-control form-control-sm",placeholder:m("navigator.eventsettings.desc"),maxLength:64,value:u,onChange:g=>d(g.target.value)})]}),t(T,{children:t(D,{fullWidth:!0,disabled:!a||!u,variant:!a||!u?"danger":"success",onClick:g=>h(),children:m("navigator.eventsettings.edit")})})]})]})},Ry=o=>{const{eventDescription:e="",setIsEditingPromote:n=null}=o,{setIsExtended:r}=gl(),s=()=>{r(!0),ee("catalog/open/room_event")};return l(V,{children:[t(w,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:t(S,{variant:"white",children:e})}),t("br",{}),t("br",{}),l(se,{className:"d-flex align-items-center justify-content-end gap-2",children:[t(D,{className:"btn btn-primary w-100 btn-sm",onClick:a=>n(!0),children:m("navigator.roominfo.editevent")}),t(D,{className:"btn btn-success w-100 btn-sm",onClick:a=>s(),children:m("roomad.extend.event")})]})]})},yy=o=>{const{eventDescription:e=""}=o;return l(V,{children:[t(w,{alignItems:"center",gap:2,style:{overflowWrap:"anywhere"},children:t(S,{variant:"white",children:e})}),t("br",{}),t("br",{}),t(T,{alignItems:"center",gap:1,children:l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",center:!0,children:m("navigator.eventinprogress")})}),t(S,{children:""})]})})]})},Oy=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(!0),{promoteInformation:a,setPromoteInformation:c}=gl();return F(sd,u=>{c(null)}),a?t(V,{children:a.data.adId!==-1&&t(P,{className:"nitro-notification-bubble rounded",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",pointer:!0,onClick:u=>s(d=>!d),children:[t(S,{variant:"white",overflow:"hidden",children:a.data.eventName}),r&&t(qi,{className:"fa-icon"}),!r&&t(zi,{className:"fa-icon"})]}),r&&q().userId!==a.data.ownerAvatarId&&t(yy,{eventDescription:a.data.eventDescription}),r&&q().userId===a.data.ownerAvatarId&&t(Ry,{eventDescription:a.data.eventDescription,setIsEditingPromote:()=>n(!0)}),e&&t(wy,{eventId:a.data.adId,eventName:a.data.eventName,eventDescription:a.data.eventDescription,setIsEditingPromote:()=>n(!1)})]})})}):null},ky=o=>t("div",{className:"nitro-right-side",children:l(T,{position:"relative",gap:1,children:[t(Ny,{}),t(dy,{}),t(vy,{}),t(uy,{}),t(Oy,{}),t(by,{})]})}),Ay=o=>t("div",{className:"room-spectator"}),Py=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(null),{chatStyleId:a=0}=Yn(),{roomSession:c=null}=xe();F(g_,d=>{const h=d.getParser();if(!h)return;const g=c.userDataManager.getPetData(h.petId);g&&(n(g),s(h))});const u=(d,h)=>{!d||!h||c==null||c.sendChatMessage(`${d} ${h}`,a)};return!e||!r?null:l(oe,{uniqueKey:"user-settings",className:"user-settings-window no-resize",theme:"primary-slim",children:[t(ie,{headerText:m("widgets.pet.commands.title"),onCloseClick:()=>s(null)}),l(re,{className:"text-black",children:[t(w,{alignItems:"center",justifyContent:"center",gap:2,children:l(se,{columnCount:2,children:[t(T,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:t(tr,{figure:e.figure,posture:"std",direction:2})}),t(S,{variant:"black",small:!0,wrap:!0,children:e.name})]})}),t(se,{columnCount:2,children:r.commands&&r.commands.length>0&&r.commands.map((d,h)=>t(D,{disabled:!r.enabledCommands.includes(d),onClick:()=>u(e.name,m(`pet.command.${d}`)),children:m(`pet.command.${d}`)},h))})]})]})},$t=o=>{const{justifyContent:e="center",alignItems:n="center",classNames:r=[],...s}=o,a=i.useMemo(()=>{const c=["menu-header","p-1"];return r.length&&c.push(...r),c},[r]);return t(w,{justifyContent:e,alignItems:n,classNames:a,...s})},Dy=o=>{const{chatEvent:e=null,onClose:n=null}=o,[r,s]=i.useState(e.chat==="${bot.skill.chatter.configuration.text.placeholder}"?"":e.chat),[a,c]=i.useState(e.automaticChat),[u,d]=i.useState(e.mixSentences),[h,g]=i.useState(e.chatDelay),f=i.useMemo(()=>Ji(Oe().roomId,e.objectId,e.category,1),[e]),p=E=>E.replace(/;#;/g," ").replace(/\r\n|\r|\n/g,"\r"),C=()=>{const E=p(r)+";#;"+a+";#;"+h+";#;"+u;A(new mr(e.botId,Ne.SETUP_CHAT,E)),n()};return t(Ar,{windowPosition:Rt.NOTHING,handleSelector:".drag-handler",dragStyle:{top:f.y,left:f.x},children:l(P,{className:"nitro-context-menu bot-chat",children:[t($t,{className:"drag-handler",children:m("bot.skill.chatter.configuration.title")}),l(T,{className:"p-1",children:[l(T,{gap:1,children:[t(S,{variant:"white",children:m("bot.skill.chatter.configuration.chat.text")}),t("textarea",{className:"form-control form-control-sm",placeholder:m("bot.skill.chatter.configuration.text.placeholder"),value:r,rows:7,onChange:E=>s(E.target.value)})]}),l(T,{gap:1,children:[l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:m("bot.skill.chatter.configuration.automatic.chat")}),t("input",{type:"checkbox",className:"form-check-input",checked:a,onChange:E=>c(E.target.checked)})]}),l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:m("bot.skill.chatter.configuration.markov")}),t("input",{type:"checkbox",className:"form-check-input",checked:u,onChange:E=>d(E.target.checked)})]}),l(w,{gap:1,alignItems:"center",justifyContent:"between",children:[t(S,{fullWidth:!0,variant:"white",children:m("bot.skill.chatter.configuration.chat.delay")}),t("input",{type:"number",className:"form-control form-control-sm",value:h,onChange:E=>g(E.target.valueAsNumber)})]})]}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(D,{fullWidth:!0,variant:"primary",onClick:n,children:m("cancel")}),t(D,{fullWidth:!0,variant:"success",onClick:C,children:m("save")})]})]})]})})},Fc=-1,Bc=0,Gc=1,Vc=2,Hc=3,Wc=4,jc=5,qc=6,My=o=>{const{item:e=null,onClose:n=null}=o,[r,s]=i.useState(Fc),[a,c]=i.useState(null),[u,d]=i.useState(null),{roomSession:h=null}=xe(),g=()=>{a&&$().selectRoomObject(h.roomId,a.roomIndex,Q.UNIT)},f=()=>{h.usePetProduct(e.requestRoomObjectId,a.webID),n()},p=i.useMemo(()=>{if(!a||!u)return null;const C=new Is(a.figure),E=u.customParams.split(" "),_=parseInt(E[0]);switch(u.specialType){case Z.PET_SHAMPOO:{if(E.length<2)return null;const I=$().getPetColorResult(_,C.paletteId),b=$().getPetColorResultsForTag(_,E[1]);let N=-1;for(const v of b)if(v.breed===I.breed){N=parseInt(v.id);break}return t(tr,{typeId:C.typeId,paletteId:N,petColor:C.color,customParts:C.customParts,direction:2})}case Z.PET_CUSTOM_PART:{if(E.length<4)return null;const I=[],b=E[1].split(",").map(R=>parseInt(R)),N=E[2].split(",").map(R=>parseInt(R)),v=E[3].split(",").map(R=>parseInt(R));let O=0;for(;O<b.length;){const R=b[O],y=C.getCustomPart(R);let G=v[O];y!=null&&(G=y.paletteId),I.push(new jo(R,N[O],G)),O++}return t(tr,{typeId:C.typeId,paletteId:C.paletteId,petColor:C.color,customParts:I,direction:2})}case Z.PET_CUSTOM_PART_SHAMPOO:{if(E.length<3)return null;const I=[],b=E[1].split(",").map(O=>parseInt(O)),N=E[2].split(",").map(O=>parseInt(O));let v=0;for(;v<b.length;){const O=b[v],R=C.getCustomPart(O);let y=-1;R!=null&&(y=R.partId),I.push(new jo(b[v],y,N[v])),v++}return t(tr,{typeId:C.typeId,paletteId:C.paletteId,petColor:C.color,customParts:I,direction:2})}case Z.PET_SADDLE:{if(E.length<4)return null;const I=[],b=E[1].split(",").map(R=>parseInt(R)),N=E[2].split(",").map(R=>parseInt(R)),v=E[3].split(",").map(R=>parseInt(R));let O=0;for(;O<b.length;)I.push(new jo(b[O],N[O],v[O])),O++;for(const R of C.customParts)b.indexOf(R.layerId)===-1&&I.push(R);return t(tr,{typeId:C.typeId,paletteId:C.paletteId,petColor:C.color,customParts:I,direction:2})}case Z.MONSTERPLANT_REBREED:case Z.MONSTERPLANT_REVIVAL:case Z.MONSTERPLANT_FERTILIZE:{let I="rip";const b=$().getRoomObject(h.roomId,a.roomIndex,Q.UNIT);if(b&&(I=b.model.getValue(ae.FIGURE_POSTURE),I==="rip")){const N=a.petLevel;N<7?I=`grw${N}`:I="std"}return t(tr,{typeId:C.typeId,paletteId:C.paletteId,petColor:C.color,customParts:C.customParts,posture:I,direction:2})}}},[a,u,h]);return i.useEffect(()=>{const C=h.userDataManager.getUserDataByIndex(e.id);c(C);const E=uo(h.roomId,e.requestRoomObjectId,Q.FLOOR);if(!E)return;d(E);let _=Fc;switch(E.specialType){case Z.PET_SHAMPOO:_=Bc;break;case Z.PET_CUSTOM_PART:_=Gc;break;case Z.PET_CUSTOM_PART_SHAMPOO:_=Vc;break;case Z.PET_SADDLE:_=Hc;break;case Z.MONSTERPLANT_REVIVAL:_=Wc;break;case Z.MONSTERPLANT_REBREED:_=jc;break;case Z.MONSTERPLANT_FERTILIZE:_=qc;break}s(_)},[h,e]),a?l(oe,{className:"nitro-use-product-confirmation",children:[t(ie,{headerText:m("useproduct.widget.title",["name"],[a.name]),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(P,{pointer:!0,className:"product-preview",onClick:g,children:p})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[r===Bc&&l(V,{children:[t(S,{children:m("useproduct.widget.text.shampoo",["productName"],[u.name])}),t(S,{children:m("useproduct.widget.info.shampoo")})]}),r===Gc&&l(V,{children:[t(S,{children:m("useproduct.widget.text.custompart",["productName"],[u.name])}),t(S,{children:m("useproduct.widget.info.custompart")})]}),r===Vc&&l(V,{children:[t(S,{children:m("useproduct.widget.text.custompartshampoo",["productName"],[u.name])}),t(S,{children:m("useproduct.widget.info.custompartshampoo")})]}),r===Hc&&l(V,{children:[t(S,{children:m("useproduct.widget.text.saddle",["productName"],[u.name])}),t(S,{children:m("useproduct.widget.info.saddle")})]}),r===Wc&&l(V,{children:[t(S,{children:m("useproduct.widget.text.revive_monsterplant",["productName"],[u.name])}),t(S,{children:m("useproduct.widget.info.revive_monsterplant")})]}),r===jc&&l(V,{children:[t(S,{children:m("useproduct.widget.text.rebreed_monsterplant",["productName"],[u.name])}),t(S,{children:m("useproduct.widget.info.rebreed_monsterplant")})]}),r===qc&&l(V,{children:[t(S,{children:m("useproduct.widget.text.fertilize_monsterplant",["productName"],[u.name])}),t(S,{children:m("useproduct.widget.info.fertilize_monsterplant")})]})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(D,{variant:"danger",onClick:n,children:m("useproduct.widget.cancel")}),t(D,{variant:"success",onClick:f,children:m("useproduct.widget.use")})]})]})]})})]}):null},z=o=>{const{disabled:e=!1,fullWidth:n=!0,justifyContent:r="center",alignItems:s="center",classNames:a=[],onClick:c=null,...u}=o,d=g=>{e||c&&c(g)},h=i.useMemo(()=>{const g=["menu-item","list-item"];return e&&g.push("disabled"),a.length&&g.push(...a),g},[e,a]);return t(w,{fullWidth:n,justifyContent:r,alignItems:s,classNames:h,onClick:d,...u})},Ly=o=>{const{justifyContent:e="center",alignItems:n="center",classNames:r=[],collapsed:s=!0,...a}=o,c=i.useMemo(()=>{const u=["menu-footer"];return r.length&&u.push(...r),u},[r]);return l(w,{justifyContent:e,alignItems:n,classNames:c,...a,children:[!s&&t(Wi,{className:"fa-icon align-self-center"}),s&&t(Hi,{className:"fa-icon align-self-center"})]})},Uy=25,zc=3,xy=5e3,Fy=75,os=10;let ri=!1,xa=null,Fa=-1e6,si=1;const cr=o=>{const{objectId:e=-1,category:n=-1,userType:r=-1,fades:s=!1,onClose:a=null,position:c="absolute",classNames:u=[],style:d={},children:h=null,collapsable:g=!1,...f}=o,[p,C]=i.useState({x:null,y:null}),[E,_]=i.useState(1),[I,b]=i.useState(!1),[N,v]=i.useState(ri),O=i.useRef(),R=i.useCallback(B=>{if(!I)return;si+=B;let M=(1-si/Fy)*1;if(M<=0)return a(),!1;_(M)},[I,a]),y=i.useCallback((B,M)=>{if(!B||!M||!xa)return;let U=-O.current.offsetHeight;r>-1&&(r===pt.USER||r===pt.BOT||r===pt.RENTABLE_BOT)?U=U+(B.height>50?15:0):U=U-14,xa.addValue(M.y-B.top);let W=xa.getMax();W<Fa-zc&&(W=Fa-zc),Fa=W;const L=M.y-W;let x=~~(M.x-O.current.offsetWidth/2),j=~~(L+U);const H=_e().width-O.current.offsetWidth-os,te=_e().height-O.current.offsetHeight-os;x<os?x=os:x>H&&(x=H),j<os?j=os:j>te&&(j=te),C({x,y:j})},[r]),G=i.useMemo(()=>{const B=["nitro-context-menu"];return N&&B.push("menu-hidden"),B.push(p.x!==null?"visible":"invisible"),u.length&&B.push(...u),B},[p,u,N]),k=i.useMemo(()=>{let B={};return B.left=p.x||0,B.top=p.y||0,B.opacity=E,Object.keys(d).length&&(B={...B,...d}),B},[p,E,d]);return i.useEffect(()=>{if(!O.current)return;const B=M=>{if(!O.current)return;R(M);const U=Ji(Oe().roomId,e,n),W=Id(Oe().roomId,e,n);y(U,W)};return Er().add(B),()=>{Er().remove(B)}},[e,n,R,y]),i.useEffect(()=>{if(!s)return;const B=setTimeout(()=>b(!0),xy);return()=>clearTimeout(B)},[s]),i.useEffect(()=>{ri=N},[N]),i.useEffect(()=>{xa=new h_(Uy),Fa=-1e6,si=1},[]),l(P,{innerRef:O,position:c,classNames:G,style:k,...f,children:[!(g&&ri)&&h,g&&t(Ly,{onClick:()=>v(!N),collapsed:N})]})},Yc=0,$c=1,Kc=2,Xc=3,Qc=4,Jc=5,Zc=6,eu=7,By=o=>{const{item:e=null,updateConfirmingProduct:n=null,onClose:r=null}=o,[s,a]=i.useState(0),{roomSession:c=null}=xe(),u=d=>{if(d)switch(d){case"use_product":case"use_product_shampoo":case"use_product_custom_part":case"use_product_custom_part_shampoo":case"use_product_saddle":case"replace_product_saddle":case"revive_monsterplant":case"rebreed_monsterplant":case"fertilize_monsterplant":n(e);break}};return i.useEffect(()=>{if(!e)return;const d=uo(c.roomId,e.requestRoomObjectId,Q.FLOOR);if(!d)return;let h=Yc;switch(d.specialType){case Z.PET_SHAMPOO:h=$c;break;case Z.PET_CUSTOM_PART:h=Kc;break;case Z.PET_CUSTOM_PART_SHAMPOO:h=Xc;break;case Z.PET_SADDLE:h=Qc;break;case Z.MONSTERPLANT_REVIVAL:h=Jc;break;case Z.MONSTERPLANT_REBREED:h=Zc;break;case Z.MONSTERPLANT_FERTILIZE:h=eu;break}a(h)},[c,e]),l(cr,{objectId:e.id,category:Q.UNIT,userType:pt.PET,onClose:r,collapsable:!0,children:[t($t,{children:e.name}),s===Yc&&t(z,{onClick:d=>u("use_product"),children:m("infostand.button.useproduct")}),s===$c&&t(z,{onClick:d=>u("use_product_shampoo"),children:m("infostand.button.useproduct_shampoo")}),s===Kc&&t(z,{onClick:d=>u("use_product_custom_part"),children:m("infostand.button.useproduct_custom_part")}),s===Xc&&t(z,{onClick:d=>u("use_product_custom_part_shampoo"),children:m("infostand.button.useproduct_custom_part_shampoo")}),s===Qc&&l(V,{children:[e.replace&&t(z,{onClick:d=>u("replace_product_saddle"),children:m("infostand.button.replaceproduct_saddle")}),!e.replace&&t(z,{onClick:d=>u("use_product_saddle"),children:m("infostand.button.useproduct_saddle")})]}),s===Jc&&t(z,{onClick:d=>u("revive_monsterplant"),children:m("infostand.button.revive_monsterplant")}),s===Zc&&t(z,{onClick:d=>u("rebreed_monsterplant"),children:m("infostand.button.rebreed_monsterplant")}),s===eu&&t(z,{onClick:d=>u("fertilize_monsterplant"),children:m("infostand.button.fertilize_monsterplant")})]})},Gy=o=>{const{avatarInfo:e=null,onClose:n=null}=o;return e?t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(hn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,className:"body-image bot",children:t(ot,{figure:e.figure,direction:4})}),t(T,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(r=>t(qe,{badgeCode:r,showInfo:!0},r))})]}),t("hr",{className:"m-0"})]}),t(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),e.carryItem>0&&l(T,{gap:1,children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.text.handitem",["item"],[m("handitem"+e.carryItem)])})]})]})}):null},ai=0,tu=1,nu=2,Vy=o=>{const{avatarInfo:e=null,onClose:n=null}=o,{roomSession:r=null}=xe(),[s,a]=i.useState(0),[c,u]=i.useState(!1),[d,h]=i.useState(!1),[g,f]=i.useState(!1),[p,C]=i.useState([]),[E,_]=i.useState([]),[I,b]=i.useState([]),[N,v]=i.useState([]),[O,R]=i.useState(!1),[y,G]=i.useState(0),[k,B]=i.useState(0),[M,U]=i.useState(!1),[W,L]=i.useState(!1),[x,j]=i.useState(null),[H,te]=i.useState(!1),[ne,Ce]=i.useState(!1),[Me,Ze]=i.useState(-1),[tt,Ft]=i.useState(""),[je,qt]=i.useState("");Wr(Hu.NPE_SONG_CHANGED,me=>{Ze(me.id)},H||ne),Wr(p_.SIR_TRAX_SONG_INFO_RECEIVED,me=>{if(me.id!==Me)return;const Ae=_e().soundManager.musicController.getSongInfo(me.id);Ae&&(Ft(Ae.name),qt(Ae.creator))},H||ne),i.useEffect(()=>{let me=ai,Ae=!1,it=!1,nn=!1,pe=[],Le=[],vn=[],Dr=[],rn=!1,ma=0,Os=0,Mr=!1,Lr=!1,ts=!1,ks=!1,br=-1;const Ur=e.roomControllerLevel>=nt.GUEST;if((Ur||e.isOwner||e.isRoomOwner||e.isAnyRoomController)&&(Ae=!0,it=!e.isWallItem,e.roomControllerLevel>=nt.MODERATOR&&(Mr=!0)),e.isAnyRoomController&&(Lr=!0),(e.usagePolicy===Hl.EVERYBODY||e.usagePolicy===Hl.CONTROLLER&&Ur||e.extraParam===gr.JUKEBOX&&Ur||e.extraParam===gr.USABLE_PRODUCT&&Ur)&&(nn=!0),e.extraParam){if(e.extraParam===gr.CRACKABLE_FURNI){const Bt=e.stuffData;nn=!0,rn=!0,ma=Bt.hits,Os=Bt.target}else if(e.extraParam===gr.JUKEBOX){const Bt=_e().soundManager.musicController.getRoomItemPlaylist();Bt&&(br=Bt.nowPlayingSongId),ts=!0}else e.extraParam.indexOf(gr.SONGDISK)===0&&(br=parseInt(e.extraParam.substr(gr.SONGDISK.length)),ks=!0);if(Mr){const Bt=e.extraParam.substr(gr.BRANDING_OPTIONS.length);if(Bt){const Kn=Bt.split("	");for(const ns of Kn){const Xn=ns.split("=");Xn&&Xn.length===2&&(pe.push(Xn[0]),Le.push(Xn[1]))}}}}if(Mr){const Bt=$().getRoomObject(r.roomId,e.id,e.isWallItem?Q.WALL:Q.FLOOR);if(Bt){const Kn=Bt.model.getValue(ae.FURNITURE_CUSTOM_VARIABLES),ns=Bt.model.getValue(ae.FURNITURE_DATA);if(Kn&&Kn.length)for(const Xn of Kn)vn.push(Xn),Dr.push(ns[Xn]||"")}}e.isOwner||e.isAnyRoomController?me=nu:(e.isRoomOwner||e.roomControllerLevel>=nt.GUILD_ADMIN)&&(me=tu),e.isStickie&&(me=ai),a(me),u(Ae),h(it),f(nn),C(pe),_(Le),b(vn),v(Dr),R(rn),G(ma),B(Os),U(Mr),L(Lr),j(null),te(ts),Ce(ks),Ze(br),e.groupId&&A(new Ws(e.groupId,!1))},[r,e]),F(ta,me=>{const Ae=me.getParser();!e||e.groupId!==Ae.id||Ae.flag||(x&&j(null),j(Ae.title))}),i.useEffect(()=>{const me=_e().soundManager.musicController.getSongInfo(Me);Ft((me==null?void 0:me.name)??""),qt((me==null?void 0:me.creator)??"")},[Me]);const Tn=i.useCallback((me,Ae)=>{const it=Array.from(E);it[me]=Ae,_(it)},[E]),Ge=i.useCallback((me,Ae)=>{const it=Array.from(N);it[me]=Ae,v(it)},[N]),Ee=i.useCallback(()=>{if(p.length===0||E.length===0)return"";let me="",Ae=0;for(;Ae<p.length;){const it=p[Ae],nn=E[Ae];me=me+(it+"="+nn+"	"),Ae++}return me},[p,E]),$e=i.useCallback(me=>{if(!(!me||me===""))switch(me){case"buy_one":ee(`catalog/open/offerId/${e.purchaseOfferId}`);return;case"move":$().processRoomObjectOperation(e.id,e.category,Vn.OBJECT_MOVE);break;case"rotate":$().processRoomObjectOperation(e.id,e.category,Vn.OBJECT_ROTATE_POSITIVE);break;case"pickup":s===nu?$().processRoomObjectOperation(e.id,e.category,Vn.OBJECT_PICKUP):$().processRoomObjectOperation(e.id,e.category,Vn.OBJECT_EJECT);break;case"use":$().useRoomObject(e.id,e.category);break;case"save_branding_configuration":{const Ae=new Map,it=Ee().split("	");if(it)for(const nn of it){const[pe,Le]=nn.split("=",2);Ae.set(pe,Le)}$().modifyRoomObjectDataWithMap(e.id,e.category,Vn.OBJECT_SAVE_STUFF_DATA,Ae);break}case"save_custom_variables":{const Ae=new Map;for(let it=0;it<I.length;it++){const nn=I[it],pe=N[it];nn&&nn.length&&pe&&pe.length&&Ae.set(nn,pe)}A(new f_(e.id,Ae));break}}},[e,s,I,N,Ee]),Ot=i.useCallback(()=>{const me=e.stuffData;return!me||!(me instanceof ea)?null:me.getValue(2)},[e]);return e?l(T,{gap:1,alignItems:"end",children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(hn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{position:"relative",gap:1,children:[e.stuffData.isUnique&&t("div",{className:"position-absolute end-0",children:t(Kd,{uniqueNumber:e.stuffData.uniqueNumber,uniqueSeries:e.stuffData.uniqueSeries})}),e.stuffData.rarityLevel>-1&&t("div",{className:"position-absolute end-0",children:t(dl,{level:e.stuffData.rarityLevel})}),e.image&&e.image.src.length&&t("img",{className:"d-block mx-auto",src:e.image.src,alt:""})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,children:e.description}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:m("furni.owner",["name"],[e.ownerName])})]}),e.purchaseOfferId>0&&t(w,{children:t(S,{variant:"white",small:!0,underline:!0,pointer:!0,onClick:me=>$e("buy_one"),children:m("infostand.button.buy")})})]}),(H||ne)&&l(T,{gap:1,children:[t("hr",{className:"m-0"}),Me===-1&&t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.jukebox.text.not.playing")}),!!tt.length&&l(w,{alignItems:"center",gap:1,children:[t(P,{className:"icon disk-icon"}),t(S,{variant:"white",small:!0,wrap:!0,children:tt})]}),!!je.length&&l(w,{alignItems:"center",gap:1,children:[t(P,{className:"icon disk-creator"}),t(S,{variant:"white",small:!0,wrap:!0,children:je})]})]}),l(T,{gap:1,children:[O&&l(V,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.crackable_furni.hits_remaining",["hits","target"],[y.toString(),k.toString()])})]}),e.groupId>0&&l(V,{children:[t("hr",{className:"m-0"}),l(w,{pointer:!0,alignItems:"center",gap:2,onClick:()=>ia(e.groupId),children:[t(qe,{badgeCode:Ot(),isGroup:!0}),t(S,{variant:"white",underline:!0,children:x})]})]}),M&&l(V,{children:[t("hr",{className:"m-0"}),W&&l(S,{small:!0,wrap:!0,variant:"white",children:["ID: ",e.id]}),p.length>0&&l(V,{children:[t("hr",{className:"m-0"}),t(T,{gap:1,children:p.map((me,Ae)=>l(w,{alignItems:"center",gap:1,children:[t(S,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:me}),t("input",{type:"text",className:"form-control form-control-sm",value:E[Ae],onChange:it=>Tn(Ae,it.target.value)})]},Ae))})]})]}),I.length>0&&l(V,{children:[t("hr",{className:"m-0 my-1"}),t(T,{gap:1,children:I.map((me,Ae)=>l(w,{alignItems:"center",gap:1,children:[t(S,{small:!0,wrap:!0,align:"end",variant:"white",className:"col-4",children:me}),t("input",{type:"text",className:"form-control form-control-sm",value:N[Ae],onChange:it=>Ge(Ae,it.target.value)})]},Ae))})]})]})]})}),l(w,{gap:1,justifyContent:"end",children:[c&&t(D,{variant:"dark",onClick:me=>$e("move"),children:m("infostand.button.move")}),d&&t(D,{variant:"dark",onClick:me=>$e("rotate"),children:m("infostand.button.rotate")}),s!==ai&&t(D,{variant:"dark",onClick:me=>$e("pickup"),children:m(s===tu?"infostand.button.eject":"infostand.button.pickup")}),g&&t(D,{variant:"dark",onClick:me=>$e("use"),children:m("infostand.button.use")}),p.length>0&&E.length>0&&p.length===E.length&&t(D,{variant:"dark",onClick:()=>$e("save_branding_configuration"),children:m("save")}),I.length>0&&N.length>0&&I.length===N.length&&t(D,{variant:"dark",onClick:()=>$e("save_custom_variables"),children:m("save")})]})]}):null},Hy=o=>{const{avatarInfo:e=null,onClose:n=null}=o,[r,s]=i.useState(0),[a,c]=i.useState(0),{roomSession:u=null}=xe(),{petRespectRemaining:d=0,respectPet:h=null}=Yn();if(i.useEffect(()=>{s(e.remainingGrowTime),c(e.remainingTimeToLive)},[e]),i.useEffect(()=>{if(e.petType!==Ut.MONSTERPLANT||e.dead)return;const f=setInterval(()=>{s(p=>p-1),c(p=>p-1)},1e3);return()=>clearInterval(f)},[e]),!e)return null;const g=f=>{let p=!0;if(!(!f||f=="")){switch(f){case"respect":h(e.id),d-1>=1&&(p=!1);break;case"buyfood":ee("catalog/open/"+K("catalog.links")["pets.buy_food"]);break;case"train":u==null||u.requestPetCommands(e.id);break;case"treat":A(new Xi(e.id));break;case"compost":u==null||u.compostPlant(e.id);break;case"pick_up":u==null||u.pickupPet(e.id);break}p&&n()}};return l(T,{gap:1,alignItems:"end",children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(hn,{className:"cursor-pointer fa-icon",onClick:n})]}),t(S,{variant:"white",small:!0,wrap:!0,children:m(`pet.breed.${e.petType}.${e.petBreed}`)}),t("hr",{className:"m-0"})]}),e.petType===Ut.MONSTERPLANT&&l(V,{children:[l(T,{center:!0,gap:1,children:[t(tr,{figure:e.petFigure,posture:e.posture,direction:4}),t("hr",{className:"m-0"})]}),l(T,{gap:2,children:[!e.dead&&t(T,{alignItems:"center",gap:1,children:t(S,{variant:"white",center:!0,small:!0,wrap:!0,children:m("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])})}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:m("infostand.pet.text.wellbeing")}),l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.dead?"00:00:00":Fr(a==0?e.remainingTimeToLive:a).split(":")[1]+":"+Fr(a==null||a==null?0:a).split(":")[2]+":"+Fr(a==null||a==null?0:a).split(":")[3]})}),t(P,{className:"bg-success rounded pet-stats",style:{width:e.dead?"0":Math.round(e.maximumTimeToLive*100/a).toString()}})]})]}),r!=0&&r>0&&l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:m("infostand.pet.text.growth")}),t(bS,{className:"top-2 end-2",day:Fr(r).split(":")[0],hour:Fr(r).split(":")[1],minutes:Fr(r).split(":")[2],seconds:Fr(r).split(":")[3]})]}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:m("infostand.pet.text.raritylevel",["level"],[m(`infostand.pet.raritylevel.${e.rarityLevel}`)])}),t(dl,{className:"top-2 end-2",level:e.rarityLevel})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:m("pet.age",["age"],[e.age.toString()])}),t("hr",{className:"m-0"})]})]}),e.petType!==Ut.MONSTERPLANT&&l(V,{children:[l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,overflow:"hidden",className:"body-image pet p-1",children:t(tr,{figure:e.petFigure,posture:e.posture,direction:4})}),l(T,{grow:!0,gap:1,children:[t(S,{variant:"white",center:!0,small:!0,wrap:!0,children:m("pet.level",["level","maxlevel"],[e.level.toString(),e.maximumLevel.toString()])}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:m("infostand.pet.text.happiness")}),l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.happyness+"/"+e.maximumHappyness})}),t(P,{className:"bg-info rounded pet-stats",style:{width:e.happyness/e.maximumHappyness*100+"%"}})]})]}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:m("infostand.pet.text.experience")}),l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.experience+"/"+e.levelExperienceGoal})}),t(P,{className:"bg-purple rounded pet-stats",style:{width:e.experience/e.levelExperienceGoal*100+"%"}})]})]}),l(T,{alignItems:"center",gap:1,children:[t(S,{variant:"white",small:!0,truncate:!0,children:m("infostand.pet.text.energy")}),l(P,{fullWidth:!0,overflow:"hidden",position:"relative",className:"bg-light-dark rounded",children:[t(w,{fit:!0,center:!0,position:"absolute",children:t(S,{variant:"white",small:!0,children:e.energy+"/"+e.maximumEnergy})}),t(P,{className:"bg-success rounded pet-stats",style:{width:e.energy/e.maximumEnergy*100+"%"}})]})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[e.petType!==Ut.MONSTERPLANT&&t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.text.petrespect",["count"],[e.respect.toString()])}),t(S,{variant:"white",small:!0,wrap:!0,children:m("pet.age",["age"],[e.age.toString()])}),t("hr",{className:"m-0"})]})]}),t(T,{gap:1,children:l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.text.petowner",["name"],[e.ownerName])})]})})]})}),l(w,{gap:1,justifyContent:"end",children:[e.petType!==Ut.MONSTERPLANT&&t(D,{variant:"dark",onClick:f=>g("buyfood"),children:m("infostand.button.buyfood")}),e.isOwner&&e.petType!==Ut.MONSTERPLANT&&t(D,{variant:"dark",onClick:f=>g("train"),children:m("infostand.button.train")}),!e.dead&&e.energy/e.maximumEnergy<.98&&e.petType===Ut.MONSTERPLANT&&t(D,{variant:"dark",onClick:f=>g("treat"),children:m("infostand.button.pettreat")}),(u==null?void 0:u.isRoomOwner)&&e.petType===Ut.MONSTERPLANT&&t(D,{variant:"dark",onClick:f=>g("compost"),children:m("infostand.button.compost")}),e.isOwner&&t(D,{variant:"dark",onClick:f=>g("pick_up"),children:m("inventory.pets.pickup")}),d>0&&e.petType!==Ut.MONSTERPLANT&&t(D,{variant:"dark",onClick:f=>g("respect"),children:m("infostand.button.petrespect",["count"],[d.toString()])})]})]})},Wy=o=>{const{avatarInfo:e=null,onClose:n=null}=o,r=i.useMemo(()=>!(e.botSkills.indexOf(Ne.NO_PICK_UP)>=0||!e.amIOwner&&!e.amIAnyRoomController),[e]),s=()=>A(new ad(e.webID));if(e)return l(T,{gap:1,children:[t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:e.name}),t(hn,{className:"cursor-pointer fa-icon",onClick:n})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{gap:1,children:[t(T,{fullWidth:!0,className:"body-image bot",children:t(ot,{figure:e.figure,direction:4})}),t(T,{grow:!0,center:!0,gap:0,children:e.badges.length>0&&e.badges.map(a=>t(qe,{badgeCode:a,showInfo:!0},a))})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:t(S,{fullWidth:!0,wrap:!0,textBreak:!0,variant:"white",small:!0,className:"motto-content",children:e.motto})}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:e.ownerId}),t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.text.botowner",["name"],[e.ownerName])})]}),e.carryItem>0&&l(V,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.text.handitem",["item"],[m("handitem"+e.carryItem)])})]})]})]})}),r&&t(w,{justifyContent:"end",children:t(D,{variant:"dark",onClick:s,children:m("infostand.button.pickup")})})]})};class jm{constructor(e){this.handler="getBannerByUserId",this.session=new URLSearchParams(window.location.search).get("sso"),this.userId=e}}const oi=o=>{const{type:e=-1,relationship:n=null}=o;if(!n)return null;const r=Bn.RELATIONSHIP_NAMES[e].toLocaleLowerCase();return l(w,{alignItems:"center",gap:1,children:[t("i",{className:`nitro-friends-spritesheet icon-${r}`}),t(w,{alignItems:"center",gap:0,children:l(S,{small:!0,variant:"white",onClick:s=>tn(n.randomFriendId),children:[t("u",{children:n.randomFriendName}),n.friendCount>1&&" "+m(`extendedprofile.relstatus.others.${r}`,["count"],[(n.friendCount-1).toString()])]})})]})},jy=o=>{const{relationships:e=null}=o;return!e||!e.relationshipStatusMap.length?null:l(V,{children:[t(oi,{type:Bn.HEART,relationship:e.relationshipStatusMap.getValue(Bn.HEART)}),t(oi,{type:Bn.SMILE,relationship:e.relationshipStatusMap.getValue(Bn.SMILE)}),t(oi,{type:Bn.BOBBA,relationship:e.relationshipStatusMap.getValue(Bn.BOBBA)})]})},qy=o=>{ee(`navigator/search/${o}`),A(new Es("hotel_view",`tag:${o}`))},zy=o=>{const{tags:e=null}=o;return!e||!e.length?null:l(V,{children:[t("hr",{className:"m-0"}),t(w,{className:"flex-tags",children:e&&e.length>0&&e.map((n,r)=>t(S,{variant:"white",className:"text-tags",onClick:s=>qy(n),children:n},r))})]})},Yy=o=>{const{avatarInfo:e=null,setAvatarInfo:n=null,onClose:r=null}=o,[s,a]=i.useState(null),[c,u]=i.useState(!1),[d,h]=i.useState(null),{roomSession:g=null}=xe(),[f,p]=i.useState("default"),[C,E]=i.useState([]),{sendMessage:_,lastMessage:I,readyState:b}=Kr(K("external.websocket"),{share:!0});i.useEffect(()=>{if(I!==null){var R=JSON.parse(I.data);R.header==="updateBannerResponse"&&R.data!==null&&e.webID==R.data.userId&&p(R.data.bannerName),R.header==="getBannerByUserIdResponse"&&R.data!==null&&e.webID==R.data.userId&&p(R.data.bannerName)}},[I,E]),i.useEffect(()=>{e!==null&&_(JSON.stringify(new jm(e.webID)))},[]);const N=R=>{!c||R.length>K("motto.max.length",38)||(g.sendMottoMessage(R),u(!1))},v=R=>N(R.target.value),O=R=>{switch(R.stopPropagation(),R.key){case"Enter":N(R.target.value);return}};return Ye(I_.RSUBE_BADGES,R=>{!e||e.webID!==R.userId||e.badges.join("")===R.badges.join("")||n(G=>{const k=Kt(G);return k.badges=R.badges,k})}),Ye(E_.USER_FIGURE,R=>{!e||e.roomIndex!==R.roomIndex||n(y=>{const G=Kt(y);return G.figure=R.figure,G.motto=R.customInfo,G.achievementScore=R.activityPoints,G})}),Ye(C_.FAVOURITE_GROUP_UPDATE,R=>{!e||e.roomIndex!==R.roomIndex||n(y=>{const G=Kt(y),k=R.status===-1||R.habboGroupId<=0;return G.groupId=k?-1:R.habboGroupId,G.groupName=k?null:R.habboGroupName,G.groupBadgeId=k?null:q().getGroupBadge(R.habboGroupId),G})}),F(od,R=>{const y=R.getParser();!e||e.webID!==y.userId||h(y)}),i.useEffect(()=>(u(!1),a(e.motto),A(new id(e.webID)),()=>{u(!1),a(null),h(null)}),[e]),e?t(T,{className:"nitro-infostand rounded",children:l(T,{overflow:"visible",className:"container-fluid content-area",gap:1,children:[l(T,{gap:1,children:[l(w,{alignItems:"center",justifyContent:"between",children:[l(w,{alignItems:"center",gap:1,children:[t(bn,{userId:e.webID}),t(S,{variant:"white",small:!0,wrap:!0,children:e.name})]}),t(hn,{className:"cursor-pointer fa-icon",onClick:r})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,style:{height:"175px"},children:[l(w,{gap:1,style:{height:"170px"},children:[t(T,{fullWidth:!0,className:"body-image",onClick:R=>tn(e.webID),style:{backgroundImage:`url(${K("banners.url")}/${f}.png)`},children:t(ot,{figure:e.figure,direction:4})}),l(T,{grow:!0,alignItems:"center",gap:0,children:[l(w,{gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[0]&&t(qe,{badgeCode:e.badges[0],showInfo:!0})}),t(w,{center:!0,pointer:e.groupId>0,className:"badge-image",onClick:R=>ia(e.groupId),children:e.groupId>0&&t(qe,{badgeCode:e.groupBadgeId,isGroup:!0,showInfo:!0,customTitle:e.groupName})})]}),l(w,{center:!0,gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[1]&&t(qe,{badgeCode:e.badges[1],showInfo:!0})}),t(w,{center:!0,className:"badge-image",children:e.badges[2]&&t(qe,{badgeCode:e.badges[2],showInfo:!0})})]}),l(w,{center:!0,gap:1,children:[t(w,{center:!0,className:"badge-image",children:e.badges[3]&&t(qe,{badgeCode:e.badges[3],showInfo:!0})}),t(w,{center:!0,className:"badge-image",children:e.badges[4]&&t(qe,{badgeCode:e.badges[4],showInfo:!0})})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-light-dark rounded py-1 px-2",children:[e.type!==At.OWN_USER&&t(w,{grow:!0,alignItems:"center",className:"motto-content",children:t(S,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",children:s})}),e.type===At.OWN_USER&&l(w,{grow:!0,alignItems:"center",gap:2,children:[t(pg,{className:"small fa-icon"}),l(w,{grow:!0,alignItems:"center",className:"motto-content",children:[!c&&l(S,{fullWidth:!0,pointer:!0,wrap:!0,textBreak:!0,small:!0,variant:"white",onClick:R=>u(!0),children:[s,""]}),c&&t("input",{type:"text",className:"motto-input",maxLength:K("motto.max.length",38),value:s,onChange:R=>a(R.target.value),onBlur:v,onKeyDown:O,autoFocus:!0})]})]})]}),t("hr",{className:"m-0"})]}),l(T,{gap:1,children:[t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.text.achievement_score")+" "+e.achievementScore}),e.carryItem>0&&l(V,{children:[t("hr",{className:"m-0"}),t(S,{variant:"white",small:!0,wrap:!0,children:m("infostand.text.handitem",["item"],[m("handitem"+e.carryItem)])})]})]}),t(T,{gap:1,children:t(jy,{relationships:d})}),K("user.tags.enabled")&&t(T,{gap:1,className:"mt-1",children:t(zy,{tags:q().tags})})]})}):null},Ba=0,ii=1,ru=2,su=3,li=4,au=5,ou=6,$y=o=>{const{avatarInfo:e=null,onClose:n=null}=o,[r,s]=i.useState(Ba),{canRequestFriend:a=null}=fn(),{report:c=null}=Un(),{roomSession:u=null}=xe(),{userRespectRemaining:d=0,respectUser:h=null}=Yn(),g=i.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel<nt.GUEST&&!e.isGuildRoom,[e]),f=i.useMemo(()=>e.amIOwner&&e.targetRoomControllerLevel===nt.GUEST&&!e.isGuildRoom,[e]),p=i.useMemo(()=>e.canBeKicked||e.canBeBanned||e.canBeMuted||g||f,[g,f,e]),C=i.useMemo(()=>{let _=!1;const I=Jr();if(I){const b=I.model.getValue(ae.FIGURE_CARRY_OBJECT);b>0&&b<999999&&(_=!0)}return _},[]),E=_=>{let I=!0;if(_)switch(_){case"moderate":I=!1,s(ii);break;case"ban":I=!1,s(ru);break;case"mute":I=!1,s(su);break;case"ambassador":I=!1,s(li);break;case"ambassador_mute":I=!1,s(au);break;case"back_moderate":I=!1,s(ii);break;case"back_ambassador":I=!1,s(li);break;case"back":I=!1,s(Ba);break;case"whisper":St(new Fs(Fs.WHISPER,e.name));break;case"friend":ee(`friends/request/${e.webID}/${e.name}`);break;case"relationship":I=!1,s(ou);break;case"respect":{h(e.webID),d-1>=1&&(I=!1);break}case"ignore":q().ignoreUser(e.name);break;case"unignore":q().unignoreUser(e.name);break;case"kick":u.sendKickMessage(e.webID);break;case"ban_hour":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_HOUR");break;case"ban_day":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_DAY");break;case"perm_ban":u.sendBanMessage(e.webID,"RWUAM_BAN_USER_PERM");break;case"mute_2min":u.sendMuteMessage(e.webID,2);break;case"mute_5min":u.sendMuteMessage(e.webID,5);break;case"mute_10min":u.sendMuteMessage(e.webID,10);break;case"give_rights":u.sendGiveRightsMessage(e.webID);break;case"remove_rights":u.sendTakeRightsMessage(e.webID);break;case"trade":A(new b_(e.roomIndex));break;case"report":c(He.BULLY,{reportedUserId:e.webID});break;case"pass_hand_item":A(new __(e.webID));break;case"ambassador_alert":u.sendAmbassadorAlertMessage(e.webID);break;case"ambassador_kick":u.sendKickMessage(e.webID);break;case"ambassador_mute_2min":u.sendMuteMessage(e.webID,2);break;case"ambassador_mute_10min":u.sendMuteMessage(e.webID,10);break;case"ambassador_mute_60min":u.sendMuteMessage(e.webID,60);break;case"ambassador_mute_18hour":u.sendMuteMessage(e.webID,1080);break;case"rship_heart":A(new Ls(e.webID,Wt.RELATIONSHIP_HEART));break;case"rship_smile":A(new Ls(e.webID,Wt.RELATIONSHIP_SMILE));break;case"rship_bobba":A(new Ls(e.webID,Wt.RELATIONSHIP_BOBBA));break;case"rship_none":A(new Ls(e.webID,Wt.RELATIONSHIP_NONE));break}I&&n()};return i.useEffect(()=>{s(Ba)},[e]),l(cr,{objectId:e.roomIndex,category:Q.UNIT,userType:e.userType,onClose:n,collapsable:!0,children:[t($t,{className:"cursor-pointer",onClick:_=>tn(e.webID),children:e.name}),r===Ba&&l(V,{children:[a(e.webID)&&t(z,{onClick:_=>E("friend"),children:m("infostand.button.friend")}),t(z,{onClick:_=>E("trade"),children:m("infostand.button.trade")}),t(z,{onClick:_=>E("whisper"),children:m("infostand.button.whisper")}),d>0&&t(z,{onClick:_=>E("respect"),children:m("infostand.button.respect",["count"],[d.toString()])}),!a(e.webID)&&l(z,{onClick:_=>E("relationship"),children:[m("infostand.link.relationship"),t(Zt,{className:"right fa-icon"})]}),!e.isIgnored&&t(z,{onClick:_=>E("ignore"),children:m("infostand.button.ignore")}),e.isIgnored&&t(z,{onClick:_=>E("unignore"),children:m("infostand.button.unignore")}),t(z,{onClick:_=>E("report"),children:m("infostand.button.report")}),p&&l(z,{onClick:_=>E("moderate"),children:[t(Zt,{className:"right fa-icon"}),m("infostand.link.moderate")]}),e.isAmbassador&&l(z,{onClick:_=>E("ambassador"),children:[t(Zt,{className:"right fa-icon"}),m("infostand.link.ambassador")]}),C&&t(z,{onClick:_=>E("pass_hand_item"),children:m("avatar.widget.pass_hand_item")})]}),r===ii&&l(V,{children:[t(z,{onClick:_=>E("kick"),children:m("infostand.button.kick")}),l(z,{onClick:_=>E("mute"),children:[t(Zt,{className:"right fa-icon"}),m("infostand.button.mute")]}),l(z,{onClick:_=>E("ban"),children:[t(Zt,{className:"right fa-icon"}),m("infostand.button.ban")]}),g&&t(z,{onClick:_=>E("give_rights"),children:m("infostand.button.giverights")}),f&&t(z,{onClick:_=>E("remove_rights"),children:m("infostand.button.removerights")}),l(z,{onClick:_=>E("back"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]}),r===ru&&l(V,{children:[t(z,{onClick:_=>E("ban_hour"),children:m("infostand.button.ban_hour")}),t(z,{onClick:_=>E("ban_day"),children:m("infostand.button.ban_day")}),t(z,{onClick:_=>E("perm_ban"),children:m("infostand.button.perm_ban")}),l(z,{onClick:_=>E("back_moderate"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]}),r===su&&l(V,{children:[t(z,{onClick:_=>E("mute_2min"),children:m("infostand.button.mute_2min")}),t(z,{onClick:_=>E("mute_5min"),children:m("infostand.button.mute_5min")}),t(z,{onClick:_=>E("mute_10min"),children:m("infostand.button.mute_10min")}),l(z,{onClick:_=>E("back_moderate"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]}),r===li&&l(V,{children:[t(z,{onClick:_=>E("ambassador_alert"),children:m("infostand.button.alert")}),t(z,{onClick:_=>E("ambassador_kick"),children:m("infostand.button.kick")}),l(z,{onClick:_=>E("ambassador_mute"),children:[m("infostand.button.mute"),t(Zt,{className:"right fa-icon"})]}),l(z,{onClick:_=>E("back"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]}),r===au&&l(V,{children:[t(z,{onClick:_=>E("ambassador_mute_2min"),children:m("infostand.button.mute_2min")}),t(z,{onClick:_=>E("ambassador_mute_10min"),children:m("infostand.button.mute_10min")}),t(z,{onClick:_=>E("ambassador_mute_60min"),children:m("infostand.button.mute_60min")}),t(z,{onClick:_=>E("ambassador_mute_18hr"),children:m("infostand.button.mute_18hour")}),l(z,{onClick:_=>E("back_ambassador"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]}),r===ou&&l(V,{children:[l(w,{className:"menu-list-split-3",children:[t(z,{onClick:_=>E("rship_heart"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-heart"})}),t(z,{onClick:_=>E("rship_smile"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-smile"})}),t(z,{onClick:_=>E("rship_bobba"),children:t(P,{pointer:!0,className:"nitro-friends-spritesheet icon-bobba"})})]}),t(z,{onClick:_=>E("rship_none"),children:m("avatar.widget.clear_relationship")}),l(z,{onClick:_=>E("back"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]})]})},qm=o=>{const{classNames:e=[],...n}=o,r=i.useMemo(()=>{const s=["menu-list"];return e.length&&s.push(...e),s},[e]);return t(T,{classNames:r,...n})},Ky=o=>{const{userId:e=-1,userName:n="",roomIndex:r=-1,setIsDecorating:s=null}=o;return t(cr,{objectId:r,category:Q.UNIT,onClose:null,children:t(qm,{children:t(z,{onClick:a=>s(!1),children:m("widget.avatar.stop_decorating")})})})},Xy=o=>{const{avatarInfo:e=null,onClose:n=null}=o,r=s=>{if(s)switch(s){case"move":us(e.id,e.category,Vn.OBJECT_MOVE);break;case"rotate":us(e.id,e.category,Vn.OBJECT_ROTATE_POSITIVE);break;case"pickup":us(e.id,e.category,Vn.OBJECT_PICKUP);break;case"eject":us(e.id,e.category,Vn.OBJECT_EJECT);break}};return l(cr,{objectId:e.id,category:e.category,onClose:n,collapsable:!0,children:[t($t,{children:e.name}),l(w,{className:"menu-list-split-3",children:[t(z,{onClick:s=>r("move"),children:t(Ig,{className:"center fa-icon"})}),t(z,{onClick:s=>r("rotate"),disabled:e.isWallItem,children:t(Eg,{className:"center fa-icon"})}),(e.isOwner||e.isAnyRoomController)&&t(z,{onClick:s=>r("pickup"),children:t(Nl,{className:"center fa-icon"})}),!e.isOwner&&!e.isAnyRoomController&&(e.isRoomOwner||e.roomControllerLevel>=nt.GUILD_ADMIN)&&t(z,{onClick:s=>r("eject"),children:t(Nl,{className:"center fa-icon"})})]})]})},iu=o=>{const{nameInfo:e=null,onClose:n=null}=o,r=i.useMemo(()=>{const s=["name-only"];return e.isFriend&&s.push("is-friend"),s},[e]);return t(cr,{objectId:e.roomIndex,category:e.category,userType:e.userType,fades:e.id!==q().userId,classNames:r,onClose:n,children:t("div",{className:"text-shadow",children:e.name})})},ci=0,ui=1,lu=3,cu=4,uu=5,Qy=o=>{const{avatarInfo:e=null,isDancing:n=!1,setIsDecorating:r=null,onClose:s=null}=o,[a,c]=i.useState(n&&zr()?ui:ci),{roomSession:u=null}=xe(),d=f=>{let p=!0;if(f)if(f.startsWith("sign_")){const C=parseInt(f.split("_")[1]);u.sendSignMessage(C)}else switch(f){case"decorate":r(!0);break;case"change_name":St(new so(so.INIT));break;case"change_looks":ee("avatar-editor/show");break;case"expressions":p=!1,c(lu);break;case"sit":u.sendPostureMessage(eo.POSTURE_SIT);break;case"stand":u.sendPostureMessage(eo.POSTURE_STAND);break;case"wave":u.sendExpressionMessage(er.WAVE.ordinal);break;case"blow":u.sendExpressionMessage(er.BLOW.ordinal);break;case"laugh":u.sendExpressionMessage(er.LAUGH.ordinal);break;case"idle":u.sendExpressionMessage(er.IDLE.ordinal);break;case"dance_menu":p=!1,c(ui);break;case"dance":u.sendDanceMessage(1);break;case"dance_stop":u.sendDanceMessage(0);break;case"dance_1":case"dance_2":case"dance_3":case"dance_4":u.sendDanceMessage(parseInt(f.charAt(f.length-1)));break;case"signs":p=!1,c(cu);break;case"back":p=!1,c(ci);break;case"drop_carry_item":A(new S_);break;case"customize":p=!1,c(uu);break}p&&s()},h=()=>e.amIOwner||e.amIAnyRoomController||e.roomControllerLevel>nt.GUEST,g=mb();return l(cr,{objectId:e.roomIndex,category:Q.UNIT,userType:e.userType,onClose:s,collapsable:!0,children:[t($t,{className:"cursor-pointer",onClick:f=>tn(e.webID),children:e.name}),a===ci&&l(V,{children:[e.allowNameChange&&t(z,{onClick:f=>d("change_name"),children:m("widget.avatar.change_name")}),h()&&t(z,{onClick:f=>d("decorate"),children:m("widget.avatar.decorate")}),t(z,{onClick:f=>d("change_looks"),children:m("widget.memenu.myclothes")}),zr()&&!g&&l(z,{onClick:f=>d("dance_menu"),children:[t(Zt,{className:"right fa-icon"}),m("widget.memenu.dance")]}),!n&&!zr()&&!g&&t(z,{onClick:f=>d("dance"),children:m("widget.memenu.dance")}),n&&!zr()&&!g&&t(z,{onClick:f=>d("dance_stop"),children:m("widget.memenu.dance.stop")}),l(z,{onClick:f=>d("expressions"),children:[t(Zt,{className:"right fa-icon"}),m("infostand.link.expressions")]}),l(z,{onClick:f=>d("signs"),children:[t(Zt,{className:"right fa-icon"}),m("infostand.show.signs")]}),e.carryItem>0&&t(z,{onClick:f=>d("drop_carry_item"),children:m("avatar.widget.drop_hand_item")}),l(z,{onClick:f=>d("customize"),children:[t(Zt,{className:"right fa-icon"}),"Customize"]})]}),a===ui&&l(V,{children:[n&&t(z,{onClick:f=>d("dance_stop"),children:m("widget.memenu.dance.stop")}),t(z,{onClick:f=>d("dance_1"),children:m("widget.memenu.dance1")}),t(z,{onClick:f=>d("dance_2"),children:m("widget.memenu.dance2")}),t(z,{onClick:f=>d("dance_3"),children:m("widget.memenu.dance3")}),t(z,{onClick:f=>d("dance_4"),children:m("widget.memenu.dance4")}),l(z,{onClick:f=>d("back"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]}),a===lu&&l(V,{children:[ub()===ms.POSTURE_STAND&&t(z,{onClick:f=>d("sit"),children:m("widget.memenu.sit")}),J_()&&t(z,{onClick:f=>d("stand"),children:m("widget.memenu.stand")}),$o()&&t(z,{onClick:f=>d("wave"),children:m("widget.memenu.wave")}),$o()&&l(z,{disabled:!wa(),onClick:f=>d("laugh"),children:[!wa()&&t(at,{type:"hc"}),m("widget.memenu.laugh")]}),$o()&&l(z,{disabled:!wa(),onClick:f=>d("blow"),children:[!wa()&&t(at,{type:"hc"}),m("widget.memenu.blow")]}),t(z,{onClick:f=>d("idle"),children:m("widget.memenu.idle")}),l(z,{onClick:f=>d("back"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]}),a===cu&&l(V,{children:[l(w,{className:"menu-list-split-3",children:[t(z,{onClick:f=>d("sign_1"),children:"1"}),t(z,{onClick:f=>d("sign_2"),children:"2"}),t(z,{onClick:f=>d("sign_3"),children:"3"})]}),l(w,{className:"menu-list-split-3",children:[t(z,{onClick:f=>d("sign_4"),children:"4"}),t(z,{onClick:f=>d("sign_5"),children:"5"}),t(z,{onClick:f=>d("sign_6"),children:"6"})]}),l(w,{className:"menu-list-split-3",children:[t(z,{onClick:f=>d("sign_7"),children:"7"}),t(z,{onClick:f=>d("sign_8"),children:"8"}),t(z,{onClick:f=>d("sign_9"),children:"9"})]}),l(w,{className:"menu-list-split-3",children:[t(z,{onClick:f=>d("sign_10"),children:"10"}),t(z,{onClick:f=>d("sign_11"),children:t("i",{className:"icon icon-sign-heart"})}),t(z,{onClick:f=>d("sign_12"),children:t("i",{className:"icon icon-sign-skull"})})]}),l(w,{className:"menu-list-split-3",children:[t(z,{onClick:f=>d("sign_0"),children:"0"}),t(z,{onClick:f=>d("sign_13"),children:t("i",{className:"icon icon-sign-exclamation"})}),t(z,{onClick:f=>d("sign_15"),children:t("i",{className:"icon icon-sign-smile"})})]}),l(w,{className:"menu-list-split-3",children:[t(z,{onClick:f=>d("sign_14"),children:t("i",{className:"icon icon-sign-soccer"})}),t(z,{onClick:f=>d("sign_17"),children:t("i",{className:"icon icon-sign-yellow"})}),t(z,{onClick:f=>d("sign_16"),children:t("i",{className:"icon icon-sign-red"})})]}),l(z,{onClick:f=>d("back"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]}),a===uu&&l(V,{children:[t(z,{onClick:()=>ee("customize/show"),children:"Nombre"}),t(z,{onClick:()=>ee("banners/show"),children:"Banner"}),l(z,{onClick:f=>d("back"),children:[t(Jt,{className:"left fa-icon"}),m("generic.back")]})]})]})},di=0,du=1,mu=2,gu=3,Jy=o=>{const{avatarInfo:e=null,onClose:n=null}=o,[r,s]=i.useState(di),{roomSession:a=null}=xe(),{petRespectRemaining:c=0,respectPet:u=null}=Yn(),d=i.useMemo(()=>{let g=!1;const f=Jr();if(f){const p=f.model.getValue(ae.FIGURE_CARRY_OBJECT);p>0&&p<999999&&(g=!0)}return g},[]),h=g=>{let f=!0;if(g)switch(g){case"respect":u(e.id),c-1>=1&&(f=!1);break;case"treat":A(new Xi(e.id));break;case"pass_handitem":A(new ld(e.id));break;case"train":a.requestPetCommands(e.id);break;case"pick_up":a.pickupPet(e.id);break;case"mount":a.mountPet(e.id);break;case"toggle_riding_permission":a.togglePetRiding(e.id);break;case"toggle_breeding_permission":a.togglePetBreeding(e.id);break;case"dismount":a.dismountPet(e.id);break;case"saddle_off":a.removePetSaddle(e.id);break;case"breed":break;case"harvest":a.harvestPet(e.id);break;case"revive":break;case"compost":a.compostPlant(e.id);break;case"buy_saddle":ee("catalog/open/"+K("catalog.links")["pets.buy_saddle"]);break}f&&n()};return i.useEffect(()=>{s(g=>e.petType===Ut.MONSTERPLANT?gu:e.saddle&&!e.rider?du:e.rider?mu:di)},[e]),l(cr,{objectId:e.roomIndex,category:Q.UNIT,userType:pt.PET,onClose:n,collapsable:!0,children:[t($t,{children:e.name}),r===di&&l(V,{children:[c>0&&t(z,{onClick:g=>h("respect"),children:m("infostand.button.petrespect",["count"],[c.toString()])}),t(z,{onClick:g=>h("train"),children:m("infostand.button.train")}),t(z,{onClick:g=>h("pick_up"),children:m("infostand.button.pickup")}),e.petType===Ut.HORSE&&t(z,{onClick:g=>h("buy_saddle"),children:m("infostand.button.buy_saddle")}),[Ut.BEAR,Ut.TERRIER,Ut.CAT,Ut.DOG,Ut.PIG].indexOf(e.petType)>-1&&t(z,{onClick:g=>h("breed"),children:m("infostand.button.breed")})]}),r===du&&l(V,{children:[t(z,{onClick:g=>h("mount"),children:m("infostand.button.mount")}),l(z,{onClick:g=>h("toggle_riding_permission"),gap:1,children:[t("input",{type:"checkbox",checked:!!e.publiclyRideable,readOnly:!0}),m("infostand.button.toggle_riding_permission")]}),c>0&&t(z,{onClick:g=>h("respect"),children:m("infostand.button.petrespect",["count"],[c.toString()])}),t(z,{onClick:g=>h("train"),children:m("infostand.button.train")}),t(z,{onClick:g=>h("pick_up"),children:m("infostand.button.pickup")}),t(z,{onClick:g=>h("saddle_off"),children:m("infostand.button.saddleoff")})]}),r===mu&&l(V,{children:[t(z,{onClick:g=>h("dismount"),children:m("infostand.button.dismount")}),c>0&&t(z,{onClick:g=>h("respect"),children:m("infostand.button.petrespect",["count"],[c.toString()])})]}),r===gu&&l(V,{children:[t(z,{onClick:g=>h("pick_up"),children:m("infostand.button.pickup")}),e.dead&&t(z,{onClick:g=>h("revive"),children:m("infostand.button.revive")}),a.isRoomOwner&&t(z,{onClick:g=>h("compost"),children:m("infostand.button.compost")}),!e.dead&&e.energy/e.maximumEnergy<.98&&t(z,{onClick:g=>h("treat"),children:m("infostand.button.pettreat")}),!e.dead&&e.level===e.maximumLevel&&e.breedable&&l(V,{children:[l(z,{onClick:g=>h("toggle_breeding_permission"),gap:1,children:[t("input",{type:"checkbox",checked:e.publiclyBreedable,readOnly:!0}),m("infostand.button.toggle_breeding_permission")]}),t(z,{onClick:g=>h("breed"),children:m("infostand.button.breed")})]})]}),d&&t(z,{onClick:g=>h("pass_hand_item"),children:m("infostand.button.pass_hand_item")})]})},mi=0,hu=1,fu=2,pu=3,Zy=o=>{const{avatarInfo:e=null,onClose:n=null}=o,[r,s]=i.useState(mi),{roomSession:a=null}=xe(),{petRespectRemaining:c=0,respectPet:u=null}=Yn(),d=i.useMemo(()=>a.isRoomOwner||a.controllerLevel>=nt.GUEST||q().isModerator,[a]),h=i.useMemo(()=>{let f=!1;const p=Jr();if(p){const C=p.model.getValue(ae.FIGURE_CARRY_OBJECT);C>0&&C<999999&&(f=!0)}return f},[]),g=f=>{let p=!0;if(f)switch(f){case"respect":u(e.id),c-1>=1&&(p=!1);break;case"treat":A(new Xi(e.id));break;case"pass_handitem":A(new ld(e.id));break;case"pick_up":a.pickupPet(e.id);break;case"mount":a.mountPet(e.id);break;case"dismount":a.dismountPet(e.id);break}p&&n()};return i.useEffect(()=>{s(f=>e.petType===Ut.MONSTERPLANT?pu:e.saddle&&!e.rider?hu:e.rider?fu:mi)},[e]),l(cr,{objectId:e.roomIndex,category:Q.UNIT,userType:pt.PET,onClose:n,collapsable:!0,children:[t($t,{children:e.name}),r===mi&&c>0&&t(z,{onClick:f=>g("respect"),children:m("infostand.button.petrespect",["count"],[c.toString()])}),r===hu&&l(V,{children:[!!e.publiclyRideable&&t(z,{onClick:f=>g("mount"),children:m("infostand.button.mount")}),c>0&&t(z,{onClick:f=>g("respect"),children:m("infostand.button.petrespect",["count"],[c.toString()])})]}),r===fu&&l(V,{children:[t(z,{onClick:f=>g("dismount"),children:m("infostand.button.dismount")}),c>0&&t(z,{onClick:f=>g("respect"),children:m("infostand.button.petrespect",["count"],[c.toString()])})]}),r===pu&&!e.dead&&e.energy/e.maximumEnergy<.98&&t(z,{onClick:f=>g("treat"),children:m("infostand.button.pettreat")}),d&&t(z,{onClick:f=>g("pick_up"),children:m("infostand.button.pickup")}),h&&t(z,{onClick:f=>g("pass_hand_item"),children:m("infostand.button.pass_hand_item")})]})},gi=0,Iu=1,Eu=2,eO=o=>{const{avatarInfo:e=null,onClose:n=null}=o,[r,s]=i.useState(gi),[a,c]=i.useState(""),[u,d]=i.useState("");F(N_,p=>{const C=p.getParser();if(C.botId===e.webID)switch(C.commandId){case Ne.CHANGE_BOT_NAME:c(C.data),s(Iu);return;case Ne.CHANGE_BOT_MOTTO:d(C.data),s(Eu);return;case Ne.SETUP_CHAT:{const E=C.data,_=E.split(E.indexOf(";#;")===-1?";":";#;");(_.length===3||_.length===4)&&(St(new Ud(e.roomIndex,Q.UNIT,e.webID,_[0],_[1].toLowerCase()==="true"||_[1]==="1",parseInt(_[2]),_[3]?_[3].toLowerCase()==="true"||_[3]==="1":!1)),n());return}}});const h=p=>A(new T_(e.webID,p)),g=p=>{let C=!0;if(p)switch(p){case"donate_to_all":h(Ne.DONATE_TO_ALL),A(new mr(e.webID,Ne.DONATE_TO_ALL,""));break;case"donate_to_user":h(Ne.DONATE_TO_USER),A(new mr(e.webID,Ne.DONATE_TO_USER,""));break;case"change_bot_name":h(Ne.CHANGE_BOT_NAME),C=!1;break;case"save_bot_name":A(new mr(e.webID,Ne.CHANGE_BOT_NAME,a));break;case"change_bot_motto":h(Ne.CHANGE_BOT_MOTTO),C=!1;break;case"save_bot_motto":A(new mr(e.webID,Ne.CHANGE_BOT_MOTTO,u));break;case"dress_up":A(new mr(e.webID,Ne.DRESS_UP,""));break;case"random_walk":A(new mr(e.webID,Ne.RANDOM_WALK,""));break;case"setup_chat":h(Ne.SETUP_CHAT),C=!1;break;case"dance":A(new mr(e.webID,Ne.DANCE,""));break;case"nux_take_tour":_e().createLinkEvent("help/tour"),A(new mr(e.webID,Ne.NUX_TAKE_TOUR,""));break;case"pick":A(new ad(e.webID));break}C&&n()};i.useEffect(()=>{s(gi)},[e]);const f=e.amIOwner||e.amIAnyRoomController;return l(cr,{objectId:e.roomIndex,category:Q.UNIT,userType:pt.RENTABLE_BOT,onClose:n,collapsable:!0,children:[t($t,{children:e.name}),r===gi&&f&&l(V,{children:[e.botSkills.indexOf(Ne.DONATE_TO_ALL)>=0&&t(z,{onClick:p=>g("donate_to_all"),children:m("avatar.widget.donate_to_all")}),e.botSkills.indexOf(Ne.DONATE_TO_USER)>=0&&t(z,{onClick:p=>g("donate_to_user"),children:m("avatar.widget.donate_to_user")}),e.botSkills.indexOf(Ne.CHANGE_BOT_NAME)>=0&&t(z,{onClick:p=>g("change_bot_name"),children:m("avatar.widget.change_bot_name")}),e.botSkills.indexOf(Ne.CHANGE_BOT_MOTTO)>=0&&t(z,{onClick:p=>g("change_bot_motto"),children:m("avatar.widget.change_bot_motto")}),e.botSkills.indexOf(Ne.DRESS_UP)>=0&&t(z,{onClick:p=>g("dress_up"),children:m("avatar.widget.dress_up")}),e.botSkills.indexOf(Ne.RANDOM_WALK)>=0&&t(z,{onClick:p=>g("random_walk"),children:m("avatar.widget.random_walk")}),e.botSkills.indexOf(Ne.SETUP_CHAT)>=0&&t(z,{onClick:p=>g("setup_chat"),children:m("avatar.widget.setup_chat")}),e.botSkills.indexOf(Ne.DANCE)>=0&&t(z,{onClick:p=>g("dance"),children:m("avatar.widget.dance")}),e.botSkills.indexOf(Ne.NO_PICK_UP)===-1&&t(z,{onClick:p=>g("pick"),children:m("avatar.widget.pick_up")})]}),r===Iu&&l(T,{className:"menu-item",onClick:null,gap:1,children:[t(S,{variant:"white",children:m("bot.skill.name.configuration.new.name")}),t("input",{type:"text",className:"form-control form-control-sm",value:a,maxLength:K("bot.name.max.length",15),onChange:p=>c(p.target.value)}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(D,{fullWidth:!0,variant:"secondary",onClick:p=>g(null),children:m("cancel")}),t(D,{fullWidth:!0,variant:"success",onClick:p=>g("save_bot_name"),children:m("save")})]})]}),r===Eu&&l(T,{className:"menu-item",onClick:null,gap:1,children:[t(S,{variant:"white",children:m("bot.skill.name.configuration.new.motto")}),t("input",{type:"text",className:"form-control form-control-sm",value:u,maxLength:K("motto.max.length",38),onChange:p=>d(p.target.value)}),l(w,{alignItems:"center",justifyContent:"between",gap:1,children:[t(D,{fullWidth:!0,variant:"secondary",onClick:p=>g(null),children:m("cancel")}),t(D,{fullWidth:!0,variant:"success",onClick:p=>g("save_bot_motto"),children:m("save")})]})]})]})},tO=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(!1),[a,c]=i.useState(null),{avatarInfo:u=null,setAvatarInfo:d=null,activeNameBubble:h=null,setActiveNameBubble:g=null,nameBubbles:f=[],removeNameBubble:p=null,productBubbles:C=[],confirmingProduct:E=null,updateConfirmingProduct:_=null,removeProductBubble:I=null,isDecorating:b=!1,setIsDecorating:N=null}=dT(),{roomSession:v=null}=xe();Te(En.NORMAL_MODE,y=>{e&&n(!1)}),Te(En.GAME_MODE,y=>{e||n(!0)}),Ye(v_.RSDE_DANCE,y=>{y.roomIndex===v.ownRoomIndex&&s(y.danceId!==0)}),lt(Ud.UPDATE_CHAT,y=>c(y));const O=()=>{if(!v||e)return null;if(h)return t(iu,{nameInfo:h,onClose:()=>g(null)});if(u)switch(u.type){case bs.FURNI:{const y=u;return b?t(Xy,{avatarInfo:y,onClose:()=>d(null)}):null}case At.OWN_USER:case At.PEER:{const y=u;return K("user.tags.enabled")&&q().getUserTags(y.roomIndex),y.isSpectatorMode?null:y.isOwnUser?Ci.isRunning()?null:t(Qy,{avatarInfo:y,isDancing:r,setIsDecorating:N,onClose:()=>d(null)}):t($y,{avatarInfo:y,onClose:()=>d(null)})}case Ss.PET_INFO:{const y=u;return y.isOwner?t(Jy,{avatarInfo:y,onClose:()=>d(null)}):t(Zy,{avatarInfo:y,onClose:()=>d(null)})}case Ns.RENTABLE_BOT:return t(eO,{avatarInfo:u,onClose:()=>d(null)})}return null},R=()=>{if(!u)return null;switch(u.type){case bs.FURNI:return t(Vy,{avatarInfo:u,onClose:()=>d(null)});case At.OWN_USER:case At.PEER:return t(Yy,{avatarInfo:u,setAvatarInfo:d,onClose:()=>d(null)});case At.BOT:return t(Gy,{avatarInfo:u,onClose:()=>d(null)});case Ns.RENTABLE_BOT:return t(Wy,{avatarInfo:u,onClose:()=>d(null)});case Ss.PET_INFO:return t(Hy,{avatarInfo:u,onClose:()=>d(null)})}};return l(V,{children:[b&&t(Ky,{userId:q().userId,userName:q().userName,roomIndex:v.ownRoomIndex,setIsDecorating:N}),O(),u&&t(T,{alignItems:"end",className:"nitro-infostand-container",children:R()}),f.length>0&&f.map((y,G)=>t(iu,{nameInfo:y,onClose:()=>p(G)},G)),C.length>0&&C.map((y,G)=>t(By,{item:y,updateConfirmingProduct:_,onClose:()=>I(G)},y.id)),a&&t(Dy,{chatEvent:a,onClose:()=>c(null)}),E&&t(My,{item:E,onClose:()=>_(null)}),t(Py,{})]})},nO=o=>{const{roomSession:e=null}=xe(),{chatStyleId:n=0,updateChatStyleId:r=null}=Yn(),[s,a]=i.useState(null),[c,u]=i.useState(!1);function d(g){e.sendChatMessage(g.native,n)}const h=g=>{let f=!1;u(p=>(f=!p,f)),console.log("hoplaa"),f&&a(g.target)};return i.useEffect(()=>{c||a(null)},[c]),l(V,{children:[t(P,{pointer:!0,className:"icon chatemoji-icon",onClick:h}),t(lo,{show:c,target:s,placement:"top",children:t(ps,{className:"nitro-chat-emoji-selector-container image-rendering-pixelated",style:{maxWidth:"400px"},children:t(re,{overflow:"hidden",className:"bg-transparent",children:t(Cg,{data:_g,onEmojiSelect:d})})})})]})},rO=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(!1),[a,c]=i.useState(null),[u,d]=i.useState(null),[h,g]=i.useState(!0),[f,p]=i.useState(!1),{roomSession:C=null}=xe(),{chatStyleId:E=0,updateChatStyleId:_=null}=Yn();var I=!1;function b(B){if(I=!0,B.length==0){p(!1),g(!0);return}fetch("https://api.giphy.com/v1/gifs/search?api_key=4qwMrfzYMYVl1lhhl3wDaVxDNWAzAv6s&q="+B+"&limit=25&offset=0&rating=g&lang=en").then(M=>M.json()).then(M=>{d(M),g(!1),p(!0)})}function N(B){const M=B.split(".gif");C.sendChatMessage(M[0],E)}function v(){return a==null?null:t("div",{})}function O(){return u==null?null:t(se,{columnCount:4,overflow:"auto",id:"giphyStickers",children:u.data.map(B=>t(P,{children:t("img",{src:B.images.downsized_medium.url,width:50,height:50,className:"sticker-img",onClick:M=>N(B.images.fixed_height_small.url)})},B.images.downsized_medium.url))})}const R=B=>{if(I)return;let M=!0;s(U=>(M=!U,M)),M&&n(B.target),I=!1};function y(){I=!0}var G="";function k(B){G=B}return i.useEffect(()=>{r||n(null)},[r]),t(V,{children:t(P,{pointer:!0,className:"icon chatstickers-icon",onClick:R,style:{marginLeft:"13px",display:"inline-block"},children:r&&t(lo,{show:r,target:e,placement:"top",children:t(ps,{className:"nitro-chat-sticker-selector-container image-rendering-pixelated",children:l(re,{overflow:"hidden",className:"bg-transparent",children:[l(w,{gap:1,children:[t("input",{onClick:B=>y(),onChange:B=>k(B.target.value),type:"text",className:"form-control form-control-sm",placeholder:m("generic.search")}),t(wu,{variant:"primary",className:"stickers-search-button",onClick:B=>b(G),children:t(io,{className:"fa-icon"})})]}),h?t(v,{}):null,f?t(O,{}):null]})})})})})},sO=o=>{const{chatStyleId:e=0,chatStyleIds:n=null,selectChatStyleId:r=null}=o,[s,a]=i.useState(null),[c,u]=i.useState(!1),d=g=>{r(g),u(!1)},h=g=>{let f=!1;u(p=>(f=!p,f)),f&&a(g.target)};return i.useEffect(()=>{c||a(null)},[c]),l(V,{children:[t(P,{pointer:!0,className:"icon chatstyles-icon",onClick:h}),t(lo,{show:c,target:s,placement:"top",children:t(ps,{className:"nitro-chat-style-selector-container image-rendering-pixelated",children:t(re,{overflow:"hidden",className:"bg-transparent",children:t(se,{columnCount:3,overflow:"auto",children:n&&n.length>0&&n.map(g=>t(w,{center:!0,pointer:!0,className:"bubble-parent-container",onClick:f=>d(g),children:t(P,{className:"bubble-container",children:t(P,{className:`chat-bubble bubble-${g}`,children:""})},g)},g))})})})})]})},aO=o=>{const[e,n]=i.useState(""),{chatStyleId:r=0,updateChatStyleId:s=null}=Yn(),{selectedUsername:a="",floodBlocked:c=!1,floodBlockedSeconds:u=0,setIsTyping:d=null,setIsIdle:h=null,sendChat:g=null}=gT(),{roomSession:f=null}=xe(),p=i.useRef(),C=i.useMemo(()=>m("widgets.chatinput.mode.whisper"),[]),E=i.useMemo(()=>m("widgets.chatinput.mode.shout"),[]),_=i.useMemo(()=>m("widgets.chatinput.mode.speak"),[]),I=i.useMemo(()=>K("chat.input.maxlength",100),[]);function b(){document.getElementById("submenuChat").style.display=="block"?document.getElementById("submenuChat").style.display="none":document.getElementById("submenuChat").style.display="block"}function N(){document.getElementById("submenuChat").style.display="none"}const v=i.useCallback(()=>{const M=document.activeElement;return!(!M||p&&p.current===M||!(M instanceof HTMLInputElement)&&!(M instanceof HTMLTextAreaElement))},[p]),O=i.useCallback(()=>{p.current.focus(),p.current.setSelectionRange(p.current.value.length*2,p.current.value.length*2)},[p]),R=i.useCallback(()=>{n(M=>M!==C||!a.length?M:`${M} ${a}`)},[a,C]),y=i.useCallback((M,U=!1)=>{if(!M||M==="")return;let W=U?Wn.CHAT_SHOUT:Wn.CHAT_DEFAULT,L=M;const x=L.split(" ");let j="",H="";switch(x[0]){case C:W=Wn.CHAT_WHISPER,j=x[1],H=C+" "+j+" ",x.shift(),x.shift();break;case E:W=Wn.CHAT_SHOUT,x.shift();break;case _:W=Wn.CHAT_DEFAULT,x.shift();break}L=x.join(" "),d(!1),h(!1),L.length<=I&&(/%CC%/g.test(encodeURIComponent(L))?n(""):(n(""),g(L,W,j,r))),n(H)},[C,E,_,I,r,d,h,g]),G=i.useCallback(M=>{!M||!M.length?d(!1):(d(!0),h(!0)),n(M)},[d,h]),k=i.useCallback(M=>{if(c||!p.current||v())return;document.activeElement!==p.current&&O();const U=M.target.value;switch(M.key){case" ":case"Space":R();return;case"NumpadEnter":case"Enter":y(U,M.shiftKey);return;case"Backspace":if(U){const W=U.split(" ");W[0]===C&&W.length===3&&W[2]===""&&n("")}return}},[c,p,C,v,O,R,y]);lt(Fs.CHAT_INPUT_CONTENT,M=>{switch(M.chatMode){case Fs.WHISPER:{n(`${C} ${M.userName} `);return}case Fs.SHOUT:return}});const B=i.useMemo(()=>{let M=[];const U=K("chat.styles");for(const W of U)if(W){if(W.minRank>0){q().hasSecurity(W.minRank)&&M.push(W.styleId);continue}if(W.isSystemStyle&&q().hasSecurity(nt.MODERATOR)){M.push(W.styleId);continue}if(!(K("chat.styles.disabled").indexOf(W.styleId)>=0)){if(W.isHcOnly&&Cn()>=dn.CLUB){M.push(W.styleId);continue}if(W.isAmbassadorOnly&&q().isAmbassador){M.push(W.styleId);continue}!W.isHcOnly&&!W.isAmbassadorOnly&&M.push(W.styleId)}}return M},[]);return i.useEffect(()=>(document.body.addEventListener("keydown",k),()=>{document.body.removeEventListener("keydown",k)}),[k]),i.useEffect(()=>{p.current&&(p.current.parentElement.dataset.value=e)},[e]),!f||f.isSpectator?null:Vi.createPortal(l(V,{children:[l("div",{id:"submenuChat",className:"animate__animated animate__fadeInUp",style:{paddingLeft:"16px",paddingRight:"13px",paddingTop:"11px",paddingBottom:"7px",position:"absolute",backgroundColor:"rgba(43, 43, 43, 0.8)",top:"-60px",borderRadius:"7px",display:"none",border:"2px solid rgb(44, 45, 42)"},children:[t(sO,{chatStyleId:r,chatStyleIds:B,selectChatStyleId:s}),t(rO,{}),t(nO,{}),t("div",{onClick:()=>N(),className:"icon chatequis-icon",style:{marginLeft:"10px",display:"inline-block"}})]}),l("div",{className:"nitro-chat-input-container",children:[l("div",{className:"input-sizer align-items-center",children:[!c&&t("input",{ref:p,type:"text",className:"chat-input",placeholder:m("widgets.chatinput.default"),value:e,maxLength:I,onChange:M=>G(M.target.value),onMouseDown:M=>O()}),c&&l(S,{variant:"danger",children:[m("chat.input.alert.flood",["time"],[u.toString()])," "]})]}),t("div",{onClick:()=>b(),className:"icon chatmas-icon",style:{marginRight:"3px"}})]})]}),document.getElementById("toolbar-chat-input-container"))},oO=()=>{let o=null;self.onmessage=e=>{if(!e)return;const n=e.data;switch(n.action){case"START":o=setInterval(()=>postMessage(null),n.content);break;case"STOP":o&&(clearInterval(o),o=null);break}}};class iO extends Worker{constructor(e){const n=e.toString(),r=new Blob([`(${n})()`]);super(URL.createObjectURL(r))}}const lO=o=>{const{chat:e=null,makeRoom:n=null,bubbleWidth:r=Et.CHAT_BUBBLE_WIDTH_NORMAL}=o,[s,a]=i.useState(!1),[c,u]=i.useState(!1),d=i.useRef(),h=i.useMemo(()=>{switch(r){case Et.CHAT_BUBBLE_WIDTH_NORMAL:return 350;case Et.CHAT_BUBBLE_WIDTH_THIN:return 240;case Et.CHAT_BUBBLE_WIDTH_WIDE:return 2e3}},[r]);return i.useEffect(()=>{a(!1);const g=d.current;if(!g)return;const f=g.offsetWidth,p=g.offsetHeight;e.width=f,e.height=p,e.elementRef=g;let C=e.left,E=e.top;return!C&&!E&&(C=e.location.x-f/2,E=g.parentElement.offsetHeight-p,e.left=C,e.top=E),u(!0),()=>{e.elementRef=null,u(!1)}},[e]),i.useEffect(()=>{!c||!e||s||(n&&n(e),a(!0))},[e,c,s,n]),l("div",{ref:d,className:`bubble-container ${s?"visible":"invisible"}`,onClick:g=>$().selectRoomObject(e.roomId,e.senderId,Q.UNIT),children:[e.styleId===0&&t("div",{className:"user-container-bg",style:{backgroundColor:e.color}}),l("div",{className:`chat-bubble bubble-${e.styleId} type-${e.type}`,style:{maxWidth:h},children:[t("div",{className:"user-container",children:e.imageUrl&&e.imageUrl.length>0&&t("div",{className:"user-image",style:{backgroundImage:`url(${e.imageUrl})`}})}),l("div",{className:"chat-content",children:[t("b",{className:"username mr-1",dangerouslySetInnerHTML:{__html:`${e.username}: `}}),t("span",{className:"message",dangerouslySetInnerHTML:{__html:`${e.formattedText}`}})]}),t("div",{className:"pointer"})]})]})},cO=o=>{const{chatMessages:e=[],setChatMessages:n=null,chatSettings:r=null,getScrollSpeed:s=6e3}=fT(),a=i.useRef(),c=i.useCallback(()=>{n(h=>{if(h){const g=h.filter(f=>f.top>-f.height*2);if(g.length!==h.length)return g}return h})},[n]),u=i.useCallback((h,g,f)=>{for(let p=e.indexOf(h)-1;p>=0;p--){const C=e[p];if(!(!C||h===C||f.indexOf(C)>=0||C.top+C.height-g>h.top+h.height)&&nS(h,C,-g,0)){const E=Math.abs(C.top+C.height-h.top);f.push(C),C.top-=E,C.skipMovement=!0,u(C,E,f)}}},[e]),d=i.useCallback(h=>{if(r.mode===Et.CHAT_MODE_FREE_FLOW)h.skipMovement=!0,u(h,0,[h]),c();else{const g=h.top+h.height,f=h.height,p=a.current.offsetHeight-g,C=f-p;p<f&&(n(E=>(E.forEach(_=>{_!==h&&(_.top-=C)}),E)),c())}},[r,u,c,n]);return i.useEffect(()=>{const h=(g=null)=>{if(!a||!a.current)return;const f=a.current.offsetHeight,p=Math.round(document.body.offsetHeight*K("chat.viewer.height.percentage"));a.current.style.height=`${p}px`,n(C=>(C&&C.forEach(E=>E.top-=f-p),C))};return window.addEventListener("resize",h),h(),()=>{window.removeEventListener("resize",h)}},[n]),i.useEffect(()=>{const h=f=>{n(p=>(p.forEach(C=>{if(C.skipMovement){C.skipMovement=!1;return}C.top-=f}),p)),c()},g=new iO(oO);return g.onmessage=()=>h(15),g.postMessage({action:"START",content:s}),()=>{g.postMessage({action:"STOP"})}},[s,c,n]),t("div",{ref:a,className:"nitro-chat-widget",children:e.map(h=>t(lO,{chat:h,makeRoom:d,bubbleWidth:r.weight},h.id))})},zm=o=>{const{title:e=null,items:n=[],selectItem:r=null,onClose:s=null}=o,[a,c]=i.useState(null),[u,d]=i.useState(""),h=q().isModerator,g=i.useMemo(()=>{const f=u.toLocaleLowerCase();return n.filter(p=>{var C;return(C=p.name)==null?void 0:C.toLocaleLowerCase().includes(f)})},[n,u]);return i.useEffect(()=>{a&&r(a)},[a,r]),l(oe,{className:"nitro-chooser-widget",theme:"primary-slim",children:[t(ie,{headerText:e,onCloseClick:s}),l(re,{overflow:"hidden",gap:2,children:[t("input",{type:"text",className:"form-control form-control-sm",placeholder:m("generic.search"),value:u,onChange:f=>d(f.target.value)}),t(_o,{rows:g,rowRender:f=>t(w,{alignItems:"center",className:Gt("rounded p-1",a===f&&"bg-muted"),pointer:!0,onClick:p=>c(f),children:l(S,{truncate:!0,children:[f.name," ",h&&" - "+f.id]})})})]})]})},uO=o=>{const{items:e=null,onClose:n=null,selectItem:r=null,populateChooser:s=null}=NT();return i.useEffect(()=>{const a={linkReceived:c=>{c.split("/"),s()},eventUrlPrefix:"furni-chooser/"};return ut(a),()=>dt(a)},[s]),e?t(zm,{title:m("widget.chooser.furni.title"),items:e,selectItem:r,onClose:n}):null},dO=o=>{const{items:e=null,onClose:n=null,selectItem:r=null,populateChooser:s=null}=OT();return i.useEffect(()=>{const a={linkReceived:c=>{c.split("/"),s()},eventUrlPrefix:"user-chooser/"};return ut(a),()=>dt(a)},[s]),e?t(zm,{title:m("widget.chooser.user.title"),items:e,selectItem:r,onClose:n}):null};class mO{constructor(){this.handler="getCustomize",this.session=new URLSearchParams(window.location.search).get("sso")}}class oo{constructor(e,n){this.handler="updateCustomize",this.session=new URLSearchParams(window.location.search).get("sso"),this.type=e,this.id=n}}const gO=o=>{i.useState([]);const{sendMessage:e,lastMessage:n,readyState:r}=Kr(K("external.websocket"),{share:!0});return l(V,{children:[t(Ie,{itemActive:!1,onClick:()=>e(JSON.stringify(new oo("color",0))),children:t("span",{style:{color:"gray"},children:"OFF"})},-1),o.colors.map((s,a)=>t(Ie,{itemActive:!1,onClick:()=>e(JSON.stringify(new oo("color",s.id))),style:{backgroundColor:`#${s.haxCode}`}},a))]})},hO=o=>{i.useState([]);const{sendMessage:e,lastMessage:n,readyState:r}=Kr(K("external.websocket"),{share:!0});return l(V,{children:[t(Ie,{itemActive:!1,onClick:()=>e(JSON.stringify(new oo("icon",0))),children:t("span",{style:{color:"gray"},children:"OFF"})},-1),o.icons.map((s,a)=>t(Ie,{itemActive:!1,itemImage:s.iconImage,onClick:()=>e(JSON.stringify(new oo("icon",s.id)))},a))]})},fO=["Iconos","Colores"],pO=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(0),[a,c]=i.useState([]),{sendMessage:u,lastMessage:d,readyState:h}=Kr(K("external.websocket"),{share:!0}),[g,f]=i.useState([]),[p,C]=i.useState([]);return i.useEffect(()=>{const E={linkReceived:_=>{const I=_.split("/");if(!(I.length<2))switch(I[1]){case"show":n(!0),u(JSON.stringify(new mO));return;case"hide":n(!1);return}},eventUrlPrefix:"customize/"};return ut(E),()=>dt(E)},[n]),i.useEffect(()=>{if(d!==null){var E=JSON.parse(d.data);E.header==="getCustomizeResponse"&&E.data!==null&&(f(E.data.iconsName),C(E.data.colorsName))}},[d,c]),t(V,{children:e&&l(oe,{style:{height:"300px",width:"390px"},children:[t(ie,{headerText:"Customize",onCloseClick:E=>n(!1)}),t(lr,{children:fO.map((E,_)=>t(Mn,{isActive:r===_,onClick:I=>s(_),children:E},_))}),t(re,{children:t(se,{children:t(T,{overflow:"hidden",size:12,children:t(ke,{columnCount:4,children:t(V,{children:r==0?t(hO,{icons:g}):t(gO,{colors:p})})})})})})]})})},IO=o=>{const[e,n]=i.useState(!1),{users:r=[],answer:s=null}=IT();return i.useEffect(()=>{n(!!r.length)},[r]),e?l(oe,{className:"nitro-widget-doorbell",theme:"primary-slim",children:[t(ie,{headerText:m("navigator.doorbell.title"),onCloseClick:a=>n(!1)}),l(re,{overflow:"hidden",gap:0,children:[t(T,{gap:2,children:l(se,{gap:1,className:"text-black fw-bold border-bottom px-1 pb-1",children:[t(P,{className:"g-col-6",children:m("generic.username")}),t(P,{className:"g-col-6"})]})}),t(T,{overflow:"auto",className:"striped-children",gap:0,children:r&&r.length>0&&r.map(a=>l(se,{gap:1,alignItems:"center",className:"text-black border-bottom p-1",children:[t(P,{className:"g-col-6",children:a}),t(P,{className:"g-col-6",children:l(w,{alignItems:"center",justifyContent:"end",gap:1,children:[t(D,{variant:"success",onClick:()=>s(a,!0),children:m("generic.accept")}),t(D,{variant:"danger",onClick:()=>s(a,!1),children:m("generic.deny")})]})})]},a))})]})]}):null},Cl=o=>{const{objectId:e=-1,category:n=-1,noFollow:r=!1,position:s="absolute",...a}=o,[c,u]=i.useState({x:-1,y:-1}),d=i.useRef();return i.useEffect(()=>{let h=!1;const g=()=>{const p=Oe();return Ji(p.roomId,e,n,1)},f=()=>{const p=g();!p||!d.current||u({x:Math.round(p.left+p.width/2-d.current.offsetWidth/2),y:Math.round(p.top-d.current.offsetHeight+10)})};return r?f():(h=!0,Er().add(f)),()=>{h&&Er().remove(f)}},[e,n,r]),t(P,{innerRef:d,position:s,visible:c.x+(d.current?d.current.offsetWidth:0)>-1,className:"object-location",style:{left:c.x,top:c.y},...a})},EO=o=>{const{roomIndex:e=-1,request:n=null,hideFriendRequest:r=null,requestResponse:s=null}=o;return t(Cl,{objectId:e,category:Q.UNIT,children:t(P,{className:"nitro-friend-request-dialog nitro-context-menu p-2",children:l(T,{children:[l(w,{alignItems:"center",justifyContent:"between",gap:2,children:[t(S,{variant:"white",fontSize:6,children:m("widget.friendrequest.from",["username"],[n.name])}),t(hn,{className:"cursor-pointer fa-icon",onClick:a=>r(n.requesterUserId)})]}),l(w,{justifyContent:"end",gap:1,children:[t(D,{variant:"danger",onClick:a=>s(n.requesterUserId,!1),children:m("widget.friendrequest.decline")}),t(D,{variant:"success",onClick:a=>s(n.requesterUserId,!0),children:m("widget.friendrequest.accept")})]})]})})})},CO=o=>{const{displayedRequests:e=[],hideFriendRequest:n=null}=bT(),{requestResponse:r=null}=fn();return e.length?t(V,{children:e.map((s,a)=>t(EO,{roomIndex:s.roomIndex,request:s.request,hideFriendRequest:n,requestResponse:r},a))}):null},_O=o=>{const{productType:e=de.FLOOR,classId:n=-1,extraParam:r=void 0}=o;switch(e){case de.WALL:case de.FLOOR:return t(il,{productType:e,productClassId:n});case de.BADGE:return t(qe,{badgeCode:r});case de.HABBO_CLUB:return t(at,{type:"hc"})}return null},bO=o=>{const{ownerId:e=-1}=o,[n,r]=i.useState(0),[s,a]=i.useState(void 0),c=()=>{n===1&&A(new O_(e)),r(0),a(void 0)};F(w_,d=>{r(1)}),F(R_,d=>{r(0),a(void 0)}),F(y_,d=>{const h=d.getParser();a({contentType:h.contentType,classId:h.classId}),r(2)});const u=q().userId===e;return n===0?null:l(oe,{className:"nitro-mysterybox-dialog",theme:"primary-slim",children:[t(ie,{headerText:m(n===1?`mysterybox.dialog.${u?"owner":"other"}.title`:"mysterybox.reward.title"),onCloseClick:c}),l(re,{children:[n===1&&l(V,{children:[l(S,{variant:"primary",children:[" ",m(`mysterybox.dialog.${u?"owner":"other"}.subtitle`)," "]}),l(S,{children:[" ",m(`mysterybox.dialog.${u?"owner":"other"}.description`)," "]}),l(S,{children:[" ",m(`mysterybox.dialog.${u?"owner":"other"}.waiting`)]}),l(D,{variant:"danger",onClick:c,className:"mt-auto",children:[" ",m(`mysterybox.dialog.${u?"owner":"other"}.cancel`)," "]})]}),n===2&&s&&l(V,{children:[l(S,{variant:"black",children:[" ",m("mysterybox.reward.text")," "]}),t(w,{className:"prize-container justify-content-center mx-auto",children:t(_O,{classId:s.classId,productType:s.contentType})}),l(D,{variant:"success",onClick:c,className:"mt-auto",children:[" ",m("mysterybox.reward.close")," "]})]})]})]})},SO=o=>{const{objectId:e=-1,onClose:n=null}=o,[r,s]=i.useState(""),a=()=>{A(new k_(e,r)),n()};return e===-1?null:l(oe,{className:"nitro-mysterytrophy-dialog no-resize",theme:"primary-slim",children:[t(ie,{center:!0,headerText:m("mysterytrophy.header.title"),onCloseClick:n}),l(re,{children:[l(w,{className:"mysterytrophy-dialog-top p-3",children:[t("div",{className:"mysterytrophy-image flex-shrink-0"}),t("div",{className:"m-2",children:t(S,{variant:"white",className:"mysterytrophy-text-big",children:m("mysterytrophy.header.description")})})]}),t(w,{className:"mysterytrophy-dialog-bottom p-2",children:l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-mysterytrophy-dialog",children:[t("textarea",{className:"form-control form-control-sm input-mysterytrophy",value:r,onChange:c=>s(c.target.value)}),t("div",{className:"mysterytrophy-pencil-image flex-shrink-0 small fa-icon"})]}),l(w,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[t(S,{pointer:!0,className:"text-decoration",onClick:()=>n(),children:m("cancel")}),t(D,{variant:"success",onClick:()=>a(),children:m("generic.ok")})]})]})})]})]})},NO=o=>{const{objectId:e=-1,onClose:n=null}=o,{roomSession:r=null}=xe(),s=()=>{r.useMultistateItem(e),n()};return l(oe,{className:"nitro-use-product-confirmation",children:[t(ie,{headerText:m("effectbox.header.title"),onCloseClick:n}),t(re,{center:!0,children:t(w,{gap:2,children:l(T,{justifyContent:"between",children:[t(S,{children:m("effectbox.header.description")}),l(w,{alignItems:"center",justifyContent:"between",children:[t(D,{variant:"danger",onClick:n,children:m("generic.cancel")}),t(D,{variant:"success",onClick:s,children:m("generic.ok")})]})]})})})]})},Ga=-1,TO=0,vO=o=>{const{objectId:e=-1,onClose:n=null}=o,[r,s]=i.useState(null),[a,c]=i.useState(Ga),{roomSession:u=null}=xe(),d=()=>{u.useMultistateItem(e),n()};return i.useEffect(()=>{if(!u||e===-1)return;const h=uo(u.roomId,e,Q.FLOOR);if(!h)return;s(h);let g=Ga;switch(h.specialType){case Z.MONSTERPLANT_SEED:g=TO;break}if(g===Ga){n();return}c(g)},[u,e,n]),a===Ga?null:l(oe,{className:"nitro-use-product-confirmation",children:[t(ie,{headerText:m("useproduct.widget.title.plant_seed",["name"],[r.name]),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(P,{className:"product-preview",children:t(P,{className:"monsterplant-image"})})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[t(S,{children:m("useproduct.widget.text.plant_seed",["productName"],[r.name])}),t(S,{children:m("useproduct.widget.info.plant_seed")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(D,{variant:"danger",onClick:n,children:m("useproduct.widget.cancel")}),t(D,{variant:"success",onClick:d,children:m("widget.monsterplant_seed.button.use")})]})]})]})})]})},Va=-1,wO=0,RO=o=>{const{objectId:e=-1,onClose:n=null}=o,[r,s]=i.useState(Va),[a,c]=i.useState(ye.MALE),[u,d]=i.useState(null),{roomSession:h=null}=xe(),g=()=>{Ti().send(new A_(e)),Ti().send(new $u(a,u)),n()};return i.useEffect(()=>{let f=Va;const p=q().figure,C=q().gender,E=[];if(h&&e>=0){const _=uo(h.roomId,e,Q.FLOOR);if(_)switch(_.specialType){case Z.FIGURE_PURCHASABLE_SET:f=wO;const I=_.customParams.split(",").map(b=>parseInt(b));for(const b of I)Nt().isValidFigureSetForGender(b,C)&&E.push(b);break}}if(f===Va){n();return}c(C),d(Nt().getFigureStringWithFigureIds(p,C,E)),s(f)},[h,e,n]),r===Va?null:l(oe,{className:"nitro-use-product-confirmation",children:[t(ie,{headerText:m("useproduct.widget.title.bind_clothing"),onCloseClick:n}),t(re,{center:!0,children:l(w,{gap:2,overflow:"hidden",children:[t(T,{children:t(P,{className:"mannequin-preview",children:t(ot,{figure:u,direction:2})})}),l(T,{justifyContent:"between",overflow:"auto",children:[l(T,{gap:2,children:[t(S,{children:m("useproduct.widget.text.bind_clothing")}),t(S,{children:m("useproduct.widget.info.bind_clothing")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(D,{variant:"danger",onClick:n,children:m("useproduct.widget.cancel")}),t(D,{variant:"success",onClick:g,children:m("useproduct.widget.bind_clothing")})]})]})]})})]})},yO=o=>{const{closeConfirm:e=null,processAction:n=null,onClose:r=null,objectId:s=-1,mode:a=null,confirmMode:c=null,confirmingObjectId:u=-1,groupData:d=null,isGroupMember:h=!1,objectOwnerId:g=-1}=_N(),{simpleAlert:f=null}=Je();F(P_,C=>{const E=C.getParser();if(E)switch(E.count){case 1:f(m("costumehopper.costumerequired.bodytext"),null,"catalog/open/temporary_effects",m("costumehopper.costumerequired.buy"),m("costumehopper.costumerequired.header"),null);break;case 2:f(m("viphopper.viprequired.bodytext"),null,"catalog/open/habbo_club",m("viprequired.buy.vip"),m("viprequired.header"),null);break;case 3:f(m("gate.viprequired.bodytext"),null,"catalog/open/habbo_club",m("viprequired.buy.vip"),m("gate.viprequired.title"),null);break}});const p=q().userId===g;return l(V,{children:[c===xi&&t(vO,{objectId:u,onClose:e}),c===Fi&&t(RO,{objectId:u,onClose:e}),c===bm&&t(NO,{objectId:u,onClose:e}),c===Bi&&t(SO,{objectId:u,onClose:e}),t(bO,{ownerId:g}),s>=0&&a&&l(cr,{objectId:s,category:Q.FLOOR,onClose:r,fades:!0,children:[a===Mt.FRIEND_FURNITURE&&l(V,{children:[t($t,{children:m("friendfurni.context.title")}),t(z,{onClick:C=>n("use_friend_furni"),children:m("friendfurni.context.use")})]}),a===Mt.MONSTERPLANT_SEED&&l(V,{children:[t($t,{children:m("furni.mnstr_seed.name")}),t(z,{onClick:C=>n("use_monsterplant_seed"),children:m("widget.monsterplant_seed.button.use")})]}),a===Mt.RANDOM_TELEPORT&&l(V,{children:[t($t,{children:m("furni.random_teleport.name")}),t(z,{onClick:C=>n("use_random_teleport"),children:m("widget.random_teleport.button.use")})]}),a===Mt.PURCHASABLE_CLOTHING&&l(V,{children:[t($t,{children:m("furni.generic_usable.name")}),t(z,{onClick:C=>n("use_purchaseable_clothing"),children:m("widget.generic_usable.button.use")})]}),a===Mt.MYSTERY_BOX&&l(V,{children:[t($t,{children:m("mysterybox.context.title")}),t(z,{onClick:C=>n("use_mystery_box"),children:m("mysterybox.context."+(p?"owner":"other")+".use")})]}),a===Mt.MYSTERY_TROPHY&&l(V,{children:[t($t,{children:m("mysterytrophy.header.title")}),t(z,{onClick:C=>n("use_mystery_trophy"),children:m("friendfurni.context.use")})]}),a===_m&&d&&l(V,{children:[t($t,{className:"cursor-pointer text-truncate",onClick:()=>ia(d.guildId),children:d.guildName}),!h&&t(z,{onClick:C=>n("join_group"),children:m("widget.furniture.button.join.group")}),t(z,{onClick:C=>n("go_to_group_homeroom"),children:m("widget.furniture.button.go.to.group.home.room")}),d.guildHasReadableForum&&t(z,{onClick:C=>n("open_forum"),children:m("widget.furniture.button.open_group_forum")})]})]})]})},OO=o=>{const{objectId:e=-1,color:n=0,setColor:r=null,applyToner:s=null,toggleToner:a=null,onClose:c=null}=pN();return e===-1?null:l(oe,{theme:"primary-slim",className:"nitro-room-widget-toner",children:[t(ie,{headerText:m("widget.backgroundcolor.title"),onCloseClick:c}),l(re,{overflow:"hidden",justifyContent:"between",children:[t(T,{overflow:"auto",gap:1,children:t("input",{type:"color",className:"form-control",value:en.makeColorNumberHex(n),onChange:u=>r(en.convertFromHex(u.target.value))})}),l(T,{gap:1,children:[t(D,{fullWidth:!0,variant:"primary",onClick:a,children:m("widget.backgroundcolor.button.on")}),t(D,{fullWidth:!0,variant:"primary",onClick:s,children:m("widget.backgroundcolor.button.apply")})]})]})]})},kO=o=>{const{objectId:e=-1,color:n="1",badgeName:r="",badgeDesc:s="",date:a="",senderName:c="",onClose:u=null}=EN();return e===-1?null:t(Xd,{color:n,message:s,date:a,senderName:c,customTitle:r,onCloseClick:u})},AO=o=>{const{objectId:e=-1,recipes:n=[],ingredients:r=[],selectedRecipe:s=null,requiredIngredients:a=null,isCrafting:c=!1,craft:u=null,selectRecipe:d=null,onClose:h=null}=SN(),{roomSession:g=null}=xe(),[f,p]=i.useState(!1),C=i.useMemo(()=>{const I=$().getRoomObject(g.roomId,e,Q.FLOOR);return Ht(I)},[e,g.roomId]),E=i.useMemo(()=>{if(!a||!a.length)return!1;for(const I of a){const b=r.find(N=>N.name===I.itemName);if(!b||b.count<I.count)return!1}return!0},[r,a]),_=()=>{if(!f){p(!0);return}u(),p(!1)};return i.useEffect(()=>{p(!1)},[s]),e===-1?null:l(oe,{className:"nitro-widget-crafting",theme:"primary-slim",children:[t(ie,{headerText:m("crafting.title"),onCloseClick:h}),t(re,{children:l(w,{grow:!0,overflow:"hidden",gap:2,children:[l(w,{column:!0,fullWidth:!0,gap:2,children:[l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:m("crafting.title.products")}),t(ke,{columnCount:5,children:n.length>0&&n.map(I=>t(Ie,{itemImage:I.iconUrl,itemActive:s&&s.name===I.name,onClick:()=>d(I)},I.name))})]}),l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:m("crafting.title.mixer")}),t(ke,{columnCount:5,children:r.length>0&&r.map(I=>t(Ie,{itemImage:I.iconUrl,itemCount:I.count,itemCountMinimum:0,className:(I.count?"":"opacity-0-5 ")+"cursor-default"},I.name))})]})]}),l(w,{column:!0,fullWidth:!0,gap:2,children:[!s&&t(T,{center:!0,fullHeight:!0,className:"text-black text-center",children:m("crafting.info.start")}),s&&l(V,{children:[l(T,{overflow:"hidden",fullHeight:!0,children:[t("div",{className:"bg-muted rounded py-1 text-center",children:m("crafting.current_recipe")}),t(ke,{columnCount:5,children:!!a&&a.length>0&&a.map(I=>{const b=r.find(v=>v.name===I.itemName),N=[];for(let v=0;v<I.count;v++)N.push(t(Ie,{itemImage:b.iconUrl,className:(b.count-v<=0?"opacity-0-5 ":"")+"cursor-default"},v));return N})})]}),l(w,{gap:2,column:!0,fullHeight:!0,children:[l(w,{gap:2,className:"bg-muted rounded",column:!0,fullHeight:!0,children:[t("div",{className:"py-1 text-center",children:m("crafting.result")}),l(w,{gap:1,center:!0,column:!0,fullHeight:!0,className:"pb-1",children:[t(T,{fullHeight:!0,children:t("img",{src:s.iconUrl})}),t("div",{className:"text-black",children:s.localizedName})]})]}),l(D,{variant:!C||!E?"danger":f?"warning":c?"primary":"success",disabled:!C||!E||c,onClick:_,children:[!c&&m(C?E?f?"generic.confirm":"crafting.btn.craft":"crafting.status.recipe.incomplete":"crafting.btn.notowner"),c&&t(ll,{})]})]})]})]})]})})]})},PO=o=>{const[e,n]=i.useState(!1),{presets:r=[],dimmerState:s=0,selectedPresetId:a=0,color:c=16777215,brightness:u=255,effectId:d=0,selectedColor:h=0,setSelectedColor:g=null,selectedBrightness:f=0,setSelectedBrightness:p=null,selectedEffectId:C=0,setSelectedEffectId:E=null,selectPresetId:_=null,applyChanges:I}=TN(),b=()=>{an.previewDimmer(c,u,d===2),n(!1)};Te(ve.REMOVE_DIMMER,v=>n(!1)),i.useEffect(()=>{!r||!r.length||n(!0)},[r]);const N=i.useMemo(()=>K("widget.dimmer.colorwheel",!1),[]);return e?l(oe,{className:"nitro-room-widget-dimmer",children:[t(ie,{headerText:m("widget.dimmer.title"),onCloseClick:b}),s===1&&t(lr,{children:r.map(v=>t(Mn,{isActive:a===v.id,onClick:O=>_(v.id),children:m(`widget.dimmer.tab.${v.id}`)},v.id))}),l(re,{children:[s===0&&l(T,{alignItems:"center",children:[t(P,{className:"dimmer-banner"}),t(S,{center:!0,className:"bg-muted rounded p-1",children:m("widget.dimmer.info.off")}),t(D,{fullWidth:!0,variant:"success",onClick:()=>an.changeState(),children:m("widget.dimmer.button.on")})]}),s===1&&l(V,{children:[l(T,{gap:1,children:[t(S,{fontWeight:"bold",children:m("widget.backgroundcolor.hue")}),N&&t("input",{type:"color",className:"form-control",value:en.makeColorNumberHex(h),onChange:v=>g(en.convertFromHex(v.target.value))}),!N&&t(se,{gap:1,columnCount:7,children:an.AVAILABLE_COLORS.map((v,O)=>t(T,{fullWidth:!0,pointer:!0,className:Gt("color-swatch rounded",v===h&&"active"),onClick:()=>g(v),style:{backgroundColor:an.HTML_COLORS[O]}},O))})]}),l(T,{gap:1,children:[t(S,{fontWeight:"bold",children:m("widget.backgroundcolor.lightness")}),t(Dt,{className:"nitro-slider",min:an.MIN_BRIGHTNESS,max:an.MAX_BRIGHTNESS,value:f,onChange:v=>p(v),thumbClassName:"thumb percent",renderThumb:(v,O)=>t("div",{...v,children:an.scaleBrightness(O.valueNow)})})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:C===2,onChange:v=>E(v.target.checked?2:1)}),t(S,{children:m("widget.dimmer.type.checkbox")})]}),l(w,{gap:1,children:[t(D,{fullWidth:!0,variant:"danger",onClick:()=>an.changeState(),children:m("widget.dimmer.button.off")}),t(D,{fullWidth:!0,variant:"success",onClick:I,children:m("widget.dimmer.button.apply")})]})]})]})]}):null},DO=o=>{const{objectId:e=-1,value:n=0,onClose:r=null,redeem:s=null}=wN();return e===-1?null:l(oe,{className:"nitro-widget-exchange-credit",theme:"primary-slim",children:[t(ie,{headerText:m("catalog.redeem.dialog.title"),onCloseClick:r}),t(re,{center:!0,children:l(w,{overflow:"hidden",gap:2,children:[t(T,{center:!0,children:t(P,{className:"exchange-image"})}),l(T,{grow:!0,justifyContent:"between",overflow:"hidden",children:[l(T,{gap:1,overflow:"auto",children:[t(S,{fontWeight:"bold",children:m("creditfurni.description",["credits"],[n.toString()])}),t(S,{children:m("creditfurni.prompt")})]}),t(D,{variant:"success",onClick:s,children:m("catalog.redeem.dialog.button.exchange")})]})]})})]})},MO=o=>{const{currentIndex:e=-1,currentPhotos:n=null}=o,[r,s]=i.useState(0),a=n&&n.length?n[r]:null,c=()=>{s(d=>{let h=d+1;return h>=n.length&&(h=0),h})},u=()=>{s(d=>{let h=d-1;return h<0&&(h=n.length-1),h})};return i.useEffect(()=>{s(e)},[e]),a?l(se,{style:{display:"flex",flexDirection:"column"},children:[t(w,{center:!0,className:"picture-preview border border-black",style:a.w?{backgroundImage:"url("+a.w+")"}:{},children:!a.w&&t(S,{bold:!0,children:m("camera.loading")})}),a.m&&a.m.length&&t(S,{center:!0,children:a.m}),l(w,{alignItems:"center",justifyContent:"between",children:[t(S,{children:a.n||""}),t(S,{children:new Date(a.t).toLocaleDateString()})]}),n.length>1&&l(w,{className:"picture-preview-buttons",children:[t(Nu,{className:"cursor-pointer picture-preview-buttons-previous fa-icon",onClick:u}),t(S,{underline:!0,className:"cursor-pointer",onClick:d=>tn(a.oi),children:a.o}),t(Tu,{className:"cursor-pointer picture-preview-buttons-next fa-icon",onClick:c})]})]}):null},LO=o=>{const{objectId:e=-1,currentPhotoIndex:n=-1,currentPhotos:r=null,onClose:s=null}=yN(),{report:a=null}=Un();return e===-1||n===-1?null:l(oe,{className:"nitro-external-image-widget",theme:"primary-slim",children:[t(ie,{headerText:"",isGalleryPhoto:!0,onReportPhoto:()=>a(He.PHOTO,{extraData:r[n].w,roomId:r[n].s,reportedUserId:q().userId,roomObjectId:Number(r[n].u)}),onCloseClick:s}),t(re,{children:t(MO,{currentIndex:n,currentPhotos:r})})]})},UO=o=>{const{objectId:e=-1,type:n=0,stage:r=0,usernames:s=[],figures:a=[],date:c=null,onClose:u=null,respond:d=null}=kN();if(e===-1)return null;if(r>0)return l(oe,{className:"nitro-engraving-lock",theme:"primary-slim",children:[t(ie,{headerText:m("friend.furniture.confirm.lock.caption"),onCloseClick:u}),l(re,{children:[t("h5",{className:"text-black text-center fw-bold mt-2 mb-2",children:m("friend.furniture.confirm.lock.subtitle")}),t("div",{className:"d-flex justify-content-center mb-2",children:t("div",{className:`engraving-lock-stage-${r}`})}),r===2&&t("div",{className:"text-small text-black text-center mb-2",children:m("friend.furniture.confirm.lock.other.locked")}),l(w,{gap:1,children:[t(D,{fullWidth:!0,onClick:h=>d(!1),children:m("friend.furniture.confirm.lock.button.cancel")}),t(D,{fullWidth:!0,variant:"success",onClick:h=>d(!0),children:m("friend.furniture.confirm.lock.button.confirm")})]})]})]});if(s.length>0)return t(Ar,{handleSelector:".nitro-engraving-lock-view",children:l("div",{className:`nitro-engraving-lock-view engraving-lock-${n}`,children:[t("div",{className:"engraving-lock-close",onClick:u}),l(w,{justifyContent:"center",children:[t("div",{className:"engraving-lock-avatar",children:t(ot,{figure:a[0],direction:2})}),t("div",{className:"engraving-lock-avatar",children:t(ot,{figure:a[1],direction:4})})]}),l(T,{justifyContent:"between",className:"mt-1",children:[l(T,{alignItems:"center",justifyContent:"center",gap:1,children:[l("div",{children:[n===0&&m("lovelock.engraving.caption"),n===3&&m("wildwest.engraving.caption")]}),t("div",{children:c})]}),l(w,{justifyContent:"center",gap:4,children:[t("div",{children:s[0]}),t("div",{children:s[1]})]})]})]})})},xO=o=>{const{objectId:e=-1,classId:n=-1,itemType:r=null,text:s=null,isOwnerOfFurniture:a=!1,senderName:c=null,senderFigure:u=null,placedItemId:d=-1,placedItemType:h=null,placedInRoom:g=!1,imageUrl:f=null,openPresent:p=null,onClose:C=null}=qN(),{groupItems:E=[]}=Zr();if(e===-1)return null;const _=I=>{const b=E.find(N=>{var v;return((v=N.getItemById(I))==null?void 0:v.id)===I});b&&_s(b),C()};return l(oe,{className:"nitro-gift-opening",theme:"primary-slim",children:[t(ie,{headerText:m(c?"widget.furni.present.window.title_from":"widget.furni.present.window.title",["name"],[c]),onCloseClick:C}),l(re,{children:[d===-1&&l(T,{overflow:"hidden",children:[t(w,{center:!0,overflow:"auto",children:t($d,{userName:c,figure:u,message:s})}),a&&l(w,{gap:1,children:[c&&t(D,{fullWidth:!0,onClick:I=>ee("catalog/open"),children:m("widget.furni.present.give_gift",["name"],[c])}),t(D,{fullWidth:!0,variant:"success",onClick:p,children:m("widget.furni.present.open_gift")})]})]}),d>-1&&l(w,{gap:2,overflow:"hidden",children:[t(T,{center:!0,className:"p-2",children:t(ir,{imageUrl:f})}),l(T,{grow:!0,children:[l(T,{center:!0,gap:1,children:[t(S,{wrap:!0,small:!0,children:m("widget.furni.present.message_opened")}),t(S,{bold:!0,fontSize:5,children:s})]}),l(T,{grow:!0,gap:1,children:[l(w,{gap:1,children:[g&&t(D,{fullWidth:!0,onClick:null,children:m("widget.furni.present.put_in_inventory")}),t(D,{fullWidth:!0,variant:"success",onClick:I=>_(d),children:m(g?"widget.furni.present.keep_in_room":"widget.furni.present.place_in_room")})]}),c&&c.length&&t(D,{fullWidth:!0,onClick:I=>ee("catalog/open"),children:m("widget.furni.present.give_gift",["name"],[c])})]})]})]})]})]})},FO=o=>{const{stuffDatas:e=null,getScoreType:n=null,getClearType:r=null}=MN();return!e||!e.size?null:t(V,{children:Array.from(e.entries()).map(([s,a],c)=>t(Cl,{objectId:s,category:Q.FLOOR,children:l(T,{className:"nitro-widget-high-score nitro-context-menu",gap:0,children:[t($t,{children:m("high.score.display.caption",["scoretype","cleartype"],[m(`high.score.display.scoretype.${n(a.scoreType)}`),m(`high.score.display.cleartype.${r(a.clearType)}`)])}),l(qm,{overflow:"hidden",gap:1,className:"h-100",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",children:[t(S,{center:!0,bold:!0,variant:"white",className:"col-8",children:m("high.score.display.users.header")}),t(S,{center:!0,bold:!0,variant:"white",className:"col-4",children:m("high.score.display.score.header")})]}),t("hr",{className:"m-0"})]}),t(T,{overflow:"auto",gap:1,className:"overflow-y-scroll",children:a.entries.map((u,d)=>l(w,{alignItems:"center",children:[t(S,{center:!0,variant:"white",className:"col-8",children:u.users.join(", ")}),t(S,{center:!0,variant:"white",className:"col-4",children:u.score})]},d))})]})]})},c))})},BO=o=>(xN(),null),GO=-1,Ha=0,hi=1,fi=2,pi=3,Ii=4,VO=o=>{const[e,n]=i.useState(null),[r,s]=i.useState(GO),{objectId:a=-1,figure:c=null,gender:u=null,clubLevel:d=dn.NO_CLUB,name:h=null,setName:g=null,saveFigure:f=null,wearFigure:p=null,saveName:C=null,onClose:E=null}=BN();return i.useEffect(()=>{if(a===-1)return;const _=Oe();if(_.isRoomOwner||_.controllerLevel>=nt.GUEST||q().isModerator){s(Ha);return}if(q().gender.toLowerCase()!==u.toLowerCase()){s(Ii);return}if(Cn()<d){s(pi);return}s(fi)},[a,u,d]),i.useEffect(()=>{switch(r){case Ha:case Ii:{const _=Nt().createFigureContainer(c);fs.transformAsMannequinFigure(_),n(_.getFigureString());break}case hi:{const _=Nt().createFigureContainer(q().figure);fs.transformAsMannequinFigure(_),n(_.getFigureString());break}case fi:case pi:{const _=fs.getMergedMannequinFigureContainer(q().figure,c);n(_.getFigureString());break}}},[r,c,d]),a===-1?null:l(oe,{className:"nitro-mannequin no-resize",theme:"primary-slim",children:[t(ie,{headerText:m("mannequin.widget.title"),onCloseClick:E}),t(re,{center:!0,children:l(w,{fullWidth:!0,gap:2,overflow:"hidden",children:[t(T,{children:l(P,{position:"relative",className:"mannequin-preview",children:[t(ot,{position:"absolute",figure:e,direction:2}),d>0&&t(at,{className:"position-absolute end-2 bottom-2",type:"hc"})]})}),l(T,{grow:!0,justifyContent:"between",overflow:"auto",children:[r===Ha&&l(V,{children:[t("input",{type:"text",className:"form-control form-control-sm",value:h,onChange:_=>g(_.target.value),onBlur:C}),l(T,{gap:1,children:[t(D,{variant:"success",onClick:_=>s(hi),children:m("mannequin.widget.style")}),t(D,{variant:"success",onClick:p,children:m("mannequin.widget.wear")})]})]}),r===hi&&l(V,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:h}),t(S,{wrap:!0,children:m("mannequin.widget.savetext")})]}),l(w,{alignItems:"center",justifyContent:"between",children:[t(S,{underline:!0,pointer:!0,onClick:_=>s(Ha),children:m("mannequin.widget.back")}),t(D,{variant:"success",onClick:f,children:m("mannequin.widget.save")})]})]}),r===fi&&l(V,{children:[l(T,{gap:1,children:[t(S,{bold:!0,children:h}),t(S,{children:m("mannequin.widget.weartext")})]}),t(D,{variant:"success",onClick:p,children:m("mannequin.widget.wear")})]}),r===pi&&t(w,{center:!0,grow:!0,children:t(S,{children:m("mannequin.widget.clubnotification")})}),r===Ii&&t(S,{children:m("mannequin.widget.wronggender")})]})]})})]})},HO=o=>($N(),null),Ym=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],WO=["blue","pink","green","yellow"],jO=o=>{let e=Ym.indexOf(o);return e===-1&&(e=0),WO[e]},qO=o=>{const{objectId:e=-1,color:n="0",setColor:r=null,text:s="",setText:a=null,canModify:c=!1,onClose:u=null}=XN();return e===-1?null:t(Ar,{handleSelector:".drag-handler",windowPosition:Rt.TOP_LEFT,children:l("div",{className:"nitro-stickie nitro-stickie-image stickie-"+jO(n),children:[l("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[t("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:c&&l(V,{children:[t("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:u}),Ym.map(d=>t("div",{className:"stickie-color ms-1",onClick:h=>r(d),style:{backgroundColor:en.makeColorHex(d)}},d))]})}),t("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:u})]}),t("div",{className:"stickie-context",children:t("textarea",{className:"context-text",value:s,onChange:d=>a(d.target.value),tabIndex:0,autoFocus:!0})})]})})},zO=o=>{const{objectId:e=-1,height:n=0,maxHeight:r=40,onClose:s=null,updateHeight:a=null}=JN(),[c,u]=i.useState(""),d=h=>{u(h);const g=parseFloat(h);isNaN(g)||g===n||a(g)};return i.useEffect(()=>{u(n.toString())},[n]),e===-1?null:l(oe,{className:"nitro-widget-custom-stack-height",theme:"primary-slim",children:[t(ie,{headerText:m("widget.custom.stack.height.title"),onCloseClick:s}),l(re,{justifyContent:"between",children:[t(S,{children:m("widget.custom.stack.height.text")}),l(w,{gap:2,children:[t(Dt,{className:"nitro-slider",min:0,max:r,step:.01,value:n,onChange:h=>a(h),renderThumb:(h,g)=>t("div",{...h,children:g.valueNow})}),t("input",{className:"show-number-arrows",style:{width:50},type:"number",min:0,max:r,value:c,onChange:h=>d(h.target.value)})]}),l(T,{gap:1,children:[t(D,{onClick:h=>A(new Si(e,-100)),children:m("furniture.above.stack")}),t(D,{onClick:h=>A(new Si(e,0)),children:m("furniture.floor.level")})]})]})]})},$m=["9CCEFF","FF9CFF","9CFF9C","FFFF33"],YO=["blue","pink","green","yellow"],$O=["post_it","post_it_shakesp","post_it_dreams","post_it_xmas","post_it_vd","post_it_juninas"],KO=["post_it","shakesp","dreams","christmas","heart","juninas"],XO=o=>{let e=$m.indexOf(o);return e===-1&&(e=0),YO[e]},QO=o=>{let e=$O.indexOf(o);return e===-1&&(e=0),KO[e]},JO=o=>{const{objectId:e=-1,color:n="0",text:r="",type:s="",canModify:a=!1,updateColor:c=null,updateText:u=null,trash:d=null,onClose:h=null}=eT(),[g,f]=i.useState(!1);return i.useEffect(()=>{f(!1)},[e,n,r,s]),e===-1?null:t(Ar,{handleSelector:".drag-handler",windowPosition:Rt.TOP_LEFT,children:l("div",{className:"nitro-stickie nitro-stickie-image stickie-"+(s=="post_it"?XO(n):QO(s)),children:[l("div",{className:"d-flex align-items-center stickie-header drag-handler",children:[t("div",{className:"d-flex align-items-center flex-grow-1 h-100",children:a&&l(V,{children:[t("div",{className:"nitro-stickie-image stickie-trash header-trash",onClick:d}),s=="post_it"&&t(V,{children:$m.map(p=>t("div",{className:"stickie-color ms-1",onClick:C=>c(p),style:{backgroundColor:en.makeColorHex(p)}},p))})]})}),t("div",{className:"d-flex align-items-center nitro-stickie-image stickie-close header-close",onClick:h})]}),t("div",{className:"stickie-context",children:!g||!a?t("div",{className:"context-text",onClick:p=>a&&f(!0),children:r}):t("textarea",{className:"context-text",defaultValue:r,tabIndex:0,onBlur:p=>u(p.target.value),autoFocus:!0})})]})})},ZO=o=>{const{objectId:e=-1,color:n="1",senderName:r="",date:s="",message:a="",onClose:c=null}=nT();return e===-1?null:t(Xd,{color:n,message:a,date:s,senderName:r,onCloseClick:c})},ek=o=>{const[e,n]=i.useState(null),{objectId:r=-1,videoId:s=null,videoStart:a=0,videoEnd:c=0,currentVideoState:u=null,selectedVideo:d=null,playlists:h=[],onClose:g=null,previous:f=null,next:p=null,pause:C=null,play:E=null,selectVideo:_=null}=lT(),I=N=>{if(n(N.target),r!==-1)switch(N.target.getPlayerState()){case-1:case 1:u!==1&&E();return;case 2:u!==2&&C()}};if(i.useEffect(()=>{if(!(u===null||!e)){if(u===An.PLAYING&&e.getPlayerState()!==An.PLAYING){e.playVideo();return}if(u===An.PAUSED&&e.getPlayerState()!==An.PAUSED){e.pauseVideo();return}}},[u,e]),r===-1)return null;const b={height:"375",width:"500",playerVars:{autoplay:1,disablekb:1,controls:0,origin:window.origin,modestbranding:1,start:a,end:c}};return l(oe,{className:"youtube-tv-widget",children:[t(ie,{headerText:m("catalog.page.youtube_tvs"),onCloseClick:g}),t(re,{children:l("div",{className:"row w-100 h-100",children:[l("div",{className:"youtube-video-container col-9 overflow-hidden",children:[s&&s.length>0&&t(bg,{videoId:s,opts:b,onReady:N=>n(N.target),onStateChange:I,containerClassName:"youtubeContainer"}),(!s||s.length===0)&&t("div",{className:"empty-video w-100 h-100 justify-content-center align-items-center d-flex",children:m("widget.furni.video_viewer.no_videos")})]}),l("div",{className:"playlist-container col-3 d-flex flex-column",children:[l("span",{className:"playlist-controls justify-content-center d-flex",children:[t("i",{className:"icon icon-youtube-prev cursor-pointer",onClick:f}),t("i",{className:"icon icon-youtube-next cursor-pointer",onClick:p})]}),t("div",{className:"mb-1",children:m("widget.furni.video_viewer.playlists")}),t(ke,{columnCount:1,columnMinWidth:80,columnMinHeight:100,className:"mb-1",overflow:"auto",children:h&&h.map((N,v)=>t(Ie,{onClick:O=>_(N.video),itemActive:N.video===d,children:t("b",{children:N.title})},v))})]})]})})]})},tk=o=>{const{diskInventory:e=null,addToPlaylist:n=null}=o,[r,s]=i.useState(-1),[a,c]=i.useState(-1),u=i.useCallback((g,f)=>{g.stopPropagation(),c(p=>p===f?-1:f)},[]),d=i.useCallback((g,f)=>{var p,C;g.stopPropagation(),n(f,(C=(p=_e().soundManager.musicController)==null?void 0:p.getRoomItemPlaylist())==null?void 0:C.length)},[n]),h=()=>{ee("catalog/open/"+mt.TRAX_SONGS)};return i.useEffect(()=>{var g;if(a!==-1)return(g=_e().soundManager.musicController)==null||g.playSong(a,Us.PRIORITY_SONG_PLAY,0,0,0,0),()=>{var f;(f=_e().soundManager.musicController)==null||f.stop(Us.PRIORITY_SONG_PLAY)}},[a]),i.useEffect(()=>()=>c(-1),[]),l(V,{children:[l("div",{className:"bg-success py-3 container-fluid justify-content-center d-flex rounded",children:[t("img",{src:K("image.library.url")+"playlist/title_mymusic.gif",className:"my-music"}),t("h2",{className:"ms-4",children:m("playlist.editor.my.music")})]}),t("div",{className:"h-100 overflow-y-scroll mt-4 py-2",children:t(ke,{columnCount:3,columnMinWidth:95,gap:1,children:e&&e.getKeys().map((g,f)=>{var _;const p=e.getKey(f),C=e.getWithIndex(f),E=(_=_e().soundManager.musicController)==null?void 0:_.getSongInfo(C);return l(Ie,{itemActive:r===f,onClick:()=>s(I=>I===f?-1:f),classNames:["text-black"],children:[t("div",{className:"disk-image flex-shrink-0 mb-n2",style:{backgroundColor:Vd(E==null?void 0:E.songData)}}),t(S,{truncate:!0,fullWidth:!0,className:"text-center",children:E==null?void 0:E.name}),r===f&&l(w,{position:"absolute",className:"bottom-0 mb-1 bg-secondary p-1 rounded",alignItems:"center",justifyContent:"center",gap:2,children:[t(D,{onClick:I=>u(I,C),variant:"light",children:t(P,{className:a===C?"pause-btn":"preview-song"})}),t(D,{onClick:I=>d(I,p),variant:"light",children:t(P,{className:"move-disk"})})]})]},f)})})}),l("div",{className:"playlist-bottom text-black p-1",children:[t("h5",{children:m("playlist.editor.text.get.more.music")}),t("div",{children:m("playlist.editor.text.you.have.no.songdisks.available")}),t("div",{children:m("playlist.editor.text.you.can.buy.some.from.the.catalogue")}),t("button",{className:"btn btn-primary btn-sm",onClick:()=>h(),children:m("playlist.editor.button.open.catalogue")})]}),t("img",{src:K("image.library.url")+"playlist/background_get_more_music.gif",className:"get-more"})]})},nk=o=>{var g,f;const{furniId:e=-1,playlist:n=null,currentPlayingIndex:r=-1,removeFromPlaylist:s=null,togglePlayPause:a=null}=o,[c,u]=i.useState(-1),d=p=>{c===p&&s(p)},h=(p,C)=>{a(p,C!==-1?C:0)};return l(V,{children:[l("div",{className:"bg-primary py-3 container-fluid justify-content-center d-flex rounded",children:[t("img",{src:K("image.library.url")+"playlist/title_playlist.gif",className:"playlist-img"}),t("h2",{className:"ms-4",children:m("playlist.editor.playlist")})]}),t("div",{className:"h-100 overflow-y-scroll py-2",children:t(w,{column:!0,gap:2,children:n&&n.map((p,C)=>l(w,{gap:1,className:"text-black cursor-pointer "+(c===C?"border border-muted border-2 rounded":"border-2"),alignItems:"center",onClick:()=>u(E=>E===C?-1:C),children:[t(P,{onClick:()=>d(C),className:"disk-2 "+(c===C?"selected-song":""),style:{backgroundColor:c===C?"":Vd(p.songData)}}),p.name]},C))})}),(!n||n.length===0)&&l(V,{children:[l("div",{className:"playlist-bottom text-black p-1 ms-5",children:[t("h5",{children:m("playlist.editor.add.songs.to.your.playlist")}),t("div",{children:m("playlist.editor.text.click.song.to.choose.click.again.to.move")})]}),t("img",{src:K("image.library.url")+"playlist/background_add_songs.gif",className:"add-songs"})]}),n&&n.length>0&&l(V,{children:[r===-1&&t(D,{variant:"success",size:"lg",onClick:()=>h(e,c),children:m("playlist.editor.button.play.now")}),r!==-1&&l(w,{gap:1,children:[t(D,{variant:"danger",onClick:()=>h(e,c),children:t(P,{className:"pause-song"})}),l(w,{column:!0,children:[t(S,{bold:!0,display:"block",children:m("playlist.editor.text.now.playing.in.your.room")}),t(S,{children:((g=n[r])==null?void 0:g.name)+" - "+((f=n[r])==null?void 0:f.creator)})]})]})]})]})},rk=o=>{const{objectId:e=-1,currentPlayingIndex:n=-1,playlist:r=null,diskInventory:s=null,onClose:a=null,togglePlayPause:c=null,removeFromPlaylist:u=null,addToPlaylist:d=null}=VN();return e===-1?null:l(oe,{className:"nitro-playlist-editor-widget",theme:"primary-slim",children:[t(ie,{headerText:m("playlist.editor.title"),onCloseClick:a}),t(re,{children:l("div",{className:"d-flex flex-row gap-1 h-100",children:[t("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:t(tk,{addToPlaylist:d,diskInventory:s})}),t("div",{className:"w-50 position-relative overflow-hidden h-100 rounded d-flex flex-column",children:t(nk,{furniId:e,removeFromPlaylist:u,playlist:r,togglePlayPause:c,currentPlayingIndex:n})})]})})]})},sk=o=>l(P,{fit:!0,position:"absolute",className:"nitro-room-widgets top-0 start-0",children:[t(OO,{}),t(kO,{}),t(AO,{}),t(PO,{}),t(DO,{}),t(LO,{}),t(UO,{}),t(xO,{}),t(FO,{}),t(BO,{}),t(VO,{}),t(rk,{}),t(HO,{}),t(qO,{}),t(zO,{}),t(JO,{}),t(ZO,{}),t(yO,{}),t(ek,{})]}),ak=o=>{const{isVisible:e=!1,errorResult:n=null,petName:r=null,objectType:s=null,onChangePetName:a=null,onConfirm:c=null,onClose:u=null}=vT();return t(V,{children:e&&l(oe,{className:"nitro-pet-package no-resize",theme:"primary-slim",children:[t(ie,{center:!0,headerText:m(s==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage.open"),onCloseClick:()=>u()}),l(re,{children:[l(w,{className:"pet-package-container-top p-3",children:[t("div",{className:`package-image-${s} flex-shrink-0`}),t("div",{className:"m-2",children:t(S,{variant:"white",className:"package-text-big",children:m(s==="gnome_box"?"widgets.gnomepackage.name.title":"furni.petpackage")})})]}),t(w,{className:"pet-package-container-bottom p-2",children:l(T,{gap:1,children:[l(w,{alignItems:"center",className:"bg-white rounded py-1 px-2 input-pet-package-container",children:[t("input",{type:"text",className:"form-control form-control-sm input-pet-package",maxLength:K("pet.package.name.max.length"),placeholder:m(s==="gnome_box"?"widgets.gnomepackage.name.select":"widgets.petpackage.name.title"),value:r,onChange:d=>a(d.target.value)}),t("div",{className:"package-pencil-image flex-shrink-0 small fa-icon"})]}),n.length>0&&t(P,{className:"invalid-feedback d-block m-0",children:n}),l(w,{className:"mt-2",gap:5,display:"flex",justifyContent:"center",alignItems:"center",children:[t(S,{pointer:!0,className:"text-decoration",onClick:()=>u(),children:m("cancel")}),t(wu,{variant:r.length<3?"danger":"success",disabled:r.length<3,onClick:()=>c(),children:m(s==="gnome_box"?"widgets.gnomepackage.name.pick":"furni.petpackage.confirm")})]})]})})]})]})})},ok=o=>{const[e,n]=i.useState("bobba"),[r,s]=i.useState(""),[a,c]=i.useState(!1),{wordsFilter:u=[],isVisible:d=null,setWordsFilter:h,onClose:g=null}=CT(),{navigatorData:f=null}=xn(),p=_=>{(a?!r:!e)||(A(new D_(f.enteredGuestRoom.roomId,_,a?r:e)),s(""),n("bobba"),c(!1),!(_&&u.includes(a?r:e))&&h(I=>{const b=[...I];return _?b.push(a?r:e):b.splice(b.indexOf(a?r:e),1),b}))},C=_=>{n(_),c(!1)},E=_=>{s(_),c(!0)};return d?l(oe,{className:"nitro-guide-tool no-resize",theme:"primary-slim",children:[t(ie,{headerText:m("navigator.roomsettings.roomfilter"),onCloseClick:()=>g()}),l(re,{className:"text-black",children:[l(se,{className:"d-flex align-items-center justify-content-end gap-2",children:[t("input",{type:"text",className:"form-control form-control-sm",maxLength:255,value:e,onChange:_=>C(_.target.value)}),t(D,{onClick:()=>p(!0),children:m("navigator.roomsettings.roomfilter.addword")})]}),t(T,{overflow:"auto",gap:0,className:"form-control form-control-sm",style:{height:"100px"},children:u&&u.length>0&&u.map((_,I)=>t(w,{alignItems:"center",className:Gt("rounded p-1",r===_&&"bg-muted"),pointer:!0,onClick:b=>E(_),children:t(S,{truncate:!0,children:_})},I))}),t(se,{className:"d-flex align-items-center justify-content-end gap-2",children:t(D,{variant:"danger",onClick:()=>p(!1),disabled:u.length===0||!a,children:m("navigator.roomsettings.roomfilter.removeword")})})]})]}):null},ik=o=>{const[e,n]=i.useState(!1),{roomSession:r=null}=xe();lt([Gn.SHOW_THUMBNAIL,Gn.HIDE_THUMBNAIL,Gn.TOGGLE_THUMBNAIL],a=>{switch(a.type){case Gn.SHOW_THUMBNAIL:n(!0);return;case Gn.HIDE_THUMBNAIL:n(!1);return;case Gn.TOGGLE_THUMBNAIL:n(c=>!c);return}});const s=a=>{$().saveTextureAsScreenshot(a,!0),n(!1)};return e?t(NS,{roomId:r.roomId,textureReceiver:s,onClose:()=>n(!1)}):null},lk=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(null),[a,c]=i.useState(null),[u,d]=i.useState(null),[h,g]=i.useState(!1),{navigatorData:f=null}=xn(),{roomSession:p=null}=xe(),C=(E,_)=>{switch(E){case"settings":ee("navigator/toggle-room-info");return;case"zoom":n(I=>{let b=$().getRoomInstanceRenderingCanvasScale(p.roomId,1);return I?b*=2:b/=2,$().setRoomInstanceRenderingCanvasScale(p.roomId,1,b),!I});return;case"chat_history":ee("chat-history/toggle");return;case"like_room":A(new M_(1));return;case"toggle_room_link":ee("navigator/toggle-room-link");return;case"navigator_search_tag":ee(`navigator/search/${_}`),A(new Es("hotel_view",`tag:${_}`));return}};return F(ws,E=>{const _=E.getParser();!_.roomEnter||_.data.roomId!==p.roomId||(r!==_.data.roomName&&s(_.data.roomName),a!==_.data.ownerName&&c(_.data.ownerName),u!==_.data.tags&&d(_.data.tags))}),i.useEffect(()=>{g(!0);const E=setTimeout(()=>g(!1),5e3);return()=>clearTimeout(E)},[r,a,u]),l(w,{className:"nitro-room-tools-container",gap:2,children:[l(T,{center:!0,className:"nitro-room-tools p-2",children:[t(P,{pointer:!0,title:m("room.settings.button.text"),className:"icon icon-cog",onClick:()=>C("settings")}),t(P,{pointer:!0,title:m("room.zoom.button.text"),onClick:()=>C("zoom"),className:Gt("icon",!e&&"icon-zoom-less",e&&"icon-zoom-more")}),t(P,{pointer:!0,title:m("room.chathistory.button.text"),onClick:()=>C("chat_history"),className:"icon icon-chat-history"}),f.canRate&&t(P,{pointer:!0,title:m("room.like.button.text"),onClick:()=>C("like_room"),className:"icon icon-like-room"})]}),t(T,{justifyContent:"center",children:t(Rs,{type:bt.SLIDE_LEFT,inProp:h,timeout:300,children:t(T,{center:!0,children:l(T,{className:"nitro-room-tools-info rounded py-2 px-3",children:[l(T,{gap:1,children:[t(S,{wrap:!0,variant:"white",fontSize:4,children:r}),t(S,{variant:"muted",fontSize:5,children:a})]}),u&&u.length>0&&t(w,{gap:2,children:u.map((E,_)=>l(S,{small:!0,pointer:!0,variant:"white",className:"rounded bg-primary p-1",onClick:()=>C("navigator_search_tag",E),children:["#",E]},_))})]})})})})]})},ck=o=>{const{question:e=null,canVote:n=null,vote:r=null,noVotes:s=null,yesVotes:a=null}=o;return l(T,{gap:2,className:"wordquiz-question p-2",children:[!n&&l(w,{fullWidth:!0,alignItems:"center",gap:2,children:[t(w,{center:!0,pointer:!0,className:"bg-danger rounded p-2",children:t(S,{variant:"white",children:s})}),t(S,{variant:"white",center:!0,textBreak:!0,children:e}),t(w,{center:!0,pointer:!0,className:"bg-success rounded p-2",children:t(S,{variant:"white",children:a})})]}),n&&l(T,{children:[t(S,{variant:"white",center:!0,textBreak:!0,children:e}),l(w,{fullWidth:!0,justifyContent:"center",gap:1,children:[t(w,{center:!0,pointer:!0,className:"bg-danger rounded p-1",onClick:c=>r(to),children:t(P,{className:"word-quiz-dislike"})}),t(w,{center:!0,pointer:!0,className:"bg-success rounded p-1",onClick:c=>r(Hd),children:t(P,{className:"word-quiz-like"})})]})]})]})},uk=o=>{const{userIndex:e=null,vote:n=null,...r}=o;return t(Cl,{objectId:e,category:Q.UNIT,...r,children:t(w,{center:!0,pointer:!0,className:`bg-${n===to?"danger":"success"} rounded p-1`,children:t(P,{className:`word-quiz-${n===to?"dislike":"like"}-sm`})})})},dk=o=>{const{question:e=null,answerSent:n=!1,answerCounts:r=null,userAnswers:s=null,vote:a=null}=PT();return l(V,{children:[e&&t(ck,{question:e.content,canVote:!n,vote:a,noVotes:r.get(to)||0,yesVotes:r.get(Hd)||0}),s&&Array.from(s.entries()).map(([c,u],d)=>t(uk,{userIndex:c,vote:u.value},d))]})},mk=o=>{const{roomSession:e=null}=xe(),{simpleAlert:n=null}=Je();return Te(Ni.ROOM_ZOOM,r=>$().setRoomInstanceRenderingCanvasScale(r.roomId,1,r.level,null,null,!1,r.asDelta)),Te([ve.REQUEST_TEASER,ve.REQUEST_ECOTRONBOX,ve.REQUEST_CLOTHING_CHANGE,ve.REQUEST_PLAYLIST_EDITOR,ve.OPEN_WIDGET,ve.CLOSE_WIDGET,Ea.FURNI_CLICK,Ea.FURNI_DOUBLE_CLICK,Ea.TOOLTIP_SHOW,Ea.TOOLTIP_HIDE],r=>{if(e)switch(r.objectId,r.category,r.type){}}),Ye([ht.RSEME_KICKED,ht.RSEME_PETS_FORBIDDEN_IN_HOTEL,ht.RSEME_PETS_FORBIDDEN_IN_FLAT,ht.RSEME_MAX_PETS,ht.RSEME_MAX_NUMBER_OF_OWN_PETS,ht.RSEME_NO_FREE_TILES_FOR_PET,ht.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET,ht.RSEME_BOTS_FORBIDDEN_IN_HOTEL,ht.RSEME_BOTS_FORBIDDEN_IN_FLAT,ht.RSEME_BOT_LIMIT_REACHED,ht.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT,ht.RSEME_BOT_NAME_NOT_ACCEPTED],r=>{let s=m("error.title"),a="";switch(r.type){case ht.RSEME_MAX_PETS:a=m("room.error.max_pets");break;case ht.RSEME_MAX_NUMBER_OF_OWN_PETS:a=m("room.error.max_own_pets");break;case ht.RSEME_KICKED:a=m("room.error.kicked"),s=m("generic.alert.title");break;case ht.RSEME_PETS_FORBIDDEN_IN_HOTEL:a=m("room.error.pets.forbidden_in_hotel");break;case ht.RSEME_PETS_FORBIDDEN_IN_FLAT:a=m("room.error.pets.forbidden_in_flat");break;case ht.RSEME_NO_FREE_TILES_FOR_PET:a=m("room.error.pets.no_free_tiles");break;case ht.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET:a=m("room.error.pets.selected_tile_not_free");break;case ht.RSEME_BOTS_FORBIDDEN_IN_HOTEL:a=m("room.error.bots.forbidden_in_hotel");break;case ht.RSEME_BOTS_FORBIDDEN_IN_FLAT:a=m("room.error.bots.forbidden_in_flat");break;case ht.RSEME_BOT_LIMIT_REACHED:a=m("room.error.max_bots");break;case ht.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT:a=m("room.error.bots.selected_tile_not_free");break;case ht.RSEME_BOT_NAME_NOT_ACCEPTED:a=m("room.error.bots.name.not.accepted");break;default:return}n(a,ue.DEFAULT,null,null,s)}),l(V,{children:[t(tO,{}),t(cO,{}),t(aO,{}),t(IO,{}),t(sk,{}),t(lk,{}),t(ok,{}),t(ik,{}),t(uO,{}),t(ak,{}),t(dO,{}),t(dk,{}),t(CO,{}),t(pO,{})]})},gk=o=>{const{roomSession:e=null}=xe(),n=i.useRef();return i.useEffect(()=>{const r=_e().application.renderer.view;if(!r)return;r.onclick=a=>Sa(a),r.onmousemove=a=>Sa(a),r.onmousedown=a=>Sa(a),r.onmouseup=a=>Sa(a),r.ontouchstart=a=>va(a),r.ontouchmove=a=>va(a),r.ontouchend=a=>va(a),r.ontouchcancel=a=>va(a);const s=n.current;s&&s.appendChild(r)},[]),t(P,{fit:!0,innerRef:n,className:!e&&"d-none",children:e&&l(V,{children:[t(mk,{}),e.isSpectator&&t(Ay,{})]})})},hk=o=>{const{useGuideTool:e=!1,unseenAchievementCount:n=0,setMeExpanded:r=null,children:s=null,...a}=o,c=i.useRef();return i.useEffect(()=>{const u=Oe();u&&$().selectRoomObject(u.roomId,u.ownRoomIndex,Q.UNIT)},[]),i.useEffect(()=>{const u=d=>r(!1);return document.addEventListener("click",u),()=>document.removeEventListener(Re.MOUSE_CLICK,u)},[r]),l(w,{innerRef:c,alignItems:"center",className:"nitro-toolbar-me p-2",gap:2,children:[K("guides.enabled")&&e&&t(P,{pointer:!0,className:"navigation-item icon icon-me-helper-tool",onClick:u=>St(new Vt(Vt.TOGGLE_GUIDE_TOOL))}),t(P,{pointer:!0,className:"navigation-item icon icon-me-achievements",onClick:u=>ee("achievements/toggle"),children:n>0&&t(wr,{count:n})}),t(P,{pointer:!0,className:"navigation-item icon icon-me-profile",onClick:u=>tn(q().userId)}),t(P,{pointer:!0,className:"navigation-item icon icon-me-rooms",onClick:u=>ee("navigator/search/myworld_view")}),t(P,{pointer:!0,className:"navigation-item icon icon-me-clothing",onClick:u=>ee("avatar-editor/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-me-settings",onClick:u=>ee("user-settings/toggle")}),s]})},fk=o=>{const{isInRoom:e}=o,[n,r]=i.useState(!1),[s,a]=i.useState(!1),{userFigure:c=null}=Yn(),{getFullCount:u=0}=Sn(),{getTotalUnseen:d=0}=bo(),{requests:h=[]}=fn(),{iconState:g=qn.HIDDEN}=hm(),f=q().isModerator;return F(Zu,p=>{const C=p.getParser();a(C.isAllowed(Ju.USE_GUIDE_TOOL))}),Te(L_.ANIMATE_ICON,p=>{((E,_,I,b)=>{const N=document.body.getElementsByClassName(E)[0];if(!N)return;_.className="toolbar-icon-animation",_.style.visibility="visible",_.style.left=I+"px",_.style.top=b+"px",document.body.append(_);const v=N.getBoundingClientRect(),O=_.getBoundingClientRect(),R=O.x-v.x,y=O.y-v.y,G=Math.sqrt(R*R+y*y),k=500-Math.abs(1/G*100*500*.5),B=20,M=`ToolbarBouncing[${E}]`;qo.getMotionByTag(M)||(qo.runMotion(new Wl(new U_(k+8),new x_(N,400,12))).tag=M);const U=new Wl(new F_(new B_(_,k,v.x-O.x+B,v.y-O.y,100,1),1),new G_(_));qo.runMotion(U)})("icon-inventory",p.image,p.x,p.y)}),l(V,{children:[t(Rs,{type:bt.FADE_IN,inProp:n,timeout:300,children:t(hk,{useGuideTool:s,unseenAchievementCount:d,setMeExpanded:r})}),l(w,{alignItems:"center",justifyContent:"between",gap:2,className:"nitro-toolbar py-1 px-3",children:[l(w,{gap:2,alignItems:"center",children:[l(w,{alignItems:"center",gap:2,children:[l(w,{center:!0,pointer:!0,className:"navigation-item item-avatar "+(n?"active ":""),onClick:p=>r(!n),children:[t(ot,{figure:c,direction:2,position:"absolute"}),d>0&&t(wr,{count:d})]}),e&&t(P,{pointer:!0,className:"navigation-item icon icon-habbo",onClick:p=>Qi()}),!e&&t(P,{pointer:!0,className:"navigation-item icon icon-house",onClick:p=>ee("navigator/goto/home")}),t(P,{pointer:!0,className:"navigation-item icon icon-rooms",onClick:p=>ee("navigator/toggle")}),K("game.center.enabled")&&t(P,{pointer:!0,className:"navigation-item icon icon-game",onClick:p=>ee("games/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-catalog",onClick:p=>ee("catalog/toggle")}),t(P,{pointer:!0,className:"navigation-item icon icon-inventory",onClick:p=>ee("inventory/toggle"),children:u>0&&t(wr,{count:u})}),e&&t(P,{pointer:!0,className:"navigation-item icon icon-camera",onClick:p=>ee("camera/toggle")}),f&&t(P,{pointer:!0,className:"navigation-item icon icon-modtools",onClick:p=>ee("mod-tools/toggle")})]}),t(w,{alignItems:"center",id:"toolbar-chat-input-container"})]}),l(w,{alignItems:"center",gap:2,children:[l(w,{gap:2,children:[t(P,{pointer:!0,className:"navigation-item icon icon-friendall",onClick:p=>ee("friends/toggle"),children:h.length>0&&t(wr,{count:h.length})}),(g===qn.SHOW||g===qn.UNREAD)&&t(P,{pointer:!0,className:`navigation-item icon icon-message ${g===qn.UNREAD&&"is-unseen"}`,onClick:p=>fo()})]}),t(P,{id:"toolbar-friend-bar-container",className:"d-none d-lg-block"})]})]})]})},pk=o=>{const{badges:e=null,gap:n=1,justifyContent:r="between",...s}=o;return t(V,{children:e&&e.length>0&&e.map((a,c)=>t(T,{center:!0,children:t(qe,{badgeCode:a},a)},a))})},Ik=o=>{const{relationships:e=null}=o,n=({type:r})=>{const s=e&&e.relationshipStatusMap.hasKey(r)?e.relationshipStatusMap.getValue(r):null,a=Bn.RELATIONSHIP_NAMES[r].toLocaleLowerCase();return l(w,{fullWidth:!0,gap:1,children:[t(w,{center:!0,className:"user-relationship",children:t("i",{className:`nitro-friends-spritesheet icon-${a}`})}),l(T,{grow:!0,gap:0,children:[l(w,{alignItems:"center",justifyContent:"between",className:"bg-white rounded px-2 py-1 user-relationship",children:[l(S,{small:!0,underline:!0,pointer:!0,onClick:c=>s&&s.randomFriendId>=1&&tn(s.randomFriendId),children:[(!s||s.friendCount===0)&&m("extendedprofile.add.friends"),s&&s.friendCount>=1&&s.randomFriendName]}),s&&s.friendCount>=1&&t(w,{center:!0,position:"relative",className:"avatar-image-container",children:t(ot,{figure:s.randomFriendFigure,headOnly:!0,direction:4})})]}),l(S,{small:!0,italics:!0,className:"user-relationship-count",children:[(!s||s.friendCount===0)&&m("extendedprofile.no.friends.in.this.category"),s&&s.friendCount>1&&m(`extendedprofile.relstatus.others.${a}`,["count"],[(s.friendCount-1).toString()]),""]})]})]})};return l(V,{children:[t(n,{type:Bn.HEART}),t(n,{type:Bn.SMILE}),t(n,{type:Bn.BOBBA})]})},Ek=o=>{const{relationships:e=null,friendsCount:n=null}=o;return l(T,{gap:1,children:[l(S,{small:!0,children:[t("b",{children:m("extendedprofile.friends.count")})," ",n]}),t(S,{bold:!0,small:!0,children:m("extendedprofile.relstatus")}),t(T,{children:t(Ik,{relationships:e})})]})},Ck=o=>{const{itsMe:e=null,groups:n=null,onLeaveGroup:r=null,overflow:s="hidden",gap:a=2,...c}=o,[u,d]=i.useState(null),[h,g]=i.useState(null);return F(ta,f=>{const p=f.getParser();!u||u!==p.id||p.flag||g(p)}),i.useEffect(()=>{u&&A(new Ws(u,!1))},[u]),i.useEffect(()=>{g(null),n.length>0&&d(f=>(f===n[0].groupId&&A(new Ws(n[0].groupId,!1)),n[0].groupId))},[n]),!n||!n.length?t(T,{center:!0,fullHeight:!0,children:l(w,{justifyContent:"center",gap:2,children:[t(P,{className:"no-group-spritesheet image-1"}),t(P,{className:"no-group-spritesheet image-2"}),t(P,{className:"no-group-spritesheet image-3"})]})}):l(se,{overflow:s,gap:2,...c,children:[t(T,{alignItems:"center",size:2,overflow:"auto",children:t(ke,{overflow:null,columnCount:1,columnMinHeight:50,className:"user-groups-container",children:n.map((f,p)=>l(Ie,{overflow:"unset",itemActive:u===f.groupId,onClick:()=>d(f.groupId),className:"p-1",children:[e&&t("i",{className:"position-absolute end-0 top-0 z-index-1 icon icon-group-"+(f.favourite?"favorite":"not-favorite"),onClick:()=>zb(f)}),t(qe,{badgeCode:f.badgeCode,isGroup:!0})]},p))})}),t(T,{size:10,overflow:"hidden",children:h&&t(Fm,{groupInformation:h,onClose:r})})]})},_k=o=>{const{userProfile:e=null}=o,[n,r]=i.useState(e.requestSent),s=e.id===q().userId,a=!n&&!s&&!e.isMyFriend&&!e.requestSent,c=()=>{r(!0),A(new Uu(e.username))};i.useEffect(()=>{r(e.requestSent)},[e]);const[u,d]=i.useState("default"),[h,g]=i.useState([]),{sendMessage:f,lastMessage:p,readyState:C}=Kr(K("external.websocket"),{share:!0});return i.useEffect(()=>{if(p!==null){var E=JSON.parse(p.data);E.header==="updateBannerResponse"&&E.data!==null&&e.id==E.data.userId&&d(E.data.bannerName),E.header==="getBannerByUserIdResponse"&&E.data!==null&&e.id==E.data.userId&&d(E.data.bannerName)}},[p,g]),i.useEffect(()=>{e!==null&&f(JSON.stringify(new jm(e.id)))},[]),l(w,{gap:2,children:[t(T,{center:!0,className:"avatar-container",style:{backgroundImage:`url(${K("banners.url")}/${u}.png)`,backgroundRepeat:"no-repeat"},children:t(ot,{figure:e.figure,direction:2})}),l(T,{children:[l(T,{gap:0,children:[t(S,{bold:!0,children:e.username}),l(S,{italics:!0,textBreak:!0,small:!0,children:[e.motto,""]})]}),l(T,{gap:1,children:[l(S,{small:!0,children:[t("b",{children:m("extendedprofile.created")})," ",e.registration]}),l(S,{small:!0,children:[t("b",{children:m("extendedprofile.last.login")})," ",jn.format(e.secondsSinceLastVisit,".ago",2)]}),l(S,{small:!0,children:[t("b",{children:m("extendedprofile.achievementscore")})," ",e.achievementPoints]})]}),l(w,{gap:1,children:[e.isOnline&&t("i",{className:"icon icon-pf-online"}),!e.isOnline&&t("i",{className:"icon icon-pf-offline"}),l(w,{alignItems:"center",gap:1,children:[a&&t(S,{small:!0,underline:!0,pointer:!0,onClick:c,children:m("extendedprofile.addasafriend")}),!a&&l(V,{children:[t("i",{className:"icon icon-pf-tick"}),s&&t(S,{children:m("extendedprofile.me")}),e.isMyFriend&&t(S,{children:m("extendedprofile.friend")}),(n||e.requestSent)&&t(S,{children:m("extendedprofile.friendrequestsent")})]})]})]})]})]})},bk=o=>{const[e,n]=i.useState(null),[r,s]=i.useState([]),[a,c]=i.useState(null),u=()=>{n(null),s([]),c(null)},d=()=>{!e||e.id!==q().userId||tn(e.id)};return F(V_,h=>{const g=h.getParser();!e||g.userId!==e.id||s(g.badges)}),F(od,h=>{const g=h.getParser();!e||g.userId!==e.id||c(g)}),F(W_,h=>{const g=h.getParser();let f=!1;n(p=>(p&&p.id&&(f=p.id===g.id),g)),f||(s([]),c(null)),A(new H_(g.id)),A(new id(g.id))}),F(j_,h=>{const g=h.getParser();g.userId==(e==null?void 0:e.id)&&tn(g.userId)}),Te(It.SELECTED,h=>{if(!e||h.category!==Q.UNIT)return;const g=Oe().userDataManager.getUserDataByIndex(h.objectId);g.type===pt.USER&&tn(g.webID)}),e?l(oe,{uniqueKey:"nitro-user-profile",theme:"primary-slim",className:"user-profile",children:[t(ie,{headerText:m("extendedprofile.caption"),onCloseClick:u}),l(re,{overflow:"hidden",children:[l(se,{fullHeight:!1,gap:2,children:[l(T,{size:7,gap:1,className:"user-container pe-2",children:[t(_k,{userProfile:e}),t(se,{columnCount:5,fullHeight:!0,className:"bg-muted rounded px-2 py-1",children:t(pk,{fullWidth:!0,center:!0,badges:r})})]}),t(T,{size:5,children:a&&t(Ek,{relationships:a,friendsCount:e.friendsCount})})]}),t(w,{alignItems:"center",className:"rooms-button-container px-2 py-1",children:l(w,{alignItems:"center",gap:1,onClick:h=>ee(`navigator/search/hotel_view/owner:${e.username}`),children:[t("i",{className:"icon icon-rooms"}),t(S,{bold:!0,underline:!0,pointer:!0,children:m("extendedprofile.rooms")})]})}),t(Ck,{fullWidth:!0,itsMe:e.id===q().userId,groups:e.groups,onLeaveGroup:d})]})]}):null},Sk=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(null),[a,c]=mm(),[u,d]=gm(),h=(f,p)=>{let C=!0;const E=r.clone();switch(f){case"close_view":n(!1),C=!1;return;case"oldchat":E.oldChat=p,A(new Y_(E.oldChat));break;case"room_invites":E.roomInvites=p,A(new z_(E.roomInvites));break;case"camera_follow":E.cameraFollow=p,A(new q_(E.cameraFollow));break;case"system_volume":E.volumeSystem=p,E.volumeSystem=Math.max(0,E.volumeSystem),E.volumeSystem=Math.min(100,E.volumeSystem);break;case"furni_volume":E.volumeFurni=p,E.volumeFurni=Math.max(0,E.volumeFurni),E.volumeFurni=Math.min(100,E.volumeFurni);break;case"trax_volume":E.volumeTrax=p,E.volumeTrax=Math.max(0,E.volumeTrax),E.volumeTrax=Math.min(100,E.volumeTrax);break}C&&s(E),Ri(E)},g=f=>{switch(f){case"volume":A(new $_(Math.round(r.volumeSystem),Math.round(r.volumeFurni),Math.round(r.volumeTrax)));break}};return F(Yu,f=>{const p=f.getParser(),C=new K_;C.volumeSystem=p.volumeSystem,C.volumeFurni=p.volumeFurni,C.volumeTrax=p.volumeTrax,C.oldChat=p.oldChat,C.roomInvites=p.roomInvites,C.cameraFollow=p.cameraFollow,C.flags=p.flags,C.chatType=p.chatType,s(C),Ri(C)}),i.useEffect(()=>{const f={linkReceived:p=>{const C=p.split("/");if(!(C.length<2))switch(C[1]){case"show":n(!0);return;case"hide":n(!1);return;case"toggle":n(E=>!E);return}},eventUrlPrefix:"user-settings/"};return ut(f),()=>dt(f)},[]),i.useEffect(()=>{r&&St(r)},[r]),!e||!r?null:l(oe,{uniqueKey:"user-settings",className:"user-settings-window",theme:"primary-slim",children:[t(ie,{headerText:m("widget.memenu.settings.title"),onCloseClick:f=>h("close_view")}),l(re,{className:"text-black",children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.oldChat,onChange:f=>h("oldchat",f.target.checked)}),t(S,{children:m("memenu.settings.chat.prefer.old.chat")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.roomInvites,onChange:f=>h("room_invites",f.target.checked)}),t(S,{children:m("memenu.settings.other.ignore.room.invites")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:r.cameraFollow,onChange:f=>h("camera_follow",f.target.checked)}),t(S,{children:m("memenu.settings.other.disable.room.camera.follow")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:a,onChange:f=>c(f.target.checked)}),t(S,{children:m("memenu.settings.other.place.multiple.objects")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:u,onChange:f=>d(f.target.checked)}),t(S,{children:m("memenu.settings.other.skip.purchase.confirmation")})]})]}),l(T,{children:[t(S,{bold:!0,children:m("widget.memenu.settings.volume")}),l(T,{gap:1,children:[t(S,{children:m("widget.memenu.settings.volume.ui")}),l(w,{alignItems:"center",gap:1,children:[r.volumeSystem===0&&t(Po,{className:Gt(r.volumeSystem>=50&&"text-muted","fa-icon")}),r.volumeSystem>0&&t(Do,{className:Gt(r.volumeSystem>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeSystem",value:r.volumeSystem,onChange:f=>h("system_volume",f.target.value),onMouseUp:()=>g("volume")}),t(Mo,{className:Gt(r.volumeSystem<50&&"text-muted","fa-icon")})]})]}),l(T,{gap:1,children:[t(S,{children:m("widget.memenu.settings.volume.furni")}),l(w,{alignItems:"center",gap:1,children:[r.volumeFurni===0&&t(Po,{className:Gt(r.volumeFurni>=50&&"text-muted","fa-icon")}),r.volumeFurni>0&&t(Do,{className:Gt(r.volumeFurni>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeFurni",value:r.volumeFurni,onChange:f=>h("furni_volume",f.target.value),onMouseUp:()=>g("volume")}),t(Mo,{className:Gt(r.volumeFurni<50&&"text-muted","fa-icon")})]})]}),l(T,{gap:1,children:[t(S,{children:m("widget.memenu.settings.volume.trax")}),l(w,{alignItems:"center",gap:1,children:[r.volumeTrax===0&&t(Po,{className:Gt(r.volumeTrax>=50&&"text-muted","fa-icon")}),r.volumeTrax>0&&t(Do,{className:Gt(r.volumeTrax>=50&&"text-muted","fa-icon")}),t("input",{type:"range",className:"custom-range w-100",min:"0",max:"100",step:"1",id:"volumeTrax",value:r.volumeTrax,onChange:f=>h("trax_volume",f.target.value),onMouseUp:()=>g("volume")}),t(Mo,{className:Gt(r.volumeTrax<50&&"text-muted","fa-icon")})]})]})]})]})]})},Nk=o=>{const{trigger:e=null,furniIds:n=[]}=Se();return l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.pickfurnis.caption",["count","limit"],[n.length.toString(),e.maximumItemSelectionCount.toString()])}),t(S,{small:!0,children:m("wiredfurni.pickfurnis.desc")})]})},_l=o=>{const{wiredType:e="",requiresFurni:n=le.STUFF_SELECTION_OPTION_NONE,save:r=null,validate:s=null,children:a=null,hasSpecialInput:c=!1}=o,[u,d]=i.useState(null),[h,g]=i.useState(null),[f,p]=i.useState(!1),{trigger:C=null,setTrigger:E=null,setIntParams:_=null,setStringParam:I=null,setFurniIds:b=null,setAllowsFurni:N=null,saveWired:v=null}=Se(),O=()=>E(null),R=()=>{s&&!s()||(r&&r(),p(!0))};return i.useEffect(()=>{f&&(v(),p(!1))},[f,v]),i.useEffect(()=>{if(!C)return;const y=C.spriteId||-1,G=q().getFloorItemData(y);G?(d(G.name),g(G.description)):(d("NAME: "+y),g("NAME: "+y)),c&&(_(C.intData),I(C.stringData)),n>le.STUFF_SELECTION_OPTION_NONE&&b(k=>(k&&k.length&&Bs.clearSelectionShaderFromFurni(k),C.selectedItems&&C.selectedItems.length?(Bs.applySelectionShaderToFurni(C.selectedItems),C.selectedItems):[])),N(n)},[C,c,n,_,I,b,N]),l(oe,{uniqueKey:"nitro-wired",className:"nitro-wired",theme:"primary-slim",children:[t(ie,{headerText:m("wiredfurni.title"),onCloseClick:O}),l(re,{children:[l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("i",{className:`icon icon-wired-${e}`}),t(S,{bold:!0,children:u})]}),t(S,{small:!0,children:h})]}),!!a&&t("hr",{className:"m-0 bg-dark"}),a,n>le.STUFF_SELECTION_OPTION_NONE&&l(V,{children:[t("hr",{className:"m-0 bg-dark"}),t(Nk,{})]}),l(w,{alignItems:"center",gap:1,children:[t(D,{fullWidth:!0,variant:"success",onClick:R,children:m("wiredfurni.ready")}),t(D,{fullWidth:!0,variant:"secondary",onClick:O,children:m("cancel")})]})]})]})},gt=o=>{const{requiresFurni:e=le.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=o,{trigger:a=null,actionDelay:c=0,setActionDelay:u=null}=Se();return i.useEffect(()=>{u(a.delayInPulses)},[a,u]),l(_l,{wiredType:"action",requiresFurni:e,save:n,hasSpecialInput:r,children:[s,!!s&&t("hr",{className:"m-0 bg-dark"}),l(T,{children:[t(S,{bold:!0,children:m("wiredfurni.params.delay",["seconds"],[ca(c)])}),t(Dt,{className:"nitro-slider",min:0,max:20,value:c,onChange:d=>u(d)})]})]})},Tk="hd-180-1.ch-210-66.lg-270-82.sh-290-81",vk=o=>{const[e,n]=i.useState(""),[r,s]=i.useState(""),{trigger:a=null,setStringParam:c=null}=Se(),u=()=>c(e+Ts+r);return i.useEffect(()=>{const d=a.stringData.split(Ts);d.length>0&&n(d[0]),d.length>1&&s(d[1].length>0?d[1]:Tk)},[a]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:d=>n(d.target.value)})]}),l(w,{center:!0,children:[t(ot,{figure:r,direction:4}),t(D,{onClick:d=>s(q().figure),children:m("wiredfurni.params.capture.figure")})]})]})},wk=o=>{const[e,n]=i.useState(""),[r,s]=i.useState(-1),{trigger:a=null,setStringParam:c=null,setIntParams:u=null}=Se(),d=()=>{c(e),u([r])};return i.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:h=>n(h.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode1",checked:r===1,onChange:h=>s(1)}),t(S,{children:m("wiredfurni.params.start.following")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"followMode",id:"followMode2",checked:r===0,onChange:h=>s(0)}),t(S,{children:m("wiredfurni.params.stop.following")})]})]})]})},Rk=[2,5,7,8,9,10,27],yk=o=>{const[e,n]=i.useState(""),[r,s]=i.useState(-1),{trigger:a=null,setStringParam:c=null,setIntParams:u=null}=Se(),d=()=>{c(e),u([r])};return i.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:h=>n(h.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.handitem")}),l("select",{className:"form-select form-select-sm",value:r,onChange:h=>s(parseInt(h.target.value)),children:[t("option",{value:"0",children:"------"}),Rk.map(h=>t("option",{value:h,children:m(`handitem${h}`)},h))]})]})]})},Ok=o=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:s=null}=Se(),a=()=>s(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},kk=o=>{const[e,n]=i.useState(""),[r,s]=i.useState(""),[a,c]=i.useState(-1),{trigger:u=null,setStringParam:d=null,setIntParams:h=null}=Se(),g=()=>{d(e+Ts+r),h([a])};return i.useEffect(()=>{const f=u.stringData.split(Ts);f.length>0&&n(f[0]),f.length>1&&s(f[1].length>0?f[1]:""),c(u.intData.length>0?u.intData[0]:0)},[u]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:g,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:f=>n(f.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:K("wired.action.bot.talk.to.avatar.max.length",64),value:r,onChange:f=>s(f.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:a===0,onChange:f=>c(0)}),t(S,{children:m("wiredfurni.params.talk")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:a===1,onChange:f=>c(1)}),t(S,{children:m("wiredfurni.params.whisper")})]})]})]})},Ak=o=>{const[e,n]=i.useState(""),[r,s]=i.useState(""),[a,c]=i.useState(-1),{trigger:u=null,setStringParam:d=null,setIntParams:h=null}=Se(),g=()=>{d(e+Ts+r),h([a])};return i.useEffect(()=>{const f=u.stringData.split(Ts);f.length>0&&n(f[0]),f.length>1&&s(f[1].length>0?f[1]:""),c(u.intData.length>0?u.intData[0]:0)},[u]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:g,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:f=>n(f.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:K("wired.action.bot.talk.max.length",64),value:r,onChange:f=>s(f.target.value)})]}),l(T,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode1",checked:a===0,onChange:f=>c(0)}),t(S,{children:m("wiredfurni.params.talk")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"talkMode",id:"talkMode2",checked:a===1,onChange:f=>c(1)}),t(S,{children:m("wiredfurni.params.shout")})]})]})]})},Pk=o=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:s=null}=Se(),a=()=>s(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},Dk=o=>t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Mk=o=>t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),Lk=o=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:s=null}=Se(),a=()=>s(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value),maxLength:K("wired.action.chat.max.length",100)})]})})},Uk=o=>t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),xk=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(1),[a,c]=i.useState(!1),[u,d]=i.useState(1),[h,g]=i.useState(1),[f,p]=i.useState([]),{trigger:C=null,setIntParams:E=null,setStringParam:_=null}=Se(),I=()=>p(O=>[...O,{isBadge:!1,itemCode:"",probability:null}]),b=O=>{p(R=>{const y=Array.from(R);return y.splice(O,1),y})},N=(O,R,y,G)=>{const k=Array.from(f),B=k[O];B&&(B.isBadge=R,B.itemCode=y,B.probability=G,p(k))},v=()=>{let O=[];for(const R of f){if(!R.itemCode)continue;const y=[R.isBadge?"0":"1",R.itemCode,R.probability.toString()];O.push(y.join(","))}O.length>0&&(_(O.join(";")),E([r,a?1:0,u,h]))};return i.useEffect(()=>{const O=[];if(C.stringData.length>0&&C.stringData.includes(";")){const R=C.stringData.split(";");for(const y of R){const G=y.split(",");G.length===3&&O.push({isBadge:G[0]==="0",itemCode:G[1],probability:Number(G[2])})}}O.length===0&&O.push({isBadge:!1,itemCode:"",probability:null}),s(C.intData.length>0?C.intData[0]:0),c(C.intData.length>1?C.intData[1]===1:!1),d(C.intData.length>2?C.intData[2]:0),g(C.intData.length>3?C.intData[3]:0),n(C.intData.length>3?C.intData[3]>0:!1),p(O)},[C]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:v,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"limitEnabled",onChange:O=>n(O.target.checked)}),t(S,{children:m("wiredfurni.params.prizelimit",["amount"],[e?u.toString():""])})]}),!e&&t(S,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"Reward limit not set. Make sure rewards are badges or non-tradeable items."}),e&&t(Dt,{className:"nitro-slider",min:1,max:1e3,value:u,onChange:O=>d(O)}),t("hr",{className:"m-0 bg-dark"}),l(T,{gap:1,children:[t(S,{bold:!0,children:"How often can a user be rewarded?"}),l(w,{gap:1,children:[l("select",{className:"form-select form-select-sm w-100",value:r,onChange:O=>s(Number(O.target.value)),children:[t("option",{value:"0",children:"Once"}),l("option",{value:"3",children:["Once every ",h," minutes"]}),l("option",{value:"2",children:["Once every ",h," hours"]}),l("option",{value:"1",children:["Once every ",h," days"]})]}),r>0&&t("input",{type:"number",className:"form-control form-control-sm",value:h,onChange:O=>g(Number(O.target.value))})]})]}),t("hr",{className:"m-0 bg-dark"}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"uniqueRewards",checked:a,onChange:O=>c(O.target.checked)}),t(S,{children:"Unique rewards"})]}),t(S,{center:!0,small:!0,className:"bg-muted rounded p-1",children:"If checked each reward will be given once to each user. This will disable the probabilities option."}),t("hr",{className:"m-0 bg-dark"}),l(w,{justifyContent:"between",alignItems:"center",children:[t(S,{bold:!0,children:"Rewards"}),t(D,{variant:"success",onClick:I,children:t(Js,{className:"fa-icon"})})]}),t(T,{gap:1,children:f&&f.map((O,R)=>l(w,{gap:1,children:[l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",checked:O.isBadge,onChange:y=>N(R,y.target.checked,O.itemCode,O.probability)}),t(S,{small:!0,children:"Badge?"})]}),t("input",{type:"text",className:"form-control form-control-sm",value:O.itemCode,onChange:y=>N(R,O.isBadge,y.target.value,O.probability),placeholder:"Item Code"}),t("input",{type:"number",className:"form-control form-control-sm",value:O.probability,onChange:y=>N(R,O.isBadge,O.itemCode,Number(y.target.value)),placeholder:"Probability"}),R>0&&t(D,{variant:"danger",onClick:y=>b(R),children:t(ji,{className:"fa-icon"})})]},R))})]})},Fk=o=>{const[e,n]=i.useState(1),[r,s]=i.useState(1),[a,c]=i.useState(1),{trigger:u=null,setIntParams:d=null}=Se(),h=()=>d([e,r,a]);return i.useEffect(()=>{u.intData.length>=2?(n(u.intData[0]),s(u.intData[1]),c(u.intData[2])):(n(1),s(1),c(1))},[u]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:h,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.setpoints",["points"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:100,value:e,onChange:g=>n(g)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.settimesingame",["times"],[r.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:10,value:r,onChange:g=>s(g)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.team")}),[1,2,3,4].map(g=>l(w,{gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${g}`,checked:a===g,onChange:f=>c(g)}),t(S,{children:m("wiredfurni.params.team."+g)})]},g))]})]})},Bk=o=>{const[e,n]=i.useState(1),[r,s]=i.useState(1),{trigger:a=null,setIntParams:c=null}=Se(),u=()=>c([e,r]);return i.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(1),s(1))},[a]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.setpoints",["points"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:100,value:e,onChange:d=>n(d)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.settimesingame",["times"],[r.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:10,value:r,onChange:d=>s(d)})]})]})},Gk=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.team")}),[1,2,3,4].map(c=>l(w,{gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:m(`wiredfurni.params.team.${c}`)})]},c))]})})},Vk=o=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:s=null}=Se(),a=()=>s(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value),maxLength:K("wired.action.kick.from.room.max.length",100)})]})})},Hk=o=>t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Wk=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],jk=[0,1,2,3,4,5,6],qk=o=>{const[e,n]=i.useState(-1),[r,s]=i.useState(-1),{trigger:a=null,setIntParams:c=null}=Se(),u=()=>c([e,r]);return i.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(-1),s(-1))},[a]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.startdir")}),t(w,{gap:1,children:Wk.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:e===d.value,onChange:h=>n(d.value)}),t(S,{children:t("i",{className:`icon icon-${d.icon}`})})]},d.value))})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.turn")}),jk.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${d}`,checked:r===d,onChange:h=>s(d)}),t(S,{children:m(`wiredfurni.params.turn.${d}`)})]},d))]})]})},zk=[{value:0,icon:"ne"},{value:2,icon:"se"},{value:4,icon:"sw"},{value:6,icon:"nw"}],Yk=o=>{const[e,n]=i.useState(-1),[r,s]=i.useState(-1),{trigger:a=null,setIntParams:c=null}=Se(),u=()=>c([r,e]);return i.useEffect(()=>{a.intData.length>=2?(n(a.intData[1]),s(a.intData[0])):(n(-1),s(-1))},[a]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.emptytiles",["tiles"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:5,value:e,onChange:d=>n(d)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.startdir")}),t(w,{gap:1,children:zk.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:r===d.value,onChange:h=>s(d.value)}),t(S,{children:t("i",{className:`icon icon-${d.icon}`})})]},d.value))})]})]})},$k=[{value:4,icon:"ne"},{value:5,icon:"se"},{value:6,icon:"sw"},{value:7,icon:"nw"},{value:2,icon:"mv-2"},{value:3,icon:"mv-3"},{value:1,icon:"mv-1"}],Kk=[0,1,2,3],Xk=o=>{const[e,n]=i.useState(-1),[r,s]=i.useState(-1),{trigger:a=null,setIntParams:c=null}=Se(),u=()=>c([e,r]);return i.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(-1),s(-1))},[a]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.movefurni")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:"movement0",checked:e===0,onChange:d=>n(0)}),t(S,{children:m("wiredfurni.params.movefurni.0")})]}),l(w,{gap:1,children:[$k.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"movement",id:`movement${d.value}`,checked:e===d.value,onChange:h=>n(d.value)}),t("i",{className:`icon icon-${d.icon}`})]},d.value)),t("div",{className:"col"})]})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.rotatefurni")}),Kk.map(d=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"rotation",id:`rotation${d}`,checked:r===d,onChange:h=>s(d)}),l(S,{children:[[1,2].includes(d)&&t("i",{className:`icon icon-rot-${d}`}),m(`wiredfurni.params.rotatefurni.${d}`)]})]},d))]})]})},Qk=o=>{const[e,n]=i.useState(-1),[r,s]=i.useState(""),{trigger:a=null,setIntParams:c=null,setStringParam:u=null}=Se(),d=()=>{c([e]),u(r)};return i.useEffect(()=>{n(a.intData.length>0?a.intData[0]:0),s(a.stringData)},[a]),l(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.length.minutes",["minutes"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:10,value:e,onChange:h=>n(h)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.message")}),t("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:h=>s(h.target.value),maxLength:K("wired.action.mute.user.max.length",100)})]})]})},Jk=o=>t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),Zk=o=>{const[e,n]=i.useState(0),[r,s]=i.useState(0),[a,c]=i.useState(0),{trigger:u=null,setIntParams:d=null}=Se(),h=()=>d([e,r,a]);return i.useEffect(()=>{n(u.getBoolean(0)?1:0),s(u.getBoolean(1)?1:0),c(u.getBoolean(2)?1:0)},[u]),t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:h,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.conditions")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:g=>n(g.target.checked?1:0)}),t(S,{children:m("wiredfurni.params.condition.state")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:g=>s(g.target.checked?1:0)}),t(S,{children:m("wiredfurni.params.condition.direction")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!a,onChange:g=>c(g.target.checked?1:0)}),t(S,{children:m("wiredfurni.params.condition.position")})]})]})})},eA=o=>t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),tA=o=>t(gt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_BY_TYPE_OR_FROM_CONTEXT,hasSpecialInput:!1,save:null}),nA=o=>{switch(o){case fe.BOT_CHANGE_FIGURE:return t(vk,{});case fe.BOT_FOLLOW_AVATAR:return t(wk,{});case fe.BOT_GIVE_HAND_ITEM:return t(yk,{});case fe.BOT_MOVE:return t(Ok,{});case fe.BOT_TALK:return t(Ak,{});case fe.BOT_TALK_DIRECT_TO_AVTR:return t(kk,{});case fe.BOT_TELEPORT:return t(Pk,{});case fe.CALL_ANOTHER_STACK:return t(Dk,{});case fe.CHASE:return t(Mk,{});case fe.CHAT:return t(Lk,{});case fe.FLEE:return t(Uk,{});case fe.GIVE_REWARD:return t(xk,{});case fe.GIVE_SCORE:return t(Bk,{});case fe.GIVE_SCORE_TO_PREDEFINED_TEAM:return t(Fk,{});case fe.JOIN_TEAM:return t(Gk,{});case fe.KICK_FROM_ROOM:return t(Vk,{});case fe.LEAVE_TEAM:return t(Hk,{});case fe.MOVE_FURNI:return t(Xk,{});case fe.MOVE_AND_ROTATE_FURNI:return t(qk,{});case fe.MOVE_FURNI_TO:return t(Yk,{});case fe.MUTE_USER:return t(Qk,{});case fe.RESET:return t(Jk,{});case fe.SET_FURNI_STATE:return t(Zk,{});case fe.TELEPORT:return t(eA,{});case fe.TOGGLE_FURNI_STATE:return t(tA,{})}return null},Xt=o=>{const{requiresFurni:e=le.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=o;return t(_l,{wiredType:"condition",requiresFurni:e,hasSpecialInput:r,save:()=>n&&n(),children:s})},rA=[2,5,7,8,9,10,27],sA=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.handitem")}),t("select",{className:"form-select form-select-sm",value:e,onChange:c=>n(parseInt(c.target.value)),children:rA.map(c=>t("option",{value:c,children:m(`handitem${c}`)},c))})]})})},aA=o=>t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),oA=o=>t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),iA=[1,2,3,4],lA=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.team")}),iA.map(c=>l(w,{gap:1,alignItems:"center",children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:m(`wiredfurni.params.team.${c}`)})]},c))]})})},cA=o=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:s=null}=Se(),a=()=>s(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.badgecode")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:c=>n(c.target.value)})]})})},uA=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n((r==null?void 0:r.intData[0])??0)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.tooltip.effectid")}),t("input",{type:"number",className:"form-control form-control-sm",value:e,onChange:c=>n(parseInt(c.target.value))})]})})},dA=o=>{const[e,n]=i.useState(""),[r,s]=i.useState(""),{trigger:a=null,setIntParams:c=null}=Se(),u=()=>{let d=0,h=0;const g=new Date(e),f=new Date(r);g&&f&&(d=g.getTime()/1e3,h=f.getTime()/1e3),c([d,h])};return i.useEffect(()=>{if(a.intData.length>=2){let d=new Date,h=new Date;a.intData[0]>0&&(d=new Date(a.intData[0]*1e3)),a.intData[1]>0&&(h=new Date(a.intData[1]*1e3)),n(cc(d)),s(cc(h))}},[a]),l(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.startdate")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:d=>n(d.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.enddate")}),t("input",{type:"text",className:"form-control form-control-sm",value:r,onChange:d=>s(d.target.value)})]})]})},mA=o=>t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!1,save:null}),gA=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.requireall")}),[0,1].map(c=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:m("wiredfurni.params.requireall."+c)})]},c))]})})},hA=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.not_requireall")}),[0,1].map(c=>l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"requireAll",id:`requireAll${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:m(`wiredfurni.params.not_requireall.${c}`)})]},c))]})})},fA=o=>t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),pA=o=>{const[e,n]=i.useState(0),[r,s]=i.useState(0),[a,c]=i.useState(0),{trigger:u=null,setIntParams:d=null}=Se(),h=()=>d([e,r,a]);return i.useEffect(()=>{n(u.getBoolean(0)?1:0),s(u.getBoolean(1)?1:0),c(u.getBoolean(2)?1:0)},[u]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:h,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.conditions")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"stateFlag",checked:!!e,onChange:g=>n(g.target.checked?1:0)}),t(S,{children:m("wiredfurni.params.condition.state")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"directionFlag",checked:!!r,onChange:g=>s(g.target.checked?1:0)}),t(S,{children:m("wiredfurni.params.condition.direction")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"checkbox",id:"positionFlag",checked:!!a,onChange:g=>c(g.target.checked?1:0)}),t(S,{children:m("wiredfurni.params.condition.position")})]})]})})},IA=[1,2,3,4],EA=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.team")}),IA.map(c=>l(w,{gap:1,alignItems:"center",children:[t("input",{className:"form-check-input",type:"radio",name:"selectedTeam",id:`selectedTeam${c}`,checked:e===c,onChange:u=>n(c)}),t(S,{children:m(`wiredfurni.params.team.${c}`)})]},c))]})})},CA=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.allowbefore",["seconds"],[ca(e)])}),t(Dt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},_A=o=>{const[e,n]=i.useState(-1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.allowafter",["seconds"],[ca(e)])}),t(Dt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},bA=o=>{const[e,n]=i.useState(1),[r,s]=i.useState(1),{trigger:a=null,setIntParams:c=null}=Se(),u=()=>c([e,r]);return i.useEffect(()=>{a.intData.length>=2?(n(a.intData[0]),s(a.intData[1])):(n(1),s(1))},[a]),l(Xt,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.usercountmin",["value"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:50,value:e,onChange:d=>n(d)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.usercountmax",["value"],[r.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:50,value:r,onChange:d=>s(d)})]})]})},SA=o=>{switch(o){case he.ACTOR_HAS_HANDITEM:return t(sA,{});case he.ACTOR_IS_GROUP_MEMBER:case he.NOT_ACTOR_IN_GROUP:return t(aA,{});case he.ACTOR_IS_ON_FURNI:case he.NOT_ACTOR_ON_FURNI:return t(oA,{});case he.ACTOR_IS_IN_TEAM:case he.NOT_ACTOR_IN_TEAM:return t(lA,{});case he.ACTOR_IS_WEARING_BADGE:case he.NOT_ACTOR_WEARS_BADGE:return t(cA,{});case he.ACTOR_IS_WEARING_EFFECT:case he.NOT_ACTOR_WEARING_EFFECT:return t(uA,{});case he.DATE_RANGE_ACTIVE:return t(dA,{});case he.FURNIS_HAVE_AVATARS:case he.FURNI_NOT_HAVE_HABBO:return t(mA,{});case he.HAS_STACKED_FURNIS:return t(gA,{});case he.NOT_HAS_STACKED_FURNIS:return t(hA,{});case he.STUFF_TYPE_MATCHES:case he.NOT_FURNI_IS_OF_TYPE:return t(fA,{});case he.STATES_MATCH:case he.NOT_STATES_MATCH:return t(pA,{});case he.TIME_ELAPSED_LESS:return t(CA,{});case he.TIME_ELAPSED_MORE:return t(_A,{});case he.USER_COUNT_IN:case he.NOT_USER_COUNT_IN:return t(bA,{});case he.SELECT_FURNI_AND_TEAM:return t(EA,{})}return null},pn=o=>{const{requiresFurni:e=le.STUFF_SELECTION_OPTION_NONE,save:n=null,hasSpecialInput:r=!1,children:s=null}=o;return t(_l,{wiredType:"trigger",requiresFurni:e,hasSpecialInput:r,save:()=>n&&n(),children:s})},NA=o=>{const[e,n]=i.useState(""),[r,s]=i.useState(0),{trigger:a=null,setStringParam:c=null}=Se(),u=()=>c(r===1?e:"");return i.useEffect(()=>{n(a.stringData),s(a.stringData?1:0)},[a]),t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:u,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.picktriggerer")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode0",checked:r===0,onChange:d=>s(0)}),t(S,{children:m("wiredfurni.params.anyavatar")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"avatarMode",id:"avatarMode1",checked:r===1,onChange:d=>s(1)}),t(S,{children:m("wiredfurni.params.certainavatar")})]}),r===1&&t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:d=>n(d.target.value)})]})})},TA=o=>{const[e,n]=i.useState(""),[r,s]=i.useState(-1),{trigger:a=null,setStringParam:c=null,setIntParams:u=null}=Se(),d=()=>{c(e),u([r])};return i.useEffect(()=>{n(a.stringData),s(a.intData.length>0?a.intData[0]:0)},[a]),l(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:d,children:[l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.whatissaid")}),t("input",{type:"text",className:"form-control form-control-sm",value:e,onChange:h=>n(h.target.value)})]}),l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.picktriggerer")}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar0",checked:r===0,onChange:h=>s(0)}),t(S,{children:m("wiredfurni.params.anyavatar")})]}),l(w,{alignItems:"center",gap:1,children:[t("input",{className:"form-check-input",type:"radio",name:"triggererAvatar",id:"triggererAvatar1",checked:r===1,onChange:h=>s(1)}),t(S,{children:q().userName})]})]})]})},vA=o=>t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),wA=o=>t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),RA=o=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:s=null}=Se(),a=()=>s(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},yA=o=>{const[e,n]=i.useState(""),{trigger:r=null,setStringParam:s=null}=Se(),a=()=>s(e);return i.useEffect(()=>{n(r.stringData)},[r]),t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.bot.name")}),t("input",{type:"text",className:"form-control form-control-sm",maxLength:32,value:e,onChange:c=>n(c.target.value)})]})})},OA=o=>t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),kA=o=>{const[e,n]=i.useState(1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.settime",["seconds"],[ca(e)])}),t(Dt,{className:"nitro-slider",min:1,max:1200,value:e,onChange:c=>n(c)})]})})},AA=o=>{const[e,n]=i.useState(1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.setlongtime",["time"],[jn.format(e*5).toString()])}),t(Dt,{className:"nitro-slider",min:1,max:120,value:e,onChange:c=>n(c)})]})})},PA=o=>{const[e,n]=i.useState(1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.settime",["seconds"],[ca(e)])}),t(Dt,{className:"nitro-slider",min:1,max:60,value:e,onChange:c=>n(c)})]})})},DA=o=>t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),MA=o=>t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!1,save:null}),LA=o=>{const[e,n]=i.useState(1),{trigger:r=null,setIntParams:s=null}=Se(),a=()=>s([e]);return i.useEffect(()=>{n(r.intData.length>0?r.intData[0]:0)},[r]),t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_NONE,hasSpecialInput:!0,save:a,children:l(T,{gap:1,children:[t(S,{bold:!0,children:m("wiredfurni.params.setscore",["points"],[e.toString()])}),t(Dt,{className:"nitro-slider",min:1,max:1e3,value:e,onChange:c=>n(c)})]})})},UA=o=>t(pn,{requiresFurni:le.STUFF_SELECTION_OPTION_BY_ID_OR_BY_TYPE,hasSpecialInput:!1,save:null}),xA=o=>{switch(o){case et.AVATAR_ENTERS_ROOM:return t(NA,{});case et.AVATAR_SAYS_SOMETHING:return t(TA,{});case et.AVATAR_WALKS_OFF_FURNI:return t(vA,{});case et.AVATAR_WALKS_ON_FURNI:return t(wA,{});case et.BOT_REACHED_AVATAR:return t(RA,{});case et.BOT_REACHED_STUFF:return t(yA,{});case et.COLLISION:return t(OA,{});case et.EXECUTE_ONCE:return t(kA,{});case et.EXECUTE_PERIODICALLY:return t(PA,{});case et.EXECUTE_PERIODICALLY_LONG:return t(AA,{});case et.GAME_ENDS:return t(DA,{});case et.GAME_STARTS:return t(MA,{});case et.SCORE_ACHIEVED:return t(LA,{});case et.TOGGLE_FURNI:return t(UA,{})}return null},FA=o=>{const{trigger:e=null}=Se();return e?e instanceof Wu?nA(e.code):e instanceof ju?xA(e.code):e instanceof qu?SA(e.code):null:null},BA=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(!0),[a,c]=i.useState("all"),u=new URLSearchParams(window.location.search).get("sso"),[d,h]=i.useState(null),{sendMessage:g,lastMessage:f,readyState:p}=Kr(K("external.websocket"),{onOpen:()=>{d!=null&&clearInterval(d),g(JSON.stringify(new LT(u)));var E=setInterval(()=>{g(JSON.stringify(new UT))},5e3);h(E)},shouldReconnect:E=>!0,share:!0});Ye(jt.CREATED,E=>s(!1)),Ye(jt.ENDED,E=>s(E.openLandingView)),i.useEffect(()=>{n(!0),zs().connection.onReady()},[]),i.useEffect(()=>{const E={linkReceived:_=>{const I=_.split("/");if(!(I.length<2))switch(I[1]){case"open":if(I.length>2)switch(I[2]){case"credits":break;default:{const b=I[2];Zs.openHabblet(b)}}return}},eventUrlPrefix:"habblet/"};return ut(E),()=>dt(E)},[]);function C(E){c(E)}return l(P,{fit:!0,children:[t(Rs,{type:bt.FADE_IN,inProp:r,timeout:300,children:t(CR,{})}),t(fk,{isInRoom:!r}),t(jR,{}),t(gk,{}),t(Kv,{}),t(FA,{}),t(JT,{}),t(WT,{}),t(ay,{}),t(OR,{actualCategory:a,setActualCategory:C}),t($v,{}),t(Cw,{}),t(ky,{}),t(Sk,{}),t(bk,{}),t(Uw,{}),t(iv,{}),t(mR,{}),t(iy,{}),t(Yw,{}),t($w,{}),t(uv,{}),t(Nw,{}),t(ow,{}),t(ev,{})]})};Ru.UI_VERSION=yd();const GA=o=>{const[e,n]=i.useState(!1),[r,s]=i.useState(!1),[a,c]=i.useState("Getting Ready"),[u,d]=i.useState(0),[h,g]=i.useState(!0);if(!_e()){if(!NitroConfig)throw new Error("NitroConfig is not defined!");is.bootstrap()}const f=i.useCallback(async p=>{switch(p.type){case Ca.LOADED:_e().localization.init(),d(C=>C+20);return;case Ca.FAILED:s(!0),c("Configuration Failed");return;case is.WEBGL_UNAVAILABLE:s(!0),c("WebGL Required");return;case is.WEBGL_CONTEXT_LOST:s(!0),c("WebGL Context Lost - Reloading"),setTimeout(()=>window.location.reload(),1500);return;case Qn.CONNECTION_HANDSHAKING:d(C=>C+20);return;case Qn.CONNECTION_HANDSHAKE_FAILED:s(!0),c("Handshake Failed");return;case Qn.CONNECTION_AUTHENTICATED:d(C=>C+20),_e().init(),qs.available&&qs.call("legacyTrack","authentication","authok",[]);return;case Qn.CONNECTION_ERROR:s(!0),c("Connection Error");return;case Qn.CONNECTION_CLOSED:c("Connection Error"),Zs.send(-1,"client.init.handshake.fail");return;case En.ENGINE_INITIALIZED:d(C=>C+20),setTimeout(()=>n(!0),300);return;case jl.LOADED:{const C=K("preload.assets.urls"),E=[];if(C&&C.length)for(const I of C)E.push(hr.interpolate(I));await Xu().downloadAssets(E)?(zs().init(),d(I=>I+20)):(s(!0),c("Assets Failed"));return}}},[]);return Br(is.WEBGL_UNAVAILABLE,f),Br(is.WEBGL_CONTEXT_LOST,f),Br(Qn.CONNECTION_HANDSHAKING,f),Br(Qn.CONNECTION_HANDSHAKE_FAILED,f),Br(Qn.CONNECTION_AUTHENTICATED,f),Br(Qn.CONNECTION_ERROR,f),Br(Qn.CONNECTION_CLOSED,f),Te(En.ENGINE_INITIALIZED,f),OS(jl.LOADED,f),mc(Ca.LOADED,f),mc(Ca.FAILED,f),i.useEffect(()=>{_e().core.configuration.init();const p=C=>g(!(window.devicePixelRatio%1));return window.addEventListener("resize",p),p(),()=>{window.removeEventListener("resize",p)}},[]),l(P,{fit:!0,overflow:"hidden",className:h&&"image-rendering-pixelated",children:[(!e||r)&&t(RS,{isError:r,message:a,percent:u}),t(Rs,{type:bt.FADE_IN,inProp:e,children:t(BA,{})}),t(P,{id:"draggable-windows-container"})]})};Sg(document.getElementById("root")).render(t(GA,{}));
