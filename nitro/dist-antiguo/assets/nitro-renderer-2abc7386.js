import{i as _u,B as Sa,F as sh,A as Qf,a as yo,C as Jf,P as Y,R as de,S as Mt,T as Ct,b as Zf,c as ze,s as Ma,d as wu,M as ue,e as Hu,f as Cs,G as Lo,g as $f,h as tm,E as em,j as sm,I as im,k as rm,l as nm,m as am,p as om,n as _m,o as Uo,q as hm,r as um,t as Bi}from"./vendor-79a8afd5.js";class G{static log(...t){this.LOG_DEBUG&&console.log(this.logPrefix(),...t)}static warn(...t){this.LOG_WARN&&console.warn(this.logPrefix(),...t)}static error(...t){this.LOG_ERROR&&console.error(this.logPrefix(),...t)}static events(...t){this.LOG_EVENTS&&console.log(this.logPrefix(),...t)}static packets(...t){this.LOG_PACKETS&&console.log(this.logPrefix(),...t)}static logPrefix(){return"[Nitro]"}}G.LOG_DEBUG=!1;G.LOG_WARN=!1;G.LOG_ERROR=!1;G.LOG_EVENTS=!1;G.LOG_PACKETS=!1;class vt{constructor(t=null){if(this._length=0,this._dictionary=new Map,this._array=[],this._keys=[],t)for(const[e,s]of t.entries())this.add(e,s)}get length(){return this._length}get disposed(){return!this._dictionary}dispose(){if(!this._dictionary){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._dictionary=null}this._length=0,this._array=null,this._keys=null}reset(){for(const t of this._dictionary.keys())this._dictionary.delete(t);this._length=0,this._array=[],this._keys=[]}unshift(t,e){return this._dictionary.get(t)!==null?!1:(this._dictionary.set(t,e),this._array.unshift(e),this._keys.unshift(t),this._length++,!0)}add(t,e){return this._dictionary.get(t)!==void 0?!1:(this._dictionary.set(t,e),this._array[this._length]=e,this._keys[this._length]=t,this._length++,!0)}remove(t){const e=this._dictionary.get(t);if(!e)return null;const s=this._array.indexOf(e);return s>=0&&(this._array.splice(s,1),this._keys.splice(s,1),this._length--),this._dictionary.delete(t),e}getWithIndex(t){return t<0||t>=this._length?null:this._array[t]}getKey(t){return t<0||t>=this._length?null:this._keys[t]}getKeys(){return this._keys.slice()}hasKey(t){return this._keys.indexOf(t)>-1}getValue(t){return this._dictionary.get(t)}getValues(){return this._array.slice()}hasValue(t){return this._array.indexOf(t)>-1}indexOf(t){return this._array.indexOf(t)}concatenate(t){for(const e of t._keys)this.add(e,t.getValue(e))}clone(){const t=new vt;return t.concatenate(this),t}}const Vu=n=>{let t="";const e=new Uint8Array(n),s=e.byteLength;for(let i=0;i<s;i++)t+=String.fromCharCode(e[i]);return window.btoa(t)};class Ca{constructor(t){this._position=0,this._dataView=new DataView(t)}readBytes(t){const e=new Ca(this._dataView.buffer.slice(this._position,this._position+t));return this._position+=t,e}readByte(){const t=this._dataView.getInt8(this._position);return this._position++,t}readShort(){const t=this._dataView.getInt16(this._position);return this._position+=2,t}readInt(){const t=this._dataView.getInt32(this._position);return this._position+=4,t}readFloat(){const t=this._dataView.getFloat32(this._position);return this._position+=4,t}readDouble(){const t=this._dataView.getFloat64(this._position);return this._position+=8,t}remaining(){return this._dataView.byteLength-this._position}toString(t){return new TextDecoder().decode(this._dataView.buffer)}toArrayBuffer(){return this._dataView.buffer}}class hu{constructor(){this._buffer=new Uint8Array,this._position=0}writeByte(t){const e=new Uint8Array(1);return e[0]=t,this.appendArray(e),this}writeBytes(t){const e=new Uint8Array(t);return this.appendArray(e),this}writeShort(t){const e=new Uint8Array(2);return e[0]=t>>8,e[1]=t&255,this.appendArray(e),this}writeInt(t){const e=new Uint8Array(4);return e[0]=t>>24,e[1]=t>>16,e[2]=t>>8,e[3]=t&255,this.appendArray(e),this}writeString(t,e=!0){const s=new TextEncoder().encode(t);return e?(this.writeShort(s.length),this.appendArray(s)):this.appendArray(s),this}appendArray(t){if(!t)return;const e=new Uint8Array(this.position+t.length>this._buffer.length?this.position+t.length:this._buffer.length);e.set(this._buffer),e.set(t,this.position),this._buffer=e,this.position+=t.length}getBuffer(){return this._buffer.buffer}get position(){return this._position}set position(t){this._position=t}toString(t){return new TextDecoder(t).decode(this._buffer)}}const ju=class zu{constructor(t){this._jsonFile=null,this._image=null,this._imageData=null,this._baseTexture=null,this.parse(t)}parse(t){const e=new Ca(t);let s=e.readShort();for(;s>0;){const i=e.readShort(),r=e.readBytes(i).toString(),a=e.readInt(),o=e.readBytes(a);if(r.endsWith(".json")){const _=_u(o.toArrayBuffer());this._jsonFile=JSON.parse(zu.TEXT_DECODER.decode(_))}else{const _=_u(o.toArrayBuffer()),l=Vu(_);this._baseTexture=new Sa("data:image/png;base64,"+l)}s--}}get jsonFile(){return this._jsonFile}get baseTexture(){return this._baseTexture}};ju.TEXT_DECODER=new TextDecoder("utf-8");let Yu=ju;class lm extends sh{constructor(t){super(`attribute vec2 aVertexPosition;
            attribute vec2 aTextureCoord;
            
            uniform mat3 projectionMatrix;
            
            varying vec2 vTextureCoord;
            
            void main(void)
            {
                gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
                vTextureCoord = aTextureCoord;
            }`,`varying vec2 vTextureCoord;
            uniform sampler2D uSampler;
            
            uniform float gamma;
            uniform float contrast;
            uniform float saturation;
            uniform float brightness;
            uniform float red;
            uniform float green;
            uniform float blue;
            uniform float alpha;
            
            void main(void)
            {
                vec4 c = texture2D(uSampler, vTextureCoord);
            
                if (c.a > 0.0) {
                    c.rgb /= c.a;
            
                    vec3 rgb = pow(c.rgb, vec3(1. / gamma));
                    rgb = mix(vec3(.5), mix(vec3(dot(vec3(.2125, .7154, .0721), rgb)), rgb, saturation), contrast);
                    rgb.r *= red;
                    rgb.g *= green;
                    rgb.b *= blue;
                    c.rgb = rgb * brightness;
            
                    c.rgb *= c.a;
                }
            
                gl_FragColor = c * alpha;
            }`),this.gamma=1,this.saturation=1,this.contrast=1,this.brightness=1,this.red=1,this.green=1,this.blue=1,this.alpha=1,Object.assign(this,t)}apply(t,e,s,i){this.uniforms.gamma=Math.max(this.gamma,1e-4),this.uniforms.saturation=this.saturation,this.uniforms.contrast=this.contrast,this.uniforms.brightness=this.brightness,this.uniforms.red=this.red,this.uniforms.green=this.green,this.uniforms.blue=this.blue,this.uniforms.alpha=this.alpha,t.applyFilter(this,e,s,i)}}const cm=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,dm=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D mask;
uniform int fromChannel;
uniform int toChannel;

void main(void) {
    vec4 maskColor = texture2D(mask, vTextureCoord);
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(maskColor.r == 0.0 && maskColor.g == 0.0 && maskColor.b == 0.0)
    {
        adjusted.a = 0.0;
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, adjusted.a);
}`;class Na extends sh{constructor(t,e,s){super(cm,dm,{mask:t.castToBaseTexture(),fromChannel:e,toChannel:s})}}Na.CHANNEL_RED=0;Na.CHANNEL_GREEN=1;Na.CHANNEL_BLUE=2;Na.CHANNEL_ALPHA=3;const Wu=class vo extends Qf{constructor(t){super(t),vo.INSTANCE||(vo.INSTANCE=this)}static get instance(){return this.INSTANCE||null}};Wu.INSTANCE=null;let zt=Wu;const Ss=()=>{var n;return((n=zt.instance)==null?void 0:n.ticker)||null},gm=()=>{var n;return((n=Ss())==null?void 0:n.FPS)||0},$=()=>{var n;return((n=Ss())==null?void 0:n.lastTime)||0};class dj extends yo{}class Em extends Sa{}class Ve extends Jf{}class fm extends sh{}class ta extends Y{}class gj extends de{}class Nt extends Mt{}class ku extends Ct{}class Ej extends Zf{}const mm=`
attribute vec2 aVertexPosition;
attribute vec2 aTextureCoord;
uniform mat3 projectionMatrix;
varying vec2 vTextureCoord;
void main(void)
{
    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);
    vTextureCoord = aTextureCoord;
}`,Im=`
varying vec2 vTextureCoord;
uniform sampler2D uSampler;
uniform sampler2D lut;
uniform int channel;

void main(void) {
    vec4 currentColor = texture2D(uSampler, vTextureCoord);
    vec4 adjusted = currentColor;

    if(currentColor.a > 0.0)
    {
        if(channel == 0)
        {
            adjusted = texture2D(lut, vec2((currentColor.r * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 1) {
            adjusted = texture2D(lut, vec2((currentColor.g * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 2) {
            adjusted = texture2D(lut, vec2((currentColor.b * 255.0 + 0.5) / 256.0, 0.5));
        } else if(channel == 3) {
            adjusted = texture2D(lut, vec2((currentColor.a * 255.0 + 0.5) / 256.0, 0.5));
        }
    }

    gl_FragColor = vec4(adjusted.r, adjusted.g, adjusted.b, currentColor.a);
}`,$r=class wi extends fm{constructor(t,e=wi.CHANNEL_RED){super(mm,Im),this._channel=e;let s=[];s=this.getLutForPalette(t),this._lut=Em.fromBuffer(Uint8Array.from(s),s.length/4,1,{mipmap:0,scaleMode:0}),this.uniforms.lut=this._lut,this.uniforms.channel=this._channel}getLutForPalette(t){const e=[];for(let s=0;s<t.length;s++)e[s*4+wi.CHANNEL_RED]=t[s]>>16&255,e[s*4+wi.CHANNEL_GREEN]=t[s]>>8&255,e[s*4+wi.CHANNEL_BLUE]=t[s]&255,e[s*4+wi.CHANNEL_ALPHA]=t[s]>>24&255;return e}get lut(){return this._lut}get channel(){return this._channel}};$r.CHANNEL_RED=0;$r.CHANNEL_GREEN=1;$r.CHANNEL_BLUE=2;$r.CHANNEL_ALPHA=3;let uu=$r;const Ku=class Xu{constructor(){this.RENDER_TEXTURE_POOL=new Map,this.RENDER_TEXTURE_CACHE=[]}clearCache(){this.RENDER_TEXTURE_POOL.forEach(t=>t==null?void 0:t.destroy(!0)),this.RENDER_TEXTURE_POOL.clear(),this.RENDER_TEXTURE_CACHE=[]}clearRenderTexture(t){return t?this.writeToRenderTexture(new Mt(Ct.EMPTY),t):null}getTextureIdentifier(t,e,s){return`${s??Xu.DEFAULT_PLANE_ID}:${t}:${e}`}createRenderTexture(t,e,s=null){if(t<0||e<0)return null;if(!s){const r=ze.create({width:t,height:e});return this.RENDER_TEXTURE_CACHE.push(r),r}s=this.getTextureIdentifier(t,e,s);let i=this.RENDER_TEXTURE_POOL.get(s);return i||(i=ze.create({width:t,height:e}),this.RENDER_TEXTURE_CACHE.push(i),this.RENDER_TEXTURE_POOL.set(s,i)),i}createAndFillRenderTexture(t,e,s=null,i=16777215){if(t<0||e<0)return null;const r=this.createRenderTexture(t,e,s);return this.clearAndFillRenderTexture(r,i)}createAndWriteRenderTexture(t,e,s,i=null,r=null){if(t<0||e<0)return null;const a=this.createRenderTexture(t,e,i);return this.writeToRenderTexture(s,a,!0,r)}clearAndFillRenderTexture(t,e=16777215){if(!t)return null;const s=new Mt(Ct.WHITE);return s.tint=e,s.width=t.width,s.height=t.height,this.writeToRenderTexture(s,t)}writeToRenderTexture(t,e,s=!0,i=null){return!t||!e?null:(this.getRenderer().render(t,{renderTexture:e,clear:s,transform:i}),e)}getPixels(t,e=null){return this.getExtractor().pixels(t)}getRenderer(){return zt.instance.renderer}getExtractor(){return this.getRenderer().plugins.extract}};Ku.DEFAULT_PLANE_ID="DEFAULT";let Rm=Ku;class At{static generateTexture(t,e=null,s=null,i=1){return t?(s===null&&(s=Ma.SCALE_MODE),this.getRenderer().generateTexture(t,{scaleMode:s,resolution:i,region:e})):null}static generateTextureFromImage(t){return t?Ct.from(t):null}static generateImage(t){return t?this.getExtractor().image(t):null}static generateImageUrl(t){return t?this.getExtractor().base64(t):null}static generateCanvas(t){return t?this.getExtractor().canvas(t):null}static clearRenderTexture(t){return t?this.writeToRenderTexture(new Mt(Ct.EMPTY),t):null}static createRenderTexture(t,e){return t<0||e<0?null:ze.create({width:t,height:e})}static createAndFillRenderTexture(t,e,s=16777215){if(t<0||e<0)return null;const i=this.createRenderTexture(t,e);return this.clearAndFillRenderTexture(i,s)}static createAndWriteRenderTexture(t,e,s,i=null){if(t<0||e<0)return null;const r=this.createRenderTexture(t,e);return this.writeToRenderTexture(s,r,!0,i)}static clearAndFillRenderTexture(t,e=16777215){if(!t)return null;const s=new Mt(Ct.WHITE);return s.tint=e,s.width=t.width,s.height=t.height,this.writeToRenderTexture(s,t)}static writeToRenderTexture(t,e,s=!0,i=null){return!t||!e?null:(this.getRenderer().render(t,{renderTexture:e,clear:s,transform:i}),e)}static getPixels(t,e=null){return this.getExtractor().pixels(t)}static getRenderer(){return zt.instance.renderer}static getExtractor(){return this.getRenderer().plugins.extract}}const qu=class Cr{static createAsset(t,e,s,i,r,a=!1,o=!1,_=!1){const l=Cr.GRAPHIC_POOL.length?Cr.GRAPHIC_POOL.pop():new Cr;return l._name=t,l._source=e||null,s?(l._texture=s,l._initialized=!1):(l._texture=null,l._initialized=!0),l._usesPalette=_,l._x=i,l._y=r,l._flipH=a,l._flipV=o,l._rectangle=null,l}recycle(){this._texture=null,Cr.GRAPHIC_POOL.push(this)}initialize(){this._initialized||!this._texture||(this._width=this._texture.width,this._height=this._texture.height,this._initialized=!0)}getImageUrl(){return At.generateImageUrl(new Mt(this._texture))}get name(){return this._name}get source(){return this._source}get texture(){return this._texture}get usesPalette(){return this._usesPalette}get x(){return this._x}get y(){return this._y}get width(){return this.initialize(),this._width}get height(){return this.initialize(),this._height}get offsetX(){return this._flipH?-this._x:this._x}get offsetY(){return this._flipV?-this._y:this._y}get flipH(){return this._flipH}get flipV(){return this._flipV}get rectangle(){return this._rectangle||(this._rectangle=new de(0,0,this.width,this.height)),this._rectangle}};qu.GRAPHIC_POOL=[];let Tm=qu;class pm{constructor(t,e,s){for(this._palette=t;this._palette.length<256;)this._palette.push([0,0,0]);this._primaryColor=e,this._secondaryColor=s}dispose(){}applyPalette(t){var a,o;const e=At.createAndWriteRenderTexture(t.width,t.height,new Mt(t)),s=At.getPixels(e);for(let _=0;_<s.length;_+=4){let l=this._palette[s[_+1]];l===void 0&&(l=[0,0,0]),s[_]=l[0],s[_+1]=l[1],s[_+2]=l[2]}const i=(a=e.baseTexture._glTextures[1])==null?void 0:a.texture,r=(o=zt.instance.renderer)==null?void 0:o.gl;return r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e.width,e.height,0,r.RGBA,r.UNSIGNED_BYTE,s),r.bindTexture(r.TEXTURE_2D,null),e}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}}const Qu=class bo{constructor(t,e){if(!t)throw new Error("invalid_collection");this._name=t.name,this._baseTexture=e&&e.baseTexture||null,this._data=t,this._textures=new Map,this._assets=new Map,this._palettes=new Map,this._paletteAssetNames=[],e&&this.addLibraryAsset(e.textures),this.define(t)}static removeFileExtension(t){return t.substring(0,t.lastIndexOf("."))||t}dispose(){if(this._palettes){for(const t of this._palettes.values())t.dispose();this._palettes.clear()}if(this._paletteAssetNames&&(this.disposePaletteAssets(),this._paletteAssetNames=null),this._assets){for(const t of this._assets.values())t.recycle();this._assets.clear()}}addReference(){this._referenceCount++,this._referenceTimestamp=$()}removeReference(){this._referenceCount--,this._referenceCount<=0&&(this._referenceCount=0,this._referenceTimestamp=$(),this.disposePaletteAssets(!1))}define(t){const e=t.assets,s=t.palettes;e&&this.defineAssets(e),s&&this.definePalettes(s)}defineAssets(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=-s.x||0,r=-s.y||0;let a=!1;const o=!1,_=s.usesPalette||!1;let l=s.source||"";s.flipH&&l.length&&(a=!0),l.length||(l=e);const c=this.getLibraryAsset(l);if(!c)continue;let d=this.createAsset(e,l,c,a,o,i,r,_);if(!d){const E=this.getAsset(e);E&&E.name!==E.source&&(d=this.replaceAsset(e,l,c,a,o,i,r,_))}}}definePalettes(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id.toString();if(this._palettes.get(i))continue;let r=16777215,a=16777215,o=s.color1;o&&o.length>0&&(r=parseInt(o,16)),o=s.color2,o&&o.length>0&&(a=parseInt(o,16)),this._palettes.set(i,new pm(s.rgb,r,a))}}createAsset(t,e,s,i,r,a,o,_){if(this._assets.get(t))return!1;const l=Tm.createAsset(t,e,s,a,o,i,r,_);return this._assets.set(t,l),!0}replaceAsset(t,e,s,i,r,a,o,_){const l=this._assets.get(t);return l&&(this._assets.delete(t),l.recycle()),this.createAsset(t,e,s,i,r,a,o,_)}getAsset(t){if(!t)return null;const e=this._assets.get(t);return e||null}getAssetWithPalette(t,e){const s=t+"@"+e;let i=this.getAsset(s);if(!i){if(i=this.getAsset(t),!i||!i.usesPalette)return i;const r=this.getPalette(e);if(r){const a=r.applyPalette(i.texture);a&&(this._paletteAssetNames.push(s),this.createAsset(s,i.source+"@"+e,a,i.flipH,i.flipV,i.x,i.y,!1),i=this.getAsset(s))}}return i}getTexture(t){return this._textures.get(t)}getPaletteNames(){return Array.from(this._palettes.keys())}getPaletteColors(t){const e=this.getPalette(t);return e?[e.primaryColor,e.secondaryColor]:null}getPalette(t){if(!t)return null;const e=this._palettes.get(t);return e||null}addAsset(t,e,s,i=0,r=0,a=!1,o=!1){if(!t||!e)return!1;const _=this.getLibraryAsset(t);return _?s?(_.baseTexture=e.baseTexture,_.frame=e.frame,_.trim=e.trim,_.updateUvs(),!0):!1:(this._textures.set(t,e),this.createAsset(t,t,e,a,o,i,r,!1))}disposeAsset(t){const e=this._assets.get(t);if(!e)return;this._assets.delete(t);const s=this.getLibraryAsset(e.source);s&&(this._textures.delete(e.source),s.destroy(!0)),e.recycle()}getLibraryAsset(t){if(!t)return null;t=this._name+"_"+t;const e=this._textures.get(t);return e||null}addLibraryAsset(t){if(t)for(const e in t){const s=t[e];s&&this._textures.set(bo.removeFileExtension(e),s)}}disposePaletteAssets(t=!0){if(this._paletteAssetNames&&(t||this._paletteAssetNames.length>bo.PALETTE_ASSET_DISPOSE_THRESHOLD)){for(const e of this._paletteAssetNames)this.disposeAsset(e);this._paletteAssetNames=[]}}get referenceCount(){return this._referenceCount}get referenceTimestamp(){return this._referenceTimestamp}get name(){return this._name}get baseTexture(){return this._baseTexture}get data(){return this._data}get textures(){return this._textures}get assets(){return this._assets}};Qu.PALETTE_ASSET_DISPOSE_THRESHOLD=10;let Ju=Qu;const Fo=class{constructor(){this._textures=new Map,this._collections=new Map}getTexture(t){if(!t)return null;const e=this._textures.get(t);return e||null}setTexture(t,e){!t||!e||this._textures.set(t,e)}getAsset(t){if(!t)return null;for(const e of this._collections.values()){if(!e)continue;const s=e.getAsset(t);if(s)return s}return null}getCollection(t){if(!t)return null;const e=this._collections.get(t);return e||null}createCollection(t,e){if(!t)return null;const s=new Ju(t,e);if(s){for(const[i,r]of s.textures.entries())this.setTexture(i,r);this._collections.set(s.name,s)}return s}async downloadAsset(t){return await this.downloadAssets([t])}async downloadAssets(t){if(!t||!t.length)return Promise.resolve(!0);try{for(const e of t){const s=await fetch(e);if(s.status!==200)continue;let i="application/octet-stream";switch(s.headers.has("Content-Type")&&(i=s.headers.get("Content-Type")),i){case"application/octet-stream":{const r=await s.arrayBuffer(),a=new Yu(r);await this.processAsset(a.baseTexture,a.jsonFile);break}case"image/png":case"image/jpeg":case"image/gif":{const r=await s.arrayBuffer(),a=Vu(r),o=Sa.from(`data:${i};base64,${a}`),_=async()=>{const l=new Ct(o);this.setTexture(e,l)};o.valid?await _():await new Promise((l,c)=>{o.once("update",async()=>(await _(),l()))});break}}}return Promise.resolve(!0)}catch(e){return G.error(e),Promise.resolve(!1)}}async processAsset(t,e){const s=e.spritesheet;if(!t||!s||!Object.keys(s).length){this.createCollection(e,null);return}const i=async()=>{const r=new wu(t,s);await r.parse(),this.createCollection(e,r)};t.valid?await i():await new Promise((r,a)=>{t.once("update",async()=>(await i(),r()))})}get collections(){return this._collections}};Fo._INSTANCE=new Fo;let Om=Fo;const Me=()=>Om._INSTANCE;class Am{constructor(t,e,s){this.name=t,this.textures=e,this.durations=s}}class ih{}ih.UNKNOWN=0;ih.BROWSER=1;class Da{}Da.UNKNOWN=0;Da.FLASH=1;Da.HTML5=2;class Se{}Se.CONNECTION_OPENED="open";Se.CONNECTION_CLOSED="close";Se.CONNECTION_ERROR="error";Se.CONNECTION_MESSAGE="message";class k{static parseConfiguration(t,e=!1){if(!t)return!1;try{const s=new RegExp(/\${(.*?)}/g);for(const i in t){let r=t[i];typeof r=="string"&&(r=this.interpolate(r,s)),this._definitions.has(i)?e&&this.setValue(i,r):this.setValue(i,r)}return!0}catch(s){return G.error(s.stack),!1}}static interpolate(t,e=null){e||(e=new RegExp(/\${(.*?)}/g));const s=t.match(e);if(s&&s.length)for(const i of s){const r=this._definitions.get(this.removeInterpolateKey(i));r&&(t=t.replace(i,r))}return t}static removeInterpolateKey(t){return t.replace("${","").replace("}","")}static getValue(t,e=null){let s=this._definitions.get(t);if(s===void 0){if(this._missingKeys.indexOf(t)>=0)return e;this._missingKeys.push(t),G.warn(`Missing configuration key: ${t}`),s=e}return s}static setValue(t,e){const s=t.split(".");let i=this._config;for(let r=0;r<s.length;r++){const a=s[r].toString();if(r!==s.length-1){i[a]||(i[a]={}),i=i[a];continue}i[a]=e}this._definitions.set(t,e)}static get definitions(){return this._definitions}}k._definitions=new Map;k._config={};k._missingKeys=[];const B=class hi{static getExpressionTimeout(t){switch(t=parseInt(t),t){case 1:return 5e3;case 2:return 1400;case 3:return 2e3;case 4:return 2e3;case 5:return 0;case 6:return 700;case 7:return 2e3;case 8:return 1500;case 9:return 1500;case 10:return 1500;default:return 0}}static getExpressionId(t){return hi.EXPRESSION_MAP.indexOf(t)}static getExpression(t){return t>hi.EXPRESSION_MAP.length?null:hi.EXPRESSION_MAP[t]}static getGestureId(t){return hi.GESTURE_MAP.indexOf(t)}static getGesture(t){return t>hi.GESTURE_MAP.length?null:hi.GESTURE_MAP[t]}static idToAvatarActionState(t){return t==="Lay"?"lay":t==="Float"?"float":t==="Swim"?"swim":t==="Sit"?"sit":t==="Respect"?"respect":t==="Wave"?"wave":t==="Idle"?"idle":t==="Dance"?"dance":t==="UseItem"?"usei":t==="CarryItem"?"cri":t==="Talk"?"talk":t==="Sleep"?"Sleep":t==="Move"?"mv":"std"}};B.CARRY_OBJECT="cri";B.DANCE="dance";B.EFFECT="fx";B.EXPRESSION="expression";B.EXPRESSION_BLOW_A_KISS="blow";B.EXPRESSION_CRY="cry";B.EXPRESSION_IDLE="idle";B.EXPRESSION_LAUGH="laugh";B.EXPRESSION_RESPECT="respect";B.EXPRESSION_RIDE_JUMP="ridejump";B.EXPRESSION_SNOWBOARD_OLLIE="sbollie";B.EXPRESSION_SNOWBORD_360="sb360";B.EXPRESSION_WAVE="wave";B.GESTURE="gest";B.GESTURE_AGGRAVATED="agr";B.GESTURE_SAD="sad";B.GESTURE_SMILE="sml";B.GESTURE_SURPRISED="srp";B.GUIDE_STATUS="guide";B.MUTED="muted";B.PET_GESTURE_BLINK="eyb";B.PET_GESTURE_CRAZY="crz";B.PET_GESTURE_JOY="joy";B.PET_GESTURE_MISERABLE="mis";B.PET_GESTURE_PUZZLED="puz";B.PET_GESTURE_TONGUE="tng";B.PLAYING_GAME="playing_game";B.POSTURE="posture";B.POSTURE_FLOAT="float";B.POSTURE_LAY="lay";B.POSTURE_SIT="sit";B.POSTURE_STAND="std";B.POSTURE_SWIM="swim";B.POSTURE_WALK="mv";B.SIGN="sign";B.SLEEP="sleep";B.SNOWWAR_DIE_BACK="swdieback";B.SNOWWAR_DIE_FRONT="swdiefront";B.SNOWWAR_PICK="swpick";B.SNOWWAR_RUN="swrun";B.SNOWWAR_THROW="swthrow";B.TALK="talk";B.BLINK="blink";B.TYPING="typing";B.USE_OBJECT="usei";B.VOTE="vote";B.GESTURE_MAP=["",B.GESTURE_SMILE,B.GESTURE_AGGRAVATED,B.GESTURE_SURPRISED,B.GESTURE_SAD,B.PET_GESTURE_JOY,B.PET_GESTURE_CRAZY,B.PET_GESTURE_TONGUE,B.PET_GESTURE_BLINK,B.PET_GESTURE_MISERABLE,B.PET_GESTURE_PUZZLED];B.EXPRESSION_MAP=["",B.EXPRESSION_WAVE,B.EXPRESSION_BLOW_A_KISS,B.EXPRESSION_LAUGH,B.EXPRESSION_CRY,B.EXPRESSION_IDLE,B.DANCE,B.EXPRESSION_RESPECT,B.EXPRESSION_SNOWBOARD_OLLIE,B.EXPRESSION_SNOWBORD_360,B.EXPRESSION_RIDE_JUMP];let w=B;class ts{}ts.DIRECTION_TO_ANGLE=[45,90,135,180,225,270,315,0];ts.DIRECTION_IS_FLIPPED=[!1,!1,!1,!1,!0,!0,!0,!1];ts.MIN_DIRECTION=0;ts.MAX_DIRECTION=7;class Si{}Si.GENERIC="hd";Si.HEAD="head";Si.TORSO="torso";Si.LEGS="legs";Si.HOTLOOKS="hotlooks";Si.WARDROBE="wardrobe";Si.EFFECTS="effects";const et=class{};et.BODY="bd";et.SHOES="sh";et.LEGS="lg";et.CHEST="ch";et.WAIST_ACCESSORY="wa";et.CHEST_ACCESSORY="ca";et.HEAD="hd";et.HAIR="hr";et.FACE_ACCESSORY="fa";et.EYE_ACCESSORY="ea";et.HEAD_ACCESSORY="ha";et.HEAD_ACCESSORY_EXTRA="he";et.COAT_CHEST="cc";et.CHEST_PRINT="cp";et.LEFT_HAND_ITEM="li";et.LEFT_HAND="lh";et.LEFT_SLEEVE="ls";et.RIGHT_HAND="rh";et.RIGHT_SLEEVE="rs";et.FACE="fc";et.EYES="ey";et.HAIR_BIG="hrb";et.RIGHT_HAND_ITEM="ri";et.LEFT_COAT_SLEEVE="lc";et.RIGHT_COAT_SLEEVE="rc";et.FIGURE_SETS=[et.SHOES,et.LEGS,et.CHEST,et.WAIST_ACCESSORY,et.CHEST_ACCESSORY,et.HEAD,et.HAIR,et.FACE_ACCESSORY,et.EYE_ACCESSORY,et.HEAD_ACCESSORY,et.HEAD_ACCESSORY_EXTRA,et.COAT_CHEST,et.CHEST_PRINT];let Oe=et;class we{}we.NONE=0;we.GUIDE=1;we.REQUESTER=2;class es{}es.LARGE="h";es.SMALL="sh";class ie{}ie.FULL="full";ie.HEAD="head";ie.BODY="body";class He{}He.VERTICAL="vertical";He.SITTING="sitting";He.HORIZONTAL="horizontal";He.SWIM="swim";He.SNOWWARS_HORIZONTAL="swhorizontal";class nt{}nt.DOG=0;nt.CAT=1;nt.CROCODILE=2;nt.TERRIER=3;nt.BEAR=4;nt.PIG=5;nt.LION=6;nt.RHINO=7;nt.SPIDER=8;nt.TURTLE=9;nt.CHICKEN=10;nt.FROG=11;nt.DRAGON=12;nt.MONSTER=13;nt.MONKEY=14;nt.HORSE=15;nt.MONSTERPLANT=16;nt.BUNNY=17;nt.BUNNYEVIL=18;nt.BUNNYDEPRESSED=19;nt.BUNNYLOVE=20;nt.PIGEONGOOD=21;nt.PIGEONEVIL=22;nt.DEMONMONKEY=23;nt.BABYBEAR=24;nt.BABYTERRIER=25;nt.GNOME=26;nt.LEPRECHAUN=27;nt.KITTENBABY=28;nt.PUPPYBABY=29;nt.PIGLETNBABY=30;nt.HALOOMPA=31;nt.FOOLS=32;nt.PTEROSAUR=33;nt.VELOCIRAPTOR=34;class Mi{}Mi.NONE=0;Mi.HEART=1;Mi.SMILE=2;Mi.BOBBA=3;Mi.RELATIONSHIP_TYPES=[0,1,2,3];Mi.RELATIONSHIP_NAMES=["None","Heart","Smile","Bobba"];class Fs{}Fs.HOTEL_VIEW="hotel_view";Fs.HOME_ROOM="home_room";Fs.NAVIGATOR="navigator";Fs.CATALOG="catalog";Fs.INVENTORY="inventory";Fs.ME_MENU="me_menu";Fs.FRIEND_LIST="friendlist";class Ci{}Ci.LOVE_LOCK=0;Ci.CARVE_A_TREE=1;Ci.FRIENDS_PORTRAIT=2;Ci.WILD_WEST_WANTED=3;Ci.HABBOWEEN=4;class rh{}rh.CATALOG="catalog";rh.INVENTORY="inventory";class g{}g.OBJECT_ROOM_ID="object_room_id";g.OBJECT_ACCURATE_Z_VALUE="object_accurate_z_value";g.TILE_CURSOR_HEIGHT="tile_cursor_height";g.FIGURE="figure";g.GENDER="gender";g.OWN_USER="own_user";g.FIGURE_CAN_STAND_UP="figure_can_stand_up";g.FIGURE_VERTICAL_OFFSET="figure_vertical_offset";g.FIGURE_TALK="figure_talk";g.FIGURE_DANCE="figure_dance";g.FIGURE_SLEEP="figure_sleep";g.FIGURE_BLINK="figure_blink";g.FIGURE_EFFECT="figure_effect";g.FIGURE_CARRY_OBJECT="figure_carry_object";g.FIGURE_USE_OBJECT="figure_use_object";g.FIGURE_GESTURE="figure_gesture";g.FIGURE_POSTURE="figure_posture";g.FIGURE_POSTURE_PARAMETER="figure_posture_parameter";g.FIGURE_HIGHLIGHT_ENABLE="figure_highlight_enable";g.FIGURE_HIGHLIGHT="figure_highlight";g.FURNITURE_PURCHASER_NAME="furniture_purchaser_name";g.FURNITURE_PURCHASER_FIGURE="furniture_purchaser_figure";g.STD="std";g.FIGURE_SIGN="figure_sign";g.FIGURE_FLAT_CONTROL="figure_flat_control";g.FIGURE_IS_TYPING="figure_is_typing";g.FIGURE_IS_MUTED="figure_is_muted";g.FIGURE_GAINED_EXPERIENCE="figure_gained_experience";g.FIGURE_EXPERIENCE_TIMESTAMP="figure_experience_timestamp";g.FIGURE_NUMBER_VALUE="figure_number_value";g.FIGURE_IS_PLAYING_GAME="figure_is_playing_game";g.FIGURE_GUIDE_STATUS="figure_guide_status";g.FIGURE_EXPRESSION="figure_expression";g.HEAD_DIRECTION="head_direction";g.FURNITURE_CUSTOM_VARIABLES="furniture_custom_variables";g.FURNITURE_AUTOMATIC_STATE_INDEX="furniture_automatic_state_index";g.FURNITURE_ALWAYS_STACKABLE="furniture_always_stackable";g.FURNITURE_DISABLE_PICKING_ANIMATION="furniture_disable_picking_animation";g.FURNITURE_DATA_FORMAT="furniture_data_format";g.FURNITURE_UNIQUE_SERIAL_NUMBER="furniture_unique_serial_number";g.FURNITURE_UNIQUE_EDITION_SIZE="furniture_unique_edition_size";g.FURNITURE_CRACKABLE_STATE="furniture_crackable_state";g.FURNITURE_CRACKABLE_HITS="furniture_crackable_hits";g.FURNITURE_CRACKABLE_TARGET="furniture_crackable_target";g.FURNITURE_CREDIT_VALUE="furniture_credit_value";g.FURNITURE_DATA="furniture_data";g.FURNITURE_ITEMDATA="furniture_itemdata";g.FURNITURE_COLOR="furniture_color";g.FURNITURE_LIFT_AMOUNT="furniure_lift_amount";g.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID="furniture_guild_customized_guild_id";g.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME="furniture_guild_customized_asset_name";g.FURNITURE_GUILD_CUSTOMIZED_COLOR_1="furniture_guild_customized_color_1";g.FURNITURE_GUILD_CUSTOMIZED_COLOR_2="furniture_guild_customized_color_2";g.FURNITURE_STATE_UPDATE_TIME="furniture_state_update_time";g.FURNITURE_SELECTION_DISABLED="furniture_selection_disabled";g.FURNITURE_SIZE_X="furniture_size_x";g.FURNITURE_SIZE_Y="furniture_size_y";g.FURNITURE_SIZE_Z="furniture_size_z";g.FURNITURE_CENTER_X="furniture_center_x";g.FURNITURE_CENTER_Y="furniture_center_y";g.FURNITURE_CENTER_Z="furniture_center_z";g.FURNITURE_ALLOWED_DIRECTIONS="furniture_allowed_directions";g.FURNITURE_AD_URL="furniture_ad_url";g.FURNITURE_TYPE_ID="furniture_type_id";g.FURNITURE_EXTRAS="furniture_extras";g.FURNITURE_EXPIRY_TIME="furniture_expiry_time";g.FURNITURE_EXPIRTY_TIMESTAMP="furniture_expiry_timestamp";g.FURNITURE_REAL_ROOM_OBJECT="furniture_real_room_object";g.FURNITURE_IS_STICKIE="furniture_is_stickie";g.FURNITURE_BRANDING_IMAGE_STATUS="furniture_branding_image_status";g.FURNITURE_BRANDING_IMAGE_URL="furniture_branding_image_url";g.FURNITURE_BRANDING_URL="furniture_branding_url";g.FURNITURE_BRANDING_OFFSET_X="furniture_branding_offset_x";g.FURNITURE_BRANDING_OFFSET_Y="furniture_branding_offset_y";g.FURNITURE_BRANDING_OFFSET_Z="furniture_branding_offset_z";g.FURNITURE_BRANDING_IS_ANIMATED="furniture_branding_is_animated";g.FURNITURE_BADGE_IMAGE_STATUS="furniture_badge_image_status";g.FURNITURE_BADGE_ASSET_NAME="furniture_badge_asset_name";g.FURNITURE_BADGE_VISIBLE_IN_STATE="furniture_badge_visible_in_state";g.FURNITURE_ALPHA_MULTIPLIER="furniture_alpha_multiplier";g.FURNITURE_USAGE_POLICY="furniture_usage_policy";g.FURNITURE_OWNER_ID="furniture_owner_id";g.FURNITURE_OWNER_NAME="furniture_owner_name";g.FURNITURE_ROOM_BACKGROUND_COLOR_HUE="furniture_room_background_color_hue";g.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION="furniture_room_background_color_saturation";g.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS="furniture_room_background_color_lightness";g.FURNITURE_USES_PLANE_MASK="furniture_uses_plane_mask";g.FURNITURE_PLANE_MASK_TYPE="furniture_plane_mask_type";g.FURNITURE_IS_VARIABLE_HEIGHT="furniture_is_variable_height";g.FURNITURE_VOTE_MAJORITY_RESULT="furniture_vote_majority_result";g.FURNITURE_VOTE_COUNTER_COUNT="furniture_vote_counter_count";g.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED="furniture_soundblock_relative_animation_speed";g.FURNITURE_MANNEQUIN_NAME="furniture_mannequin_name";g.FURNITURE_MANNEQUIN_GENDER="furniture_mannequin_gender";g.FURNITURE_MANNEQUIN_FIGURE="furniture_mannequin_figure";g.FURNITURE_HIGHSCORE_SCORE_TYPE="furniture_highscore_score_type";g.FURNITURE_HIGHSCORE_CLEAR_TYPE="furniture_highscore_clear_type";g.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT="furniture_highscore_data_entry_count";g.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_="furniture_highscore_data_entry_base_users_";g.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_="furniture_highscore_data_entry_base_score_";g.FURNITURE_INTERNAL_LINK="furniture_internal_link";g.FURNITURE_CLOTHING_BOY="furniture_clothing_boy";g.FURNITURE_CLOTHING_GIRL="furniture_clothing_girl";g.FURNITURE_PLANETSYSTEM_DATA="furniture_planetsystem_data";g.FURNITURE_FIREWORKS_DATA="furniture_fireworks_data";g.PET_PALETTE_INDEX="pet_palette_index";g.PET_COLOR="pet_color";g.PET_HEAD_ONLY="pet_head_only";g.PET_CUSTOM_LAYER_IDS="pet_custom_layer_ids";g.PET_CUSTOM_PARTS_IDS="pet_custom_part_ids";g.PET_CUSTOM_PALETTE_IDS="pet_custom_palette_ids";g.PET_IS_RIDING="pet_is_riding";g.PET_TYPE="pet_type";g.PET_ALLOWED_DIRECTIONS="pet_allowed_directions";g.RACE="race";g.ROOM_MAP_DATA="room_map_data";g.ROOM_PLANE_MASK_XML="room_plane_mask_xml";g.ROOM_FLOOR_TYPE="room_floor_type";g.ROOM_WALL_TYPE="room_wall_type";g.ROOM_LANDSCAPE_TYPE="room_landscape_type";g.ROOM_WALL_THICKNESS="room_wall_thickness";g.ROOM_FLOOR_THICKNESS="room_floor_thickness";g.ROOM_FLOOR_HOLE_UPDATE_TIME="room_floor_hole_update_time";g.ROOM_FLOOR_VISIBILITY="room_floor_visibility";g.ROOM_WALL_VISIBILITY="room_wall_visibility";g.ROOM_LANDSCAPE_VISIBILITY="room_landscape_visibility";g.ROOM_DOOR_X="room_door_x";g.ROOM_DOOR_Y="room_door_y";g.ROOM_DOOR_Z="room_door_z";g.ROOM_DOOR_DIR="room_door_dir";g.ROOM_BACKGROUND_COLOR="room_background_color";g.ROOM_COLORIZE_BG_ONLY="room_colorize_bg_only";g.ROOM_RANDOM_SEED="room_random_seed";g.ROOM_WORLD_TYPE="room_world_type";g.ROOM_SELECTED_X="room_selected_x";g.ROOM_SELECTED_Y="room_selected_y";g.ROOM_SELECTED_Z="room_selected_z";g.ROOM_SELECTED_PLANE="room_selected_plane";g.IMAGE_QUERY_SCALE="image_query_scale";g.FURNITURE_FRIENDFURNI_ENGRAVING="furniture_friendfurni_engraving_type";g.SESSION_URL_PREFIX="session_url_prefix";g.SESSION_CURRENT_USER_ID="session_current_user_id";class Zu{}Zu.UNIQUE_SET=256;class ri{constructor(){this._flags=0,this._uniqueNumber=0,this._uniqueSeries=0}parseWrapper(t){(this._flags&Zu.UNIQUE_SET)>0&&(this._uniqueNumber=t.readInt(),this._uniqueSeries=t.readInt())}initializeFromRoomObjectModel(t){this._uniqueNumber=t.getValue(g.FURNITURE_UNIQUE_SERIAL_NUMBER),this._uniqueSeries=t.getValue(g.FURNITURE_UNIQUE_EDITION_SIZE)}writeRoomObjectModel(t){t&&(t.setValue(g.FURNITURE_UNIQUE_SERIAL_NUMBER,this._uniqueNumber),t.setValue(g.FURNITURE_UNIQUE_EDITION_SIZE,this._uniqueSeries))}getLegacyString(){return""}compare(t){return!1}get state(){const t=parseInt(this.getLegacyString());return isNaN(t)?0:t}get isUnique(){return this._uniqueSeries>0}get uniqueNumber(){return this._uniqueNumber}set uniqueNumber(t){this._uniqueNumber=t}get uniqueSeries(){return this._uniqueSeries}set uniqueSeries(t){this._uniqueSeries=t}get rarityLevel(){return-1}get flags(){return this._flags}set flags(t){this._flags=t}}class ne{}ne.LEGACY_KEY=0;ne.MAP_KEY=1;ne.STRING_KEY=2;ne.VOTE_KEY=3;ne.EMPTY_KEY=4;ne.NUMBER_KEY=5;ne.HIGHSCORE_KEY=6;ne.CRACKABLE_KEY=7;const $u=class tl extends ri{constructor(){super(),this._state="",this._hits=0,this._target=0}parseWrapper(t){t&&(this._state=t.readString(),this._hits=t.readInt(),this._target=t.readInt(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._state=t.getValue(g.FURNITURE_CRACKABLE_STATE),this._hits=t.getValue(g.FURNITURE_CRACKABLE_HITS),this._target=t.getValue(g.FURNITURE_CRACKABLE_TARGET)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(g.FURNITURE_DATA_FORMAT,tl.FORMAT_KEY),t.setValue(g.FURNITURE_CRACKABLE_STATE,this._state),t.setValue(g.FURNITURE_CRACKABLE_HITS,this._hits),t.setValue(g.FURNITURE_CRACKABLE_TARGET,this._target)}getLegacyString(){return this._state}compare(t){return!0}get hits(){return this._hits}get target(){return this._target}};$u.FORMAT_KEY=ne.CRACKABLE_KEY;let lu=$u;const el=class sl extends ri{parseWrapper(t){t&&(this._state="",super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(g.FURNITURE_DATA_FORMAT,sl.FORMAT_KEY)}getLegacyString(){return this._state}compare(t){return super.compare(t)}};el.FORMAT_KEY=ne.EMPTY_KEY;let cu=el;class du{constructor(){this._score=-1,this._users=[]}get score(){return this._score}set score(t){this._score=t}get users(){return this._users}set users(t){this._users=t}addUsername(t){this._users.push(t)}}const il=class rl extends ri{constructor(){super(),this._state="",this._scoreType=-1,this._clearType=-1,this._entries=[]}parseWrapper(t){if(!t)return;this._state=t.readString(),this._scoreType=t.readInt(),this._clearType=t.readInt();let e=t.readInt();for(;e>0;){const s=new du;s.score=t.readInt();let i=t.readInt();for(;i>0;)s.addUsername(t.readString()),i--;this._entries.push(s),e--}super.parseWrapper(t)}initializeFromRoomObjectModel(t){this._scoreType=t.getValue(g.FURNITURE_HIGHSCORE_SCORE_TYPE),this._clearType=t.getValue(g.FURNITURE_HIGHSCORE_CLEAR_TYPE),this._entries=[];const e=t.getValue(g.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT);let s=0;for(;s<e;){const i=new du;i.score=t.getValue(g.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+s),i.users=t.getValue(g.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+s),this._entries.push(i),s++}super.initializeFromRoomObjectModel(t)}writeRoomObjectModel(t){if(super.writeRoomObjectModel(t),t.setValue(g.FURNITURE_DATA_FORMAT,rl.FORMAT_KEY),t.setValue(g.FURNITURE_HIGHSCORE_SCORE_TYPE,this._scoreType),t.setValue(g.FURNITURE_HIGHSCORE_CLEAR_TYPE,this._clearType),this._entries){t.setValue(g.FURNITURE_HIGHSCORE_DATA_ENTRY_COUNT,this._entries.length);let e=0;for(;e<this._entries.length;){const s=this._entries[e];t.setValue(g.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_SCORE_+e,s.score),t.setValue(g.FURNITURE_HIGHSCORE_DATA_ENTRY_BASE_USERS_+e,s.users),e++}}}getLegacyString(){return this._state}get entries(){return this._entries}get clearType(){return this._clearType}get scoreType(){return this._scoreType}};il.FORMAT_KEY=ne.HIGHSCORE_KEY;let gu=il;const nl=class al extends ri{constructor(){super(),this._data=""}parseWrapper(t){t&&(this._data=t.readString(),super.parseWrapper(t))}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(g.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(g.FURNITURE_DATA_FORMAT,al.FORMAT_KEY),t.setValue(g.FURNITURE_DATA,this._data)}getLegacyString(){return this._data}compare(t){return this._data===t.getLegacyString()}setString(t){this._data=t}};nl.FORMAT_KEY=ne.LEGACY_KEY;let Re=nl;const Pa=class bn extends ri{constructor(){super(),this._data={}}parseWrapper(t){if(!t)return;this._data={};const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data[t.readString()]=t.readString();super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(g.FURNITURE_DATA)||{}}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(g.FURNITURE_DATA_FORMAT,bn.FORMAT_KEY),t.setValue(g.FURNITURE_DATA,this._data)}getLegacyString(){if(!this._data)return"";const t=this._data[bn.STATE];return t??""}compare(t){return!1}getValue(t){return this._data[t]}get rarityLevel(){if(!this._data)return-1;const t=this._data[bn.RARITY];return t==null?-1:parseInt(t)}get data(){return this._data}};Pa.FORMAT_KEY=ne.MAP_KEY;Pa.STATE="state";Pa.RARITY="rarity";let Yr=Pa;const nh=class Fn extends ri{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readInt());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(g.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(g.FURNITURE_DATA_FORMAT,Fn.FORMAT_KEY),t.setValue(g.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[Fn.STATE].toString()}compare(t){if(!(t instanceof Fn))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==t.getValue(e))return!1}e++}return!0}getValue(t){if(!this._data||!this._data.length)return-1;const e=this._data[t];return e??-1}};nh.FORMAT_KEY=ne.NUMBER_KEY;nh.STATE=0;let xo=nh;const ah=class xn extends ri{constructor(){super(),this._data=[]}parseWrapper(t){if(!t)return;this._data=[];const e=t.readInt();if(e)for(let s=0;s<e;s++)this._data.push(t.readString());super.parseWrapper(t)}initializeFromRoomObjectModel(t){super.initializeFromRoomObjectModel(t),this._data=t.getValue(g.FURNITURE_DATA)}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(g.FURNITURE_DATA_FORMAT,xn.FORMAT_KEY),t.setValue(g.FURNITURE_DATA,this._data)}getLegacyString(){return!this._data||!this._data.length?"":this._data[xn.STATE]}compare(t){if(!(t instanceof xn))return!1;let e=0;for(;e<this._data.length;){if(e!==0){if(this._data[e]!==t.getValue(e))return!1}e++}return!0}getValue(t){return this._data[t]||""}setValue(t){this._data=t}};ah.FORMAT_KEY=ne.STRING_KEY;ah.STATE=0;let ea=ah;const ol=class _l extends ri{constructor(){super(),this._state="",this._result=0}parseWrapper(t){t&&(this._state=t.readString(),this._result=t.readInt(),super.parseWrapper(t))}writeRoomObjectModel(t){super.writeRoomObjectModel(t),t.setValue(g.FURNITURE_DATA_FORMAT,_l.FORMAT_KEY);const e={};e.S=this._state,e.R=this._result.toString(),t.setValue(g.FURNITURE_DATA,e)}getLegacyString(){return this._state}compare(t){return!0}setString(t){this._state=t}get result(){return this._result}};ol.FORMAT_KEY=ne.VOTE_KEY;let Go=ol;class $s{static getData(t){let e=null;switch(t&255){case lu.FORMAT_KEY:e=new lu;break;case cu.FORMAT_KEY:e=new cu;break;case gu.FORMAT_KEY:e=new gu;break;case Re.FORMAT_KEY:e=new Re;break;case Yr.FORMAT_KEY:e=new Yr;break;case xo.FORMAT_KEY:e=new xo;break;case ea.FORMAT_KEY:e=new ea;break;case Go.FORMAT_KEY:e=new Go;break}return e?(e.flags=t&65280,e):null}}class S{}S.MINIMUM=-2;S.ROOM=0;S.FLOOR=10;S.WALL=20;S.UNIT=100;S.CURSOR=200;class M{}M.FURNITURE_BASIC="furniture_basic";M.FURNITURE_MULTISTATE="furniture_multistate";M.FURNITURE_MULTIHEIGHT="furniture_multiheight";M.FURNITURE_RANDOMSTATE="furniture_randomstate";M.FURNITURE_PLACEHOLDER="furniture_placeholder";M.FURNITURE_CREDIT="furniture_credit";M.FURNITURE_STICKIE="furniture_stickie";M.FURNITURE_PRESENT="furniture_present";M.FURNITURE_TROPHY="furniture_trophy";M.FURNITURE_ECOTRON_BOX="furniture_ecotron_box";M.FURNITURE_DICE="furniture_dice";M.FURNITURE_HOCKEY_SCORE="furniture_hockey_score";M.FURNITURE_HABBOWHEEL="furniture_habbowheel";M.FURNITURE_ONE_WAY_DOOR="furniture_one_way_door";M.FURNITURE_PLANET_SYSTEM="furniture_planet_system";M.FURNITURE_WINDOW="furniture_window";M.FURNITURE_EXTERNAL_IMAGE_WALLITEM="furniture_external_image_wallitem";M.FURNITURE_ROOMDIMMER="furniture_roomdimmer";M.FURNITURE_SOUND_MACHINE="furniture_sound_machine";M.FURNITURE_JUKEBOX="furniture_jukebox";M.FURNITURE_CRACKABLE="furniture_crackable";M.FURNITURE_PUSHABLE="furniture_pushable";M.FURNITURE_CLOTHING_CHANGE="furniture_clothing_change";M.FURNITURE_COUNTER_CLOCK="furniture_counter_clock";M.FURNITURE_SCORE="furniture_score";M.FURNITURE_ES="furniture_es";M.FURNITURE_FIREWORKS="furniture_fireworks";M.FURNITURE_SONG_DISK="furniture_song_disk";M.FURNITURE_BB="furniture_bb";M.FURNITURE_BG="furniture_bg";M.FURNITURE_WELCOME_GIFT="furniture_welcome_gift";M.FURNITURE_FLOOR_HOLE="furniture_floor_hole";M.FURNITURE_MANNEQUIN="furniture_mannequin";M.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized";M.FURNITURE_GROUP_FORUM_TERMINAL="furniture_group_forum_terminal";M.FURNITURE_PET_CUSTOMIZATION="furniture_pet_customization";M.FURNITURE_CUCKOO_CLOCK="furniture_cuckoo_clock";M.FURNITURE_VOTE_COUNTER="furniture_vote_counter";M.FURNITURE_VOTE_MAJORITY="furniture_vote_majority";M.FURNITURE_SOUNDBLOCK="furniture_soundblock";M.FURNITURE_RANDOM_TELEPORT="furniture_random_teleport";M.FURNITURE_MONSTERPLANT_SEED="furniture_monsterplant_seed";M.FURNITURE_PURCHASABLE_CLOTHING="furniture_purchasable_clothing";M.FURNITURE_BACKGROUND_COLOR="furniture_background_color";M.FURNITURE_MYSTERYBOX="furniture_mysterybox";M.FURNITURE_EFFECTBOX="furniture_effectbox";M.FURNITURE_MYSTERYTROPHY="furniture_mysterytrophy";M.FURNITURE_ACHIEVEMENT_RESOLUTION="furniture_achievement_resolution";M.FURNITURE_LOVELOCK="furniture_lovelock";M.FURNITURE_WILDWEST_WANTED="furniture_wildwest_wanted";M.FURNITURE_HWEEN_LOVELOCK="furniture_hween_lovelock";M.FURNITURE_BADGE_DISPLAY="furniture_badge_display";M.FURNITURE_HIGH_SCORE="furniture_high_score";M.FURNITURE_INTERNAL_LINK="furniture_internal_link";M.FURNITURE_CUSTOM_STACK_HEIGHT="furniture_custom_stack_height";M.FURNITURE_YOUTUBE="furniture_youtube";M.FURNITURE_RENTABLE_SPACE="furniture_rentable_space";M.FURNITURE_CHANGE_STATE_WHEN_STEP_ON="furniture_change_state_when_step_on";M.FURNITURE_VIMEO="furniture_vimeo";M.FURNITURE_EDITABLE_INTERNAL_LINK="furniture_editable_internal_link";M.FURNITURE_EDITABLE_ROOM_LINK="furniture_editable_room_link";M.FURNITURE_CRAFTING_GIZMO="furniture_crafting_gizmo";M.ROOM="room";M.USER="user";M.BOT="bot";M.RENTABLE_BOT="rentable_bot";M.PET="pet";M.TILE_CURSOR="tile_cursor";M.SELECTION_ARROW="selection_arrow";M.GAME_SNOWBALL="game_snowball";M.GAME_SNOWSPLASH="game_snowsplash";class X{}X.OBJECT_UNDEFINED="OBJECT_UNDEFINED";X.OBJECT_MOVE="OBJECT_MOVE";X.OBJECT_PLACE="OBJECT_PLACE";X.OBJECT_ROTATE_POSITIVE="OBJECT_ROTATE_POSITIVE";X.OBJECT_ROTATE_NEGATIVE="OBJECT_ROTATE_NEGATIVE";X.OBJECT_MOVE_TO="OBJECT_MOVE_TO";X.OBJECT_PLACE_TO="OBJECT_PLACE_TO";X.OBJECT_PICKUP="OBJECT_PICKUP";X.OBJECT_PICKUP_BOT="OBJECT_PICKUP_BOT";X.OBJECT_PICKUP_PET="OBJECT_PICKUP_PET";X.OBJECT_EJECT="OBJECT_EJECT";X.OBJECT_SAVE_STUFF_DATA="OBJECT_SAVE_STUFF_DATA";class je{}je.USER=1;je.PET=2;je.BOT=3;je.RENTABLE_BOT=4;const Ni=class ui{static getTypeNumber(t){return ui.AVATAR_TYPES[t]}static getTypeString(t){for(const e in ui.AVATAR_TYPES)if(e&&ui.AVATAR_TYPES[e]===t)return e;return null}static getRealType(t){switch(t){case ui.BOT:case ui.RENTABLE_BOT:return ui.USER;default:return t}}};Ni.USER="user";Ni.PET="pet";Ni.BOT="bot";Ni.RENTABLE_BOT="rentable_bot";Ni.MONSTER_PLANT="monsterplant";Ni.AVATAR_TYPES={user:1,pet:2,bot:3,rentable_bot:4};let lt=Ni;class P{}P.FURNITURE_STATIC="furniture_static";P.FURNITURE_ANIMATED="furniture_animated";P.FURNITURE_RESETTING_ANIMATED="furniture_resetting_animated";P.FURNITURE_POSTER="furniture_poster";P.FURNITURE_EXTERNAL_IMAGE="furniture_external_image";P.FURNITURE_HABBOWHEEL="furniture_habbowheel";P.FURNITURE_VAL_RANDOMIZER="furniture_val_randomizer";P.FURNITURE_BOTTLE="furniture_bottle";P.FURNITURE_PLANET_SYSTEM="furniture_planet_system";P.FURNITURE_QUEUE_TILE="furniture_queue_tile";P.FURNITURE_PARTY_BEAMER="furniture_party_beamer";P.FURNITURE_CUBOID="furniture_cuboid";P.FURNITURE_GIFT_WRAPPED="furniture_gift_wrapped";P.FURNITURE_GIFT_WRAPPED_FIREWORKS="furniture_gift_wrapped_fireworks";P.FURNITURE_COUNTER_CLOCK="furniture_counter_clock";P.FURNITURE_WATER_AREA="furniture_water_area";P.FURNITURE_SCORE_BOARD="furniture_score_board";P.FURNITURE_FIREWORKS="furniture_fireworks";P.FURNITURE_BB="furniture_bb";P.FURNITURE_ISOMETRIC_BB="furniture_isometric_bb";P.FURNITURE_BG="furniture_bg";P.FURNITURE_STICKIE="furniture_stickie";P.FURNITURE_MANNEQUIN="furniture_mannequin";P.FURNITURE_GUILD_CUSTOMIZED="furniture_guild_customized";P.FURNITURE_GUILD_ISOMETRIC_BADGE="furniture_guild_isometric_badge";P.FURNITURE_VOTE_COUNTER="furniture_vote_counter";P.FURNITURE_VOTE_MAJORITY="furniture_vote_majority";P.FURNITURE_SOUNDBLOCK="furniture_soundblock";P.FURNITURE_BADGE_DISPLAY="furniture_badge_display";P.FURNITURE_YOUTUBE="furniture_youtube";P.FURNITURE_BUILDER_PLACEHOLDER="furniture_builder_placeholder";P.ROOM="room";P.USER="user";P.PET_ANIMATED="pet_animated";P.BOT="bot";P.RENTABLE_BOT="rentable_bot";P.TILE_CURSOR="tile_cursor";class Ms{constructor(t,e,s,i=null){this._id=t,this._location=e,this._targetLocation=s,this._movementType=i}get id(){return this._id}get location(){return this._location}get targetLocation(){return this._targetLocation}get movementType(){return this._movementType}}Ms.MOVE="mv";Ms.SLIDE="sld";class oh{}oh.KICKED_OUT_OF_ROOM=4008;oh.STRIP_LOCKED_FOR_TRADING=-13001;class er{}er.OLD_IDENTITY=0;er.NEW_IDENTITY=1;er.REAL_NOOB=2;class Ie{}Ie.NONE=0;Ie.GUEST=1;Ie.GUILD_MEMBER=2;Ie.GUILD_ADMIN=3;Ie.ROOM_OWNER=4;Ie.MODERATOR=5;const ya=class Gn{static getLocalizationKey(t){switch(t){case Gn.FREE_TRADING:return"${trading.mode.free}";case Gn.ROOM_CONTROLLER_REQUIRED:return"${trading.mode.controller}";case Gn.NO_TRADING:return"${trading.mode.not.allowed}"}return""}};ya.NO_TRADING=0;ya.ROOM_CONTROLLER_REQUIRED=1;ya.FREE_TRADING=2;let Sm=ya;class ke{}ke.SUPER_USER=9;ke.ADMINISTRATOR=8;ke.COMMUNITY=7;ke.PLAYER_SUPPORT=6;ke.MODERATOR=5;ke.EMPLOYEE=4;ke.BUS_PARTNER=3;ke.PARTNER=2;ke.CELEBRITY=1;ke.NONE=0;var Ii=(n=>(n.FLOOR="S",n.WALL="I",n.EFFECT="E",n.BADGE="B",n.ROBOT="R",n.HABBO_CLUB="H",n.PET="P",n))(Ii||{});class Ne{}Ne.MATCH_ALL_PIXELS=-1;Ne.MATCH_OPAQUE_PIXELS=128;Ne.MATCH_NOTHING=256;class he{}he.DEFAULT=1;he.ROOM_PLANE=2;he.AVATAR=3;he.AVATAR_OWN=4;class hl{}class R{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s,this._length=NaN}static sum(t,e){return!t||!e?null:new R(t.x+e.x,t.y+e.y,t.z+e.z)}static dif(t,e){return!t||!e?null:new R(t.x-e.x,t.y-e.y,t.z-e.z)}static product(t,e){return t?new R(t.x*e,t.y*e,t.z*e):null}static dotProduct(t,e){return!t||!e?0:t.x*e.x+t.y*e.y+t.z*e.z}static crossProduct(t,e){return!t||!e?null:new R(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)}static scalarProjection(t,e){if(!t||!e)return-1;const s=e.length;return s>0?(t.x*e.x+t.y*e.y+t.z*e.z)/s:-1}static cosAngle(t,e){if(!t||!e)return 0;const s=t.length*e.length;return s?R.dotProduct(t,e)/s:0}static isEqual(t,e){return!(!t||!e||t.x!==e.x||t.y!==e.y||t.z!==e.z)}negate(){this._x=-this._x,this._y=-this._y,this._z=-this._z}add(t){t&&(this._x+=t.x,this._y+=t.y,this._z+=t.z,this._length=NaN)}subtract(t){t&&(this._x-=t.x,this._y-=t.y,this._z-=t.z,this._length=NaN)}multiply(t){this._x*=t,this._y*=t,this._z*=t,this._length=NaN}divide(t){t&&(this._x/=t,this._y/=t,this._z/=t,this._length=NaN)}assign(t){t&&(this._x=t.x,this._y=t.y,this._z=t.z,this._length=NaN)}get x(){return this._x}set x(t){this._x=t,this._length=NaN}get y(){return this._y}set y(t){this._y=t,this._length=NaN}get z(){return this._z}set z(t){this._z=t,this._length=NaN}get length(){return isNaN(this._length)&&(this._length=Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)),this._length}toString(){return`[Vector3d: ${this._x}, ${this._y}, ${this._z}]`}}class F{}F.MOUSE_CLICK="click";F.DOUBLE_CLICK="double_click";F.MOUSE_MOVE="mousemove";F.MOUSE_DOWN="mousedown";F.MOUSE_DOWN_LONG="mousedown_long";F.MOUSE_UP="mouseup";F.ROLL_OVER="mouseover";F.ROLL_OUT="mouseout";F.RIGHT_CLICK="contextmenu";class tn{}tn.TOUCH_START="touchstart";tn.TOUCH_MOVE="touchmove";tn.TOUCH_CANCEL="touchcancel";tn.TOUCH_END="touchend";tn.TOUCH_LONG="touchlong";const Zt=class{constructor(t){this._ordinal=t}get ordinal(){return this._ordinal}equals(t){return t&&t._ordinal==this._ordinal}};Zt.NONE=new Zt(0);Zt.WAVE=new Zt(1);Zt.BLOW=new Zt(2);Zt.LAUGH=new Zt(3);Zt.CRY=new Zt(4);Zt.IDLE=new Zt(5);Zt.JUMP=new Zt(6);Zt.RESPECT=new Zt(7);let Rj=Zt;class $t{}$t.DUMMY="DUMMY";$t.FRIEND_FURNITURE="FRIEND_FURNITURE";$t.MONSTERPLANT_SEED="MONSTERPLANT_SEED";$t.MYSTERY_BOX="MYSTERY_BOX";$t.EFFECT_BOX="EFFECT_BOX";$t.MYSTERY_TROPHY="MYSTERY_TROPHY";$t.RANDOM_TELEPORT="RANDOM_TELEPORT";$t.PURCHASABLE_CLOTHING="PURCHASABLE_CLOTHING";$t.GENERIC_USABLE="GENERIC_USABLE";class z{}z.CHAT_WIDGET="RWE_CHAT_WIDGET";z.INFOSTAND="RWE_INFOSTAND";z.ME_MENU="RWE_ME_MENU";z.CHAT_INPUT_WIDGET="RWE_CHAT_INPUT_WIDGET";z.FURNI_PLACEHOLDER="RWE_FURNI_PLACEHOLDER";z.FURNI_CREDIT_WIDGET="RWE_FURNI_CREDIT_WIDGET";z.FURNI_STICKIE_WIDGET="RWE_FURNI_STICKIE_WIDGET";z.FURNI_TROPHY_WIDGET="RWE_FURNI_TROPHY_WIDGET";z.FURNI_LOVELOCK_WIDGET="RWE_FURNI_LOVELOCK_WIDGET";z.FURNI_PRESENT_WIDGET="RWE_FURNI_PRESENT_WIDGET";z.FURNI_ECOTRONBOX_WIDGET="RWE_FURNI_ECOTRONBOX_WIDGET";z.FURNI_PET_PACKAGE_WIDGET="RWE_FURNI_PET_PACKAGE_WIDGET";z.PLAYLIST_EDITOR_WIDGET="RWE_PLAYLIST_EDITOR_WIDGET";z.DOORBELL="RWE_DOORBELL";z.LOADINGBAR="RWE_LOADINGBAR";z.ROOM_QUEUE="RWE_ROOM_QUEUE";z.ROOM_POLL="RWE_ROOM_POLL";z.ROOM_VOTE="RWE_ROOM_VOTE";z.USER_CHOOSER="RWE_USER_CHOOSER";z.FURNI_CHOOSER="RWE_FURNI_CHOOSER";z.ROOM_DIMMER="RWE_ROOM_DIMMER";z.FRIEND_REQUEST="RWE_FRIEND_REQUEST";z.CLOTHING_CHANGE="RWE_CLOTHING_CHANGE";z.CONVERSION_TRACKING="RWE_CONVERSION_TRACKING";z.USER_NOTIFICATION="RWE_USER_NOTIFICATION";z.FRIENDS_BAR="RWE_FRIENDS_BAR";z.PURSE_WIDGET="RWE_PURSE_WIDGET";z.AVATAR_INFO="RWE_AVATAR_INFO";z.WELCOME_GIFT="RWE_WELCOME_GIFT";z.SPAMWALL_POSTIT_WIDGET="RWE_SPAMWALL_POSTIT_WIDGET";z.EFFECTS="RWE_EFFECTS";z.MANNEQUIN="RWE_MANNEQUIN";z.FURNITURE_CONTEXT_MENU="RWE_FURNITURE_CONTEXT_MENU";z.LOCATION_WIDGET="RWE_LOCATION_WIDGET";z.CAMERA="RWE_CAMERA";z.ROOM_THUMBNAIL_CAMERA="RWE_ROOM_THUMBNAIL_CAMERA";z.ROOM_BACKGROUND_COLOR="RWE_ROOM_BACKGROUND_COLOR";z.CUSTOM_USER_NOTIFICATION="RWE_CUSTOM_USER_NOTIFICATION";z.FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING="RWE_FURNI_ACHIEVEMENT_RESOLUTION_ENGRAVING";z.FRIEND_FURNI_CONFIRM="RWE_FRIEND_FURNI_CONFIRM";z.FRIEND_FURNI_ENGRAVING="RWE_FRIEND_FURNI_ENGRAVING";z.HIGH_SCORE_DISPLAY="RWE_HIGH_SCORE_DISPLAY";z.INTERNAL_LINK="RWE_INTERNAL_LINK";z.CUSTOM_STACK_HEIGHT="RWE_CUSTOM_STACK_HEIGHT";z.YOUTUBE="RWE_YOUTUBE";z.RENTABLESPACE="RWE_RENTABLESPACE";z.VIMEO="RWE_VIMEO";z.ROOM_TOOLS="RWE_ROOM_TOOLS";z.EXTERNAL_IMAGE="RWE_EXTERNAL_IMAGE";z.WORD_QUIZZ="RWE_WORD_QUIZZ";z.UI_HELP_BUBBLE="RWE_UI_HELP_BUBBLE";z.ROOM_LINK="RWE_ROOM_LINK";z.CRAFTING="RWE_CRAFTING";z.ROOMGAME_CHECKERS="RWE_GAME_CHECKERS";class Yt{}Yt.INFOSTAND_EXTRA_PARAM="RWEIEP_INFOSTAND_EXTRA_PARAM";Yt.JUKEBOX="RWEIEP_JUKEBOX";Yt.USABLE_PRODUCT="RWEIEP_USABLE_PRODUCT";Yt.SONGDISK="RWEIEP_SONGDISK";Yt.CRACKABLE_FURNI="RWEIEP_CRACKABLE_FURNI";Yt.BRANDING_OPTIONS="RWEIEP_BRANDING_OPTIONS";Yt.USABLE="RWEIEP_USABLE";class _h{}_h.NOBODY=0;_h.CONTROLLER=1;_h.EVERYBODY=2;class qs{}qs.NORMAL=0;qs.GENERIC=1;qs.BOT=2;class ge{constructor(){this._isDisposed=!1,this._isDisposing=!1}dispose(){this._isDisposed||this._isDisposing||(this._isDisposing=!0,this.onDispose(),this._isDisposed=!0,this._isDisposing=!1)}onDispose(){}get disposed(){return this._isDisposed}get isDisposing(){return this._isDisposing}}class pe extends ge{constructor(){super(),this._listeners=new Map}onDispose(){this.removeAllListeners(),super.onDispose()}addEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(!s){this._listeners.set(t,[e]);return}s.push(e)}removeEventListener(t,e){if(!t||!e)return;const s=this._listeners.get(t);if(!(!s||!s.length)){for(const[i,r]of s.entries())if(!(!r||r!==e)){s.splice(i,1),s.length||this._listeners.delete(t);return}}}dispatchEvent(t){return t?(G.events("Dispatched Event",t.type),this.processEvent(t),!0):!1}processEvent(t){const e=this._listeners.get(t.type);if(!e||!e.length)return;const s=[];for(const i of e)i&&s.push(i);for(;s.length;){const i=s.shift();try{i(t)}catch(r){G.error(r.stack);return}}}removeAllListeners(){this._listeners.clear()}}class ns extends ge{constructor(){super(),this._events=new pe,this._isLoaded=!1,this._isLoading=!1}init(){this._isLoaded||this._isLoading||this.isDisposing||(this._isLoading=!0,this.onInit(),this._isLoaded=!0,this._isLoading=!1)}onInit(){}onDispose(){this._events&&this._events.dispose(),super.onDispose()}reload(){this.dispose(),this.init()}get events(){return this._events}get isLoaded(){return this._isLoaded}get isLoading(){return this._isLoading}}class Mm{constructor(t){this._value=t}get value(){return this._value}}class Cm{constructor(t,e){this._header=t,this._buffer=e}readBytes(t){return this._buffer?this._buffer.readBytes(t):null}readByte(){return this._buffer?this._buffer.readByte():-1}readBoolean(){return this.readByte()===1}readShort(){return this._buffer?this._buffer.readShort():-1}readInt(){return this._buffer?this._buffer.readInt():-1}readFloat(){return this._buffer?this._buffer.readFloat():-1}readDouble(){return this._buffer?this._buffer.readDouble():-1}readString(){const t=this.readShort();return this._buffer.readBytes(t).toString("utf8")}get header(){return this._header}get bytesAvailable(){return this._buffer&&this._buffer.remaining()>0}}class Nm{constructor(t){this._value=t}get value(){return this._value}}class Dm{encode(t,e){const s=new hu;s.writeShort(t);for(const r of e){let a=typeof r;switch(a==="object"&&(r===null?a="null":r instanceof Mm?a="byte":r instanceof Nm?a="short":r instanceof ArrayBuffer&&(a="arraybuffer")),a){case"undefined":case"null":s.writeShort(0);break;case"byte":s.writeByte(r.value);break;case"short":s.writeShort(r.value);break;case"number":s.writeInt(r);break;case"boolean":s.writeByte(r?1:0);break;case"string":r?s.writeString(r,!0):s.writeShort(0);break;case"arraybuffer":s.writeBytes(r);break}}const i=s.getBuffer();return i?new hu().writeInt(i.byteLength).writeBytes(i):null}decode(t){if(!t||!t.dataBuffer||!t.dataBuffer.byteLength)return null;const e=[];for(;t.dataBuffer.byteLength&&!(t.dataBuffer.byteLength<4);){const s=new Ca(t.dataBuffer),i=s.readInt();if(i>t.dataBuffer.byteLength-4)break;const r=s.readBytes(i);e.push(new Cm(r.readShort(),r)),t.dataBuffer=t.dataBuffer.slice(i+4)}return e}}class f{constructor(t,e){this._callBack=t,this._parserClass=e,this._parser=null,this._connection=null}dispose(){this._callBack=null,this._parserClass=null,this._parser=null,this._connection=null}get callBack(){return this._callBack}get parserClass(){return this._parserClass}get parser(){return this._parser}set parser(t){this._parser=t}get connection(){return this._connection}set connection(t){this._connection=t}}class rt{constructor(t){this._type=t}get type(){return this._type}}class Bt extends rt{constructor(t,e,s){super(t),this._connection=e,this._originalEvent=event}get connection(){return this._connection}get originalEvent(){return this._originalEvent}}Bt.CONNECTION_OPENED="SCE_OPEN";Bt.CONNECTION_CLOSED="SCE_CLOSED";Bt.CONNECTION_ERROR="SCE_ERROR";Bt.CONNECTION_MESSAGE="SCE_MESSAGE";class qi extends rt{constructor(t,e){super(t),this._library=e}get library(){return this._library}}qi.DOWNLOAD_COMPLETE="ARELE_DOWNLOAD_COMPLETE";class La{}La.AVATAR_RENDER_READY="AVATAR_RENDER_READY";class Qi extends rt{constructor(t,e){super(t),this._library=e}get library(){return this._library}}Qi.DOWNLOAD_COMPLETE="ARLE_DOWNLOAD_COMPLETE";class Bo extends rt{constructor(t){super(t)}}Bo.INITIALIZED="RCWM_INITIALIZED";class Qt extends rt{constructor(t,e){super(t),this._connection=e}get connection(){return this._connection}}Qt.CONNECTION_ESTABLISHED="NCE_ESTABLISHED";Qt.CONNECTION_CLOSED="NCE_CLOSED";Qt.CONNECTION_ERROR="NCE_ERROR";Qt.CONNECTION_HANDSHAKING="NCE_HANDSHAKING";Qt.CONNECTION_HANDSHAKED="NCE_HANDSHAKED";Qt.CONNECTION_HANDSHAKE_FAILED="NCE_HANDSHAKE_FAILED";Qt.CONNECTION_AUTHENTICATED="NCE_AUTHENTICATED";class Ji extends rt{constructor(t){super(t)}}Ji.LOADED="NLE_LOADED";Ji.FAILED="NLE_FAILED";const ul=class wo extends rt{constructor(){super(wo.SETTINGS_UPDATED)}clone(){const t=new wo;return t._volumeSystem=this._volumeSystem,t._volumeFurni=this._volumeFurni,t._volumeTrax=this._volumeTrax,t._oldChat=this._oldChat,t._roomInvites=this._roomInvites,t._cameraFollow=this._cameraFollow,t._flags=this._flags,t._chatType=this._chatType,t}get volumeSystem(){return this._volumeSystem}set volumeSystem(t){this._volumeSystem=t}get volumeFurni(){return this._volumeFurni}set volumeFurni(t){this._volumeFurni=t}get volumeTrax(){return this._volumeTrax}set volumeTrax(t){this._volumeTrax=t}get oldChat(){return this._oldChat}set oldChat(t){this._oldChat=t}get roomInvites(){return this._roomInvites}set roomInvites(t){this._roomInvites=t}get cameraFollow(){return this._cameraFollow}set cameraFollow(t){this._cameraFollow=t}get flags(){return this._flags}set flags(t){this._flags=t}get chatType(){return this._chatType}set chatType(t){this._chatType=t}};ul.SETTINGS_UPDATED="NSE_SETTINGS_UPDATED";let jr=ul;class Bn extends rt{constructor(t,e){super(t),this._sampleCode=e}get sampleCode(){return this._sampleCode}}Bn.PLAY_SOUND="NSOE_PLAY_SOUND";class hh extends rt{constructor(t){super(t)}get iconId(){return this._iconId}set iconId(t){this._iconId=t}get iconName(){return this._iconName}set iconName(t){this._iconName=t}}hh.TOOLBAR_CLICK="NTE_TOOLBAR_CLICK";hh.SELECT_OWN_AVATAR="NTE_SELECT_OWN_AVATAR";const ll=class cl extends hh{constructor(t,e,s){super(cl.ANIMATE_ICON),this._image=t,this._x=e,this._y=s}get image(){return this._image}get x(){return this._x}get y(){return this._y}};ll.ANIMATE_ICON="NTAIE_ANIMATE_ICON";let Eu=ll;class ot extends rt{constructor(t,e){super(t),this._roomId=e}get roomId(){return this._roomId}}ot.INITIALIZED="REE_INITIALIZED";ot.ENGINE_INITIALIZED="REE_ENGINE_INITIALIZED";ot.OBJECTS_INITIALIZED="REE_OBJECTS_INITIALIZED";ot.NORMAL_MODE="REE_NORMAL_MODE";ot.GAME_MODE="REE_GAME_MODE";ot.ROOM_ZOOMED="REE_ROOM_ZOOMED";ot.DISPOSED="REE_DISPOSED";const dl=class gl extends ot{constructor(t,e,s,i){super(gl.ROOM_COLOR,t),this._color=e,this._brightness=s,this._bgOnly=i}get color(){return this._color}get brightness(){return this._brightness}get bgOnly(){return this._bgOnly}};dl.ROOM_COLOR="REE_ROOM_COLOR";let Pm=dl;class ss extends rt{constructor(t,e){super(t),this._contentType=e}get contentType(){return this._contentType}}ss.RCLE_SUCCESS="RCLE_SUCCESS";ss.RCLE_FAILURE="RCLE_FAILURE";ss.RCLE_CANCEL="RCLE_CANCEL";const El=class fl extends ot{constructor(t,e,s){super(fl.ROOM_DRAG,t),this._offsetX=e,this._offsetY=s}get offsetX(){return this._offsetX}get offsetY(){return this._offsetY}};El.ROOM_DRAG="RDE_ROOM_DRAG";let ym=El;const ml=class Il extends ot{constructor(t,e,s,i,r,a){super(Il.ROOM_COLOR,t),this._state=e,this._presetId=s,this._effectId=i,this._color=r,this._brightness=a}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};ml.ROOM_COLOR="REDSE_ROOM_COLOR";let Lm=ml;class V extends ot{constructor(t,e,s,i){super(t,e),this._objectId=s,this._category=i}get objectId(){return this._objectId}get category(){return this._category}}V.SELECTED="REOE_SELECTED";V.DESELECTED="REOE_DESELECTED";V.ADDED="REOE_ADDED";V.REMOVED="REOE_REMOVED";V.PLACED="REOE_PLACED";V.PLACED_ON_USER="REOE_PLACED_ON_USER";V.CONTENT_UPDATED="REOE_CONTENT_UPDATED";V.REQUEST_MOVE="REOE_REQUEST_MOVE";V.REQUEST_ROTATE="REOE_REQUEST_ROTATE";V.REQUEST_MANIPULATION="REOE_REQUEST_MANIPULATION";V.MOUSE_ENTER="REOE_MOUSE_ENTER";V.MOUSE_LEAVE="REOE_MOUSE_LEAVE";V.DOUBLE_CLICK="REOE_DOUBLE_CLICK";class Um extends V{constructor(t,e,s,i,r,a,o,_,l,c,d,E,I){super(t,e,s,i),this._wallLocation="",this._x=0,this._y=0,this._z=0,this._direction=0,this._placedInRoom=!1,this._placedOnFloor=!1,this._placedOnWall=!1,this._instanceData=null,this._wallLocation=r,this._x=a,this._y=o,this._z=_,this._direction=l,this._placedInRoom=c,this._placedOnFloor=d,this._placedOnWall=E,this._instanceData=I}get wallLocation(){return this._wallLocation}get x(){return this._x}get y(){return this._y}get z(){return this._z}get direction(){return this._direction}get placedInRoom(){return this._placedInRoom}get placedOnFloor(){return this._placedOnFloor}get placedOnWall(){return this._placedOnWall}get instanceData(){return this._instanceData}}class vm extends V{constructor(t,e,s,i,r,a){super(t,e,s,i),this._droppedObjectId=r,this._droppedObjectCategory=a}get droppedObjectId(){return this._droppedObjectId}get droppedObjectCategory(){return this._droppedObjectCategory}}class Zi extends V{constructor(t,e,s,i,r,a=1){super(t,e,s,i),this._soundId=r,this._pitch=a}get soundId(){return this._soundId}get pitch(){return this._pitch}}Zi.PLAY_SOUND="REOPSE_PLAY_SOUND";Zi.PLAY_SOUND_AT_PITCH="REOPSE_PLAY_SOUND_AT_PITCH";class ti extends V{}ti.FURNI_CLICK="RERAE_FURNI_CLICK";ti.FURNI_DOUBLE_CLICK="RERAE_FURNI_DOUBLE_CLICK";ti.TOOLTIP_SHOW="RERAE_TOOLTIP_SHOW";ti.TOOLTIP_HIDE="RERAE_TOOLTIP_HIDE";class _e extends V{constructor(t,e,s,i,r,a=1){super(t,e,s,i),this._sampleId=r,this._pitch=a}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}_e.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED";_e.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED";_e.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE";_e.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class U extends V{constructor(t,e,s,i,r=null){super(t,e,s,i),this._widget=r}get widget(){return this._widget}get contextMenu(){return this._widget}}U.OPEN_WIDGET="RETWE_OPEN_WIDGET";U.CLOSE_WIDGET="RETWE_CLOSE_WIDGET";U.OPEN_FURNI_CONTEXT_MENU="RETWE_OPEN_FURNI_CONTEXT_MENU";U.CLOSE_FURNI_CONTEXT_MENU="RETWE_CLOSE_FURNI_CONTEXT_MENU";U.REQUEST_PLACEHOLDER="RETWE_REQUEST_PLACEHOLDER";U.REQUEST_CREDITFURNI="RETWE_REQUEST_CREDITFURNI";U.REQUEST_STACK_HEIGHT="RETWE_REQUEST_STACK_HEIGHT";U.REQUEST_EXTERNAL_IMAGE="RETWE_REQUEST_EXTERNAL_IMAGE";U.REQUEST_STICKIE="RETWE_REQUEST_STICKIE";U.REQUEST_PRESENT="RETWE_REQUEST_PRESENT";U.REQUEST_TROPHY="RETWE_REQUEST_TROPHY";U.REQUEST_TEASER="RETWE_REQUEST_TEASER";U.REQUEST_ECOTRONBOX="RETWE_REQUEST_ECOTRONBOX";U.REQUEST_DIMMER="RETWE_REQUEST_DIMMER";U.REMOVE_DIMMER="RETWE_REMOVE_DIMMER";U.REQUEST_CLOTHING_CHANGE="RETWE_REQUEST_CLOTHING_CHANGE";U.REQUEST_PLAYLIST_EDITOR="RETWE_REQUEST_PLAYLIST_EDITOR";U.REQUEST_MANNEQUIN="RETWE_REQUEST_MANNEQUIN";U.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG";U.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG";U.REQUEST_BACKGROUND_COLOR="RETWE_REQUEST_BACKGROUND_COLOR";U.REQUEST_MYSTERYBOX_OPEN_DIALOG="RETWE_REQUEST_MYSTERYBOX_OPEN_DIALOG";U.REQUEST_EFFECTBOX_OPEN_DIALOG="RETWE_REQUEST_EFFECTBOX_OPEN_DIALOG";U.REQUEST_MYSTERYTROPHY_OPEN_DIALOG="RETWE_REQUEST_MYSTERYTROPHY_OPEN_DIALOG";U.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING";U.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED="RETWE_REQUEST_ACHIEVEMENT_RESOLUTION_FAILED";U.REQUEST_FRIEND_FURNITURE_CONFIRM="RETWE_REQUEST_FRIEND_FURNITURE_CONFIRM";U.REQUEST_FRIEND_FURNITURE_ENGRAVING="RETWE_REQUEST_FRIEND_FURNITURE_ENGRAVING";U.REQUEST_BADGE_DISPLAY_ENGRAVING="RETWE_REQUEST_BADGE_DISPLAY_ENGRAVING";U.REQUEST_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIGH_SCORE_DISPLAY";U.REQUEST_HIDE_HIGH_SCORE_DISPLAY="RETWE_REQUEST_HIDE_HIGH_SCORE_DISPLAY";U.REQUEST_INTERNAL_LINK="RETWE_REQUEST_INTERNAL_LINK";U.REQUEST_ROOM_LINK="RETWE_REQUEST_ROOM_LINK";U.REQUEST_YOUTUBE="RETWE_REQUEST_YOUTUBE";class sa extends V{constructor(t,e,s,i,r=-1,a=-1){super(t,e,s,i),this._inventoryStripId=r,this._furnitureTypeId=a}get inventoryStripId(){return this._inventoryStripId}get furnitureTypeId(){return this._furnitureTypeId}}sa.USE_PRODUCT_FROM_ROOM="REUPE_USE_PRODUCT_FROM_ROOM";sa.USE_PRODUCT_FROM_INVENTORY="REUPE_USE_PRODUCT_FROM_INVENTORY";class ye extends rt{constructor(t,e){super(t),this._object=e}get object(){return this._object}get objectId(){return this._object?this._object.id:-1}get objectType(){return this._object?this._object.type:null}}class rs extends ye{constructor(t,e,s,i=!0){super(t,e),this._badgeId=s,this._groupBadge=i}get badgeId(){return this._badgeId}get groupBadge(){return this._groupBadge}}rs.LOAD_BADGE="ROBAE_LOAD_BADGE";class Ce extends ye{constructor(t,e){super(t,e)}}Ce.RODRE_CURRENT_USER_ID="RODRE_CURRENT_USER_ID";Ce.RODRE_URL_PREFIX="RODRE_URL_PREFIX";const Rl=class Tl extends ye{constructor(t,e,s,i,r,a){super(Tl.DIMMER_STATE,t),this._state=e,this._presetId=s,this._effectId=i,this._color=r,this._brightness=a}get state(){return this._state}get presetId(){return this._presetId}get effectId(){return this._effectId}get color(){return this._color}get brightness(){return this._brightness}};Rl.DIMMER_STATE="RODSUE_DIMMER_STATE";let zr=Rl;class ee extends ye{constructor(t,e){super(t,e)}}ee.ADD_HOLE="ROFHO_ADD_HOLE";ee.REMOVE_HOLE="ROFHO_REMOVE_HOLE";class y extends ye{}y.DICE_OFF="ROFCAE_DICE_OFF";y.DICE_ACTIVATE="ROFCAE_DICE_ACTIVATE";y.USE_HABBOWHEEL="ROFCAE_USE_HABBOWHEEL";y.STICKIE="ROFCAE_STICKIE";y.ENTER_ONEWAYDOOR="ROFCAE_ENTER_ONEWAYDOOR";y.SOUND_MACHINE_INIT="ROFCAE_SOUND_MACHINE_INIT";y.SOUND_MACHINE_START="ROFCAE_SOUND_MACHINE_START";y.SOUND_MACHINE_STOP="ROFCAE_SOUND_MACHINE_STOP";y.SOUND_MACHINE_DISPOSE="ROFCAE_SOUND_MACHINE_DISPOSE";y.JUKEBOX_INIT="ROFCAE_JUKEBOX_INIT";y.JUKEBOX_START="ROFCAE_JUKEBOX_START";y.JUKEBOX_MACHINE_STOP="ROFCAE_JUKEBOX_MACHINE_STOP";y.JUKEBOX_DISPOSE="ROFCAE_JUKEBOX_DISPOSE";y.MOUSE_BUTTON="ROFCAE_MOUSE_BUTTON";y.MOUSE_ARROW="ROFCAE_MOUSE_ARROW";class Ho extends ot{constructor(t,e,s,i,r,a){super(t,e),this._enable=s,this._hue=i,this._saturation=r,this._lightness=a}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}Ho.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class Qs extends ye{constructor(t,e,s,i,r,a){super(t,e),this._enable=s,this._hue=i,this._saturation=r,this._lightness=a}get enable(){return this._enable}get hue(){return this._hue}get saturation(){return this._saturation}get lightness(){return this._lightness}}Qs.ROOM_BACKGROUND_COLOR="ROHSLCEE_ROOM_BACKGROUND_COLOR";class j extends ye{constructor(t,e,s,i=!1,r=!1,a=!1,o=!1){super(t,e),this._eventId="",this._eventId=s,this._altKey=i,this._ctrlKey=r,this._shiftKey=a,this._buttonDown=o}get eventId(){return this._eventId}get altKey(){return this._altKey}get ctrlKey(){return this._ctrlKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get localX(){return this._localX}set localX(t){this._localX=t}get localY(){return this._localY}set localY(t){this._localY=t}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}j.CLICK="ROE_MOUSE_CLICK";j.DOUBLE_CLICK="ROE_MOUSE_DOUBLE_CLICK";j.MOUSE_MOVE="ROE_MOUSE_MOVE";j.MOUSE_DOWN="ROE_MOUSE_DOWN";j.MOUSE_DOWN_LONG="ROE_MOUSE_DOWN_LONG";j.MOUSE_UP="ROE_MOUSE_UP";j.MOUSE_ENTER="ROE_MOUSE_ENTER";j.MOUSE_LEAVE="ROE_MOUSE_LEAVE";class re extends ye{constructor(t,e){super(t,e)}}re.POSITION_CHANGED="ROME_POSITION_CHANGED";re.OBJECT_REMOVED="ROME_OBJECT_REMOVED";class Ns extends y{constructor(t,e,s,i=1){super(t,e),this._soundId=s,this._pitch=i}get soundId(){return this._soundId}get pitch(){return this._pitch}}Ns.PLAY_SOUND="ROPSIE_PLAY_SOUND";Ns.PLAY_SOUND_AT_PITCH="ROPSIE_PLAY_SOUND_AT_PITCH";class Tt extends ye{constructor(t,e,s="",i=""){super(t,e),this._imageUrl="",this._clickUrl="",this._imageUrl=s,this._clickUrl=i}get imageUrl(){return this._imageUrl}get clickUrl(){return this._clickUrl}}Tt.ROOM_AD_LOAD_IMAGE="RORAE_ROOM_AD_LOAD_IMAGE";Tt.ROOM_AD_FURNI_CLICK="RORAE_ROOM_AD_FURNI_CLICK";Tt.ROOM_AD_FURNI_DOUBLE_CLICK="RORAE_ROOM_AD_FURNI_DOUBLE_CLICK";Tt.ROOM_AD_TOOLTIP_SHOW="RORAE_ROOM_AD_TOOLTIP_SHOW";Tt.ROOM_AD_TOOLTIP_HIDE="RORAE_ROOM_AD_TOOLTIP_HIDE";class Dt extends ye{constructor(t,e,s,i=1){super(t,e),this._sampleId=s,this._pitch=i}get sampleId(){return this._sampleId}get pitch(){return this._pitch}}Dt.ROOM_OBJECT_INITIALIZED="ROPSPE_ROOM_OBJECT_INITIALIZED";Dt.ROOM_OBJECT_DISPOSED="ROPSPE_ROOM_OBJECT_DISPOSED";Dt.PLAY_SAMPLE="ROPSPE_PLAY_SAMPLE";Dt.CHANGE_PITCH="ROPSPE_CHANGE_PITCH";class Et extends V{}Et.SOUND_MACHINE_INIT="ROSM_SOUND_MACHINE_INIT";Et.SOUND_MACHINE_SWITCHED_ON="ROSM_SOUND_MACHINE_SWITCHED_ON";Et.SOUND_MACHINE_SWITCHED_OFF="ROSM_SOUND_MACHINE_SWITCHED_OFF";Et.SOUND_MACHINE_DISPOSE="ROSM_SOUND_MACHINE_DISPOSE";Et.JUKEBOX_INIT="ROSM_JUKEBOX_INIT";Et.JUKEBOX_SWITCHED_ON="ROSM_JUKEBOX_SWITCHED_ON";Et.JUKEBOX_SWITCHED_OFF="ROSM_JUKEBOX_SWITCHED_OFF";Et.JUKEBOX_DISPOSE="ROSM_JUKEBOX_DISPOSE";class it extends ye{constructor(t,e,s=0){super(t,e),this._state=s}get state(){return this._state}}it.STATE_CHANGE="ROSCE_STATE_CHANGE";it.STATE_RANDOM="ROSCE_STATE_RANDOM";class ls extends j{constructor(t,e,s,i,r,a,o=!1,_=!1,l=!1,c=!1){super(t,e,s,o,_,l,c),this._tileX=i,this._tileY=r,this._tileZ=a}get tileX(){return this._tileX}get tileY(){return this._tileY}get tileZ(){return this._tileZ}get tileXAsInt(){return Math.trunc(this._tileX+.499)}get tileYAsInt(){return Math.trunc(this._tileY+.499)}get tileZAsInt(){return Math.trunc(this._tileZ+.499)}}class Hi extends j{constructor(t,e,s,i,r,a,o,_,l,c=!1,d=!1,E=!1,I=!1){super(t,e,s,c,d,E,I),this._wallLocation=new R,this._wallWd=new R,this._wallHt=new R,this._wallLocation.assign(i),this._wallWd.assign(r),this._wallHt.assign(a),this._x=o,this._y=_,this._direction=l}get wallLocation(){return this._wallLocation}get wallWidth(){return this._wallWd}get wallHeight(){return this._wallHt}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class O extends ye{constructor(t,e){super(t,e)}}O.OPEN_WIDGET="ROWRE_OPEN_WIDGET";O.CLOSE_WIDGET="ROWRE_CLOSE_WIDGET";O.OPEN_FURNI_CONTEXT_MENU="ROWRE_OPEN_FURNI_CONTEXT_MENU";O.CLOSE_FURNI_CONTEXT_MENU="ROWRE_CLOSE_FURNI_CONTEXT_MENU";O.PLACEHOLDER="ROWRE_PLACEHOLDER";O.CREDITFURNI="ROWRE_CREDITFURNI";O.STACK_HEIGHT="ROWRE_STACK_HEIGHT";O.EXTERNAL_IMAGE="ROWRE_EXTERNAL_IMAGE";O.STICKIE="ROWRE_STICKIE";O.PRESENT="ROWRE_PRESENT";O.TROPHY="ROWRE_TROPHY";O.TEASER="ROWRE_TEASER";O.ECOTRONBOX="ROWRE_ECOTRONBOX";O.DIMMER="ROWRE_DIMMER";O.WIDGET_REMOVE_DIMMER="ROWRE_WIDGET_REMOVE_DIMMER";O.CLOTHING_CHANGE="ROWRE_CLOTHING_CHANGE";O.JUKEBOX_PLAYLIST_EDITOR="ROWRE_JUKEBOX_PLAYLIST_EDITOR";O.MANNEQUIN="ROWRE_MANNEQUIN";O.PET_PRODUCT_MENU="ROWRE_PET_PRODUCT_MENU";O.GUILD_FURNI_CONTEXT_MENU="ROWRE_GUILD_FURNI_CONTEXT_MENU";O.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG="ROWRE_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG";O.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG="ROWRE_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG";O.BACKGROUND_COLOR="ROWRE_BACKGROUND_COLOR";O.MYSTERYBOX_OPEN_DIALOG="ROWRE_MYSTERYBOX_OPEN_DIALOG";O.EFFECTBOX_OPEN_DIALOG="ROWRE_EFFECTBOX_OPEN_DIALOG";O.MYSTERYTROPHY_OPEN_DIALOG="ROWRE_MYSTERYTROPHY_OPEN_DIALOG";O.ACHIEVEMENT_RESOLUTION_OPEN="ROWRE_ACHIEVEMENT_RESOLUTION_OPEN";O.ACHIEVEMENT_RESOLUTION_ENGRAVING="ROWRE_ACHIEVEMENT_RESOLUTION_ENGRAVING";O.ACHIEVEMENT_RESOLUTION_FAILED="ROWRE_ACHIEVEMENT_RESOLUTION_FAILED";O.FRIEND_FURNITURE_CONFIRM="ROWRE_FRIEND_FURNITURE_CONFIRM";O.FRIEND_FURNITURE_ENGRAVING="ROWRE_FRIEND_FURNITURE_ENGRAVING";O.BADGE_DISPLAY_ENGRAVING="ROWRE_BADGE_DISPLAY_ENGRAVING";O.HIGH_SCORE_DISPLAY="ROWRE_HIGH_SCORE_DISPLAY";O.HIDE_HIGH_SCORE_DISPLAY="ROWRE_HIDE_HIGH_SCORE_DISPLAY";O.INERNAL_LINK="ROWRE_INTERNAL_LINK";O.ROOM_LINK="ROWRE_ROOM_LINK";O.YOUTUBE="ROWRE_YOUTUBE";class bm{constructor(t,e,s,i,r,a,o=0,_=0,l=!1,c=!1,d=!1,E=!1){this._type=t,this._eventId=e,this._canvasId=s,this._spriteTag=i,this._screenX=r,this._screenY=a,this._localX=o,this._localY=_,this._ctrlKey=l,this._altKey=c,this._shiftKey=d,this._buttonDown=E,this._spriteOffsetX=0,this._spriteOffsetY=0}get type(){return this._type}get eventId(){return this._eventId}get canvasId(){return this._canvasId}get spriteTag(){return this._spriteTag}get screenX(){return this._screenX}get screenY(){return this._screenY}get localX(){return this._localX}get localY(){return this._localY}get ctrlKey(){return this._ctrlKey}get altKey(){return this._altKey}get shiftKey(){return this._shiftKey}get buttonDown(){return this._buttonDown}get spriteOffsetX(){return this._spriteOffsetX}set spriteOffsetX(t){this._spriteOffsetX=t}get spriteOffsetY(){return this._spriteOffsetY}set spriteOffsetY(t){this._spriteOffsetY=t}}class Fm extends rt{constructor(t){super(t)}}class Wr extends Fm{constructor(t,e){super(t),this._targetLocation=e}get targetLocation(){return this._targetLocation}}Wr.ROAME_MOVE_TO="ROAME_MOVE_TO";const pl=class Ol extends ot{constructor(t,e,s=!1,i=!1){super(Ol.ROOM_ZOOM,t),this._level=e,this._forceFlip=s,this._asDelta=i}get level(){return this._level}get forceFlip(){return this._forceFlip}get asDelta(){return this._asDelta}};pl.ROOM_ZOOM="REE_ROOM_ZOOM";let Tj=pl;const Al=class Sl extends rt{constructor(t,e){super(Sl.IMAGE_READY),this._badgeId=t,this._image=e}get badgeId(){return this._badgeId}get image(){return this._image}};Al.IMAGE_READY="BIME_BADGE_IMAGE_READY";let ia=Al;const Ml=class Cl extends rt{constructor(t,e){super(Cl.MYSTERY_BOX_KEYS_UPDATE),this._boxColor=t,this._keyColor=e}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}};Ml.MYSTERY_BOX_KEYS_UPDATE="mbke_update";let xm=Ml;const Gm=class Nl extends rt{constructor(){super(Nl.PERKS_UPDATED)}};Gm.PERKS_UPDATED="PUE_perks_updated";class K extends rt{constructor(t,e,s=!0){super(t),this._session=e,this._openLandingView=s}get session(){return this._session}get openLandingView(){return this._openLandingView}}K.CREATED="RSE_CREATED";K.STARTED="RSE_STARTED";K.ENDED="RSE_ENDED";K.ROOM_DATA="RSE_ROOM_DATA";class st extends K{constructor(t,e,s,i,r,a=0,o=null,_=-1){super(t,e),this._objectId=s,this._message=i,this._chatType=r,this._links=o,this._extraParam=_,this._style=a}get objectId(){return this._objectId}get message(){return this._message}get chatType(){return this._chatType}get links(){return this._links}get extraParam(){return this._extraParam}get style(){return this._style}}st.CHAT_EVENT="RSCE_CHAT_EVENT";st.FLOOD_EVENT="RSCE_FLOOD_EVENT";st.CHAT_TYPE_SPEAK=0;st.CHAT_TYPE_WHISPER=1;st.CHAT_TYPE_SHOUT=2;st.CHAT_TYPE_RESPECT=3;st.CHAT_TYPE_PETRESPECT=4;st.CHAT_TYPE_HAND_ITEM_RECEIVED=5;st.CHAT_TYPE_PETTREAT=6;st.CHAT_TYPE_PETREVIVE=7;st.CHAT_TYPE_PET_REBREED_FERTILIZE=8;st.CHAT_TYPE_PET_SPEED_FERTILIZE=9;st.CHAT_TYPE_MUTE_REMAINING=10;const Dl=class Pl extends K{constructor(t,e,s,i,r,a){super(Pl.CONFIRM_PET_BREEDING,t),this._nestId=e,this._pet1=s,this._pet2=i,this._rarityCategories=r,this._resultPetTypeId=a}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetTypeId(){return this._resultPetTypeId}};Dl.CONFIRM_PET_BREEDING="RSPFUE_CONFIRM_PET_BREEDING";let Bm=Dl;const yl=class Ll extends K{constructor(t,e,s){super(Ll.RSPFUE_CONFIRM_PET_BREEDING_RESULT,t),this._breedingNestStuffId=e,this._result=s}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}};yl.RSPFUE_CONFIRM_PET_BREEDING_RESULT="RSPFUE_CONFIRM_PET_BREEDING_RESULT";let wm=yl;const Ul=class vl extends K{constructor(t,e,s){super(vl.RSDE_DANCE,t),this._roomIndex=e,this._danceId=s}get roomIndex(){return this._roomIndex}get danceId(){return this._danceId}};Ul.RSDE_DANCE="RSDE_DANCE";let Hm=Ul;class Vm{constructor(t,e,s,i){this._id=t,this._type=e,this._color=s,this._brightness=i}get id(){return this._id}get type(){return this._type}get color(){return this._color}get brightness(){return this._brightness}}class Vo extends K{constructor(t,e){super(t,e),this._selectedPresetId=0,this._presets=[]}storePreset(t,e,s,i){this._presets[t-1]=new Vm(t,e,s,i)}getPreset(t){return t<0||t>=this._presets.length?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}set selectedPresetId(t){this._selectedPresetId=t}}Vo.ROOM_DIMMER_PRESETS="RSDPE_PRESETS";class Ds extends K{constructor(t,e,s){super(t,e),this._userName="",this._userName=s}get userName(){return this._userName}}Ds.DOORBELL="RSDE_DOORBELL";Ds.RSDE_REJECTED="RSDE_REJECTED";Ds.RSDE_ACCEPTED="RSDE_ACCEPTED";class St extends K{constructor(t,e,s=null){super(t,e),this._message=s}get message(){return this._message}}St.RSEME_KICKED="RSEME_KICKED";St.RSEME_PETS_FORBIDDEN_IN_HOTEL="RSEME_PETS_FORBIDDEN_IN_HOTEL";St.RSEME_PETS_FORBIDDEN_IN_FLAT="RSEME_PETS_FORBIDDEN_IN_FLAT";St.RSEME_MAX_PETS="RSEME_MAX_PETS";St.RSEME_MAX_NUMBER_OF_OWN_PETS="RSEME_MAX_NUMBER_OF_OWN_PETS";St.RSEME_NO_FREE_TILES_FOR_PET="RSEME_NO_FREE_TILES_FOR_PET";St.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET="RSEME_SELECTED_TILE_NOT_FREE_FOR_PET";St.RSEME_BOTS_FORBIDDEN_IN_HOTEL="RSEME_BOTS_FORBIDDEN_IN_HOTEL";St.RSEME_BOTS_FORBIDDEN_IN_FLAT="RSEME_BOTS_FORBIDDEN_IN_FLAT";St.RSEME_BOT_LIMIT_REACHED="RSEME_BOT_LIMIT_REACHED";St.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT="RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT";St.RSEME_BOT_NAME_NOT_ACCEPTED="RSEME_BOT_NAME_NOT_ACCEPTED";const bl=class Fl extends K{constructor(t,e,s,i,r){super(Fl.FAVOURITE_GROUP_UPDATE,t),this._roomIndex=e,this._habboGroupId=s,this._habboGroupName=r,this._status=i}get roomIndex(){return this._roomIndex}get habboGroupId(){return this._habboGroupId}get habboGroupName(){return this._habboGroupName}get status(){return this._status}};bl.FAVOURITE_GROUP_UPDATE="RSFGUE_FAVOURITE_GROUP_UPDATE";let jm=bl;const xl=class Gl extends K{constructor(t,e,s,i){super(Gl.RSFRE_FRIEND_REQUEST,t),this._requestId=0,this._userId=0,this._requestId=e,this._userId=s,this._userName=i}get requestId(){return this._requestId}get userId(){return this._userId}get userName(){return this._userName}};xl.RSFRE_FRIEND_REQUEST="RSFRE_FRIEND_REQUEST";let zm=xl;const Bl=class wl extends K{constructor(t,e,s){super(wl.NEST_BREEDING_SUCCESS,t),this._petId=e,this._rarityCategory=s}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}};Bl.NEST_BREEDING_SUCCESS="RSPFUE_NEST_BREEDING_SUCCESS";let Ym=Bl;const Hl=class Vl extends K{constructor(t,e,s,i){super(Vl.PET_BREEDING,t),this._state=e,this._ownPetId=s,this._otherPetId=i}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}};Hl.PET_BREEDING="RSPFUE_PET_BREEDING";let Wm=Hl;const jl=class zl extends K{constructor(t,e,s){super(zl.PET_BREEDING_RESULT,t),this._resultData=e,this._otherResultData=s}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}};jl.PET_BREEDING_RESULT="RSPFUE_PET_BREEDING_RESULT";let km=jl;const Km=class Yl extends K{constructor(t,e,s,i){super(Yl.PET_COMMANDS,t),this._petId=e,this._allCommandIds=s,this._enabledCommandIds=i}get id(){return this._petId}get commands(){return this._allCommandIds}get enabledCommands(){return this._enabledCommandIds}};Km.PET_COMMANDS="RSPIUE_ENABLED_PET_COMMANDS";const Wl=class kl extends K{constructor(t,e,s){super(kl.PET_FIGURE_UPDATE,t),this._petId=e,this._figure=s}get id(){return this._petId}get figure(){return this._figure}};Wl.PET_FIGURE_UPDATE="RSPFUE_PET_FIGURE_UPDATE";let Xm=Wl;const Kl=class Xl extends K{constructor(t,e){super(Xl.PET_INFO,t),this._petInfo=e}get petInfo(){return this._petInfo}};Kl.PET_INFO="RSPIUE_PET_INFO";let qm=Kl;const ql=class Ql extends K{constructor(t,e,s){super(Ql.PET_LEVEL_UPDATE,t),this._petId=e,this._level=s}get petId(){return this._petId}get level(){return this._level}};ql.PET_LEVEL_UPDATE="RSPLUE_PET_LEVEL_UPDATE";let Qm=ql;class $i extends K{constructor(t,e,s,i,r,a){super(t,e),this._objectId=-1,this._nameValidationStatus=0,this._nameValidationInfo=null,this._objectId=s,this._figureData=i,this._nameValidationStatus=r,this._nameValidationInfo=a}get objectId(){return this._objectId}get figureData(){return this._figureData}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}$i.RSOPPE_OPEN_PET_PACKAGE_REQUESTED="RSOPPE_OPEN_PET_PACKAGE_REQUESTED";$i.RSOPPE_OPEN_PET_PACKAGE_RESULT="RSOPPE_OPEN_PET_PACKAGE_RESULT";const Jl=class Zl extends K{constructor(t,e,s,i,r,a){super(Zl.PET_STATUS_UPDATE,t),this._petId=e,this._canBreed=s,this._canHarvest=i,this._canRevive=r,this._hasBreedingPermission=a}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}};Jl.PET_STATUS_UPDATE="RSPFUE_PET_STATUS_UPDATE";let Jm=Jl;class Os extends K{constructor(t,e,s){super(t,e),this._id=-1,this._numQuestions=0,this._startMessage="",this._endMessage="",this._questionArray=null,this._npsPoll=!1,this._id=s}get id(){return this._id}get headline(){return this._headline}set headline(t){this._headline=t}get summary(){return this._summary}set summary(t){this._summary=t}get numQuestions(){return this._numQuestions}set numQuestions(t){this._numQuestions=t}get startMessage(){return this._startMessage}set startMessage(t){this._startMessage=t}get endMessage(){return this._endMessage}set endMessage(t){this._endMessage=t}get questionArray(){return this._questionArray}set questionArray(t){this._questionArray=t}get npsPoll(){return this._npsPoll}set npsPoll(t){this._npsPoll=t}}Os.OFFER="RSPE_POLL_OFFER";Os.ERROR="RSPE_POLL_ERROR";Os.CONTENT="RSPE_POLL_CONTENT";class jo extends K{constructor(t,e,s,i,r,a,o,_,l){super(t,e),this._classId=0,this._itemType="",this._placedItemId=0,this._placedItemType="",this._classId=s,this._itemType=i,this._productCode=r,this._placedItemId=a,this._placedItemType=o,this._placedInRoom=_,this._petFigureString=l}get classId(){return this._classId}get itemType(){return this._itemType}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedInRoom(){return this._placedInRoom}get placedItemType(){return this._placedItemType}get petFigureString(){return this._petFigureString}}jo.RSPE_PRESENT_OPENED="RSPE_PRESENT_OPENED";class zo extends K{constructor(t,e){super(t,e)}}zo.RSDUE_ALLOW_PETS="RSDUE_ALLOW_PETS";const en=class $l extends K{constructor(t,e,s,i=!1){super($l.QUEUE_STATUS,t),this._name=e,this._target=s,this._queues=new Map,this._isActive=i}get isActive(){return this._isActive}get queueSetName(){return this._name}get queueSetTarget(){return this._target}get queueTypes(){return Array.from(this._queues.keys())}getQueueSize(t){return this._queues.get(t)}addQueue(t,e){this._queues.set(t,e)}};en.QUEUE_STATUS="RSQE_QUEUE_STATUS";en.QUEUE_TYPE_CLUB="c";en.QUEUE_TYPE_NORMAL="d";en.QUEUE_TARGET_VISITOR=2;en.QUEUE_TARGET_SPECTATOR=1;class Yo extends K{constructor(t,e){super(t,e)}}Yo.SPECTATOR_MODE="RSSME_SPECTATOR_MODE";const tc=class ec extends K{constructor(t,e,s){super(ec.RSUBE_BADGES,t),this._userId=0,this._badges=[],this._userId=e,this._badges=s}get userId(){return this._userId}get badges(){return this._badges}};tc.RSUBE_BADGES="RSUBE_BADGES";let Zm=tc;const sc=class ic extends K{constructor(t,e){super(ic.USER_DATA_UPDATED,t),this._addedUsers=e}get addedUsers(){return this._addedUsers}};sc.USER_DATA_UPDATED="RMUDUE_USER_DATA_UPDATED";let $m=sc;const rc=class nc extends K{constructor(t,e,s,i,r,a){super(nc.USER_FIGURE,t),this._roomIndex=0,this._figure="",this._gender="",this._customInfo="",this._roomIndex=e,this._figure=s,this._gender=i,this._customInfo=r,this._achievementScore=a}get roomIndex(){return this._roomIndex}get figure(){return this._figure}get gender(){return this._gender}get customInfo(){return this._customInfo}get activityPoints(){return this._achievementScore}};rc.USER_FIGURE="RSUBE_FIGURE";let tI=rc;const eI=class ac extends rt{constructor(t,e){super(ac.UTRE_USER_TAGS_RECEIVED),this._userId=t,this._tags=e}get userId(){return this._userId}get tags(){return this._tags}};eI.UTRE_USER_TAGS_RECEIVED="UTRE_USER_TAGS_RECEIVED";class oc extends K{constructor(t,e,s,i,r=null,a=0){super(t,e),this._question="",this._SafeStr_7654=0,this._choices=[],this._SafeStr_7651=[],this._question=s,this._choices=i,this._SafeStr_7651=r,this._SafeStr_7651==null&&(this._SafeStr_7651=[]),this._SafeStr_7654=a}get question(){return this._question}get choices(){return this._choices.slice()}get _SafeStr_4173(){return this._SafeStr_7651.slice()}get _SafeStr_4174(){return this._SafeStr_7654}}oc.VOTE_QUESTION="RSPE_VOTE_QUESTION";oc.VOTE_RESULT="RSPE_VOTE_RESULT";class As extends K{constructor(t,e,s=-1){super(t,e),this._id=-1,this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,this._userId=-1,this._id=s}get id(){return this._id}get pollType(){return this._pollType}set pollType(t){this._pollType=t}get pollId(){return this._pollId}set pollId(t){this._pollId=t}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get duration(){return this._duration}set duration(t){this._duration=t}get question(){return this._question}set question(t){this._question=t}get userId(){return this._userId}set userId(t){this._userId=t}get value(){return this._value}set value(t){this._value=t}get answerCounts(){return this._answerCounts}set answerCounts(t){this._answerCounts=t}}As.QUESTION="RWPUW_NEW_QUESTION";As.FINISHED="RWPUW_QUESION_FINSIHED";As.ANSWERED="RWPUW_QUESTION_ANSWERED";const _c=class hc extends rt{constructor(t){super(hc.UPDATED),this._uiFlags=t}get uiFlags(){return this._uiFlags}};_c.UPDATED="APUE_UPDATED";let sI=_c;const uc=class lc extends rt{constructor(t){super(lc.UNUE_NAME_UPDATED),this._name=t}get name(){return this._name}};uc.UNUE_NAME_UPDATED="unue_name_updated";let fu=uc;class iI{constructor(){this._messageIdByEvent=new Map,this._messageIdByComposer=new Map,this._messageInstancesById=new Map}dispose(){this._messageIdByEvent.clear(),this._messageIdByComposer.clear(),this._messageInstancesById.clear()}registerMessages(t){for(const[e,s]of t.events)this.registerMessageEventClass(e,s);for(const[e,s]of t.composers)this.registerMessageComposerClass(e,s)}registerMessageEventClass(t,e){!t||!e||this._messageIdByEvent.set(e,t)}registerMessageComposerClass(t,e){!t||!e||this._messageIdByComposer.set(e,t)}registerMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;let s=this._messageInstancesById.get(e);(!s||!s.length)&&(s=[],this._messageInstancesById.set(e,s)),s.push(t)}removeMessageEvent(t){if(!t)return;const e=this.getEventId(t);if(!e)return;const s=this._messageInstancesById.get(e);if(s){for(const[i,r]of s.entries())if(r&&r===t){s.splice(i,1),s.length===0&&this._messageInstancesById.delete(e),r.dispose();return}}}getEvents(t){if(!t)return;const e=this._messageInstancesById.get(t);if(e)return e}getEventId(t){if(!t)return-1;const e=t instanceof f?t.constructor:t,s=this._messageIdByEvent.get(e);return s||-1}getComposerId(t){if(!t)return-1;const e=this._messageIdByComposer.get(t.constructor);return e||-1}}class rI extends pe{constructor(t,e){super(),this._communicationManager=t,this._stateListener=e,this._socket=null,this._messages=new iI,this._codec=new Dm,this._dataBuffer=null,this._isReady=!1,this._pendingClientMessages=[],this._pendingServerMessages=[],this._isAuthenticated=!1,this.onOpen=this.onOpen.bind(this),this.onClose=this.onClose.bind(this),this.onError=this.onError.bind(this),this.onMessage=this.onMessage.bind(this)}init(t){this._stateListener&&this._stateListener.connectionInit(t),this.createSocket(t)}onDispose(){super.onDispose(),this.destroySocket(),this._communicationManager=null,this._stateListener=null,this._messages=null,this._codec=null,this._dataBuffer=null}onReady(){this._isReady||(this._isReady=!0,this._pendingServerMessages&&this._pendingServerMessages.length&&this.processWrappers(...this._pendingServerMessages),this._pendingClientMessages&&this._pendingClientMessages.length&&this.send(...this._pendingClientMessages),this._pendingServerMessages=[],this._pendingClientMessages=[])}createSocket(t){t&&(this.destroySocket(),this._dataBuffer=new ArrayBuffer(0),this._socket=new WebSocket(t),this._socket.addEventListener(Se.CONNECTION_OPENED,this.onOpen),this._socket.addEventListener(Se.CONNECTION_CLOSED,this.onClose),this._socket.addEventListener(Se.CONNECTION_ERROR,this.onError),this._socket.addEventListener(Se.CONNECTION_MESSAGE,this.onMessage))}destroySocket(){this._socket&&(this._socket.removeEventListener(Se.CONNECTION_OPENED,this.onOpen),this._socket.removeEventListener(Se.CONNECTION_CLOSED,this.onClose),this._socket.removeEventListener(Se.CONNECTION_ERROR,this.onError),this._socket.removeEventListener(Se.CONNECTION_MESSAGE,this.onMessage),this._socket.readyState===WebSocket.OPEN&&this._socket.close(),this._socket=null)}onOpen(t){this.dispatchConnectionEvent(Bt.CONNECTION_OPENED,t)}onClose(t){this.dispatchConnectionEvent(Bt.CONNECTION_CLOSED,t)}onError(t){this.dispatchConnectionEvent(Bt.CONNECTION_ERROR,t)}onMessage(t){if(!t)return;const e=new FileReader;e.readAsArrayBuffer(t.data),e.onloadend=()=>{this._dataBuffer=this.concatArrayBuffers(this._dataBuffer,e.result),this.processReceivedData()}}dispatchConnectionEvent(t,e){this.dispatchEvent(new Bt(t,this,e))}authenticated(){this._isAuthenticated=!0}send(...t){if(this.disposed||!t)return!1;if(t=[...t],this._isAuthenticated&&!this._isReady)return this._pendingClientMessages||(this._pendingClientMessages=[]),this._pendingClientMessages.push(...t),!1;for(const e of t){if(!e)continue;const s=this._messages.getComposerId(e);if(s===-1){G.packets("Unknown Composer",e.constructor.name);continue}const i=e.getMessageArray(),r=this._codec.encode(s,i);if(!r){G.packets("Encoding Failed",e.constructor.name);continue}G.packets("OutgoingComposer",s,e.constructor.name,i),this.write(r.getBuffer())}return!0}write(t){this._socket.readyState===WebSocket.OPEN&&this._socket.send(t)}processReceivedData(){try{this.processData()}catch(t){G.error(t)}}processData(){const t=this.splitReceivedMessages();if(!(!t||!t.length)){if(this._isAuthenticated&&!this._isReady){this._pendingServerMessages||(this._pendingServerMessages=[]),this._pendingServerMessages.push(...t);return}this.processWrappers(...t)}}processWrappers(...t){if(!(!t||!t.length))for(const e of t){if(!e)continue;const s=this.getMessagesForWrapper(e);!s||!s.length||(G.packets("IncomingMessage",e.header,s[0].constructor.name,s[0].parser),this.handleMessages(...s))}}splitReceivedMessages(){return!this._dataBuffer||!this._dataBuffer.byteLength?null:this._codec.decode(this)}concatArrayBuffers(t,e){const s=new Uint8Array(t.byteLength+e.byteLength);return s.set(new Uint8Array(t),0),s.set(new Uint8Array(e),t.byteLength),s.buffer}getMessagesForWrapper(t){if(!t)return null;const e=this._messages.getEvents(t.header);if(!e||!e.length){G.packets("IncomingMessage",t.header,"UNREGISTERED",t);return}try{const s=new e[0].parserClass;if(!s||!s.flush()||!s.parse(t))return null;for(const i of e)i.parser=s}catch(s){return G.error("Error parsing message",s,e[0].constructor.name),null}return e}handleMessages(...t){t=[...t];for(const e of t)e&&(e.connection=this,e.callBack&&e.callBack(e))}registerMessages(t){t&&this._messages.registerMessages(t)}addMessageEvent(t){!t||!this._messages||this._messages.registerMessageEvent(t)}removeMessageEvent(t){!t||!this._messages||this._messages.removeMessageEvent(t)}get isAuthenticated(){return this._isAuthenticated}get dataBuffer(){return this._dataBuffer}set dataBuffer(t){this._dataBuffer=t}}class nI extends ge{constructor(){super(),this._connections=[]}onDispose(){if(!(!this._connections||!this._connections.length))for(const t of this._connections.values())t&&t.dispose()}createConnection(t=null){const e=new rI(this,t);if(e)return this._connections.push(e),e}update(t){let e=0;for(;e<this._connections.length;){const s=this._connections[e];if(s.processReceivedData(),this.disposed)return;s.disposed?this._connections.splice(e,1):e++}}}class Js extends rt{constructor(t){super(t)}}Js.LOADED="NCE_LOADED";Js.FAILED="NCE_FAILED";class aI extends ns{constructor(){super(),this._definitions=new Map,this._config=[],this._pendingUrls=[],this._missingKeys=[],this.onConfigurationLoaded=this.onConfigurationLoaded.bind(this)}onInit(){k.parseConfiguration(this.getDefaultConfig(),!0),this._pendingUrls=k.getValue("config.urls").slice(),this.loadNextConfiguration()}loadNextConfiguration(){if(!this._pendingUrls.length){this.dispatchConfigurationEvent(Js.LOADED);return}this.loadConfigurationFromUrl(this._pendingUrls[0])}loadConfigurationFromUrl(t){if(!t||t===""){this.dispatchConfigurationEvent(Js.FAILED);return}fetch(t).then(e=>e.json()).then(e=>this.onConfigurationLoaded(e,t)).catch(e=>this.onConfigurationFailed(e))}onConfigurationLoaded(t,e){if(t){if(k.parseConfiguration(t)){const s=this._pendingUrls.indexOf(e);s>=0&&this._pendingUrls.splice(s,1),this.loadNextConfiguration();return}this.dispatchConfigurationEvent(Js.FAILED)}}onConfigurationFailed(t){this.dispatchConfigurationEvent(Js.FAILED)}dispatchConfigurationEvent(t){this.events&&this.events.dispatchEvent(new Js(t))}getDefaultConfig(){return NitroConfig}}const uh=class Nr{static sayHello(){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){const t=[`
 %c %c %c Nitro ${Nr.UI_VERSION} - Renderer ${Nr.RENDERER_VERSION} %c %c %c https://discord.nitrodev.co %c %c 

`,"background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","color: #ffffff; background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #000000; padding:5px 0;","background: #ffffff; padding:5px 0;","background: #ffffff; padding:5px 0;"];self.console.log(...t)}else self.console&&self.console.log(`Nitro ${Nr.UI_VERSION} - Renderer ${Nr.RENDERER_VERSION} `)}};uh.RENDERER_VERSION="1.6.6";uh.UI_VERSION="";let cc=uh;class oI extends ge{constructor(){super(),cc.sayHello(),this._configuration=new aI,this._communication=new nI}onDispose(){this._communication&&(this._communication.dispose(),this._communication=null)}get configuration(){return this._configuration}get communication(){return this._communication}}class _I{constructor(t){this._id=parseInt(t.id),this._value=parseInt(t.id),this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._isAnimated=!0,t.animated!==void 0&&t.animated===!1&&(this._isAnimated=!1)}get id(){return this._id}get value(){return this._value}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get isAnimated(){return this._isAnimated}}class hI{constructor(t){if(this._id=t.id,this._state=t.state,this._precedence=t.precedence,this._activePartSet=t.activePartSet,this._assetPartDefinition=t.assetPartDefinition,this._lay=t.lay,this._geometryType=t.geometryType,this._isMain=t.main||!1,this._isDefault=t.isDefault||!1,this._isAnimation=t.animation||!1,this._startFromFrameZero=t.startFromFrameZero||!1,this._prevents=t.prevents||[],this._preventHeadTurn=t.preventHeadTurn||!1,this._types=new Map,this._params=new Map,this._defaultParameterValue="",this._canvasOffsets=null,t.params&&t.params.length>0)for(const e of t.params)e&&(e.id==="default"?this._defaultParameterValue=e.value:this._params.set(e.id,e.value));if(t.types&&t.types.length>0)for(const e of t.types){if(!e)continue;const s=new _I(e);this._types.set(s.id,s)}}setOffsets(t,e,s){this._canvasOffsets||(this._canvasOffsets=new Map);let i=this._canvasOffsets.get(t);i||(i=new Map,this._canvasOffsets.set(t,i)),i.set(e,s)}getOffsets(t,e){if(!this._canvasOffsets)return null;const s=this._canvasOffsets.get(t);return s?s.get(e):null}getType(t){if(!t)return null;const e=this._types.get(parseInt(t));return e||null}getParameterValue(t){if(!t)return"";const e=this._params.get(t);return e||this._defaultParameterValue}getPrevents(t){return this._prevents.concat(this.getTypePrevents(t))}getTypePrevents(t){if(!t)return[];const e=this._types.get(parseInt(t));return e?e.prevents:[]}getPreventHeadTurn(t){if(!t)return this._preventHeadTurn;const e=this.getType(t);return e?e.preventHeadTurn:this._preventHeadTurn}isAnimated(t){if(!t)return!0;const e=this.getType(t);return e?e.isAnimated:!0}get id(){return this._id}get state(){return this._state}get precedence(){return this._precedence}get activePartSet(){return this._activePartSet}get assetPartDefinition(){return this._assetPartDefinition}get lay(){return this._lay}get geometryType(){return this._geometryType}get isMain(){return this._isMain}get isDefault(){return this._isDefault}get isAnimation(){return this._isAnimation}get startFromFrameZero(){return this._startFromFrameZero}get prevents(){return this._prevents}get preventHeadTurn(){return this._preventHeadTurn}get params(){return this._params}}class Wo{constructor(t,e="",s=0){this._actionType=t||"",this._actionParameter=e||"",this._definition=null,this._startFrame=s||0,this._overridingAction=null}dispose(){this._actionType=null,this._actionParameter=null,this._definition=null}get id(){return this._definition?this._definition.id+"_"+this._actionParameter:""}get actionType(){return this._actionType}get actionParameter(){return this._actionParameter}set actionParameter(t){this._actionParameter=t}get definition(){return this._definition}set definition(t){this._definition=t}get startFrame(){return this._startFrame}get overridingAction(){return this._overridingAction}set overridingAction(t){this._overridingAction=t}}class uI{constructor(t,e){this._assets=t,this._actions=new Map,this._defaultAction=null,this.updateActions(e)}updateActions(t){if(t){for(const e of t.actions){if(!e||!e.state)continue;const s=new hI(e);this._actions.set(s.state,s)}t.actionOffsets&&this.parseActionOffsets(t.actionOffsets)}}parseActionOffsets(t){if(!(!t||!t.length))for(const e of t){const s=this._actions.get(e.action);if(s)for(const i of e.offsets){const r=i.size||"",a=i.direction;if(r===""||a===void 0)continue;const o=i.x||0,_=i.y||0,l=i.z||0;s.setOffsets(r,a,[o,_,l])}}}getActionDefinition(t){if(!t)return null;for(const e of this._actions.values())if(!(!e||e.id!==t))return e;return null}getActionDefinitionWithState(t){const e=this._actions.get(t);return e||null}getDefaultAction(){if(this._defaultAction)return this._defaultAction;for(const t of this._actions.values())if(!(!t||!t.isDefault))return this._defaultAction=t,t;return null}getCanvasOffsets(t,e,s){let i=[];for(const r of t){if(!r)continue;const a=this._actions.get(r.actionType),o=a&&a.getOffsets(e,s);o&&(i=o)}return i}sortActions(t){if(!t)return null;t=this.filterActions(t);const e=[];for(const s of t){if(!s)continue;const i=this._actions.get(s.actionType);i&&(s.definition=i,e.push(s))}return e.sort(this.sortByPrecedence),e}filterActions(t){let e=[];const s=[];for(const i of t){if(!i)continue;const r=this._actions.get(i.actionType);r&&(e=e.concat(r.getPrevents(i.actionParameter)))}for(const i of t){if(!i)continue;let r=i.actionType;i.actionType==="fx"&&(r=r+("."+i.actionParameter)),!(e.indexOf(r)>=0)&&s.push(i)}return s}sortByPrecedence(t,e){if(!t||!e)return 0;const s=t.definition.precedence,i=e.definition.precedence;return s<i?1:s>i?-1:0}}class lI{constructor(t,e){this._name=t,this._link=e.link,this._flipH=e.flipH,this._flipV=e.flipV}get name(){return this._name}get link(){return this._link}get flipH(){return this._flipH}get flipV(){return this._flipV}}class cI{constructor(t,e){this._avatarRenderManager=t,this._aliases=new Map,this._assets=e,this._missingAssetNames=[]}dispose(){this._assets=null,this._aliases=null}reset(){this.init()}init(){for(const t of this._assets.collections.values()){if(!t)continue;const e=t.data&&t.data.aliases;if(e)for(const s in e){const i=e[s];i&&this._aliases.set(s,new lI(s,i))}}}hasAlias(t){return!!this._aliases.get(t)}getAssetName(t){let e=t,s=5;for(;this.hasAlias(e)&&s>=0;)e=this._aliases.get(e).link,s--;return e}getAsset(t){if(!this._assets)return null;t=this.getAssetName(t);const e=this._assets.getAsset(t);return e||null}}class dI{constructor(t){this._id=t.id||"",this._align=t.align||"",this._base=t.base||"",this._ink=t.ink||0,this._blend=0;const e=t.blend;e&&e.length>0&&(this._blend=parseInt(e),this._blend>1&&(this._blend=this._blend/100))}get id(){return this._id}get align(){return this._align}get base(){return this._base}get ink(){return this._ink}get blend(){return this._blend}get isBlended(){return this._blend!==1}}class Be{constructor(t,e,s){if(this._id=t.id,this._animationFrame=t.frame||0,this._dx=t.dx||0,this._dy=t.dy||0,this._dz=t.dz||0,this._directionOffset=t.dd||0,this._type=e,this._base=t.base||"",this._items=new Map,t.items)for(const i of t.items)this._items.set(i.id,i.base);this._base!==""&&this.baseAsInt().toString(),s&&(this._action=new Wo(s.state,this.base),this._action.definition=s)}get items(){return this._items}baseAsInt(){let t=0,e=0;for(;e<this._base.length;)t=t+this._base.charCodeAt(e),e++;return t}get id(){return this._id}get animationFrame(){return this._animationFrame}get dx(){return this._dx}get dy(){return this._dy}get dz(){return this._dz}get dd(){return this._directionOffset}get type(){return this._type}get base(){return this._base}get action(){return this._action}}Be.BODYPART="bodypart";Be.FX="fx";class gI{constructor(t){this._ink=t.ink;let e=t.foreground,s=t.background;e=e.replace("#",""),s=s.replace("#",""),this._foreGround=parseInt(e,16),this._backGround=parseInt(s,16),this._colorTransform=null,this._rgb=parseInt(e,16),this._r=this._rgb>>16&255,this._g=this._rgb>>8&255,this._b=this._rgb>>0&255,this._redMultiplier=this._r/255*1,this._greenMultiplier=this._g/255*1,this._blueMultiplier=this._b/255*1,this._alphaMultiplier=1,this._paletteIsGrayscale=!0,this._ink===37&&(this._alphaMultiplier=.5,this._paletteIsGrayscale=!1),this._colorTransform=new lm({red:this._r/255,green:this._g/255,blue:this._b/255,alpha:this._alphaMultiplier}),this._colorMap=this.generatePaletteMapForGrayscale(this._backGround,this._foreGround)}get ink(){return this._ink}get colorTransform(){return this._colorTransform}get reds(){return this._colorMap.get("reds")}get greens(){return this._colorMap.get("greens")}get blues(){return this._colorMap.get("blues")}get alphas(){return this._colorMap.get("alphas")}get paletteIsGrayscale(){return this._paletteIsGrayscale}generatePaletteMapForGrayscale(t,e){const s=t>>24&255,i=t>>16&255,r=t>>8&255,a=t>>0&255,o=e>>24&255,_=e>>16&255,l=e>>8&255,c=e>>0&255,d=(o-s)/255,E=(_-i)/255,I=(l-r)/255,m=(c-a)/255,T=new Map,p=[],A=[],N=[];let C=s,L=i,D=r,v=a;for(let b=0;b<256;b++)L==i&&D==r&&v==a&&(C=0),C=C+d,L=L+E,D=D+I,v=v+m,p.push(C<<24|L<<16|D<<8|v),A.push(C<<24|L<<16|D<<8|v),N.push(C<<24|L<<16|D<<8|v);return T.set("alphas",p),T.set("reds",p),T.set("greens",A),T.set("blues",N),T}}class EI{constructor(t){this._offset=t.offset}get offset(){return this._offset}}class fI{constructor(t,e){this._animation=t,this._id=e.id,this._ink=e.ink,this._member=e.member,this._hasStaticY=!!e.staticY,this._hasDirections=!!e.directions,this._dx=[],this._dy=[],this._dz=[];const s=e.directionList;if(s&&s.length)for(const i of s){const r=i.id;r!==void 0&&(this._dx[r]=i.dx||0,this._dy[r]=i.dy||0,this._dz[r]=i.dz||0)}}getDirectionOffsetX(t){return t<this._dx.length?this._dx[t]:0}getDirectionOffsetY(t){return t<this._dy.length?this._dy[t]:0}getDirectionOffsetZ(t){return t<this._dz.length?this._dz[t]:0}get animation(){return this._animation}get id(){return this._id}get ink(){return this._ink}get member(){return this._member}get hasDirections(){return this._hasDirections}get hasStaticY(){return this._hasStaticY}}const dc=class wn{constructor(t,e){if(this._id=e.name,this._description=this._id,this._frames=[],this._spriteData=null,this._avatarData=null,this._directionData=null,this._removeData=null,this._addData=null,this._overriddenActions=null,this._overrideFrames=null,this._resetOnToggle=e.resetOnToggle||!1,e.sprites&&e.sprites.length){this._spriteData=[];for(const s of e.sprites)this._spriteData.push(new fI(this,s))}if(e.avatars&&e.avatars.length&&(this._avatarData=new gI(e.avatars[0])),e.directions&&e.directions.length&&(this._directionData=new EI(e.directions[0])),e.removes&&e.removes.length){this._removeData=[];for(const s of e.removes)this._removeData.push(s.id)}if(e.adds&&e.adds.length){this._addData=[];for(const s of e.adds)this._addData.push(new dI(s))}if(e.overrides&&e.overrides.length){this._overrideFrames=new Map,this._overriddenActions=new Map;for(const s of e.overrides){const i=s.name,r=s.override;this._overriddenActions.set(r,i);const a=[];this.parseFrames(a,s.frames,t),this._overrideFrames.set(i,a)}}this.parseFrames(this._frames,e.frames,t)}parseFrames(t,e,s){if(!(!e||!e.length))for(const i of e){let r=1;i.repeats&&i.repeats>1&&(r=i.repeats);let a=0;for(;a<r;){const o=[];if(i.bodyparts&&i.bodyparts.length)for(const _ of i.bodyparts){const l=s.getActionDefinition(_.action),c=new Be(_,Be.BODYPART,l);o.push(c)}if(i.fxs&&i.fxs.length)for(const _ of i.fxs){const l=s.getActionDefinition(_.action),c=new Be(_,Be.FX,l);o.push(c)}t.push(o),a++}}}frameCount(t=null){if(!t)return this._frames.length;if(this._overrideFrames){const e=this._overrideFrames.get(t);if(e)return e.length}return 0}hasOverriddenActions(){return this._overriddenActions?this._overriddenActions.size>0:!1}overriddenActionNames(){if(!this._overriddenActions)return null;const t=[];for(const e of this._overriddenActions.keys())t.push(e);return t}overridingAction(t){return this._overriddenActions?this._overriddenActions.get(t):null}getFrame(t,e=null){t<0&&(t=0);let s=[];if(!e)this._frames.length>0&&(s=this._frames[t%this._frames.length]);else{const i=this._overrideFrames.get(e);i&&i.length>0&&(s=i[t%i.length])}return s}getAnimatedBodyPartIds(t,e=null){const s=[];for(const i of this.getFrame(t,e))if(i.type===Be.BODYPART)s.push(i.id);else if(i.type===Be.FX&&this._addData&&this._addData.length)for(const r of this._addData)r.id===i.id&&s.push(r.align);return s}getLayerData(t,e,s=null){for(const i of this.getFrame(t,s)){if(i.id===e)return i;if(i.type===Be.FX&&this._addData&&this._addData.length){for(const r of this._addData)if(r.align===e&&r.id===i.id)return i}}return null}hasAvatarData(){return this._avatarData!==null}hasDirectionData(){return this._directionData!==null}hasAddData(){return this._addData!==null}getAddData(t){if(this._addData){for(const e of this._addData)if(e.id===t)return e}return null}get id(){return this._id}get spriteData(){return this._spriteData||wn.EMPTY_ARRAY}get avatarData(){return this._avatarData}get directionData(){return this._directionData}get removeData(){return this._removeData||wn.EMPTY_ARRAY}get addData(){return this._addData||wn.EMPTY_ARRAY}toString(){return this._description}get resetOnToggle(){return this._resetOnToggle}};dc.EMPTY_ARRAY=[];let mI=dc;class II{constructor(){this._animations=new Map}registerAnimation(t,e){if(!e)return!1;const s=e[Object.keys(e)[0]],i=new mI(t,s);return this._animations.set(s.name,i),!0}getAnimation(t){const e=this._animations.get(t);return e||null}getLayerData(t,e,s){const i=this.getAnimation(t);return i?i.getLayerData(e,s):null}get animations(){return this._animations}}const sn=class cs extends pe{constructor(t,e,s,i){super(),this._state=cs.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=i,this._assets=s,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=cs.LOADED)}async downloadAsset(){if(!this._assets||this._state===cs.LOADING||this._state===cs.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=cs.LOADED,this.dispatchEvent(new Qi(Qi.DOWNLOAD_COMPLETE,this));return}this._state=cs.LOADING,await this._assets.downloadAsset(this._downloadUrl)&&(this._state=cs.LOADED,this.dispatchEvent(new Qi(Qi.DOWNLOAD_COMPLETE,this)))}get libraryName(){return this._libraryName}get isLoaded(){return this._state===cs.LOADED}};sn.DOWNLOAD_COMPLETE="AADL_DOWNLOAD_COMPLETE";sn.NOT_LOADED=0;sn.LOADING=1;sn.LOADED=2;let RI=sn;const Ua=class ko extends pe{constructor(t,e){super(),this._assets=t,this._structure=e,this._missingMandatoryLibs=k.getValue("avatar.mandatory.libraries"),this._figureMap=new Map,this._pendingContainers=[],this._figureListeners=new Map,this._incompleteFigures=new Map,this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadFigureMap(),this._structure.renderManager.events.addEventListener(La.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadFigureMap(){const t=new XMLHttpRequest;try{t.open("GET",k.getValue("avatar.figuremap.url")),t.send(),t.onloadend=e=>{if(t.responseText){const s=JSON.parse(t.responseText);this.processFigureMap(s.libraries),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new rt(ko.DOWNLOADER_READY))}},t.onerror=e=>{throw new Error("invalid_avatar_figure_map")}}catch(e){G.error(e)}}processFigureMap(t){if(t)for(const e of t){if(!e)continue;const s=e.id,i=e.revision||"";if(this._libraryNames.indexOf(s)>=0)continue;this._libraryNames.push(s);const r=new RI(s,i,this._assets,k.getValue("avatar.asset.url"));r.addEventListener(Qi.DOWNLOAD_COMPLETE,this.onLibraryLoaded);for(const a of e.parts){const o=a.id,l=a.type+":"+o;let c=this._figureMap.get(l);c||(c=[]),c.push(r),this._figureMap.set(l,c)}}}onAvatarRenderReady(t){if(t){for(const[e,s]of this._pendingContainers)this.downloadAvatarFigure(e,s);this._pendingContainers=[]}}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];for(const[i,r]of this._incompleteFigures.entries()){let a=!0;for(const o of r)if(!(!o||o.isLoaded)){a=!1;break}if(a){e.push(i);const o=this._figureListeners.get(i);if(o)for(const _ of o)!_||_.disposed||_.resetFigure(i);this._figureListeners.delete(i),this.dispatchEvent(new rt(ko.LIBRARY_LOADED))}}for(const i of e)i&&this._incompleteFigures.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const s=this._figureMap.get(e);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarFigureContainerReady(t){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarFigurePendingLibraries(t).length}getAvatarFigurePendingLibraries(t){const e=[];if(!t||!this._structure)return e;const s=this._structure.figureData;if(!s)return e;const i=t.getPartTypeIds();for(const r of i){const a=s.getSetType(r);if(!a)continue;const o=a.getPartSet(t.getPartSetId(r));if(o)for(const _ of o.parts){if(!_)continue;const l=_.type+":"+_.id,c=this._figureMap.get(l);if(c!==void 0)for(const d of c)!d||d.isLoaded||e.indexOf(d)>=0||e.push(d)}}return e}downloadAvatarFigure(t,e){if(!this._isReady||!this._structure.renderManager.isReady){this._pendingContainers.push([t,e]);return}const s=t.getFigureString(),i=this.getAvatarFigurePendingLibraries(t);if(i&&i.length){if(e&&!e.disposed){let r=this._figureListeners.get(s);r||(r=[],this._figureListeners.set(s,r)),r.push(e)}this._incompleteFigures.set(s,i);for(const r of i)r&&this.downloadLibrary(r)}else e&&!e.disposed&&e.resetFigure(s)}downloadLibrary(t){!t||t.isLoaded||this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};Ua.DOWNLOADER_READY="AADM_DOWNLOADER_READY";Ua.LIBRARY_LOADED="AADM_LIBRARY_LOADED";Ua.MAX_DOWNLOADS=2;let Ar=Ua;class Hn{constructor(t){this._parts=new Map,this.parseFigure(t)}getPartTypeIds(){return this.partSets().keys()}hasPartType(t){return!!this.partSets().get(t)}getPartSetId(t){const e=this.partSets().get(t);return e?e.get("setid"):0}getPartColorIds(t){const e=this.partSets().get(t);return e?e.get("colorids"):null}updatePart(t,e,s){const i=new Map;i.set("type",t),i.set("setid",e),i.set("colorids",s);const r=this.partSets();r.delete(t),r.set(t,i)}removePart(t){this.partSets().delete(t)}getFigureString(){const t=[];for(const e of this.partSets().keys()){if(!e)continue;let s=[];s.push(e),s.push(this.getPartSetId(e)),s=s.concat(this.getPartColorIds(e)),t.push(s.join("-"))}return t.join(".")}partSets(){return this._parts||(this._parts=new Map),this._parts}parseFigure(t){t||(t="");for(const e of t.split(".")){const s=e.split("-");if(s.length>=2){const i=s[0],r=parseInt(s[1]),a=[];let o=2;for(;o<s.length;)a.push(parseInt(s[o])),o++;this.updatePart(i,r,a)}}}}class TI{constructor(){this._cache=new Map,this.setLastAccessTime($())}dispose(){if(this.debugInfo("[dispose]"),!!this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache.clear()}}getDirectionCache(t){const e=this._cache.get(t.toString());return e||null}updateDirectionCache(t,e){this._cache.set(t.toString(),e)}setLastAccessTime(t){this._lastAccessTime=t}getLastAccessTime(){return this._lastAccessTime}debugInfo(t){}}class mu{constructor(){this._cache=new Map}setAction(t,e){this._currentAction||(this._currentAction=t);const s=this.getActionCache(this._currentAction);s&&s.setLastAccessTime(e),this._currentAction=t}dispose(){if(!this._disposed){if(!this._cache)return;this.disposeActions(0,2147483647),this._cache.clear(),this._cache=null,this._disposed=!0}}disposeActions(t,e){if(!(!this._cache||this._disposed))for(const[s,i]of this._cache.entries()){if(!i)continue;const r=i.getLastAccessTime();e-r>=t&&(i.dispose(),this._cache.delete(s))}}getAction(){return this._currentAction}setDirection(t){this._currentDirection=t}getDirection(){return this._currentDirection}getActionCache(t=null){return this._currentAction?(t||(t=this._currentAction),t.overridingAction?this._cache.get(t.overridingAction):this._cache.get(t.id)):null}updateActionCache(t,e){t.overridingAction?this._cache.set(t.overridingAction,e):this._cache.set(t.id,e)}debugInfo(t){}}class pI{constructor(t,e,s){this._image=t,this._regPoint=e,this._offset=new Y(0,0),this._regPoint=e,this._isCacheable=s,this.cleanPoints()}dispose(){this._image&&this._image.destroy({children:!0}),this._image=null,this._regPoint=null,this._offset=null}cleanPoints(){}setRegPoint(t){this._regPoint=t,this.cleanPoints()}get image(){return this._image}set image(t){this._image&&this._image!==t&&this._image.destroy({children:!0}),this._image=t}get regPoint(){const t=this._regPoint.clone();return t.x+=this._offset.x,t.y+=this._offset.y,t}set offset(t){this._offset=t,this.cleanPoints()}get isCacheable(){return this._isCacheable}}class OI{constructor(t){this._partList=t,this._images=new Map}dispose(){for(const t of this._images.values())t&&t.dispose();this._images=null}getPartList(){return this._partList}getImageContainer(t){const e=this._images.get(this.getCacheKey(t));return e||null}updateImageContainer(t,e){const s=this.getCacheKey(e),i=this._images.get(s);i&&i.dispose(),this._images.set(s,t)}getCacheKey(t){let e="";for(const s of this._partList)e+=s.getCacheableKey(t)+"/";return e}debugInfo(t){}}class Iu{constructor(t,e,s,i,r,a=null){this._texture=t,this._container=a,this._rect=e,this._regPoint=s,this._flipH=i,this._colorTransform=r,i&&(this._regPoint.x=-this._regPoint.x+e.width)}dispose(){this._texture=null,this._regPoint=null,this._colorTransform=null}get texture(){return this._texture}get container(){return this._container}get rect(){return this._rect}get regPoint(){return this._regPoint}get flipH(){return this._flipH}get colorTransform(){return this._colorTransform}get offsetRect(){return new de(-this._regPoint.x,-this._regPoint.y,this._rect.width,this._rect.height)}}class gc{constructor(t,e,s,i){this._structure=t,this._avatar=e,this._assets=s,this._scale=i,this._cache=new Map,this._canvas=null,this._disposed=!1,this._unionImages=[],this._matrix=new ue,this._serverRenderData=[]}dispose(){if(!this._disposed){if(this._structure=null,this._avatar=null,this._assets=null,this._canvas=null,this._disposed=!0,this._cache){for(const t of this._cache.values())t&&t.dispose();this._cache=null}if(this._unionImages){for(const t of this._unionImages)t&&t.dispose();this._unionImages=[]}}}disposeInactiveActions(t=6e4){const e=$();if(this._cache)for(const s of this._cache.values())s&&s.disposeActions(t,e)}resetBodyPartCache(t){if(this._cache)for(const e of this._cache.values())e&&e.setAction(t,0)}setDirection(t,e){const s=this._structure.getBodyPartsUnordered(t);if(s)for(const i of s){const r=this.getBodyPartCache(i);r&&r.setDirection(e)}}setAction(t,e){const s=this._structure.getActiveBodyPartIds(t,this._avatar);for(const i of s){const r=this.getBodyPartCache(i);r&&r.setAction(t,e)}}setGeometryType(t){if(this._geometryType!==t){if(this._geometryType===He.SITTING&&t===He.VERTICAL||this._geometryType===He.VERTICAL&&t===He.SITTING||this._geometryType===He.SNOWWARS_HORIZONTAL&&(t=He.SNOWWARS_HORIZONTAL)){this._geometryType=t,this._canvas=null;return}this.disposeInactiveActions(0),this._geometryType=t,this._canvas=null}}getImageContainer(t,e,s=!1){let i=this.getBodyPartCache(t);i||(i=new mu,this._cache.set(t,i));let r=i.getDirection(),a=i.getAction(),o=e;a.definition.startFromFrameZero&&(o-=a.startFrame);let _=a,l=[],c=new Map;const d=new Y;if(!(!a||!a.definition)&&a.definition.isAnimation){let p=r;const A=this._structure.getAnimation(a.definition.state+"."+a.actionParameter),N=e-a.startFrame;if(A){const C=A.getLayerData(N,t,a.overridingAction);C&&(p=r+C.dd,C.dd<0?p<0?p=8+p:p>7&&(p=8-p):p<0?p=p+8:p>7&&(p=p-8),this._scale===es.LARGE?(d.x=C.dx,d.y=C.dy):(d.x=C.dx/2,d.y=C.dy/2),o=C.animationFrame,C.action&&(a=C.action),C.type===Be.BODYPART?(C.action!=null&&(_=C.action),r=p):C.type===Be.FX&&(r=p),c=C.items),l=A.removeData}}let E=i.getActionCache(_);(!E||s)&&(E=new TI,i.updateActionCache(_,E));let I=E.getDirectionCache(r);if(!I||s){const p=this._structure.getParts(t,this._avatar.getFigure(),_,this._geometryType,r,l,this._avatar,c);I=new OI(p),E.updateDirectionCache(r,I)}let m=I.getImageContainer(o);if(!m||s){const p=I.getPartList();if(m=this.renderBodyPart(r,p,o,a,s),m&&!s)m.isCacheable&&I.updateImageContainer(m,o);else return null}const T=this._structure.getFrameBodyPartOffset(_,r,o,t);return d.x+=T.x,d.y+=T.y,m.offset=d,m}getServerRenderData(){return this._serverRenderData=[],this._serverRenderData}getBodyPartCache(t){let e=this._cache.get(t);return e||(e=new mu,this._cache.set(t,e)),e}renderBodyPart(t,e,s,i,r=!1){if(!e||!e.length||!this._canvas&&(this._canvas=this._structure.getCanvas(this._scale,this._geometryType),!this._canvas))return null;const a=ts.DIRECTION_IS_FLIPPED[t]||!1;let o=i.definition.assetPartDefinition,_=!0,l=e.length-1;for(;l>=0;){const m=e[l];let T=16777215;if(!(t==7&&(m.partType==="fc"||m.partType==="ey"))&&!(m.partType==="ri"&&!m.partId)){const p=m.partId,A=m.getFrameDefinition(s);let N=m.partType,C=0;A?(C=A.number,A.assetPartDefinition&&A.assetPartDefinition!==""&&(o=A.assetPartDefinition)):C=m.getFrameIndex(s);let L=t,D=!1;a&&(o==="wav"&&(N===Oe.LEFT_HAND||N===Oe.LEFT_SLEEVE||N===Oe.LEFT_COAT_SLEEVE)||o==="drk"&&(N===Oe.RIGHT_HAND||N===Oe.RIGHT_SLEEVE||N===Oe.RIGHT_COAT_SLEEVE)||o==="blw"&&N===Oe.RIGHT_HAND||o==="sig"&&N===Oe.LEFT_HAND||o==="respect"&&N===Oe.LEFT_HAND||N===Oe.RIGHT_HAND_ITEM||N===Oe.LEFT_HAND_ITEM||N===Oe.CHEST_PRINT?D=!0:(t===4?L=2:t===5?L=1:t===6&&(L=0),m.flippedPartType!==N&&(N=m.flippedPartType)));let v=this._scale+"_"+o+"_"+N+"_"+p+"_"+L+"_"+C,b=this._assets.getAsset(v);if(b||(v=this._scale+"_std_"+N+"_"+p+"_"+L+"_0",b=this._assets.getAsset(v)),b){const q=b.texture;if(!q||!q.valid||!q.baseTexture)_=!1;else{m.isColorable&&m.color&&(T=m.color.rgb);const Q=new Y(-b.x,-b.y);if(D&&(Q.x=Q.x+(this._scale===es.LARGE?65:31)),r){const tt=new hl;tt.name=this._assets.getAssetName(v),tt.x=-Q.x-33,tt.y=-Q.y,tt.z=this._serverRenderData.length*-1e-4,tt.width=b.rectangle.width,tt.height=b.rectangle.height,tt.flipH=D,o==="lay"&&(tt.x=tt.x+53),a&&(tt.flipH=!tt.flipH,tt.flipH?tt.x=-tt.x-q.width:tt.x=tt.x+65),m.isColorable&&(tt.color=`${T}`),this._serverRenderData.push(tt)}this._unionImages.push(new Iu(q,b.rectangle,Q,D,T))}}}l--}if(!this._unionImages.length)return null;const c=this.createUnionImage(this._unionImages,a),d=this._scale===es.LARGE?this._canvas.height-16:this._canvas.height-8,E=new Y(-c.regPoint.x,d-c.regPoint.y);a&&o!=="lay"&&(E.x=E.x+(this._scale===es.LARGE?67:31));let I=this._unionImages.length-1;for(;I>=0;){const m=this._unionImages.pop();m&&m.dispose(),I--}return new pI(c.container,E,_)}convertColorToHex(t){let e=(t*255).toString(16);return e.length<2&&(e="0"+e),e}createUnionImage(t,e){const s=new de;for(const o of t)o&&s.enlarge(o.offsetRect);const i=new Y(-s.x,-s.y),r=new Ve,a=new Nt(Ct.EMPTY);a.width=s.width,a.height=s.height,r.addChild(a);for(const o of t){if(!o)continue;const _=o.texture,l=o.colorTransform,c=!(e&&o.flipH)&&(e||o.flipH),d=i.clone();d.x-=o.regPoint.x,d.y-=o.regPoint.y,e&&(d.x=r.width-(d.x+o.rect.width)),c?(this._matrix.a=-1,this._matrix.tx=o.rect.x+o.rect.width+d.x,this._matrix.ty=d.y-o.rect.y):(this._matrix.a=1,this._matrix.tx=d.x-o.rect.x,this._matrix.ty=d.y-o.rect.y);const E=new Nt(_);E.tint=l,E.transform.setFromMatrix(this._matrix),r.addChild(E)}return new Iu(null,r.getLocalBounds(),i,e,null,r)}}gc.DEFAULT_MAX_CACHE_STORAGE_TIME_MS=6e4;const as=class ds{constructor(t,e,s,i,r,a=null){this._frameCounter=0,this._directionOffset=0,this._isAnimating=!1,this._animationHasResetOnToggle=!1,this._actionsSorted=!1,this._fullImageCacheSize=5,this._isCachedImage=!1,this._useFullImageCache=!1,this._effectIdInUse=-1,this._cachedBodyPartsDirection=-1,this._cachedBodyPartsGeometryType=null,this._cachedBodyPartsAvatarSet=null,this._canvasOffsets=[],this._actions=[],this._cachedBodyParts=[],this._changes=!0,this._disposed=!1,this._effectManager=r,this._structure=t,this._assets=e,this._scale=i,this._effectListener=a,this._scale==null&&(this._scale=es.LARGE),s==null&&(s=new Hn("hr-893-45.hd-180-2.ch-210-66.lg-270-82.sh-300-91.wa-2007-.ri-1-")),this._figure=s,this._cache=new gc(this._structure,this,this._assets,this._scale),this.setDirection(ds.DEFAULT_AVATAR_SET,ds.DEFAULT_DIRECTION),this._actions=[],this._defaultAction=new Wo(w.POSTURE_STAND),this._defaultAction.definition=this._structure.getActionDefinition(ds.DEFAULT_ACTION),this.resetActions(),this._fullImageCache=new vt,this._animationFrameCount=0}getServerRenderData(){return this.getAvatarPartsForCamera(ie.FULL),this._cache.getServerRenderData()}dispose(){if(!this._disposed){if(this._structure=null,this._assets=null,this._mainAction=null,this._figure=null,this._avatarSpriteData=null,this._actions=null,this._image&&(this._image.destroy(),this._image=null),this._cache&&(this._cache.dispose(),this._cache=null),this._fullImageCache){for(const t of this._fullImageCache.getValues())t&&t.destroy();this._fullImageCache=null}this._image=null,this._canvasOffsets=null,this._disposed=!0}}get disposed(){return this._disposed}getFigure(){return this._figure}getScale(){return this._scale}getPartColor(t){return this._structure.getPartColor(this._figure,t)}setDirection(t,e){e=e+this._directionOffset,e<ts.MIN_DIRECTION&&(e=ts.MAX_DIRECTION+(e+1)),e>ts.MAX_DIRECTION&&(e=e-(ts.MAX_DIRECTION+1)),this._structure.isMainAvatarSet(t)&&(this._mainDirection=e),(t===ie.HEAD||t===ie.FULL)&&(t===ie.HEAD&&this.isHeadTurnPreventedByAction()&&(e=this._mainDirection),this._headDirection=e),this._cache.setDirection(t,e),this._changes=!0}setDirectionAngle(t,e){this.setDirection(t,Math.floor(e/45))}getSprites(){return this._sprites}getCanvasOffsets(){return this._canvasOffsets}getLayerData(t){return this._structure.getBodyPartData(t.animation.id,this._frameCounter,t.id)}updateAnimationByFrames(t=1){this._frameCounter+=t,this._changes=!0}resetAnimationFrameCounter(){this._frameCounter=0,this._changes=!0}getFullImageCacheKey(){if(!this._useFullImageCache)return null;if(this._sortedActions.length==1&&this._mainDirection==this._headDirection)return this._mainDirection+this._currentActionsString+this._frameCounter%4;if(this._sortedActions.length==2)for(const t of this._sortedActions){if(t.actionType=="fx"&&(t.actionParameter=="33"||t.actionParameter=="34"||t.actionParameter=="35"||t.actionParameter=="36"))return this._mainDirection+this._currentActionsString+0;if(t.actionType=="fx"&&(t.actionParameter=="38"||t.actionParameter=="39"))return this._mainDirection+"_"+this._headDirection+this._currentActionsString+this._frameCounter%11;if(t.actionType==="dance"&&(t.actionParameter==="1"||t.actionParameter==="2"||t.actionParameter==="3"||t.actionParameter==="4")){let e=this._frameCounter%8;return t.actionParameter==="3"&&(e=this._frameCounter%10),t.actionParameter==="4"&&(e=this._frameCounter%16),this._mainDirection+t.actionType+t.actionParameter+e}}return null}getBodyParts(t,e,s){return(s!=this._cachedBodyPartsDirection||e!=this._cachedBodyPartsGeometryType||t!=this._cachedBodyPartsAvatarSet)&&(this._cachedBodyPartsDirection=s,this._cachedBodyPartsGeometryType=e,this._cachedBodyPartsAvatarSet=t,this._cachedBodyParts=this._structure.getBodyParts(t,e,s)),this._cachedBodyParts}getAvatarPartsForCamera(t){let e;if(this._mainAction==null||this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType)==null)return;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection);let r=i.length-1;for(;r>=0;)e=i[r],this._cache.getImageContainer(e,this._frameCounter,!0),r--}getImage(t,e,s=1,i=!0){if(!this._changes)return this._image;if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const r=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!r)return null;this._image&&(this._image.width!==r.width||this._image.height!==r.height)&&(this._reusableTexture&&(this._reusableTexture.destroy(!0),this._reusableTexture=null),this._image=null,this._isCachedImage=!1);const a=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection);this._image=null;const o=new Ve;let _=!0,l=a.length-1;for(;l>=0;){const c=a[l],d=this._cache.getImageContainer(c,this._frameCounter);if(d){const E=d.image;if(!E)return o.destroy({children:!0}),null;_=_&&d.isCacheable;const I=d.regPoint.clone();if(I){I.x+=r.offset.x,I.y+=r.offset.y,I.x+=r.regPoint.x,I.y+=r.regPoint.y;const m=new Ve;m.addChild(E),m&&(m.position.set(I.x,I.y),o.addChild(m))}}l--}return this._avatarSpriteData&&(o.filters||(o.filters=[]),this._avatarSpriteData.colorTransform&&o.filters.push(this._avatarSpriteData.colorTransform),this._avatarSpriteData.paletteIsGrayscale&&(this.convertToGrayscale(o),o.filters.push(new uu(this._avatarSpriteData.reds,uu.CHANNEL_RED)))),i?(this._reusableTexture?(zt.instance.renderer.render(o,{renderTexture:this._reusableTexture,clear:!0}),this._reusableTexture.baseTexture.hitMap=null):this._reusableTexture=At.generateTexture(o,new de(0,0,r.width,r.height)),this._reusableTexture?(this._image=this._reusableTexture,this._changes=!1,this._image):null):At.generateTexture(o,new de(0,0,r.width,r.height))}applyPalette(t,e=[],s=[],i=[]){const r=At.generateCanvas(t),a=r.getContext("2d"),o=a.getImageData(0,0,r.width,r.height),_=o.data;for(let c=0;c<_.length;c+=4){if(e.length==256){let d=e[_[c]];d===void 0&&(d=0),_[c]=d>>16&255,_[c+1]=d>>8&255,_[c+2]=d&255}if(s.length==256){let d=s[_[c+1]];d===void 0&&(d=0),_[c]=d>>16&255,_[c+1]=d>>8&255,_[c+2]=d&255}if(i.length==256){let d=s[_[c+2]];d===void 0&&(d=0),_[c]=d>>16&255,_[c+1]=d>>8&255,_[c+2]=d&255}}a.putImageData(o,0,0);const l=new Mt(Ct.from(r));return zt.instance.renderer.render(l,{renderTexture:t,clear:!0}),t}getImageAsSprite(t,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection),r=new Nt,a=new Nt(Ct.EMPTY);a.width=s.width,a.height=s.height,r.addChild(a);let o=i.length-1;for(;o>=0;){const _=i[o],l=this._cache.getImageContainer(_,this._frameCounter);if(l){const c=l.image;if(!c)return r.destroy({children:!0}),null;const d=l.regPoint.clone();if(d){d.x+=s.offset.x,d.y+=s.offset.y,d.x+=s.regPoint.x,d.y+=s.regPoint.y;const E=new Ve;E.addChild(c),E.position.set(d.x,d.y),r.addChild(E)}}o--}return r}getCroppedImage(t,e=1){if(!this._mainAction)return null;this._actionsSorted||this.endActionAppends();const s=this._structure.getCanvas(this._scale,this._mainAction.definition.geometryType);if(!s)return null;const i=this.getBodyParts(t,this._mainAction.definition.geometryType,this._mainDirection),r=new Ve;let a=i.length-1;for(;a>=0;){const l=i[a],c=this._cache.getImageContainer(l,this._frameCounter);if(c){const d=c.image;if(!d)return r.destroy({children:!0}),null;const E=c.regPoint.clone();if(E){E.x+=s.offset.x,E.y+=s.offset.y,E.x+=s.regPoint.x,E.y+=s.regPoint.y;const I=new Ve;I.addChild(d),I&&(I.position.set(E.x,E.y),r.addChild(I))}}a--}const o=At.generateTexture(r,new de(0,0,s.width,s.height)),_=At.generateImage(o);return _||null}getFullImage(t){const e=this._fullImageCache.getValue(t);return e?(e.valid||(this._fullImageCache.remove(t),e.destroy(!0)),e):null}cacheFullImage(t,e){const s=this._fullImageCache.getValue(t);if(s&&(this._fullImageCache.remove(t),s.destroy(!0)),this._fullImageCache.length===this._fullImageCacheSize){const i=this._fullImageCache.getKey(0);i&&this._fullImageCache.remove(i).destroy(!0)}this._fullImageCache.add(t,e)}getAsset(t){return this._assets.getAsset(t)}getDirection(){return this._mainDirection}initActionAppends(){this._actions=[],this._actionsSorted=!1,this._currentActionsString="",this._useFullImageCache=!1}endActionAppends(){if(this.sortActions()){for(const t of this._sortedActions)t.actionType===w.EFFECT&&(this._effectManager.isAvatarEffectReady(parseInt(t.actionParameter))||this._effectManager.downloadAvatarEffect(parseInt(t.actionParameter),this));this.resetActions(),this.setActionsToParts()}}appendAction(t,...e){let s="";switch(this._actionsSorted=!1,e&&e.length>0&&(s=e[0]),s!=null&&(s=s.toString()),t){case w.POSTURE:switch(s){case w.POSTURE_LAY:case w.POSTURE_WALK:case w.POSTURE_STAND:case w.POSTURE_SWIM:case w.POSTURE_FLOAT:case w.POSTURE_SIT:case w.SNOWWAR_RUN:case w.SNOWWAR_DIE_FRONT:case w.SNOWWAR_DIE_BACK:case w.SNOWWAR_PICK:case w.SNOWWAR_THROW:(s===w.POSTURE_LAY||s===w.POSTURE_LAY||s===w.POSTURE_LAY)&&(s===w.POSTURE_LAY&&(this._mainDirection==0?this.setDirection(ie.FULL,4):this.setDirection(ie.FULL,2)),this._useFullImageCache=!0,this._useFullImageCache=!0),this.addActionData(s);break}break;case w.GESTURE:switch(s){case w.GESTURE_AGGRAVATED:case w.GESTURE_SAD:case w.GESTURE_SMILE:case w.GESTURE_SURPRISED:this.addActionData(s);break}break;case w.EFFECT:case w.DANCE:case w.TALK:case w.EXPRESSION_WAVE:case w.SLEEP:case w.SIGN:case w.EXPRESSION_RESPECT:case w.EXPRESSION_BLOW_A_KISS:case w.EXPRESSION_LAUGH:case w.EXPRESSION_CRY:case w.EXPRESSION_IDLE:case w.EXPRESSION_SNOWBOARD_OLLIE:case w.EXPRESSION_SNOWBORD_360:case w.EXPRESSION_RIDE_JUMP:s===w.EFFECT&&(s==="33"||s==="34"||s==="35"||s==="36"||s==="38"||s==="39")&&(this._useFullImageCache=!0),this.addActionData(t,s);break;case w.CARRY_OBJECT:case w.USE_OBJECT:{const i=this._structure.getActionDefinitionWithState(t);i&&(s=i.getParameterValue(s)),this.addActionData(t,s);break}}return!0}addActionData(t,e=""){let s;this._actions||(this._actions=[]);let i=0;for(;i<this._actions.length;){if(s=this._actions[i],s.actionType==t&&s.actionParameter==e)return;i++}this._actions.push(new Wo(t,e,this._frameCounter))}isAnimating(){return this._isAnimating||this._animationFrameCount>1}resetActions(){return this._animationHasResetOnToggle=!1,this._isAnimating=!1,this._sprites=[],this._avatarSpriteData=null,this._directionOffset=0,this._structure.removeDynamicItems(this),this._mainAction=this._defaultAction,this._mainAction.definition=this._defaultAction.definition,this.resetBodyPartCache(this._defaultAction),!0}isHeadTurnPreventedByAction(){let t,e;if(this._sortedActions==null)return!1;for(const s of this._sortedActions)t=this._structure.getActionDefinitionWithState(s.actionType),t!=null&&t.getPreventHeadTurn(s.actionParameter)&&(e=!0);return e}sortActions(){let t,e,s;if(this._currentActionsString="",this._sortedActions=this._structure.sortActions(this._actions),this._animationFrameCount=this._structure.maxFrames(this._sortedActions),!this._sortedActions)this._canvasOffsets=[0,0,0],this._lastActionsString!==""&&(s=!0,this._lastActionsString="");else{this._canvasOffsets=this._structure.getCanvasOffsets(this._sortedActions,this._scale,this._mainDirection);for(const i of this._sortedActions)if(this._currentActionsString=this._currentActionsString+(i.actionType+i.actionParameter),i.actionType===w.EFFECT){const r=parseInt(i.actionParameter);this._effectIdInUse!==r&&(t=!0),this._effectIdInUse=r,e=!0}e||(this._effectIdInUse>-1&&(t=!0),this._effectIdInUse=-1),t&&this._cache.disposeInactiveActions(0),this._lastActionsString!=this._currentActionsString&&(s=!0,this._lastActionsString=this._currentActionsString)}return this._actionsSorted=!0,s}setActionsToParts(){if(!this._sortedActions==null)return;const t=$(),e=[];for(const s of this._sortedActions)e.push(s.actionType);for(const s of this._sortedActions)if(s&&s.definition&&s.definition.isAnimation){const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);if(i&&i.hasOverriddenActions()){const r=i.overriddenActionNames();if(r)for(const a of r)e.indexOf(a)>=0&&(s.overridingAction=i.overridingAction(a))}i&&i.resetOnToggle&&(this._animationHasResetOnToggle=!0)}for(const s of this._sortedActions)if(!(!s||!s.definition)&&(s.definition.isAnimation&&s.actionParameter===""&&(s.actionParameter="1"),this.setActionToParts(s,t),s.definition.isAnimation)){this._isAnimating=s.definition.isAnimated(s.actionParameter);const i=this._structure.getAnimation(s.definition.state+"."+s.actionParameter);i&&(this._sprites=this._sprites.concat(i.spriteData),i.hasDirectionData()&&(this._directionOffset=i.directionData.offset),i.hasAvatarData()&&(this._avatarSpriteData=i.avatarData))}}setActionToParts(t,e){t==null||t.definition==null||t.definition.assetPartDefinition!=""&&(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.setAction(t,e),this._changes=!0)}resetBodyPartCache(t){t&&t.definition.assetPartDefinition!==""&&(t.definition.isMain&&(this._mainAction=t,this._cache.setGeometryType(t.definition.geometryType)),this._cache.resetBodyPartCache(t),this._changes=!0)}get avatarSpriteData(){return this._avatarSpriteData}convertToGrayscale(t,e="CHANNELS_EQUAL"){let s=.33,i=.33,r=.33;switch(e){case ds.CHANNELS_UNIQUE:s=.3,i=.59,r=.11;break;case ds.CHANNELS_RED:s=1,i=0,r=0;break;case ds.CHANNELS_GREEN:s=0,i=1,r=0;break;case ds.CHANNELS_BLUE:s=0,i=0,r=1;break;case ds.CHANNELS_DESATURATED:s=.3086,i=.6094,r=.082;break}const a=new Hu;return a.matrix=[s,i,r,0,0,s,i,r,0,0,s,i,r,0,0,0,0,0,1,0],t.filters.push(a),t}errorThis(t){}logThis(t){}isPlaceholder(){return!1}forceActionUpdate(){this._lastActionsString=""}get animationHasResetOnToggle(){return this._animationHasResetOnToggle}get mainAction(){return this._mainAction.actionType}resetEffect(t){t===this._effectIdInUse&&(this.resetActions(),this.setActionsToParts(),this._animationHasResetOnToggle=!0,this._changes=!0,this._effectListener&&this._effectListener.resetEffect(t))}};as.CHANNELS_EQUAL="CHANNELS_EQUAL";as.CHANNELS_UNIQUE="CHANNELS_UNIQUE";as.CHANNELS_RED="CHANNELS_RED";as.CHANNELS_GREEN="CHANNELS_GREEN";as.CHANNELS_BLUE="CHANNELS_BLUE";as.CHANNELS_DESATURATED="CHANNELS_DESATURATED";as.DEFAULT_ACTION="Default";as.DEFAULT_DIRECTION=2;as.DEFAULT_AVATAR_SET=ie.FULL;let Ec=as;class Vn{constructor(t){this._number=t.number,this._assetPartDefinition=t.assetPartDefinition||null}get number(){return this._number}get assetPartDefinition(){return this._assetPartDefinition}}class AI{constructor(t){if(this._frames=[],t.frames&&t.frames.length>0)for(const e of t.frames){if(!e)continue;this._frames.push(new Vn(e));let s=e.repeats||0;if(s>1)for(;--s>0;)this._frames.push(this._frames[this._frames.length-1])}}get frames(){return this._frames}}const fc=class jn{constructor(t){if(this._id=t.id,this._actionParts=new Map,this._bodyPartOffsets=new Map,this._frameCount=0,this._frameIndexes=[],t.parts&&t.parts.length>0)for(const e of t.parts){if(!e)continue;const s=new AI(e);this._actionParts.set(e.setType,s),this._frameCount=Math.max(this._frameCount,s.frames.length)}if(t.offsets&&t.offsets.frames&&t.offsets.frames.length>0)for(const e of t.offsets.frames){if(!e)continue;const s=e.id;this._frameCount=Math.max(this._frameCount,s);const i=new Map;if(this._bodyPartOffsets.set(s,i),e.directions&&e.directions.length>0)for(const r of e.directions){if(!r)continue;const a=r.id,o=new Map;if(i.set(a,o),r.bodyParts&&r.bodyParts.length>0)for(const _ of r.bodyParts){if(!_)continue;const l=_.id;let c=0,d=0;_.dx!==void 0&&(c=_.dx),_.dy!==void 0&&(d=_.dy),o.set(l,new Y(c,d))}}if(this._frameIndexes.push(s),e.repeats!==void 0){let r=e.repeats||0;if(r>1)for(;--r>0;)this._frameIndexes.push(s)}}}getPart(t){if(!t)return null;const e=this._actionParts.get(t);return e||null}getFrameBodyPartOffset(t,e,s){const i=e%this._frameIndexes.length,r=this._frameIndexes[i],a=this._bodyPartOffsets.get(r);if(!a)return jn.DEFAULT_OFFSET;const o=a.get(t);if(!o)return jn.DEFAULT_OFFSET;const _=o.get(s);return _||jn.DEFAULT_OFFSET}get id(){return this._id}get parts(){return this._actionParts}get frameCount(){return this._frameCount}};fc.DEFAULT_OFFSET=new Y(0,0);let Ko=fc;class SI{constructor(){this._actions=new Map}parse(t){if(t&&t.length>0)for(const e of t){if(!e)continue;const s=new Ko(e);this._actions.set(s.id,s)}return!0}appendJSON(t){for(const e of t.action)this._actions.set(e.id,new Ko(e));return!0}getAction(t){const e=this._actions.get(t.id);return e||null}getFrameCount(t){const e=this.getAction(t);return e?e.frameCount:0}}class MI{constructor(t,e){this._id=t.id,this._width=t.width,this._height=t.height,this._offset=new Y(t.dx,t.dy),e==es.LARGE?this._regPoint=new Y((this._width-64)/2,0):this._regPoint=new Y((this._width-32)/2,0)}get width(){return this._width}get height(){return this._height}get offset(){return this._offset}get id(){return this._id}get regPoint(){return this._regPoint}}const mc=class Ic extends pe{constructor(t,e){super(),this._dataReceiver=e,this.download(t)}download(t){const e=new XMLHttpRequest;try{e.open("GET",t),e.send(),e.onloadend=s=>{const i=e.responseText;if(!i||!i.length)throw new Error("invalid_figure_data");this._dataReceiver&&this._dataReceiver.appendJSON(JSON.parse(i)),this.dispatchEvent(new rt(Ic.AVATAR_STRUCTURE_DONE))},e.onerror=s=>{throw new Error("invalid_avatar_figure_data")}}catch(s){G.error(s)}}};mc.AVATAR_STRUCTURE_DONE="AVATAR_STRUCTURE_DONE";let Ru=mc;class CI{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._type=t.type,this._index=t.index,this._colorLayerIndex=t.colorindex,this._paletteMapId=-1,this._breed=-1}dispose(){}get id(){return this._id}get type(){return this._type}get breed(){return this._breed}get index(){return this._index}get colorLayerIndex(){return this._colorLayerIndex}get paletteMap(){return this._paletteMapId}}class NI{constructor(t,e){if(!t||!e)throw new Error("invalid_data");this._id=e.id,this._type=t,this._gender=e.gender,this._clubLevel=e.club,this._isColorable=e.colorable,this._isSelectable=e.selectable,this._parts=[],this._hiddenLayers=[],this._isPreSelectable=e.preselectable,this._isSellable=e.sellable;for(const s of e.parts){const i=new CI(s),r=this.getPartIndex(i);r!==-1?this._parts.splice(r,0,i):this._parts.push(i)}if(e.hiddenLayers)for(const s of e.hiddenLayers)this._hiddenLayers.push(s.partType)}dispose(){for(const t of this._parts)t.dispose();this._parts=null,this._hiddenLayers=null}getPartIndex(t){const e=this._parts.length;if(!e)return-1;for(let s=0;s<e;s++){const i=this._parts[s];if(i&&!(i.type!==t.type||i.index>t.index))return s}return-1}getPart(t,e){for(const s of this._parts)if(!(s.type!==t||s.id!==e))return s;return null}get id(){return this._id}get type(){return this._type}get gender(){return this._gender}get clubLevel(){return this._clubLevel}get isColorable(){return this._isColorable}get isSelectable(){return this._isSelectable}get parts(){return this._parts}get hiddenLayers(){return this._hiddenLayers}get isPreSelectable(){return this._isPreSelectable}get isSellable(){return this._isSellable}}class DI{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._index=t.index,this._clubLevel=t.club||0,this._isSelectable=t.selectable,this._rgb=parseInt("0x"+t.hexCode,16)}get id(){return this._id}get index(){return this._index}get clubLevel(){return this._clubLevel}get isSelectable(){return this._isSelectable}get rgb(){return this._rgb}}class Tu{constructor(t){if(!t)throw new Error("invalid_data");this._id=t.id,this._colors=new vt,this.append(t)}append(t){for(const e of t.colors){const s=new DI(e);this._colors.add(e.id.toString(),s)}}getColor(t){return t===void 0||t<0?null:this._colors.getValue(t.toString())||null}get id(){return this._id}get colors(){return this._colors}}class To{constructor(t){if(!t)throw new Error("invalid_data");this._type=t.type,this._paletteId=t.paletteId,this._isMandatory={},this._isMandatory.F=[t.mandatory_f_0,t.mandatory_f_1],this._isMandatory.M=[t.mandatory_m_0,t.mandatory_m_1],this._partSets=new vt,this.append(t)}dispose(){for(const t of this._partSets.getValues())t.dispose();this._partSets=null}cleanUp(t){for(const e of t.sets){const s=e.id.toString(),i=this._partSets.getValue(s);i&&(i.dispose(),this._partSets.remove(s))}}append(t){if(!(!t||!t.sets))for(const e of t.sets)this._partSets.add(e.id.toString(),new NI(this._type,e))}getDefaultPartSet(t){for(const e of this._partSets.getValues())if(e&&e.clubLevel===0&&(e.gender===t||e.gender==="U"))return e;return null}getPartSet(t){return this._partSets.getValue(t.toString())}get type(){return this._type}get paletteID(){return this._paletteId}isMandatory(t,e){return this._isMandatory[t.toUpperCase()][Math.min(e,1)]}optionalFromClubLevel(t){return this._isMandatory[t.toUpperCase()].indexOf(!1)}get partSets(){return this._partSets}}class PI{constructor(){this._palettes=new Map,this._setTypes=new Map}dispose(){}parse(t){if(!t)return!1;for(const e of t.palettes){const s=new Tu(e);s&&this._palettes.set(s.id.toString(),s)}for(const e of t.setTypes){const s=new To(e);s&&this._setTypes.set(s.type,s)}return!0}injectJSON(t){for(const e of t.setTypes){const s=this._setTypes.get(e.type);s?s.cleanUp(e):this._setTypes.set(e.type,new To(e))}this.appendJSON(t)}appendJSON(t){if(!t)return!1;for(const e of t.palettes){const s=e.id.toString(),i=this._palettes.get(s);i?i.append(e):this._palettes.set(s,new Tu(e))}for(const e of t.setTypes){const s=e.type,i=this._setTypes.get(s);i?i.append(e):this._setTypes.set(s,new To(e))}return!1}getMandatorySetTypeIds(t,e){const s=[];for(const i of this._setTypes.values())!i||!i.isMandatory(t,e)||s.push(i.type);return s}getDefaultPartSet(t,e){const s=this._setTypes.get(t);return s?s.getDefaultPartSet(e):null}getSetType(t){return this._setTypes.get(t)||null}getPalette(t){return this._palettes.get(t.toString())||null}getFigurePartSet(t){for(const e of this._setTypes.values()){const s=e.getPartSet(t);if(s)return s}return null}}class pu{constructor(t){if(this._id=t.id,this._parts=[],t.activeParts&&t.activeParts.length>0)for(const e of t.activeParts)e&&this._parts.push(e.setType)}get parts(){return this._parts}}class po{constructor(t){if(!t)throw new Error("invalid_data");this._setType=t.setType,this._flippedSetType=t.flippedSetType||null,this._removeSetType=t.removeSetType||null,this._appendToFigure=!1,this._staticId=-1}hasStaticId(){return this._staticId>=0}get staticId(){return this._staticId}set staticId(t){this._staticId=t}get setType(){return this._setType}get flippedSetType(){return this._flippedSetType}set flippedSetType(t){this._flippedSetType=t}get removeSetType(){return this._removeSetType}get appendToFigure(){return this._appendToFigure}set appendToFigure(t){this._appendToFigure=t}}class yI{constructor(){this._parts=new Map,this._activePartSets=new Map}parse(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new po(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new pu(e));return!0}appendJSON(t){if(t.partSet&&t.partSet.length>0)for(const e of t.partSet)e&&this._parts.set(e.setType,new po(e));if(t.activePartSets&&t.activePartSets.length>0)for(const e of t.activePartSets)e&&this._activePartSets.set(e.id,new pu(e));return!1}getActiveParts(t){const e=this._activePartSets.get(t.activePartSet);return e?e.parts:[]}getPartDefinition(t){const e=this._parts.get(t);return e||null}addPartDefinition(t){const e=t.setType;let s=this._parts.get(e);return s||(s=new po(t),this._parts.set(e,s)),s}getActivePartSet(t){const e=this._activePartSets.get(t.activePartSet);return e||null}get parts(){return this._parts}get activePartSets(){return this._activePartSets}}class Oo{constructor(t,e,s,i,r,a,o,_,l="",c=!1,d=1){this._bodyPartId=t,this._partType=e,this._partId=s,this._color=i,this._frames=r,this._action=a,this._isColorable=o,this._paletteMapId=_,this._flippedPartType=l,this._isBlendable=c,this._blendTransform=null,this._partType==="ey"&&(this._isColorable=!1)}getFrameIndex(t){if(!this._frames||!this._frames.length)return 0;const e=t%this._frames.length;return this._frames[e]instanceof Vn?this._frames[e].number:e}getFrameDefinition(t){const e=t%this._frames.length;return this._frames&&this._frames.length>e&&this._frames[e]instanceof Vn?this._frames[e]:null}getCacheableKey(t){const e=t%this._frames.length;if(this._frames&&this._frames.length>e&&this._frames[e]instanceof Vn){const s=this._frames[e];return this.partId+":"+s.assetPartDefinition+":"+s.number}return this.partId+":"+e}get bodyPartId(){return this._bodyPartId}get partType(){return this._partType}get partId(){return this._partId}get color(){return this._color}get action(){return this._action}get isColorable(){return this._isColorable}set isColorable(t){this._isColorable=t}get paletteMapId(){return this._paletteMapId}get flippedPartType(){return this._flippedPartType}get isBlendable(){return this._isBlendable}toString(){return[this._bodyPartId,this._partType,this._partId].join(":")}}const Ft=class pt{constructor(){this._gender="M",this._avatarEffectType=-1}loadAvatarData(t,e){this._data=new Map,this._colors=new Map,this._gender=e,this.parseFigureString(t)}dispose(){this._data=null,this._colors=null,this._isDisposed=!0}get disposed(){return this._isDisposed}parseFigureString(t){if(t)for(const e of t.split(".")){const s=e.split("-");if(s.length>0){const i=s[0],r=parseInt(s[1]),a=[];let o=2;for(;o<s.length;)a.push(parseInt(s[o])),o++;a.length||a.push(0),this.savePartSetId(i,r,!1),this.savePartSetColourId(i,a,!1)}}}hasSetType(t){return!!this._data.get(t)}getPartSetId(t){return this.hasSetType(t)?this._data.get(t):-1}getColourIds(t){return this._colors.get(t)?this._colors.get(t):[]}getFigureString(){let t="";const e=[];for(const[i,r]of this._data.entries()){let a=i+"-"+r;const o=this._colors.get(i);if(o)for(const _ of o)a=a+("-"+_);e.push(a)}let s=0;for(;s<e.length;)t=t+e[s],s<e.length-1&&(t=t+"."),s++;return t}savePartData(t,e,s,i=!1){this.savePartSetId(t,e,i),this.savePartSetColourId(t,s,i)}savePartSetId(t,e,s=!0){switch(t){case pt.HD:case pt.HAIR:case pt.HAT:case pt.HEAD_ACCESSORIES:case pt.EYE_ACCESSORIES:case pt.FACE_ACCESSORIES:case pt.SHIRT:case pt.JACKET:case pt.CHEST_ACCESSORIES:case pt.CHEST_PRINTS:case pt.TROUSERS:case pt.SHOES:case pt.TROUSER_ACCESSORIES:e>=0?this._data.set(t,e):this._data.delete(t)}}savePartSetColourId(t,e,s=!0){switch(t){case pt.HD:case pt.HAIR:case pt.HAT:case pt.HEAD_ACCESSORIES:case pt.EYE_ACCESSORIES:case pt.FACE_ACCESSORIES:case pt.SHIRT:case pt.JACKET:case pt.CHEST_ACCESSORIES:case pt.CHEST_PRINTS:case pt.TROUSERS:case pt.SHOES:case pt.TROUSER_ACCESSORIES:this._colors.set(t,e);return}}getFigureStringWithFace(t){const e=[pt.HD];let s="";const i=[];for(const a of e){const o=this._colors.get(a);if(o){let _=this._data.get(a);a===pt.HD&&(_=t);let l=a+"-"+_;if(_>=0){let c=0;for(;c<o.length;)l=l+("-"+o[c]),c++}i.push(l)}}let r=0;for(;r<i.length;)s=s+i[r],r<i.length-1&&(s=s+"."),r++;return s}get gender(){return this._gender}};Ft.MALE="M";Ft.FEMALE="F";Ft.UNISEX="U";Ft.SCALE="h";Ft.STD="std";Ft.DEFAULT_FRAME="0";Ft.HD="hd";Ft.HAIR="hr";Ft.HAT="ha";Ft.HEAD_ACCESSORIES="he";Ft.EYE_ACCESSORIES="ea";Ft.FACE_ACCESSORIES="fa";Ft.JACKET="cc";Ft.SHIRT="ch";Ft.CHEST_ACCESSORIES="ca";Ft.CHEST_PRINTS="cp";Ft.TROUSERS="lg";Ft.SHOES="sh";Ft.TROUSER_ACCESSORIES="wa";Ft.BLOCKED_FX_TYPES=[28,29,30,33,34,35,36,37,38,39,40,41,42,43,68];let LI=Ft;class pj{constructor(t){this._data=[],this._maxSize=t,this._index=0}reset(){this._data=[],this._index=0}addValue(t){this._data.length<this._maxSize?this._data.push(t):this._data[this._index]=t,this._index=(this._index+1)%this._maxSize}getMax(){let t=Number.MIN_VALUE,e=0;for(;e<this._maxSize;)this._data[e]>t&&(t=this._data[e]),e++;return t}getMin(){let t=Number.MAX_VALUE,e=0;for(;e<this._maxSize;)this._data[e]<t&&(t=this._data[e]),e++;return t}}class bt{constructor(t,e){this._location=t,this._direction=e}get location(){return this._location}get direction(){return this._direction}}class va extends ge{constructor(){super(),this._object=null,this._events=null,this._time=0}initialize(t){}onDispose(){this._object=null}update(t){this._time=t}processUpdateMessage(t){!t||!this._object||(this._object.setLocation(t.location),this._object.setDirection(t.direction))}getEventTypes(){return[]}mergeTypes(t,e){const s=t.concat();for(const i of e)!i||s.indexOf(i)>=0||s.push(i);return s}mouseEvent(t,e){}useObject(){}setObject(t){if(this._object!==t){if(this._object&&this._object.setLogic(null),!t){this.dispose(),this._object=null;return}this._object=t,this._object.setLogic(this)}}tearDown(){}get object(){return this._object}get eventDispatcher(){return this._events}set eventDispatcher(t){this._events=t}get widget(){return null}get contextMenu(){return null}get time(){return this._time}}class Rc{constructor(){this._map=new Map,this._updateCounter=0}dispose(){this._map.clear(),this._updateCounter=0}getValue(t){return this._map.get(t)}setValue(t,e){this._map.has(t)&&this._map.get(t)===e||(this._map.set(t,e),this._updateCounter++)}removeKey(t){t&&(this._map.delete(t),this._updateCounter++)}get updateCounter(){return this._updateCounter}}const Tc=class pc extends ge{constructor(t,e,s){super(),this._id=t,this._instanceId=pc.OBJECT_COUNTER++,this._type=s,this._model=new Rc,this._location=new R,this._direction=new R,this._states=[],this._visualization=null,this._logic=null,this._pendingLogicMessages=[],this._updateCounter=0,this._isReady=!1;let i=e-1;for(;i>=0;)this._states[i]=0,i--}onDispose(){this._pendingLogicMessages=[],this.setVisualization(null),this.setLogic(null),this._model&&this._model.dispose(),super.onDispose()}getLocation(){return this._location}setLocation(t){t&&(t.x===this._location.x&&t.y===this._location.y&&t.z===this._location.z||(this._location.x=t.x,this._location.y=t.y,this._location.z=t.z,this._updateCounter++))}getDirection(){return this._direction}setDirection(t){t&&(t.x===this._direction.x&&t.y===this._direction.y&&t.z===this._direction.z||(this._direction.x=(t.x%360+360)%360,this._direction.y=(t.y%360+360)%360,this._direction.z=(t.z%360+360)%360,this._updateCounter++))}getState(t=0){return t>=0&&t<this._states.length?this._states[t]:-1}setState(t,e=0){return e>=0&&e<this._states.length?(this._states[e]!==t&&(this._states[e]=t,this._updateCounter++),!0):!1}setVisualization(t){this._visualization!==t&&(this._visualization&&this._visualization.dispose(),this._visualization=t,this._visualization&&(this._visualization.object=this))}setLogic(t){if(this._logic===t)return;const e=this._logic;if(e&&(this._logic=null,e.setObject(null)),this._logic=t,this._logic)for(this._logic.setObject(this);this._pendingLogicMessages.length;){const s=this._pendingLogicMessages.shift();this._logic.processUpdateMessage(s)}}processUpdateMessage(t){if(this._logic)return this._logic.processUpdateMessage(t);this._pendingLogicMessages.push(t)}tearDown(){this._logic&&this._logic.tearDown()}get id(){return this._id}get instanceId(){return this._instanceId}get type(){return this._type}get model(){return this._model}get visualization(){return this._visualization}get mouseHandler(){return this._logic}get logic(){return this._logic}get location(){return this._location}get direction(){return this._direction}get updateCounter(){return this._updateCounter}set updateCounter(t){this._updateCounter=t}get isReady(){return this._isReady}set isReady(t){this._isReady=t}};Tc.OBJECT_COUNTER=0;let UI=Tc;const Oc=class Ac{constructor(){this._id=Ac.SPRITE_COUNTER++,this._name="",this._type="",this._spriteType=he.DEFAULT,this._texture=null,this._container=null,this._width=0,this._height=0,this._offsetX=0,this._offsetY=0,this._flipH=!1,this._flipV=!1,this._direction=0,this._alpha=255,this._blendMode=Cs.NORMAL,this._color=16777215,this._relativeDepth=0,this._varyingDepth=!1,this._libraryAssetName="",this._clickHandling=!1,this._visible=!0,this._tag="",this._posture=null,this._alphaTolerance=Ne.MATCH_OPAQUE_PIXELS,this._filters=[],this._updateCounter=0,this._updateContainer=!1}dispose(){this._texture=null,this._width=0,this._height=0}get id(){return this._id}set id(t){this._id=t}get name(){return this._name}set name(t){this._name!==t&&(this._name=t,this._updateCounter++)}get type(){return this._type}set type(t){this._type=t}get spriteType(){return this._spriteType}set spriteType(t){this._spriteType=t}get texture(){return this._texture}set texture(t){this._texture!==t&&(t&&(this._width=t.width,this._height=t.height),this._texture=t,this._updateCounter++)}get container(){return this._container}set container(t){this._container!==t&&(this.texture=Ct.EMPTY,t&&(this._width=t.width,this._height=t.height),this._container=t,this._updateCounter++,this._updateContainer=!0)}get width(){return this._width}get height(){return this._height}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX!==t&&(this._offsetX=t,this._updateCounter++)}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY!==t&&(this._offsetY=t,this._updateCounter++)}get flipH(){return this._flipH}set flipH(t){this._flipH!==t&&(this._flipH=t,this._updateCounter++)}get flipV(){return this._flipV}set flipV(t){this._flipV!==t&&(this._flipV=t,this._updateCounter++)}get direction(){return this._direction}set direction(t){this._direction=t}get alpha(){return this._alpha}set alpha(t){t=t&255,this._alpha!==t&&(this._alpha=t,this._updateCounter++)}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode!==t&&(this._blendMode=t,this._updateCounter++)}get color(){return this._color}set color(t){t=t&16777215,this._color!==t&&(this._color=t,this._updateCounter++)}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth!==t&&(this._relativeDepth=t,this._updateCounter++)}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){t!==this._varyingDepth&&(this._varyingDepth=t,this._updateCounter++)}get libraryAssetName(){return this._libraryAssetName}set libraryAssetName(t){this._libraryAssetName=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}get visible(){return this._visible}set visible(t){this._visible!==t&&(this._visible=t,this._updateCounter++)}get tag(){return this._tag}set tag(t){this._tag!==t&&(this._tag=t,this._updateCounter++)}get posture(){return this._posture}set posture(t){this._posture!==t&&(this._posture=t,this._updateCounter++)}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance!==t&&(this._alphaTolerance=t,this._updateCounter++)}get filters(){return this._filters}set filters(t){this._filters=t,this._updateCounter++}get updateCounter(){return this._updateCounter}get updateContainer(){return this._updateContainer}set updateContainer(t){this._updateContainer=t}};Oc.SPRITE_COUNTER=0;let Ou=Oc;const Sc=class Mc{constructor(){this._id=Mc.VISUALIZATION_COUNTER++,this._object=null,this._asset=null,this._sprites=[],this._scale=-1,this._updateObjectCounter=-1,this._updateModelCounter=-1,this._updateSpriteCounter=-1}initialize(t){return!1}update(t,e,s,i){}reset(){this._scale=-1}dispose(){if(this._sprites){for(;this._sprites.length;){const t=this._sprites[0];t&&t.dispose(),this._sprites.pop()}this._sprites=null}this._object=null,this._asset=null}getSprite(t){return t>=0&&t<this._sprites.length?this._sprites[t]:null}getSpriteList(){return null}createSprite(){return this.createSpriteAtIndex(this._sprites.length)}createSpriteAtIndex(t){const e=new Ou;return t>=this._sprites.length?this._sprites.push(e):this._sprites.splice(t,0,e),e}createSprites(t){for(;this._sprites.length>t;){const e=this._sprites[this._sprites.length-1];e&&e.dispose(),this._sprites.pop()}for(;this._sprites.length<t;)this._sprites.push(new Ou)}get image(){return this.getImage(0,-1)}getImage(t,e){const s=this.getBoundingRectangle();if(s.width*s.height===0)return null;const i=this.totalSprites,r=[];let a=0;for(;a<i;){const l=this.getSprite(a);l&&l.visible&&l.texture&&r.push(l),a++}r.sort((l,c)=>c.relativeDepth-l.relativeDepth);const o=new Ve;for(a=0;a<r.length;){const l=r[a],c=l.texture;if(c){const d=new Nt(c);d.alpha=l.alpha/255,d.tint=l.color,d.x=l.offsetX,d.y=l.offsetY,d.blendMode=l.blendMode,d.filters=l.filters,l.flipH&&(d.scale.x=-1),l.flipV&&(d.scale.y=-1),o.addChild(d)}a++}const _=At.generateTexture(o);return _||null}getBoundingRectangle(){const t=this.totalSprites,e=new de;let s=0;for(;s<t;){const i=this.getSprite(s);if(i&&i.texture&&i.visible){const r=i.flipH?-i.width+i.offsetX:i.offsetX,a=i.flipV?-i.height+i.offsetY:i.offsetY,o=new Y(r,a);s===0?(e.x=o.x,e.y=o.y,e.width=i.width,e.height=i.height):(o.x<e.x&&(e.x=o.x),o.y<e.y&&(e.y=o.y),o.x+i.width>e.right&&(e.width=o.x+i.width-e.x),o.y+i.height>e.bottom&&(e.height=o.y+i.height-e.y))}s++}return e}get instanceId(){return this._id}get object(){return this._object}set object(t){this._object=t}get asset(){return this._asset}set asset(t){this._asset&&this._asset.removeReference(),this._asset=t,this._asset&&this._asset.addReference()}get sprites(){return this._sprites}get totalSprites(){return this._sprites.length}get updateObjectCounter(){return this._updateObjectCounter}set updateObjectCounter(t){this._updateObjectCounter=t}get updateModelCounter(){return this._updateModelCounter}set updateModelCounter(t){this._updateModelCounter=t}get updateSpriteCounter(){return this._updateSpriteCounter}set updateSpriteCounter(t){this._updateSpriteCounter=t}get spriteCount(){return this._sprites.length}};Sc.VISUALIZATION_COUNTER=0;let ba=Sc;class vI{constructor(t){this._roomObjectVariableAccurateZ=t||"",this._location=new R,this._screenLocation=new R,this._locationChanged=!1,this._geometryUpdateId=-1,this._objectUpdateId=-1}dispose(){this._screenLocation=null}updateLocation(t,e){if(!t||!e)return null;let s=!1;const i=t.getLocation();if((e.updateId!==this._geometryUpdateId||t.updateCounter!==this._objectUpdateId)&&(this._objectUpdateId=t.updateCounter,(e.updateId!==this._geometryUpdateId||i.x!==this._location.x||i.y!==this._location.y||i.z!==this._location.z)&&(this._geometryUpdateId=e.updateId,this._location.assign(i),s=!0)),this._locationChanged=s,this._locationChanged){const r=e.getScreenPosition(i);if(!r)return null;const a=t.model.getValue(this._roomObjectVariableAccurateZ);if(isNaN(a)||a===0){const o=new R(Math.round(i.x),Math.round(i.y),i.z);if(o.x!==i.x||o.y!==i.y){const _=e.getScreenPosition(o);this._screenLocation.assign(r),_&&(this._screenLocation.z=_.z)}else this._screenLocation.assign(r)}else this._screenLocation.assign(r);this._screenLocation.x=Math.round(this._screenLocation.x),this._screenLocation.y=Math.round(this._screenLocation.y)}return this._screenLocation}get locationChanged(){return this._locationChanged}}class bI{constructor(){this._sprites=[],this._updateId1=-1,this._updateId2=-1,this._isEmpty=!1}get spriteCount(){return this._sprites.length}get isEmpty(){return this._isEmpty}dispose(){this.setSpriteCount(0)}addSprite(t){this._sprites.push(t)}getSprite(t){return this._sprites[t]}get sprites(){return this._sprites}needsUpdate(t,e){return t===this._updateId1&&e===this._updateId2?!1:(this._updateId1=t,this._updateId2=e,!0)}setSpriteCount(t){if(t<this._sprites.length){let e=t;for(;e<this._sprites.length;){const s=this._sprites[e];s&&s.dispose(),e++}this._sprites.splice(t,this._sprites.length-t)}this._isEmpty=!this._sprites.length}}class FI{constructor(t){this._location=new vI(t),this._sprites=new bI}get location(){return this._location}get sprites(){return this._sprites}dispose(){this._location&&(this._location.dispose(),this._location=null),this._sprites&&(this._sprites.dispose(),this._sprites=null)}get objectId(){return this._objectId}set objectId(t){this._objectId=t}}const Cc=class Xo{constructor(t){this._data=new Map,this._roomObjectVariableAccurateZ=t}dispose(){if(this._data){for(const[t,e]of this._data.entries())e&&(this._data.delete(t),e.dispose());this._data=null}}getObjectCache(t){let e=this._data.get(t);return e||(e=new FI(this._roomObjectVariableAccurateZ),this._data.set(t,e)),e}removeObjectCache(t){const e=this._data.get(t);e&&(this._data.delete(t),e.dispose())}getSortableSpriteList(){const t=[];for(const e of this._data.values()){if(!e)continue;const s=e.sprites&&e.sprites.sprites;if(!(!s||!s.length)){for(const i of s)if(i&&i.sprite.spriteType!==he.ROOM_PLANE&&i.sprite.name!==""){const r=new hl;r.objectId=e.objectId,r.x=i.x,r.y=i.y,r.z=i.z,r.name=i.sprite.name||"",r.flipH=i.sprite.flipH,r.alpha=i.sprite.alpha,r.color=i.sprite.color.toString(),r.blendMode=i.sprite.blendMode.toString(),r.width=i.sprite.width,r.height=i.sprite.height,r.type=i.sprite.type,r.posture=i.sprite.posture;const a=this.isSkewedSprite(i.sprite);a&&(r.skew=i.sprite.direction%4===0?-.5:.5),(a||i.name.indexOf("%image.library.url%")>=0||i.name.indexOf("%group.badge.url%")>=0)&&r.width<=Xo.MAX_SIZE_FOR_AVG_COLOR&&r.height<=Xo.MAX_SIZE_FOR_AVG_COLOR&&i.sprite.name.indexOf("external_image_wallitem")===0&&(r.frame=!0),t.push(r)}}}return!t||!t.length?null:t}isSkewedSprite(t){return t.type?t.type.indexOf("external_image_wallitem")===0&&t.tag==="THUMBNAIL"||t.type.indexOf("guild_forum")===0&&t.tag==="THUMBNAIL":!1}getPlaneSortableSprites(){const t=[];for(const e of this._data.values())for(const s of e.sprites.sprites)s.sprite.spriteType===he.ROOM_PLANE&&t.push(s);return t}};Cc.MAX_SIZE_FOR_AVG_COLOR=200;let xI=Cc;const Nc=class ws{static hex2rgb(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e}static hex2rgba(t,e=[]){return e[0]=(t>>16&255)/255,e[1]=(t>>8&255)/255,e[2]=(t&255)/255,e[3]=t&255,e}static rgb2hex(t){return(t[0]*255<<16)+(t[1]*255<<8)+(t[2]*255|0)}static rgba2hex(t){return(t[0]*255<<16)+(t[1]*255<<8)+(t[2]*255|0)+(t[3]|0)}static rgbStringToHex(t){const e=t.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+ws.getHex(e[1])+ws.getHex(e[2])+ws.getHex(e[3])}static getHex(t){return isNaN(t)?"00":ws.HEX_DIGITS[(t-t%16)/16]+ws.HEX_DIGITS[t%16]}static int2rgb(t){t>>>=0;const e=t&255,s=(t&65280)>>>8;return"rgba("+[(t&16711680)>>>16,s,e,1].join(",")+")"}static rgbToHSL(t){const e=(t>>16&255)/255,s=(t>>8&255)/255,i=(t&255)/255,r=Math.max(e,s,i),a=Math.min(e,s,i),o=r-a;let _=0,l=0,c=0;o==0?_=0:r==e?s>i?_=60*(s-i)/o:_=60*(s-i)/o+360:r==s?_=60*(i-e)/o+120:r==i&&(_=60*(e-s)/o+240),l=.5*(r+a),o==0?c=0:l<=.5?c=o/l*.5:c=o/(1-l)*.5;const d=Math.round(_/360*255),E=Math.round(c*255),I=Math.round(l*255);return(d<<16)+(E<<8)+I}static hslToRGB(t){let e,s,i,r,a;const o=(t>>16&255)/255,_=(t>>8&255)/255,l=(t&255)/255;let c=0,d=0,E=0;_>0?(e=0,s=0,l<.5?e=l*(1+_):e=l+_-l*_,s=2*l-e,i=o+1/3,r=o,a=o-1/3,i<0?i=i+1:i>1&&i--,r<0?r=r+1:r>1&&r--,a<0?a=a+1:a>1&&a--,i*6<1?c=s+(e-s)*6*i:i*2<1?c=e:i*3<2?c=s+(e-s)*6*(2/3-i):c=s,r*6<1?d=s+(e-s)*6*r:r*2<1?d=e:r*3<2?d=s+(e-s)*6*(2/3-r):d=s,a*6<1?E=s+(e-s)*6*a:a*2<1?E=e:a*3<2?E=s+(e-s)*6*(2/3-a):E=s):(c=l,d=l,E=l);const I=Math.round(c*255),m=Math.round(d*255),T=Math.round(E*255);return(I<<16)+(m<<8)+T}static rgb2xyz(t){let e=(t>>16&255)/255,s=(t>>8&255)/255,i=(t>>0&255)/255;return e>.04045?e=Math.pow((e+.055)/1.055,2.4):e=e/12.92,s>.04045?s=Math.pow((s+.055)/1.055,2.4):s=s/12.92,i>.04045?i=Math.pow((i+.055)/1.055,2.4):i=i/12.92,e=e*100,s=s*100,i=i*100,new R(e*.4124+s*.3576+i*.1805,e*.2126+s*.7152+i*.0722,e*.0193+s*.1192+i*.9505)}static xyz2CieLab(t){let e=t.x/95.047,s=t.y/100,i=t.z/108.883;return e>.008856?e=Math.pow(e,1/3):e=7.787*e+16/116,s>.008856?s=Math.pow(s,1/3):s=7.787*s+16/116,i>.008856?i=Math.pow(i,1/3):i=7.787*i+16/116,new R(116*s-16,500*(e-s),200*(s-i))}static rgb2CieLab(t){return ws.xyz2CieLab(ws.rgb2xyz(t))}static colorize(t,e){if(e===4294967295)return t;let s=e>>16&255,i=e>>8&255,r=e&255;return s=(t>>16&255)*s/255,i=(t>>8&255)*i/255,r=(t&255)*r/255,(t&&4278190080)|s<<16|i<<8|r}};Nc.HEX_DIGITS=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];let qo=Nc;class Au{constructor(t){t<0&&(t=0),this._reservedNumbers=[],this._freeNumbers=[];let e=0;for(;e<t;)this._freeNumbers.push(e),e++}dispose(){this._reservedNumbers=null,this._freeNumbers=null}reserveNumber(){if(this._freeNumbers.length>0){const t=this._freeNumbers.pop();return this._reservedNumbers.push(t),t}return-1}freeNumber(t){const e=this._reservedNumbers.indexOf(t);e>=0&&(this._reservedNumbers.splice(e,1),this._freeNumbers.push(t))}}class GI{static getFlipHBitmapData(t){if(!t)return null;const e=At.createRenderTexture(t.width,t.height),s=new ue;return s.scale(-1,1),s.translate(t.width,0),zt.instance.renderer.render(new Mt(t),{renderTexture:e,clear:!0,transform:s}),e}static getFlipVBitmapData(t){if(!t)return null;const e=new ue;e.scale(1,-1),e.translate(0,t.height);const s=new Lo;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),At.generateTexture(s)}static getFlipHVBitmapData(t){if(!t)return null;const e=new ue;e.scale(-1,-1),e.translate(t.width,t.height);const s=new Lo;return s.beginTextureFill({texture:t,matrix:e}).drawRect(0,0,t.width,t.height).endFill(),At.generateTexture(s)}}const De=class _t{static init(t,e){_t._currentDelta=0,_t._startDelayMs=t,_t._effectDurationMs=e,_t._initializationTimeMs=$(),_t._state=_t.STATE_START_DELAY}static turnVisualizationOn(){if(_t._state===_t.STATE_NOT_INITIALIZED||_t._state===_t.STATE_OVER)return;const t=$()-_t._initializationTimeMs;if(t>_t._startDelayMs+_t._effectDurationMs){_t._state=_t.STATE_OVER;return}if(_t._visualizationOn=!0,t<_t._startDelayMs){_t._state=_t.STATE_START_DELAY;return}_t._state=_t.STATE_RUNNING,_t._currentDelta=(t-_t._startDelayMs)/_t._effectDurationMs}static turnVisualizationOff(){_t._visualizationOn=!1}static isVisualizationOn(){return _t._visualizationOn&&_t.isRunning()}static isRunning(){return _t._state===_t.STATE_START_DELAY||_t._state===_t.STATE_RUNNING}static getDelta(t=0,e=1){return Math.min(Math.max(_t._currentDelta,t),e)}static get totalRunningTime(){return _t._startDelayMs+_t._effectDurationMs}};De.STATE_NOT_INITIALIZED=0;De.STATE_START_DELAY=1;De.STATE_RUNNING=2;De.STATE_OVER=3;De._state=De.STATE_NOT_INITIALIZED;De._visualizationOn=!1;De._currentDelta=0;De._initializationTimeMs=0;De._startDelayMs=20*1e3;De._effectDurationMs=2e3;let Zs=De;const lh=class li{constructor(t,e,s,i=null){this._updateId=0,this._scale=1,this._x_scale=1,this._y_scale=1,this._z_scale=1,this._x_scale_internal=1,this._y_scale_internal=1,this._z_scale_internal=1,this._clipNear=-500,this._clipFar=500,this._displacements=null,this.scale=t,this._x=new R,this._y=new R,this._z=new R,this._directionAxis=new R,this._location=new R,this._direction=new R,this._depth=new R,this._x_scale_internal=1,this._y_scale_internal=1,this.x_scale=1,this.y_scale=1,this._z_scale_internal=Math.sqrt(1/2)/Math.sqrt(3/4),this.z_scale=1,this.location=new R(s.x,s.y,s.z),this.direction=new R(e.x,e.y,e.z),i!=null?this.setDepthVector(i):this.setDepthVector(e),this._displacements=new Map}static getIntersectionVector(t,e,s,i){const r=R.dotProduct(e,i);if(Math.abs(r)<1e-5)return null;const a=R.dif(t,s),o=-R.dotProduct(i,a)/r;return R.sum(t,R.product(e,o))}get updateId(){return this._updateId}get scale(){return this._scale/Math.sqrt(.5)}set scale(t){t<=1&&(t=1),t=t*Math.sqrt(.5),t!=this._scale&&(this._scale=t,this._updateId++)}get directionAxis(){return this._directionAxis}get location(){return this._location.assign(this._loc),this._location.x=this._location.x*this._x_scale,this._location.y=this._location.y*this._y_scale,this._location.z=this._location.z*this._z_scale,this._location}set location(t){if(t==null)return;this._loc==null&&(this._loc=new R);const e=this._loc.x,s=this._loc.y,i=this._loc.z;this._loc.assign(t),this._loc.x=this._loc.x/this._x_scale,this._loc.y=this._loc.y/this._y_scale,this._loc.z=this._loc.z/this._z_scale,(this._loc.x!=e||this._loc.y!=s||this._loc.z!=i)&&this._updateId++}get direction(){return this._direction}set direction(t){let e,s,i,r,a;if(t==null)return;this._dir==null&&(this._dir=new R);const o=this._dir.x,_=this._dir.y,l=this._dir.z;this._dir.assign(t),this._direction.assign(t),(this._dir.x!=o||this._dir.y!=_||this._dir.z!=l)&&this._updateId++;const c=new R(0,1,0),d=new R(0,0,1),E=new R(1,0,0),I=t.x/180*Math.PI,m=t.y/180*Math.PI,T=t.z/180*Math.PI,p=Math.cos(I),A=Math.sin(I),N=R.sum(R.product(c,p),R.product(E,-A)),C=new R(d.x,d.y,d.z),L=R.sum(R.product(c,A),R.product(E,p)),D=Math.cos(m),v=Math.sin(m),b=new R(N.x,N.y,N.z),q=R.sum(R.product(C,D),R.product(L,v)),Q=R.sum(R.product(C,-v),R.product(L,D));T!=0?(e=Math.cos(T),s=Math.sin(T),i=R.sum(R.product(b,e),R.product(q,s)),r=R.sum(R.product(b,-s),R.product(q,e)),a=new R(Q.x,Q.y,Q.z),this._x.assign(i),this._y.assign(r),this._z.assign(a),this._directionAxis.assign(this._z)):(this._x.assign(b),this._y.assign(q),this._z.assign(Q),this._directionAxis.assign(this._z))}set x_scale(t){this._x_scale!=t*this._x_scale_internal&&(this._x_scale=t*this._x_scale_internal,this._updateId++)}set y_scale(t){this._y_scale!=t*this._y_scale_internal&&(this._y_scale=t*this._y_scale_internal,this._updateId++)}set z_scale(t){this._z_scale!=t*this._z_scale_internal&&(this._z_scale=t*this._z_scale_internal,this._updateId++)}dispose(){this._x=null,this._y=null,this._z=null,this._loc=null,this._dir=null,this._directionAxis=null,this._location=null,this._displacements!=null&&(this._displacements.clear(),this._displacements=null)}setDisplacement(t,e){let s,i;t==null||e==null||this._displacements!=null&&(s=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.delete(s),i=new R,i.assign(e),this._displacements.set(s,i),this._updateId++)}getDisplacenent(t){let e;return this._displacements!=null?(e=Math.trunc(Math.round(t.x))+"_"+Math.trunc(Math.round(t.y))+"_"+Math.trunc(Math.round(t.z)),this._displacements.get(e)):null}setDepthVector(t){let e,s,i;const r=new R(0,1,0),a=new R(0,0,1),o=new R(1,0,0),_=t.x/180*Math.PI,l=t.y/180*Math.PI,c=t.z/180*Math.PI,d=Math.cos(_),E=Math.sin(_),I=R.sum(R.product(r,d),R.product(o,-E)),m=new R(a.x,a.y,a.z),T=R.sum(R.product(r,E),R.product(o,d)),p=Math.cos(l),A=Math.sin(l),N=new R(I.x,I.y,I.z),C=R.sum(R.product(m,p),R.product(T,A)),L=R.sum(R.product(m,-A),R.product(T,p));c!=0?(e=Math.cos(c),s=Math.sin(c),R.sum(R.product(N,e),R.product(C,s)),R.sum(R.product(N,-s),R.product(C,e)),i=new R(L.x,L.y,L.z),this._depth.assign(i)):this._depth.assign(L),this._updateId++}adjustLocation(t,e){if(t==null||this._z==null)return;const s=R.product(this._z,-e),i=new R(t.x+s.x,t.y+s.y,t.z+s.z);this.location=i}getCoordinatePosition(t){if(t==null)return null;const e=R.scalarProjection(t,this._x),s=R.scalarProjection(t,this._y),i=R.scalarProjection(t,this._z);return new R(e,s,i)}getScreenPosition(t){let e=R.dif(t,this._loc);e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale;let s=R.scalarProjection(e,this._depth);if(s<this._clipNear||s>this._clipFar)return null;let i=R.scalarProjection(e,this._x),r=-R.scalarProjection(e,this._y);i=i*this._scale,r=r*this._scale;const a=this.getDisplacenent(t);return a!=null&&(e=R.dif(t,this._loc),e.add(a),e.x=e.x*this._x_scale,e.y=e.y*this._y_scale,e.z=e.z*this._z_scale,s=R.scalarProjection(e,this._depth)),e.x=i,e.y=r,e.z=s,e}getScreenPoint(t){const e=this.getScreenPosition(t);return e==null?null:new Y(e.x,e.y)}getPlanePosition(t,e,s,i){let r,a;const o=t.x/this._scale,_=-t.y/this._scale,l=R.product(this._x,o);l.add(R.product(this._y,_));const c=new R(this._loc.x*this._x_scale,this._loc.y*this._y_scale,this._loc.z*this._z_scale);c.add(l);const d=this._z,E=new R(e.x*this._x_scale,e.y*this._y_scale,e.z*this._z_scale),I=new R(s.x*this._x_scale,s.y*this._y_scale,s.z*this._z_scale),m=new R(i.x*this._x_scale,i.y*this._y_scale,i.z*this._z_scale),T=R.crossProduct(I,m),p=new R;return p.assign(li.getIntersectionVector(c,d,E,T)),p!=null?(p.subtract(E),r=R.scalarProjection(p,s)/I.length*s.length,a=R.scalarProjection(p,i)/m.length*i.length,new Y(r,a)):null}performZoom(){this.isZoomedIn()?this.scale=li.SCALE_ZOOMED_OUT:this.scale=li.SCALE_ZOOMED_IN}isZoomedIn(){return this.scale==li.SCALE_ZOOMED_IN}performZoomOut(){this.scale=li.SCALE_ZOOMED_OUT}performZoomIn(){this.scale=li.SCALE_ZOOMED_IN}};lh.SCALE_ZOOMED_IN=64;lh.SCALE_ZOOMED_OUT=32;let kr=lh;const Dc=class Qo{static makeRoomPreviewerId(t){return(t&65535)+Qo.PREVIEW_ROOM_ID_BASE}static isRoomPreviewerId(t){return t>=Qo.PREVIEW_ROOM_ID_BASE}};Dc.PREVIEW_ROOM_ID_BASE=2147418112;let Pc=Dc;class Ke{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=$(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=$()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}Ke.STATE_NOT_INITIALIZED=0;Ke.STATE_START_DELAY=1;Ke.STATE_RUNNING=2;Ke.STATE_OVER=3;Ke._SafeStr_448=0;Ke._SafeStr_4512=!1;Ke._SafeStr_4513=0;Ke._SafeStr_4514=0;Ke._SafeStr_4515=2e4;Ke._SafeStr_4516=5e3;class Ye{static init(t,e){this._SafeStr_4513=0,this._SafeStr_4515=t,this._SafeStr_4516=e,this._SafeStr_4514=$(),this._SafeStr_448=1}static turnVisualizationOn(){if(this._SafeStr_448===0||this._SafeStr_448===3)return;this._SafeStr_4524||(this._SafeStr_4524=setTimeout(()=>this.turnVisualizationOff(),this._SafeStr_4516));const t=$()-this._SafeStr_4514;if(t>this._SafeStr_4515+this._SafeStr_4516){this._SafeStr_448=3;return}if(this._SafeStr_4512=!0,t<this._SafeStr_4515){this._SafeStr_448=1;return}this._SafeStr_448=2,this._SafeStr_4513=(t-this._SafeStr_4515)/this._SafeStr_4516}static turnVisualizationOff(){this._SafeStr_4512=!1,clearTimeout(this._SafeStr_4524),this._SafeStr_4524=null}static isVisualizationOn(){return this._SafeStr_4512&&this.isRunning()}static isRunning(){return this._SafeStr_448===1||this._SafeStr_448===2}}Ye.STATE_NOT_INITIALIZED=0;Ye.STATE_START_DELAY=1;Ye.STATE_RUNNING=2;Ye.STATE_OVER=3;Ye._SafeStr_448=0;Ye._SafeStr_4512=!1;Ye._SafeStr_4514=0;Ye._SafeStr_4515=2e4;Ye._SafeStr_4516=5e3;class BI{static hex2int(t){return parseInt(t,16)}static inkToBlendMode(t){return t=="ADD"||t==33?Cs.ADD:t=="SUBTRACT"?Cs.SUBTRACT:t=="DARKEN"?Cs.DARKEN:Cs.NORMAL}}class ra extends Mt{constructor(t=null){super(t),this._offsetX=0,this._offsetY=0,this._tag="",this._alphaTolerance=128,this._varyingDepth=!1,this._clickHandling=!1,this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1}needsUpdate(t,e){return this._pairedSpriteId===t&&this._pairedSpriteUpdateCounter===e?!1:(this._pairedSpriteId=t,this._pairedSpriteUpdateCounter=e,!0)}calculateVertices(){this.texture.orig&&super.calculateVertices()}setTexture(t){t||(t=Ct.EMPTY),t!==this.texture&&(t===Ct.EMPTY&&(this._pairedSpriteId=-1,this._pairedSpriteUpdateCounter=-1),this.texture=t)}containsPoint(t){return ra.containsPoint(this,t)}static containsPoint(t,e){if(!t||!e||t.alphaTolerance>255||!(t instanceof Mt))return!1;if(t.texture===Ct.EMPTY||t.blendMode!==Cs.NORMAL)return;const s=t.texture,i=s.baseTexture;if(!s||!i||!i.valid)return!1;const r=e.x*t.scale.x,a=e.y*t.scale.y;if(!t.getLocalBounds().contains(r,a)||!i.hitMap&&!ra.generateHitMap(i))return!1;const o=i.hitMap;let _=r+s.frame.x,l=a+s.frame.y;s.trim&&(_-=s.trim.x,l-=s.trim.y),_=Math.round(_)*i.resolution,l=Math.round(l)*i.resolution;const c=_+l*i.realWidth,d=c%32,E=c/32|0;return(o[E]&1<<d)!==0}static generateHitMap(t){if(!t)return!1;const e=new Ct(t),s=new Mt(e),i=At.getPixels(s),r=t.width,a=t.height,o=new Uint32Array(Math.ceil(r*a/32)),_=Ne.MATCH_OPAQUE_PIXELS;for(let l=0;l<r*a;l++){const c=l%32,d=l/32|0;i[l*4+3]>=_&&(o[d]=o[d]|1<<c)}return t.hitMap=o,s.destroy(),e.destroy(),!0}get offsetX(){return this._offsetX}set offsetX(t){this._offsetX=t}get offsetY(){return this._offsetY}set offsetY(t){this._offsetY=t}get tag(){return this._tag}set tag(t){this._tag=t}get alphaTolerance(){return this._alphaTolerance}set alphaTolerance(t){this._alphaTolerance=t}get varyingDepth(){return this._varyingDepth}set varyingDepth(t){this._varyingDepth=t}get clickHandling(){return this._clickHandling}set clickHandling(t){this._clickHandling=t}}class wI{constructor(){this._objectId="",this._spriteTag=""}get objectId(){return this._objectId}set objectId(t){this._objectId=t}get spriteTag(){return this._spriteTag}set spriteTag(t){this._spriteTag=t}}const yc=class Lc{constructor(){this._name="",this._sprite=null,this._x=0,this._y=0,this._z=0}dispose(){this._z=-Lc.Z_INFINITY,this._sprite=null}get name(){return this._name}set name(t){this._name=t}get sprite(){return this._sprite}set sprite(t){this._sprite=t}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}};yc.Z_INFINITY=1e8;let HI=yc;class VI{constructor(t,e,s,i,r){this._SafeStr_4507=!1,this._rotation=0,this._rotationOrigin=null,this._rotationRodLength=0,this._SafeStr_795=0,this._id=e,this._container=t,this._geometry=new kr(r,new R(-135,30,0),new R(11,11,5),new R(-135,.5,0)),this._animationFPS=H.instance.getConfiguration("system.fps.animation",24),this._renderTimestamp=0,this._totalTimeRunning=0,this._lastFrame=0,this._master=null,this._display=null,this._mask=null,this._sortableSprites=[],this._spriteCount=0,this._activeSpriteCount=0,this._spritePool=[],this._skipObjectUpdate=!1,this._runningSlow=!1,this._width=0,this._height=0,this._renderedWidth=0,this._renderedHeight=0,this._screenOffsetX=0,this._screenOffsetY=0,this._mouseLocation=new Y,this._mouseOldX=0,this._mouseOldY=0,this._mouseCheckCount=0,this._mouseSpriteWasHit=!1,this._mouseActiveObjects=new Map,this._eventCache=new Map,this._eventId=0,this._scale=1,this._restrictsScaling=!1,this._noSpriteVisibilityChecking=!1,this._usesExclusionRectangles=!1,this._usesMask=!0,this._canvasUpdated=!1,this._objectCache=new xI(this._container.roomObjectVariableAccurateZ),this._mouseListener=null,this.setupCanvas(),this.initialize(s,i)}setupCanvas(){if(this._master||(this._master=new Nt,this._master.interactiveChildren=!1),!this._display){const t=new Ve;this._master.addChild(t),this._display=t}}dispose(){if(this.cleanSprites(0,!0),this._geometry&&(this._geometry.dispose(),this._geometry=null),this._mask&&(this._mask=null),this._objectCache&&(this._objectCache.dispose(),this._objectCache=null),this._master){for(;this._master.children.length;)this._master.removeChildAt(0).destroy();this._master.parent&&this._master.parent.removeChild(this._master),this._master.destroy(),this._master=null}if(this._display=null,this._sortableSprites=[],this._mouseActiveObjects&&(this._mouseActiveObjects.clear(),this._mouseActiveObjects=null),this._spritePool){for(const t of this._spritePool)this.cleanSprite(t,!0);this._spritePool=[]}this._eventCache&&(this._eventCache.clear(),this._eventCache=null),this._mouseListener=null}initialize(t,e){if(t=t<1?1:t,e=e<1?1:e,this._usesMask&&(this._mask?this._mask.clear().beginFill(16711680).drawRect(0,0,t,e).endFill():(this._mask=new Lo().beginFill(16711680).drawRect(0,0,t,e).endFill(),this._master&&(this._master.addChild(this._mask),this._display&&(this._display.mask=this._mask)))),this._master){if(this._master.hitArea){const s=this._master.hitArea;s.width=t,s.height=e}else this._master.hitArea=new de(0,0,t,e);if(this._master.filterArea){const s=this._master.filterArea;s.width=t,s.height=e}else this._master.filterArea=new de(0,0,t,e)}this._width=t,this._height=e}setMask(t){t&&!this._usesMask?(this._usesMask=!0,this._mask&&this._mask.parent!==this._master&&(this._master.addChild(this._mask),this._display.mask=this._mask)):!t&&this._usesMask&&(this._usesMask=!1,this._mask&&this._mask.parent===this._master&&(this._master.removeChild(this._mask),this._display.mask=null))}setScale(t,e=null,s=null,i=!1,r=!1){!this._master||!this._display||this._restrictsScaling&&!i||(e||(e=new Y(this._width/2,this._height/2)),s||(s=e),e=this._display.toLocal(e),r?this._scale*=t:this._scale=t,this.screenOffsetX=s.x-e.x*this._scale,this.screenOffsetY=s.y-e.y*this._scale)}render(t,e=!1){if(this._canvasUpdated=!1,this._totalTimeRunning+=Ss().deltaTime,this._totalTimeRunning===this._renderTimestamp||(t===-1&&(t=this._renderTimestamp+1),!this._container||!this._geometry))return;(this._width!==this._renderedWidth||this._height!==this._renderedHeight)&&(e=!0),(this._display.x!==this._screenOffsetX||this._display.y!==this._screenOffsetY)&&(this._display.position.set(this._screenOffsetX,this._screenOffsetY),e=!0),this._display.scale.x!==this._scale&&(this._display.scale.set(this._scale),e=!0),this.doMagic();const s=Math.round(this._totalTimeRunning/(60/this._animationFPS));let i=!1;s!==this._lastFrame&&(this._lastFrame=s,i=!0);let r=0;const a=this._container.objects;if(a.size)for(const _ of a.values())_&&(r=r+this.renderObject(_,_.instanceId.toString(),t,e,i,r));this._sortableSprites.sort((_,l)=>l.z-_.z),r<this._sortableSprites.length&&this._sortableSprites.splice(r);let o=0;for(;o<r;){const _=this._sortableSprites[o];_&&_.sprite&&this.renderSprite(o,_),o++}this.cleanSprites(r),(e||i)&&(this._canvasUpdated=!0),this._renderTimestamp=this._totalTimeRunning,this._renderedWidth=this._width,this._renderedHeight=this._height}skipSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!0,this.render(-1,!0)}resumeSpriteVisibilityChecking(){this._noSpriteVisibilityChecking=!1}getSortableSpriteList(){return this._objectCache.getSortableSpriteList()}getPlaneSortableSprites(){return this._objectCache.getPlaneSortableSprites()}removeFromCache(t){this._objectCache.removeObjectCache(t)}renderObject(t,e,s,i,r,a){if(!t)return 0;const o=t.visualization;if(!o)return this.removeFromCache(e),0;const _=this.getCacheItem(e);_.objectId=t.instanceId;const l=_.location,c=_.sprites,d=l.updateLocation(t,this._geometry);if(!d)return this.removeFromCache(e),0;if(r&&o.update(this._geometry,s,!c.isEmpty||i,this._skipObjectUpdate&&this._runningSlow),l.locationChanged&&(i=!0),!c.needsUpdate(o.instanceId,o.updateSpriteCounter)&&!i)return c.spriteCount;let E=d.x,I=d.y,m=d.z;E>0?m=m+E*12e-8:m=m+-E*12e-8,E=E+Math.trunc(this._width/2),I=I+Math.trunc(this._height/2);let T=0;for(const p of o.sprites.values()){if(!p||!p.visible)continue;const A=p.texture,N=A&&A.baseTexture;if(!A||!N)continue;const C=E+p.offsetX+this._screenOffsetX,L=I+p.offsetY+this._screenOffsetY;if(p.flipH){const v=E+-(A.width+-p.offsetX)+this._screenOffsetX;if(!this.isSpriteVisible(v,L,A.width,A.height))continue}else if(p.flipV){const v=I+-(A.height+-p.offsetY)+this._screenOffsetY;if(!this.isSpriteVisible(C,v,A.width,A.height))continue}else if(!this.isSpriteVisible(C,L,A.width,A.height))continue;let D=c.getSprite(T);D||(D=new HI,c.addSprite(D),this._sortableSprites.push(D),D.name=e),D.sprite=p,(p.spriteType===he.AVATAR||p.spriteType===he.AVATAR_OWN)&&(D.sprite.libraryAssetName="avatar_"+t.id),D.x=C-this._screenOffsetX,D.y=L-this._screenOffsetY,D.z=m+p.relativeDepth+37e-12*a,T++,a++}return c.setSpriteCount(T),this._canvasUpdated=!0,T}getExtendedSprite(t){if(t<0||t>=this._spriteCount)return null;const e=this._display.getChildAt(t);return e||null}getExtendedSpriteIdentifier(t){return t?t.name:""}renderSprite(t,e){if(t>=this._spriteCount)return this.createAndAddSprite(e),!0;if(!e)return!1;const s=e.sprite,i=this.getExtendedSprite(t);if(!s||!i)return!1;if(i.varyingDepth!==s.varyingDepth)return i.varyingDepth&&!s.varyingDepth?(this._display.removeChildAt(t),this._spritePool.push(i),this.renderSprite(t,e)):(this.createAndAddSprite(e,t),!0);if(i.needsUpdate(s.id,s.updateCounter)||Zs.isVisualizationOn()){i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.name=e.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.filters=s.filters;const r=s.alpha/255;i.alpha!==r&&(i.alpha=r),i.tint!==s.color&&(i.tint=s.color),i.blendMode!==s.blendMode&&(i.blendMode=s.blendMode),i.texture!==s.texture&&i.setTexture(s.texture),s.updateContainer&&(i.children.length===1&&i.removeChildAt(0),i.addChild(s.container),s.updateContainer=!1),s.flipH?i.scale.x!==-1&&(i.scale.x=-1):i.scale.x!==1&&(i.scale.x=1),s.flipV?i.scale.y!==-1&&(i.scale.y=-1):i.scale.y!==1&&(i.scale.y=1),this.updateEnterRoomEffect(i,s)}return i.x!==e.x&&(i.x=e.x),i.y!==e.y&&(i.y=e.y),i.offsetX=s.offsetX,i.offsetY=s.offsetY,!0}createAndAddSprite(t,e=-1){const s=t.sprite;if(!s)return;let i=null;this._spritePool.length>0&&(i=this._spritePool.pop()),i||(i=new ra),i.children.length&&i.removeChildren(),i.tag=s.tag,i.alphaTolerance=s.alphaTolerance,i.alpha=s.alpha/255,i.tint=s.color,i.x=t.x,i.y=t.y,i.offsetX=s.offsetX,i.offsetY=s.offsetY,i.name=s.name,i.varyingDepth=s.varyingDepth,i.clickHandling=s.clickHandling,i.blendMode=s.blendMode,i.filters=s.filters,i.setTexture(s.texture),s.updateContainer&&(i.addChild(s.container),s.updateContainer=!1),s.flipH&&(i.scale.x=-1),s.flipV&&(i.scale.y=-1),this.updateEnterRoomEffect(i,s),e<0||e>=this._spriteCount?(this._display.addChild(i),this._spriteCount++):this._display.addChildAt(i,e),this._activeSpriteCount++}cleanSprites(t,e=!1){if(this._display){if(t<0&&(t=0),t<this._activeSpriteCount||!this._activeSpriteCount){let s=this._spriteCount-1;for(;s>=t;)this.cleanSprite(this.getExtendedSprite(s),e),s--}this._activeSpriteCount=t}}updateEnterRoomEffect(t,e){if(!(!Zs.isVisualizationOn()||!e))switch(e.spriteType){case he.AVATAR_OWN:return;case he.ROOM_PLANE:t.alpha=Zs.getDelta(.9);return;case he.AVATAR:t.alpha=Zs.getDelta(.5);return;default:t.alpha=Zs.getDelta(.1)}}cleanSprite(t,e){t&&(e?(t.parent&&t.parent.removeChild(t),t.destroy({children:!0})):t.setTexture(null))}update(){this._mouseCheckCount,this._mouseCheckCount=0,this._eventId++}setMouseListener(t){this._mouseListener=t}getCacheItem(t){return this._objectCache.getObjectCache(t)}isSpriteVisible(t,e,s,i){return!!(this._noSpriteVisibilityChecking||(t=(t-this._screenOffsetX)*this._scale+this._screenOffsetX,e=(e-this._screenOffsetY)*this._scale+this._screenOffsetY,s=s*this._scale,i=i*this._scale,t<this._width&&t+s>=0&&e<this._height&&e+i>=0&&!this._usesExclusionRectangles))}handleMouseEvent(t,e,s,i,r,a,o){return t=t-this._screenOffsetX,e=e-this._screenOffsetY,this._mouseLocation.x=t/this._scale,this._mouseLocation.y=e/this._scale,this._mouseCheckCount>0&&s==F.MOUSE_MOVE?this._mouseSpriteWasHit:(this._mouseSpriteWasHit=this.checkMouseHits(Math.trunc(t/this._scale),Math.trunc(e/this._scale),s,i,r,a,o),this._mouseCheckCount++,this._mouseSpriteWasHit)}checkMouseHits(t,e,s,i=!1,r=!1,a=!1,o=!1){const _=[];let l=!1,c=null,d=this._activeSpriteCount-1;for(;d>=0;){const m=this.getExtendedSprite(d);if(m&&m.containsPoint(new Y(t-m.x,e-m.y))&&!(m.clickHandling&&(s===F.MOUSE_CLICK||s===F.DOUBLE_CLICK))){const T=this.getExtendedSpriteIdentifier(m);if(_.indexOf(T)===-1){const p=m.tag;let A=this._mouseActiveObjects.get(T);A&&A.spriteTag!==p&&(c=this.createMouseEvent(0,0,0,0,F.ROLL_OUT,A.spriteTag,i,r,a,o),this.bufferMouseEvent(c,T)),s===F.MOUSE_MOVE&&(!A||A.spriteTag!==p)?c=this.createMouseEvent(t,e,t-m.x,e-m.y,F.ROLL_OVER,p,i,r,a,o):(c=this.createMouseEvent(t,e,t-m.x,e-m.y,s,p,i,r,a,o),c.spriteOffsetX=m.offsetX,c.spriteOffsetY=m.offsetY),A||(A=new wI,A.objectId=T,this._mouseActiveObjects.set(T,A)),A.spriteTag=p,(s!==F.MOUSE_MOVE||t!==this._mouseOldX||e!==this._mouseOldY)&&this.bufferMouseEvent(c,T),_.push(T)}l=!0}d--}const E=[];for(const m of this._mouseActiveObjects.keys())m&&E.push(m);let I=0;for(;I<E.length;){const m=E[I];_.indexOf(m)>=0&&(E[I]=null),I++}for(I=0;I<E.length;){const m=E[I];if(m!==null){const T=this._mouseActiveObjects.get(m);T&&this._mouseActiveObjects.delete(m);const p=this.createMouseEvent(0,0,0,0,F.ROLL_OUT,T.spriteTag,i,r,a,o);this.bufferMouseEvent(p,m)}I++}return this.processMouseEvents(),this._mouseOldX=t,this._mouseOldY=e,l}createMouseEvent(t,e,s,i,r,a,o,_,l,c){const d=t-this._width/2,E=e-this._height/2,I=`canvas_${this._id}`;return new bm(r,I+"_"+this._eventId,I,a,d,E,s,i,_,o,l,c)}bufferMouseEvent(t,e){!t||!this._eventCache||(this._eventCache.delete(e),this._eventCache.set(e,t))}processMouseEvents(){if(!(!this._container||!this._eventCache)){for(const[t,e]of this._eventCache.entries()){if(!this._eventCache)return;if(!e)continue;const s=this._container.getRoomObject(parseInt(t));if(s)if(this._mouseListener)this._mouseListener.processRoomCanvasMouseEvent(e,s,this._geometry);else{const i=s.mouseHandler;i&&i.mouseEvent(e,this._geometry)}}this._eventCache&&this._eventCache.clear()}}getDisplayAsTexture(){this._noSpriteVisibilityChecking=!0;const t=this._scale,e=this._screenOffsetX,s=this._screenOffsetY;this.setScale(1,null,null,!0),this._screenOffsetX=0,this._screenOffsetY=0,this.render(-1,!0),this._display.mask=null;const i=this._display.getBounds(),r=ze.create({width:this._display.width,height:this._display.height});return zt.instance.renderer.render(this._display,{renderTexture:r,clear:!0,transform:new ue(1,0,0,1,-i.x,-i.y)}),this._display.mask=this._mask,this._noSpriteVisibilityChecking=!1,this.setScale(t,null,null,!0),this._screenOffsetX=e,this._screenOffsetY=s,r}doMagic(){const t=this.geometry;if(this._rotation!==0){let e=this._effectDirection;t.direction=new R(e.x+this._rotation,e.y,e.z),e=t.direction,t.setDepthVector(new R(e.x,e.y,5));const s=new R;s.assign(this._rotationOrigin),s.x=s.x+this._rotationRodLength*Math.cos((e.x+180)/180*3.14159265358979)*Math.cos(e.y/180*3.14159265358979),s.y=s.y+this._rotationRodLength*Math.sin((e.x+180)/180*3.14159265358979)*Math.cos(e.y/180*3.14159265358979),s.z=s.z+this._rotationRodLength*Math.sin(e.y/180*3.14159265358979),t.location=s,this._effectLocation=new R,this._effectLocation.assign(s),this._effectDirection=new R,this._effectDirection.assign(t.direction)}if(Ye.isVisualizationOn()&&!this._SafeStr_4507?this.changeShaking():!Ye.isVisualizationOn()&&this._SafeStr_4507&&this.changeShaking(),Ke.isVisualizationOn()&&this.changeRotation(),this._SafeStr_4507){this._SafeStr_795++;const e=this._effectDirection,s=R.sum(e,new R(Math.sin(this._SafeStr_795*5/180*3.14159265358979)*2,Math.sin(this._SafeStr_795/180*3.14159265358979)*5,Math.sin(this._SafeStr_795*10/180*3.14159265358979)*2));t.direction=s}else this._SafeStr_795=0,t.direction=this._effectDirection}changeShaking(){if(this._SafeStr_4507=!this._SafeStr_4507,this._SafeStr_4507){const t=this.geometry.direction;this._effectDirection=new R(t.x,t.y,t.z)}}changeRotation(){if(this._SafeStr_4507)return;const t=this.geometry;if(t){if(this._rotation===0){const e=t.location,s=t.directionAxis;this._effectLocation=new R,this._effectLocation.assign(e),this._effectDirection=new R,this._effectDirection.assign(t.direction);const i=kr.getIntersectionVector(e,s,new R(0,0,0),new R(0,0,1));i!==null&&(this._rotationOrigin=new R(i.x,i.y,i.z),this._rotationRodLength=R.dif(i,e).length,this._rotation=1);return}this._rotation=0,t.location=this._effectLocation,t.direction=this._effectDirection,t.setDepthVector(new R(this._effectDirection.x,this._effectDirection.y,5))}}moveLeft(){if(this._rotation!==0){this._rotation===1?this._rotation=-1:this._rotation=this._rotation-1;return}const t=this.geometry,e=(t.direction.x-90)/180*3.14159265358979;t.location=R.sum(t.location,new R(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveRight(){if(this._rotation!==0){this._rotation===-1?this._rotation=1:this._rotation=this._rotation+1;return}const t=this.geometry,e=(t.direction.x+90)/180*3.14159265358979;t.location=R.sum(t.location,new R(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveUp(){if(this._rotation!==0)return;const t=this.geometry,e=t.direction.x/180*3.14159265358979;t.location=R.sum(t.location,new R(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}moveDown(){if(this._rotation!==0)return;const t=this.geometry,e=(t.direction.x+180)/180*3.14159265358979;t.location=R.sum(t.location,new R(Math.cos(e)*Math.sqrt(2),Math.sin(e)*Math.sqrt(2)))}get id(){return this._id}get geometry(){return this._geometry}get master(){return this._master}get display(){return this._display}get screenOffsetX(){return this._screenOffsetX}set screenOffsetX(t){t=Math.trunc(t),this._mouseLocation.x=this._mouseLocation.x-(t-this._screenOffsetX),this._screenOffsetX=t}get screenOffsetY(){return this._screenOffsetY}set screenOffsetY(t){t=Math.trunc(t),this._mouseLocation.y=this._mouseLocation.y-(t-this._screenOffsetY),this._screenOffsetY=t}get scale(){return this._scale}get width(){return this._width*this._scale}get height(){return this._height*this._scale}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get canvasUpdated(){return this._canvasUpdated}set canvasUpdated(t){this._canvasUpdated=t}}class jI{constructor(){this._objects=new Map,this._canvases=new Map,this._disposed=!1,this._roomObjectVariableAccurateZ=null}dispose(){if(!this._disposed){if(this._canvases){for(const[t,e]of this._canvases.entries())this._canvases.delete(t),e&&e.dispose();this._canvases=null}this._objects&&(this._objects=null),this._disposed=!0}}reset(){this._objects.clear()}getInstanceId(t){return t?t.instanceId:-1}getRoomObject(t){return this._objects.get(t)}addObject(t){t&&this._objects.set(this.getInstanceId(t),t)}removeObject(t){const e=this.getInstanceId(t);this._objects.delete(e);for(const s of this._canvases.values()){if(!s)continue;s.removeFromCache(e.toString())}}render(t,e=!1){if(!(!this._canvases||!this._canvases.size))for(const s of this._canvases.values())s&&s.render(t,e)}update(t,e=!1){if(!(!this._canvases||!this._canvases.size)){this.render(t,e);for(const s of this._canvases.values())s&&s.update()}}getCanvas(t){const e=this._canvases.get(t);return e||null}createCanvas(t,e,s,i){const r=this._canvases.get(t);if(r)return r.initialize(e,s),r.geometry&&(r.geometry.scale=i),r;const a=this.createSpriteCanvas(t,e,s,i);if(a)return this._canvases.set(t,a),a}createSpriteCanvas(t,e,s,i){return new VI(this,t,e,s,i)}removeCanvas(t){const e=this._canvases.get(t);e&&(this._canvases.delete(t),e.dispose())}get objects(){return this._objects}get disposed(){return this._disposed}get roomObjectVariableAccurateZ(){return this._roomObjectVariableAccurateZ}set roomObjectVariableAccurateZ(t){this._roomObjectVariableAccurateZ=t}}class zI{createRenderer(){return new jI}}class YI extends ge{constructor(t,e){super(),this._id=t,this._container=e,this._renderer=null,this._managers=new Map,this._updateCategories=[],this._model=new Rc}onDispose(){this.removeAllManagers(),this.destroyRenderer(),this._container=null,this._model.dispose()}setRenderer(t){if(t!==this._renderer&&(this._renderer&&this.destroyRenderer(),this._renderer=t,!!this._renderer&&(this._renderer.reset(),this._managers.size)))for(const e of this._managers.values()){if(!e)continue;const s=e.objects;if(s.length)for(const i of s.getValues())i&&this._renderer.addObject(i)}}destroyRenderer(){this._renderer&&(this._renderer.dispose(),this._renderer=null)}getManager(t){const e=this._managers.get(t);return e||null}getManagerOrCreate(t){let e=this.getManager(t);return e||(e=this._container.createRoomObjectManager(t),e?(this._managers.set(t,e),e):null)}getTotalObjectsForManager(t){const e=this.getManager(t);return e?e.totalObjects:0}getRoomObject(t,e){const s=this.getManager(e);if(!s)return null;const i=s.getObject(t);return i||null}getRoomObjectsForCategory(t){const e=this.getManager(t);return e?e.objects.getValues():[]}getRoomObjectByIndex(t,e){const s=this.getManager(e);if(!s)return null;const i=s.getObjectByIndex(t);return i||null}createRoomObject(t,e,s,i){const r=this.getManagerOrCreate(i);if(!r)return null;const a=r.createObject(t,e,s);return a?(this._renderer&&this._renderer.addObject(a),a):null}createRoomObjectAndInitalize(t,e,s){return this._container?this._container.createRoomObjectAndInitalize(this._id,t,e,s):null}removeRoomObject(t,e){const s=this.getManager(e);if(!s)return;const i=s.getObject(t);i&&(i.tearDown(),this._renderer&&this._renderer.removeObject(i),s.removeObject(t))}removeAllManagers(){for(const t of this._managers.values())if(t){if(this._renderer){const e=t.objects;if(e.length)for(const s of e.getValues())s&&this._renderer.removeObject(s)}t.dispose()}this._managers.clear()}addUpdateCategory(t){this._updateCategories.indexOf(t)>=0||this._updateCategories.push(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);e!==-1&&this._updateCategories.splice(e,1)}update(t,e=!1){for(const s of this._updateCategories){const i=this.getManager(s);if(!i)continue;const r=i.objects;if(r.length)for(const a of r.getValues()){if(!a)continue;const o=a.logic;o&&o.update(t)}}this._renderer&&this._renderer.update(t,e)}hasUninitializedObjects(){for(const t of this._managers.values())if(t){for(const e of t.objects.getValues())if(e&&!e.isReady)return!0}return!1}get id(){return this._id}get container(){return this._container}get renderer(){return this._renderer}get managers(){return this._managers}get model(){return this._model}}const Uc=class Jo{constructor(t,e,s,i,r,a,o){this._layerTags=[],this._primaryColor=t&16777215,this._secondaryColor=e&16777215,this._breed=s,this._tag=i>-1&&i<Jo.COLOR_TAGS.length?Jo.COLOR_TAGS[i]:"",this._id=r,this._isMaster=a,this._layerTags=o}get primaryColor(){return this._primaryColor}get secondaryColor(){return this._secondaryColor}get breed(){return this._breed}get tag(){return this._tag}get id(){return this._id}get isMaster(){return this._isMaster}get layerTags(){return this._layerTags}};Uc.COLOR_TAGS=["Null","Black","White","Grey","Red","Orange","Pink","Green","Lime","Blue","Light-Blue","Dark-Blue","Yellow","Brown","Dark-Brown","Beige","Cyan","Purple","Gold"];let WI=Uc;const Jt=class wt{constructor(){this._stateEvents=null,this._sessionDataManager=null,this._waitingForSessionDataManager=!1,this._iconListener=null,this._collections=new Map,this._gifCollections=new Map,this._images=new Map,this._events=new Map,this._activeObjects={},this._activeObjectTypes=new Map,this._activeObjectTypeIds=new Map,this._objectTypeAdUrls=new Map,this._wallItems={},this._wallItemTypes=new Map,this._wallItemTypeIds=new Map,this._furniRevisions=new Map,this._pets={},this._petColors=new Map,this._objectAliases=new Map,this._objectOriginalNames=new Map,this._pendingContentTypes=[],this._dataInitialized=!1}initialize(t){this._stateEvents=t,this.setFurnitureData();for(const[e,s]of k.getValue("pet.types").entries())this._pets[s]=e}dispose(){}setSessionDataManager(t){this._sessionDataManager=t,this._waitingForSessionDataManager&&(this._waitingForSessionDataManager=!1,this.setFurnitureData())}loadFurnitureData(){this.setFurnitureData()}setFurnitureData(){if(!this._sessionDataManager){this._waitingForSessionDataManager=!0;return}const t=this._sessionDataManager.getAllFurnitureData(this);t&&(this._sessionDataManager.removePendingFurniDataListener(this),this.processFurnitureData(t),this._stateEvents.dispatchEvent(new rt(wt.LOADER_READY)))}processFurnitureData(t){if(t)for(const e of t){if(!e)continue;const s=e.id;let i=e.className;e.hasIndexedColor&&(i=i+"*"+e.colorIndex);const r=e.revision,a=e.adUrl;a&&a.length>0&&this._objectTypeAdUrls.set(i,a);let o=e.className;e.type===Ii.FLOOR?(this._activeObjectTypes.set(s,i),this._activeObjectTypeIds.set(i,s),this._activeObjects[o]||(this._activeObjects[o]=1)):e.type===Ii.WALL&&(o==="post.it"&&(i="post_it",o="post_it"),o==="post.it.vd"&&(i="post_it_vd",o="post_id_vd"),this._wallItemTypes.set(s,i),this._wallItemTypeIds.set(i,s),this._wallItems[o]||(this._wallItems[o]=1));const _=this._furniRevisions.get(o);r>_&&(this._furniRevisions.delete(o),this._furniRevisions.set(o,r))}}getFurnitureFloorNameForTypeId(t){const e=this._activeObjectTypes.get(t);return this.removeColorIndex(e)}getFurnitureWallNameForTypeId(t,e=null){let s=this._wallItemTypes.get(t);return s==="poster"&&e!==null&&(s=s+e),this.removeColorIndex(s)}getFurnitureFloorColorIndex(t){const e=this._activeObjectTypes.get(t);return e?this.getColorIndexFromName(e):-1}getFurnitureWallColorIndex(t){const e=this._wallItemTypes.get(t);return e?this.getColorIndexFromName(e):-1}getColorIndexFromName(t){if(!t)return-1;const e=t.indexOf("*");return e===-1?0:parseInt(t.substr(e+1))}removeColorIndex(t){if(!t)return null;const e=t.indexOf("*");return e===-1?t:t.substr(0,e)}getRoomObjectAdUrl(t){const e=this._objectTypeAdUrls.get(t);return e||""}getPetColorResult(t,e){const s=this._petColors.get(t);return s?s.get(e):null}getPetColorResultsForTag(t,e){const s=this._petColors.get(t),i=[];if(s)for(const r of s.values())r.tag===e&&i.push(r);return i}getCollection(t){if(!t)return null;const e=this._collections.get(t);if(!e){const s=Me().getCollection(t);return s?(this._collections.set(t,s),s):null}return e}getGifCollection(t){return t&&this._gifCollections.get(t)||null}getImage(t){if(!t)return null;const e=this._images.get(t);if(!e)return null;const s=new Image;return s.src=e.src,s}addAssetToCollection(t,e,s,i=!0){const r=this.getCollection(t);return r?r.addAsset(e,s,i,0,0,!1,!1):!1}createGifCollection(t,e,s){if(!t||!e||!s)return null;const i=new Am(t,e,s);return this._gifCollections.set(t,i),i}createCollection(t,e){if(!t||!e)return null;const s=new Ju(t,e);this._collections.set(s.name,s);const i=this._pets[s.name];if(i!==void 0){const r=s.getPaletteNames(),a=new Map;for(const o of r){const _=s.getPalette(o),l=t.palettes[o],c=_.primaryColor,d=_.secondaryColor,E=l.breed!==void 0?l.breed:0,I=l.colorTag!==void 0?l.colorTag:-1,m=l.master!==void 0?l.master:!1,T=l.tags!==void 0?l.tags:[];a.set(parseInt(o),new WI(c,d,E,I,o,m,T))}this._petColors.set(i,a)}}getPlaceholderName(t){switch(this.getCategoryForType(t)){case S.FLOOR:return wt.PLACE_HOLDER;case S.WALL:return wt.PLACE_HOLDER_WALL;default:return this._pets[t]!==void 0?wt.PLACE_HOLDER_PET:wt.PLACE_HOLDER_DEFAULT}}getCategoryForType(t){return t?this._activeObjects[t]!==void 0?S.FLOOR:this._wallItems[t]!==void 0?S.WALL:this._pets[t]!==void 0?S.UNIT:t.indexOf("poster")===0?S.WALL:t==="room"?S.ROOM:t===lt.USER||t===lt.PET||t===lt.BOT||t===lt.RENTABLE_BOT?S.UNIT:t===wt.TILE_CURSOR||t===wt.SELECTION_ARROW?S.CURSOR:S.MINIMUM:S.MINIMUM}getPetNameForType(t){return k.getValue("pet.types")[t]||null}isLoaderType(t){return t=lt.getRealType(t),t!==P.USER}downloadImage(t,e,s,i=null){let r=null,a=[];if(e&&e.indexOf(",")>=0&&(r=e,e=r.split(",")[0]),r?a=this.getAssetUrls(r,s,!0):a=this.getAssetUrls(e,s,!0),a&&a.length){const o=a[0],_=new Image;return _.src=o,_.onload=()=>{_.onerror=null,this._images.set([e,s].join("_"),_),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!0)},_.onerror=()=>{_.onload=null,G.error("Failed to download asset",o),this._iconListener.onRoomContentLoaded(t,[e,s].join("_"),!1)},!0}return!1}async downloadAsset(t,e){var i;const s=(i=this.getAssetUrls(t))==null?void 0:i[0];if(!(!s||!s.length)&&!(this._pendingContentTypes.indexOf(t)>=0||this.getOrRemoveEventDispatcher(t))){this._pendingContentTypes.push(t),this._events.set(t,e);try{const r=await fetch(s);let a="application/octet-stream";switch(r.headers.has("Content-Type")&&(a=r.headers.get("Content-Type")),a){case"application/octet-stream":{const o=new Yu(await r.arrayBuffer());await this.processAsset(o.baseTexture,o.jsonFile);const _=this._events.get(t);if(!_)return;_.dispatchEvent(new ss(ss.RCLE_SUCCESS,t));break}default:throw new Error}}catch{e.dispatchEvent(new ss(ss.RCLE_FAILURE,t))}}}async processAsset(t,e){const s=e.spritesheet;if(!t||!s||!Object.keys(s).length){this.createCollection(e,null);return}const i=async()=>{const r=new wu(t,s);await r.parse(),this.createCollection(e,r)};t.valid?await i():await new Promise((r,a)=>{t.once("update",async()=>(await i(),r()))})}setAssetAliasName(t,e){this._objectAliases.set(t,e),this._objectOriginalNames.set(e,t)}getAssetAliasName(t){const e=this._objectAliases.get(t);return e||t}getAssetOriginalName(t){const e=this._objectOriginalNames.get(t);return e||t}getAssetUrls(t,e=null,s=!1){switch(t){case wt.PLACE_HOLDER:return[this.getAssetUrlWithGenericBase(wt.PLACE_HOLDER)];case wt.PLACE_HOLDER_WALL:return[this.getAssetUrlWithGenericBase(wt.PLACE_HOLDER_WALL)];case wt.PLACE_HOLDER_PET:return[this.getAssetUrlWithGenericBase(wt.PLACE_HOLDER_PET)];case wt.ROOM:return[this.getAssetUrlWithGenericBase("room")];case wt.TILE_CURSOR:return[this.getAssetUrlWithGenericBase(wt.TILE_CURSOR)];case wt.SELECTION_ARROW:return[this.getAssetUrlWithGenericBase(wt.SELECTION_ARROW)];default:{const i=this.getCategoryForType(t);if(i===S.FLOOR||i===S.WALL){const r=this.getAssetAliasName(t);let a=s?this.getAssetUrlWithFurniIconBase(r):this.getAssetUrlWithFurniBase(t);if(s){const o=e&&e!==""&&this._activeObjectTypeIds.has(r+"*"+e);a=a.replace(/%param%/gi,o?"_"+e:"")}return[a]}return i===S.UNIT?[this.getAssetUrlWithPetBase(t)]:null}}}getAssetIconUrl(t,e){let s=null,i=[];return t&&t.indexOf(",")>=0&&(s=t,t=s.split(",")[0]),s?i=this.getAssetUrls(s,e,!0):i=this.getAssetUrls(t,e,!0),i&&i.length?i[0]:null}getAssetUrlWithGenericBase(t){return k.getValue("generic.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniBase(t){return k.getValue("furni.asset.url").replace(/%libname%/gi,t)}getAssetUrlWithFurniIconBase(t){return k.getValue("furni.asset.icon.url").replace(/%libname%/gi,t)}getAssetUrlWithPetBase(t){return k.getValue("pet.asset.url").replace(/%libname%/gi,t)}setRoomObjectRoomId(t,e){const s=t&&t.model;s&&s.setValue(g.OBJECT_ROOM_ID,e)}getOrRemoveEventDispatcher(t,e=!1){const s=this._events.get(t);return e&&this._events.delete(t),s}setIconListener(t){this._iconListener=t}};Jt.PLACE_HOLDER="place_holder";Jt.PLACE_HOLDER_WALL="place_holder_wall";Jt.PLACE_HOLDER_PET="place_holder_pet";Jt.PLACE_HOLDER_DEFAULT=Jt.PLACE_HOLDER;Jt.ROOM="room";Jt.TILE_CURSOR="tile_cursor";Jt.SELECTION_ARROW="selection_arrow";Jt.LOADER_READY="RCL_LOADER_READY";Jt.MANDATORY_LIBRARIES=[Jt.PLACE_HOLDER,Jt.PLACE_HOLDER_WALL,Jt.PLACE_HOLDER_PET,Jt.ROOM,Jt.TILE_CURSOR,Jt.SELECTION_ARROW];let zn=Jt;class kI{constructor(){this._objects=new vt,this._objectsPerType=new vt}dispose(){this.removeAllObjects()}getObject(t){const e=this._objects.getValue(t);return e||null}getObjectByIndex(t){const e=this._objects.getWithIndex(t);return e||null}createObject(t,e,s){const i=new UI(t,e,s);return this.addObject(t,s,i)}addObject(t,e,s){if(this._objects.getValue(t))return s.dispose(),null;this._objects.add(t,s);const i=this.getTypeMap(e);return i&&i.add(t,s),s}removeObject(t){const e=this._objects.remove(t);if(e){const s=this.getTypeMap(e.type);s&&s.remove(e.id),e.dispose()}}removeAllObjects(){let t=0;for(;t<this._objects.length;){const e=this._objects.getWithIndex(t);e&&e.dispose(),t++}for(this._objects.reset(),t=0;t<this._objectsPerType.length;){const e=this._objectsPerType.getWithIndex(t);e&&e.dispose(),t++}this._objectsPerType.reset()}getTypeMap(t,e=!0){let s=this._objectsPerType.getValue(t);return!s&&e&&(s=new vt,this._objectsPerType.add(t,s)),s}get objects(){return this._objects}get totalObjects(){return this._objects.length}}const Di=class Hs extends ns{constructor(t,e,s){super(),this._state=Hs.ROOM_MANAGER_LOADED,this._rooms=new Map,this._contentLoader=null,this._updateCategories=[],this._listener=t,this._visualizationFactory=e,this._logicFactory=s,this._initialLoadList=[],this._pendingContentTypes=[],this._skipContentProcessing=!1,this._disposed=!1,this.onRoomContentLoadedEvent=this.onRoomContentLoadedEvent.bind(this),this.events.addEventListener(ss.RCLE_SUCCESS,this.onRoomContentLoadedEvent),this.events.addEventListener(ss.RCLE_FAILURE,this.onRoomContentLoadedEvent),this.events.addEventListener(ss.RCLE_CANCEL,this.onRoomContentLoadedEvent)}onInit(){if(this._state>=Hs.ROOM_MANAGER_INITIALIZING||!this._contentLoader)return;const t=zn.MANDATORY_LIBRARIES;for(const e of t)e&&this._initialLoadList.indexOf(e)===-1&&(this._contentLoader.downloadAsset(e,this.events),this._initialLoadList.push(e));this._state=Hs.ROOM_MANAGER_INITIALIZING}getRoomInstance(t){const e=this._rooms.get(t);return e||null}createRoomInstance(t){if(this._rooms.get(t))return null;const e=new YI(t,this);if(this._rooms.set(e.id,e),this._updateCategories.length)for(const s of this._updateCategories)e.addUpdateCategory(s);return e}removeRoomInstance(t){const e=this._rooms.get(t);return e?(this._rooms.delete(t),e.dispose(),!0):!1}createRoomObjectAndInitalize(t,e,s,i){const r=this.getRoomInstance(t);if(!r)return null;let a=s,o=s,_=s,l=null,c=!1;if(this._contentLoader.isLoaderType(s)){if(l=this._contentLoader.getCollection(s),!l&&(c=!0,this._contentLoader.downloadAsset(s,this.events),_=this._contentLoader.getPlaceholderName(s),l=this._contentLoader.getCollection(_),!l))return null;a=l.data.visualizationType,o=l.data.logicType}const d=r.createRoomObject(e,1,s,i);if(!d)return null;if(this._visualizationFactory){const E=this._visualizationFactory.getVisualization(a);if(!E)return r.removeRoomObject(e,i),null;E.asset=l;const I=this._visualizationFactory.getVisualizationData(_,a,l&&l.data||null);if(!I||!E.initialize(I))return r.removeRoomObject(e,i),null;d.setVisualization(E)}if(this._logicFactory){const E=this._logicFactory.getLogic(o);d.setLogic(E),E&&E.initialize(l&&l.data||null)}return c||(d.isReady=!0),this._contentLoader.setRoomObjectRoomId(d,t),d}reinitializeRoomObjectsByType(t){if(!t||!this._contentLoader||!this._visualizationFactory||!this._logicFactory)return;const e=this._contentLoader.getCollection(t);if(!e)return;const s=e.data.visualizationType,i=e.data.logicType,r=this._visualizationFactory.getVisualizationData(t,s,e.data);for(const a of this._rooms.values())if(a){for(const[o,_]of a.managers.entries())if(_)for(const l of _.objects.getValues()){if(!l||l.type!==t)continue;const c=this._visualizationFactory.getVisualization(s);if(c)if(c.asset=e,!r||!c.initialize(r))_.removeObject(l.id);else{l.setVisualization(c);const d=this._logicFactory.getLogic(i);l.setLogic(d),d&&d.initialize(e.data),l.isReady=!0,this._listener&&this._listener.objectInitialized(a.id,l.id,o)}else _.removeObject(l.id)}}}addUpdateCategory(t){if(!(this._updateCategories.indexOf(t)>=0)&&(this._updateCategories.push(t),!!this._rooms.size))for(const s of this._rooms.values())s&&s.addUpdateCategory(t)}removeUpdateCategory(t){const e=this._updateCategories.indexOf(t);if(e!==-1&&(this._updateCategories.splice(e,1),!!this._rooms.size))for(const s of this._rooms.values())s&&s.removeUpdateCategory(t)}setContentLoader(t){this._contentLoader&&this._contentLoader.dispose(),this._contentLoader=t}processPendingContentTypes(t){if(this._skipContentProcessing){this._skipContentProcessing=!1;return}for(;this._pendingContentTypes.length;){const e=this._pendingContentTypes.shift();if(!this._contentLoader.getCollection(e)){this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!1),G.log("Invalid Collection",e);continue}this.reinitializeRoomObjectsByType(e),this._listener&&this._listener.initalizeTemporaryObjectsByType(e,!0),this._initialLoadList.length>0&&this.removeFromInitialLoad(e)}}removeFromInitialLoad(t){if(!(!t||this._state===Hs.ROOM_MANAGER_ERROR))if(this._contentLoader||(this._state=Hs.ROOM_MANAGER_ERROR),this._contentLoader.getCollection(t)){const e=this._initialLoadList.indexOf(t);e>=0&&this._initialLoadList.splice(e,1),this._initialLoadList.length||(this._state=Hs.ROOM_MANAGER_INITIALIZED,this._listener&&this._listener.onRoomEngineInitalized(!0))}else this._state=Hs.ROOM_MANAGER_ERROR,this._listener&&this._listener.onRoomEngineInitalized(!1)}onRoomContentLoadedEvent(t){if(!this._contentLoader)return;const e=t.contentType;this._pendingContentTypes.indexOf(e)>=0||this._pendingContentTypes.push(e)}update(t,e=!1){if(this.processPendingContentTypes(t),!!this._rooms.size)for(const s of this._rooms.values())s&&s.update(t,e)}createRoomObjectManager(t){return new kI}get rooms(){return this._rooms}get disposed(){return this._disposed}};Di.ROOM_MANAGER_ERROR=-1;Di.ROOM_MANAGER_LOADING=0;Di.ROOM_MANAGER_LOADED=1;Di.ROOM_MANAGER_INITIALIZING=2;Di.ROOM_MANAGER_INITIALIZED=3;Di.CONTENT_PROCESSING_TIME_LIMIT_MILLISECONDS=40;let KI=Di;class XI{constructor(t,e=-1,s=null,i=null,r=null){this._minLevel=-1,this._texture=null,this._colorMatrix=null,this._blendMode=null,this._name=t,this._minLevel=e,this._texture=s,this._colorMatrix=i,this._blendMode=r}get name(){return this._name}get texture(){return this._texture}set texture(t){this._texture=t}get colorMatrix(){return this._colorMatrix}set colorMatrix(t){this._colorMatrix=t}get blendMode(){return this._blendMode}set blendMode(t){this._blendMode=t}get minLevel(){return this._minLevel}}class qI{constructor(){this._effects=new Map,this._events=new pe,this._isLoaded=!1}init(){if(this._isLoaded)return;this._isLoaded=!0;const t=k.getValue("image.library.url")+"Habbo-Stories/",e=k.getValue("camera.available.effects");for(const s of e){if(!s.enabled)continue;const i=new XI(s.name,s.minLevel);s.colorMatrix.length?i.colorMatrix=s.colorMatrix:(i.texture=Ct.from(t+s.name+".png"),i.blendMode=s.blendMode),this._effects.set(i.name,i)}this.events.dispatchEvent(new Bo(Bo.INITIALIZED))}applyEffects(t,e,s){const i=new Ve,r=new Nt(t);i.addChild(r),s&&r.scale.set(2);for(const a of e){const o=a.effect;if(o)if(o.colorMatrix){const _=new Hu;_.matrix=o.colorMatrix,_.alpha=a.alpha,r.filters||(r.filters=[]),r.filters.push(_)}else{const _=new Nt(o.texture);_.alpha=a.alpha,_.blendMode=o.blendMode,i.addChild(_)}}return At.generateImage(i)}get effects(){return this._effects}get events(){return this._events}get isLoaded(){return this._isLoaded}}class Oj{constructor(t,e){this._effect=t,this._alpha=e}get effect(){return this._effect}get alpha(){return this._alpha}}class QI{flush(){return this._canShowInterstitial=!1,!0}parse(t){return t?(this._canShowInterstitial=t.readBoolean(),!0):!1}get canShowInterstitial(){return this._canShowInterstitial}}class JI{flush(){return this._errorCode=0,this._filteredText=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._filteredText=t.readString(),!0):!1}get errorCode(){return this._errorCode}get filteredText(){return this._filteredText}}class ZI{flush(){return this._isOpen=!1,this._onShutdown=!1,this._isAuthenticUser=!1,!0}parse(t){return t?(this._isOpen=t.readBoolean(),this._onShutdown=t.readBoolean(),t.bytesAvailable&&(this._isAuthenticUser=t.readBoolean()),!0):!1}get isOpen(){return this._isOpen}get onShutdown(){return this._onShutdown}get isAuthenticUser(){return this._isAuthenticUser}}class $I{flush(){return this._isOpen=!1,this._minutesUntilChange=0,!0}parse(t){return t?(this._isOpen=t.readInt()>0,this._minutesUntilChange=t.readInt(),!0):!1}get isOpen(){return this._isOpen}get minutesUntilChange(){return this._minutesUntilChange}}class tR{flush(){return this._openHour=0,this._openMinute=0,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}}class eR{flush(){return this._openHour=0,this._openMinute=0,this._userThrownOutAtClose=!1,!0}parse(t){return t?(this._openHour=t.readInt(),this._openMinute=t.readInt(),this._userThrownOutAtClose=t.readBoolean(),!0):!1}get openHour(){return this._openHour}get openMinute(){return this._openMinute}get userThrowOutAtClose(){return this._userThrownOutAtClose}}class sR{flush(){return this._minutes=0,!0}parse(t){return t?(this._minutes=t.readInt(),!0):!1}get openMinute(){return this._minutes}}class iR{flush(){return this._isInMaintenance=!1,this._minutesUntilMaintenance=0,this._duration=15,!0}parse(t){return t?(this._isInMaintenance=t.readBoolean(),this._minutesUntilMaintenance=t.readInt(),t.bytesAvailable&&(this._duration=t.readInt()),!0):!1}get isInMaintenance(){return this._isInMaintenance}get minutesUntilMaintenance(){return this._minutesUntilMaintenance}get duration(){return this._duration}}class rR{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class nR{flush(){return this._resultCode=-1,this._name="",this._nameSuggestions=[],!0}parse(t){if(!t)return!1;this._resultCode=t.readInt(),this._name=t.readString();let e=t.readInt();for(;e>0;)this._nameSuggestions.push(t.readString()),e--;return!0}get resultCode(){return this._resultCode}get name(){return this._name}get nameSuggestions(){return this._nameSuggestions}}class aR{flush(){return this._figure="",this._gender="",!0}parse(t){return t?(this._figure=t.readString(),this._gender=t.readString(),this._gender&&(this._gender=this._gender.toUpperCase()),!0):!1}get figure(){return this._figure}get gender(){return this._gender}}class oR{constructor(t){this._slotId=t.readInt(),this._figureString=t.readString(),this._gender=t.readString()}get slotId(){return this._slotId}get figureString(){return this._figureString}get gender(){return this._gender}}class _R{flush(){return this._state=0,this._outfits=[],!0}parse(t){if(!t)return!1;this._state=t.readInt();let e=t.readInt();for(;e>0;)this._outfits.push(new oR(t)),e--;return!0}get state(){return this._state}get outfits(){return this._outfits}}class ch{constructor(t){if(!t)throw new Error("invalid_parser");this._id=t.readInt(),this._name=t.readString(),this._motto=t.readString(),this._gender=t.readString(),this._figure=t.readString()}get id(){return this._id}get name(){return this._name}get motto(){return this._motto}get figure(){return this._figure}get gender(){return this._gender}}class hR{flush(){return this._item=null,this._openInventory=!1,!0}parse(t){return t?(this._item=new ch(t),this._openInventory=t.readBoolean(),!0):!1}get item(){return this._item}openInventory(){return this._openInventory}}class uR{flush(){return this._items=null,!0}parse(t){this._items=new Map;let e=t.readInt();for(;e>0;){const s=new ch(t);this._items.set(s.id,s),e--}return!0}get items(){return this._items}}class lR{flush(){return this._boughtAsGift=!1,this._item=null,!0}parse(t){return t?(this._boughtAsGift=t.readBoolean(),this._item=new ch(t),!0):!1}get boughtAsGift(){return this._boughtAsGift}get item(){return this._item}}class cR{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class dR{constructor(t){this._name=t.readString(),this._id=t.readInt(),this._consequence=t.readString()}get name(){return this._name}get id(){return this._id}get consequence(){return this._consequence}}class gR{constructor(t){this._topics=[],this._name=t.readString();let e=t.readInt();for(;e>0;)this._topics.push(new dR(t)),e--}dispose(){this._disposed||(this._disposed=!0,this._topics=null)}get disposed(){return this._disposed}get name(){return this._name}get topics(){return this._topics}}class ER{constructor(t){this._tradeLockInfo="",this._machineBanInfo="",this._name=t.readString(),this._sanctionLengthInHours=t.readInt(),this._probationDays=t.readInt(),this._avatarOnly=t.readBoolean(),t.bytesAvailable&&(this._tradeLockInfo=t.readString()),t.bytesAvailable&&(this._machineBanInfo=t.readString())}get name(){return this._name}get sanctionLengthInHours(){return this._sanctionLengthInHours}get avatarOnly(){return this._avatarOnly}get tradeLockInfo(){return this._tradeLockInfo}get machineBanInfo(){return this._machineBanInfo}}class fR{flush(){return this._issueId=-1,this._accountId=1,this._sanctionType=null,!0}parse(t){return t?(this._issueId=t.readInt(),this._accountId=t.readInt(),this._sanctionType=new ER(t),!0):!1}get issueId(){return this._issueId}get accountId(){return this._accountId}get sanctionType(){return this._sanctionType}}class mR{flush(){return this._callForHelpCategories=null,!0}parse(t){if(!t)return!1;this._callForHelpCategories=[];let e=t.readInt();for(;e>0;)this._callForHelpCategories.push(new gR(t)),e--;return!0}get callForHelpCategories(){return this._callForHelpCategories}}class IR{flush(){return this._isSanctionNew=!1,this._isSanctionActive=!1,this._sanctionName=null,this._sanctionLengthHours=0,this._sanctionReason=null,this._sanctionCreationTime=null,this._probationHoursLeft=0,this._nextSanctionName=null,this._nextSanctionLengthHours=0,this._hasCustomMute=!1,this._tradeLockExpiryTime=null,!0}parse(t){return t?(this._isSanctionNew=t.readBoolean(),this._isSanctionActive=t.readBoolean(),this._sanctionName=t.readString(),this._sanctionLengthHours=t.readInt(),t.readInt(),this._sanctionReason=t.readString(),this._sanctionCreationTime=t.readString(),this._probationHoursLeft=t.readInt(),this._nextSanctionName=t.readString(),this._nextSanctionLengthHours=t.readInt(),t.readInt(),this._hasCustomMute=t.readBoolean(),t.bytesAvailable&&(this._tradeLockExpiryTime=t.readString()),!0):!1}get isSanctionNew(){return this._isSanctionNew}get isSanctionActive(){return this._isSanctionActive}get sanctionName(){return this._sanctionName}get sanctionLengthHours(){return this._sanctionLengthHours}get sanctionReason(){return this._sanctionReason}get sanctionCreationTime(){return this._sanctionCreationTime}get probationHoursLeft(){return this._probationHoursLeft}get nextSanctionName(){return this._nextSanctionName}get nextSanctionLengthHours(){return this._nextSanctionLengthHours}get hasCustomMute(){return this._hasCustomMute}get tradeLockExpiryTime(){return this._tradeLockExpiryTime}}class RR{constructor(){this._ok=!1,this._secondsToWait=0}flush(){return this._ok=!1,this._secondsToWait=0,this._extraDataId=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._secondsToWait=t.readInt(),this._ok&&t.bytesAvailable&&(this._extraDataId=t.readString()),!0):!1}get ok(){return this._ok}get secondsToWait(){return this._secondsToWait}get extraDataId(){return this._extraDataId}}class TR{flush(){return!0}parse(t){return!!t}}class pR{flush(){return this._url="",!0}parse(t){return t?(this._url=t.readString(),!0):!1}get url(){return this._url}}class OR{constructor(){this._ok=!1,this._errorReason=null}flush(){return this._ok=!1,this._errorReason=null,!0}parse(t){return t?(this._ok=t.readBoolean(),this._errorReason=t.readString(),!0):!1}get ok(){return this._ok}get errorReason(){return this._errorReason}}class AR{constructor(){this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0}flush(){return this._creditPrice=0,this._ducketPrice=0,this._publishDucketPrice=0,!0}parse(t){return t?(this._creditPrice=t.readInt(),this._ducketPrice=t.readInt(),t.bytesAvailable&&(this._publishDucketPrice=t.readInt()),!0):!1}get creditPrice(){return this._creditPrice}get ducketPrice(){return this._ducketPrice}get publishDucketPrice(){return this._publishDucketPrice}}class SR{constructor(){this._ok=!0,this._renderLimitHit=!1}flush(){return this._ok=!0,this._renderLimitHit=!1,!0}parse(t){return t?(t.bytesAvailable&&(this._ok=t.readBoolean(),this._renderLimitHit=t.readBoolean()),!0):!1}get ok(){return this._ok}get isRenderLimitHit(){return this._renderLimitHit}}class dh{parse(t){if(!t)return!1;this._campaignName=t.readString(),this._campaignImage=t.readString(),this._currentDay=t.readInt(),this._campaignDays=t.readInt(),this._openedDays=[];let e=t.readInt();for(let s=0;s<e;s++)this._openedDays.push(t.readInt());this._missedDays=[],e=t.readInt();for(let s=0;s<e;s++)this._missedDays.push(t.readInt());return!0}clone(){const t=new dh;return t.campaignDays=this._campaignDays,t.campaignImage=this._campaignImage,t.campaignName=this._campaignName,t.currentDay=this._currentDay,t.missedDays=this._missedDays,t.openedDays=this._openedDays,t}get campaignName(){return this._campaignName}set campaignName(t){this._campaignName=t}get campaignImage(){return this._campaignImage}set campaignImage(t){this._campaignImage=t}get currentDay(){return this._currentDay}set currentDay(t){this._currentDay=t}get campaignDays(){return this._campaignDays}set campaignDays(t){this._campaignDays=t}get openedDays(){return this._openedDays}set openedDays(t){this._openedDays=t}get missedDays(){return this._missedDays}set missedDays(t){this._missedDays=t}}class MR{flush(){return this._calendarData=null,!0}parse(t){return t?(this._calendarData=new dh,this._calendarData.parse(t),!0):!1}get calendarData(){return this._calendarData}}class CR{flush(){return this._doorOpened=!1,this._productName=null,this._customImage=null,this._furnitureClassName=null,!0}parse(t){return t?(this._doorOpened=t.readBoolean(),this._productName=t.readString(),this._customImage=t.readString(),this._furnitureClassName=t.readString(),!0):!1}get doorOpened(){return this._doorOpened}get productName(){return this._productName}get customImage(){return this._customImage}get furnitureClassName(){return this._furnitureClassName}}class NR{flush(){return this._totalCoinsForBonus=-1,this._coinsStillRequiredToBuy=-1,this._productType="",this._productClassId=-1,!0}parse(t){return t?(this._productType=t.readString(),this._productClassId=t.readInt(),this._totalCoinsForBonus=t.readInt(),this._coinsStillRequiredToBuy=t.readInt(),!0):!1}get totalCoinsForBonus(){return this._totalCoinsForBonus}get coinsStillRequiredToBuy(){return this._coinsStillRequiredToBuy}get productType(){return this._productType}get productClassId(){return this._productClassId}}class DR{flush(){return this._furniCount=0,!0}parse(t){return t?(this._furniCount=t.readInt(),!0):!1}get furniCount(){return this._furniCount}}class PR{flush(){return this._secondsLeft=0,this._furniLimit=0,this._maxFurniLimit=0,this._secondsLeftWithGrace=0,!0}parse(t){return t?(this._secondsLeft=t.readInt(),this._furniLimit=t.readInt(),this._maxFurniLimit=t.readInt(),t.bytesAvailable?this._secondsLeftWithGrace=t.readInt():this._secondsLeftWithGrace=this._secondsLeft,!0):!1}get secondsLeft(){return this._secondsLeft}get furniLimit(){return this._furniLimit}get maxFurniLimit(){return this._maxFurniLimit}get secondsLeftWithGrace(){return this._secondsLeftWithGrace}}class yR{constructor(t){this._maxPurchaseSize=t.readInt(),this._bundleSize=t.readInt(),this._bundleDiscountSize=t.readInt(),this._bonusThreshold=t.readInt(),this._additionalBonusDiscountThresholdQuantities=[];let e=t.readInt();for(;e>0;)this._additionalBonusDiscountThresholdQuantities.push(t.readInt()),e--}get maxPurchaseSize(){return this._maxPurchaseSize}get bundleSize(){return this._bundleSize}get bundleDiscountSize(){return this._bundleDiscountSize}get bonusThreshold(){return this._bonusThreshold}get additionalBonusDiscountThresholdQuantities(){return this._additionalBonusDiscountThresholdQuantities}}class LR{flush(){return this._bundleDiscountRuleset=null,!0}parse(t){return t?(this._bundleDiscountRuleset=new yR(t),!0):!1}get bundleDiscountRuleset(){return this._bundleDiscountRuleset}}class gh{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._visible=!1,this._icon=0,this._pageId=-1,this._pageName=null,this._localization=null,this._children=[],this._offerIds=[],!0}parse(t){if(!t)return!1;this._visible=t.readBoolean(),this._icon=t.readInt(),this._pageId=t.readInt(),this._pageName=t.readString(),this._localization=t.readString();let e=t.readInt();for(;e>0;)this._offerIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._children.push(new gh(t)),s--;return!0}get visible(){return this._visible}get icon(){return this._icon}get pageId(){return this._pageId}get pageName(){return this._pageName}get localization(){return this._localization}get children(){return this._children}get offerIds(){return this._offerIds}}class UR{flush(){return this._root=null,!0}parse(t){return t?(this._root=new gh(t),this._newAdditionsAvailable=t.readBoolean(),this._catalogType=t.readString(),!0):!1}get root(){return this._root}get newAdditionsAvailable(){return this._newAdditionsAvailable}get catalogType(){return this._catalogType}}class vR{constructor(t){this._images=[],this._texts=[];let e=t.readInt();for(;e>0;)this._images.push(t.readString()),e--;let s=t.readInt();for(;s>0;)this._texts.push(t.readString()),s--}get images(){return this._images}get texts(){return this._texts}}class bR{flush(){return this._pageName=null,this._pageId=0,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get pageId(){return this._pageId}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}const rn=class vc{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._productType=null,this._furniClassId=-1,this._extraParam=null,this._productCount=0,this._uniqueLimitedItem=!1,this._uniqueLimitedItemSeriesSize=0,this._uniqueLimitedItemsLeft=0,!0}parse(t){switch(this._productType=t.readString(),this._productType){case vc.B:return this._extraParam=t.readString(),this._productCount=1,!0;default:return this._furniClassId=t.readInt(),this._extraParam=t.readString(),this._productCount=t.readInt(),this._uniqueLimitedItem=t.readBoolean(),this._uniqueLimitedItem&&(this._uniqueLimitedItemSeriesSize=t.readInt(),this._uniqueLimitedItemsLeft=t.readInt()),!0}}get productType(){return this._productType}get furniClassId(){return this._furniClassId}get extraParam(){return this._extraParam}get productCount(){return this._productCount}get uniqueLimitedItem(){return this._uniqueLimitedItem}get uniqueLimitedSeriesSize(){return this._uniqueLimitedItemSeriesSize}get uniqueLimitedItemsLeft(){return this._uniqueLimitedItemsLeft}};rn.I="i";rn.S="s";rn.E="e";rn.B="b";let Fa=rn;class xa{constructor(t){this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean(),this._products=[];let e=t.readInt();for(;e>0;)this._products.push(new Fa(t)),e--;this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),this._isPet=t.readBoolean(),this._previewImage=t.readString()}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get isPet(){return this._isPet}get previewImage(){return this._previewImage}get products(){return this._products}}const Ga=class Yn{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._position=null,this._itemName=null,this._itemPromoImage=null,this._catalogPageLocation=null,this._productCode=null,this._productOfferId=0,this._expirationTime=0,!0}parse(t){if(!t)return!1;switch(this._position=t.readInt(),this._itemName=t.readString(),this._itemPromoImage=t.readString(),this._type=t.readInt(),this._type){case Yn.ITEM_CATALOGUE_PAGE:this._catalogPageLocation=t.readString();break;case Yn.ITEM_PRODUCT_OFFER:this._productOfferId=t.readInt();break;case Yn.ITEM_IAP:this._productCode=t.readString();break}const e=t.readInt();return this._expirationTime=e>0?e*1e3+$():0,!0}get type(){return this._type}get position(){return this._position}get itemName(){return this._itemName}get itemPromoImage(){return this._itemPromoImage}get catalogPageLocation(){return this._catalogPageLocation}get productCode(){return this._productCode}get productOfferId(){return this._productOfferId}get expirationTime(){return this._expirationTime}};Ga.ITEM_CATALOGUE_PAGE=0;Ga.ITEM_PRODUCT_OFFER=1;Ga.ITEM_IAP=2;let FR=Ga;class xR{flush(){return this._pageId=-1,this._catalogType=null,this._layoutCode=null,this._localization=null,this._offers=[],this._offerId=-1,this._acceptSeasonCurrencyAsCredits=!1,this._frontPageItems=[],!0}parse(t){if(!t)return!1;this._pageId=t.readInt(),this._catalogType=t.readString(),this._layoutCode=t.readString(),this._localization=new vR(t);let e=t.readInt();for(;e>0;)this._offers.push(new xa(t)),e--;if(this._offerId=t.readInt(),this._acceptSeasonCurrencyAsCredits=t.readBoolean(),t.bytesAvailable){let s=t.readInt();for(;s>0;)this._frontPageItems.push(new FR(t)),s--}return!0}get pageId(){return this._pageId}get catalogType(){return this._catalogType}get layoutCode(){return this._layoutCode}get localization(){return this._localization}get offers(){return this._offers}get offerId(){return this._offerId}get acceptSeasonCurrencyAsCredits(){return this._acceptSeasonCurrencyAsCredits}get frontPageItems(){return this._frontPageItems}}class GR{flush(){return this._pageName=null,this._secondsToExpiry=0,this._image=null,!0}parse(t){return t?(this._pageName=t.readString(),this._secondsToExpiry=t.readInt(),this._image=t.readString(),!0):!1}get pageName(){return this._pageName}get secondsToExpiry(){return this._secondsToExpiry}get image(){return this._image}}class BR{flush(){return this._instantlyRefreshCatalogue=!1,this._newFurniDataHash=null,!0}parse(t){return t?(this._instantlyRefreshCatalogue=t.readBoolean(),t.bytesAvailable&&(this._newFurniDataHash=t.readString()),!0):!1}get instantlyRefreshCatalogue(){return this._instantlyRefreshCatalogue}get newFurniDataHash(){return this._newFurniDataHash}}class wR{constructor(t){this._offerId=t.readInt(),this._isVip=t.readBoolean(),this._daysRequired=t.readInt(),this._isSelectable=t.readBoolean()}get offerId(){return this._offerId}get isVip(){return this._isVip}get isSelectable(){return this._isSelectable}get daysRequired(){return this._daysRequired}}class HR{flush(){return!0}parse(t){if(!t)return!1;this._offers=[],this._giftData=new Map,this._daysUntilNextGift=t.readInt(),this._giftsAvailable=t.readInt();const e=t.readInt();for(let i=0;i<e;i++)this._offers.push(new xa(t));const s=t.readInt();for(let i=0;i<s;i++){const r=new wR(t);this._giftData.set(r.offerId,r)}return!0}get offers(){return this._offers}get daysUntilNextGift(){return this._daysUntilNextGift}get giftsAvailable(){return this._giftsAvailable}set giftsAvailable(t){this._giftsAvailable=t}getOfferExtraData(t){return t?this._giftData.get(t):null}get giftData(){return this._giftData}}class VR{flush(){return this._productCode=null,this._products=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._products.push(new Fa(t)),e--;return!0}get productCode(){return this._productCode}get products(){return this._products}}class bc{constructor(t){if(!t)throw new Error("invalid_wrapper");this._offerId=t.readInt(),this._productCode=t.readString(),t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._vip=t.readBoolean(),this._months=t.readInt(),this._extraDays=t.readInt(),this._giftable=t.readBoolean(),this._daysLeftAfterPurchase=t.readInt(),this._year=t.readInt(),this._month=t.readInt(),this._day=t.readInt()}get offerId(){return this._offerId}get productCode(){return this._productCode}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get vip(){return this._vip}get months(){return this._months}get extraDays(){return this._extraDays}get daysLeftAfterPurchase(){return this._daysLeftAfterPurchase}get year(){return this._year}get month(){return this._month}get day(){return this._day}get giftable(){return this._giftable}}class jR extends bc{constructor(t){super(t),this._originalPrice=t.readInt(),this._originalActivityPointPrice=t.readInt(),this._originalActivityPointType=t.readInt(),this._subscriptionDaysLeft=t.readInt()}get originalPrice(){return this._originalPrice*this.months}get originalActivityPointPrice(){return this._originalActivityPointPrice*this.months}get originalActivityPointType(){return this._originalActivityPointType}get discountCreditAmount(){return this._originalPrice*this.months-this.priceCredits}get discountActivityPointAmount(){return this.originalActivityPointPrice*this.months-this.priceActivityPoints}get subscriptionDaysLeft(){return this._subscriptionDaysLeft}}class zR{flush(){return this._available=!1,this._pricePointUrl=null,this._market=null,this._lengthInDays=0,!0}parse(t){return t?(this._pricePointUrl=t.readString(),this._pricePointUrl!==""&&(this._available=!0),this._market=t.readString(),this._lengthInDays=t.readInt(),!0):!1}get available(){return this._available}get pricePointUrl(){return this._pricePointUrl}get market(){return this._market}get lengthInDays(){return this._lengthInDays}}class YR{flush(){return!0}parse(t){return!!t}}class WR{constructor(){this._isEnabled=!1,this._price=null,this._giftWrappers=null,this._boxTypes=null,this._ribbonTypes=null,this._giftFurnis=null}flush(){return this._boxTypes=null,this._giftFurnis=null,this._giftWrappers=null,this._ribbonTypes=null,this._isEnabled=null,this._price=null,!0}parse(t){if(!t)return!1;const e=[],s=[],i=[],r=[];this._isEnabled=t.readBoolean(),this._price=t.readInt();let a=t.readInt(),o=0;for(;o<a;)e.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)s.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)i.push(t.readInt()),o++;for(a=t.readInt(),o=0;o<a;)r.push(t.readInt()),o++;return this._giftWrappers=e,this._ribbonTypes=i,this._giftFurnis=r,this._boxTypes=s,!0}get giftWrappers(){return this._giftWrappers}get ribbonTypes(){return this._ribbonTypes}get giftFurnis(){return this._giftFurnis}get boxTypes(){return this._boxTypes}get isEnabled(){return this._isEnabled}get price(){return this._price}}class kR{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new jR(t),!0):!1}get offer(){return this._offer}}class KR{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._offers.push(new bc(t)),e--;return!0}get offers(){return this._offers}}class XR{flush(){return this._offerId=0,this._isGiftable=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._isGiftable=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get isGiftable(){return this._isGiftable}}class qR{flush(){return!0}parse(t){return!!t}}class QR{flush(){return this._appearsInSeconds=-1,this._pageId=-1,this._offerId=-1,this._productType="",!0}parse(t){return t?(this._appearsInSeconds=t.readInt(),this._pageId=t.readInt(),this._offerId=t.readInt(),this._productType=t.readString(),!0):!1}get appearsInSeconds(){return this._appearsInSeconds}get pageId(){return this._pageId}get offerId(){return this._offerId}get productType(){return this._productType}}class JR{constructor(){this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0}flush(){return this._notEnoughCredits=!1,this._notEnoughActivityPoints=!1,this._activityPointType=0,!0}parse(t){return t?(this._notEnoughCredits=t.readBoolean(),this._notEnoughActivityPoints=t.readBoolean(),t.bytesAvailable&&(this._activityPointType=t.readInt()),!0):!1}get notEnoughCredits(){return this._notEnoughCredits}get notEnoughActivityPoints(){return this._notEnoughActivityPoints}get activityPointType(){return this._activityPointType}}class ZR{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new xa(t),!0):!1}get offer(){return this._offer}}class $R{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class tT{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get code(){return this._code}}class eT{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._offerId=-1,this._localizationId=null,this._rent=!1,this._priceCredits=0,this._priceActivityPoints=0,this._priceActivityPointsType=0,this._clubLevel=0,this._giftable=!1,this._bundlePurchaseAllowed=!1,this._products=[],!0}parse(t){if(!t)return!1;this._offerId=t.readInt(),this._localizationId=t.readString(),this._rent=t.readBoolean(),this._priceCredits=t.readInt(),this._priceActivityPoints=t.readInt(),this._priceActivityPointsType=t.readInt(),this._giftable=t.readBoolean();let e=t.readInt();for(;e>0;)this._products.push(new Fa(t)),e--;return this._clubLevel=t.readInt(),this._bundlePurchaseAllowed=t.readBoolean(),!0}get offerId(){return this._offerId}get localizationId(){return this._localizationId}get rent(){return this._rent}get priceCredits(){return this._priceCredits}get priceActivityPoints(){return this._priceActivityPoints}get priceActivityPointsType(){return this._priceActivityPointsType}get clubLevel(){return this._clubLevel}get giftable(){return this._giftable}get bundlePurchaseAllowed(){return this._bundlePurchaseAllowed}get products(){return this._products}}class sT{flush(){return this._offer=null,!0}parse(t){return t?(this._offer=new eT(t),!0):!1}get offer(){return this._offer}}class iT{flush(){return this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,!0}parse(t){return t?(this._clubLevel=t.readInt(),this._securityLevel=t.readInt(),this._isAmbassador=t.readBoolean(),!0):!1}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}}class Ba{flush(){return!0}parse(t){return t?(this._status=t.readInt(),!0):!1}get status(){return this._status}}Ba.SAFETY_LOCK_STATUS_LOCKED=0;Ba.SAFETY_LOCK_STATUS_UNLOCKED=1;class rT{flush(){return this._result=-1,this._validationInfo="",!0}parse(t){return t?(this._result=t.readInt(),this._validationInfo=t.readString(),!0):!1}get result(){return this._result}get validationInfo(){return this._validationInfo}}class Fc{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}Fc.EMAIL_STATUS_OK=0;class nT{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._relationshipStatusType=Mi.NONE,this._friendCount=0,this._randomFriendId=0,this._randomFriendFigure=null,this._randomFriendName=null,!0}parse(t){return t?(this._relationshipStatusType=t.readInt(),this._friendCount=t.readInt(),this._randomFriendId=t.readInt(),this._randomFriendName=t.readString(),this._randomFriendFigure=t.readString(),!0):!1}get relationshipStatusType(){return this._relationshipStatusType}get friendCount(){return this._friendCount}get randomFriendId(){return this._randomFriendId}get randomFriendName(){return this._randomFriendName}get randomFriendFigure(){return this._randomFriendFigure}}class aT{flush(){return this._userId=0,this._relationshipStatusMap=null,!0}parse(t){if(!t)return!1;this._userId=t.readInt(),this._relationshipStatusMap=new vt;const e=t.readInt();for(let s=0;s<e;s++){const i=new nT(t);this._relationshipStatusMap.add(i.relationshipStatusType,i)}return!0}get userId(){return this._userId}get relationshipStatusMap(){return this._relationshipStatusMap}}class oT{flush(){return this._userId=null,this._badges=[],!0}parse(t){if(!t)return!1;this._userId=t.readInt();let e=t.readInt();for(;e>0;){t.readInt();const s=t.readString();this._badges.push(s),e--}return!0}get userId(){return this._userId}get badges(){return this._badges}}class _T{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._userId=0,this._username=null,this._figure=null,this._gender=null,this._motto=null,this._realName=null,this._directMail=!1,this._respectsReceived=0,this._respectsRemaining=0,this._respectsPetRemaining=0,this._streamPublishingAllowed=!1,this._lastAccessDate=null,this._canChangeName=!1,this._safetyLocked=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._motto=t.readString(),this._realName=t.readString(),this._directMail=t.readBoolean(),this._respectsReceived=t.readInt(),this._respectsRemaining=t.readInt(),this._respectsPetRemaining=t.readInt(),this._streamPublishingAllowed=t.readBoolean(),this._lastAccessDate=t.readString(),this._canChangeName=t.readBoolean(),this._safetyLocked=t.readBoolean(),!0):!1}get userId(){return this._userId}get username(){return this._username}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get realName(){return this._realName}get directMail(){return this._directMail}get respectsReceived(){return this._respectsReceived}get respectsRemaining(){return this._respectsRemaining}get respectsPetRemaining(){return this._respectsPetRemaining}get streamPublishingAllowed(){return this._streamPublishingAllowed}get lastAccessedDate(){return this._lastAccessDate}get canChangeName(){return this._canChangeName}get safetyLocked(){return this._safetyLocked}}class hT{flush(){return this._userInfo=null,!0}parse(t){return!(!t||(this._userInfo=new _T(t),!this._userInfo))}get userInfo(){return this._userInfo}}class uT{flush(){return this._webId=-1,this._id=-1,this._newName="",!0}parse(t){return t?(this._webId=t.readInt(),this._id=t.readInt(),this._newName=t.readString(),!0):!1}get webId(){return this._webId}get id(){return this._id}get newName(){return this._newName}}class xc{constructor(t){this._groupId=t.readInt(),this._groupName=t.readString(),this._badgeCode=t.readString(),this._colorA=t.readString(),this._colorB=t.readString(),this._favourite=t.readBoolean(),this._ownerId=t.readInt(),this._hasForum=t.readBoolean()}get groupId(){return this._groupId}get groupName(){return this._groupName}get badgeCode(){return this._badgeCode}get colorA(){return this._colorA}get colorB(){return this._colorB}get favourite(){return this._favourite}get ownerId(){return this._ownerId}get hasForum(){return this._hasForum}}class lT{flush(){return this._id=0,this._username=null,this._figure=null,this._motto=null,this._registration=null,this._achievementPoints=0,this._friendsCount=0,this._isMyFriend=!1,this._requestSent=!1,this._isOnline=!1,this._groups=[],this._secondsSinceLastVisit=0,this._openProfileWindow=!1,!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._username=t.readString(),this._figure=t.readString(),this._motto=t.readString(),this._registration=t.readString(),this._achievementPoints=t.readInt(),this._friendsCount=t.readInt(),this._isMyFriend=t.readBoolean(),this._requestSent=t.readBoolean(),this._isOnline=t.readBoolean();const e=t.readInt();for(let s=0;s<e;s++)this._groups.push(new xc(t));return this._secondsSinceLastVisit=t.readInt(),this._openProfileWindow=t.readBoolean(),!0}get id(){return this._id}get username(){return this._username}get figure(){return this._figure}get motto(){return this._motto}get registration(){return this._registration}get achievementPoints(){return this._achievementPoints}get friendsCount(){return this._friendsCount}get isMyFriend(){return this._isMyFriend}get requestSent(){return this._requestSent}get isOnline(){return this._isOnline}get groups(){return this._groups}get secondsSinceLastVisit(){return this._secondsSinceLastVisit}get openProfileWindow(){return this._openProfileWindow}}class cT{flush(){return this._volumeSystem=0,this._volumeFurni=0,this._volumeTrax=0,this._oldChat=!1,this._roomInvites=!1,this._cameraFollow=!1,this._flags=0,this._chatType=0,!0}parse(t){return t?(this._volumeSystem=t.readInt(),this._volumeFurni=t.readInt(),this._volumeTrax=t.readInt(),this._oldChat=t.readBoolean(),this._roomInvites=t.readBoolean(),this._cameraFollow=t.readBoolean(),this._flags=t.readInt(),this._chatType=t.readInt(),!0):!1}get volumeSystem(){return this._volumeSystem}get volumeFurni(){return this._volumeFurni}get volumeTrax(){return this._volumeTrax}get oldChat(){return this._oldChat}get roomInvites(){return this._roomInvites}get cameraFollow(){return this._cameraFollow}get flags(){return this._flags}get chatType(){return this._chatType}}class dT{flush(){return this._roomUnitId=-1,this._tags=[],!0}parse(t){if(!t)return!1;this._roomUnitId=t.readInt();let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}get roomUnitId(){return this._roomUnitId}get tags(){return this._tags}}class gT{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}}class ET{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class fT{flush(){return this._groupId=-1,!0}parse(t){return t?(this._groupId=t.readInt(),!0):!1}get groupId(){return this._groupId}}class mT{flush(){return this._groupId=-1,this._requester=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._requester=new cb(t),!0):!1}get groupId(){return this._groupId}get requester(){return this._requester}}class Gc{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}Gc.INSUFFICIENT_SUBSCRIPTION_LEVEL=2;class IT{flush(){return this._guildId=-1,this._reason=-1,!0}parse(t){return t?(this._guildId=t.readInt(),this._reason=t.readInt(),!0):!1}get guildId(){return this._guildId}get reason(){return this._reason}}class RT{flush(){return this._groups=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._groups.push(new xc(t)),e--;return!0}get groups(){return this._groups}}class TT{flush(){return this._badges=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._badges.set(s,i),e--}return!0}get badges(){return this._badges}}class Bc{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}Bc.INSUFFICIENT_SUBSCRIPTION_LEVEL=4;class pT{flush(){return this._ignoredUsers=[],!0}parse(t){if(!t)return!1;this._ignoredUsers=[];let e=t.readInt();for(;e>0;)this._ignoredUsers.push(t.readString()),e--;return!0}get ignoredUsers(){return this._ignoredUsers}}class OT{flush(){return this._result=-1,this._name=null,!0}parse(t){return t?(this._result=t.readInt(),this._name=t.readString(),!0):!1}get result(){return this._result}get name(){return this._name}}class AT{flush(){return this._link=null,!0}parse(t){return t?(this._link=t.readString(),!0):!1}get link(){return this._link}}class ST{flush(){return this._credits=null,!0}parse(t){return t?(this._credits=t.readString(),!0):!1}get credits(){return this._credits}}class MT{flush(){return this._currencies=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._currencies.set(t.readInt(),t.readInt()),e--;return!0}get currencies(){return this._currencies}}class nn{flush(){return this._productName=null,this._daysToPeriodEnd=0,this._memberPeriods=0,this._periodsSubscribedAhead=0,this._responseType=0,this._hasEverBeenMember=!1,this._isVip=!1,this._pastClubDays=0,this._pastVipDays=0,this._minutesUntilExpiration=0,this._minutesSinceLastModified=0,!0}parse(t){return t?(this._productName=t.readString(),this._daysToPeriodEnd=t.readInt(),this._memberPeriods=t.readInt(),this._periodsSubscribedAhead=t.readInt(),this._responseType=t.readInt(),this._hasEverBeenMember=t.readBoolean(),this._isVip=t.readBoolean(),this._pastClubDays=t.readInt(),this._pastVipDays=t.readInt(),this._minutesUntilExpiration=t.readInt(),t.bytesAvailable&&(this._minutesSinceLastModified=t.readInt()),!0):!1}get productName(){return this._productName}get daysToPeriodEnd(){return this._daysToPeriodEnd}get memberPeriods(){return this._memberPeriods}get periodsSubscribedAhead(){return this._periodsSubscribedAhead}get responseType(){return this._responseType}get hasEverBeenMember(){return this._hasEverBeenMember}get isVip(){return this._isVip}get pastClubDays(){return this._pastClubDays}get pastVipDays(){return this._pastVipDays}get minutesUntilExpiration(){return this._minutesUntilExpiration}get minutesSinceLastModified(){return this._minutesSinceLastModified}}nn.RESPONSE_TYPE_LOGIN=1;nn.RESPONSE_TYPE_PURCHASE=2;nn.RESPONSE_TYPE_DISCOUNT_AVAILABLE=3;nn.RESPONSE_TYPE_CITIZENSHIP_DISCOUNT=4;class _r{constructor(t){if(this._unseen=0,!t)throw new Error("invalid_parser");this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._scoreAtStartOfLevel=t.readInt(),this._scoreLimit=Math.max(1,t.readInt()),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._currentPoints=t.readInt(),this._finalLevel=t.readBoolean(),this._category=t.readString(),this._subCategory=t.readString(),this._levelCount=t.readInt(),this._displayMethod=t.readInt()}get achievementId(){return this._achievementId}get badgeId(){return this._badgeId}get level(){return this._level}get scoreAtStartOfLevel(){return this._scoreAtStartOfLevel}get scoreLimit(){return this._scoreLimit-this._scoreAtStartOfLevel}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get currentPoints(){return this._currentPoints-this._scoreAtStartOfLevel}get finalLevel(){return this._finalLevel}get category(){return this._category}get subCategory(){return this._subCategory}get levelCount(){return this._levelCount}get firstLevelAchieved(){return this._level>1||this._finalLevel}setMaxProgress(){this._currentPoints=this._scoreLimit}get displayMethod(){return this._displayMethod}get progress(){return this._currentPoints}get toNextProgress(){return this._scoreLimit}set unseen(t){this._unseen=t}get unseen(){return this._unseen}reset(t){this._achievementId=t._achievementId,this._level=t._level,this._badgeId=t._badgeId,this._scoreAtStartOfLevel=t._scoreAtStartOfLevel,this._scoreLimit=t._scoreLimit,this._levelRewardPoints=t._levelRewardPoints,this._levelRewardPointType=t._levelRewardPointType,this._currentPoints=t._currentPoints,this._finalLevel=t._finalLevel,this._category=t.category,this._subCategory=t._subCategory,this._levelCount=t._levelCount,this._displayMethod=t._displayMethod}}_r.DISPLAY_METHOD_OBSOLETE=-1;_r.DISPLAY_METHOD_SHOW_LEVEL_PROGRESS=0;_r.DISPLAY_METHOD_NEVER_SHOW_PROGRESS=1;_r.DISPLAY_METHOD_SHOW_TOTAL_PROGRESS=2;class CT{flush(){return this._achievement=null,!0}parse(t){return t?(this._achievement=new _r(t),!0):!1}get achievement(){return this._achievement}}const wc=class Hc{constructor(t){this._achievementId=t.readInt(),this._level=t.readInt(),this._badgeId=t.readString(),this._requiredLevel=t.readInt(),this._state=t.readInt()}dispose(){this._achievementId=0,this._level=0,this._badgeId="",this._requiredLevel=0}get achievementId(){return this._achievementId}get level(){return this._level}get badgeId(){return this._badgeId}get requiredLevel(){return this._requiredLevel}get enabled(){return this._state===Hc.STATE_SELECTABLE}get state(){return this._state}};wc.STATE_SELECTABLE=0;let NT=wc;class DT{flush(){return this._achievements=[],this._defaultCategory=null,!0}parse(t){if(!t)return!1;this._achievements=[];let e=t.readInt();for(;e>0;)this._achievements.push(new _r(t)),e--;return this._defaultCategory=t.readString(),!0}get achievements(){return this._achievements}get defaultCategory(){return this._defaultCategory}}class PT{flush(){return this._score=0,!0}parse(t){return t?(this._score=t.readInt(),!0):!1}get score(){return this._score}}class yT{get type(){return this._type}set type(t){this._type=t}get subType(){return this._subType}set subType(t){this._subType=t}get duration(){return this._duration}set duration(t){this._duration=t}get inactiveEffectsInInventory(){return this._inactiveEffectsInInventory}set inactiveEffectsInInventory(t){this._inactiveEffectsInInventory=t}get secondsLeftIfActive(){return this._secondsLeftIfActive}set secondsLeftIfActive(t){this._secondsLeftIfActive=t}get isPermanent(){return this._permanent}set isPermanent(t){this._permanent=t}}class LT{flush(){return this._type=0,this._duration=0,this._isPermanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._duration=t.readInt(),this._isPermanent=t.readBoolean(),!0):!1}get type(){return this._type}get duration(){return this._duration}get isPermanent(){return this._isPermanent}}class UT{flush(){return this._type=0,this._subType=0,this._duration=0,this._permanent=!1,!0}parse(t){return t?(this._type=t.readInt(),this._subType=t.readInt(),this._duration=t.readInt(),this._permanent=t.readBoolean(),!0):!1}get type(){return this._type}get subType(){return this._subType}get duration(){return this._duration}get isPermanent(){return this._permanent}}class vT{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class bT{flush(){return this._type=0,!0}parse(t){return t?(this._type=t.readInt(),!0):!1}get type(){return this._type}}class FT{flush(){return this._effects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=new yT;s.type=t.readInt(),s.subType=t.readInt(),s.duration=t.readInt(),s.inactiveEffectsInInventory=t.readInt(),s.secondsLeftIfActive=t.readInt(),s.isPermanent=t.readBoolean(),this._effects.push(s),e--}return!0}get effects(){return this._effects}}class xT{constructor(t,e){if(!e)throw new Error("invalid_parser");this._badgeId="ACH_"+t+e.readInt(),this._limit=e.readInt()}get badgeId(){return this._badgeId}get limit(){return this._limit}}class GT{flush(){return this._data=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readString(),i=t.readInt();let r=0;for(;r<i;)this._data.push(new xT(s,t)),r++;e--}return!0}get data(){return this._data}}class BT{flush(){return this._badgeId=0,this._badgeCode=null,!0}parse(t){return t?(this._badgeId=t.readInt(),this._badgeCode=t.readString(),!0):!1}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}}class wT{flush(){return this._allBadgeCodes=[],this._activeBadgeCodes=null,this._badgeIds=null,!0}parse(t){if(!t)return!1;this._allBadgeCodes=[],this._activeBadgeCodes=[],this._badgeIds=new vt;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._badgeIds.add(i,s),this._allBadgeCodes.push(i),e--}for(e=t.readInt();e>0;){t.readInt();const s=t.readString();this._activeBadgeCodes.push(s),e--}return!0}getBadgeId(t){return this._badgeIds.getValue(t)}getAllBadgeCodes(){return this._allBadgeCodes}getActiveBadgeCodes(){return this._activeBadgeCodes}}class HT{flush(){return!0}parse(t){return t?(this._requestCode=t.readString(),this._fulfilled=t.readBoolean(),!0):!1}get requestCode(){return this._requestCode}get fulfilled(){return this._fulfilled}}class VT{flush(){return this._figureSetIds=[],this._boundFurnitureNames=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._figureSetIds.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._boundFurnitureNames.push(t.readString()),s--;return!0}get figureSetIds(){return this._figureSetIds}get boundsFurnitureNames(){return this._boundFurnitureNames}}class an{flush(){return this._reason=0,this._parameter="",!0}parse(t){return t?(this._reason=t.readInt(),this._parameter=t.readString(),!0):!1}get reason(){return this._reason}get parameter(){return this._parameter}}an.REASON_FULL=1;an.REASON_CLOSED=2;an.REASON_QUEUE_ERROR=3;an.REASON_BANNED=4;class jT{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class zT{flush(){return!0}parse(t){return!!t}}class YT{flush(){return!0}parse(t){return!!t}}class WT{flush(){return this._controllerLevel=Ie.NONE,!0}parse(t){return t?(this._controllerLevel=t.readInt(),!0):!1}get controllerLevel(){return this._controllerLevel}}class kT{flush(){return!0}parse(t){return!!t}}class KT{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class XT{flush(){return this._botId=-1,this._commandId=-1,this._data="",!0}parse(t){return t?(this._botId=t.readInt(),this._commandId=t.readInt(),this._data=t.readString(),!0):!1}get botId(){return this._botId}get commandId(){return this._commandId}get data(){return this._data}}class qT{flush(){return this._botId=-1,!0}parse(t){return t?(this._botId=t.readInt(),!0):!1}get botId(){return this._botId}}class QT{constructor(t){this._id=t.readInt(),this._data=t.readString()}get id(){return this._id}get data(){return this._data}}class JT{flush(){return this._botId=-1,this._skillList=[],!0}parse(t){if(!t)return!1;this._botId=t.readInt();let e=t.readInt();for(;e>0;)this._skillList.push(new QT(t)),e--;return!0}get botId(){return this._botId}get skillList(){return this._skillList}}class ZT{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}}class $T{flush(){return this._roomId=0,this._bannedUsers=[],!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;)this._bannedUsers.push(new ZT(t)),e--;return!0}get roomId(){return this._roomId}get bannedUsers(){return this._bannedUsers}}class tp{constructor(t){this._userId=t.readInt(),this._userName=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get selected(){return this._selected}set selected(t){this._selected=t}}class ep{flush(){return this._roomId=0,this._data=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._data=new tp(t),!0):!1}get roomId(){return this._roomId}get data(){return this._data}}class sp{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class ip{flush(){return this._roomId=0,this._users=new Map,!0}parse(t){if(!t)return!1;this._roomId=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();this._users.set(s,i),e--}return!0}get roomId(){return this._roomId}get users(){return this._users}}class rp{flush(){return!0}parse(t){return t?(this._isMuted=t.readBoolean(),!0):!1}get isMuted(){return this._isMuted}}class np{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class Ee{constructor(t){if(!t)throw new Error("invalid_wrapper");this._mode=t.readInt(),this._weight=t.readInt(),this._speed=t.readInt(),this._distance=t.readInt(),this._protection=t.readInt()}get mode(){return this._mode}get weight(){return this._weight}get speed(){return this._speed}get distance(){return this._distance}get protection(){return this._protection}}Ee.CHAT_MODE_FREE_FLOW=0;Ee.CHAT_MODE_LINE_BY_LINE=1;Ee.CHAT_BUBBLE_WIDTH_WIDE=0;Ee.CHAT_BUBBLE_WIDTH_NORMAL=1;Ee.CHAT_BUBBLE_WIDTH_THIN=2;Ee.CHAT_SCROLL_SPEED_FAST=0;Ee.CHAT_SCROLL_SPEED_NORMAL=1;Ee.CHAT_SCROLL_SPEED_SLOW=2;Ee.FLOOD_FILTER_STRICT=0;Ee.FLOOD_FILTER_NORMAL=1;Ee.FLOOD_FILTER_LOOSE=2;class on{constructor(t){this._allowMute=t.readInt(),this._allowKick=t.readInt(),this._allowBan=t.readInt()}get allowMute(){return this._allowMute}get allowKick(){return this._allowKick}get allowBan(){return this._allowBan}}on.MODERATION_LEVEL_NONE=0;on.MODERATION_LEVEL_USER_WITH_RIGHTS=1;on.MODERATION_LEVEL_ALL=2;const xs=class gs{constructor(){this._roomId=-1,this._name=null,this._description=null,this._doorMode=gs.DOORMODE_OPEN,this._categoryId=-1,this._maximumVisitors=0,this._maximumVisitorsLimit=0,this._tags=[],this._tradeMode=gs.TRADEMODE_NOT_ALLOWED,this._allowPets=!1,this._allowFoodConsume=!1,this._allowWalkThrough=!1,this._hideWalls=!1,this._wallThickness=0,this._floorThickness=0,this._controllersById=new Map,this._controllerList=null,this._highlightedUserId=-1,this._bannedUsersById=new Map,this._bannedUsersList=null,this._roomModerationSettings=null,this._chatSettings=null,this._allowNavigatorDynamicCats=!1}static from(t){const e=new gs;return e._roomId=t._roomId,e._name=t._name,e._description=t._description,e._doorMode=t._doorMode,e._categoryId=t._categoryId,e._maximumVisitors=t._maximumVisitors,e._maximumVisitorsLimit=t._maximumVisitorsLimit,e._tags=t._tags,e._tradeMode=t._tradeMode,e._allowPets=t._allowPets,e._allowFoodConsume=t._allowFoodConsume,e._allowWalkThrough=t._allowWalkThrough,e._hideWalls=t._hideWalls,e._wallThickness=t._wallThickness,e._floorThickness=t._floorThickness,e._controllersById=t._controllersById,e._controllerList=t._controllerList,e._highlightedUserId=t._highlightedUserId,e._bannedUsersById=t._bannedUsersById,e._bannedUsersList=t._bannedUsersList,e._roomModerationSettings=t._roomModerationSettings,e._chatSettings=t._chatSettings,e._allowNavigatorDynamicCats=t._allowNavigatorDynamicCats,e}static getDoorModeLocalizationKey(t){switch(t){case gs.DOORMODE_OPEN:return"${navigator.door.mode.open}";case gs.DOORMODE_CLOSED:return"${navigator.door.mode.closed}";case gs.DOORMODE_PASSWORD:return"${navigator.door.mode.password}";case gs.DOORMODE_INVISIBLE:return"${navigator.door.mode.invisible}";case gs.DOORMODE_NOOBS_ONLY:return"${navigator.door.mode.noobs_only}"}return""}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get allowFoodConsume(){return this._allowFoodConsume}set allowFoodConsume(t){this._allowFoodConsume=t}get allowWalkThrough(){return this._allowWalkThrough}set allowWalkThrough(t){this._allowWalkThrough=t}get hideWalls(){return this._hideWalls}set hideWalls(t){this._hideWalls=t}get wallThickness(){return this._wallThickness}set wallThickness(t){this._wallThickness=t}get floorThickness(){return this._floorThickness}set floorThickness(t){this._floorThickness=t}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get name(){return this._name}set name(t){this._name=t}get description(){return this._description}set description(t){this._description=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get categoryId(){return this._categoryId}set categoryId(t){this._categoryId=t}get maximumVisitors(){return this._maximumVisitors}set maximumVisitors(t){this._maximumVisitors=t}get maximumVisitorsLimit(){return this._maximumVisitorsLimit}set maximumVisitorsLimit(t){this._maximumVisitorsLimit=t}get tags(){return this._tags}set tags(t){this._tags=t}setFlatController(t,e){this._controllersById.set(t,e),this._controllerList=null,this._highlightedUserId=t}get roomModerationSettings(){return this._roomModerationSettings}set roomModerationSettings(t){this._roomModerationSettings=t}get controllersById(){return this._controllersById}set controllersById(t){this._controllersById=t}get controllerList(){if(!this._controllerList){this._controllerList=[];for(const t of this._controllersById.values())this._controllerList.push(t);this._controllerList.sort((t,e)=>t.userName.localeCompare(e.userName))}return this._controllerList}get highlightedUserId(){return this._highlightedUserId}setBannedUser(t,e){this._bannedUsersById.set(t,e),this._bannedUsersList=null}get bannedUsersById(){return this._bannedUsersById}get bannedUsersList(){if(!this._bannedUsersList){this._bannedUsersList=[];for(const t of this._bannedUsersById.values())this._bannedUsersList.push(t);this._bannedUsersList.sort((t,e)=>t.userName.localeCompare(e.userName))}return this._bannedUsersList}get chatSettings(){return this._chatSettings}set chatSettings(t){this._chatSettings=t}get allowNavigatorDynamicCats(){return this._allowNavigatorDynamicCats}set allowNavigatorDynamicCats(t){this._allowNavigatorDynamicCats=t}};xs.DOORMODE_OPEN=0;xs.DOORMODE_CLOSED=1;xs.DOORMODE_PASSWORD=2;xs.DOORMODE_INVISIBLE=3;xs.DOORMODE_NOOBS_ONLY=4;xs.TRADEMODE_NOT_ALLOWED=0;xs.TRADEMODE_WITH_CONTROLLER=1;xs.TRADEMODE_ALLOWED=2;let ap=xs;class op{flush(){return this._roomSettingsData=null,!0}parse(t){if(!t)return!1;this._roomSettingsData=new ap,this._roomSettingsData.roomId=t.readInt(),this._roomSettingsData.name=t.readString(),this._roomSettingsData.description=t.readString(),this._roomSettingsData.doorMode=t.readInt(),this._roomSettingsData.categoryId=t.readInt(),this._roomSettingsData.maximumVisitors=t.readInt(),this._roomSettingsData.maximumVisitorsLimit=t.readInt(),this._roomSettingsData.tags=[];let e=t.readInt();for(;e>0;)this._roomSettingsData.tags.push(t.readString()),e--;return this._roomSettingsData.tradeMode=t.readInt(),this._roomSettingsData.allowPets=t.readInt()===1,this._roomSettingsData.allowFoodConsume=t.readInt()===1,this._roomSettingsData.allowWalkThrough=t.readInt()===1,this._roomSettingsData.hideWalls=t.readInt()===1,this._roomSettingsData.wallThickness=t.readInt(),this._roomSettingsData.floorThickness=t.readInt(),this._roomSettingsData.chatSettings=new Ee(t),this._roomSettingsData.allowNavigatorDynamicCats=t.readBoolean(),this._roomSettingsData.roomModerationSettings=new on(t),!0}get data(){return this._roomSettingsData}}class _p{flush(){return this._roomId=0,this._code=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}}class hp{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class fe{flush(){return this._roomId=0,this._code=0,this._message=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._code=t.readInt(),this._message=t.readString(),!0):!1}get roomId(){return this._roomId}get code(){return this._code}get message(){return this._message}}fe.ERROR_ROOM_NOT_FOUND=1;fe.ERROR_NOT_OWNER=2;fe.ERROR_INVALID_DOOR_MODE=3;fe.ERROR_INVALID_USER_LIMIT=4;fe.ERROR_INVALID_PASSWORD=5;fe.ERROR_INVALID_CATEGORY=6;fe.ERROR_INVALID_NAME=7;fe.ERROR_UNACCEPTABLE_NAME=8;fe.ERROR_INVALID_DESCRIPTION=9;fe.ERROR_UNACCEPTABLE_DESCRIPTION=10;fe.ERROR_INVALID_TAG=11;fe.ERROR_NON_USER_CHOOSABLE_TAG=12;fe.ERROR_TOO_MANY_CHARACTERS_IN_TAG=13;class up{flush(){return this._selectionType=0,!0}parse(t){return t?(this._selectionType=t.readInt(),!0):!1}get selectionType(){return this._selectionType}}class lp{flush(){return this._roomId=0,this._userId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._userId=t.readInt(),!0):!1}get roomId(){return this._roomId}get userId(){return this._userId}}class cp{flush(){return this._chat=null,!0}parse(t){return t?(this._chat=new Ee(t),!0):!1}get chat(){return this._chat}}const Le=class ci{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=0,this._roomName=null,this._ownerId=0,this._ownerName=null,this._doorMode=0,this._userCount=0,this._maxUserCount=0,this._description=null,this._tradeMode=2,this._score=0,this._ranking=0,this._categoryId=0,this._totalStars=0,this._groupId=0,this._groupName=null,this._groupBadge=null,this._tags=[],this._bitMask=0,this._thumbnail=null,this._allowPets=!1,this._showOwner=!0,this._displayAd=!1,this._adName=null,this._adDescription=null,this._adExpiresIn=0,this._allInRoomMuted=!1,this._canMute=!1,this._officialRoomPicRef=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._doorMode=t.readInt(),this._userCount=t.readInt(),this._maxUserCount=t.readInt(),this._description=t.readString(),this._tradeMode=t.readInt(),this._score=t.readInt(),this._ranking=t.readInt(),this._categoryId=t.readInt(),this.parseTags(t),this.parseBitMask(t),!0):!1}parseTags(t){if(!t)return!1;this._tags=[];let e=t.readInt();for(;e>0;)this._tags.push(t.readString()),e--;return!0}parseBitMask(t){return t?(this._bitMask=t.readInt(),this._bitMask&ci.THUMBNAIL_BITMASK&&(this._officialRoomPicRef=t.readString()),this._bitMask&ci.GROUPDATA_BITMASK&&(this._groupId=t.readInt(),this._groupName=t.readString(),this._groupBadge=t.readString()),this._bitMask&ci.ROOMAD_BITMASK&&(this._adName=t.readString(),this._adDescription=t.readString(),this._adExpiresIn=t.readInt()),this._showOwner=(this._bitMask&ci.SHOWOWNER_BITMASK)>0,this._allowPets=(this._bitMask&ci.ALLOW_PETS_BITMASK)>0,this._displayAd=(this._bitMask&ci.DISPLAY_ROOMAD_BITMASK)>0,this._thumbnail=null,!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}set roomName(t){this._roomName=t}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get doorMode(){return this._doorMode}get userCount(){return this._userCount}get maxUserCount(){return this._maxUserCount}get description(){return this._description}get tradeMode(){return this._tradeMode}get score(){return this._score}get ranking(){return this._ranking}get categoryId(){return this._categoryId}get tags(){return this._tags}get officialRoomPicRef(){return this._officialRoomPicRef}get habboGroupId(){return this._groupId}get groupName(){return this._groupName}get groupBadgeCode(){return this._groupBadge}get roomAdName(){return this._adName}get roomAdDescription(){return this._adDescription}get roomAdExpiresInMin(){return this._adExpiresIn}get showOwner(){return this._showOwner}get allowPets(){return this._allowPets}get displayRoomEntryAd(){return this._displayAd}get canMute(){return this._canMute}set canMute(t){this._canMute=t}get allInRoomMuted(){return this._allInRoomMuted}set allInRoomMuted(t){this._allInRoomMuted=t}};Le.THUMBNAIL_BITMASK=1;Le.GROUPDATA_BITMASK=2;Le.ROOMAD_BITMASK=4;Le.SHOWOWNER_BITMASK=8;Le.ALLOW_PETS_BITMASK=16;Le.DISPLAY_ROOMAD_BITMASK=32;Le.OPEN_STATE=0;Le.DOORBELL_STATE=1;Le.PASSWORD_STATE=2;Le.INVISIBLE_STATE=3;Le.NOOB_STATE=4;let wa=Le;class dp{flush(){return this._roomId=0,this._isOwner=!1,!0}parse(t){return t?(this._roomId=t.readInt(),this._isOwner=t.readBoolean(),!0):!1}get roomId(){return this._roomId}get isOwner(){return this._isOwner}}class gp{flush(){return this._totalLikes=0,this._canLike=!1,!0}parse(t){return t?(this._totalLikes=t.readInt(),this._canLike=t.readBoolean(),!0):!1}get totalLikes(){return this._totalLikes}get canLike(){return this._canLike}}class Ep{flush(){return this._roomIndex=-1,this._groupId=-1,this._status=0,this._groupName=null,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._groupId=t.readInt(),this._status=t.readInt(),this._groupName=t.readString(),!0):!1}get roomIndex(){return this._roomIndex}get groupId(){return this._groupId}get status(){return this._status}get groupName(){return this._groupName}}class fp{constructor(t,e,s){this._id=0,this._state=0,this._id=t,this._state=e,this._data=s}get id(){return this._id}get state(){return this._state}get data(){return this._data}}class mp{flush(){return this._code=0,!0}parse(t){return t?(this._code=t.readInt(),!0):!1}get count(){return this._code}}class Ip{flush(){return this._itemId=0,this._value=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._value=t.readInt(),!0):!1}get itemId(){return this._itemId}get value(){return this._value}}class ni{flush(){return this._itemId=0,this._data=null,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=ni.parseObjectData(t),!0):!1}static parseObjectData(t){if(!t)return null;const e=$s.getData(t.readInt());return e?(e.parseWrapper(t),e):null}get furnitureId(){return this._itemId}get objectData(){return this._data}}class Eh{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._spriteName=null,this._x=0,this._y=0,this._direction=0,this._z=0,this._stackHeight=0,this._extra=0,this._data=null,this._state=0,this._expires=0,this._usagePolicy=0,this._userId=0,this._username=null,!0}parse(t){return t?(this._itemId=t.readInt(),this._spriteId=t.readInt(),this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt()%8*45,this._z=parseFloat(t.readString()),this._stackHeight=parseFloat(t.readString()),this._extra=t.readInt(),this._data=ni.parseObjectData(t),this._state=parseFloat(this._data&&this._data.getLegacyString())||0,this._expires=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null,this._spriteId<0&&(this._spriteName=t.readString()),!0):!1}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}get z(){return isNaN(this._z)?0:this._z}get stackHeight(){return isNaN(this._stackHeight)?0:this._stackHeight}get extra(){return this._extra}get data(){return this._data}get state(){return this._state}get expires(){return this._expires}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get spriteName(){return this._spriteName}set spriteName(t){this._spriteName=t}}class Rp{flush(){return this._item=null,!0}parse(t){return t?(this._item=new Eh(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class Tp{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new Eh(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class pp{flush(){return this._itemId=0,this._isExpired=!0,this._userId=0,this._delay=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._isExpired=t.readBoolean(),this._userId=t.readInt(),this._delay=t.readInt(),!0):!1}get itemId(){return this._itemId}get isExpired(){return this._isExpired}get userId(){return this._userId}get delay(){return this._delay}}class Op{flush(){return this._item=null,!0}parse(t){return t?(this._item=new Eh(t),!0):!1}get item(){return this._item}}class Ap{flush(){return this._isWallItem=!1,this._furniTypeName=null,this._buyout=!1,this._priceInCredits=-1,this._priceInActivityPoints=-1,this._activityPointType=-1,!0}parse(t){return t?(this._isWallItem=t.readBoolean(),this._furniTypeName=t.readString(),this._buyout=t.readBoolean(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),!0):!1}get isWallItem(){return this._isWallItem}get furniTypeName(){return this._furniTypeName}get buyout(){return this._buyout}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}}class Sp{flush(){return this._aliases=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._aliases.set(t.readString(),t.readString()),e--;return!0}get aliases(){return this._aliases}}class Mp{flush(){return this._furniId=-1,this._height=0,!0}parse(t){return t?(this._furniId=t.readInt(),this._height=t.readInt()/100,!0):!1}get furniId(){return this._furniId}get height(){return this._height}}class Cp{flush(){return this._objectId=0,this._guildId=0,this._guildName=null,this._guildHomeRoomId=0,this._userIsMember=!1,this._guildHasReadableForum=!1,!0}parse(t){return t?(this._objectId=t.readInt(),this._guildId=t.readInt(),this._guildName=t.readString(),this._guildHomeRoomId=t.readInt(),this._userIsMember=t.readBoolean(),this._guildHasReadableForum=t.readBoolean(),!0):!1}get objectId(){return this._objectId}get guildId(){return this._guildId}get guildName(){return this._guildName}get guildHomeRoomId(){return this._guildHomeRoomId}get userIsMember(){return this._userIsMember}get guildHasReadableForum(){return this._guildHasReadableForum}}class Np{flush(){return this._itemId=0,this._data="",!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._data=t.readString(),!0):!1}get furnitureId(){return this._itemId}get data(){return this._data}}class Dp{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class Pp{get furniId(){return this._furniId}flush(){return this._furniId=-1,!0}parse(t){return this._furniId=t.readInt(),!0}}class yp{get furniId(){return this._furniId}get start(){return this._start}flush(){return this._furniId=-1,this._start=!1,!0}parse(t){return this._furniId=t.readInt(),this._start=t.readBoolean(),!0}}class Lp{flush(){return this._itemId=0,this._state=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._state=t.readInt(),!0):!1}get itemId(){return this._itemId}get state(){return this._state}}class Up{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class vp{flush(){return!0}parse(t){return t?(this._expiryTime=t.readInt(),!0):!1}get expiryTime(){return this._expiryTime}}class bp{flush(){return this._rented=!1,this._renterId=-1,this._renterName=null,this._canRent=!1,this._canRentErrorCode=-1,this._timeRemaining=-1,this._price=-1,!0}parse(t){return t?(this._rented=t.readBoolean(),this._canRentErrorCode=t.readInt(),this._canRent=this._canRentErrorCode===0,this._renterId=t.readInt(),this._renterName=t.readString(),this._timeRemaining=t.readInt(),this._price=t.readInt(),this._rented||(this._renterId=-1,this._renterName=""),!0):!1}get rented(){return this._rented}get renterId(){return this._renterId}get renterName(){return this._renterName}get canRent(){return this._canRent}get price(){return this._price}get timeRemaining(){return this._timeRemaining}get canRentErrorCode(){return this._canRentErrorCode}}class Fp{flush(){return this._itemId=-1,this._location="",!0}parse(t){return t?(this._itemId=t.readInt(),this._location=t.readString(),!0):!1}get itemId(){return this._itemId}get location(){return this._location}}class xp{constructor(t,e,s,i){this.id=t,this.type=e,this.color=s,this.brightness=i}}class Gp{constructor(){this._selectedPresetId=0,this._presets=[]}flush(){return this._presets=[],!0}parse(t){const e=t.readInt();this._selectedPresetId=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),r=t.readInt(),a=parseInt(t.readString().substr(1),16),o=t.readInt();this._presets.push(new xp(i,r,a,o))}return!0}getPreset(t){return t<0||t>=this.presetCount?null:this._presets[t]}get presetCount(){return this._presets.length}get selectedPresetId(){return this._selectedPresetId}}class Bp{flush(){return this._roomId=-1,this._roomName=null,this._messageCount=-1,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),this._messageCount=t.readInt(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}get messageCount(){return this._messageCount}}class fh{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._itemId=0,this._spriteId=0,this._location=null,this._stuffData=null,this._state=0,this._secondsToExpiration=0,this._usagePolicy=-1,this._userId=0,this._username=null,this._width=0,this._height=0,this._localX=0,this._localY=0,this._y=0,this._z=0,this._direction=null,this._isOldFormat=!1,!0}parse(t){if(!t)return!1;this._itemId=parseInt(t.readString()),this._spriteId=t.readInt(),this._location=t.readString(),this._stuffData=t.readString(),this._secondsToExpiration=t.readInt(),this._usagePolicy=t.readInt(),this._userId=t.readInt(),this._username=null;const e=parseFloat(this._stuffData);if(isNaN(e)||(this._state=Math.trunc(e)),this._location.indexOf(":")===0){this._isOldFormat=!1;let s=this._location.split(" ");if(s.length>=3){let i=s[0],r=s[1];const a=s[2];if(i.length>3&&r.length>2&&(i=i.substr(3),r=r.substr(2),s=i.split(","),s.length>=2)){const o=parseInt(s[0]),_=parseInt(s[1]);if(s=r.split(","),s.length>=2){const l=parseInt(s[0]),c=parseInt(s[1]);this._width=o,this._height=_,this._localX=l,this._localY=c,this._direction=a}}}}else this._isOldFormat=!0;return!0}get itemId(){return this._itemId}get spriteId(){return this._spriteId}get wallPosition(){return this._location}get stuffData(){return this._stuffData}get state(){return this._state}get secondsToExpiration(){return this._secondsToExpiration}get usagePolicy(){return this._usagePolicy}get userId(){return this._userId}get username(){return this._username}set username(t){this._username=t}get width(){return this._width}get height(){return this._height}get localX(){return this._localX}get localY(){return this._localY}get direction(){return this._direction}get isOldFormat(){return this._isOldFormat}}class wp{flush(){return this._item=null,!0}parse(t){return t?(this._item=new fh(t),this._item.username=t.readString(),!0):!1}get item(){return this._item}}class Hp{flush(){return this._owners=new Map,this._items=[],!0}parse(t){if(!t||!this.parseOwners(t))return!1;let e=t.readInt();for(;e>0;){const s=new fh(t);if(!s)continue;const i=this._owners.get(s.userId);i&&(s.username=i),this._items.push(s),e--}return!0}parseOwners(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._owners.set(t.readInt(),t.readString()),e--;return!0}get owners(){return this._owners}get items(){return this._items}}class Vp{flush(){return this._itemId=0,this._userId=0,!0}parse(t){return t?(this._itemId=parseInt(t.readString()),this._userId=t.readInt(),!0):!1}get itemId(){return this._itemId}get userId(){return this._userId}}class jp{flush(){return this._item=null,!0}parse(t){return t?(this._item=new fh(t),!0):!1}get item(){return this._item}}class zp{flush(){return this._email=null,this._isVerified=!1,this._allowChange=!1,this._furniId=-1,this._requestedByUser=!1,!0}parse(t){return t?(this._email=t.readString(),this._isVerified=t.readBoolean(),this._allowChange=t.readBoolean(),this._furniId=t.readInt(),this._requestedByUser=t.readBoolean(),!0):!1}get email(){return this._email}get isVerified(){return this._isVerified}get allowChange(){return this._allowChange}get furniId(){return this._furniId}get requestedByUser(){return this._requestedByUser}}class Yp{parse(t){return this._furniId=t.readInt(),this._commandId=t.readInt(),!0}flush(){return this._furniId=-1,this._commandId=-1,!0}get furniId(){return this._furniId}get commandId(){return this._commandId}}class Wp{constructor(t,e,s){this._video=t,this._title=e,this._description=s}get video(){return this._video}get title(){return this._title}get description(){return this._description}}class kp{flush(){return this._furniId=-1,this._playlists=null,this._selectedPlaylistId=null,!0}parse(t){this._furniId=t.readInt();const e=t.readInt();this._playlists=[];for(let s=0;s<e;s++)this._playlists.push(new Wp(t.readString(),t.readString(),t.readString()));return this._selectedPlaylistId=t.readString(),!0}get furniId(){return this._furniId}get playlists(){return this._playlists}get selectedPlaylistId(){return this._selectedPlaylistId}}class Kp{flush(){return!0}parse(t){return this._furniId=t.readInt(),this._videoId=t.readString(),this._startAtSeconds=t.readInt(),this._endAtSeconds=t.readInt(),this._state=t.readInt(),!0}get furniId(){return this._furniId}get videoId(){return this._videoId}get state(){return this._state}get startAtSeconds(){return this._startAtSeconds}get endAtSeconds(){return this._endAtSeconds}}class Xp{flush(){return this._objects=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=ni.parseObjectData(t),r=parseFloat(i.getLegacyString());this._objects.push(new fp(s,r,i)),e--}return!0}get objects(){return this._objects}}class qp{flush(){return this._rollerId=0,this._itemsRolling=[],this._unitRolling=null,!0}parse(t){if(!t)return!1;const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=t.readInt();let a=t.readInt();for(;a>0;){const d=t.readInt(),E=parseFloat(t.readString()),I=parseFloat(t.readString()),m=new Ms(d,new R(e,s,E),new R(i,r,I));this._itemsRolling.push(m),a--}if(this._rollerId=t.readInt(),!t.bytesAvailable)return!0;const o=t.readInt(),_=t.readInt(),l=parseFloat(t.readString()),c=parseFloat(t.readString());switch(o){case 0:break;case 1:this._unitRolling=new Ms(_,new R(e,s,l),new R(i,r,c),Ms.MOVE);break;case 2:this._unitRolling=new Ms(_,new R(e,s,l),new R(i,r,c),Ms.SLIDE);break}return!0}get rollerId(){return this._rollerId}get itemsRolling(){return this._itemsRolling}get unitRolling(){return this._unitRolling}}const Vc=class Zo{flush(){return this._model=null,this._width=0,this._height=0,this._wallHeight=-1,this._heightMap=[],this._scale=64,this._model=null,!0}parse(t){if(!t)return!1;const e=t.readBoolean(),s=t.readInt(),i=t.readString();return this.parseExplicitly(i,s,e)}parseModel(t,e,s=!0){return this.parseExplicitly(t,e,s)}parseExplicitly(t,e,s=!0){this._scale=s?32:64,this._wallHeight=e,this._model=t;const i=this._model.split("\r"),r=i.length;let a=0,o=0;for(;o<r;){const _=i[o];_.length>a&&(a=_.length),o++}for(this._heightMap=[],o=0;o<r;){const _=[];let l=0;for(;l<a;)_.push(Zo.TILE_BLOCKED),l++;this._heightMap.push(_),o++}for(this._width=a,this._height=r,o=0;o<r;){const _=this._heightMap[o],l=i[o];if(l.length>0){let c=0;for(;c<l.length;){const d=l.charAt(c);let E=Zo.TILE_BLOCKED;d!=="x"&&d!=="X"&&(E=parseInt(d,36)),_[c]=E,c++}}o++}return!0}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return-110;const s=this._heightMap[e];if(s===void 0)return-110;const i=s[t];return i===void 0?-110:i}get model(){return this._model}get width(){return this._width}get height(){return this._height}get heightMap(){return this._heightMap}get wallHeight(){return this._wallHeight}get scale(){return this._scale}};Vc.TILE_BLOCKED=-110;let jc=Vc;class Qp{flush(){return this._x=0,this._y=0,this._direction=0,!0}parse(t){return t?(this._x=t.readInt(),this._y=t.readInt(),this._direction=t.readInt(),!0):!1}get x(){return this._x}get y(){return this._y}get direction(){return this._direction}}class ei{static decodeTileHeight(t){return t<0?-1:(t&16383)/256}static decodeIsStackingBlocked(t){return!!(t&16384)}static decodeIsRoomTile(t){return t>=0}getTileHeight(t,e){return t<0||t>=this._width||e<0||e>=this._height?-1:ei.decodeTileHeight(this._heights[e*this._width+t])}getStackingBlocked(t,e){return t<0||t>=this._width||e<0||e>=this._height?!0:ei.decodeIsStackingBlocked(this._heights[e*this._width+t])}isRoomTile(t,e){return t<0||t>=this._width||e<0||e>=this._height?!1:ei.decodeIsRoomTile(this._heights[e*this._width+t])}flush(){return this._width=0,this._height=0,this._heights=[],!0}parse(t){if(!t)return!1;this._width=t.readInt();const e=t.readInt();this._height=e/this._width;let s=0;for(;s<e;)this._heights[s]=t.readShort(),s++;return!0}get width(){return this._width}get height(){return this._height}get heights(){return this._heights}}class Jp{flush(){return this._wrapper=null,this._count=0,this._x=0,this._y=0,this._value=0,!0}tileHeight(){return ei.decodeTileHeight(this._value)}isStackingBlocked(){return ei.decodeIsStackingBlocked(this._value)}isRoomTile(){return ei.decodeIsRoomTile(this._value)}next(){return this._count?(this._count--,this._x=this._wrapper.readByte(),this._y=this._wrapper.readByte(),this._value=this._wrapper.readShort(),!0):!1}parse(t){return t?(this._wrapper=t,this._count=t.readByte(),!0):!1}get x(){return this._x}get y(){return this._y}get height(){return this._value}}class Zp{flush(){return this._blockedTilesMap=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readInt();this._blockedTilesMap[i]||(this._blockedTilesMap[i]=[]),this._blockedTilesMap[i][s]=!0,e--}return!0}get blockedTilesMap(){return this._blockedTilesMap}}class $p{flush(){return this._floorType=null,this._wallType=null,this._landscapeType=null,this._landscapeAnimation=null,!0}parse(t){if(!t)return!1;const e=t.readString(),s=t.readString();switch(e){case"floor":this._floorType=s;break;case"wallpaper":this._wallType=s;break;case"landscape":this._landscapeType=s;break;case"landscapeanim":this._landscapeAnimation=s;break}return!0}get floorType(){return this._floorType}get wallType(){return this._wallType}get landscapeType(){return this._landscapeType}get landscapeAnimation(){return this._landscapeAnimation}}class tO{flush(){return this._name=null,this._roomId=0,!0}parse(t){return t?(this._name=t.readString(),this._roomId=t.readInt(),!0):!1}get name(){return this._name}get roomId(){return this._roomId}}class eO{flush(){return this._hideWalls=!1,this._thicknessWall=0,this._thicknessFloor=0,!0}parse(t){if(!t)return!1;this._hideWalls=t.readBoolean();let e=t.readInt(),s=t.readInt();return e=e<-2?-2:e>1?1:e,s=s<-2?-2:s>1?1:s,this._thicknessWall=Math.pow(2,e),this._thicknessFloor=Math.pow(2,s),!0}get hideWalls(){return this._hideWalls}get thicknessWall(){return this._thicknessWall}get thicknessFloor(){return this._thicknessFloor}}class Su{constructor(t){if(!t)throw new Error("invalid_wrapper");this._webId=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._figure=t.readString(),this._owner=t.readString()}dispose(){this._webId=0,this._name="",this._level=0,this._figure="",this._owner=""}get webId(){return this._webId}get name(){return this._name}get level(){return this._level}get figure(){return this._figure}get owner(){return this._owner}}class Mu{constructor(t){this._stuffId=t.readInt(),this._classId=t.readInt(),this._productCode=t.readString(),this._userId=t.readInt(),this._userName=t.readString(),this._rarityLevel=t.readInt(),this._hasMutation=t.readBoolean()}get stuffId(){return this._stuffId}get classId(){return this._classId}get productCode(){return this._productCode}get userId(){return this._userId}get userName(){return this._userName}get rarityLevel(){return this._rarityLevel}get hasMutation(){return this._hasMutation}}class sO{flush(){return this._resultData=null,this._otherResultData=null,!0}parse(t){return t?(this._resultData=new Mu(t),this._otherResultData=new Mu(t),!0):!1}get resultData(){return this._resultData}get otherResultData(){return this._otherResultData}}class iO{flush(){return this._petId=-1,this._roomIndex=-1,this._gainedExperience=0,!0}parse(t){return t?(this._petId=t.readInt(),this._roomIndex=t.readInt(),this._gainedExperience=t.readInt(),!0):!1}get petId(){return this._petId}get roomIndex(){return this._roomIndex}get gainedExperience(){return this._gainedExperience}}class rO{flush(){return!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._figureData=new Rh(t),this._hasSaddle=t.readBoolean(),this._isRiding=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get figureData(){return this._figureData}get hasSaddle(){return this._hasSaddle}get isRiding(){return this._isRiding}}class nO{flush(){return this._id=-1,this._skillThresholds=[],!0}parse(t){if(!t)return!1;this._id=t.readInt(),this._name=t.readString(),this._level=t.readInt(),this._maximumLevel=t.readInt(),this._experience=t.readInt(),this._levelExperienceGoal=t.readInt(),this._energy=t.readInt(),this._maximumEnergy=t.readInt(),this._happyness=t.readInt(),this._maximumHappyness=t.readInt(),this._respect=t.readInt(),this._ownerId=t.readInt(),this._age=t.readInt(),this._ownerName=t.readString(),this._rarityLevel=t.readInt(),this._saddle=t.readBoolean(),this._rider=t.readBoolean();let e=t.readInt();for(;e>0;)this._skillThresholds.push(t.readInt()),e--;return this._skillThresholds.sort(),this._publiclyRideable=t.readInt(),this._breedable=t.readBoolean(),this._fullyGrown=t.readBoolean(),this._dead=t.readBoolean(),this._unknownRarity=t.readInt(),this._maximumTimeToLive=t.readInt(),this._remainingTimeToLive=t.readInt(),this._remainingGrowTime=t.readInt(),this._publiclyBreedable=t.readBoolean(),!0}get id(){return this._id}get name(){return this._name}get level(){return this._level}get maximumLevel(){return this._maximumLevel}get experience(){return this._experience}get energy(){return this._energy}get happyness(){return this._happyness}get levelExperienceGoal(){return this._levelExperienceGoal}get maximumEnergy(){return this._maximumEnergy}get maximumHappyness(){return this._maximumHappyness}get respect(){return this._respect}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get age(){return this._age}get rarityLevel(){return this._rarityLevel}get saddle(){return this._saddle}get rider(){return this._rider}get breedable(){return this._breedable}get fullyGrown(){return this._fullyGrown}get dead(){return this._dead}get maximumTimeToLive(){return this._maximumTimeToLive}get remainingTimeToLive(){return this._remainingTimeToLive}get remainingGrowTime(){return this._remainingGrowTime}get skillTresholds(){return this._skillThresholds}get publiclyRideable(){return this._publiclyRideable}get unknownRarity(){return this._unknownRarity}get publiclyBreedable(){return this._publiclyBreedable}}class aO{flush(){return this._roomIndex=-1,this._petId=-1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._petId=t.readInt(),this._canBreed=t.readBoolean(),this._canHarvest=t.readBoolean(),this._canRevive=t.readBoolean(),this._hasBreedingPermission=t.readBoolean(),!0):!1}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get canBreed(){return this._canBreed}get canHarvest(){return this._canHarvest}get canRevive(){return this._canRevive}get hasBreedingPermission(){return this._hasBreedingPermission}}class oO{constructor(t){if(!t)throw new Error("invalid_wrapper");this._chance=t.readInt(),this._breeds=[];let e=t.readInt();for(;e>0;)this._breeds.push(t.readInt()),e--}dispose(){this._chance=-1,this._breeds=[]}get chance(){return this._chance}get breeds(){return this._breeds}}class _O{flush(){return this._isPlaying=!1,!0}parse(t){return t?(this._isPlaying=t.readBoolean(),!0):!1}get isPlaying(){return this._isPlaying}}class hO{flush(){return!0}parse(t){return!0}}class uO{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class lO{flush(){return this._seconds=0,!0}parse(t){return t?(this._seconds=t.readInt(),!0):!1}get seconds(){return this._seconds}}class mh{flush(){return this._roomIndex=null,this._message=null,this._gesture=0,this._bubble=0,this._urls=[],this._messageLength=0,!0}parse(t){return t?(this._roomIndex=t.readInt(),this._message=t.readString(),this._gesture=t.readInt(),this._bubble=t.readInt(),this.parseUrls(t),this._messageLength=t.readInt(),!0):!1}parseUrls(t){if(!t)return!1;this._urls=[];let e=t.readInt();for(;e>0;)this._urls.push(t.readString()),e--;return!0}get roomIndex(){return this._roomIndex}get message(){return this._message}get gesture(){return this._gesture}get bubble(){return this._bubble}get urls(){return this._urls}get messageLength(){return this._messageLength}}class cO{flush(){return this._unitId=null,this._isTyping=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isTyping=t.readInt()===1,!0):!1}get unitId(){return this._unitId}get isTyping(){return this._isTyping}}class dO{flush(){return this._unitId=null,this._danceId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._danceId=t.readInt(),!0):!1}get unitId(){return this._unitId}get danceId(){return this._danceId}}class gO{flush(){return this._unitId=null,this._effectId=0,this._delay=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._effectId=t.readInt(),this._delay=t.readInt(),!0):!1}get unitId(){return this._unitId}get effectId(){return this._effectId}get delay(){return this._delay}}class EO{flush(){return this._unitId=null,this._expression=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._expression=t.readInt(),!0):!1}get unitId(){return this._unitId}get expression(){return this._expression}}class fO{flush(){return this._unitId=null,this._handId=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._handId=t.readInt(),!0):!1}get unitId(){return this._unitId}get handId(){return this._handId}}class mO{flush(){return this._giverUserId=-1,this._handItemType=-1,!0}parse(t){return t?(this._giverUserId=t.readInt(),this._handItemType=t.readInt(),!0):!1}get giverUserId(){return this._giverUserId}get handItemType(){return this._handItemType}}class IO{flush(){return this._unitId=null,this._isIdle=!1,!0}parse(t){return t?(this._unitId=t.readInt(),this._isIdle=t.readBoolean(),!0):!1}get unitId(){return this._unitId}get isIdle(){return this._isIdle}}class RO{flush(){return this._unitId=null,this._figure=null,this._gender="M",this._motto=null,this._achievementScore=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._figure=t.readString(),this._gender=t.readString().toLocaleUpperCase(),this._motto=t.readString(),this._achievementScore=t.readInt(),!0):!1}get unitId(){return this._unitId}get figure(){return this._figure}get gender(){return this._gender}get motto(){return this._motto}get achievementScore(){return this._achievementScore}}class TO{flush(){return this._unitId=null,this._value=0,!0}parse(t){return t?(this._unitId=t.readInt(),this._value=t.readInt(),!0):!1}get unitId(){return this._unitId}get value(){return this._value}}class tr{constructor(t){this._roomIndex=0,this._x=0,this._y=0,this._z=0,this._dir=0,this._name="",this._userType=0,this._sex="",this._figure="",this._custom="",this._activityPoints=0,this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._subType="",this._ownerId=0,this._ownerName="",this._rarityLevel=0,this._hasSaddle=!1,this._isRiding=!1,this._canBreed=!1,this._canHarvest=!1,this._canRevive=!1,this._hasBreedingPermission=!1,this._petLevel=0,this._petPosture="",this._botSkills=[],this._isModerator=!1,this._isReadOnly=!1,this._roomIndex=t}setReadOnly(){this._isReadOnly=!0}get roomIndex(){return this._roomIndex}get x(){return this._x}set x(t){this._isReadOnly||(this._x=t)}get y(){return this._y}set y(t){this._isReadOnly||(this._y=t)}get z(){return this._z}set z(t){this._isReadOnly||(this._z=t)}get dir(){return this._dir}set dir(t){this._isReadOnly||(this._dir=t)}get name(){return this._name}set name(t){this._isReadOnly||(this._name=t)}get userType(){return this._userType}set userType(t){this._isReadOnly||(this._userType=t)}get sex(){return this._sex}set sex(t){this._isReadOnly||(this._sex=t)}get figure(){return this._figure}set figure(t){this._isReadOnly||(this._figure=t)}get custom(){return this._custom}set custom(t){this._isReadOnly||(this._custom=t)}get activityPoints(){return this._activityPoints}set activityPoints(t){this._isReadOnly||(this._activityPoints=t)}get webID(){return this._webID}set webID(t){this._isReadOnly||(this._webID=t)}get groupID(){return this._groupID}set groupID(t){this._isReadOnly||(this._groupID=t)}get groupName(){return this._groupName}set groupName(t){this._isReadOnly||(this._groupName=t)}get groupStatus(){return this._groupStatus}set groupStatus(t){this._isReadOnly||(this._groupStatus=t)}get subType(){return this._subType}set subType(t){this._isReadOnly||(this._subType=t)}get ownerId(){return this._ownerId}set ownerId(t){this._isReadOnly||(this._ownerId=t)}get ownerName(){return this._ownerName}set ownerName(t){this._isReadOnly||(this._ownerName=t)}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._isReadOnly||(this._rarityLevel=t)}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._isReadOnly||(this._hasSaddle=t)}get isRiding(){return this._isRiding}set isRiding(t){this._isReadOnly||(this._isRiding=t)}get canBreed(){return this._canBreed}set canBreed(t){this._isReadOnly||(this._canBreed=t)}get canHarvest(){return this._canHarvest}set canHarvest(t){this._isReadOnly||(this._canHarvest=t)}get canRevive(){return this._canRevive}set canRevive(t){this._isReadOnly||(this._canRevive=t)}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._isReadOnly||(this._hasBreedingPermission=t)}get petLevel(){return this._petLevel}set petLevel(t){this._isReadOnly||(this._petLevel=t)}get petPosture(){return this._petPosture}set petPosture(t){this._isReadOnly||(this._petPosture=t)}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isReadOnly||(this._isModerator=t)}}tr.M="M";tr.F="F";class pO{flush(){return this._users=[],!0}parse(t){if(!t)return!1;this._users=[];const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),r=t.readString(),a=t.readString();let o=t.readString();const _=t.readInt(),l=t.readInt(),c=t.readInt(),d=parseFloat(t.readString()),E=t.readInt(),I=t.readInt(),m=new tr(_);if(m.dir=E,m.name=r,m.custom=a,m.x=l,m.y=c,m.z=d,this._users.push(m),I===1){m.webID=i,m.userType=je.USER,m.sex=this.resolveSex(t.readString()),m.groupID=t.readInt(),m.groupStatus=t.readInt(),m.groupName=t.readString();const T=t.readString();T!==""&&(o=this.convertSwimFigure(T,o,m.sex)),m.figure=o,m.activityPoints=t.readInt(),m.isModerator=t.readBoolean()}else if(I===2)m.userType=je.PET,m.figure=o,m.webID=i,m.subType=t.readInt().toString(),m.ownerId=t.readInt(),m.ownerName=t.readString(),m.rarityLevel=t.readInt(),m.hasSaddle=t.readBoolean(),m.isRiding=t.readBoolean(),m.canBreed=t.readBoolean(),m.canHarvest=t.readBoolean(),m.canRevive=t.readBoolean(),m.hasBreedingPermission=t.readBoolean(),m.petLevel=t.readInt(),m.petPosture=t.readString();else if(I===3)m.userType=je.BOT,m.webID=_*-1,o.indexOf("/")===-1?m.figure=o:m.figure="hr-100-.hd-180-1.ch-876-66.lg-270-94.sh-300-64",m.sex=tr.M;else if(I===4){m.userType=je.RENTABLE_BOT,m.webID=i,m.sex=this.resolveSex(t.readString()),m.figure=o,m.ownerId=t.readInt(),m.ownerName=t.readString();const T=t.readInt();if(T){const p=[];let A=0;for(;A<T;)p.push(t.readShort()),A++;m.botSkills=p}}s++}return!0}resolveSex(t){return t.substr(0,1).toLowerCase()==="f"?tr.F:tr.M}convertSwimFigure(t,e,s){const i=e.split(".");let r=1,a=1,o=1;const _=1e4;let l=0;for(;l<i.length;){const I=i[l].split("-");I.length>2&&I[0]==="hd"&&(r=parseInt(I[2])),l++}const c=["238,238,238","250,56,49","253,146,160","42,199,210","53,51,44","239,255,146","198,255,152","255,146,90","157,89,126","182,243,255","109,255,51","51,120,201","255,182,49","223,161,233","249,251,50","202,175,143","197,198,197","71,98,61","138,131,97","255,140,51","84,198,39","30,108,153","152,79,136","119,200,255","255,192,142","60,75,135","124,44,71","215,255,227","143,63,28","255,99,147","31,155,121","253,255,51"],d=t.split("=");if(d.length>1){const E=d[1].split("/");E[0];const I=E[1];s==="F"?o=10010:o=10011;const m=c.indexOf(I);a=_+m+1}return e+(".bds-10001-"+r+".ss-"+o+"-"+a)}get users(){return this._users}}class OO{flush(){return this._unitId=null,!0}parse(t){return t?(this._unitId=parseInt(t.readString()),!0):!1}get unitId(){return this._unitId}}class AO{constructor(t,e){this._action=t,this._value=e}get action(){return this._action}get value(){return this._value}}class SO{constructor(t,e,s,i,r,a,o,_=0,l=0,c=0,d,E,I){this._id=t,this._x=e,this._y=s,this._z=i,this._height=r,this._headDirection=a,this._direction=o,this._targetX=_,this._targetY=l,this._targetZ=c,this._didMove=d,this._canStandUp=E,this._actions=I||[]}get id(){return this._id}get x(){return this._x}get y(){return this._y}get z(){return this._z}get height(){return this._height}get headDirection(){return this._headDirection}get direction(){return this._direction}get targetX(){return this._targetX}get targetY(){return this._targetY}get targetZ(){return this._targetZ}get didMove(){return this._didMove}get canStandUp(){return this._canStandUp}get actions(){return this._actions}}class MO{flush(){return this._statuses=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=this.parseStatus(t);if(!s){e--;continue}this._statuses.push(s),e--}return!0}parseStatus(t){if(!t)return null;const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=parseFloat(t.readString()),a=t.readInt()%8*45,o=t.readInt()%8*45,_=t.readString();let l=0,c=0,d=0,E=0,I=!1,m=!1;if(_){const T=_.split("/"),p=[];for(const A of T){const N=A.split(" ");if(N[0]!==""&&N.length>=2){switch(N[0]){case"mv":{const C=N[1].split(",");C.length>=3&&(l=parseInt(C[0]),c=parseInt(C[1]),d=parseFloat(C[2]),m=!0);break}case"sit":{const C=parseFloat(N[1]);N.length>=3&&(I=N[2]==="1"),E=C;break}case"lay":{const C=parseFloat(N[1]);E=Math.abs(C);break}}p.push(new AO(N[0],N[1]))}}this._statuses.push(new SO(e,s,i,r,E,a,o,l,c,d,m,I,p))}}get statuses(){return this._statuses}}const Ih=class $o{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rentable=!1,this._itemId=0,this._furniType=null,this._ref=0,this._spriteId=0,this._category=0,this._stuffData=null,this._isGroupable=!1,this._isRecyclable=!1,this._tradable=!1,this._sellable=!1,this._secondsToExpiration=0,this._extra=0,this._flatId=0,this._isWallItem=!1,this._hasRentPeriodStarted=!1,this._expirationTimeStamp=0,this._slotId="",this._songId=-1,!0}parse(t){return t?(this._itemId=t.readInt(),this._furniType=t.readString(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._stuffData=ni.parseObjectData(t),this._isRecyclable=t.readBoolean(),this._tradable=t.readBoolean(),this._isGroupable=t.readBoolean(),this._sellable=t.readBoolean(),this._secondsToExpiration=t.readInt(),this._expirationTimeStamp=$(),this.secondsToExpiration>-1?this._rentable=!0:(this._rentable=!1,this._secondsToExpiration=-1),this._hasRentPeriodStarted=t.readBoolean(),this._flatId=t.readInt(),this._isWallItem=this._furniType===$o.WALL_ITEM,this._furniType===$o.FLOOR_ITEM&&(this._slotId=t.readString(),this._extra=t.readInt()),!0):!1}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get isGroupable(){return this._isGroupable}get isRecycleable(){return this._isRecyclable}get tradable(){return this._tradable}get sellable(){return this._sellable}get secondsToExpiration(){return this._secondsToExpiration}get flatId(){return this._flatId}get slotId(){return this._slotId}get songId(){return this._songId}get extra(){return this._extra}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get creationDay(){return 0}get creationMonth(){return 0}get creationYear(){return 0}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}};Ih.WALL_ITEM="I";Ih.FLOOR_ITEM="S";let zc=Ih;class CO{flush(){return this._items=[],!0}parse(t){return t?(this._items.push(new zc(t)),!0):!1}get items(){return this._items}}class NO{flush(){return!0}parse(t){return!!t}}class DO{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=new Map,!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;){const s=new zc(t);s&&this._fragment.set(s.itemId,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class PO{flush(){return this._itemId=0,!0}parse(t){return t?(this._itemId=t.readInt(),!0):!1}get itemId(){return this._itemId}}class yO{flush(){return this._itemId=0,this._itemsLeft=0,!0}parse(t){return t?(this._itemId=t.readInt(),this._itemsLeft=t.readInt(),!0):!1}get itemId(){return this._itemId}get itemsLeft(){return this._itemsLeft}}class LO{flush(){return this._itemType="",this._classId=0,this._productCode="",!0}parse(t){return t?(this._itemType=t.readString(),this._classId=t.readInt(),this._productCode=t.readString(),this._placedItemId=t.readInt(),this._placedItemType=t.readString(),this._placedInRoom=t.readBoolean(),this._petFigureString=t.readString(),!0):!1}get itemType(){return this._itemType}get classId(){return this._classId}get productCode(){return this._productCode}get placedItemId(){return this._placedItemId}get placedItemType(){return this._placedItemType}get placedInRoom(){return this._placedInRoom}get petFigureString(){return this._petFigureString}}class UO{flush(){this._nestId=0,this._pet1&&(this._pet1.dispose(),this._pet1=null),this._pet2&&(this._pet2.dispose(),this._pet2=null);for(const t of this._rarityCategories)t&&t.dispose();return this._rarityCategories=[],!0}parse(t){if(!t)return!1;this._nestId=t.readInt(),this._pet1=new Su(t),this._pet2=new Su(t);let e=t.readInt();for(;e>0;)this._rarityCategories.push(new oO(t)),e--;return this._resultPetType=t.readInt(),!0}get nestId(){return this._nestId}get pet1(){return this._pet1}get pet2(){return this._pet2}get rarityCategories(){return this._rarityCategories}get resultPetType(){return this._resultPetType}}class vO{flush(){return this._breedingNestStuffId=0,this._result=0,!0}parse(t){return t?(this._breedingNestStuffId=t.readInt(),this._result=t.readInt(),!0):!1}get breedingNestStuffId(){return this._breedingNestStuffId}get result(){return this._result}}class bO{flush(){return this._petId=-1,this._rarityCategory=-1,!0}parse(t){return this._petId=t.readInt(),this._rarityCategory=t.readInt(),!0}get rarityCategory(){return this._rarityCategory}get petId(){return this._petId}}class Rh{constructor(t){this._typeId=t.readInt(),this._paletteId=t.readInt(),this._color=t.readString(),this._breedId=t.readInt(),this._customParts=[],this._customPartCount=t.readInt();let e=0;for(;e<this._customPartCount;)this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),this._customParts.push(t.readInt()),e++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get breedId(){return this._breedId}get figuredata(){let t=this.typeId+" "+this.paletteId+" "+this.color;t=t+(" "+this.custompartCount);for(const e of this.customParts)t=t+(" "+e);return t}get customParts(){return this._customParts}get custompartCount(){return this._customPartCount}}class Ha{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._figureData=new Rh(t),this._level=t.readInt()}get id(){return this._id}get name(){return this._name}get typeId(){return this._figureData.typeId}get paletteId(){return this._figureData.paletteId}get color(){return this._figureData.color}get breedId(){return this._figureData.breedId}get customPartCount(){return this._figureData.custompartCount}get figureString(){return this._figureData.figuredata}get figureData(){return this._figureData}get level(){return this._level}}class FO{flush(){return this._pet=null,this._boughtAsGift=!1,!0}parse(t){return this._pet=new Ha(t),this._boughtAsGift=t.readBoolean(),!0}get pet(){return this._pet}get boughtAsGift(){return this._boughtAsGift}}class Va{flush(){return this._state=0,this._ownPetId=0,this._otherPetId=0,!0}parse(t){return t?(this._state=t.readInt(),this._ownPetId=t.readInt(),this._otherPetId=t.readInt(),!0):!1}get state(){return this._state}get ownPetId(){return this._ownPetId}get otherPetId(){return this._otherPetId}}Va.STATE_CANCEL=1;Va.STATE_ACCEPT=2;Va.STATE_REQUEST=3;class xO{flush(){return this._fragment=null,!0}parse(t){this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(this._fragment=new Map;e>0;){const s=new Ha(t);this._fragment.set(s.id,s),e--}return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class GO{flush(){return this._boughtAsGift=!1,this._pet=null,!0}parse(t){return this._boughtAsGift=t.readBoolean(),this._pet=new Ha(t),!0}get boughtAsGift(){return this._boughtAsGift}get pet(){return this._pet}}class BO{flush(){return!0}parse(t){return t?(this._petId=t.readInt(),!0):!1}get petId(){return this._petId}}class wO{constructor(t){this._itemId=t.readInt(),this._furniType=t.readString().toUpperCase(),this._ref=t.readInt(),this._spriteId=t.readInt(),this._category=t.readInt(),this._isGroupable=t.readBoolean(),this._stuffData=ni.parseObjectData(t),this._secondsToExpiration=-1,this._expirationTimeStamp=$(),this._hasRentPeriodStarted=!1,this._creationDay=t.readInt(),this._creationMonth=t.readInt(),this._creationYear=t.readInt(),this._extra=this.furniType==="S"?t.readInt():-1,this._flatId=-1,this._rentable=!1,this._isWallItem=this._furniType==="I"}get itemId(){return this._itemId}get furniType(){return this._furniType}get ref(){return this._ref}get spriteId(){return this._spriteId}get category(){return this._category}get stuffData(){return this._stuffData}get extra(){return this._extra}get secondsToExpiration(){return this._secondsToExpiration}get creationDay(){return this._creationDay}get creationMonth(){return this._creationMonth}get creationYear(){return this._creationYear}get isGroupable(){return this._isGroupable}get songId(){return this._extra}get flatId(){return this._flatId}get rentable(){return this._rentable}get isWallItem(){return this._isWallItem}get hasRentPeriodStarted(){return this._hasRentPeriodStarted}get expirationTimeStamp(){return this._expirationTimeStamp}get isRecycleable(){return!0}get tradable(){return!0}get sellable(){return!0}get slotId(){return null}get isExternalImageFurni(){return this._furniType.indexOf("external_image")!==-1}}class HO{flush(){return this._userID=-1,this._userAccepts=!1,!0}parse(t){return t?(this._userID=t.readInt(),this._userAccepts=t.readInt()>0,!0):!1}get userID(){return this._userID}get userAccepts(){return this._userAccepts}}class Yc{flush(){return!0}parse(t){return t?(this._userId=t.readInt(),this._reason=t.readInt(),!0):!1}get userID(){return this._userId}get reason(){return this._reason}}Yc.ERROR_WHILE_COMMIT=1;class VO{flush(){return!0}parse(t){return!!t}}class jO{flush(){return!0}parse(t){return!!t}}class zO{flush(){return this._firstUserID=-1,this._firstUserItemArray=null,this._firstUserNumItems=0,this._firstUserNumCredits=0,this._secondUserID=-1,this._secondUserItemArray=null,this._secondUserNumItems=0,this._secondUserNumCredits=0,!0}parse(t){return!t||(this._firstUserID=t.readInt(),this._firstUserItemArray=[],!this.parseItems(t,this._firstUserItemArray))||(this._firstUserNumItems=t.readInt(),this._firstUserNumCredits=t.readInt(),this._secondUserID=t.readInt(),this._secondUserItemArray=[],!this.parseItems(t,this._secondUserItemArray))?!1:(this._secondUserNumItems=t.readInt(),this._secondUserNumCredits=t.readInt(),!0)}parseItems(t,e){let s=t.readInt();for(;s>0;)e.push(new wO(t)),s--;return!0}get firstUserID(){return this._firstUserID}get firstUserItemArray(){return this._firstUserItemArray}get firstUserNumItems(){return this._firstUserNumItems}get firstUserNumCredits(){return this._firstUserNumCredits}get secondUserID(){return this._secondUserID}get secondUserItemArray(){return this._secondUserItemArray}get secondUserNumItems(){return this._secondUserNumItems}get secondUserNumCredits(){return this._secondUserNumCredits}}class YO{flush(){return!0}parse(t){return!!t}}class WO{flush(){return!0}parse(t){return!!t}}class Th{flush(){return!0}parse(t){return t?(this._reason=t.readInt(),this._otherUserName=t.readString(),!0):!1}get reason(){return this._reason}get otherUserName(){return this._otherUserName}}Th.REASON_YOU_ARE_ALREADY_TRADING=7;Th.REASON_OTHER_USER_ALREADY_TRADING=8;class kO{flush(){return this._userId=-1,this._userCanTrade=!1,this._otherUserId=-1,this._otherUserCanTrade=!1,!0}parse(t){return t?(this._userId=t.readInt(),this._userCanTrade=t.readInt()===1,this._otherUserId=t.readInt(),this._otherUserCanTrade=t.readInt()===1,!0):!1}get userID(){return this._userId}get userCanTrade(){return this._userCanTrade}get otherUserID(){return this._otherUserId}get otherUserCanTrade(){return this._otherUserCanTrade}}class KO{flush(){return!0}parse(t){return!!t}}class XO{flush(){return!0}parse(t){return!!t}}class qO{flush(){return this._respect=0,this._petOwnerId=0,this._petData=null,!0}parse(t){return t?(this._respect=t.readInt(),this._petOwnerId=t.readInt(),this._petData=new Ha(t),!0):!1}get respect(){return this._respect}get petOwnerId(){return this._petOwnerId}get petData(){return this._petData}get isTreat(){return this._petData.typeId===nt.MONSTERPLANT}}class QO{flush(){return this._petId=0,this._userId=0,this._supplementType=0,!0}parse(t){return t?(this._petId=t.readInt(),this._userId=t.readInt(),this._supplementType=t.readInt(),!0):!1}get petId(){return this._petId}get userId(){return this._userId}get supplementType(){return this._supplementType}}class si{}si.WATER=0;si.LIGHT=1;si.REVIVE=2;si.REBREED_FERTILIZER=3;si.SPEED_FERTILIZER=4;class JO{flush(){return this._userId=0,this._respectsReceived=0,!0}parse(t){return t?(this._userId=t.readInt(),this._respectsReceived=t.readInt(),!0):!1}get userId(){return this._userId}get respectsReceived(){return this._respectsReceived}}class ZO{constructor(t,e,s){this._hasControllers=!1,this._roomId=t,this._roomName=e,this._hasControllers=s}get roomId(){return this._roomId}get roomName(){return this._roomName}get hasControllers(){return this._hasControllers}}class $O{constructor(t){this._currentHcStreak=t.readInt(),this._firstSubscriptionDate=t.readString(),this._kickbackPercentage=t.readDouble(),this._totalCreditsMissed=t.readInt(),this._totalCreditsRewarded=t.readInt(),this._totalCreditsSpent=t.readInt(),this._creditRewardForStreakBonus=t.readInt(),this._creditRewardForMonthlySpent=t.readInt(),this._timeUntilPayday=t.readInt()}get currentHcStreak(){return this._currentHcStreak}get firstSubscriptionDate(){return this._firstSubscriptionDate}get kickbackPercentage(){return this._kickbackPercentage}get totalCreditsMissed(){return this._totalCreditsMissed}get totalCreditsRewarded(){return this._totalCreditsRewarded}get totalCreditsSpent(){return this._totalCreditsSpent}get creditRewardForStreakBonus(){return this._creditRewardForStreakBonus}get creditRewardForMonthlySpent(){return this._creditRewardForMonthlySpent}get timeUntilPayday(){return this._timeUntilPayday}}class tA{flush(){return this._data=null,!0}parse(t){return this._data=new $O(t),!0}get data(){return this._data}}class eA{flush(){return this._looks=new Map,!0}parse(t){if(!t)return!1;t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString(),r=t.readString();this._looks.set(s,[i,r]),e--}return!0}get looks(){return this._looks}}class sA{flush(){return this._result=-1,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class iA{flush(){return this._isVip=!1,this._rooms=[],!0}parse(t){if(!t)return!1;this._isVip=t.readBoolean();let e=t.readInt();for(;e>0;)this._rooms.push(new ZO(t.readInt(),t.readString(),t.readBoolean())),e--;return!0}get isVip(){return this._isVip}get rooms(){return this._rooms}}class rA{flush(){return this._pageId=-1,this._data=null,!0}parse(t){return t?(this._pageId=t.readInt(),this._data=new xa(t),!0):!1}get pageId(){return this._pageId}get data(){return this._data}}class nA{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._type=-1,this._breedId=-1,this._paletteId=-1,this._sellable=!1,this._rare=!1,!0}parse(t){return t?(this._type=t.readInt(),this._breedId=t.readInt(),this._paletteId=t.readInt(),this._sellable=t.readBoolean(),this._rare=t.readBoolean(),!0):!1}get type(){return this._type}get breedId(){return this._breedId}get paletteId(){return this._paletteId}get sellable(){return this._sellable}get rare(){return this._rare}}class aA{flush(){return this._productCode="",this._palettes=[],!0}parse(t){if(!t)return!1;this._productCode=t.readString();let e=t.readInt();for(;e>0;)this._palettes.push(new nA(t)),e--;return!0}get productCode(){return this._productCode}get palettes(){return this._palettes}}class oA{constructor(t){this._trackingState=t.readInt(),this._id=t.readInt(),this._identifier=t.readString(),this._productCode=t.readString(),this._priceInCredits=t.readInt(),this._priceInActivityPoints=t.readInt(),this._activityPointType=t.readInt(),this._purchaseLimit=t.readInt();const e=t.readInt();this._expirationTime=e>0?e*1e3+Date.now():0,this._title=t.readString(),this._description=t.readString(),this._imageUrl=t.readString(),this._iconImageUrl=t.readString(),this._type=t.readInt(),this._subProductCodes=[];let s=t.readInt();for(;s>0;)this._subProductCodes.push(t.readString()),s--;return this}populate(t){t&&(this._id=t.id,this._identifier=t.identifier,this._type=t.type,this._title=t.title,this._description=t.description,this._imageUrl=t.imageUrl,this._iconImageUrl=t.iconImageUrl,this._productCode=t.productCode,this._purchaseLimit=t.purchaseLimit,this._expirationTime=t.expirationTime,this._priceInCredits=t.priceInCredits,this._priceInActivityPoints=t.priceInActivityPoints,this._activityPointType=t.activityPointType,this._subProductCodes=t.subProductCodes,this._trackingState=t.trackingState)}purchase(t){this._purchaseLimit=this._purchaseLimit-t}get id(){return this._id}get identifier(){return this._identifier}get type(){return this._type}get title(){return this._title}get description(){return this._description}get imageUrl(){return this._imageUrl}get iconImageUrl(){return this._iconImageUrl}get productCode(){return this._productCode}get purchaseLimit(){return this._purchaseLimit}get expirationTime(){return this._expirationTime}get priceInCredits(){return this._priceInCredits}get priceInActivityPoints(){return this._priceInActivityPoints}get activityPointType(){return this._activityPointType}get subProductCodes(){return this._subProductCodes}get trackingState(){return this._trackingState}}class _A{flush(){return!0}parse(t){return!!t}}class hA{flush(){return this._data=null,!0}parse(t){return t?(this._data=new oA(t),!0):!1}get data(){return this._data}}class uA{constructor(){this._errorCode=""}flush(){return this._errorCode="",!0}parse(t){return t?(this._errorCode=t.readString(),!0):!1}get errorCode(){return this._errorCode}}class lA{constructor(){this._productName="",this._productDescription=""}flush(){return this._productDescription="",this._productName="",!0}parse(t){return t?(this._productDescription=t.readString(),this._productName=t.readString(),!0):!1}get productName(){return this._productName}get productDescription(){return this._productDescription}}class cA{flush(){return!0}parse(t){return!!t}}class ai{flush(){return this._goalId=0,this._goalCode=null,this._result=0,this._requiredFurnis=null,this._missingFurnis=null,!0}parse(t){this._goalId=t.readInt(),this._goalCode=t.readString(),this._result=t.readInt(),this._requiredFurnis=[];let e=t.readInt();for(;e>0;)this._requiredFurnis.push(t.readString()),e--;for(e=t.readInt();e>0;)this._missingFurnis[t.readString()]="",e--;return!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get result(){return this._result}get requiredFurnis(){return this._requiredFurnis}isMissing(t){return!!this._missingFurnis[t]}}ai.SUBMITTED=0;ai.ASK_FOR_SUBMIT=1;ai.ASK_FOR_CONFIRM=2;ai.PREREQUISITES_NOT_MET=3;ai.ROOM_DOOR_NOT_OPEN=4;ai.ROOM_TOO_OLD=5;ai.ASK_FOR_ACCEPT_RULES=6;class ja{}ja.ALLOWED=0;ja.REQUIRED_PERK_MISSING=1;ja.REQUIRED_BADGE_MISSING=2;class dA{flush(){return this._goalId=0,this._goalCode=null,this._resultCode=0,this._votesRemaining=0,!0}parse(t){return this._goalId=t.readInt(),this._goalCode=t.readString(),this._resultCode=t.readInt(),this._votesRemaining=t.readInt(),!0}get goalId(){return this._goalId}get goalCode(){return this._goalCode}get isVotingAllowedForUser(){return this._resultCode===ja.ALLOWED}get votesRemaining(){return this._votesRemaining}get resultCode(){return this._resultCode}}class gA{flush(){return this._schedulingStr=null,this._code=null,!0}parse(t){return this._schedulingStr=t.readString(),this._code=t.readString(),!0}get schedulingStr(){return this._schedulingStr}get code(){return this._code}}class EA{flush(){return this._isPartOf=!1,this._targetId=0,!0}parse(t){return this._isPartOf=t.readBoolean(),this._targetId=t.readInt(),!0}get isPartOf(){return this._isPartOf}get targetId(){return this._targetId}}class fA{flush(){return!0}parse(t){return!0}}class mA{flush(){return this._timeStr=null,this._secondsUntil=0,!0}parse(t){return this._timeStr=t.readString(),this._secondsUntil=t.readInt(),!0}get timeStr(){return this._timeStr}get secondsUntil(){return this._secondsUntil}}class Wc{constructor(t){this._recipeName=t.readString(),this._itemName=t.readString()}get recipeName(){return this._recipeName}get itemName(){return this._itemName}}class IA{constructor(){this._recipes=[],this._ingredients=[]}flush(){return this._recipes=[],this._ingredients=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let i=0;i<e;i++)this._recipes.push(new Wc(t));const s=t.readInt();for(let i=0;i<s;i++)this._ingredients.push(t.readString());return!0}get recipes(){return this._recipes}get ingredients(){return this._ingredients}isActive(){return this._recipes.length>0||this._ingredients.length>0}}class RA{constructor(t){this._count=t.readInt(),this._itemName=t.readString()}get count(){return this._count}get itemName(){return this._itemName}}class TA{constructor(){this._ingredients=[]}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._ingredients.push(new RA(t));return!0}flush(){return this._ingredients=[],!0}get ingredients(){return this._ingredients}}class pA{parse(t){return t?(this._count=t.readInt(),this._hasRecipes=t.readBoolean(),!0):!1}flush(){return this._count=0,this._hasRecipes=!1,!0}get count(){return this._count}get hasRecipes(){return this._hasRecipes}}class OA{parse(t){return t?(this._success=t.readBoolean(),this._success&&(this._result=new Wc(t)),!0):!1}flush(){return this._success=!1,!0}get success(){return this._success}get result(){return this._result}}class AA{flush(){return!0}parse(t){return!!t}}class SA{constructor(t){if(!t)throw new Error("invalid_wrapper");this._senderId=t.readInt(),this._errorCode=t.readInt()}get senderId(){return this._senderId}get errorCode(){return this._errorCode}}class MA{flush(){return this._failuers=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._failuers.push(new SA(t)),e--;return!0}get failures(){return this._failuers}}class CA{flush(){return this._success=!1,!0}parse(t){return t?(this._success=t.readBoolean(),!0):!1}get success(){return this._success}}class NA{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class kc{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString()}get id(){return this._id}get name(){return this._name}}class t_{constructor(t){if(!t)throw new Error("invalid_wrapper");this._id=t.readInt(),this._name=t.readString(),this._gender=t.readInt(),this._online=t.readBoolean(),this._followingAllowed=t.readBoolean(),this._figure=t.readString(),this._categoryId=t.readInt(),this._motto=t.readString(),this._realName=t.readString(),this._lastAccess=t.readString(),this._persistedMessageUser=t.readBoolean(),this._vipMember=t.readBoolean(),this._pocketHabboUser=t.readBoolean(),this._relationshipStatus=t.readShort()}get id(){return this._id}get name(){return this._name}get gender(){return this._gender}get online(){return this._online}get followingAllowed(){return this._followingAllowed}get figure(){return this._figure}get categoryId(){return this._categoryId}get motto(){return this._motto}get lastAccess(){return this._lastAccess}get realName(){return this._realName}get persistedMessageUser(){return this._persistedMessageUser}get vipMember(){return this._vipMember}get pocketHabboUser(){return this._pocketHabboUser}get relationshipStatus(){return this._relationshipStatus}}class DA{flush(){return this._totalFragments=0,this._fragmentNumber=0,this._fragment=[],!0}parse(t){if(!t)return!1;this._totalFragments=t.readInt(),this._fragmentNumber=t.readInt();let e=t.readInt();for(;e>0;)this._fragment.push(new t_(t)),e--;return!0}get totalFragments(){return this._totalFragments}get fragmentNumber(){return this._fragmentNumber}get fragment(){return this._fragment}}class PA{flush(){return this._categories=[],this._removedFriendIds=[],this._addedFriends=[],this._updatedFriends=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new kc(t)),e--;let s=t.readInt();for(;s>0;){const i=t.readInt();i===-1?this._removedFriendIds.push(t.readInt()):i===0?this._updatedFriends.push(new t_(t)):i===1&&this._addedFriends.push(new t_(t)),s--}return!0}get categories(){return this._categories}get removedFriendIds(){return this._removedFriendIds}get addedFriends(){return this._addedFriends}get updatedFriends(){return this._updatedFriends}}class yA{flush(){return this._typeCode=-1,this._avatarId=0,this._message=null,!0}parse(t){return t?(this._typeCode=t.readInt(),this._avatarId=t.readInt(),this._message=t.readString(),!0):!1}get typeCode(){return this._typeCode}get avatarId(){return this._avatarId}get message(){return this._message}}class Kc{constructor(t){if(!t)throw new Error("invalid_wrapper");this._requestId=t.readInt(),this._requesterName=t.readString(),this._figureString=t.readString(),this._requesterUserId=this._requestId}get requestId(){return this._requestId}get requesterName(){return this._requesterName}get requesterUserId(){return this._requesterUserId}get figureString(){return this._figureString}}class LA{flush(){return this._totalRequests=0,this._requests=[],!0}parse(t){if(!t)return!1;this._totalRequests=t.readInt();let e=t.readInt();for(;e>0;)this._requests.push(new Kc(t)),e--;return!0}get totalRequests(){return this._totalRequests}get requests(){return this._requests}}class Cu{constructor(t){if(!t)throw new Error("invalid_wrapper");this._avatarId=t.readInt(),this._avatarName=t.readString(),this._avatarMotto=t.readString(),this._isAvatarOnline=t.readBoolean(),this._canFollow=t.readBoolean(),this._lastOnlineData=t.readString(),this._avatarGender=t.readInt(),this._avatarFigure=t.readString(),this._realName=t.readString()}get avatarId(){return this._avatarId}get avatarName(){return this._avatarName}get avatarMotto(){return this._avatarMotto}get isAvatarOnline(){return this._isAvatarOnline}get canFollow(){return this._canFollow}get avatarGender(){return this._avatarGender}get avatarFigure(){return this._avatarFigure}get lastOnlineData(){return this._lastOnlineData}get realName(){return this._realName}}class UA{flush(){return this._friends=[],this._others=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._friends.push(new Cu(t)),e--;let s=t.readInt();for(;s>0;)this._others.push(new Cu(t)),s--;return!0}get friends(){return this._friends}get others(){return this._others}}class vA{flush(){return this._errorCode=0,this._userId=0,this._message=null,!0}parse(t){return t?(this._errorCode=t.readInt(),this._userId=t.readInt(),this._message=t.readString(),!0):!1}get errorCode(){return this._errorCode}get userId(){return this._userId}get message(){return this._message}}class bA{flush(){return this._clientMessageId=0,this._errorCode=0,!0}parse(t){return t?(this._clientMessageId=t.readInt(),this._errorCode=t.readInt(),!0):!1}get clientMessageId(){return this._clientMessageId}get errorCode(){return this._errorCode}}class FA{flush(){return this._userFriendLimit=0,this._normalFriendLimit=0,this._extendedFriendLimit=0,this._categories=[],!0}parse(t){if(!t)return!1;this._userFriendLimit=t.readInt(),this._normalFriendLimit=t.readInt(),this._extendedFriendLimit=t.readInt();let e=t.readInt();for(;e>0;)this._categories.push(new kc(t)),e--;return!0}get userFriendLimit(){return this._userFriendLimit}get normalFriendLimit(){return this._normalFriendLimit}get extendedFriendLimit(){return this._extendedFriendLimit}get categories(){return this._categories}}class xA{flush(){return!0}parse(t){return!!t}}class GA{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class BA{flush(){return this._senderId=0,this._messageText=null,this._secondsSinceSent=0,this._extraData=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),this._secondsSinceSent=t.readInt(),t.bytesAvailable&&(this._extraData=t.readString()),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}get secondsSinceSent(){return this._secondsSinceSent}get extraData(){return this._extraData}}class wA{flush(){return this._request=null,!0}parse(t){return t?(this._request=new Kc(t),!0):!1}get request(){return this._request}}class HA{flush(){return this._errorCode=0,this._failedRecipients=[],!0}parse(t){if(!t)return!1;this._errorCode=t.readInt();let e=t.readInt();for(;e>0;)this._failedRecipients.push(t.readInt()),e--;return!0}get errorCode(){return this._errorCode}get failedRecipients(){return this._failedRecipients}}class VA{flush(){return this._senderId=0,this._messageText=null,!0}parse(t){return t?(this._senderId=t.readInt(),this._messageText=t.readString(),!0):!1}get senderId(){return this._senderId}get messageText(){return this._messageText}}class jA{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._freeGamesLeft=t.readInt(),this._gamesPlayedTotal=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get freeGamesLeft(){return this._freeGamesLeft}get gamesPlayedTotal(){return this._gamesPlayedTotal}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}class _n{flush(){return this._status=-1,this._blockLength=-1,this._gamesPlayed=-1,this._freeGamesLeft=-1,!0}parse(t){return t?(this._status=t.readInt(),this._blockLength=t.readInt(),this._gamesPlayed=t.readInt(),this._freeGamesLeft=t.readInt(),!0):!1}get status(){return this._status}get blockLength(){return this._blockLength}get gamesPlayed(){return this._gamesPlayed}get freeGamesLeft(){return this._freeGamesLeft}get hasUnlimitedGames(){return this._freeGamesLeft==-1}}_n.STATUS_OK=0;_n.STATUS_FAILED_REASON_UNKNOWN=1;_n.STATUS_FAILED_REASON_GAME_DIRECTORY_IS_NOT_AVAILABLE=2;_n.STATUS_FAILED_REASON_HOTEL_IS_CLOSED=3;class zA{flush(){return this._position=-1,!0}parse(t){return t?(this._position=t.readInt(),!0):!1}get position(){return this._position}}class Gs{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}Gs.KICKED=1;Gs.DUPLICATE_MACHINEID=2;Gs.INVITATION_REQUIRED=3;Gs.NO_SPACE_IN_TEAM=4;Gs.TEAM_NOT_FOUND=5;Gs.USER_HAS_ACTIVE_INSTANCE=6;Gs.USER_HAS_PENDING_INSTANCE_REQUEST=7;Gs.USER_HAS_NO_FREE_GAMES_LEFT=8;class ph{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}ph.NOT_ENOUGH_PLAYERS=1;ph.GAME_HAS_NO_OWNER=2;class YA{flush(){return!0}parse(t){return!!t}}class WA{flush(){return this._userId=-1,!0}parse(t){return t?(this._userId=t.readInt(),!0):!1}get userId(){return this._userId}}class kA{flush(){return!0}parse(t){return t?(this._stuffCode=t.readString(),this._badgeCode=t.readString(),!0):!1}get stuffCode(){return this._stuffCode}get badgeCode(){return this._badgeCode}}class KA{flush(){return this._stuffId=-1,this._achievementId=0,this._requiredLevelBadgeCode="",this._userProgress=0,this._totalProgress=0,this._endTime=0,!0}parse(t){return t?(this._stuffId=t.readInt(),this._achievementId=t.readInt(),this._requiredLevelBadgeCode=t.readString(),this._userProgress=t.readInt(),this._totalProgress=t.readInt(),this._endTime=t.readInt(),!0):!1}get stuffId(){return this._stuffId}get achievementId(){return this._achievementId}get requiredLevelBadgeCode(){return this._requiredLevelBadgeCode}get userProgress(){return this._userProgress}get totalProgress(){return this._totalProgress}get endTime(){return this._endTime}}class XA{flush(){return!0}parse(t){if(!t)return!1;this._stuffId=t.readInt();const e=t.readInt();let s=0;for(;s<e;)this._achievements.push(new NT(t)),s++;return this._endTime=t.readInt(),!0}get stuffId(){return this._stuffId}get achievements(){return this._achievements}get endTime(){return this._endTime}}class qA{constructor(t,e,s,i){this._gameTypeId=t,this._achievementId=e,this._achievementName=s,this._levels=i}get gameTypeId(){return this._gameTypeId}get achievementId(){return this._achievementId}get achievementName(){return this._achievementName}get levels(){return this._levels}}class QA{flush(){return!0}parse(t){if(!t)return!1;this._achievements=[];const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),r=t.readInt();let a=0;for(;a<r;){const o=t.readInt(),_=t.readString(),l=t.readInt();this._achievements.push(new qA(i,o,_,l)),a++}s++}return!0}get achievements(){return this._achievements}}class JA{constructor(t,e,s,i,r,a){this._gameId=t,this._gameNameId=e,this._bgColor=s,this._textColor=i,this._assetUrl=r,this._supportUrl=a}get gameId(){return this._gameId}get gameNameId(){return this._gameNameId}get bgColor(){return this._bgColor}get textColor(){return this._textColor}get assetUrl(){return this._assetUrl}get supportUrl(){return this._supportUrl}}class ZA{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._inviterId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get inviterId(){return this._inviterId}}class $A{flush(){return!0}parse(t){if(!t)return!1;this._games=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),r=t.readString(),a=t.readString();let o=parseInt(a,16);o=o|4278190080;const _=t.readString();let l=parseInt(_,16);l=l|4278190080;const c=t.readString(),d=t.readString();this._games.push(new JA(i,r,o,l,c,d))}return!0}get games(){return this._games}}const Oh=class e_{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._status=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get isOk(){return this._status==e_.OK}get isInMaintenance(){return this._status==e_.MAINTENANCE}};Oh.OK=0;Oh.MAINTENANCE=1;let tS=Oh;class eS{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class Xc{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._reason=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}get reason(){return this._reason}}Xc.DUPLICATE_MACHINEID=1;class sS{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),!0):!1}get gameTypeId(){return this._gameTypeId}}class iS{flush(){return!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),this._quality=t.readString(),this._scaleMode=t.readString(),this._frameRate=t.readInt(),this._minMajorVersion=t.readInt(),this._minMinorVersion=t.readInt(),this._params=new Map;const e=t.readInt();let s=0;for(;s<e;)this._params.set(t.readString(),t.readString()),s++;return!0}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get quality(){return this._quality}get scaleMode(){return this._scaleMode}get frameRate(){return this._frameRate}get minMajorVersion(){return this._minMajorVersion}get minMinorVersion(){return this._minMinorVersion}get params(){return this._params}get gameClientId(){return this._gameClientId}}class rS{flush(){return this._gameTypeId=0,this._url=null,this._gameClientId=null,!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),this._url=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get url(){return this._url}get gameClientId(){return this._gameClientId}}class nS{flush(){return!0}parse(t){return t?(this._gameTypeId=t.readInt(),this._gameClientId=t.readString(),!0):!1}get gameTypeId(){return this._gameTypeId}get gameClientId(){return this._gameClientId}}class aS{flush(){return!0}parse(t){return!!t}}class za{flush(){return this._year=-1,this._week=-1,this._maxOffset=-1,this._currentOffset=-1,this._minutesUntilReset=-1,!0}parse(t){return t?(this._year=t.readInt(),this._week=t.readInt(),this._maxOffset=t.readInt(),this._currentOffset=t.readInt(),this._minutesUntilReset=t.readInt(),!0):!1}get year(){return this._year}get week(){return this._week}get maxOffset(){return this._maxOffset}get currentOffset(){return this._currentOffset}get minutesUntilReset(){return this._minutesUntilReset}}class oS{constructor(t){this._name=t.readString(),this._figure=t.readString(),this._gender=t.readString(),this._rank=t.readInt(),this._score=t.readInt()}get name(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get rank(){return this._rank}get score(){return this._score}}class _S{flush(){return this._gameTypeId=-1,this._products=[],this._minutesUntilNextWeek=0,this._rewardingOn=!0,!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let e=t.readInt();for(;e>0;)this._products.push(new Fa(t)),e--;return this._minutesUntilNextWeek=t.readInt(),this._rewardingOn=t.readBoolean(),!0}get gameTypeId(){return this._gameTypeId}get products(){return this._products}get minutesUntilNextWeek(){return this._minutesUntilNextWeek}get rewardingOn(){return this._rewardingOn}}class hS{flush(){return this._gameTypeId=-1,this._winners=[],!0}parse(t){if(!t)return!1;this._gameTypeId=t.readInt();let e=t.readInt();for(;e>0;)this._winners.push(new oS(t)),e--;return!0}get gameTypeId(){return this._gameTypeId}get winners(){return this._winners}}class uS{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class lS{flush(){return this._phoneStatusCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._phoneStatusCode=t.readInt(),this._collectionStatusCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get phoneStatusCode(){return this._phoneStatusCode}get collectionStatusCode(){return this._collectionStatusCode}get millisecondsToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class cS{flush(){return this._resultCode=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisToAllowProcessReset}}class dS{flush(){return this._resultCode=-1,this._millisecondsToAllowProcessReset=-1,!0}parse(t){return t?(this._resultCode=t.readInt(),this._millisecondsToAllowProcessReset=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get millisToAllowProcessReset(){return this._millisecondsToAllowProcessReset}}class gS{flush(){return this._bases=new Map,this._symbols=new Map,this._partColors=new Map,this._colorsA=new Map,this._colorsB=new Map,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const o=t.readInt(),_=t.readString(),l=t.readString();this._bases.set(o,[_,l]),e--}let s=t.readInt();for(;s>0;){const o=t.readInt(),_=t.readString(),l=t.readString();this._symbols.set(o,[_,l]),s--}let i=t.readInt();for(;i>0;){const o=t.readInt(),_=t.readString();this._partColors.set(o,_),i--}let r=t.readInt();for(;r>0;){const o=t.readInt(),_=t.readString();this._colorsA.set(o,_),r--}let a=t.readInt();for(;a>0;){const o=t.readInt(),_=t.readString();this._colorsB.set(o,_),a--}return!0}get bases(){return this._bases}get symbols(){return this._symbols}get partColors(){return this._partColors}get colorsA(){return this._colorsA}get colorsB(){return this._colorsB}}class ES{flush(){return this._groupCost=0,this._availableRooms=new Map,!0}parse(t){if(!t)return!1;this._groupCost=t.readInt();let e=t.readInt();for(;e>0;){const s=t.readInt(),i=t.readString();t.readBoolean(),this._availableRooms.set(s,i),e--}return!0}get groupCost(){return this._groupCost}get availableRooms(){return this._availableRooms}}class fS{flush(){return this._userId=0,this._furnitureCount=0,!0}parse(t){return t?(this._userId=t.readInt(),this._furnitureCount=t.readInt(),!0):!1}get userId(){return this._userId}get furnitureCount(){return this._furnitureCount}}class mS{flush(){return this._id=0,this._type=0,this._title=null,this._description=null,this._badge=null,this._roomId=0,this._roomName=null,this._membershipType=0,this._membersCount=0,this._isFavorite=!1,this._createdAt=null,this._isOwner=!1,this._isAdmin=!1,this._ownerName=null,this._flag=!1,this._canMembersDecorate=!1,this._pendingRequestsCount=0,!0}parse(t){return t?(this._id=t.readInt(),t.readBoolean(),this._type=t.readInt(),this._title=t.readString(),this._description=t.readString(),this._badge=t.readString(),this._roomId=t.readInt(),this._roomName=t.readString(),this._membershipType=t.readInt(),this._membersCount=t.readInt(),this._isFavorite=t.readBoolean(),this._createdAt=t.readString(),this._isOwner=t.readBoolean(),this._isAdmin=t.readBoolean(),this._ownerName=t.readString(),this._flag=t.readBoolean(),this._canMembersDecorate=t.readBoolean(),this._pendingRequestsCount=t.readInt(),!0):!1}get id(){return this._id}get type(){return this._type}get title(){return this._title}get description(){return this._description}get badge(){return this._badge}get roomId(){return this._roomId}get roomName(){return this._roomName}get membershipType(){return this._membershipType}get membersCount(){return this._membersCount}get isFavorite(){return this._isFavorite}get createdAt(){return this._createdAt}get isOwner(){return this._isOwner}get isAdmin(){return this._isAdmin}get ownerName(){return this._ownerName}get flag(){return this._flag}get canMembersDecorate(){return this._canMembersDecorate}get pendingRequestsCount(){return this._pendingRequestsCount}}class IS{constructor(t){this.isBase=t,this.key=0,this.color=0,this.position=4}get code(){return this.key===0?null:(this.isBase?"b":"s")+(this.key<100?"0":"")+(this.key<10?"0":"")+this.key+(this.color<10?"0":"")+this.color+this.position}}class hn{}hn.OWNER=0;hn.ADMIN=1;hn.MEMBER=2;hn.REQUESTED=3;hn.DELETED=4;class RS{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._rank=-1,this._id=0,this._name=null,this._figure=null,this._joinedAt=null,!0}parse(t){return t?(this._rank=t.readInt(),this._id=t.readInt(),this._name=t.readString(),this._figure=t.readString(),this._joinedAt=t.readString(),!0):!1}get id(){return this._id}get name(){return this._name}get figure(){return this._figure}get rank(){return this._rank}get joinedAt(){return this._joinedAt}}class TS{flush(){return this._groupId=0,this._groupTitle=null,this._roomId=0,this._badge=null,this._totalMembersCount=0,this._result=[],this._admin=!1,this._pageSize=0,this._pageIndex=0,this._level=0,this._query=null,!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._groupTitle=t.readString(),this._roomId=t.readInt(),this._badge=t.readString(),this._totalMembersCount=t.readInt();let e=t.readInt();for(;e>0;)this._result.push(new RS(t)),e--;return this._admin=t.readBoolean(),this._pageSize=t.readInt(),this._pageIndex=t.readInt(),this._level=t.readInt(),this._query=t.readString(),!0}get groupId(){return this._groupId}get groupTitle(){return this._groupTitle}get roomId(){return this._roomId}get badge(){return this._badge}get totalMembersCount(){return this._totalMembersCount}get result(){return this._result}get admin(){return this._admin}get pageSize(){return this._pageSize}get pageIndex(){return this._pageIndex}get level(){return this._level}get query(){return this._query}}class pS{flush(){return this._roomId=0,this._groupId=0,!0}parse(t){return t?(this._roomId=t.readInt(),this._groupId=t.readInt(),!0):!1}get roomId(){return this._roomId}get guildId(){return this._groupId}}class OS{flush(){return this._roomId=0,this._roomName=null,this._id=0,this._title=null,this._description=null,this._colorA=0,this._colorB=0,this._state=0,this._canMembersDecorate=!1,this._badgeParts=new Map,this._badgeCode=null,this._membersCount=0,!0}parse(t){if(!t)return!1;t.readInt()===1&&(this._roomId=t.readInt(),this._roomName=t.readString(),t.readBoolean()),t.readBoolean(),this._id=t.readInt(),this._title=t.readString(),this._description=t.readString(),t.readInt(),this._colorA=t.readInt(),this._colorB=t.readInt(),this._state=t.readInt(),this._canMembersDecorate=t.readInt()===0,t.readBoolean(),t.readString();const s=t.readInt();for(let i=0;i<s;i++){const r=new IS(i===0);r.key=t.readInt(),r.color=t.readInt(),r.position=t.readInt(),r.key===0&&(r.position=4),this._badgeParts.set(i,r)}return this._badgeCode=t.readString(),this._membersCount=t.readInt(),!0}get roomId(){return this._roomId}get roomName(){return this._roomName}get id(){return this._id}get title(){return this._title}get description(){return this._description}get colorA(){return this._colorA}get colorB(){return this._colorB}get state(){return this._state}get canMembersDecorate(){return this._canMembersDecorate}get badgeParts(){return this._badgeParts}get badgeCode(){return this._badgeCode}get membersCount(){return this._membersCount}}class AS{flush(){return!0}parse(t){return this._groupId=t.readInt(),!0}get groupId(){return this._groupId}}class Kr{static parse(t){return this.fillFromMessage(new Kr,t)}static fillFromMessage(t,e){return t._groupId=e.readInt(),t._name=e.readString(),t._description=e.readString(),t._icon=e.readString(),t._totalThreads=e.readInt(),t._leaderboardScore=e.readInt(),t._totalMessages=e.readInt(),t._unreadMessages=e.readInt(),t._lastMessageId=e.readInt(),t._lastMessageAuthorId=e.readInt(),t._lastMessageAuthorName=e.readString(),t._lastMessageTimeAsSecondsAgo=e.readInt(),t}get groupId(){return this._groupId}get name(){return this._name}get description(){return this._description}get icon(){return this._icon}get totalThreads(){return this._totalThreads}get leaderboardScore(){return this._leaderboardScore}get totalMessages(){return this._totalMessages}get unreadMessages(){return this._unreadMessages}get lastMessageId(){return this._lastMessageId}get lastMessageAuthorId(){return this._lastMessageAuthorId}get lastMessageAuthorName(){return this._lastMessageAuthorName}get lastMessageTimeAsSecondsAgo(){return this._lastMessageTimeAsSecondsAgo}updateFrom(t){this._totalThreads=t._totalThreads,this._totalMessages=t._totalMessages,this._unreadMessages=t._unreadMessages,this._lastMessageAuthorId=t._lastMessageAuthorId,this._lastMessageAuthorName=t._lastMessageAuthorName,this._lastMessageId=t._lastMessageId,this._lastMessageTimeAsSecondsAgo=t._lastMessageTimeAsSecondsAgo}get lastReadMessageId(){return this._totalMessages-this._unreadMessages}set lastReadMessageId(t){this._unreadMessages=this._totalMessages-t,this._unreadMessages<0&&(this._unreadMessages=0)}addNewThread(t){this._lastMessageAuthorId=t.lastUserId,this._lastMessageAuthorName=t.lastUserName,this._lastMessageId=t.lastMessageId,this._lastMessageTimeAsSecondsAgo=t.lastCommentTime,this._totalThreads++,this._totalMessages++,this._unreadMessages=0}}class Ah extends Kr{static parse(t){const e=new Ah;return Kr.fillFromMessage(e,t),e._readPermissions=t.readInt(),e._postMessagePermissions=t.readInt(),e._postThreadPermissions=t.readInt(),e._moderatePermissions=t.readInt(),e._readPermissionError=t.readString(),e._postMessagePermissionError=t.readString(),e._postThreadPermissionError=t.readString(),e._moderatePermissionError=t.readString(),e._reportPermissionError=t.readString(),e._canChangeSettings=t.readBoolean(),e._isStaff=t.readBoolean(),e}get readPermissions(){return this._readPermissions}get postMessagePermissions(){return this._postMessagePermissions}get postThreadPermissions(){return this._postThreadPermissions}get moderatePermissions(){return this._moderatePermissions}get hasReadPermissionError(){return this._readPermissionError.length===0}get canReport(){return!0}get hasPostMessagePermissionError(){return this._postMessagePermissionError.length===0}get hasPostThreadPermissionError(){return this._postThreadPermissionError.length===0}get hasModeratePermissionError(){return this._moderatePermissionError.length===0}get canChangeSettings(){return this._canChangeSettings}get isStaf(){return this._isStaff}get readPermissionError(){return this._readPermissionError}get postMessagePermissionError(){return this._postMessagePermissionError}get postThreadPermissionError(){return this._postThreadPermissionError}get moderatePermissionError(){return this._moderatePermissionError}get reportPermissionError(){return this._reportPermissionError}}class SS{flush(){return this._extendedForumData=null,!0}parse(t){return t?(this._extendedForumData=Ah.parse(t),!0):!1}get extendedForumData(){return this._extendedForumData}}class MS{flush(){return this._listCode=-1,this._totalAmount=0,this._startIndex=-1,this._amount=0,this._forums=[],!0}parse(t){if(!t)return!1;this._listCode=t.readInt(),this._totalAmount=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._forums=[];let e=0;for(;e<this._amount;)this._forums.push(Kr.parse(t)),e++;return!0}get listCode(){return this._listCode}get totalAmount(){return this._totalAmount}get startIndex(){return this._startIndex}get amount(){return this._amount}get forums(){return this._forums}}class un{static parse(t){const e=new un;return e._threadId=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._header=t.readString(),e._isPinned=t.readBoolean(),e._isLocked=t.readBoolean(),e._creationTimeAsSecondsAgo=t.readInt(),e._totalMessages=t.readInt(),e._unreadMessagesCount=t.readInt(),e._lastMessageId=t.readInt(),e._lastUserId=t.readInt(),e._lastUserName=t.readString(),e._lastCommentTime=t.readInt(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSecondsAgo=t.readInt(),e}get adminOperationTimeAsSecondsAgo(){return this._adminOperationTimeAsSecondsAgo}set adminOperationTimeAsSecondsAgo(t){this._adminOperationTimeAsSecondsAgo=t}get lastCommentTime(){return this._lastCommentTime}set lastCommentTime(t){this._lastCommentTime=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get creationTimeAsSecondsAgo(){return this._creationTimeAsSecondsAgo}set creationTimeAsSecondsAgo(t){this._creationTimeAsSecondsAgo=t}get header(){return this._header}set header(t){this._header=t}get lastMessageId(){return this._lastMessageId}set lastMessageId(t){this._lastMessageId=t}get lastUserId(){return this._lastUserId}set lastUserId(t){this._lastUserId=t}get lastUserName(){return this._lastUserName}set lastUserName(t){this._lastUserName=t}get totalMessages(){return this._totalMessages}set totalMessages(t){this._totalMessages=t}get unreadMessagesCount(){return this._unreadMessagesCount}set unreadMessagesCount(t){this._unreadMessagesCount=t}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get isPinned(){return this._isPinned}set isPinned(t){this._isPinned=t}get isLocked(){return this._isLocked}set isLocked(t){this._isLocked=t}}class CS{flush(){return this._groupId=-1,this._startIndex=-1,this._amount=0,this._threads=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._threads=[];let e=0;for(;e<this._amount;)this._threads.push(un.parse(t)),e++;return!0}get groupId(){return this._groupId}get startIndex(){return this._startIndex}get amount(){return this._amount}get threads(){return this._threads}}class ln{static parse(t){const e=new ln;return e._messageId=t.readInt(),e._messageIndex=t.readInt(),e._authorId=t.readInt(),e._authorName=t.readString(),e._authorFigure=t.readString(),e._creationTime=t.readInt(),e._messageText=t.readString(),e._state=t.readByte(),e._adminId=t.readInt(),e._adminName=t.readString(),e._adminOperationTimeAsSeccondsAgo=t.readInt(),e._authorPostCount=t.readInt(),e}get state(){return this._state}set state(t){this._state=t}get adminId(){return this._adminId}set adminId(t){this._adminId=t}get adminName(){return this._adminName}set adminName(t){this._adminName=t}get adminOperationTimeAsSeccondsAgo(){return this._adminOperationTimeAsSeccondsAgo}set adminOperationTimeAsSeccondsAgo(t){this._adminOperationTimeAsSeccondsAgo=t}get messageId(){return this._messageId}set messageId(t){this._messageId=t}get creationTime(){return this._creationTime}set creationTime(t){this._creationTime=t}get authorName(){return this._authorName}set authorName(t){this._authorName=t}get authorFigure(){return this._authorFigure}set authorFigure(t){this._authorFigure=t}get threadId(){return this._threadId}set threadId(t){this._threadId=t}get messageIndex(){return this._messageIndex}set messageIndex(t){this._messageIndex=t}set groupID(t){this._groupId=t}get groupId(){return this._groupId}get authorId(){return this._authorId}set authorId(t){this._authorId=t}get messageText(){return this._messageText}set messageText(t){this._messageText=t}get authorPostCount(){return this._authorPostCount}set authorPostCount(t){this._authorPostCount=t}}class NS{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=ln.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class DS{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=un.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class PS{flush(){return this._groupId=-1,this._threadId=-1,this._startIndex=-1,this._amount=0,this._messages=[],!0}parse(t){if(!t)return!1;this._groupId=t.readInt(),this._threadId=t.readInt(),this._startIndex=t.readInt(),this._amount=t.readInt(),this._messages=[];let e=0;for(;e<this._amount;){const s=ln.parse(t);s.groupID=this._groupId,s.threadId=this._threadId,this._messages.push(s),e++}return!0}get groupId(){return this._groupId}get threadId(){return this._threadId}get startIndex(){return this._startIndex}get amount(){return this._amount}get messages(){return this._messages}}class yS{flush(){return this._count=0,!0}parse(t){return t?(this._count=t.readInt(),!0):!1}get count(){return this._count}}class LS{flush(){return this._groupId=-1,this._threadId=-1,this._message=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._threadId=t.readInt(),this._message=ln.parse(t),!0):!1}get groupId(){return this._groupId}get threadId(){return this._threadId}get message(){return this._message}}class US{flush(){return this._groupId=-1,this._thread=null,!0}parse(t){return t?(this._groupId=t.readInt(),this._thread=un.parse(t),!0):!1}get groupId(){return this._groupId}get thread(){return this._thread}}class vS{constructor(){this._encryptedPublicKey=null,this._serverClientEncryption=!1}flush(){return!0}parse(t){return t?(this._encryptedPublicKey=t.readString(),t.bytesAvailable&&(this._serverClientEncryption=t.readBoolean()),!0):!1}get encryptedPublicKey(){return this._encryptedPublicKey}get serverClientEncryption(){return this._serverClientEncryption}}class bS{flush(){return this._reason=-1,!0}parse(t){return t?(this._reason=0,t.bytesAvailable&&(this._reason=t.readInt()),!0):!1}get reason(){return this._reason}}class FS{flush(){return this._accounts&&(this._accounts=new Map),!0}parse(t){if(!t)return!1;this._accounts=new Map;let e=t.readInt();for(;e>0;)this._accounts.set(t.readInt(),t.readString()),e--;return!0}get accounts(){return this._accounts}}class xS{flush(){return!0}parse(t){return t?(this._encryptedPrime=t.readString(),this._encryptedGenerator=t.readString(),!0):!1}get encryptedPrime(){return this._encryptedPrime}get encryptedGenerator(){return this._encryptedGenerator}}class GS{flush(){return this._noobnessLevel=0,!0}parse(t){return t?(this._noobnessLevel=t.readInt(),!0):!1}get noobnessLevel(){return this._noobnessLevel}}class BS{flush(){return!0}parse(t){return t?(this._infoUrl=t.readString(),!0):!1}get infoUrl(){return this._infoUrl}}class wS{flush(){return!0}parse(t){return!0}}class HS{flush(){return this._calls=[],!0}parse(t){this._calls=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),r=t.readString(),a=t.readString();this._calls.push({callId:i,timeStamp:r,message:a})}return!0}get pendingCalls(){return this._calls}get count(){return this._calls.length}}class VS{flush(){return this._message=null,!0}parse(t){return this._message=t.readString(),!0}get message(){return this._message}}class jS{flush(){return this._resultType=0,this._messageText=null,!0}parse(t){return t?(this._resultType=t.readInt(),this._messageText=t.readString(),!0):!1}get resultType(){return this._resultType}get messageText(){return this._messageText}}class zS{flush(){return!0}parse(t){return!0}}class YS{flush(){return this._acceptanceTimeout=-1,!0}parse(t){return this._acceptanceTimeout=t.readInt(),!0}get acceptanceTimeout(){return this._acceptanceTimeout}}class WS{flush(){return this._winningVoteCode=-1,this._ownVoteCode=-1,this._finalStatus=null,!0}parse(t){this._finalStatus=[],this._winningVoteCode=t.readInt(),this._ownVoteCode=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._finalStatus.push(t.readInt());return!0}get winningVoteCode(){return this._winningVoteCode}get ownVoteCode(){return this._ownVoteCode}get finalStatus(){return this._finalStatus}}class kS{flush(){return!0}parse(t){return this._votingTimeout=t.readInt(),this._chatRecord=t.readString(),!0}get votingTimeout(){return this._votingTimeout}get chatRecord(){return this._chatRecord}}class Pi{flush(){return this._status=null,!0}parse(t){this._status=[];const e=t.readInt();for(let s=0;s<e;s++)this._status.push(t.readInt());return!0}get status(){return this._status}}Pi.AWAITING_VOTE=0;Pi.VOTED_OK=1;Pi.VOTED_BAD=2;Pi.VOTED_VERY_BAD=3;Pi.NO_VOTE=4;Pi.FINDING_NEW_VOTER=5;class KS{flush(){return this._onDuty=!1,this._guidesOnDuty=0,this._helpersOnDuty=0,this._guardiansOnDuty=0,!0}parse(t){return t?(this._onDuty=t.readBoolean(),this._guidesOnDuty=t.readInt(),this._helpersOnDuty=t.readInt(),this._guardiansOnDuty=t.readInt(),!0):!1}get onDuty(){return this._onDuty}get guidesOnDuty(){return this._guidesOnDuty}get helpersOnDuty(){return this._helpersOnDuty}get guardiansOnDuty(){return this._guardiansOnDuty}}class XS{constructor(t,e,s,i,r,a,o){this._type=t,this._secondsAgo=e,this._isGuide=s,this._otherPartyName=i,this._otherPartyFigure=r,this._description=a,this._roomName=o}get type(){return this._type}set type(t){this._type=t}get secondsAgo(){return this._secondsAgo}set secondsAgo(t){this._secondsAgo=t}get isGuide(){return this._isGuide}set isGuide(t){this._isGuide=t}get otherPartyName(){return this._otherPartyName}set otherPartyName(t){this._otherPartyName=t}get otherPartyFigure(){return this._otherPartyFigure}set otherPartyFigure(t){this._otherPartyFigure=t}get description(){return this._description}set description(t){this._description=t}get roomName(){return this._roomName}set roomName(t){this._roomName=t}}class cn{flush(){return this._statusCode=0,this._pendingTicket=null,!0}parse(t){return t?(this._statusCode=t.readInt(),this._pendingTicket=new XS(t.readInt(),t.readInt(),t.readBoolean(),t.readString(),t.readString(),t.readString(),t.readString()),!0):!1}get statusCode(){return this._statusCode}get pendingTicket(){return this._pendingTicket}}cn.GUIDE_REPORTING_STATUS_OK=0;cn.GUIDE_REPORTING_STATUS_PENDING_TICKET=1;cn.GUIDE_REPORTING_STATUS_ABUSIVE=2;cn.GUIDE_REPORTING_STATUS_REPORTING_TOO_QUICKLY=3;class qS{flush(){return this._asGuide=!1,this._helpRequestType=0,this._helpRequestDescription=null,this._roleSpecificWaitTime=0,!0}parse(t){return t?(this._asGuide=t.readBoolean(),this._helpRequestType=t.readInt(),this._helpRequestDescription=t.readString(),this._roleSpecificWaitTime=t.readInt(),!0):!1}get asGuide(){return this._asGuide}get helpRequestType(){return this._helpRequestType}get helpRequestDescription(){return this._helpRequestDescription}get roleSpecificWaitTime(){return this._roleSpecificWaitTime}}class QS{flush(){return!0}parse(t){return!!t}}class JS{flush(){return this._endReason=0,!0}parse(t){return t?(this._endReason=t.readInt(),!0):!1}get endReason(){return this._endReason}}class hr{flush(){return this._errorCode=0,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}hr.ERROR_GENERIC=0;hr.ERROR_GUIDES_REJECT=1;hr.ERROR_NOT_ENOUGH_GUIDES=2;hr.ERROR_NOT_ENOUGH_VOTES=3;hr.ERROR_NO_CHATLOG_FOUND=4;class ZS{flush(){return this._roomId=0,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class $S{flush(){return this._chatMessage=null,this._senderId=0,!0}parse(t){return t?(this._chatMessage=t.readString(),this._senderId=t.readInt(),!0):!1}get chatMessage(){return this._chatMessage}get senderId(){return this._senderId}}class tM{flush(){return this._isTyping=!1,!0}parse(t){return t?(this._isTyping=t.readBoolean(),!0):!1}get isTyping(){return this._isTyping}}class eM{flush(){return this._requesterRoomId=0,!0}parse(t){return t?(this._requesterRoomId=t.readInt(),!0):!1}get requesterRoomId(){return this._requesterRoomId}}class sM{flush(){return this._requesterUserId=0,this._requesterName=null,this._requesterFigure=null,this._guideUserId=0,this._guideName=null,this._guideFigure=null,!0}parse(t){return t?(this._requesterUserId=t.readInt(),this._requesterName=t.readString(),this._requesterFigure=t.readString(),this._guideUserId=t.readInt(),this._guideName=t.readString(),this._guideFigure=t.readString(),!0):!1}get requesterUserId(){return this._requesterUserId}get requesterName(){return this._requesterName}get requesterFigure(){return this._requesterFigure}get guideUserId(){return this._guideUserId}get guideName(){return this._guideName}get guideFigure(){return this._guideFigure}}class dn{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}dn.CREATION_RESULT_OK=0;dn.CREATION_RESULT_UNABLE_TO_REPORT=1;dn.CREATION_RESULT_NO_CHATLOG_FOUND=2;dn.CREATION_RESULT_BULLY_ALREADY_REPORTED=3;class Ya{flush(){return this._resolution=0,!0}parse(t){return t?(this._resolution=t.readInt(),!0):!1}get resolution(){return this._resolution}}Ya.RESOLUTION_GUARDIANS_TOOK_ACTION=0;Ya.RESOLUTION_FORWARDED_TO_MODERATORS=1;Ya.RESOLUTION_REPORTER_IS_ABUSIVE=2;class iM{flush(){return!0}parse(t){return!!t}}class rM{flush(){return this._closeReason=0,this._messageText="",!0}parse(t){return t?(this._closeReason=t.readInt(),this._messageText=t.readString(),!0):!1}get closeReason(){return this._closeReason}get messageText(){return this._messageText}}class nM{flush(){return this._quizCode=null,this._questionIds=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIds=[];for(let s=0;s<e;s++)this._questionIds.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIds(){return this._questionIds}}class aM{flush(){return this._quizCode=null,this._questionIdsForWrongAnswers=[],!0}parse(t){if(!t)return!1;this._quizCode=t.readString();const e=t.readInt();this._questionIdsForWrongAnswers=[];for(let s=0;s<e;s++)this._questionIdsForWrongAnswers.push(t.readInt());return!0}get quizCode(){return this._quizCode}get questionIdsForWrongAnswers(){return this._questionIdsForWrongAnswers}}class Wa{constructor(t){this._id=t.readInt(),this._title=t.readString(),this._bodyText=t.readString(),this._buttonText=t.readString(),this._linkType=t.readInt(),this._linkContent=t.readString(),this._imageUrl=t.readString()}get id(){return this._id}get title(){return this._title}get bodyText(){return this._bodyText}get buttonText(){return this._buttonText}get linkType(){return this._linkType}get linkContent(){return this._linkContent}get imageUrl(){return this._imageUrl}}Wa.LINK_TYPE_URL=0;Wa.LINK_TYPE_INTERNAL=1;Wa.LINK_TYPE_NO_LINK=2;class oM{flush(){return this._articles=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._articles.push(new Wa(t));return!0}get articles(){return this._articles}}class _M{flush(){return!0}parse(t){return t?(this._acknowledged=t.readBoolean(),!0):!1}get acknowledged(){return this._acknowledged}}class hM{flush(){return this._newOfferId=-1,this._newPrice=0,this._requestedOfferId=-1,!0}parse(t){return t?(this._result=t.readInt(),this._newOfferId=t.readInt(),this._newPrice=t.readInt(),this._requestedOfferId=t.readInt(),!0):!1}get result(){return this._result}get offerId(){return this._newOfferId}get newPrice(){return this._newPrice}get requestedOfferId(){return this._requestedOfferId}}class uM{flush(){return this._offerId=0,this._success=!1,!0}parse(t){return t?(this._offerId=t.readInt(),this._success=t.readBoolean(),!0):!1}get offerId(){return this._offerId}get success(){return this._success}}class lM{flush(){return this._tokenCount=0,this._result=0,!0}parse(t){return t?(this._result=t.readInt(),this._tokenCount=t.readInt(),!0):!1}get tokenCount(){return this._tokenCount}get resultCode(){return this._result}}class cM{flush(){return this._enabled=!1,this._commission=0,this._credits=0,this._advertisements=0,this._maximumPrice=0,this._minimumPrice=0,this._offerTime=0,this._displayTime=0,!0}parse(t){return t?(this._enabled=t.readBoolean(),this._commission=t.readInt(),this._credits=t.readInt(),this._advertisements=t.readInt(),this._minimumPrice=t.readInt(),this._maximumPrice=t.readInt(),this._offerTime=t.readInt(),this._displayTime=t.readInt(),!0):!1}get enabled(){return this._enabled}get commission(){return this._commission}get credits(){return this._credits}get advertisements(){return this._advertisements}get minimumPrice(){return this._minimumPrice}get maximumPrice(){return this._maximumPrice}get offerTime(){return this._offerTime}get displayTime(){return this._displayTime}}class dM{flush(){return this._result=0,!0}parse(t){return t?(this._result=t.readInt(),!0):!1}get result(){return this._result}}class gM{flush(){return this._averagePrice=0,this._currentOfferCount=0,this._historyLength=0,this._dayOffsets=[],this._averagePrices=[],this._soldAmounts=[],this._furniTypeId=0,this._furniCategoryId=0,!0}parse(t){if(!t)return!1;this._averagePrice=t.readInt(),this._currentOfferCount=t.readInt(),this._historyLength=t.readInt();let e=t.readInt();for(;e>0;)this._dayOffsets.push(t.readInt()),this._averagePrices.push(t.readInt()),this._soldAmounts.push(t.readInt()),e--;return this._furniCategoryId=t.readInt(),this._furniTypeId=t.readInt(),!0}get averagePrice(){return this._averagePrice}get offerCount(){return this._currentOfferCount}get historyLength(){return this._historyLength}get dayOffsets(){return this._dayOffsets}get averagePrices(){return this._averagePrices}get soldAmounts(){return this._soldAmounts}get furniTypeId(){return this._furniTypeId}get furniCategoryId(){return this._furniCategoryId}}class qc{constructor(t,e,s,i,r,a,o,_,l,c=-1){this._timeLeftMinutes=-1,this._offerId=t,this._furniId=e,this._furniType=s,this._extraData=i,this._stuffData=r,this._price=a,this._status=o,this._timeLeftMinutes=_,this._averagePrice=l,this._offerCount=c}get offerId(){return this._offerId}get furniId(){return this._furniId}get furniType(){return this._furniType}get extraData(){return this._extraData}get stuffData(){return this._stuffData}get price(){return this._price}get status(){return this._status}get timeLeftMinutes(){return this._timeLeftMinutes}get averagePrice(){return this._averagePrice}get offerCount(){return this._offerCount}get isUniqueLimitedItem(){return this.stuffData!=null&&this.stuffData.uniqueSeries>0}}const ka=class Dr{constructor(){this.MAX_LIST_LENGTH=500}flush(){return this._offers=[],this._totalItemsFound=0,!0}parse(t){if(!t)return!1;const e=t.readInt();let s=0;for(;s<e;){const i=t.readInt(),r=t.readInt();let a=t.readInt(),o=-1,_="",l=null;a===Dr.FURNITYPE_STUFF?(o=t.readInt(),l=ni.parseObjectData(t)):a===Dr.FURNITYPE_WALL?(o=t.readInt(),_=t.readString()):a==Dr.FAKE_FURNITYPE_UNIQUE&&(o=t.readInt(),l=$s.getData(Re.FORMAT_KEY),l.uniqueNumber=t.readInt(),l.uniqueSeries=t.readInt(),a=Dr.FURNITYPE_STUFF);const c=t.readInt(),d=t.readInt(),E=t.readInt(),I=t.readInt(),m=new qc(i,o,a,_,l,c,r,d,E,I);s<this.MAX_LIST_LENGTH&&this._offers.push(m),s++}return this._totalItemsFound=t.readInt(),!0}get offers(){return this._offers}get totalItemsFound(){return this._totalItemsFound}};ka.FURNITYPE_STUFF=1;ka.FURNITYPE_WALL=2;ka.FAKE_FURNITYPE_UNIQUE=3;let EM=ka;const Qc=class Jc{flush(){return this._offers=[],!0}parse(t){if(!t)return!1;this._offers=[],this._creditsWaiting=t.readInt();const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),r=t.readInt();let a=t.readInt(),o,_,l;a==1?(o=t.readInt(),l=this.getStuffData(t)):a==2?(o=t.readInt(),_=t.readString()):a==3&&(o=t.readInt(),l=$s.getData(Re.FORMAT_KEY),l.uniqueNumber=t.readInt(),l.uniqueSeries=t.readInt(),a=1);const c=t.readInt(),d=t.readInt(),E=t.readInt(),I=new qc(i,o,a,_,l,c,r,d,E);s<Jc.MAX_LIST_LENGTH&&this._offers.push(I)}return!0}get offers(){return this._offers}get creditsWaiting(){return this._creditsWaiting}getStuffData(t){const e=t.readInt(),s=$s.getData(e);return s.parseWrapper(t),s}};Qc.MAX_LIST_LENGTH=500;let fM=Qc;class mM{constructor(t,e,s,i,r){this._timestamp=t,this._habboId=e,this._username=s,this._message=i,this._hasHighlighting=r}get timestamp(){return this._timestamp}get userId(){return this._habboId}get userName(){return this._username}get message(){return this._message}get hasHighlighting(){return this._hasHighlighting}}class os{constructor(t){this._context=new Map,this._chatlog=[],this._recordType=t.readByte();const e=t.readShort();for(let i=0;i<e;i++){const r=t.readString(),a=t.readByte();switch(a){case 0:this._context.set(r,t.readBoolean());break;case 1:this._context.set(r,t.readInt());break;case 2:this._context.set(r,t.readString());break;default:throw new Error("Unknown data type "+a)}}const s=t.readShort();for(let i=0;i<s;i++){const r=t.readString(),a=t.readInt(),o=t.readString(),_=t.readString(),l=t.readBoolean();this._chatlog.push(new mM(r,a,o,_,l))}}get recordType(){return this._recordType}get context(){return this._context}get chatlog(){return this._chatlog}get roomId(){return this.getInt("roomId")}get roomName(){return this._context.get("roomName")}get groupId(){return this.getInt("groupId")}get threadId(){return this.getInt("threadId")}get messageId(){return this.getInt("messageId")}getInt(t){const e=this._context.get(t);return e||0}}os.TYPE_SIMPLE=0;os.TYPE_ROOM_CHAT=1;os.TYPE_IM_SESSION=2;os.TYPE_DISCUSSION_THREAD=3;os.TYPE_DISCUSSION_MESSAGE=4;os.TYPE_SELFIE=5;os.TYPE_PHOTO=6;class IM{constructor(t){this._issueId=t.readInt(),this._callerUserId=t.readInt(),this._reportedUserId=t.readInt(),this._chatRecordId=t.readInt(),this._chatRecord=new os(t)}get issueId(){return this._issueId}get callerUserId(){return this._callerUserId}get reportedUserId(){return this._reportedUserId}get chatRecordId(){return this._chatRecordId}get chatRecord(){return this._chatRecord}}class RM{flush(){return this._data=null,!0}parse(t){return t?(this._data=new IM(t),!0):!1}get data(){return this._data}}class TM{flush(){return!0}parse(t){return this._issueId=parseInt(t.readString()),!0}get issueId(){return this._issueId}}class gn{constructor(t,e,s,i,r,a,o,_,l,c,d,E,I,m,T,p){this._disposed=!1,this._issueId=t,this._state=e,this._categoryId=s,this._reportedCategoryId=i,this._issueAgeInMilliseconds=r,this._priority=a,this._groupingId=o,this._reporterUserId=_,this._reporterUserName=l,this._reportedUserId=c,this._reportedUserName=d,this._pickerUserId=E,this._pickerUserName=I,this._message=m,this._chatRecordId=T,this._patterns=p,this._creationTimeInMilliseconds=$()}get issueId(){return this._issueId}get state(){return this._state}get categoryId(){return this._categoryId}get reportedCategoryId(){return this._reportedCategoryId}get issueAgeInMilliseconds(){return this._issueAgeInMilliseconds}get priority(){return this._priority}get groupingId(){return this._groupingId}get reporterUserId(){return this._reporterUserId}get reporterUserName(){return this._reporterUserName}get reportedUserId(){return this._reportedUserId}get reportedUserName(){return this._reportedUserName}get pickerUserId(){return this._pickerUserId}get pickerUserName(){return this._pickerUserName}get message(){return this._message}get chatRecordId(){return this._chatRecordId}get patterns(){return this._patterns}dispose(){if(!this.disposed){for(const t of this._patterns)t.dispose();this._patterns=[],this._disposed=!0}}get disposed(){return this._disposed}getOpenTime(t){const s=(this._issueAgeInMilliseconds+t-this._creationTimeInMilliseconds)/1e3/60,i=s%60,r=s/60,a=(i<10?"0":"")+i;return(r<10?"0":"")+r+":"+a}}gn.STATE_OPEN=1;gn.STATE_PICKED=2;gn.STATE_CLOSED=3;class pM{constructor(t){this._disposed=!1,this._pattern=t.readString(),this._startIndex=t.readInt(),this._endIndex=t.readInt()}dispose(){this._disposed=!0,this._pattern="",this._startIndex=-1,this._endIndex=-1}get disposed(){return this._disposed}get pattern(){return this._pattern}get startIndex(){return this._startIndex}get endIndex(){return this._endIndex}}class Zc{get issueData(){return this._issueData}flush(){return this._issueData=null,!0}parse(t){const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=t.readInt(),a=t.readInt(),o=t.readInt(),_=t.readInt(),l=t.readInt(),c=t.readString(),d=t.readInt(),E=t.readString(),I=t.readInt(),m=t.readString(),T=t.readString(),p=t.readInt(),A=t.readInt(),N=[];for(let C=0;C<A;C++)N.push(new pM(t));return this._issueData=new gn(e,s,i,r,a,o,_,l,c,d,E,I,m,T,p,N),!0}}class OM{flush(){return this._issues=null,!0}parse(t){this._issues=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),r=t.readInt(),a=t.readString(),o=new gn(i,0,0,0,0,0,0,0,null,0,null,r,a,null,0,[]);this._issues.push(o)}return this._retryEnabled=t.readBoolean(),this._retryCount=t.readInt(),!0}get issues(){return this._issues}get retryEnabled(){return this._retryEnabled}get retryCount(){return this._retryCount}}class AM{flush(){return this._message="",this._url=null,!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class SM{flush(){return this._userId=-1,this._success=!1,!0}parse(t){return this._userId=t.readInt(),this._success=t.readBoolean(),!0}get userId(){return this._userId}get success(){return this._success}}class MM{constructor(t){this._disposed=!1;const e=new Zc;this._issues=[],this._messageTemplates=[],this._roomMessageTemplates=[];let s=t.readInt(),i=0;for(;i<s;)e.parse(t)&&this._issues.push(e.issueData),i++;for(s=t.readInt(),i=0;i<s;)this._messageTemplates.push(t.readString()),i++;for(s=t.readInt(),i=0;i<s;)t.readString(),i++;for(this._cfhPermission=t.readBoolean(),this._chatlogsPermission=t.readBoolean(),this._alertPermission=t.readBoolean(),this._kickPermission=t.readBoolean(),this._banPermission=t.readBoolean(),this._roomAlertPermission=t.readBoolean(),this._roomKickPermission=t.readBoolean(),s=t.readInt(),i=0;i<s;)this._roomMessageTemplates.push(t.readString()),i++}dispose(){this._disposed||(this._disposed=!0,this._messageTemplates=null,this._roomMessageTemplates=null,this._issues=null)}get disposed(){return this._disposed}get messageTemplates(){return this._messageTemplates}get roomMessageTemplates(){return this._roomMessageTemplates}get issues(){return this._issues}get cfhPermission(){return this._cfhPermission}get chatlogsPermission(){return this._chatlogsPermission}get alertPermission(){return this._alertPermission}get kickPermission(){return this._kickPermission}get banPermission(){return this._banPermission}get roomAlertPermission(){return this._roomAlertPermission}get roomKickPermission(){return this._roomKickPermission}}class CM{constructor(){this._data=null}flush(){return this._data=null,!0}parse(t){return this._data=new MM(t),!0}get data(){return this._data}}class NM{flush(){return this._message="",this._url="",!0}parse(t){return t?(this._message=t.readString(),this._url=t.readString(),!0):!1}get message(){return this._message}get url(){return this._url}}class DM{constructor(t){if(this._tags=[],this._exists=t.readBoolean(),!this.exists)return;this._name=t.readString(),this._desc=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._tags.push(t.readString())}get name(){return this._name}get desc(){return this._desc}get tags(){return this._tags}get exists(){return this._exists}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._tags=null)}}class PM{constructor(t){this._flatId=t.readInt(),this._userCount=t.readInt(),this._ownerInRoom=t.readBoolean(),this._ownerId=t.readInt(),this._ownerName=t.readString(),this._room=new DM(t)}get flatId(){return this._flatId}get userCount(){return this._userCount}get ownerInRoom(){return this._ownerInRoom}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get room(){return this._room}get disposed(){return this._disposed}dispose(){this._disposed||(this._disposed=!0,this._room!=null&&(this._room.dispose(),this._room=null))}}class yM{flush(){return this._data=null,!0}parse(t){return t?(this._data=new PM(t),!0):!1}get data(){return this._data}}class LM{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,!0}parse(t){return this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),!0}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}}class UM{constructor(t){this._lastSanctionTime="",this._sanctionAgeHours=0,this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._registrationAgeInMinutes=t.readInt(),this._minutesSinceLastLogin=t.readInt(),this._online=t.readBoolean(),this._cfhCount=t.readInt(),this._abusiveCfhCount=t.readInt(),this._cautionCount=t.readInt(),this._banCount=t.readInt(),this._tradingLockCount=t.readInt(),this._tradingExpiryDate=t.readString(),this._lastPurchaseDate=t.readString(),this._identityId=t.readInt(),this._identityRelatedBanCount=t.readInt(),this._primaryEmailAddress=t.readString(),this._userClassification=t.readString(),t.bytesAvailable&&(this._lastSanctionTime=t.readString(),this._sanctionAgeHours=t.readInt())}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get registrationAgeInMinutes(){return this._registrationAgeInMinutes}get minutesSinceLastLogin(){return this._minutesSinceLastLogin}get online(){return this._online}get cfhCount(){return this._cfhCount}get abusiveCfhCount(){return this._abusiveCfhCount}get cautionCount(){return this._cautionCount}get banCount(){return this._banCount}get tradingLockCount(){return this._tradingLockCount}get tradingExpiryDate(){return this._tradingExpiryDate}get lastPurchaseDate(){return this._lastPurchaseDate}get identityId(){return this._identityId}get identityRelatedBanCount(){return this._identityRelatedBanCount}get primaryEmailAddress(){return this._primaryEmailAddress}get userClassification(){return this._userClassification}get lastSanctionTime(){return this._lastSanctionTime}get sanctionAgeHours(){return this._sanctionAgeHours}}class vM{flush(){return this._data=null,!0}parse(t){return t?(this._data=new UM(t),!0):!1}get data(){return this._data}}class bM{flush(){return this._data=null,!0}parse(t){return t?(this._data=new os(t),!0):!1}get data(){return this._data}}class FM{constructor(t){this._roomId=t.readInt(),this._roomName=t.readString(),this._enterHour=t.readInt(),this._enterMinute=t.readInt()}get roomId(){return this._roomId}get roomName(){return this._roomName}get enterHour(){return this._enterHour}get enterMinute(){return this._enterMinute}}class xM{constructor(t){this._rooms=[],this._userId=t.readInt(),this._userName=t.readString();const e=t.readInt();let s=0;for(;s<e;)this._rooms.push(new FM(t)),s++}get userId(){return this._userId}get userName(){return this._userName}get rooms(){return this._rooms}}class GM{flush(){return!0}parse(t){return this._data=new xM(t),!0}get data(){return this._data}}class BM{flush(){return this._message="",!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class wM{constructor(t){this._roomChatlogs=[],this._userId=t.readInt(),this._username=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._roomChatlogs.push(new os(t))}get userId(){return this._userId}get username(){return this._username}get roomChatlogs(){return this._roomChatlogs}}class HM{flush(){return this._data=null,!0}parse(t){return t?(this._data=new wM(t),!0):!1}get data(){return this._data}}class VM{flush(){return!0}parse(t){return!!t}}class jM{flush(){return!0}parse(t){return t?(this._contentType=t.readString(),this._classId=t.readInt(),!0):!1}get contentType(){return this._contentType}get classId(){return this._classId}}class zM{flush(){return this._boxColor=null,this._keyColor=null,!0}parse(t){return t?(this._boxColor=t.readString(),this._keyColor=t.readString(),!0):!1}get boxColor(){return this._boxColor}get keyColor(){return this._keyColor}}class YM{flush(){return!0}parse(t){return!!t}}class WM{flush(){return this._canCreate=!1,this._errorCode=0,!0}parse(t){return t?(this._canCreate=t.readBoolean(),this._errorCode=t.readInt(),!0):!1}get canCreate(){return this._canCreate}get errorCode(){return this._errorCode}}class Sh{flush(){return!0}parse(t){return t?(this._resultCode=t.readInt(),this._roomLimit=t.readInt(),!0):!1}get resultCode(){return this._resultCode}get roomLimit(){return this._roomLimit}}Sh.CREATION_ALLOWED=0;Sh.ROOM_LIMIT_REACHED=1;class kM{constructor(t){this._categoryToCurrentUserCountMap=new Map,this._categoryToMaxUserCountMap=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),r=t.readInt(),a=t.readInt();this._categoryToCurrentUserCountMap.set(i,r),this._categoryToMaxUserCountMap.set(i,a)}}get categoryToCurrentUserCountMap(){return this._categoryToCurrentUserCountMap}get categoryToMaxUserCountMap(){return this._categoryToMaxUserCountMap}}class KM{constructor(t,e=0,s=0){this._goalId=e,this._pageIndex=s,t&&(this._goalId=t.readInt(),this._pageIndex=t.readInt(),this._pageCount=t.readInt())}get goalId(){return this._goalId}get pageIndex(){return this._pageIndex}get pageCount(){return this._pageCount}}const Ka=class Pr{constructor(t){this._index=t.readInt(),this._popupCaption=t.readString(),this._popupDesc=t.readString(),this._showDetails=t.readInt()==1,this._picText=t.readString(),this._picRef=t.readString(),this._folderId=t.readInt(),this._userCount=t.readInt(),this._type=t.readInt(),this._type==Pr.TYPE_TAG?this._tag=t.readString():this._type==Pr.TYPE_GUEST_ROOM?this._guestRoomData=new wa(t):this._open=t.readBoolean()}dispose(){this._disposed||(this._disposed=!0,this._guestRoomData!=null&&(this._guestRoomData.flush(),this._guestRoomData=null))}get disposed(){return this._disposed}get type(){return this._type}get index(){return this._index}get popupCaption(){return this._popupCaption}get popupDesc(){return this._popupDesc}get showDetails(){return this._showDetails}get picText(){return this._picText}get picRef(){return this._picRef}get folderId(){return this._folderId}get tag(){return this._tag}get userCount(){return this._userCount}get guestRoomData(){return this._guestRoomData}get open(){return this._open}toggleOpen(){this._open=!this._open}get maxUsers(){return this.type==Pr.TYPE_TAG?0:this.type==Pr.TYPE_GUEST_ROOM?this._guestRoomData.maxUserCount:0}};Ka.TYPE_TAG=1;Ka.TYPE_GUEST_ROOM=2;Ka.TYPE_FOLDER=4;let XM=Ka;class qM{constructor(t){this._rooms=[],this._searchType=t.readInt(),this._searchParam=t.readString();const e=t.readInt();for(let i=0;i<e;i++)this._rooms.push(new wa(t));t.readBoolean()&&(this._ad=new XM(t))}dispose(){if(!this._disposed){if(this._disposed=!0,this._rooms!=null)for(const t of this._rooms)t.flush();this._ad!=null&&(this._ad.dispose(),this._ad=null),this._rooms=null}}get disposed(){return this._disposed}get searchType(){return this._searchType}get searchParam(){return this._searchParam}get rooms(){return this._rooms}get ad(){return this._ad}}class $c{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._code=null,this._filter=null,this._localization=null,!0}parse(t){return t?(this._id=t.readInt(),this._code=t.readString(),this._filter=t.readString(),this._localization=t.readString(),!0):!1}get id(){return this._id}get code(){return this._code}get filter(){return this._filter}get localization(){return this._localization}}class QM{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._action=-1,this._closed=!1,this._mode=-1,this._rooms=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString(),this._action=t.readInt(),this._closed=t.readBoolean(),this._mode=t.readInt();let e=t.readInt();for(;e>0;)this._rooms.push(new wa(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get action(){return this._action}get closed(){return this._closed}get mode(){return this._mode}get rooms(){return this._rooms}}class JM{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._data=null,this._results=[],!0}parse(t){if(!t)return!1;this._code=t.readString(),this._data=t.readString();let e=t.readInt();for(;e>0;)this._results.push(new QM(t)),e--;return!0}get code(){return this._code}get data(){return this._data}get results(){return this._results}}class ZM{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._code=null,this._savedSearches=[],!0}parse(t){if(!t)return!1;this._code=t.readString();let e=t.readInt();for(;e>0;)this._savedSearches.push(new $c(t)),e--;return!0}get code(){return this._code}get savedSearches(){return this._savedSearches}}class $M{constructor(t){this._adId=t.readInt(),this._ownerAvatarId=t.readInt(),this._ownerAvatarName=t.readString(),this._flatId=t.readInt(),this._eventType=t.readInt(),this._eventName=t.readString(),this._eventDescription=t.readString();const e=t.readInt(),s=t.readInt(),i=new Date;let r=i.getTime();const a=e*60*1e3;r=r-a;const o=new Date(r);this._creationTime=o.getDate()+"-"+o.getMonth()+"-"+o.getFullYear()+" "+o.getHours()+":"+o.getMinutes();let _=i.getTime();const l=s*60*1e3;_=_+l,this._expirationDate=new Date(_),this._categoryId=t.readInt()}dispose(){this._disposed||(this._disposed=!0)}get disposed(){return this._disposed}get adId(){return this._adId}get ownerAvatarId(){return this._ownerAvatarId}get ownerAvatarName(){return this._ownerAvatarName}get flatId(){return this._flatId}get categoryId(){return this._categoryId}get eventType(){return this._eventType}get eventName(){return this._eventName}get eventDescription(){return this._eventDescription}get creationTime(){return this._creationTime}get expirationDate(){return this._expirationDate}}class tC{flush(){return!0}parse(t){return t?(this._data=new kM(t),!0):!1}get data(){return this._data}}class eC{flush(){return!0}parse(t){return t?(this._data=new KM(t),!0):!1}get data(){return this._data}}class sC{flush(){return!0}parse(t){return t?(this._globalId=t.readString(),this._convertedId=t.readInt(),!0):!1}get globalId(){return this._globalId}get convertedId(){return this._convertedId}}class iC{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class rC{flush(){return!0}parse(t){return t?(this._flatId=t.readInt(),this._added=t.readBoolean(),!0):!1}get flatId(){return this._flatId}get added(){return this._added}}class nC{flush(){return!0}parse(t){if(!t)return!1;this._favouriteRoomIds=[],this._limit=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._favouriteRoomIds.push(t.readInt());return!0}get limit(){return this._limit}get favoriteRoomIds(){return this._favouriteRoomIds}}class aC{flush(){return this._userName=null,!0}parse(t){return t?(this._userName=t.readString(),!0):!1}get userName(){return this._userName}}class oC{flush(){return this._roomId=-1,this._roomName=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._roomName=t.readString(),!0):!1}get roomId(){return this._roomId}get roomName(){return this._roomName}}class _C{flush(){return this._roomEnter=!1,this._roomForward=!1,this._data=null,this._staffPick=!1,this._isGroupMember=!1,this._moderation=null,this._chat=null,!0}parse(t){return t?(this._roomEnter=t.readBoolean(),this._data=new wa(t),this._roomForward=t.readBoolean(),this._staffPick=t.readBoolean(),this._isGroupMember=t.readBoolean(),this.data.allInRoomMuted=t.readBoolean(),this._moderation=new on(t),this.data.canMute=t.readBoolean(),this._chat=new Ee(t),!0):!1}get roomEnter(){return this._roomEnter}get roomForward(){return this._roomForward}get data(){return this._data}get staffPick(){return this._staffPick}get isGroupMember(){return this._isGroupMember}get moderation(){return this._moderation}get chat(){return this._chat}}class hC{flush(){return!0}parse(t){return t?(this._data=new qM(t),!0):!1}get data(){return this._data}}class uC{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,this._automatic=!1,this._automaticCategoryKey=null,this._globalCategoryKey=null,this._staffOnly=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),this._automatic=t.readBoolean(),this._automaticCategoryKey=t.readString(),this._globalCategoryKey=t.readString(),this._staffOnly=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}get automatic(){return this._automatic}get automaticCategoryKey(){return this._automaticCategoryKey}get globalCategoryKey(){return this._globalCategoryKey}get staffOnly(){return this._staffOnly}}class lC{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(t.readString()),e--;return!0}get categories(){return this._categories}}class cC{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._id=-1,this._name=null,this._visible=!1,!0}parse(t){return t?(this._id=t.readInt(),this._name=t.readString(),this._visible=t.readBoolean(),!0):!1}get id(){return this._id}get name(){return this._name}get visible(){return this._visible}}class dC{flush(){return this._homeRoomId=-1,this._roomIdToEnter=-1,!0}parse(t){return t?(this._homeRoomId=t.readInt(),this._roomIdToEnter=t.readInt(),!0):!1}get homeRoomId(){return this._homeRoomId}get roomIdToEnter(){return this._roomIdToEnter}}class gC{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._roomId=-1,this._areaId=-1,this._image=null,this._caption=null,!0}parse(t){return t?(this._roomId=t.readInt(),this._areaId=t.readInt(),this._image=t.readString(),this._caption=t.readString(),!0):!1}get roomId(){return this._roomId}get areaId(){return this._areaId}get image(){return this._image}get caption(){return this._caption}}class EC{flush(){return this._rooms=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._rooms.push(new gC(t)),e--;return!0}get rooms(){return this._rooms}}class fC{flush(){return this._topLevelContexts=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._topLevelContexts.push(new ZM(t)),e--;return!0}get topLevelContexts(){return this._topLevelContexts}}class mC{flush(){return!0}parse(t){return!!t}}class IC{flush(){return this._searches=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._searches.push(new $c(t)),e--;return!0}get searches(){return this._searches}}class RC{flush(){return this._result=null,!0}parse(t){return t?(this._result=new JM(t),!0):!1}get result(){return this._result}}class TC{flush(){return this._windowX=0,this._windowY=0,this._windowWidth=0,this._windowHeight=0,this._leftPanelHidden=!1,this._resultsMode=0,!0}parse(t){return t?(this._windowX=t.readInt(),this._windowY=t.readInt(),this._windowWidth=t.readInt(),this._windowHeight=t.readInt(),this._leftPanelHidden=t.readBoolean(),this._resultsMode=t.readInt(),!0):!1}get windowX(){return this._windowX}get windowY(){return this._windowY}get windowWidth(){return this._windowWidth}get windowHeight(){return this._windowHeight}get leftPanelHidden(){return this._leftPanelHidden}get resultsMode(){return this._resultsMode}}class pC{constructor(t){this._tagName=t.readString(),this._userCount=t.readInt()}get tagName(){return this._tagName}get userCount(){return this._userCount}}class OC{constructor(t){if(!t)throw new Error("invalid_wrapper");this.flush(),this.parse(t)}flush(){return this._tags=[],!0}parse(t){if(!t)return!1;this._tags=[];const e=t.readInt();let s=0;for(;s<e;)this._tags.push(new pC(t)),s++;return!0}get tags(){return this._tags}}class AC{flush(){return this._data=null,!0}parse(t){return t?(this._data=new OC(t),!0):!1}get data(){return this._data}}class SC{flush(){return!0}parse(t){return!0}}class MC{flush(){return!0}parse(t){return this._data=new $M(t),!0}get data(){return this._data}}class CC{flush(){return this._words=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._words.push(t.readString()),e--;return!0}get words(){return this._words}}class NC{flush(){return this._roomId=0,!0}parse(t){return t?(this._roomId=t.readInt(),!0):!1}get roomId(){return this._roomId}}class DC{flush(){return!0}parse(t){return this._flatId=t.readInt(),this._resultCode=t.readInt(),!0}get flatId(){return this._flatId}get resultCode(){return this._resultCode}}class PC{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new cC(t)),e--;return!0}get categories(){return this._categories}}class yC{flush(){return this._categories=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._categories.push(new uC(t)),e--;return!0}get categories(){return this._categories}}class LC{constructor(t){this._badgeCode="",this._removedBadgeCode="",this._type=t.readInt(),this._level=t.readInt(),this._badgeId=t.readInt(),this._badgeCode=t.readString(),this._points=t.readInt(),this._levelRewardPoints=t.readInt(),this._levelRewardPointType=t.readInt(),this._bonusPoints=t.readInt(),this._achievementID=t.readInt(),this._removedBadgeCode=t.readString(),this._category=t.readString(),this._showDialogToUser=t.readBoolean()}get type(){return this._type}get level(){return this._level}get points(){return this._points}get levelRewardPoints(){return this._levelRewardPoints}get levelRewardPointType(){return this._levelRewardPointType}get bonusPoints(){return this._bonusPoints}get badgeId(){return this._badgeId}get badgeCode(){return this._badgeCode}get removedBadgeCode(){return this._removedBadgeCode}get achievementID(){return this._achievementID}get category(){return this._category}get showDialogToUser(){return this._showDialogToUser}}class UC{flush(){return this._data=null,!0}parse(t){return t?(this._data=new LC(t),!0):!1}get data(){return this._data}}class vC{flush(){return this._amount=0,this._amountChanged=0,this._type=-1,!0}parse(t){return t?(this._amount=t.readInt(),this._amountChanged=t.readInt(),this._type=t.readInt(),!0):!1}get amount(){return this._amount}get amountChanged(){return this._amountChanged}get type(){return this._type}}class bC{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class FC{flush(){return this._numGifts=0,!0}parse(t){return t?(this._numGifts=t.readInt(),!0):!1}get numGifts(){return this._numGifts}}class xC{flush(){return this._errorCode=0,this._messageId=0,this._timestamp=null,!0}parse(t){return t?(this._messageId=t.readInt(),this._errorCode=t.readInt(),this._timestamp=t.readString(),!0):!1}get errorCode(){return this._errorCode}get messageId(){return this._messageId}get timestamp(){return this._timestamp}}class GC{flush(){return this._key=null,!0}parse(t){return t?(this._key=t.readString(),!0):!1}get key(){return this._key}}class BC{flush(){return this._message=null,!0}parse(t){return t?(this._message=t.readString(),!0):!1}get message(){return this._message}}class wC{flush(){return this._enabled=!1,!0}parse(t){return t?(this._enabled=t.readBoolean(),!0):!1}get enabled(){return this._enabled}}class HC{flush(){return this._messages=[],!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;)this._messages.push(t.readString()),e--;return!0}get messages(){return this._messages}}class VC{flush(){return this._type=null,this._parameters=new Map,!0}parse(t){if(!t)return!1;this._type=t.readString();let e=t.readInt();for(;e>0;)this._parameters.set(t.readString(),t.readString()),e--;return!0}get type(){return this._type}get parameters(){return this._parameters}}class jC{flush(){return this._petId=-1,this._petName=null,this._level=0,this._figureData=null,!0}parse(t){return t?(this._petId=t.readInt(),this._petName=t.readString(),this._level=t.readInt(),this._figureData=new Rh(t),!0):!1}get petId(){return this._petId}get petName(){return this._petName}get level(){return this._level}get figureData(){return this._figureData}}class zC{flush(){return this._errorCode=-1,!0}parse(t){return t?(this._errorCode=t.readInt(),!0):!1}get errorCode(){return this._errorCode}}class YC{flush(){return this._alertMessage=null,!0}parse(t){return t?(this._alertMessage=t.readString(),t.bytesAvailable&&(this._titleMessage=t.readString()),!0):!1}get alertMessage(){return this._alertMessage}get titleMessage(){return this._titleMessage}}class WC{flush(){return this._items=new vt,!0}parse(t){if(!t)return!1;let e=t.readInt();for(;e>0;){const s=t.readInt();let i=t.readInt();const r=[];for(;i>0;)r.push(t.readInt()),i--;this._items.add(s,r),e--}return!0}getItemsByCategory(t){return this._items.getValue(t)}get categories(){return this._items.getKeys()}}class kC{constructor(t,e,s){this._code=t,this._errorMessage=e,this._isAllowed=s}get code(){return this._code}get errorMessage(){return this._errorMessage}get isAllowed(){return this._isAllowed}}class Ue{}Ue.USE_GUIDE_TOOL="USE_GUIDE_TOOL";Ue.GIVE_GUIDE_TOUR="GIVE_GUIDE_TOUR";Ue.JUDGE_CHAT_REVIEWS="JUDGE_CHAT_REVIEWS";Ue.VOTE_IN_COMPETITIONS="VOTE_IN_COMPETITIONS";Ue.CALL_ON_HELPERS="CALL_ON_HELPERS";Ue.CITIZEN="CITIZEN";Ue.TRADE="TRADE";Ue.HEIGHTMAP_EDITOR_BETA="HEIGHTMAP_EDITOR_BETA";Ue.BUILDER_AT_WORK="BUILDER_AT_WORK";Ue.NAVIGATOR_ROOM_THUMBNAIL_CAMERA="NAVIGATOR_ROOM_THUMBNAIL_CAMERA";Ue.CAMERA="CAMERA";Ue.MOUSE_ZOOM="MOUSE_ZOOM";class KC{flush(){return this._perks=[],!0}parse(t){if(!t)return!1;this._perks=[];const e=t.readInt();for(let s=0;s<e;s++)this._perks.push(new kC(t.readString(),t.readString(),t.readBoolean()));return!0}isAllowed(t){let e=!1;for(const s of this._perks)if(s.code===t){e=s.isAllowed;break}return e}get perks(){return this._perks}}class XC{flush(){return this._objectId=-1,this._figureData=null,!0}parse(t){return this._objectId=t.readInt(),t.bytesAvailable&&(this._figureData=new Aa(t.readString())),!0}get objectId(){return this._objectId}get figureData(){return this._figureData}}class qC{flush(){return this._objectId=0,this._nameValidationStatus=0,this._nameValidationInfo=null,!0}parse(t){return this._objectId=t.readInt(),this._nameValidationStatus=t.readInt(),this._nameValidationInfo=t.readString(),!0}get objectId(){return this._objectId}get nameValidationStatus(){return this._nameValidationStatus}get nameValidationInfo(){return this._nameValidationInfo}}class QC{flush(){return this._roomIndex=-1,this._petId=-1,this._level=-1,!0}parse(t){return this._roomIndex=t.readInt(),this._petId=t.readInt(),this._level=t.readInt(),!0}get roomIndex(){return this._roomIndex}get petId(){return this._petId}get level(){return this._level}}class JC{flush(){return this._currentAge=-1,this._requiredAge=-1,!0}parse(t){return this._currentAge=t.readInt(),this._requiredAge=t.readInt(),!0}get currentAge(){return this._currentAge}get requiredAge(){return this._requiredAge}}class ZC{flush(){return this._petId=-1,this._commands=[],this._enabledCommands=[],!0}parse(t){this._petId=t.readInt();let e=t.readInt();for(;e>0;)this._commands.push(t.readInt()),e--;let s=t.readInt();for(;s>0;)this._enabledCommands.push(t.readInt()),s--;return!0}get petId(){return this._petId}get commands(){return this._commands}get enabledCommands(){return this._enabledCommands}}class $C{constructor(t,e,s){this._value=t,this._choiceText=e,this._choiceType=s}get value(){return this._value}set value(t){this._value=t}get choiceText(){return this._choiceText}set choiceText(t){this._choiceText=t}get choiceType(){return this._choiceType}set choiceType(t){this._choiceType=t}}class tN{constructor(){this._children=[],this._questionChoices=[]}get questionId(){return this._questionId}set questionId(t){this._questionId=t}get questionType(){return this._questionType}set questionType(t){this._questionType=t}get sortOrder(){return this._sortOrder}set sortOrder(t){this._sortOrder=t}get questionText(){return this._questionText}set questionText(t){this._questionText=t}get questionCategory(){return this._questionCategory}set questionCategory(t){this._questionCategory=t}get questionAnswerType(){return this._questionAnswerType}set questionAnswerType(t){this._questionAnswerType=t}get questionAnswerCount(){return this._questionAnswerCount}set questionAnswerCount(t){this._questionAnswerCount=t}get children(){return this._children}set children(t){this._children=t}get questionChoices(){return this._questionChoices}set questionChoices(t){this._questionChoices=t}}class eN{constructor(){this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],this._npsPoll=!1}flush(){return this._id=-1,this._startMessage="",this._endMessage="",this._numQuestions=0,this._questionArray=[],!0}parse(t){this._id=t.readInt(),this._startMessage=t.readString(),this._endMessage=t.readString(),this._numQuestions=t.readInt();for(let e=0;e<this._numQuestions;e++){const s=this.parsePollQuestion(t),i=t.readInt();for(let r=0;r<i;r++)s.children.push(this.parsePollQuestion(t));this._questionArray.push(s)}return this._npsPoll=t.readBoolean(),!0}parsePollQuestion(t){const e=new tN;if(e.questionId=t.readInt(),e.sortOrder=t.readInt(),e.questionType=t.readInt(),e.questionText=t.readString(),e.questionCategory=t.readInt(),e.questionAnswerType=t.readInt(),e.questionAnswerCount=t.readInt(),e.questionType==1||e.questionType==2)for(let s=0;s<e.questionAnswerCount;s++)e.questionChoices.push(new $C(t.readString(),t.readString(),t.readInt()));return e}get id(){return this._id}get startMessage(){return this._startMessage}get endMessage(){return this._endMessage}get numQuestions(){return this._numQuestions}get questionArray(){return this._questionArray}get npsPoll(){return this._npsPoll}}class sN{flush(){throw!0}parse(t){return!0}}class iN{constructor(){this._id=-1,this._type="",this._headline="",this._summary=""}flush(){return this._id=-1,this._type="",this._summary="",!0}parse(t){return this._id=t.readInt(),this._type=t.readString(),this._headline=t.readString(),this._summary=t.readString(),!0}get id(){return this._id}get type(){return this._type}get headline(){return this._headline}get summary(){return this._summary}}class rN{flush(){return this._userId=-1,this._value="",this._answerCounts=null,!0}parse(t){this._userId=t.readInt(),this._value=t.readString(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),r=t.readInt();this._answerCounts.set(i,r)}return!0}get userId(){return this._userId}get value(){return this._value}get answerCounts(){return this._answerCounts}}class nN{flush(){return this._questionId=-1,this._answerCounts=null,!0}parse(t){this._questionId=t.readInt(),this._answerCounts=new Map;const e=t.readInt();for(let s=0;s<e;s++){const i=t.readString(),r=t.readInt();this._answerCounts.set(i,r)}return!0}get questionId(){return this._questionId}get answerCounts(){return this._answerCounts}}class aN{constructor(){this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null}flush(){return this._pollType=null,this._pollId=-1,this._questionId=-1,this._duration=-1,this._question=null,!0}parse(t){this._pollType=t.readString(),this._pollId=t.readInt(),this._questionId=t.readInt(),this._duration=t.readInt();const e=t.readInt(),s=t.readInt(),i=t.readInt(),r=t.readString();if(this._question={id:e,number:s,type:i,content:r},this._question.type==1||this._question.type==2){this._question.selection_min=t.readInt();const a=t.readInt();this._question.selections=[],this._question.selection_values=[],this._question.selection_count=a,this._question.selection_max=a;for(let o=0;o<a;o++)this._question.selection_values.push(t.readString()),this._question.selections.push(t.readString())}return!0}get pollType(){return this._pollType}get pollId(){return this._pollId}get questionId(){return this._questionId}get duration(){return this._duration}get question(){return this._question}}class oN{constructor(t){this._rewardUserLimits=[],this._hasGoalExpired=t.readBoolean(),this._personalContributionScore=t.readInt(),this._personalContributionRank=t.readInt(),this._communityTotalScore=t.readInt(),this._communityHighestAchievedLevel=t.readInt(),this._scoreRemainingUntilNextLevel=t.readInt(),this._percentCompletionTowardsNextLevel=t.readInt(),this._goalCode=t.readString(),this._timeRemainingInSeconds=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._rewardUserLimits.push(t.readInt())}dispose(){this._rewardUserLimits=null}get disposed(){return this._rewardUserLimits==null}get hasGoalExpired(){return this._hasGoalExpired}get personalContributionScore(){return this._personalContributionScore}get personalContributionRank(){return this._personalContributionRank}get communityTotalScore(){return this._communityTotalScore}get communityHighestAchievedLevel(){return this._communityHighestAchievedLevel}get scoreRemainingUntilNextLevel(){return this._scoreRemainingUntilNextLevel}get percentCompletionTowardsNextLevel(){return this._percentCompletionTowardsNextLevel}get timeRemainingInSeconds(){return this._timeRemainingInSeconds}get rewardUserLimits(){return this._rewardUserLimits}get goalCode(){return this._goalCode}}class _N{constructor(t){this._communityGoalId=t.readInt(),this._communityGoalCode=t.readString(),this._userRank=t.readInt(),this._rewardCode=t.readString(),this._badge=t.readBoolean(),this._localizedName=t.readString()}get communityGoalId(){return this._communityGoalId}get communityGoalCode(){return this._communityGoalCode}get userRank(){return this._userRank}get rewardCode(){return this._rewardCode}get badge(){return this._badge}get localizedName(){return this._localizedName}}class hN{flush(){return this._prizes=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._prizes.push(new _N(t));return!0}get prizes(){return this._prizes}}class uN{constructor(t){this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._rank=t.readInt(),this._currentScore=t.readInt()}get userId(){return this._userId}get userName(){return this._userName}get figure(){return this._figure}get rank(){return this._rank}get currentScore(){return this._currentScore}}class lN{constructor(t){this._hof=[],this._goalCode=t.readString();const e=t.readInt();for(let s=0;s<e;s++)this._hof.push(new uN(t))}dispose(){this._hof=null}get disposed(){return this._hof==null}get hof(){return this._hof}get goalCode(){return this._goalCode}}class cN{flush(){return this._data=null,!0}parse(t){return t?(this._data=new lN(t),!0):!1}get data(){return this._data}}class dN{flush(){return this._data=null,!0}parse(t){return t?(this._data=new oN(t),!0):!1}get data(){return this._data}}class gN{flush(){return this._state=-1,this._userCount=-1,this._userCountGoal=-1,!0}parse(t){return t?(this._state=t.readInt(),this._userCount=t.readInt(),this._userCountGoal=t.readInt(),!0):!1}get state(){return this._state}get userCount(){return this._userCount}get userCountGoal(){return this._userCountGoal}}class EN{flush(){return this._imageUri="",!0}parse(t){return t?(this._imageUri=t.readString(),!0):!1}get imageUri(){return this._imageUri}}class fN{flush(){return!0}parse(t){return t?(this._expired=t.readBoolean(),!0):!1}get expired(){return this._expired}}class yi{constructor(t){this._receiveTime=new Date,this._campaignCode=t.readString(),this._completedQuestsInCampaign=t.readInt(),this._questCountInCampaign=t.readInt(),this._activityPointType=t.readInt(),this._id=t.readInt(),this._accepted=t.readBoolean(),this._type=t.readString(),this._imageVersion=t.readString(),this._rewardCurrencyAmount=t.readInt(),this._localizationCode=t.readString(),this._completedSteps=t.readInt(),this._totalSteps=t.readInt(),this._sortOrder=t.readInt(),this._catalogPageName=t.readString(),this._chainCode=t.readString(),this._easy=t.readBoolean()}static getCampaignLocalizationKeyForCode(t){return"quests."+t}get campaignCode(){return this._campaignCode}get localizationCode(){return this._localizationCode}get completedQuestsInCampaign(){return this._completedQuestsInCampaign}get questCountInCampaign(){return this._questCountInCampaign}get activityPointType(){return this._activityPointType}set accepted(t){this._accepted=t}get accepted(){return this._accepted}set id(t){this._id=t}get id(){return this._id}get type(){return this._type}get imageVersion(){return this._imageVersion}get rewardCurrencyAmount(){return this._rewardCurrencyAmount}get completedSteps(){return this._completedSteps}get totalSteps(){return this._totalSteps}get isCompleted(){return this._completedSteps==this._totalSteps}set waitPeriodSeconds(t){this._waitPeriodSeconds=t}get waitPeriodSeconds(){if(this._waitPeriodSeconds<1)return 0;const e=new Date().getTime()-this._receiveTime.getTime();return Math.max(0,this._waitPeriodSeconds-Math.floor(e/1e3))}getCampaignLocalizationKey(){return yi.getCampaignLocalizationKeyForCode(this.campaignCode)}getQuestLocalizationKey(){return this.getCampaignLocalizationKey()+"."+this._localizationCode}get completedCampaign(){return this._id<1}get lastQuestInCampaign(){return this._completedQuestsInCampaign>=this._questCountInCampaign}get receiveTime(){return this._receiveTime}get sortOrder(){return this._sortOrder}get catalogPageName(){return this._catalogPageName}get chainCode(){return this._chainCode}get easy(){return this._easy}}class mN{flush(){return this._questData=null,!0}parse(t){return t?(this._questData=new yi(t),this._showDialog=t.readBoolean(),!0):!1}get questData(){return this._questData}get showDialog(){return this._showDialog}}class IN{flush(){return this._quest=null,!0}parse(t){return t?(t.readBoolean()&&(this._quest=new yi(t),this._easyQuestCount=t.readInt(),this._hardQuestCount=t.readInt()),!0):!1}get quest(){return this._quest}get easyQuestCount(){return this._easyQuestCount}get hardQuestCount(){return this._hardQuestCount}}class RN{flush(){return this._quest=null,!0}parse(t){return t?(this._quest=new yi(t),!0):!1}get quest(){return this._quest}}class TN{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new yi(t));return this._openWindow=t.readBoolean(),!0}get quests(){return this._quests}get openWindow(){return this._openWindow}}class pN{flush(){return this._quests=[],!0}parse(t){if(!t)return!1;const e=t.readInt();for(let s=0;s<e;s++)this._quests.push(new yi(t));return!0}get quests(){return this._quests}}class ON{flush(){return this._recyclerFinishedStatus=-1,this._prizeId=0,!0}parse(t){return t?(this._recyclerFinishedStatus=t.readInt(),this._prizeId=t.readInt(),!0):!1}get recyclerFinishedStatus(){return this._recyclerFinishedStatus}get prizeId(){return this._prizeId}}class AN{flush(){return this._recyclerStatus=-1,this._recyclerTimeoutSeconds=0,!0}parse(t){return t?(this._recyclerStatus=t.readInt(),this._recyclerTimeoutSeconds=t.readInt(),!0):!1}get recyclerStatus(){return this._recyclerStatus}get recyclerTimeoutSeconds(){return this._recyclerTimeoutSeconds}}class Mh{constructor(t){this._stuffIds=[],this._intParams=[],this._stuffTypeSelectionEnabled=t.readBoolean(),this._furniLimit=t.readInt();let e=t.readInt();for(;e>0;)this._stuffIds.push(t.readInt()),e--;for(this._stuffTypeId=t.readInt(),this._id=t.readInt(),this._stringParam=t.readString(),e=t.readInt();e>0;)this._intParams.push(t.readInt()),e--;this._stuffTypeSelectionCode=t.readInt()}getBoolean(t){return this._intParams[t]===1}get stuffTypeSelectionEnabled(){return this._stuffTypeSelectionEnabled}get stuffTypeSelectionCode(){return this._stuffTypeSelectionCode}set stuffTypeSelectionCode(t){this._stuffTypeSelectionCode=t}get maximumItemSelectionCount(){return this._furniLimit}get selectedItems(){return this._stuffIds}get id(){return this._id}get stringData(){return this._stringParam}get intData(){return this._intParams}get code(){return 0}get spriteId(){return this._stuffTypeId}}class SN extends Mh{constructor(t){super(t),this._type=t.readInt()}get type(){return this._type}get code(){return this._type}}class MN extends Mh{constructor(t){super(t),this._conflictingActions=[],this._triggerConf=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingActions.push(t.readInt()),e--}get code(){return this._triggerConf}get conflictingActions(){return this._conflictingActions}}class CN extends Mh{constructor(t){super(t),this._conflictingTriggers=[],this._type=t.readInt(),this._delayInPulses=t.readInt();let e=t.readInt();for(;e>0;)this._conflictingTriggers.push(t.readInt()),e--}get type(){return this._type}get code(){return this._type}get delayInPulses(){return this._delayInPulses}get conflictingTriggers(){return this._conflictingTriggers}}class NN{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new CN(t),!0):!1}get definition(){return this._definition}}class DN{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new SN(t),!0):!1}get definition(){return this._definition}}class PN{flush(){return this._definition=null,!0}parse(t){return t?(this._definition=new MN(t),!0):!1}get definition(){return this._definition}}class yN{flush(){return this._stuffId=0,!0}parse(t){return t?(this._stuffId=t.readInt(),!0):!1}get stuffId(){return this._stuffId}}class LN{flush(){return this._reason=0,!0}parse(t){return t?(this._reason=t.readInt(),!0):!1}get reason(){return this._reason}}class UN{flush(){return!0}parse(t){return!!t}}class vN{flush(){return this._info=null,!0}parse(t){return t?(this._info=t.readString(),!0):!1}get info(){return this._info}}class bN{flush(){return!0}parse(t){return!!t}}class FN{flush(){return!0}parse(t){return!0}}class xN{constructor(){this._songDisks=new vt}flush(){return this._songDisks.reset(),this._maxLength=0,!0}parse(t){this._maxLength=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._songDisks.add(t.readInt(),t.readInt());return!0}get songDisks(){return this._songDisks}get maxLength(){return this._maxLength}}class GN{flush(){return this._currentSongId=-1,this._currentPosition=-1,this._nextSongId=-1,this._nextPosition=-1,this._syncCount=-1,!0}parse(t){return this._currentSongId=t.readInt(),this._currentPosition=t.readInt(),this._nextSongId=t.readInt(),this._nextPosition=t.readInt(),this._syncCount=t.readInt(),!0}get currentSongId(){return this._currentSongId}get currentPosition(){return this._currentPosition}get nextSongId(){return this._nextSongId}get nextPosition(){return this._nextPosition}get syncCount(){return this._syncCount}}class BN{flush(){return this._songId=0,this._officialSongId="",!0}parse(t){return this._officialSongId=t.readString(),this._songId=t.readInt(),!0}get songId(){return this._songId}get officialSongId(){return this._officialSongId}}class Xa{constructor(t,e,s,i){this._startPlayHead=0,this._id=t,this._length=e,this._name=s,this._creator=i}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get startPlayHeadPos(){return this._startPlayHead}set startPlayHeadPos(t){this._startPlayHead=t}}class wN{flush(){return this._synchronizationCount=-1,this._playlist=[],!0}parse(t){this._synchronizationCount=t.readInt();const e=t.readInt();for(let s=0;s<e;s++)this._playlist.push(new Xa(t.readInt(),t.readInt(),t.readString(),t.readString()));return!0}get synchronizationCount(){return this._synchronizationCount}get playList(){return this._playlist}}class HN{flush(){return this._entry=null,!0}parse(t){return this._entry=new Xa(t.readInt(),t.readInt(),t.readString(),t.readString()),!0}get entry(){return this._entry}}class VN extends Xa{constructor(t,e,s,i,r){super(t,e,s,i),this._data="",this._data=r}get data(){return this._data}}class jN{flush(){return this._songs=[],!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt();t.readString();const r=t.readString(),a=t.readString(),o=t.readInt(),_=t.readString(),l=new VN(i,o,r,_,a);this._songs.push(l)}return!0}get songs(){return this._songs}}class zN{constructor(){this._songDiskInventory=new vt}flush(){return this._songDiskInventory.reset(),!0}parse(t){const e=t.readInt();for(let s=0;s<e;s++)this._songDiskInventory.add(t.readInt(),t.readInt());return!0}getDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}get songDiskCount(){return this._songDiskInventory.length}}class YN{flush(){return this._talentTrackName=null,this._level=-1,this._rewardPerks=[],this._rewardProducts=[],!0}parse(t){if(!t)return!1;let e=0;this._talentTrackName=t.readString(),this._level=t.readInt();const s=t.readInt();for(;e<s;)this._rewardPerks.push(new qN(t)),e++;const i=t.readInt();if(e<i)for(let r=0;r<i;r++){const a=t.readString(),o=t.readInt();this._rewardProducts.push(new td(a,o)),e++}return!0}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get rewardPerks(){return this._rewardPerks}get rewardProducts(){return this._rewardProducts}}class WN{constructor(t,e,s,i,r){this._level=t,this._state=e,this._tasks=s,this._rewardPerks=i,this._rewardProducts=r}get level(){return this._level}get state(){return this._state}get tasks(){return this._tasks}get perks(){return this._rewardPerks}get items(){return this._rewardProducts}}class kN{flush(){return this._talentTrackName=null,this._level=-1,this._maxLevel=-1,!0}parse(t){return t?(this._talentTrackName=t.readString(),this._level=t.readInt(),this._maxLevel=t.readInt(),!0):!1}get talentTrackName(){return this._talentTrackName}get level(){return this._level}get maxLevel(){return this._maxLevel}}class td{constructor(t,e){this._productCode=t,this._vipDays=e}get productCode(){return this._productCode}get vipDays(){return this._vipDays}}class KN{constructor(t,e,s,i,r,a){this._id=t,this._requiredLevel=e,this._badgeCode=s,this._state=i,this._currentScore=r,this._totalScore=a}get id(){return this._id}get requiredLevel(){return this._requiredLevel}get badgeCode(){return this._badgeCode}get state(){return this._state}get currentScore(){return this._currentScore}get totalScore(){return this._totalScore}}class XN{flush(){return this._type=null,this._levels=null,!0}parse(t){if(!t)return!1;this._type=t.readString(),this._levels=[];const e=t.readInt();for(let s=0;s<e;s++){const i=t.readInt(),r=t.readInt(),a=[],o=t.readInt();for(let E=0;E<o;E++){const I=t.readInt(),m=t.readInt(),T=t.readString(),p=t.readInt(),A=t.readInt(),N=t.readInt();a.push(new KN(I,m,T,p,A,N))}const _=[],l=t.readInt();for(let E=0;E<l;E++)_.push(t.readString());const c=[],d=t.readInt();for(let E=0;E<d;E++){const I=t.readString(),m=t.readInt();c.push(new td(I,m))}this._levels.push(new WN(i,r,a,_,c))}return!0}get type(){return this._type}get levels(){return this._levels}}class qN{constructor(t){this._perkId=t.readInt()}get perkId(){return this._perkId}}class QN{flush(){return this._classifiedUsersNames&&(this._classifiedUsersNames=new Map),this._classifiedUsersClass&&(this._classifiedUsersClass=new Map),!0}parse(t){if(!t)return!1;let e,s,i,r=t.readInt();for(this._classifiedUsersNames=new Map,this._classifiedUsersClass=new Map;r>0;)e=t.readInt(),s=t.readString(),i=t.readString(),this._classifiedUsersNames.set(e,s),this._classifiedUsersClass.set(e,i),r--;return!0}get classifiedUsernameMap(){return this._classifiedUsersNames}get classifiedUserTypeMap(){return this._classifiedUsersClass}}class JN extends f{constructor(t){super(t,QI)}getParser(){return this.parser}}class ZN extends f{constructor(t){super(t,JI)}getParser(){return this.parser}}class ed extends f{constructor(t){super(t,ZI)}getParser(){return this.parser}}class $N extends f{constructor(t){super(t,$I)}getParser(){return this.parser}}class tD extends f{constructor(t){super(t,tR)}getParser(){return this.parser}}class eD extends f{constructor(t){super(t,eR)}getParser(){return this.parser}}class sD extends f{constructor(t){super(t,sR)}getParser(){return this.parser}}class iD extends f{constructor(t){super(t,iR)}getParser(){return this.parser}}class We extends f{constructor(t){super(t,rR)}getParser(){return this.parser}}We.NAME_OK=0;We.ERROR_NAME_REQUIRED=1;We.ERROR_NAME_TOO_SHORT=2;We.ERROR_NAME_TOO_LONG=3;We.ERROR_NAME_NOT_VALID=4;We.ERROR_NAME_IN_USE=5;We.ERROR_NAME_CHANGE_NOT_ALLOWED=6;We.ERROR_MERGE_HOTEL_DOWN=7;class rD extends f{constructor(t){super(t,nR)}getParser(){return this.parser}}class sd extends f{constructor(t){super(t,aR)}getParser(){return this.parser}}class nD extends f{constructor(t){super(t,_R)}getParser(){return this.parser}}class aD extends f{constructor(t){super(t,hR)}getParser(){return this.parser}}class oD extends f{constructor(t){super(t,uR)}getParser(){return this.parser}}class _D extends f{constructor(t){super(t,lR)}getParser(){return this.parser}}class hD extends f{constructor(t){super(t,cR)}getParser(){return this.parser}}class uD extends f{constructor(t){super(t,fR)}getParser(){return this.parser}}class lD extends f{constructor(t){super(t,mR)}getParser(){return this.parser}}class cD extends f{constructor(t){super(t,IR)}getParser(){return this.parser}}class dD extends f{constructor(t){super(t,RR)}getParser(){return this.parser}}class gD extends f{constructor(t){super(t,TR)}getParser(){return this.parser}}class ED extends f{constructor(t){super(t,pR)}getParser(){return this.parser}}class fD extends f{constructor(t){super(t,OR)}getParser(){return this.parser}}class mD extends f{constructor(t){super(t,AR)}getParser(){return this.parser}}class ID extends f{constructor(t){super(t,SR)}getParser(){return this.parser}}class RD extends f{constructor(t){super(t,MR)}getParser(){return this.parser}}class TD extends f{constructor(t){super(t,CR)}getParser(){return this.parser}}class pD extends f{constructor(t){super(t,NR)}getParser(){return this.parser}}class OD extends f{constructor(t){super(t,DR)}getParser(){return this.parser}}class AD extends f{constructor(t){super(t,PR)}getParser(){return this.parser}}class SD extends f{constructor(t){super(t,LR)}getParser(){return this.parser}}class MD extends f{constructor(t){super(t,bR)}getParser(){return this.parser}}class CD extends f{constructor(t){super(t,xR)}getParser(){return this.parser}}class ND extends f{constructor(t){super(t,UR)}getParser(){return this.parser}}class DD extends f{constructor(t){super(t,GR)}getParser(){return this.parser}}class PD extends f{constructor(t){super(t,BR)}getParser(){return this.parser}}class yD extends f{constructor(t){super(t,HR)}getParser(){return this.parser}}class LD extends f{constructor(t){super(t,VR)}getParser(){return this.parser}}class UD extends f{constructor(t){super(t,zR)}getParser(){return this.parser}}class vD extends f{constructor(t){super(t,YR)}getParser(){return this.parser}}class bD extends f{constructor(t){super(t,WR)}getParser(){return this.parser}}class FD extends f{constructor(t){super(t,kR)}getParser(){return this.parser}}class xD extends f{constructor(t){super(t,KR)}getParser(){return this.parser}}class GD extends f{constructor(t){super(t,XR)}getParser(){return this.parser}}class BD extends f{constructor(t){super(t,qR)}getParser(){return this.parser}}class wD extends f{constructor(t){super(t,QR)}getParser(){return this.parser}}class HD extends f{constructor(t){super(t,JR)}getParser(){return this.parser}}class VD extends f{constructor(t){super(t,ZR)}getParser(){return this.parser}}class jD extends f{constructor(t){super(t,$R)}getParser(){return this.parser}}class zD extends f{constructor(t){super(t,tT)}getParser(){return this.parser}}class YD extends f{constructor(t){super(t,sT)}getParser(){return this.parser}}class WD extends f{constructor(t){super(t,iA)}getParser(){return this.parser}}class kD extends f{constructor(t){super(t,rA)}getParser(){return this.parser}}class KD extends f{constructor(t){super(t,aA)}getParser(){return this.parser}}class XD extends f{constructor(t){super(t,hA)}getParser(){return this.parser}}class qD extends f{constructor(t){super(t,_A)}getParser(){return this.parser}}class QD extends f{constructor(t){super(t,uA)}getParser(){return this.parser}}class JD extends f{constructor(t){super(t,lA)}getParser(){return this.parser}}class id extends f{constructor(t){super(t,cA)}getParser(){return this.parser}}class ZD extends f{constructor(t){super(t,ai)}getParser(){return this.parser}}class $D extends f{constructor(t){super(t,dA)}getParser(){return this.parser}}class tP extends f{constructor(t){super(t,gA)}getParser(){return this.parser}}class eP extends f{constructor(t){super(t,EA)}getParser(){return this.parser}}class sP extends f{constructor(t){super(t,fA)}getParser(){return this.parser}}class iP extends f{constructor(t){super(t,mA)}getParser(){return this.parser}}class rP extends f{constructor(t){super(t,IA)}getParser(){return this.parser}}class nP extends f{constructor(t){super(t,TA)}getParser(){return this.parser}}class aP extends f{constructor(t){super(t,pA)}getParser(){return this.parser}}class oP extends f{constructor(t){super(t,OA)}getParser(){return this.parser}}class s_ extends f{constructor(t){super(t,AA)}getParser(){return this.parser}}class _P extends f{constructor(t){super(t,MA)}getParser(){return this.parser}}class hP extends f{constructor(t){super(t,CA)}getParser(){return this.parser}}class uP extends f{constructor(t){super(t,NA)}getParser(){return this.parser}}class lP extends f{constructor(t){super(t,DA)}getParser(){return this.parser}}class cP extends f{constructor(t){super(t,PA)}getParser(){return this.parser}}class dP extends f{constructor(t){super(t,yA)}getParser(){return this.parser}}class gP extends f{constructor(t){super(t,LA)}getParser(){return this.parser}}class EP extends f{constructor(t){super(t,UA)}getParser(){return this.parser}}class fP extends f{constructor(t){super(t,vA)}getParser(){return this.parser}}class mP extends f{constructor(t){super(t,bA)}getParser(){return this.parser}}class IP extends f{constructor(t){super(t,FA)}getParser(){return this.parser}}class RP extends f{constructor(t){super(t,xA)}getParser(){return this.parser}}class TP extends f{constructor(t){super(t,GA)}getParser(){return this.parser}}class pP extends f{constructor(t){super(t,BA)}getParser(){return this.parser}}class rd extends f{constructor(t){super(t,wA)}getParser(){return this.parser}}class OP extends f{constructor(t){super(t,HA)}getParser(){return this.parser}}class AP extends f{constructor(t){super(t,VA)}getParser(){return this.parser}}class SP extends f{constructor(t){super(t,jA)}getParser(){return this.parser}}class MP extends f{constructor(t){super(t,_n)}getParser(){return this.parser}}class CP extends f{constructor(t){super(t,zA)}getParser(){return this.parser}}class NP extends f{constructor(t){super(t,Gs)}getParser(){return this.parser}}class DP extends f{constructor(t){super(t,ph)}getParser(){return this.parser}}class PP extends f{constructor(t){super(t,YA)}getParser(){return this.parser}}class yP extends f{constructor(t){super(t,WA)}getParser(){return this.parser}}class LP extends f{constructor(t){super(t,kA)}getParser(){return this.parser}}class UP extends f{constructor(t){super(t,KA)}getParser(){return this.parser}}class vP extends f{constructor(t){super(t,XA)}getParser(){return this.parser}}class bP extends f{constructor(t){super(t,QA)}getParser(){return this.parser}}class FP extends f{constructor(t){super(t,ZA)}getParser(){return this.parser}}class xP extends f{constructor(t){super(t,$A)}getParser(){return this.parser}}class GP extends f{constructor(t){super(t,tS)}getParser(){return this.parser}}class BP extends f{constructor(t){super(t,eS)}getParser(){return this.parser}}class wP extends f{constructor(t){super(t,Xc)}getParser(){return this.parser}}class HP extends f{constructor(t){super(t,sS)}getParser(){return this.parser}}class VP extends f{constructor(t){super(t,iS)}getParser(){return this.parser}}class nd extends f{constructor(t){super(t,rS)}getParser(){return this.parser}}class jP extends f{constructor(t){super(t,nS)}getParser(){return this.parser}}class zP extends f{constructor(t){super(t,aS)}getParser(){return this.parser}}class YP extends f{constructor(t){super(t,za)}getParser(){return this.parser}}class WP extends f{constructor(t){super(t,za)}getParser(){return this.parser}}class kP extends f{constructor(t){super(t,za)}getParser(){return this.parser}}class KP extends f{constructor(t){super(t,za)}getParser(){return this.parser}}class XP extends f{constructor(t){super(t,_S)}getParser(){return this.parser}}class qP extends f{constructor(t){super(t,hS)}getParser(){return this.parser}}class i_ extends f{constructor(t){super(t,uS)}getParser(){return this.parser}}class QP extends f{constructor(t){super(t,lS)}getParser(){return this.parser}}class JP extends f{constructor(t){super(t,cS)}getParser(){return this.parser}}class ZP extends f{constructor(t){super(t,dS)}getParser(){return this.parser}}class ad extends f{constructor(t){super(t,gS)}getParser(){return this.parser}}class $P extends f{constructor(t){super(t,ES)}getParser(){return this.parser}}class ty extends f{constructor(t){super(t,fS)}getParser(){return this.parser}}class ey extends f{constructor(t){super(t,mS)}getParser(){return this.parser}}class sy extends f{constructor(t){super(t,TS)}getParser(){return this.parser}}class iy extends f{constructor(t){super(t,pS)}getParser(){return this.parser}}class ry extends f{constructor(t){super(t,OS)}getParser(){return this.parser}}class ny extends f{constructor(t){super(t,AS)}getParser(){return this.parser}}class ay extends f{constructor(t){super(t,SS)}getParser(){return this.parser}}class oy extends f{constructor(t){super(t,MS)}getParser(){return this.parser}}class _y extends f{constructor(t){super(t,CS)}getParser(){return this.parser}}class hy extends f{constructor(t){super(t,NS)}getParser(){return this.parser}}class uy extends f{constructor(t){super(t,DS)}getParser(){return this.parser}}class ly extends f{constructor(t){super(t,PS)}getParser(){return this.parser}}class cy extends f{constructor(t){super(t,yS)}getParser(){return this.parser}}class dy extends f{constructor(t){super(t,LS)}getParser(){return this.parser}}class gy extends f{constructor(t){super(t,US)}getParser(){return this.parser}}class Ey extends f{constructor(t){super(t,vS)}getParser(){return this.parser}}class J{}J.LOGOUT=0;J.JUST_BANNED=1;J.CONCURRENT_LOGIN=2;J.CONNECTION_LOST_TO_PEER=3;J.AVATAR_IDENTITY_CHANGE=4;J.REMOVE_FURNITURE_TOOL=5;J.STILL_BANNED=10;J.DUAL_LOGIN_BY_USERID=11;J.HOTEL_CLOSED=12;J.DUAL_LOGIN_BY_IP=13;J.PEER_CONNECTION_MISSING=16;J.NO_LOGIN_PERMISSION=17;J.DUPLICATE_CONNECTION=18;J.HOTEL_CLOSING=19;J.INCORRECT_PASSWORD=20;J.INVALID_LOGIN_TICKET=22;J.VERSION_CHECK_URL=23;J.VERSION_CHECK_PROPERTY=24;J.VERSION_CHECK_MACHINE_ID=25;J.NO_MESSENGER_SESSION=26;J.USER_NOT_FOUND=27;J.CRYPTO_NOT_INITIALIZED=28;J.DEV_CRYPTO_NOT_ALLOWED=29;J.DUPLICATE_UUID_DETECTED=100;J.OLD_SESSION_IN_PROXY=101;J.PUBLIC_KEY_NOT_NUMERIC=102;J.PUBLIC_KEY_TOO_SHORT=103;J.SOCKET_READ_GENERIC=104;J.SOCKET_READ_FIRST_BYTE=105;J.SOCKET_READ_LENGTH=106;J.SOCKET_READ_BODY=107;J.SOCKET_READ_POLICY=108;J.SOCKET_IO_EXCEPTION=109;J.SOCKET_WRONG_CRYPTO=110;J.PROXY_RUNTIME_EXCEPTION=111;J.IDLE_CONNECTION=112;J.PONG_TIMEOUT=113;J.IDLE_CONNECTION_NOT_AUTH=114;J.IDLE_CONNECTION_NO_USER_ID=115;J.WRITE_CLOSED_CHANNEL=116;J.SOCKET_WRITE_EXCEPTION_1=117;J.SOCKET_WRITE_EXCEPTION_2=118;J.SOCKET_WRITE_EXCEPTION_3=119;class fy extends f{constructor(t){super(t,bS)}getParser(){return this.parser}get reasonString(){switch(this.getParser().reason){case J.JUST_BANNED:case J.STILL_BANNED:return"banned";case J.CONCURRENT_LOGIN:return"concurrentlogin";case J.INCORRECT_PASSWORD:return"incorrectpassword";default:return"logout"}}}class my extends f{constructor(t){super(t,FS)}getParser(){return this.parser}}class Iy extends f{constructor(t){super(t,xS)}getParser(){return this.parser}}class od extends f{constructor(t){super(t,GS)}getParser(){return this.parser}}class Ry extends f{constructor(t){super(t,BS)}getParser(){return this.parser}}class Ty extends f{constructor(t){super(t,wS)}getParser(){return this.parser}}class py extends f{constructor(t){super(t,HS)}getParser(){return this.parser}}class Oy extends f{constructor(t){super(t,VS)}getParser(){return this.parser}}class Ay extends f{constructor(t){super(t,jS)}getParser(){return this.parser}}class Sy extends f{constructor(t){super(t,zS)}getParser(){return this.parser}}class My extends f{constructor(t){super(t,YS)}getParser(){return this.parser}}class Cy extends f{constructor(t){super(t,WS)}getParser(){return this.parser}}class Ny extends f{constructor(t){super(t,kS)}getParser(){return this.parser}}class Dy extends f{constructor(t){super(t,Pi)}getParser(){return this.parser}}class Py extends f{constructor(t){super(t,KS)}getParser(){return this.parser}}class yy extends f{constructor(t){super(t,cn)}getParser(){return this.parser}}class Ly extends f{constructor(t){super(t,qS)}getParser(){return this.parser}}class Uy extends f{constructor(t){super(t,QS)}getParser(){return this.parser}}class _d extends f{constructor(t){super(t,JS)}getParser(){return this.parser}}class hd extends f{constructor(t){super(t,hr)}getParser(){return this.parser}}class vy extends f{constructor(t){super(t,ZS)}getParser(){return this.parser}}class by extends f{constructor(t){super(t,$S)}getParser(){return this.parser}}class Fy extends f{constructor(t){super(t,tM)}getParser(){return this.parser}}class xy extends f{constructor(t){super(t,eM)}getParser(){return this.parser}}class ud extends f{constructor(t){super(t,sM)}getParser(){return this.parser}}class Gy extends f{constructor(t){super(t,dn)}getParser(){return this.parser}}class By extends f{constructor(t){super(t,Ya)}getParser(){return this.parser}}class wy extends f{constructor(t){super(t,iM)}getParser(){return this.parser}}class Hy extends f{constructor(t){super(t,rM)}getParser(){return this.parser}}class Vy extends f{constructor(t){super(t,nM)}getParser(){return this.parser}}class jy extends f{constructor(t){super(t,aM)}getParser(){return this.parser}}class u{}u.ACHIEVEMENT_LIST=305;u.AUTHENTICATED=2491;u.AUTHENTICATION=-1;u.AVAILABILITY_STATUS=2033;u.BUILDERS_CLUB_EXPIRED=1452;u.CLUB_OFFERS=2405;u.CATALOG_PAGE=804;u.CATALOG_PAGE_LIST=1032;u.CATALOG_PURCHASE_OK=869;u.CATALOG_PURCHASE_ERROR=1404;u.CATALOG_PURCHASE_NOT_ALLOWED=3770;u.PRODUCT_OFFER=3388;u.LIMITED_SOLD_OUT=377;u.CATALOG_PUBLISHED=1866;u.CFH_RESULT_MESSAGE=3635;u.CLIENT_LATENCY=10;u.CLIENT_PING=3928;u.DESKTOP_CAMPAIGN=1745;u.DESKTOP_NEWS=286;u.DESKTOP_VIEW=122;u.BUNDLE_DISCOUNT_RULESET=2347;u.FIRST_LOGIN_OF_DAY=793;u.FURNITURE_ALIASES=1723;u.FURNITURE_DATA=2547;u.FURNITURE_FLOOR=1778;u.FURNITURE_FLOOR_ADD=1534;u.FURNITURE_FLOOR_REMOVE=2703;u.FURNITURE_FLOOR_UPDATE=3776;u.FURNITURE_ITEMDATA=2202;u.FURNITURE_STATE=2376;u.FURNITURE_GROUP_CONTEXT_MENU_INFO=3293;u.FURNITURE_POSTIT_STICKY_POLE_OPEN=2366;u.GAME_CENTER_ACHIEVEMENTS=2265;u.GAME_CENTER_GAME_LIST=222;u.GAME_CENTER_STATUS=2893;u.GAME_CENTER_IN_ARENA_QUEUE=872;u.GAME_CENTER_STOP_COUNTER=3191;u.GAME_CENTER_USER_LEFT_GAME=3138;u.GAME_CENTER_DIRECTORY_STATUS=2246;u.GAME_CENTER_STARTING_GAME_FAILED=2142;u.GAME_CENTER_JOINING_FAILED=1730;u.GAMESTATUSMESSAGE=3805;u.GAMEACHIEVEMENTS=1689;u.GAMEINVITE=904;u.JOININGQUEUEFAILED=3035;u.JOINEDQUEUEMESSAGE=2260;u.LEFTQUEUE=1477;u.LOAD_GAME_URL=2624;u.LOADGAME=3654;u.UNLOADGAME=1715;u.ACHIEVEMENTRESOLUTIONCOMPLETED=740;u.ACHIEVEMENTRESOLUTIONPROGRESS=3370;u.ACHIEVEMENTRESOLUTIONS=66;u.GENERIC_ALERT=3801;u.MODERATOR_MESSAGE=2030;u.GENERIC_ERROR=1600;u.GIFT_WRAPPER_CONFIG=2234;u.GROUP_BADGES=2402;u.GROUP_CREATE_OPTIONS=2159;u.GROUP_FORUM_DATA=3011;u.GROUP_FORUM_LIST=3001;u.GROUP_FORUM_THREADS=1073;u.GROUP_FORUM_POST=2049;u.GROUP_FORUM_POST_THREAD=1862;u.GROUP_FORUM_THREAD_MESSAGES=509;u.GROUP_FORUM_UNREAD_COUNT=2379;u.GROUP_FORUM_UPDATE_MESSAGE=324;u.GROUP_FORUM_UPDATE_THREAD=2528;u.GROUP_INFO=1702;u.GROUP_LIST=420;u.GROUP_MEMBER=265;u.GROUP_MEMBERS=1200;u.GROUP_MEMBERS_REFRESH=2445;u.GROUP_MEMBER_REMOVE_CONFIRM=1876;u.GROUP_PURCHASED=2808;u.GROUP_SETTINGS=3965;u.GROUP_BADGE_PARTS=2238;u.GROUP_MEMBERSHIP_REQUESTED=1180;u.GROUP_DETAILS_CHANGED=1459;u.GROUP_HABBO_JOIN_FAILED=762;u.GUILD_EDIT_FAILED=3988;u.GUILD_MEMBER_MGMT_FAILED=818;u.ITEM_DIMMER_SETTINGS=2710;u.ITEM_STACK_HELPER=2816;u.ITEM_WALL=1369;u.ITEM_WALL_ADD=2187;u.ITEM_WALL_REMOVE=3208;u.ITEM_WALL_UPDATE=2009;u.MARKETPLACE_CONFIG=1823;u.MESSENGER_ACCEPT_FRIENDS=896;u.MESSENGER_CHAT=1587;u.MESSENGER_FIND_FRIENDS=1210;u.MESSENGER_FOLLOW_FAILED=3048;u.MESSENGER_FRIEND_NOTIFICATION=3082;u.MESSENGER_FRIENDS=3130;u.MESSENGER_INIT=1605;u.MESSENGER_INSTANCE_MESSAGE_ERROR=3359;u.MESSENGER_INVITE=3870;u.MESSENGER_INVITE_ERROR=462;u.MESSENGER_MESSAGE_ERROR=892;u.MESSENGER_MINIMAIL_COUNT=2803;u.MESSENGER_MINIMAIL_NEW=1911;u.MESSENGER_RELATIONSHIPS=2016;u.MESSENGER_REQUEST=2219;u.MESSENGER_REQUEST_ERROR=892;u.MESSENGER_REQUESTS=280;u.MESSENGER_SEARCH=973;u.MESSENGER_UPDATE=2800;u.MODERATION_REPORT_DISABLED=1651;u.MODERATION_TOOL=2696;u.MODERATION_USER_INFO=2866;u.MOTD_MESSAGES=2035;u.NAVIGATOR_CATEGORIES=1562;u.NAVIGATOR_COLLAPSED=1543;u.NAVIGATOR_EVENT_CATEGORIES=3244;u.NAVIGATOR_LIFTED=3104;u.NAVIGATOR_METADATA=3052;u.NAVIGATOR_OPEN_ROOM_CREATOR=2064;u.NAVIGATOR_SEARCH=2690;u.NAVIGATOR_SEARCHES=3984;u.NAVIGATOR_SETTINGS=518;u.THUMBNAIL_UPDATE_RESULT=1927;u.CAN_CREATE_ROOM=378;u.CATEGORIES_WITH_VISITOR_COUNT=1455;u.COMPETITION_ROOMS_DATA=3954;u.CONVERTED_ROOM_ID=1331;u.GUEST_ROOM_SEARCH_RESULT=52;u.NOTIFICATION_LIST=1992;u.NOTIFICATION_SIMPLE_ALERT=5100;u.NOTIFICATION_ELEMENT_POINTER=1787;u.PET_FIGURE_UPDATE=1924;u.PET_INFO=2901;u.PET_TRAINING_PANEL=1164;u.PET_LEVEL_UPDATE=2824;u.PET_SCRATCH_FAILED=1130;u.PET_OPEN_PACKAGE_REQUESTED=2380;u.PET_OPEN_PACKAGE_RESULT=546;u.PET_BREEDING=1746;u.PET_CONFIRM_BREEDING_RESULT=1625;u.PET_GO_TO_BREEDING_NEST_FAILURE=2621;u.PET_NEST_BREEDING_SUCCESS=2527;u.PET_CONFIRM_BREEDING_REQUEST=634;u.PET_BREEDING_RESULT=1553;u.RECYCLER_PRIZES=3164;u.RECYCLER_STATUS=3433;u.RECYCLER_FINISHED=468;u.ROOM_BAN_LIST=1869;u.ROOM_BAN_REMOVE=3429;u.ROOM_CREATED=1304;u.ROOM_DOORBELL=2309;u.ROOM_DOORBELL_ACCEPTED=3783;u.ROOM_DOORBELL_REJECTED=878;u.ROOM_ENTER=758;u.ROOM_ENTER_ERROR=899;u.ROOM_FORWARD=160;u.ROOM_HEIGHT_MAP=2753;u.ROOM_HEIGHT_MAP_UPDATE=558;u.ROOM_INFO=687;u.ROOM_INFO_OWNER=749;u.ROOM_MODEL=1301;u.ROOM_MODEL_BLOCKED_TILES=3990;u.ROOM_MODEL_DOOR=1664;u.ROOM_MODEL_NAME=2031;u.ROOM_MUTED=2533;u.ROOM_MUTE_USER=826;u.ROOM_PAINT=2454;u.ROOM_PROMOTION=2274;u.ROOM_QUEUE_STATUS=2208;u.ROOM_RIGHTS=780;u.ROOM_RIGHTS_CLEAR=2392;u.ROOM_RIGHTS_LIST=1284;u.ROOM_RIGHTS_LIST_ADD=2088;u.ROOM_RIGHTS_LIST_REMOVE=1327;u.ROOM_RIGHTS_OWNER=339;u.ROOM_ROLLING=3207;u.ROOM_SCORE=482;u.ROOM_SETTINGS=1498;u.ROOM_SETTINGS_CHAT=1191;u.ROOM_SETTINGS_SAVE=948;u.ROOM_SETTINGS_SAVE_ERROR=1555;u.ROOM_INFO_UPDATED=3297;u.ROOM_SPECTATOR=1033;u.ROOM_THICKNESS=3547;u.ROOM_GET_FILTER_WORDS=2937;u.ROOM_MESSAGE_NOTIFICATION=1634;u.ROOM_POPULAR_TAGS_RESULT=2012;u.INFO_FEED_ENABLE=3284;u.SECURITY_MACHINE=1488;u.MYSTERY_BOX_KEYS=2833;u.GOTMYSTERYBOXPRIZEMESSAGE=3712;u.CANCELMYSTERYBOXWAITMESSAGE=596;u.SHOWMYSTERYBOXWAITMESSAGE=3201;u.TRADE_ACCEPTED=2568;u.TRADE_CLOSED=1373;u.TRADE_COMPLETED=1001;u.TRADE_CONFIRMATION=2720;u.TRADE_LIST_ITEM=2024;u.TRADE_NOT_OPEN=3128;u.TRADE_OPEN=2505;u.TRADE_OPEN_FAILED=217;u.TRADE_OTHER_NOT_ALLOWED=1254;u.TRADE_YOU_NOT_ALLOWED=3058;u.TRADE_NO_SUCH_ITEM=2873;u.UNIT=374;u.UNIT_CHANGE_NAME=2182;u.UNIT_CHAT=1446;u.UNIT_CHAT_SHOUT=1036;u.UNIT_CHAT_WHISPER=2704;u.UNIT_DANCE=2233;u.UNIT_EFFECT=1167;u.UNIT_EXPRESSION=1631;u.UNIT_HAND_ITEM=1474;u.UNIT_IDLE=1797;u.UNIT_INFO=3920;u.UNIT_NUMBER=2324;u.UNIT_REMOVE=2661;u.UNIT_STATUS=1640;u.UNIT_TYPING=1717;u.UNSEEN_ITEMS=2103;u.USER_ACHIEVEMENT_SCORE=1968;u.USER_BADGES=717;u.USER_BADGES_ADD=2493;u.USER_BADGES_CURRENT=1087;u.USER_BOT_REMOVE=233;u.USER_BOTS=3086;u.USER_CHANGE_NAME=118;u.USER_CLOTHING=1450;u.USER_CREDITS=3475;u.USER_CURRENCY=2018;u.ACTIVITY_POINT_NOTIFICATION=2275;u.USER_EFFECTS=340;u.USER_FAVORITE_ROOM=2524;u.USER_FAVORITE_ROOM_COUNT=151;u.USER_FIGURE=2429;u.USER_FURNITURE=994;u.USER_FURNITURE_ADD=104;u.USER_FURNITURE_POSTIT_PLACED=1501;u.USER_FURNITURE_REFRESH=3151;u.USER_FURNITURE_REMOVE=159;u.USER_HOME_ROOM=2875;u.ROOM_EVENT_CANCEL=3479;u.ROOM_EVENT=1840;u.USER_IGNORED=126;u.USER_IGNORED_RESULT=207;u.USER_INFO=2725;u.USER_OUTFITS=3315;u.USER_PERKS=2586;u.USER_PERMISSIONS=411;u.USER_PET_ADD=2101;u.USER_PET_REMOVE=3253;u.USER_PETS=3522;u.USER_PROFILE=3898;u.USER_RESPECT=2815;u.USER_SANCTION_STATUS=3679;u.USER_SETTINGS=513;u.USER_SUBSCRIPTION=954;u.USER_WARDROBE_PAGE=3315;u.USER_CLASSIFICATION=966;u.GET_USER_TAGS=1255;u.WIRED_ACTION=1434;u.WIRED_CONDITION=1108;u.WIRED_ERROR=156;u.WIRED_OPEN=1830;u.WIRED_REWARD=178;u.WIRED_SAVE=1155;u.WIRED_TRIGGER=383;u.PLAYING_GAME=448;u.FURNITURE_STATE_2=3431;u.REMOVE_BOT_FROM_INVENTORY=233;u.ADD_BOT_TO_INVENTORY=1352;u.ACHIEVEMENT_PROGRESSED=2107;u.MODTOOL_ROOM_INFO=1333;u.MODTOOL_USER_CHATLOG=3377;u.MODTOOL_ROOM_CHATLOG=3434;u.MODTOOL_VISITED_ROOMS_USER=1752;u.MODERATOR_ACTION_RESULT=2335;u.ISSUE_DELETED=3192;u.ISSUE_INFO=3609;u.ISSUE_PICK_FAILED=3150;u.CFH_CHATLOG=607;u.MODERATOR_TOOL_PREFERENCES=1576;u.LOVELOCK_FURNI_START=3753;u.LOVELOCK_FURNI_FRIEND_COMFIRMED=382;u.LOVELOCK_FURNI_FINISHED=770;u.GIFT_RECEIVER_NOT_FOUND=1517;u.GIFT_OPENED=56;u.FLOOD_CONTROL=566;u.REMAINING_MUTE=826;u.USER_EFFECT_LIST=340;u.USER_EFFECT_LIST_ADD=2867;u.USER_EFFECT_LIST_REMOVE=2228;u.USER_EFFECT_ACTIVATE=1959;u.AVATAR_EFFECT_SELECTED=3473;u.CLUB_GIFT_INFO=619;u.REDEEM_VOUCHER_ERROR=714;u.REDEEM_VOUCHER_OK=3336;u.IN_CLIENT_LINK=2023;u.BOT_COMMAND_CONFIGURATION=1618;u.BOT_SKILL_LIST_UPDATE=69;u.BOT_FORCE_OPEN_CONTEXT_MENU=296;u.HAND_ITEM_RECEIVED=354;u.PET_PLACING_ERROR=2913;u.BOT_ERROR=639;u.MARKETPLACE_SELL_ITEM=54;u.MARKETPLACE_ITEM_STATS=725;u.MARKETPLACE_OWN_ITEMS=3884;u.MARKETPLACE_CANCEL_SALE=3264;u.MARKETPLACE_ITEM_POSTED=1359;u.MARKETPLACE_ITEMS_SEARCHED=680;u.MARKETPLACE_AFTER_ORDER_STATUS=2032;u.CATALOG_RECEIVE_PET_BREEDS=3331;u.CATALOG_APPROVE_NAME_RESULT=1503;u.OBJECTS_DATA_UPDATE=1453;u.PET_EXPERIENCE=2156;u.COMMUNITY_GOAL_VOTE_EVENT=1435;u.PROMO_ARTICLES=286;u.COMMUNITY_GOAL_EARNED_PRIZES=3319;u.COMMUNITY_GOAL_PROGRESS=2525;u.CONCURRENT_USERS_GOAL_PROGRESS=2737;u.QUEST_DAILY=1878;u.QUEST_CANCELLED=3027;u.QUEST_COMPLETED=949;u.COMMUNITY_GOAL_HALL_OF_FAME=3005;u.EPIC_POPUP=3945;u.SEASONAL_QUESTS=1122;u.QUESTS=3625;u.QUEST=230;u.BONUS_RARE_INFO=1533;u.CRAFTABLE_PRODUCTS=1e3;u.CRAFTING_RECIPE=2774;u.CRAFTING_RECIPES_AVAILABLE=2124;u.CRAFTING_RESULT=618;u.CAMERA_PUBLISH_STATUS=2057;u.CAMERA_PURCHASE_OK=2783;u.CAMERA_STORAGE_URL=3696;u.COMPETITION_STATUS=133;u.INIT_CAMERA=3878;u.THUMBNAIL_STATUS=3595;u.ACHIEVEMENT_NOTIFICATION=806;u.CLUB_GIFT_NOTIFICATION=2188;u.INTERSTITIAL_MESSAGE=1808;u.ROOM_AD_ERROR=1759;u.AVAILABILITY_TIME=600;u.HOTEL_CLOSED_AND_OPENS=3728;u.HOTEL_CLOSES_AND_OPENS_AT=2771;u.HOTEL_WILL_CLOSE_MINUTES=1050;u.HOTEL_MAINTENANCE=1350;u.JUKEBOX_PLAYLIST_FULL=105;u.JUKEBOX_SONG_DISKS=34;u.NOW_PLAYING=469;u.OFFICIAL_SONG_ID=1381;u.PLAYLIST=1748;u.PLAYLIST_SONG_ADDED=1140;u.TRAX_SONG_INFO=3365;u.USER_SONG_DISKS_INVENTORY=2602;u.CHECK_USER_NAME=563;u.CFH_SANCTION=2782;u.CFH_TOPICS=325;u.CFH_SANCTION_STATUS=2221;u.CAMPAIGN_CALENDAR_DATA=2531;u.CAMPAIGN_CALENDAR_DOOR_OPENED=2551;u.BUILDERS_CLUB_FURNI_COUNT=3828;u.BUILDERS_CLUB_SUBSCRIPTION=1452;u.CATALOG_PAGE_EXPIRATION=2668;u.CATALOG_EARLIEST_EXPIRY=2515;u.CLUB_GIFT_SELECTED=659;u.TARGET_OFFER_NOT_FOUND=1237;u.TARGET_OFFER=119;u.DIRECT_SMS_CLUB_BUY=195;u.ROOM_AD_PURCHASE=2468;u.NOT_ENOUGH_BALANCE=3914;u.LIMITED_OFFER_APPEARING_NEXT=44;u.IS_OFFER_GIFTABLE=761;u.CLUB_EXTENDED_OFFER=3964;u.SEASONAL_CALENDAR_OFFER=1889;u.COMPETITION_ENTRY_SUBMIT=1177;u.COMPETITION_VOTING_INFO=3506;u.COMPETITION_TIMING_CODE=1745;u.COMPETITION_USER_PART_OF=3841;u.COMPETITION_NO_OWNED_ROOMS=2064;u.COMPETITION_SECONDS_UNTIL=3926;u.BADGE_POINT_LIMITS=2501;u.BADGE_REQUEST_FULFILLED=2998;u.HELPER_TALENT_TRACK=3406;u.TALENT_TRACK_LEVEL=1203;u.TALENT_TRACK_LEVEL_UP=638;u.USER_BANNED=1683;u.BOT_RECEIVED=3684;u.PET_LEVEL_NOTIFICATION=859;u.PET_RECEIVED=1111;u.MODERATION_CAUTION=1890;u.YOUTUBE_CONTROL_VIDEO=1554;u.YOUTUBE_DISPLAY_PLAYLISTS=1112;u.YOUTUBE_DISPLAY_VIDEO=1411;u.CFH_DISABLED_NOTIFY=1651;u.QUESTION=2665;u.POLL_CONTENTS=2997;u.POLL_ERROR=662;u.POLL_OFFER=3785;u.QUESTION_ANSWERED=2589;u.QUESTION_FINISHED=1066;u.CFH_PENDING_CALLS=1121;u.GUIDE_ON_DUTY_STATUS=1548;u.GUIDE_SESSION_ATTACHED=1591;u.GUIDE_SESSION_DETACHED=138;u.GUIDE_SESSION_ENDED=1456;u.GUIDE_SESSION_ERROR=673;u.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM=219;u.GUIDE_SESSION_MESSAGE=841;u.GUIDE_SESSION_PARTNER_IS_TYPING=1016;u.GUIDE_SESSION_REQUESTER_ROOM=1847;u.GUIDE_SESSION_STARTED=3209;u.GUIDE_TICKET_CREATION_RESULT=3285;u.GUIDE_TICKET_RESOLUTION=2674;u.GUIDE_REPORTING_STATUS=3463;u.HOTEL_MERGE_NAME_CHANGE=1663;u.ISSUE_CLOSE_NOTIFICATION=934;u.QUIZ_DATA=2927;u.QUIZ_RESULTS=2772;u.CFH_PENDING_CALLS_DELETED=77;u.CFH_REPLY=3796;u.CHAT_REVIEW_SESSION_DETACHED=30;u.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE=735;u.CHAT_REVIEW_SESSION_RESULTS=3276;u.CHAT_REVIEW_SESSION_STARTED=143;u.CHAT_REVIEW_SESSION_VOTING_STATUS=1829;u.SCR_SEND_KICKBACK_INFO=3277;u.PET_STATUS=1907;u.GROUP_DEACTIVATE=3129;u.PET_RESPECTED=2788;u.PET_SUPPLEMENT=3441;u.NOOBNESS_LEVEL=3738;u.DISCONNECT_REASON=4e3;u.CAN_CREATE_ROOM_EVENT=2599;u.FAVORITE_GROUP_UDPATE=3403;u.NO_SUCH_FLAT=84;u.ROOM_SETTINGS_ERROR=2897;u.SHOW_ENFORCE_ROOM_CATEGORY=3896;u.CUSTOM_USER_NOTIFICATION=909;u.NEW_USER_EXPERIENCE_GIFT_OFFER=3575;u.NEW_USER_EXPERIENCE_NOT_COMPLETE=3639;u.CONNECTION_ERROR=1004;u.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE=1243;u.PHONE_COLLECTION_STATE=2890;u.PHONE_TRY_NUMBER_RESULT=800;u.PHONE_TRY_VERIFICATION_CODE_RESULT=91;u.EXTENDED_PROFILE_CHANGED=876;u.WELCOME_GIFT_CHANGE_EMAIL_RESULT=2293;u.WELCOME_GIFT_STATUS=2707;u.HANDSHAKE_INIT_DIFFIE=1347;u.HANDSHAKE_COMPLETE_DIFFIE=3885;u.RENTABLE_SPACE_RENT_OK=2046;u.RENTABLE_SPACE_STATUS=3559;u.RENTABLE_SPACE_RENT_FAILED=1868;u.EMAIL_STATUS=612;u.CHANGE_EMAIL_RESULT=1815;u.WEEKLY_GAME_REWARD=2641;u.WEEKLY_GAME_REWARD_WINNERS=3097;u.WEEKLY_COMPETITIVE_LEADERBOARD=3512;u.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD=3560;u.WEEKLY_GAME2_FRIENDS_LEADERBOARD=2270;u.WEEKLY_GAME2_LEADERBOARD=2196;u.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER=35;u.HANDSHAKE_IDENTITY_ACCOUNT=3523;class zy extends f{constructor(t){super(t,CT)}getParser(){return this.parser}}class Yy extends f{constructor(t){super(t,DT)}getParser(){return this.parser}}class Wy extends f{constructor(t){super(t,PT)}getParser(){return this.parser}}class ky extends f{constructor(t){super(t,LT)}getParser(){return this.parser}}class Ky extends f{constructor(t){super(t,UT)}getParser(){return this.parser}}class Xy extends f{constructor(t){super(t,vT)}getParser(){return this.parser}}class qy extends f{constructor(t){super(t,bT)}getParser(){return this.parser}}class Qy extends f{constructor(t){super(t,FT)}getParser(){return this.parser}}class ld extends f{constructor(t){super(t,GT)}getParser(){return this.parser}}class Jy extends f{constructor(t){super(t,BT)}getParser(){return this.parser}}class Zy extends f{constructor(t){super(t,wT)}getParser(){return this.parser}}class $y extends f{constructor(t){super(t,HT)}getParser(){return this.parser}}class tL extends f{constructor(t){super(t,VT)}getParser(){return this.parser}}class eL extends f{constructor(t){super(t,CO)}getParser(){return this.parser}}class sL extends f{constructor(t){super(t,DO)}getParser(){return this.parser}}class iL extends f{constructor(t){super(t,NO)}getParser(){return this.parser}}class rL extends f{constructor(t){super(t,PO)}getParser(){return this.parser}}class nL extends f{constructor(t){super(t,yO)}getParser(){return this.parser}}class cd extends f{constructor(t){super(t,LO)}getParser(){return this.parser}}class aL extends f{constructor(t){super(t,UO)}getParser(){return this.parser}}class oL extends f{constructor(t){super(t,vO)}getParser(){return this.parser}}class _L extends f{constructor(t){super(t,bO)}getParser(){return this.parser}}class hL extends f{constructor(t){super(t,FO)}getParser(){return this.parser}}class uL extends f{constructor(t){super(t,xO)}getParser(){return this.parser}}class lL extends f{constructor(t){super(t,GO)}getParser(){return this.parser}}class cL extends f{constructor(t){super(t,BO)}getParser(){return this.parser}}class dL extends f{constructor(t){super(t,HO)}get userID(){return this.getParser().userID}get userAccepts(){return this.getParser().userAccepts}getParser(){return this.parser}}class gL extends f{constructor(t){super(t,Yc)}get userID(){return this.getParser().userID}getParser(){return this.parser}}class EL extends f{constructor(t){super(t,VO)}getParser(){return this.parser}}class fL extends f{constructor(t){super(t,jO)}getParser(){return this.parser}}class mL extends f{constructor(t){super(t,zO)}get firstUserID(){return this.getParser().firstUserID}get secondUserID(){return this.getParser().secondUserID}get firstUserNumItems(){return this.getParser().firstUserNumItems}get secondUserNumItems(){return this.getParser().secondUserNumItems}get firstUserNumCredits(){return this.getParser().firstUserNumCredits}get secondUserNumCredits(){return this.getParser().secondUserNumCredits}get firstUserItemArray(){return this.getParser().firstUserItemArray}get secondUserItemArray(){return this.getParser().secondUserItemArray}getParser(){return this.parser}}class IL extends f{constructor(t){super(t,YO)}getParser(){return this.parser}}class RL extends f{constructor(t){super(t,WO)}getParser(){return this.parser}}class TL extends f{constructor(t){super(t,kO)}get userID(){return this.getParser().userID}get userCanTrade(){return this.getParser().userCanTrade}get otherUserID(){return this.getParser().otherUserID}get otherUserCanTrade(){return this.getParser().otherUserCanTrade}getParser(){return this.parser}}class pL extends f{constructor(t){super(t,Th)}getParser(){return this.parser}}class OL extends f{constructor(t){super(t,KO)}getParser(){return this.parser}}class AL extends f{constructor(t){super(t,XO)}getParser(){return this.parser}}class SL extends f{constructor(t){super(t,oM)}getParser(){return this.parser}}class ML extends f{constructor(t){super(t,_M)}getParser(){return this.parser}}class CL extends f{constructor(t){super(t,hM)}getParser(){return this.parser}}class NL extends f{constructor(t){super(t,uM)}getParser(){return this.parser}}class DL extends f{constructor(t){super(t,lM)}getParser(){return this.parser}}class PL extends f{constructor(t){super(t,cM)}getParser(){return this.parser}}class yL extends f{constructor(t){super(t,gM)}getParser(){return this.parser}}class LL extends f{constructor(t){super(t,dM)}getParser(){return this.parser}}class UL extends f{constructor(t){super(t,EM)}getParser(){return this.parser}}class vL extends f{constructor(t){super(t,fM)}getParser(){return this.parser}}class bL extends f{constructor(t){super(t,RM)}getParser(){return this.parser}}class FL extends f{constructor(t){super(t,TM)}getParser(){return this.parser}}class xL extends f{constructor(t){super(t,Zc)}getParser(){return this.parser}}class GL extends f{constructor(t){super(t,OM)}getParser(){return this.parser}}class BL extends f{constructor(t){super(t,SM)}getParser(){return this.parser}}class wL extends f{constructor(t){super(t,AM)}getParser(){return this.parser}}class HL extends f{constructor(t){super(t,CM)}getParser(){return this.parser}}class VL extends f{constructor(t){super(t,NM)}getParser(){return this.parser}}class jL extends f{constructor(t){super(t,yM)}getParser(){return this.parser}}class zL extends f{constructor(t){super(t,LM)}getParser(){return this.parser}}class YL extends f{constructor(t){super(t,vM)}getParser(){return this.parser}}class WL extends f{constructor(t){super(t,bM)}getParser(){return this.parser}}class kL extends f{constructor(t){super(t,GM)}getParser(){return this.parser}}class KL extends f{constructor(t){super(t,BM)}getParser(){return this.parser}}class XL extends f{constructor(t){super(t,HM)}getParser(){return this.parser}}class qL extends f{constructor(t){super(t,VM)}getParser(){return this.parser}}class QL extends f{constructor(t){super(t,jM)}getParser(){return this.parser}}class dd extends f{constructor(t){super(t,zM)}getParser(){return this.parser}}class JL extends f{constructor(t){super(t,YM)}getParser(){return this.parser}}class ZL extends f{constructor(t){super(t,Sh)}getParser(){return this.parser}}class $L extends f{constructor(t){super(t,WM)}getParser(){return this.parser}}class tU extends f{constructor(t){super(t,tC)}getParser(){return this.parser}}class eU extends f{constructor(t){super(t,eC)}getParser(){return this.parser}}class sU extends f{constructor(t){super(t,sC)}getParser(){return this.parser}}class gd extends f{constructor(t){super(t,iC)}getParser(){return this.parser}get userName(){return this.getParser().userName}}class iU extends f{constructor(t){super(t,rC)}getParser(){return this.parser}}class rU extends f{constructor(t){super(t,nC)}getParser(){return this.parser}}class r_ extends f{constructor(t){super(t,aC)}getParser(){return this.parser}}class nU extends f{constructor(t){super(t,oC)}getParser(){return this.parser}}class n_ extends f{constructor(t){super(t,_C)}getParser(){return this.parser}}class aU extends f{constructor(t){super(t,hC)}getParser(){return this.parser}}class oU extends f{constructor(t){super(t,lC)}getParser(){return this.parser}}class _U extends f{constructor(t){super(t,dC)}getParser(){return this.parser}}class hU extends f{constructor(t){super(t,EC)}getParser(){return this.parser}}class uU extends f{constructor(t){super(t,fC)}getParser(){return this.parser}}class lU extends f{constructor(t){super(t,mC)}getParser(){return this.parser}}class cU extends f{constructor(t){super(t,IC)}getParser(){return this.parser}}class dU extends f{constructor(t){super(t,RC)}getParser(){return this.parser}}class gU extends f{constructor(t){super(t,TC)}getParser(){return this.parser}}class EU extends f{constructor(t){super(t,AC)}getParser(){return this.parser}}class fU extends f{constructor(t){super(t,SC)}getParser(){return this.parser}}class mU extends f{constructor(t){super(t,MC)}getParser(){return this.parser}}class IU extends f{constructor(t){super(t,CC)}getParser(){return this.parser}}class RU extends f{constructor(t){super(t,NC)}getParser(){return this.parser}}class TU extends f{constructor(t){super(t,DC)}getParser(){return this.parser}}class pU extends f{constructor(t){super(t,PC)}getParser(){return this.parser}}class OU extends f{constructor(t){super(t,yC)}getParser(){return this.parser}}class AU extends f{constructor(t){super(t,UC)}getParser(){return this.parser}}class SU extends f{constructor(t){super(t,vC)}getParser(){return this.parser}}class Ed extends f{constructor(t){super(t,bC)}getParser(){return this.parser}}class MU extends f{constructor(t){super(t,FC)}getParser(){return this.parser}}class CU extends f{constructor(t){super(t,xC)}getParser(){return this.parser}}class NU extends f{constructor(t){super(t,GC)}getParser(){return this.parser}}class DU extends f{constructor(t){super(t,BC)}getParser(){return this.parser}}class PU extends f{constructor(t){super(t,wC)}getParser(){return this.parser}}class yU extends f{constructor(t){super(t,HC)}getParser(){return this.parser}}class LU extends f{constructor(t){super(t,VC)}getParser(){return this.parser}}class UU extends f{constructor(t){super(t,jC)}getParser(){return this.parser}}class fd extends f{constructor(t){super(t,zC)}getParser(){return this.parser}}class vU extends f{constructor(t){super(t,YC)}getParser(){return this.parser}}class bU extends f{constructor(t){super(t,WC)}getParser(){return this.parser}}class FU{constructor(t){this._itemName=t.readString(),this._extraInfo=t.readString(),this._extraInfo==""&&(this._extraInfo=null)}get itemName(){return this._itemName}get extraInfo(){return this._extraInfo}}class xU{constructor(t){this._thumbnailUrl=t.readString(),this._thumbnailUrl==""&&(this._thumbnailUrl=null),this._productOfferList=[];const e=t.readInt();let s=0;for(;s<e;)this._productOfferList.push(new FU(t)),s++}get productOfferList(){return this._productOfferList}get thumbnailUrl(){return this._thumbnailUrl}}class GU{flush(){return!0}parse(t){if(!t)return!1;const e=t.readInt();this._giftOptions=[];let s=0;for(;s<e;)this._giftOptions.push(new HU(t)),s++;return!0}get giftOptions(){return this._giftOptions}}class BU{flush(){return!0}parse(t){return!!t}}class wU extends f{constructor(t){super(t,GU)}getParser(){return this.parser}}class HU{constructor(t){this._dayIndex=t.readInt(),this._stepIndex=t.readInt(),this._options=[];const e=t.readInt();let s=0;for(;s<e;)this._options.push(new xU(t)),s++}get dayIndex(){return this._dayIndex}get stepIndex(){return this._stepIndex}get options(){return this._options}}class VU extends f{constructor(t){super(t,BU)}getParser(){return this.parser}}class jU extends f{constructor(t){super(t,KC)}getParser(){return this.parser}}class zU extends f{constructor(t){super(t,Va)}getParser(){return this.parser}}class md extends f{constructor(t){super(t,XC)}getParser(){return this.parser}}class Id extends f{constructor(t){super(t,qC)}getParser(){return this.parser}}class Rd extends f{constructor(t){super(t,QC)}getParser(){return this.parser}}class Td extends f{constructor(t){super(t,JC)}getParser(){return this.parser}}class YU extends f{constructor(t){super(t,ZC)}getParser(){return this.parser}}class pd extends f{constructor(t){super(t,eN)}getParser(){return this.parser}}class Od extends f{constructor(t){super(t,sN)}getParser(){return this.parser}}class Ad extends f{constructor(t){super(t,iN)}getParser(){return this.parser}}class Sd extends f{constructor(t){super(t,rN)}getParser(){return this.parser}}class Md extends f{constructor(t){super(t,aN)}getParser(){return this.parser}}class Cd extends f{constructor(t){super(t,nN)}getParser(){return this.parser}}class WU extends f{constructor(t){super(t,hN)}getParser(){return this.parser}}class kU extends f{constructor(t){super(t,cN)}getParser(){return this.parser}}class KU extends f{constructor(t){super(t,dN)}getParser(){return this.parser}}class XU extends f{constructor(t){super(t,gN)}getParser(){return this.parser}}class qU extends f{constructor(t){super(t,EN)}getParser(){return this.parser}}class QU extends f{constructor(t){super(t,fN)}getParser(){return this.parser}}class JU extends f{constructor(t){super(t,mN)}getParser(){return this.parser}}class ZU extends f{constructor(t){super(t,IN)}getParser(){return this.parser}}class $U extends f{constructor(t){super(t,RN)}getParser(){return this.parser}}class tv extends f{constructor(t){super(t,TN)}getParser(){return this.parser}}class ev extends f{constructor(t){super(t,pN)}getParser(){return this.parser}}class Ch extends f{constructor(t){super(t,ON)}getParser(){return this.parser}}Ch.FINISHED_OK=1;Ch.FINISHED_FAIL=2;class qa extends f{constructor(t){super(t,AN)}getParser(){return this.parser}}qa.SYSTEM_STATUS_ENABLED=1;qa.SYSTEM_STATUS_DISABLED=2;qa.SYSTEM_STATUS_TIMEOUT=3;class a_ extends f{constructor(t){super(t,jT)}getParser(){return this.parser}}class o_ extends f{constructor(t){super(t,zT)}getParser(){return this.parser}}class __ extends f{constructor(t){super(t,WT)}getParser(){return this.parser}}class h_ extends f{constructor(t){super(t,YT)}getParser(){return this.parser}}class sv extends f{constructor(t){super(t,an)}getParser(){return this.parser}}class u_ extends f{constructor(t){super(t,kT)}getParser(){return this.parser}}class iv extends f{constructor(t){super(t,KT)}getParser(){return this.parser}}class rv extends f{constructor(t){super(t,XT)}getParser(){return this.parser}}class nv extends f{constructor(t){super(t,qT)}getParser(){return this.parser}}class av extends f{constructor(t){super(t,JT)}getParser(){return this.parser}}class ov extends f{constructor(t){super(t,cp)}getParser(){return this.parser}}class _v extends f{constructor(t){super(t,dp)}getParser(){return this.parser}}class hv extends f{constructor(t){super(t,gp)}getParser(){return this.parser}}class Nd extends f{constructor(t){super(t,Ep)}getParser(){return this.parser}}class l_ extends f{constructor(t){super(t,Xp)}getParser(){return this.parser}}class c_ extends f{constructor(t){super(t,qp)}getParser(){return this.parser}}class uv extends f{constructor(t){super(t,mp)}getParser(){return this.parser}}class d_ extends f{constructor(t){super(t,Ip)}getParser(){return this.parser}}class g_ extends f{constructor(t){super(t,Rp)}getParser(){return this.parser}}class E_ extends f{constructor(t){super(t,Tp)}getParser(){return this.parser}}class f_ extends f{constructor(t){super(t,pp)}getParser(){return this.parser}}class m_ extends f{constructor(t){super(t,Op)}getParser(){return this.parser}}class lv extends f{constructor(t){super(t,Ap)}getParser(){return this.parser}}class I_ extends f{constructor(t){super(t,Sp)}getParser(){return this.parser}}class R_ extends f{constructor(t){super(t,ni)}getParser(){return this.parser}}class cv extends f{constructor(t){super(t,Mp)}getParser(){return this.parser}}class dv extends f{constructor(t){super(t,Cp)}getParser(){return this.parser}}class T_ extends f{constructor(t){super(t,Np)}getParser(){return this.parser}}class gv extends f{constructor(t){super(t,Dp)}getParser(){return this.parser}}class Ev extends f{constructor(t){super(t,Pp)}getParser(){return this.parser}}class fv extends f{constructor(t){super(t,yp)}getParser(){return this.parser}}class p_ extends f{constructor(t){super(t,Lp)}getParser(){return this.parser}}class mv extends f{constructor(t){super(t,Up)}getParser(){return this.parser}}class Iv extends f{constructor(t){super(t,vp)}getParser(){return this.parser}}class Rv extends f{constructor(t){super(t,bp)}getParser(){return this.parser}}class Tv extends f{constructor(t){super(t,Fp)}getParser(){return this.parser}}class Dd extends f{constructor(t){super(t,Gp)}getParser(){return this.parser}}class pv extends f{constructor(t){super(t,Bp)}getParser(){return this.parser}}class O_ extends f{constructor(t){super(t,wp)}getParser(){return this.parser}}class A_ extends f{constructor(t){super(t,Hp)}getParser(){return this.parser}}class S_ extends f{constructor(t){super(t,Vp)}getParser(){return this.parser}}class M_ extends f{constructor(t){super(t,jp)}getParser(){return this.parser}}class Ov extends f{constructor(t){super(t,zp)}getParser(){return this.parser}}class Av extends f{constructor(t){super(t,Yp)}getParser(){return this.parser}}class Sv extends f{constructor(t){super(t,kp)}getParser(){return this.parser}}class Mv extends f{constructor(t){super(t,Kp)}getParser(){return this.parser}}class C_ extends f{constructor(t){super(t,jc)}getParser(){return this.parser}}class N_ extends f{constructor(t){super(t,Qp)}getParser(){return this.parser}}class D_ extends f{constructor(t){super(t,ei)}getParser(){return this.parser}}class P_ extends f{constructor(t){super(t,Jp)}getParser(){return this.parser}}class Cv extends f{constructor(t){super(t,Zp)}getParser(){return this.parser}}class y_ extends f{constructor(t){super(t,$p)}getParser(){return this.parser}}class rr extends f{constructor(t){super(t,tO)}getParser(){return this.parser}}class L_ extends f{constructor(t){super(t,eO)}getParser(){return this.parser}}class Pd extends f{constructor(t){super(t,sO)}getParser(){return this.parser}}class yd extends f{constructor(t){super(t,iO)}getParser(){return this.parser}}class na extends f{constructor(t){super(t,rO)}getParser(){return this.parser}}class Ld extends f{constructor(t){super(t,nO)}getParser(){return this.parser}}class Ud extends f{constructor(t){super(t,aO)}getParser(){return this.parser}}class vd extends f{constructor(t){super(t,_O)}getParser(){return this.parser}}class bd extends f{constructor(t){super(t,hO)}getParser(){return this.parser}}class Fd extends f{constructor(t){super(t,uO)}getParser(){return this.parser}}class xd extends f{constructor(t){super(t,lO)}getParser(){return this.parser}}class Nh extends f{constructor(t){super(t,mh)}getParser(){return this.parser}}class aa extends f{constructor(t){super(t,mh)}getParser(){return this.parser}}class oa extends f{constructor(t){super(t,mh)}getParser(){return this.parser}}class U_ extends f{constructor(t){super(t,cO)}getParser(){return this.parser}}class _a extends f{constructor(t){super(t,dO)}getParser(){return this.parser}}class v_ extends f{constructor(t){super(t,gO)}getParser(){return this.parser}}class ha extends f{constructor(t){super(t,pO)}getParser(){return this.parser}}class b_ extends f{constructor(t){super(t,EO)}getParser(){return this.parser}}class F_ extends f{constructor(t){super(t,fO)}getParser(){return this.parser}}class Gd extends f{constructor(t){super(t,mO)}getParser(){return this.parser}}class x_ extends f{constructor(t){super(t,IO)}getParser(){return this.parser}}class ua extends f{constructor(t){super(t,RO)}getParser(){return this.parser}}class G_ extends f{constructor(t){super(t,TO)}getParser(){return this.parser}}class la extends f{constructor(t){super(t,OO)}getParser(){return this.parser}}class B_ extends f{constructor(t){super(t,MO)}getParser(){return this.parser}}class Nv extends f{constructor(t){super(t,NN)}getParser(){return this.parser}}class Dv extends f{constructor(t){super(t,DN)}getParser(){return this.parser}}class Pv extends f{constructor(t){super(t,PN)}getParser(){return this.parser}}class yv extends f{constructor(t){super(t,yN)}getParser(){return this.parser}}class Dh extends f{constructor(t){super(t,LN)}getParser(){return this.parser}}Dh.PRODUCT_DONATED_CODE=6;Dh.BADGE_DONATED_CODE=7;class Lv extends f{constructor(t){super(t,UN)}getParser(){return this.parser}}class Uv extends f{constructor(t){super(t,vN)}getParser(){return this.parser}}class vv extends f{constructor(t){super(t,$T)}getParser(){return this.parser}}class bv extends f{constructor(t){super(t,ep)}getParser(){return this.parser}}class Fv extends f{constructor(t){super(t,sp)}getParser(){return this.parser}}class xv extends f{constructor(t){super(t,ip)}getParser(){return this.parser}}class Gv extends f{constructor(t){super(t,rp)}getParser(){return this.parser}}class Bv extends f{constructor(t){super(t,np)}getParser(){return this.parser}}class wv extends f{constructor(t){super(t,op)}getParser(){return this.parser}}class Hv extends f{constructor(t){super(t,_p)}getParser(){return this.parser}}class Vv extends f{constructor(t){super(t,hp)}getParser(){return this.parser}}class jv extends f{constructor(t){super(t,fe)}getParser(){return this.parser}}class zv extends f{constructor(t){super(t,up)}getParser(){return this.parser}}class Yv extends f{constructor(t){super(t,lp)}getParser(){return this.parser}}class Bd extends f{constructor(t){super(t,bN)}getParser(){return this.parser}}class wd extends f{constructor(t){super(t,FN)}getParser(){return this.parser}}class Hd extends f{constructor(t){super(t,xN)}getParser(){return this.parser}}class Vd extends f{constructor(t){super(t,GN)}getParser(){return this.parser}}class Wv extends f{constructor(t){super(t,BN)}getParser(){return this.parser}}class kv extends f{constructor(t){super(t,wN)}getParser(){return this.parser}}class Kv extends f{constructor(t){super(t,HN)}getParser(){return this.parser}}class jd extends f{constructor(t){super(t,jN)}getParser(){return this.parser}}class zd extends f{constructor(t){super(t,zN)}getParser(){return this.parser}}class Xv extends f{constructor(t){super(t,YN)}getParser(){return this.parser}}class qv extends f{constructor(t){super(t,kN)}getParser(){return this.parser}}class Qv extends f{constructor(t){super(t,XN)}getParser(){return this.parser}}class Yd extends f{constructor(t){super(t,iT)}getParser(){return this.parser}}class Wd extends f{constructor(t){super(t,Ba)}getParser(){return this.parser}}class Jv extends f{constructor(t){super(t,rT)}getParser(){return this.parser}}class Zv extends f{constructor(t){super(t,Fc)}getParser(){return this.parser}}class $v extends f{constructor(t){super(t,aT)}getParser(){return this.parser}}class kd extends f{constructor(t){super(t,oT)}getParser(){return this.parser}}class ca extends f{constructor(t){super(t,hT)}getParser(){return this.parser}}class Ph extends f{constructor(t){super(t,uT)}getParser(){return this.parser}}class tb extends f{constructor(t){super(t,lT)}getParser(){return this.parser}}class eb extends f{constructor(t){super(t,cT)}getParser(){return this.parser}}class Kd extends f{constructor(t){super(t,dT)}getParser(){return this.parser}}class Xd extends f{constructor(t){super(t,gT)}getParser(){return this.parser}}class sb extends f{constructor(t){super(t,ET)}getParser(){return this.parser}}class ib extends f{constructor(t){super(t,fT)}getParser(){return this.parser}}class rb extends f{constructor(t){super(t,mT)}getParser(){return this.parser}}class nb extends f{constructor(t){super(t,Gc)}getParser(){return this.parser}}class ab extends f{constructor(t){super(t,IT)}getParser(){return this.parser}}class ob extends f{constructor(t){super(t,RT)}getParser(){return this.parser}}class qd extends f{constructor(t){super(t,TT)}getParser(){return this.parser}}class _b extends f{constructor(t){super(t,Bc)}getParser(){return this.parser}}class Qd extends f{constructor(t){super(t,pT)}getParser(){return this.parser}}class yh extends f{constructor(t){super(t,OT)}getParser(){return this.parser}}class Jd extends f{constructor(t){super(t,AT)}getParser(){return this.parser}}class hb extends f{constructor(t){super(t,ST)}getParser(){return this.parser}}class ub extends f{constructor(t){super(t,MT)}getParser(){return this.parser}}class lb extends f{constructor(t){super(t,nn)}getParser(){return this.parser}}const ur=class Vi{constructor(t){this._type=t.readInt(),this._userId=t.readInt(),this._userName=t.readString(),this._figure=t.readString(),this._memberSince=t.readString()}get userId(){return this._userId}get userName(){return this._userName}get admin(){return this._type==Vi.TYPE_ADMIN}get owner(){return this._type==Vi.TYPE_OWNER}get pending(){return this._type==Vi.TYPE_PENDING}get member(){return this._type!=Vi.TYPE_MEMBER}get blocked(){return this._type==Vi.TYPE_BLOCKED}get figure(){return this._figure}get memberSince(){return this._memberSince}};ur.TYPE_OWNER=0;ur.TYPE_ADMIN=1;ur.TYPE_PENDING=2;ur.TYPE_MEMBER=3;ur.TYPE_BLOCKED=4;let cb=ur;class Zd extends f{constructor(t){super(t,qO)}getParser(){return this.parser}}class $d extends f{constructor(t){super(t,QO)}getParser(){return this.parser}}class tg extends f{constructor(t){super(t,JO)}getParser(){return this.parser}}class db extends f{constructor(t){super(t,tA)}getParser(){return this.parser}}class gb extends f{constructor(t){super(t,eA)}getParser(){return this.parser}}class Eb extends f{constructor(t){super(t,sA)}getParser(){return this.parser}}class fb extends f{constructor(t){super(t,QN)}getParser(){return this.parser}}class mb{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class Ib{constructor(){this._data=[]}dispose(){}getMessageArray(){return this._data}}class Rb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Tb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class pb{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Ob{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ab{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Sb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Mb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Cb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class da{constructor(t="",e="",s="",i=-1,r=-1){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=[]}assignBitmap(t){const e=At.generateImageUrl(t);if(!e)return;const s=e.split(",")[1],i=Uint8Array.from(atob(s),r=>r.charCodeAt(0));this._data.push(i.byteLength,i.buffer)}assignBase64(t){const e=t.split(",")[1],s=Uint8Array.from(atob(e),i=>i.charCodeAt(0));this._data.push(s.byteLength,s.buffer)}}class w_ extends da{constructor(t="",e="",s="",i=-1,r=-1){super(t,e,s,i,r)}}class Nb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Db{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class Pb{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class yb{constructor(t,e,s,i,r,a){this._data=[t,e,s,i,r,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class Lb{constructor(t,e,s,i){this._data=[t,e,s,i]}dispose(){this._data=null}getMessageArray(){return this._data}}class Ub{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class vb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bb{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Fb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class xb{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Gb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Hb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Vb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class jb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class zb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Yb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Wb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class kb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Kb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Xb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class qb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Qb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Jb{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Zb{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class $b{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class t0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class e0{constructor(t,e,s,i,r,a,o,_,l){this._data=[t,e,s,i,r,a,o,_,l]}getMessageArray(){return this._data}dispose(){}}class s0{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class i0{constructor(t,e,s,i,r,a,o){this._data=[t,e,s,i,r,a,o]}getMessageArray(){return this._data}dispose(){}}class r0{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class n0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class a0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class o0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class h0{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class u0{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class l0{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class c0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class d0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class g0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class E0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class f0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class m0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class En{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}En.CONFIRM_LEVEL_NOT_ACCEPTED=0;En.CONFIRM_LEVEL_NOT_SUBMITTED=1;En.CONFIRM_LEVEL_NOT_CONFIRMED=2;En.CONFIRM_LEVEL_COMMIT=3;class I0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class R0{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class T0{constructor(t,e){this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class p0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class O0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class A0{constructor(t,e){this._data=[t,e.length].concat(e)}getMessageArray(){return this._data}dispose(){}}class S0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class M0{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class C0{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class N0{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class D0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class P0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class y0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class L0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class U0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class v0{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class b0{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class F0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class x0{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class G0{constructor(t,e){this._data=[e.length,...e,t]}getMessageArray(){return this._data}dispose(){}}class B0{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class w0{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class H0{constructor(t=!0){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class V0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class j0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class z0{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Y0{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class W0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class k0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class K0{constructor(t,e){this._data=[t,e]}dispose(){this._data=null}getMessageArray(){return this._data}}class X0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class q0{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Q0{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class J0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class eg{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Z0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class $0{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class tF{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class eF{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class sF{constructor(t,e,s,i,r,a){this._data=[t,e,s,i,r,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class iF{constructor(t,e,s,i,r,a){this._data=[t,e,s,i,r,a]}dispose(){this._data=null}getMessageArray(){return this._data}}class rF{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class nF{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class sg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}sg.NO_ISSUE_ID=-1;class aF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ig{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}ig.NO_ISSUE_ID=-1;class oF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class _F{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class uF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class lF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class cF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class dF{constructor(t,e,s,i,r,a){this._data=[t,e,s,i,r,a.length,...a]}getMessageArray(){return this._data}dispose(){}}class gF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class EF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class fF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class RF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TF{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class pF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class OF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class AF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class SF{constructor(t,e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class MF{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class CF{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class NF{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class DF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class PF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yF{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class LF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UF{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class vF{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class bF{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class FF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xF{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class GF{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class BF{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class wF{constructor(...t){this._data=[t.length],t.forEach(e=>{this._data.push(e.k),this._data.push(e._arg_2),this._data.push(e._arg_3)})}getMessageArray(){return this._data}dispose(){}}class HF{constructor(t,e,s,i,r){this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class VF{constructor(t,e,s,i){this._data=[t,e,i,s]}getMessageArray(){return this._data}dispose(){}}class jF{constructor(t,e,s){if(this._type=t,e.length===s.length){this._data=[];for(let i=0;i<e.length;i++)this._data.push(e[i]),this._data.push(s[i])}}getMessageArray(){return this._data}dispose(){}}class rg{constructor(t,e,s,i){this._data=[`NITRO-${cc.RENDERER_VERSION.replaceAll(".","-")}`,"HTML5",Da.HTML5,ih.BROWSER]}getMessageArray(){return this._data}dispose(){}}class zF{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class YF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ng{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class WF{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ag{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class og{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class kF{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class KF{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class XF{constructor(t,e,s,i,r){this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class qF{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class QF{constructor(t,e,s,i){this._data=[t,e,s,i.length/2,...i]}getMessageArray(){return this._data}dispose(){}}class JF{constructor(t,e,s,i,r){this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class ZF{constructor(t,e,s,i,r){this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class $F{constructor(t,e,s,i,r){this._data=[t,e,s,i,r.length/2,...r]}getMessageArray(){return this._data}dispose(){}}class tx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ex{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class sx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ix{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class rx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class nx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ax{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ox{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _x{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class hx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class ux{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class lx{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class cx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class dx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class gx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ex{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class fx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ix{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Rx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Tx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class px{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ox{constructor(t,e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class Ax{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Sx{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Mx{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Cx{constructor(){this._data=[]}dispose(){this._data=null}getMessageArray(){return this._data}}class Nx{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Dx{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class Px{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yx{constructor(){this._badges=[]}getMessageArray(){const t=[];for(let e=1;e<=this._badges.length;e++)t.push(e),t.push(this._badges[e-1]);return t}dispose(){}addActivatedBadge(t){this._badges.push(t)}}class Nu{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Lx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Ux{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class vx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bx{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Du{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Fx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Gx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Bx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class wx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Hx{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class Vx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Yx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Wx{constructor(t,...e){this._data=[t,e.length,...e]}getMessageArray(){return this._data}dispose(){}}class kx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Kx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Xx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class qx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class Qx{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){this._data=null}}class Jx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Zx{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class $x{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){this._data=null}}class t1{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){this._data=null}}class e1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class s1{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class i1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){this._data=null}}class r1{constructor(t,e,s){this._data=[t,e.length,...e,s]}getMessageArray(){return this._data}dispose(){}}class Qa{constructor(t,e){this._data=[e,t.length,...t]}getMessageArray(){return this._data}dispose(){}}Qa.RESOLUTION_USELESS=1;Qa.RESOLUTION_ABUSIVE=2;Qa.RESOLUTION_RESOLVED=3;const _g=class hg{constructor(t,e,s,i,r,a=-1){this._data=[t,e,s,i,r],a!=hg.NO_ISSUE_ID&&this._data.push(a)}getMessageArray(){return this._data}dispose(){}};_g.NO_ISSUE_ID=-1;let Li=_g;class n1{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=Li.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class a1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class o1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class _1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class h1{constructor(t,e=0){this._data=[e,t]}getMessageArray(){return this._data}dispose(){}}class u1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class l1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class c1{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=Li.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class d1{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class fn{constructor(t,e,s){this._data=[],this._data.push(t),this._data.push(e),this._data.push(s)}getMessageArray(){return this._data}dispose(){}}fn.ACTION_ALERT=0;fn.ACTION_KICK=1;fn.ACTION_MESSAGE=3;fn.ACTION_MESSAGE_AND_SOFT_KICK=4;class g1{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=Li.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class E1{constructor(t,e,s,i=-1){this._data=[],this._data.push(t),this._data.push(e),this._data.push(""),this._data.push(""),this._data.push(s),i!=Li.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class f1{constructor(t,e,s,i=-1){this._data=[t,e,s],i!=Li.NO_ISSUE_ID&&this._data.push(i)}getMessageArray(){return this._data}dispose(){}}class m1{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class I1{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class R1{constructor(t,e,s,i,r=-1){this._data=[t,e,s,i],r!=Li.NO_ISSUE_ID&&this._data.push(r)}getMessageArray(){return this._data}dispose(){}}class T1{constructor(t,e,s,i){this._data=[t.length,...t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class p1{constructor(t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class O1{constructor(t){this._data=[t]}dispose(){this._data=null}getMessageArray(){return this._data}}class A1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class S1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class M1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class C1{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class N1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class D1{constructor(t,e,s,i,r,a){this._data=[t,e,s,i,r,a]}getMessageArray(){return this._data}dispose(){}}class P1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class y1{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class L1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class U1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class v1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class b1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class F1{constructor(t,e,s){this._data=[t,e?1:0,s?1:0]}getMessageArray(){return this._data}dispose(){}}class x1{constructor(t=0){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class G1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class B1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class w1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class H1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class V1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class j1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class z1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Y1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class W1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class k1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class K1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class X1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class q1{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Q1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class J1{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Z1{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $1{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class tG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class eG{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class sG{constructor(t,e,s,i,r,a){this._data=[t,e,s,i,r,a]}getMessageArray(){return this._data}dispose(){}}class iG{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class rG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aG{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class oG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class _G{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class hG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class lG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cG{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class dG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class EG{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class fG{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class mG{constructor(...t){this._data=[t.length*3],t.forEach(e=>{this._data.push(e.dayIndex),this._data.push(e.stepIndex),this._data.push(e.giftIndex)})}dispose(){this._data=null}getMessageArray(){return this._data}}class ug{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class h{}h.ACHIEVEMENT_LIST=219;h.AUTHENTICATION=-1;h.BOT_CONFIGURATION=1986;h.BOT_PICKUP=3323;h.BOT_PLACE=1592;h.BOT_SKILL_SAVE=2624;h.GET_CLUB_OFFERS=3285;h.GET_CLUB_GIFT_INFO=487;h.GET_CATALOG_INDEX=1195;h.GET_CATALOG_PAGE=412;h.CATALOG_PURCHASE=3492;h.CATALOG_PURCHASE_GIFT=1411;h.GET_PRODUCT_OFFER=2594;h.CLIENT_LATENCY=295;h.CLIENT_LATENCY_MEASURE=96;h.CLIENT_POLICY=26979;h.CLIENT_PONG=2596;h.CLIENT_TOOLBAR_TOGGLE=2313;h.CLIENT_VARIABLES=1053;h.GET_CURRENT_TIMING_CODE=2912;h.DESKTOP_NEWS=1827;h.DESKTOP_VIEW=105;h.GET_BUNDLE_DISCOUNT_RULESET=223;h.EVENT_TRACKER=3457;h.FIND_NEW_FRIENDS=516;h.FURNITURE_ALIASES=3898;h.FURNITURE_FLOOR_UPDATE=248;h.FURNITURE_MULTISTATE=99;h.FURNITURE_PICKUP=3456;h.FURNITURE_PLACE=1258;h.FURNITURE_POSTIT_PLACE=2248;h.FURNITURE_POSTIT_SAVE_STICKY_POLE=3283;h.FURNITURE_RANDOMSTATE=3617;h.FURNITURE_WALL_MULTISTATE=210;h.FURNITURE_WALL_UPDATE=168;h.GAMES_INIT=2914;h.GAMES_LIST=741;h.ACCEPTGAMEINVITE=3802;h.GAMEUNLOADEDMESSAGE=3207;h.GETGAMEACHIEVEMENTSMESSAGE=2399;h.GETGAMESTATUSMESSAGE=3171;h.GETUSERGAMEACHIEVEMENTSMESSAGE=389;h.JOINQUEUEMESSAGE=1458;h.LEAVEQUEUEMESSAGE=2384;h.RESETRESOLUTIONACHIEVEMENTMESSAGE=3144;h.GETWEEKLYGAMEREWARDWINNERS=1054;h.GAME2GETACCOUNTGAMESTATUSMESSAGE=11;h.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE=3259;h.GAME2EXITGAMEMESSAGE=1445;h.GAME2GAMECHATMESSAGE=2502;h.GAME2LOADSTAGEREADYMESSAGE=2415;h.GAME2PLAYAGAINMESSAGE=3196;h.GAME2REQUESTFULLSTATUSUPDATEMESSAGE=1598;h.GAME2GETWEEKLYFRIENDSLEADERBOARD=1232;h.GAME2GETWEEKLYLEADERBOARD=2565;h.GET_GIFT_WRAPPING_CONFIG=418;h.GROUP_ADMIN_ADD=2894;h.GROUP_ADMIN_REMOVE=722;h.GROUP_CREATE_OPTIONS=798;h.GROUP_FAVORITE=3549;h.GET_FORUM_STATS=3149;h.GET_FORUM_THREADS=873;h.GET_FORUMS_LIST=436;h.GET_FORUM_MESSAGES=232;h.GET_FORUM_THREAD=3900;h.GET_UNREAD_FORUMS_COUNT=2908;h.FORUM_MODERATE_MESSAGE=286;h.FORUM_MODERATE_THREAD=1397;h.FORUM_POST_MESSAGE=3529;h.UPDATE_FORUM_READ_MARKER=1855;h.UPDATE_FORUM_SETTINGS=2214;h.FORUM_UPDATE_THREAD=3045;h.GROUP_INFO=2991;h.GROUP_DELETE=1134;h.GROUP_MEMBER_REMOVE_CONFIRM=3593;h.GROUP_MEMBER_REMOVE=593;h.GROUP_MEMBERS=312;h.GROUP_MEMBERSHIPS=367;h.GROUP_REQUEST=998;h.GROUP_REQUEST_ACCEPT=3386;h.GROUP_REQUEST_DECLINE=1894;h.GROUP_SETTINGS=1004;h.GROUP_PARTS=813;h.GROUP_BUY=230;h.GROUP_SAVE_INFORMATION=3137;h.GROUP_SAVE_BADGE=1991;h.GROUP_SAVE_COLORS=1764;h.GROUP_SAVE_PREFERENCES=3435;h.GROUP_BADGES=21;h.GROUP_UNBLOCK_MEMBER=2864;h.GET_BADGE_POINTS_LIMITS=1371;h.REQUESTABADGE=3077;h.GETISBADGEREQUESTFULFILLED=1364;h.ITEM_CLOTHING_REDEEM=3374;h.ITEM_COLOR_WHEEL_CLICK=2144;h.ITEM_DICE_CLICK=1990;h.ITEM_DICE_CLOSE=1533;h.ITEM_DIMMER_SAVE=1648;h.ITEM_DIMMER_SETTINGS=2813;h.ITEM_DIMMER_TOGGLE=2296;h.ITEM_EXCHANGE_REDEEM=3115;h.ITEM_PAINT=711;h.SET_OBJECT_DATA=3608;h.ITEM_STACK_HELPER=3839;h.ITEM_WALL_CLICK=210;h.ITEM_WALL_UPDATE=168;h.MARKETPLACE_CONFIG=2597;h.ACCEPT_FRIEND=137;h.MESSENGER_CHAT=3567;h.DECLINE_FRIEND=2890;h.FOLLOW_FRIEND=3997;h.MESSENGER_FRIENDS=1523;h.MESSENGER_INIT=2781;h.MESSENGER_RELATIONSHIPS=2138;h.SET_RELATIONSHIP_STATUS=3768;h.REMOVE_FRIEND=1689;h.REQUEST_FRIEND=3157;h.GET_FRIEND_REQUESTS=2448;h.SEND_ROOM_INVITE=1276;h.HABBO_SEARCH=1210;h.FRIEND_LIST_UPDATE=1419;h.MOD_TOOL_USER_INFO=3295;h.GET_USER_FLAT_CATS=3027;h.NAVIGATOR_INIT=2110;h.NAVIGATOR_SEARCH=249;h.NAVIGATOR_SEARCH_CLOSE=1834;h.NAVIGATOR_SEARCH_OPEN=637;h.NAVIGATOR_SEARCH_SAVE=2226;h.GET_USER_EVENT_CATS=1782;h.NAVIGATOR_SETTINGS_SAVE=3159;h.NAVIGATOR_CATEGORY_LIST_MODE=1202;h.NAVIGATOR_DELETE_SAVED_SEARCH=1954;h.PET_INFO=2934;h.PET_PICKUP=1581;h.PET_PLACE=2647;h.PET_RESPECT=3202;h.PET_RIDE=1036;h.PET_MOVE=3449;h.PET_OPEN_PACKAGE=3698;h.PET_SELECTED=549;h.PETS_BREED=1638;h.PET_CANCEL_BREEDING=2713;h.PET_CONFIRM_BREEDING=3382;h.GET_PET_TRAINING_PANEL=2161;h.RECYCLER_PRIZES=398;h.RECYCLER_STATUS=1342;h.RECYCLER_ITEMS=2771;h.RELEASE_VERSION=4e3;h.CALL_FOR_HELP=1691;h.ROOM_AMBASSADOR_ALERT=2996;h.ROOM_BAN_GIVE=1477;h.ROOM_BAN_LIST=2267;h.ROOM_BAN_REMOVE=992;h.ROOM_CREATE=2752;h.ROOM_DELETE=532;h.ROOM_DOORBELL=1644;h.ROOM_ENTER=2312;h.ROOM_FAVORITE=3817;h.ROOM_FAVORITE_REMOVE=309;h.CAN_CREATE_ROOM=2128;h.CANCEL_ROOM_EVENT=2725;h.EDIT_ROOM_EVENT=3991;h.COMPETITION_ROOM_SEARCH=433;h.FORWARD_TO_RANDOM_PROMOTED_ROOM=10;h.FORWARD_TO_SOME_ROOM=1703;h.GET_CATEGORIES_WITH_USER_COUNT=3782;h.GET_GUEST_ROOM=2230;h.GET_OFFICIAL_ROOMS=1229;h.GET_POPULAR_ROOM_TAGS=826;h.GUILD_BASE_SEARCH=2930;h.MY_FAVOURITE_ROOMS_SEARCH=2578;h.MY_FREQUENT_ROOM_HISTORY_SEARCH=1002;h.MY_FRIENDS_ROOM_SEARCH=2266;h.MY_GUILD_BASES_SEARCH=39;h.MY_RECOMMENDED_ROOMS=2537;h.MY_ROOM_HISTORY_SEARCH=2264;h.MY_ROOM_RIGHTS_SEARCH=272;h.MY_ROOMS_SEARCH=2277;h.POPULAR_ROOMS_SEARCH=2758;h.ROOM_AD_EVENT_TAB_CLICKED=2412;h.ROOM_AD_EVENT_TAB_VIEWED=2668;h.ROOM_AD_SEARCH=2809;h.ROOM_TEXT_SEARCH=3943;h.ROOMS_WHERE_MY_FRIENDS_ARE=1786;h.ROOMS_WITH_HIGHEST_SCORE_SEARCH=2939;h.SET_ROOM_SESSION_TAGS=3305;h.UPDATE_ROOM_THUMBNAIL=2468;h.ROOM_KICK=1320;h.ROOM_LIKE=3582;h.ROOM_MODEL=2300;h.GET_OCCUPIED_TILES=1687;h.GET_ROOM_ENTRY_TILE=3559;h.ROOM_MODEL_SAVE=875;h.ROOM_MUTE=3637;h.ROOM_MUTE_USER=3485;h.ROOM_RIGHTS_GIVE=808;h.ROOM_RIGHTS_LIST=3385;h.ROOM_RIGHTS_REMOVE=2064;h.ROOM_RIGHTS_REMOVE_ALL=2683;h.ROOM_RIGHTS_REMOVE_OWN=3182;h.ROOM_SETTINGS=3129;h.ROOM_SETTINGS_SAVE=1969;h.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE=1265;h.ROOM_STAFF_PICK=1918;h.ROOM_FILTER_WORDS=1911;h.ROOM_FILTER_WORDS_MODIFY=3001;h.MYSTERYBOXWAITINGCANCELEDMESSAGE=2012;h.MYSTERYBOX_OPEN_TROPHY=3074;h.SECURITY_MACHINE=2490;h.SECURITY_TICKET=2419;h.TRADE=1481;h.TRADE_ACCEPT=3863;h.TRADE_CANCEL=2341;h.TRADE_CLOSE=2551;h.TRADE_CONFIRM=2760;h.TRADE_ITEM=3107;h.TRADE_ITEM_REMOVE=3845;h.TRADE_ITEMS=1263;h.TRADE_UNACCEPT=1444;h.UNIT_ACTION=2456;h.UNIT_CHAT=1314;h.UNIT_CHAT_SHOUT=2085;h.UNIT_CHAT_WHISPER=1543;h.UNIT_DANCE=2080;h.UNIT_DROP_HAND_ITEM=2814;h.UNIT_GIVE_HANDITEM=2941;h.UNIT_LOOK=3301;h.UNIT_POSTURE=2235;h.UNIT_SIGN=1975;h.UNIT_TYPING=1597;h.UNIT_TYPING_STOP=1474;h.UNIT_WALK=3320;h.USER_BADGES=2769;h.USER_BADGES_CURRENT=2091;h.USER_BADGES_CURRENT_UPDATE=644;h.USER_BOTS=3848;h.USER_CURRENCY=273;h.USER_EFFECT_ACTIVATE=2959;h.USER_EFFECT_ENABLE=1752;h.USER_FIGURE=2730;h.USER_FURNITURE=3150;h.REQUESTFURNIINVENTORYWHENNOTINROOM=3500;h.USER_HOME_ROOM=1740;h.USER_INFO=357;h.USER_MOTTO=2228;h.USER_IGNORED=3878;h.USER_PETS=3095;h.USER_PROFILE=3265;h.USER_PROFILE_BY_NAME=2249;h.USER_RESPECT=2694;h.GET_SOUND_SETTINGS=2388;h.USER_SETTINGS_CAMERA=1461;h.USER_SETTINGS_CHAT_STYLE=1030;h.USER_SETTINGS_INVITES=1086;h.USER_SETTINGS_OLD_CHAT=1262;h.USER_SETTINGS_VOLUME=1367;h.USER_SUBSCRIPTION=3166;h.GET_WARDROBE=2742;h.SAVE_WARDROBE_OUTFIT=800;h.USER_TAGS=17;h.PEER_USERS_CLASSIFICATION=1160;h.USER_CLASSIFICATION=2285;h.VISIT_USER=2970;h.WIRED_ACTION_SAVE=2281;h.WIRED_APPLY_SNAPSHOT=3373;h.WIRED_CONDITION_SAVE=3203;h.WIRED_OPEN=768;h.WIRED_TRIGGER_SAVE=1520;h.GET_ITEM_DATA=3964;h.ONE_WAY_DOOR_CLICK=2765;h.REMOVE_WALL_ITEM=3336;h.SET_ITEM_DATA=3666;h.CATALOG_REDEEM_VOUCHER=339;h.ROOM_TONER_APPLY=2880;h.FRIEND_FURNI_CONFIRM_LOCK=3775;h.MANNEQUIN_SAVE_NAME=2850;h.MANNEQUIN_SAVE_LOOK=2209;h.PRESENT_OPEN_PRESENT=3558;h.CATALOG_SELECT_VIP_GIFT=2276;h.USER_IGNORE_ID=3314;h.USER_IGNORE=1117;h.USER_UNIGNORE=2061;h.MODTOOL_REQUEST_ROOM_INFO=707;h.MODTOOL_CHANGE_ROOM_SETTINGS=3260;h.MODTOOL_REQUEST_USER_CHATLOG=1391;h.MODTOOL_REQUEST_ROOM_CHATLOG=2587;h.MODTOOL_SANCTION_ALERT=229;h.MODTOOL_SANCTION_BAN=2766;h.MODTOOL_SANCTION_KICK=2582;h.MODTOOL_SANCTION_TRADELOCK=3742;h.MODTOOL_ALERTEVENT=1840;h.MODTOOL_SANCTION_MUTE=1945;h.MODTOOL_REQUEST_USER_ROOMS=3526;h.MODTOOL_ROOM_ALERT=3842;h.MODTOOL_PREFERENCES=31;h.CLOSE_ISSUE_DEFAULT_ACTION=2717;h.CLOSE_ISSUES=2067;h.DEFAULT_SANCTION=1681;h.GET_CFH_CHATLOG=211;h.MODTOOL_SANCTION=1392;h.PICK_ISSUES=15;h.RELEASE_ISSUES=1572;h.CONVERT_GLOBAL_ROOM_ID=314;h.REQUEST_SELL_ITEM=848;h.REQUEST_MARKETPLACE_ITEM_STATS=3288;h.MARKETPLACE_SELL_ITEM=3447;h.MARKETPLACE_REQUEST_OWN_ITEMS=2105;h.MARKETPLACE_TAKE_BACK_ITEM=434;h.MARKETPLACE_REDEEM_CREDITS=2650;h.MARKETPLACE_REQUEST_OFFERS=2407;h.MARKETPLACE_BUY_OFFER=1603;h.MARKETPLACE_BUY_TOKENS=1866;h.CATALOG_REQUESET_PET_BREEDS=1756;h.APPROVE_NAME=2109;h.UNIT_GIVE_HANDITEM_PET=2768;h.PET_MOUNT=1036;h.PET_SUPPLEMENT=749;h.FURNITURE_GROUP_INFO=2651;h.ACHIEVEMENT_RESOLUTION_OPEN=359;h.USE_PET_PRODUCT=1328;h.REMOVE_PET_SADDLE=186;h.TOGGLE_PET_RIDING=1472;h.TOGGLE_PET_BREEDING=3379;h.UNSEEN_RESET_CATEGORY=3493;h.UNSEEN_RESET_ITEMS=2343;h.COMMUNITY_GOAL_VOTE_COMPOSER=3536;h.GET_PROMO_ARTICLES=1827;h.ACCEPT_QUEST=3604;h.ACTIVATE_QUEST=793;h.CANCEL_QUEST=3133;h.FRIEND_REQUEST_QUEST_COMPLETE=1148;h.GET_COMMUNITY_GOAL_EARNED_PRIZES=2688;h.GET_COMMUNITY_GOAL_HALL_OF_FAME=2167;h.GET_COMMUNITY_GOAL_PROGRESS=1145;h.GET_CONCURRENT_USERS_GOAL_PROGRESS=1343;h.GET_CONCURRENT_USERS_REWARD=3872;h.GET_DAILY_QUEST=2486;h.GET_QUESTS=3333;h.GET_SEASONAL_QUESTS_ONLY=1190;h.OPEN_QUEST_TRACKER=2750;h.REDEEM_COMMUNITY_GOAL_PRIZE=90;h.REJECT_QUEST=2397;h.START_CAMPAIGN=1697;h.GET_BONUS_RARE_INFO=957;h.CRAFT=3591;h.CRAFT_SECRET=1251;h.GET_CRAFTABLE_PRODUCTS=633;h.GET_CRAFTING_RECIPE=1173;h.GET_CRAFTING_RECIPES_AVAILABLE=3086;h.PHOTO_COMPETITION=3959;h.PUBLISH_PHOTO=2068;h.PURCHASE_PHOTO=2408;h.RENDER_ROOM=3226;h.RENDER_ROOM_THUMBNAIL=1982;h.REQUEST_CAMERA_CONFIGURATION=796;h.ADD_JUKEBOX_DISK=753;h.GET_JUKEBOX_PLAYLIST=1435;h.GET_NOW_PLAYING=1325;h.GET_OFFICIAL_SONG_ID=3189;h.GET_SONG_INFO=3082;h.GET_SOUND_MACHINE_PLAYLIST=3498;h.GET_USER_SONG_DISKS=2304;h.REMOVE_JUKEBOX_DISK=3050;h.INTERSTITIAL_SHOWN=1109;h.GET_INTERSTITIAL=2519;h.CHANGE_USERNAME=2977;h.CHECK_USERNAME=3950;h.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF=3889;h.OPEN_CAMPAIGN_CALENDAR_DOOR=2257;h.BUILDERS_CLUB_PLACE_ROOM_ITEM=1051;h.BUILDERS_CLUB_PLACE_WALL_ITEM=462;h.BUILDERS_CLUB_QUERY_FURNI_COUNT=2529;h.GET_CATALOG_PAGE_EXPIRATION=742;h.GET_CATALOG_PAGE_WITH_EARLIEST_EXP=3135;h.GET_DIRECT_CLUB_BUY_AVAILABLE=801;h.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER=603;h.GET_HABBO_CLUB_EXTEND_OFFER=2462;h.GET_IS_OFFER_GIFTABLE=1347;h.GET_LIMITED_OFFER_APPEARING_NEXT=410;h.GET_NEXT_TARGETED_OFFER=596;h.GET_ROOM_AD_PURCHASE_INFO=1075;h.GET_SEASONAL_CALENDAR_DAILY_OFFER=3257;h.GET_TARGETED_OFFER=2487;h.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED=2150;h.PURCHASE_BASIC_MEMBERSHIP_EXTENSION=2735;h.PURCHASE_ROOM_AD=777;h.PURCHASE_TARGETED_OFFER=1826;h.PURCHASE_VIP_MEMBERSHIP_EXTENSION=3407;h.ROOM_AD_PURCHASE_INITIATED=2283;h.SET_TARGETTED_OFFER_STATE=2041;h.SHOP_TARGETED_OFFER_VIEWED=3483;h.HELPER_TALENT_TRACK=196;h.TALENT_TRACK_GET_LEVEL=2127;h.FORWARD_TO_A_COMPETITION_ROOM=172;h.FORWARD_TO_A_SUBMITTABLE_ROOM=1450;h.FORWARD_TO_RANDOM_COMPETITION_ROOM=865;h.GET_IS_USER_PART_OF_COMPETITION=2077;h.GET_SECONDS_UNTIL=271;h.ROOM_COMPETITION_INIT=1334;h.SUBMIT_ROOM_TO_COMPETITION=2595;h.VOTE_FOR_ROOM=143;h.GET_GIFT=2436;h.RESET_PHONE_NUMBER_STATE=2741;h.SET_PHONE_NUMBER_VERIFICATION_STATUS=1379;h.TRY_PHONE_NUMBER=790;h.VERIFY_CODE=2721;h.CONTROL_YOUTUBE_DISPLAY_PLAYBACK=3005;h.GET_YOUTUBE_DISPLAY_STATUS=336;h.SET_YOUTUBE_DISPLAY_PLAYLIST=2069;h.GO_TO_FLAT=685;h.CHANGE_QUEUE=3093;h.CALL_FOR_HELP_FROM_FORUM_MESSAGE=1412;h.CALL_FOR_HELP_FROM_FORUM_THREAD=534;h.CALL_FOR_HELP_FROM_IM=2950;h.CALL_FOR_HELP_FROM_PHOTO=2492;h.CALL_FOR_HELP_FROM_SELFIE=2755;h.CHAT_REVIEW_GUIDE_DECIDES=3365;h.CHAT_REVIEW_GUIDE_DETACHED=2501;h.CHAT_REVIEW_GUIDE_VOTE=3961;h.CHAT_REVIEW_SESSION_CREATE=3060;h.DELETE_PENDING_CALLS_FOR_HELP=3605;h.GET_CFH_STATUS=2746;h.GET_FAQ_CATEGORY=3445;h.GET_FAQ_TEXT=1849;h.GET_GUIDE_REPORTING_STATUS=3786;h.GET_PENDING_CALLS_FOR_HELP=3267;h.GET_QUIZ_QUESTIONS=1296;h.GUIDE_SESSION_CREATE=3338;h.GUIDE_SESSION_FEEDBACK=477;h.GUIDE_SESSION_GET_REQUESTER_ROOM=1052;h.GUIDE_SESSION_GUIDE_DECIDES=1424;h.GUIDE_SESSION_INVITE_REQUESTER=234;h.GUIDE_SESSION_IS_TYPING=519;h.GUIDE_SESSION_MESSAGE=3899;h.GUIDE_SESSION_ON_DUTY_UPDATE=1922;h.GUIDE_SESSION_REPORT=3969;h.GUIDE_SESSION_REQUESTER_CANCELS=291;h.GUIDE_SESSION_RESOLVED=887;h.POST_QUIZ_ANSWERS=3720;h.SEARCH_FAQS=2031;h.POLL_ANSWER=3505;h.POLL_REJECT=1773;h.POLL_START=109;h.DISCONNECT=2445;h.SCR_GET_KICKBACK_INFO=869;h.COMPOST_PLANT=3835;h.HARVEST_PET=1521;h.SET_CLOTHING_CHANGE_DATA=924;h.GROUP_UNFAVORITE=1820;h.NEW_USER_EXPERIENCE_GET_GIFTS=1822;h.NEW_USER_EXPERIENCE_SCRIPT_PROCEED=1299;h.HANDSHAKE_INIT_DIFFIE=3110;h.HANDSHAKE_COMPLETE_DIFFIE=773;h.WELCOME_OPEN_GIFT=2638;h.WELCOME_GIFT_CHANGE_EMAIL=66;h.EMAIL_GET_STATUS=2557;h.EMAIL_CHANGE=3965;h.APPROVE_ALL_MEMBERSHIP_REQUESTS=882;h.RENTABLE_SPACE_CANCEL_RENT=1667;h.RENTABLE_SPACE_RENT=2946;h.RENTABLE_SPACE_STATUS=872;h.TRACKING_PERFORMANCE_LOG=3230;h.TRACKING_LAG_WARNING_REPORT=3847;h.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION=3736;h.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM=2115;h.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI=1071;h.RENTABLE_GET_RENT_OR_BUYOUT_OFFER=2518;class lg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class H_{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class cg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IG{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class dg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Eg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class fg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mg{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Ig{constructor(t,e,s){this._data=[t,e,s.length,...s]}getMessageArray(){return this._data}dispose(){}}class Rg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Tg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class OG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class SG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class MG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class CG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class NG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class DG{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class PG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class LG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class UG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class bG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class FG{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class xG{constructor(...t){this._data=[t.length],t.forEach(e=>{this._data.push(e.itemId)})}getMessageArray(){return this._data}dispose(){}}class pg{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Og{constructor(t,e=null){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class GG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ag{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Sg{constructor(t,e=0,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class BG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Mg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Cg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ng{constructor(t,e,s=0){this._data=[t,s,e]}getMessageArray(){return this._data}dispose(){}}class Dg{constructor(...t){this._data=[t.length,...t]}getMessageArray(){return this._data}dispose(){}}class wG{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class HG{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class VG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class jG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class YG{constructor(t,e,s,i,r,a,o,_,l,c,d,E,I,m,T,p,A,N,C,L,D,v,b,q){this._data=[],this._data.push(t,e,s,i,r,a,o),this._data.push(l.length,...l),this._data.push(c,d,E,I,m,T,p,A,N,C,L,D,v,b,q)}getMessageArray(){return this._data}dispose(){}}class Pg{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class yg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class WG{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Lg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Ug extends Lg{constructor(t){super(t)}}class vg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bg extends Lg{constructor(t){super(t)}}class V_{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Fg{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class xg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Gg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Bg{constructor(t,e,s=""){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class wg{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class Hg{constructor(t,e){this._data=[t,e.size*2];for(const[s,i]of e.entries())this._data.push(s,i)}getMessageArray(){return this._data}dispose(){}}class kG{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Vg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class jg{constructor(t,e,s,i,r){this._data=[t,e,s,i,r]}getMessageArray(){return this._data}dispose(){}}class zg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KG{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class XG{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class j_{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class Yg{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class Wg{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class kg{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Kg{constructor(t,e,s,i,r,a){this._itemId=t,this._category=e,this._wallLocation=s,this._x=i,this._y=r,this._direction=a}getMessageArray(){switch(this._category){case S.FLOOR:return[`${this._itemId} ${this._x} ${this._y} ${this._direction}`];case S.WALL:return[`${this._itemId} ${this._wallLocation} `];default:return[]}}dispose(){}}class qG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Xg{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class QG{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class qg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Qg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Jg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class JG{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Lh{constructor(t,e=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Zg{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $g{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class ZG{constructor(t,e=-100){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class tE{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class $G{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class tB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class eB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class eE{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class sB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class sE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class iB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class aB{constructor(t,e,s,i){this._data=[t,e,s,i]}getMessageArray(){return this._data}dispose(){}}class iE{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class oB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class _B{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class hB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class uB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class z_{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class lB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class cB{constructor(t,e,s,i,r,a,o){this._data=[t,e,s,i,r,a,o]}getMessageArray(){return this._data}dispose(){}}class dB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class rE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class nE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class Uh{constructor(t,e=0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class aE{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class gB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class oE{constructor(t,e,s){this._data=[t+" "+e,s]}getMessageArray(){return this._data}dispose(){}}class _E{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class hE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class uE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class lE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class EB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class fB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class mB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class cE{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class dE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class gE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class EE{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class Ja{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}Ja.STATE_START=0;Ja.STATE_CANCEL=1;Ja.STATE_ACCEPT=2;class IB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class RB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class TB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class AB{constructor(t,e,s,i,r,a){this._data=[t,e.length,...e,s,i.length,...i,r,a]}getMessageArray(){return this._data}dispose(){}}class SB{constructor(t,e,s,i,r){this._data=[t,e.length,...e,s,i.length,...i,r]}getMessageArray(){return this._data}dispose(){}}class MB{constructor(t,e,s,i,r){this._data=[t,e.length,...e,s,i.length,...i,r]}getMessageArray(){return this._data}dispose(){}}class CB{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class NB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class fE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class mE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class DB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class IE{constructor(...t){this._data=[t.length].concat(t)}getMessageArray(){return this._data}dispose(){}}class PB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class yB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class RE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class LB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class UB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class vB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class bB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class FB{constructor(t,e,s,i,r,a,o,_,l,c,d){this._data=[t,e,s,i,r,a,o,_,l,c,d]}getMessageArray(){return this._data}dispose(){}}class xB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class GB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class BB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class wB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class TE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class pE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class OE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class AE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class SE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ME{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class HB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class CE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class VB{constructor(t,e=!0){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class jB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class zB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class NE{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class YB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class WB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class kB{constructor(){this._data=[]}getMessageArray(){return this._data}dispose(){}}class KB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class XB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class qB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class QB{constructor(t,e,s){this._data=[t,e,s]}getMessageArray(){return this._data}dispose(){}}class JB{constructor(t,e){this._data=[t,e]}getMessageArray(){return this._data}dispose(){}}class DE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class ZB{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class PE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class yE{constructor(t){this._data=[t]}getMessageArray(){return this._data}dispose(){}}class $B extends ns{constructor(t){super(),this._communication=t,this._handShaking=!1,this._didConnect=!1,this._pongInterval=null,this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.sendPong=this.sendPong.bind(this)}onInit(){const t=this._communication.connection;t&&(t.addEventListener(Bt.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.addEventListener(Bt.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.addEventListener(Bt.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._communication.registerMessageEvent(new id(this.onClientPingEvent.bind(this))),this._communication.registerMessageEvent(new Bd(this.onAuthenticatedEvent.bind(this)))}onDispose(){const t=this._communication.connection;t&&(t.removeEventListener(Bt.CONNECTION_OPENED,this.onConnectionOpenedEvent),t.removeEventListener(Bt.CONNECTION_CLOSED,this.onConnectionClosedEvent),t.removeEventListener(Bt.CONNECTION_ERROR,this.onConnectionErrorEvent)),this._handShaking=!1,this.stopPonging(),super.onDispose()}onConnectionOpenedEvent(t){const e=this._communication.connection;e&&(this._didConnect=!0,this.dispatchCommunicationDemoEvent(Qt.CONNECTION_ESTABLISHED,e),k.getValue("system.pong.manually",!1)&&this.startPonging(),this.startHandshake(e),e.send(new rg(null,null,null,null)),this.tryAuthentication(e))}onConnectionClosedEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this._didConnect&&this.dispatchCommunicationDemoEvent(Qt.CONNECTION_CLOSED,e))}onConnectionErrorEvent(t){const e=this._communication.connection;e&&(this.stopPonging(),this.dispatchCommunicationDemoEvent(Qt.CONNECTION_ERROR,e))}tryAuthentication(t){if(!t||!this.getSSO()){this.getSSO()||G.error("Login without an SSO ticket is not supported"),this.dispatchCommunicationDemoEvent(Qt.CONNECTION_HANDSHAKE_FAILED,t);return}t.send(new og(this.getSSO(),$()))}onClientPingEvent(t){!t||!t.connection||this.sendPong(t.connection)}onAuthenticatedEvent(t){!t||!t.connection||(this.completeHandshake(t.connection),this.dispatchCommunicationDemoEvent(Qt.CONNECTION_AUTHENTICATED,t.connection),t.connection.send(new ng))}startHandshake(t){this.dispatchCommunicationDemoEvent(Qt.CONNECTION_HANDSHAKING,t),this._handShaking=!0}completeHandshake(t){this.dispatchCommunicationDemoEvent(Qt.CONNECTION_HANDSHAKED,t),this._handShaking=!1}startPonging(){this.stopPonging(),this._pongInterval=setInterval(this.sendPong,k.getValue("system.pong.interval.ms",2e4))}stopPonging(){this._pongInterval&&(clearInterval(this._pongInterval),this._pongInterval=null)}sendPong(t=null){t=t||this._communication.connection||null,t&&t.send(new ag)}dispatchCommunicationDemoEvent(t,e){H.instance.events.dispatchEvent(new Qt(t,e))}getSSO(){return k.getValue("sso.ticket",null)}}class tw{constructor(){this._events=new Map,this._composers=new Map,this.registerEvents(),this.registerComposers()}registerEvents(){this._events.set(u.INTERSTITIAL_MESSAGE,JN),this._events.set(u.ROOM_AD_ERROR,ZN),this._events.set(u.AVAILABILITY_STATUS,ed),this._events.set(u.AVAILABILITY_TIME,$N),this._events.set(u.HOTEL_CLOSED_AND_OPENS,tD),this._events.set(u.HOTEL_CLOSES_AND_OPENS_AT,eD),this._events.set(u.HOTEL_WILL_CLOSE_MINUTES,sD),this._events.set(u.HOTEL_MAINTENANCE,iD),this._events.set(u.USER_CHANGE_NAME,We),this._events.set(u.CHECK_USER_NAME,rD),this._events.set(u.USER_FIGURE,sd),this._events.set(u.USER_OUTFITS,nD),this._events.set(u.ADD_BOT_TO_INVENTORY,aD),this._events.set(u.USER_BOTS,oD),this._events.set(u.BOT_RECEIVED,_D),this._events.set(u.REMOVE_BOT_FROM_INVENTORY,hD),this._events.set(u.CFH_SANCTION,uD),this._events.set(u.CFH_TOPICS,lD),this._events.set(u.CFH_SANCTION_STATUS,cD),this._events.set(u.CAMERA_PUBLISH_STATUS,dD),this._events.set(u.CAMERA_PURCHASE_OK,gD),this._events.set(u.CAMERA_STORAGE_URL,ED),this._events.set(u.COMPETITION_STATUS,fD),this._events.set(u.INIT_CAMERA,mD),this._events.set(u.THUMBNAIL_STATUS,ID),this._events.set(u.CAMPAIGN_CALENDAR_DATA,RD),this._events.set(u.CAMPAIGN_CALENDAR_DOOR_OPENED,TD),this._events.set(u.BONUS_RARE_INFO,pD),this._events.set(u.BUILDERS_CLUB_FURNI_COUNT,OD),this._events.set(u.BUILDERS_CLUB_SUBSCRIPTION,AD),this._events.set(u.BUNDLE_DISCOUNT_RULESET,SD),this._events.set(u.CATALOG_PAGE_EXPIRATION,MD),this._events.set(u.CATALOG_PAGE,CD),this._events.set(u.CATALOG_PAGE_LIST,ND),this._events.set(u.CATALOG_EARLIEST_EXPIRY,DD),this._events.set(u.CATALOG_PUBLISHED,PD),this._events.set(u.CLUB_GIFT_INFO,yD),this._events.set(u.CLUB_GIFT_SELECTED,LD),this._events.set(u.DIRECT_SMS_CLUB_BUY,UD),this._events.set(u.GIFT_RECEIVER_NOT_FOUND,vD),this._events.set(u.GIFT_WRAPPER_CONFIG,bD),this._events.set(u.CLUB_EXTENDED_OFFER,FD),this._events.set(u.CLUB_OFFERS,xD),this._events.set(u.IS_OFFER_GIFTABLE,GD),this._events.set(u.LIMITED_SOLD_OUT,BD),this._events.set(u.LIMITED_OFFER_APPEARING_NEXT,wD),this._events.set(u.NOT_ENOUGH_BALANCE,HD),this._events.set(u.PRODUCT_OFFER,VD),this._events.set(u.CATALOG_PURCHASE_ERROR,jD),this._events.set(u.CATALOG_PURCHASE_NOT_ALLOWED,zD),this._events.set(u.CATALOG_PURCHASE_OK,YD),this._events.set(u.ROOM_AD_PURCHASE,WD),this._events.set(u.SEASONAL_CALENDAR_OFFER,kD),this._events.set(u.CATALOG_RECEIVE_PET_BREEDS,KD),this._events.set(u.TARGET_OFFER,XD),this._events.set(u.TARGET_OFFER_NOT_FOUND,qD),this._events.set(u.REDEEM_VOUCHER_ERROR,QD),this._events.set(u.REDEEM_VOUCHER_OK,JD),this._events.set(u.CLIENT_PING,id),this._events.set(u.COMPETITION_ENTRY_SUBMIT,ZD),this._events.set(u.COMPETITION_VOTING_INFO,$D),this._events.set(u.COMPETITION_TIMING_CODE,tP),this._events.set(u.COMPETITION_USER_PART_OF,eP),this._events.set(u.COMPETITION_NO_OWNED_ROOMS,sP),this._events.set(u.COMPETITION_SECONDS_UNTIL,iP),this._events.set(u.CRAFTABLE_PRODUCTS,rP),this._events.set(u.CRAFTING_RECIPE,nP),this._events.set(u.CRAFTING_RECIPES_AVAILABLE,aP),this._events.set(u.CRAFTING_RESULT,oP),this._events.set(u.DESKTOP_VIEW,s_),this._events.set(u.MESSENGER_ACCEPT_FRIENDS,_P),this._events.set(u.MESSENGER_FIND_FRIENDS,hP),this._events.set(u.MESSENGER_FOLLOW_FAILED,uP),this._events.set(u.MESSENGER_FRIENDS,lP),this._events.set(u.MESSENGER_UPDATE,cP),this._events.set(u.MESSENGER_FRIEND_NOTIFICATION,dP),this._events.set(u.MESSENGER_REQUESTS,gP),this._events.set(u.MESSENGER_SEARCH,EP),this._events.set(u.MESSENGER_INSTANCE_MESSAGE_ERROR,fP),this._events.set(u.MESSENGER_MESSAGE_ERROR,mP),this._events.set(u.MESSENGER_INIT,IP),this._events.set(u.MESSENGER_MINIMAIL_NEW,RP),this._events.set(u.MESSENGER_MINIMAIL_COUNT,TP),this._events.set(u.MESSENGER_CHAT,pP),this._events.set(u.MESSENGER_REQUEST,rd),this._events.set(u.MESSENGER_INVITE_ERROR,OP),this._events.set(u.MESSENGER_INVITE,AP),this._events.set(u.ACHIEVEMENTRESOLUTIONCOMPLETED,LP),this._events.set(u.ACHIEVEMENTRESOLUTIONPROGRESS,UP),this._events.set(u.ACHIEVEMENTRESOLUTIONS,vP),this._events.set(u.LOAD_GAME_URL,nd),this._events.set(u.LOADGAME,VP),this._events.set(u.UNLOADGAME,jP),this._events.set(u.GAME_CENTER_GAME_LIST,xP),this._events.set(u.GAMESTATUSMESSAGE,GP),this._events.set(u.GAME_CENTER_ACHIEVEMENTS,zP),this._events.set(u.GAME_CENTER_STATUS,SP),this._events.set(u.GAME_CENTER_IN_ARENA_QUEUE,CP),this._events.set(u.GAME_CENTER_STOP_COUNTER,PP),this._events.set(u.GAME_CENTER_USER_LEFT_GAME,yP),this._events.set(u.GAME_CENTER_DIRECTORY_STATUS,MP),this._events.set(u.GAME_CENTER_STARTING_GAME_FAILED,DP),this._events.set(u.GAME_CENTER_JOINING_FAILED,NP),this._events.set(u.GAMEACHIEVEMENTS,bP),this._events.set(u.GAMEINVITE,FP),this._events.set(u.JOINEDQUEUEMESSAGE,BP),this._events.set(u.JOININGQUEUEFAILED,wP),this._events.set(u.LEFTQUEUE,HP),this._events.set(u.WEEKLY_GAME_REWARD,XP),this._events.set(u.WEEKLY_GAME_REWARD_WINNERS,qP),this._events.set(u.WEEKLY_COMPETITIVE_LEADERBOARD,KP),this._events.set(u.WEEKLY_COMPETITIVE_FRIENDS_LEADERBOARD,kP),this._events.set(u.WEEKLY_GAME2_FRIENDS_LEADERBOARD,YP),this._events.set(u.WEEKLY_GAME2_LEADERBOARD,WP),this._events.set(u.GROUP_INFO,ey),this._events.set(u.GROUP_MEMBER_REMOVE_CONFIRM,ty),this._events.set(u.GROUP_MEMBERS,sy),this._events.set(u.GROUP_CREATE_OPTIONS,$P),this._events.set(u.GROUP_BADGE_PARTS,ad),this._events.set(u.GROUP_SETTINGS,ry),this._events.set(u.GROUP_PURCHASED,iy),this._events.set(u.GROUP_BADGES,qd),this._events.set(u.GROUP_DEACTIVATE,ny),this._events.set(u.GROUP_MEMBERSHIP_REQUESTED,rb),this._events.set(u.GROUP_DETAILS_CHANGED,ib),this._events.set(u.GROUP_HABBO_JOIN_FAILED,_b),this._events.set(u.GROUP_FORUM_DATA,ay),this._events.set(u.GROUP_FORUM_LIST,oy),this._events.set(u.GROUP_FORUM_THREADS,_y),this._events.set(u.GROUP_FORUM_POST,hy),this._events.set(u.GROUP_FORUM_POST_THREAD,uy),this._events.set(u.GROUP_FORUM_THREAD_MESSAGES,ly),this._events.set(u.GROUP_FORUM_UNREAD_COUNT,cy),this._events.set(u.GROUP_FORUM_UPDATE_MESSAGE,dy),this._events.set(u.GROUP_FORUM_UPDATE_THREAD,gy),this._events.set(u.CFH_DISABLED_NOTIFY,Ry),this._events.set(u.CFH_PENDING_CALLS_DELETED,Ty),this._events.set(u.CFH_PENDING_CALLS,py),this._events.set(u.CFH_REPLY,Oy),this._events.set(u.CFH_RESULT_MESSAGE,Ay),this._events.set(u.GUIDE_ON_DUTY_STATUS,Py),this._events.set(u.GUIDE_SESSION_ATTACHED,Ly),this._events.set(u.GUIDE_SESSION_DETACHED,Uy),this._events.set(u.GUIDE_SESSION_ENDED,_d),this._events.set(u.GUIDE_SESSION_ERROR,hd),this._events.set(u.GUIDE_SESSION_INVITED_TO_GUIDE_ROOM,vy),this._events.set(u.GUIDE_SESSION_MESSAGE,by),this._events.set(u.GUIDE_SESSION_PARTNER_IS_TYPING,Fy),this._events.set(u.GUIDE_SESSION_REQUESTER_ROOM,xy),this._events.set(u.GUIDE_SESSION_STARTED,ud),this._events.set(u.GUIDE_TICKET_CREATION_RESULT,Gy),this._events.set(u.GUIDE_TICKET_RESOLUTION,By),this._events.set(u.GUIDE_REPORTING_STATUS,yy),this._events.set(u.HOTEL_MERGE_NAME_CHANGE,wy),this._events.set(u.ISSUE_CLOSE_NOTIFICATION,Hy),this._events.set(u.QUIZ_DATA,Vy),this._events.set(u.QUIZ_RESULTS,jy),this._events.set(u.CHAT_REVIEW_SESSION_DETACHED,Sy),this._events.set(u.CHAT_REVIEW_SESSION_OFFERED_TO_GUIDE,My),this._events.set(u.CHAT_REVIEW_SESSION_RESULTS,Cy),this._events.set(u.CHAT_REVIEW_SESSION_STARTED,Ny),this._events.set(u.CHAT_REVIEW_SESSION_VOTING_STATUS,Dy),this._events.set(u.ACHIEVEMENT_PROGRESSED,zy),this._events.set(u.ACHIEVEMENT_LIST,Yy),this._events.set(u.USER_ACHIEVEMENT_SCORE,Wy),this._events.set(u.USER_EFFECT_ACTIVATE,ky),this._events.set(u.USER_EFFECT_LIST_ADD,Ky),this._events.set(u.USER_EFFECT_LIST_REMOVE,Xy),this._events.set(u.USER_EFFECT_LIST,Qy),this._events.set(u.AVATAR_EFFECT_SELECTED,qy),this._events.set(u.USER_BADGES,Zy),this._events.set(u.USER_BADGES_ADD,Jy),this._events.set(u.BADGE_POINT_LIMITS,ld),this._events.set(u.BADGE_REQUEST_FULFILLED,$y),this._events.set(u.USER_CLOTHING,tL),this._events.set(u.USER_FURNITURE_ADD,eL),this._events.set(u.USER_FURNITURE,sL),this._events.set(u.USER_FURNITURE_REFRESH,iL),this._events.set(u.USER_FURNITURE_REMOVE,rL),this._events.set(u.USER_FURNITURE_POSTIT_PLACED,nL),this._events.set(u.USER_PETS,uL),this._events.set(u.USER_PET_REMOVE,cL),this._events.set(u.USER_PET_ADD,hL),this._events.set(u.PET_RECEIVED,lL),this._events.set(u.PET_PLACING_ERROR,fd),this._events.set(u.YOUTUBE_CONTROL_VIDEO,Av),this._events.set(u.YOUTUBE_DISPLAY_PLAYLISTS,Sv),this._events.set(u.YOUTUBE_DISPLAY_VIDEO,Mv),this._events.set(u.TRADE_ACCEPTED,dL),this._events.set(u.TRADE_CLOSED,gL),this._events.set(u.TRADE_COMPLETED,EL),this._events.set(u.TRADE_CONFIRMATION,fL),this._events.set(u.TRADE_LIST_ITEM,mL),this._events.set(u.TRADE_NOT_OPEN,RL),this._events.set(u.TRADE_OPEN_FAILED,pL),this._events.set(u.TRADE_OPEN,TL),this._events.set(u.TRADE_OTHER_NOT_ALLOWED,OL),this._events.set(u.TRADE_YOU_NOT_ALLOWED,AL),this._events.set(u.TRADE_NO_SUCH_ITEM,IL),this._events.set(u.COMMUNITY_GOAL_VOTE_EVENT,ML),this._events.set(u.PROMO_ARTICLES,SL),this._events.set(u.MARKETPLACE_AFTER_ORDER_STATUS,CL),this._events.set(u.MARKETPLACE_CANCEL_SALE,NL),this._events.set(u.MARKETPLACE_SELL_ITEM,DL),this._events.set(u.MARKETPLACE_CONFIG,PL),this._events.set(u.MARKETPLACE_ITEM_STATS,yL),this._events.set(u.MARKETPLACE_ITEM_POSTED,LL),this._events.set(u.MARKETPLACE_ITEMS_SEARCHED,UL),this._events.set(u.MARKETPLACE_OWN_ITEMS,vL),this._events.set(u.USER_BANNED,KL),this._events.set(u.MODERATION_CAUTION,wL),this._events.set(u.MODTOOL_ROOM_INFO,jL),this._events.set(u.MODTOOL_USER_CHATLOG,XL),this._events.set(u.MODTOOL_ROOM_CHATLOG,WL),this._events.set(u.MODERATION_USER_INFO,YL),this._events.set(u.MODERATION_TOOL,HL),this._events.set(u.MODTOOL_VISITED_ROOMS_USER,kL),this._events.set(u.CFH_CHATLOG,bL),this._events.set(u.ISSUE_DELETED,FL),this._events.set(u.ISSUE_INFO,xL),this._events.set(u.ISSUE_PICK_FAILED,GL),this._events.set(u.MODERATOR_ACTION_RESULT,BL),this._events.set(u.MODERATOR_MESSAGE,VL),this._events.set(u.MODERATOR_TOOL_PREFERENCES,zL),this._events.set(u.MYSTERY_BOX_KEYS,dd),this._events.set(u.GOTMYSTERYBOXPRIZEMESSAGE,QL),this._events.set(u.CANCELMYSTERYBOXWAITMESSAGE,qL),this._events.set(u.SHOWMYSTERYBOXWAITMESSAGE,JL),this._events.set(u.CAN_CREATE_ROOM,ZL),this._events.set(u.CAN_CREATE_ROOM_EVENT,$L),this._events.set(u.CATEGORIES_WITH_VISITOR_COUNT,tU),this._events.set(u.COMPETITION_ROOMS_DATA,eU),this._events.set(u.CONVERTED_ROOM_ID,sU),this._events.set(u.ROOM_DOORBELL,gd),this._events.set(u.USER_FAVORITE_ROOM,iU),this._events.set(u.USER_FAVORITE_ROOM_COUNT,rU),this._events.set(u.ROOM_DOORBELL_REJECTED,r_),this._events.set(u.ROOM_CREATED,nU),this._events.set(u.ROOM_INFO,n_),this._events.set(u.GUEST_ROOM_SEARCH_RESULT,aU),this._events.set(u.USER_HOME_ROOM,_U),this._events.set(u.ROOM_EVENT_CANCEL,fU),this._events.set(u.ROOM_EVENT,mU),this._events.set(u.ROOM_INFO_UPDATED,RU),this._events.set(u.THUMBNAIL_UPDATE_RESULT,TU),this._events.set(u.NAVIGATOR_EVENT_CATEGORIES,pU),this._events.set(u.NAVIGATOR_CATEGORIES,OU),this._events.set(u.NAVIGATOR_COLLAPSED,oU),this._events.set(u.NAVIGATOR_LIFTED,hU),this._events.set(u.NAVIGATOR_METADATA,uU),this._events.set(u.NAVIGATOR_OPEN_ROOM_CREATOR,lU),this._events.set(u.NAVIGATOR_SEARCHES,cU),this._events.set(u.NAVIGATOR_SEARCH,dU),this._events.set(u.NAVIGATOR_SETTINGS,gU),this._events.set(u.GENERIC_ALERT,DU),this._events.set(u.MOTD_MESSAGES,yU),this._events.set(u.NOTIFICATION_LIST,LU),this._events.set(u.UNSEEN_ITEMS,bU),this._events.set(u.ACHIEVEMENT_NOTIFICATION,AU),this._events.set(u.INFO_FEED_ENABLE,PU),this._events.set(u.CLUB_GIFT_NOTIFICATION,MU),this._events.set(u.ACTIVITY_POINT_NOTIFICATION,SU),this._events.set(u.BOT_ERROR,Ed),this._events.set(u.PET_LEVEL_NOTIFICATION,UU),this._events.set(u.NOTIFICATION_SIMPLE_ALERT,vU),this._events.set(u.NOTIFICATION_ELEMENT_POINTER,NU),this._events.set(u.USER_PERKS,jU),this._events.set(u.PET_TRAINING_PANEL,YU),this._events.set(u.PET_LEVEL_UPDATE,Rd),this._events.set(u.PET_SCRATCH_FAILED,Td),this._events.set(u.PET_OPEN_PACKAGE_REQUESTED,md),this._events.set(u.PET_OPEN_PACKAGE_RESULT,Id),this._events.set(u.PET_BREEDING_RESULT,Pd),this._events.set(u.QUESTION,Md),this._events.set(u.POLL_CONTENTS,pd),this._events.set(u.POLL_ERROR,Od),this._events.set(u.POLL_OFFER,Ad),this._events.set(u.QUESTION_ANSWERED,Sd),this._events.set(u.QUESTION_FINISHED,Cd),this._events.set(u.COMMUNITY_GOAL_EARNED_PRIZES,WU),this._events.set(u.COMMUNITY_GOAL_PROGRESS,KU),this._events.set(u.CONCURRENT_USERS_GOAL_PROGRESS,XU),this._events.set(u.QUEST_DAILY,ZU),this._events.set(u.QUEST_CANCELLED,QU),this._events.set(u.QUEST_COMPLETED,JU),this._events.set(u.COMMUNITY_GOAL_HALL_OF_FAME,kU),this._events.set(u.EPIC_POPUP,qU),this._events.set(u.SEASONAL_QUESTS,ev),this._events.set(u.QUESTS,tv),this._events.set(u.QUEST,$U),this._events.set(u.ROOM_ENTER_ERROR,sv),this._events.set(u.ROOM_ENTER,u_),this._events.set(u.ROOM_FORWARD,iv),this._events.set(u.ROOM_DOORBELL_ACCEPTED,a_),this._events.set(u.ROOM_RIGHTS_CLEAR,o_),this._events.set(u.ROOM_RIGHTS_OWNER,h_),this._events.set(u.ROOM_RIGHTS,__),this._events.set(u.BOT_COMMAND_CONFIGURATION,rv),this._events.set(u.BOT_SKILL_LIST_UPDATE,av),this._events.set(u.BOT_FORCE_OPEN_CONTEXT_MENU,nv),this._events.set(u.ROOM_SETTINGS_CHAT,ov),this._events.set(u.ROOM_INFO_OWNER,_v),this._events.set(u.ROOM_SCORE,hv),this._events.set(u.ROOM_ROLLING,c_),this._events.set(u.FURNITURE_FLOOR_ADD,g_),this._events.set(u.FURNITURE_FLOOR,E_),this._events.set(u.FURNITURE_FLOOR_REMOVE,f_),this._events.set(u.FURNITURE_FLOOR_UPDATE,m_),this._events.set(u.ITEM_WALL_ADD,O_),this._events.set(u.ITEM_WALL,A_),this._events.set(u.ITEM_WALL_REMOVE,S_),this._events.set(u.ITEM_WALL_UPDATE,M_),this._events.set(u.FURNITURE_ALIASES,I_),this._events.set(u.FURNITURE_DATA,R_),this._events.set(u.FURNITURE_ITEMDATA,T_),this._events.set(u.ITEM_STACK_HELPER,cv),this._events.set(u.FURNITURE_STATE,p_),this._events.set(u.ITEM_DIMMER_SETTINGS,Dd),this._events.set(u.FURNITURE_STATE_2,d_),this._events.set(u.LOVELOCK_FURNI_FINISHED,gv),this._events.set(u.LOVELOCK_FURNI_FRIEND_COMFIRMED,Ev),this._events.set(u.LOVELOCK_FURNI_START,fv),this._events.set(u.OBJECTS_DATA_UPDATE,l_),this._events.set(u.FURNITURE_GROUP_CONTEXT_MENU_INFO,dv),this._events.set(u.FURNITURE_POSTIT_STICKY_POLE_OPEN,Tv),this._events.set(u.ROOM_SPECTATOR,bd),this._events.set(u.CUSTOM_USER_NOTIFICATION,uv),this._events.set(u.ROOM_MESSAGE_NOTIFICATION,pv),this._events.set(u.ROOM_POPULAR_TAGS_RESULT,EU),this._events.set(u.ROOM_RIGHTS_LIST,xv),this._events.set(u.ROOM_RIGHTS_LIST_ADD,bv),this._events.set(u.ROOM_RIGHTS_LIST_REMOVE,Fv),this._events.set(u.ROOM_BAN_LIST,vv),this._events.set(u.ROOM_SETTINGS_SAVE_ERROR,jv),this._events.set(u.ROOM_SETTINGS,wv),this._events.set(u.ROOM_SETTINGS_SAVE,Vv),this._events.set(u.ROOM_SETTINGS_ERROR,Hv),this._events.set(u.SHOW_ENFORCE_ROOM_CATEGORY,zv),this._events.set(u.ROOM_BAN_REMOVE,Yv),this._events.set(u.ROOM_MUTED,Gv),this._events.set(u.NO_SUCH_FLAT,Bv),this._events.set(u.FAVORITE_GROUP_UDPATE,Nd),this._events.set(u.ROOM_MODEL_DOOR,N_),this._events.set(u.ROOM_HEIGHT_MAP,D_),this._events.set(u.ROOM_HEIGHT_MAP_UPDATE,P_),this._events.set(u.ROOM_MODEL,C_),this._events.set(u.ROOM_MODEL_NAME,rr),this._events.set(u.ROOM_PAINT,y_),this._events.set(u.ROOM_THICKNESS,L_),this._events.set(u.ROOM_GET_FILTER_WORDS,IU),this._events.set(u.ROOM_MODEL_BLOCKED_TILES,Cv),this._events.set(u.PET_FIGURE_UPDATE,na),this._events.set(u.PET_INFO,Ld),this._events.set(u.PET_STATUS,Ud),this._events.set(u.PET_EXPERIENCE,yd),this._events.set(u.PLAYING_GAME,vd),this._events.set(u.UNIT_DANCE,_a),this._events.set(u.UNIT_EFFECT,v_),this._events.set(u.UNIT,ha),this._events.set(u.UNIT_EXPRESSION,b_),this._events.set(u.UNIT_HAND_ITEM,F_),this._events.set(u.UNIT_IDLE,x_),this._events.set(u.UNIT_INFO,ua),this._events.set(u.UNIT_NUMBER,G_),this._events.set(u.UNIT_REMOVE,la),this._events.set(u.UNIT_STATUS,B_),this._events.set(u.HAND_ITEM_RECEIVED,Gd),this._events.set(u.FLOOD_CONTROL,Fd),this._events.set(u.REMAINING_MUTE,xd),this._events.set(u.UNIT_CHAT,Nh),this._events.set(u.UNIT_CHAT_SHOUT,aa),this._events.set(u.UNIT_CHAT_WHISPER,oa),this._events.set(u.UNIT_TYPING,U_),this._events.set(u.WIRED_ACTION,Nv),this._events.set(u.WIRED_CONDITION,Dv),this._events.set(u.WIRED_TRIGGER,Pv),this._events.set(u.WIRED_OPEN,yv),this._events.set(u.WIRED_REWARD,Dh),this._events.set(u.WIRED_SAVE,Lv),this._events.set(u.WIRED_ERROR,Uv),this._events.set(u.AUTHENTICATED,Bd),this._events.set(u.JUKEBOX_PLAYLIST_FULL,wd),this._events.set(u.JUKEBOX_SONG_DISKS,Hd),this._events.set(u.NOW_PLAYING,Vd),this._events.set(u.OFFICIAL_SONG_ID,Wv),this._events.set(u.PLAYLIST,kv),this._events.set(u.PLAYLIST_SONG_ADDED,Kv),this._events.set(u.TRAX_SONG_INFO,jd),this._events.set(u.USER_SONG_DISKS_INVENTORY,zd),this._events.set(u.HELPER_TALENT_TRACK,Qv),this._events.set(u.TALENT_TRACK_LEVEL,qv),this._events.set(u.TALENT_TRACK_LEVEL_UP,Xv),this._events.set(u.IN_CLIENT_LINK,Jd),this._events.set(u.USER_IGNORED,Qd),this._events.set(u.USER_IGNORED_RESULT,yh),this._events.set(u.USER_RESPECT,tg),this._events.set(u.USER_PERMISSIONS,Yd),this._events.set(u.USER_BADGES_CURRENT,kd),this._events.set(u.USER_INFO,ca),this._events.set(u.UNIT_CHANGE_NAME,Ph),this._events.set(u.USER_SETTINGS,eb),this._events.set(u.USER_PROFILE,tb),this._events.set(u.MESSENGER_RELATIONSHIPS,$v),this._events.set(u.GIFT_OPENED,cd),this._events.set(u.USER_CREDITS,hb),this._events.set(u.USER_CURRENCY,ub),this._events.set(u.USER_SUBSCRIPTION,lb),this._events.set(u.USER_WARDROBE_PAGE,gb),this._events.set(u.USER_CLASSIFICATION,fb),this._events.set(u.GET_USER_TAGS,Kd),this._events.set(u.SCR_SEND_KICKBACK_INFO,db),this._events.set(u.PET_RESPECTED,Zd),this._events.set(u.PET_SUPPLEMENT,$d),this._events.set(u.ACCOUNT_SAFETY_LOCK_STATUS_CHANGE,Wd),this._events.set(u.GENERIC_ERROR,i_),this._events.set(u.GROUP_LIST,ob),this._events.set(u.CATALOG_APPROVE_NAME_RESULT,Jv),this._events.set(u.CONNECTION_ERROR,CU),this._events.set(u.GUILD_EDIT_FAILED,nb),this._events.set(u.GUILD_MEMBER_MGMT_FAILED,ab),this._events.set(u.EXTENDED_PROFILE_CHANGED,sb),this._events.set(u.NOOBNESS_LEVEL,od),this._events.set(u.DISCONNECT_REASON,fy),this._events.set(u.HANDSHAKE_INIT_DIFFIE,Iy),this._events.set(u.HANDSHAKE_COMPLETE_DIFFIE,Ey),this._events.set(u.HANDSHAKE_IDENTITY_ACCOUNT,my),this._events.set(u.NEW_USER_EXPERIENCE_GIFT_OFFER,wU),this._events.set(u.NEW_USER_EXPERIENCE_NOT_COMPLETE,VU),this._events.set(u.PHONE_COLLECTION_STATE,QP),this._events.set(u.PHONE_TRY_NUMBER_RESULT,JP),this._events.set(u.PHONE_TRY_VERIFICATION_CODE_RESULT,ZP),this._events.set(u.WELCOME_GIFT_CHANGE_EMAIL_RESULT,Eb),this._events.set(u.WELCOME_GIFT_STATUS,Ov),this._events.set(u.RENTABLE_SPACE_RENT_OK,Iv),this._events.set(u.RENTABLE_SPACE_STATUS,Rv),this._events.set(u.RENTABLE_SPACE_RENT_FAILED,mv),this._events.set(u.RECYCLER_STATUS,qa),this._events.set(u.RECYCLER_FINISHED,Ch),this._events.set(u.EMAIL_STATUS,Xd),this._events.set(u.CHANGE_EMAIL_RESULT,Zv),this._events.set(u.RENTABLE_FURNI_RENT_OR_BUYOUT_OFFER,lv)}registerComposers(){this._composers.set(h.AUTHENTICATION,jF),this._composers.set(h.INTERSTITIAL_SHOWN,Ib),this._composers.set(h.GET_INTERSTITIAL,mb),this._composers.set(h.GET_WARDROBE,Ob),this._composers.set(h.SAVE_WARDROBE_OUTFIT,Ab),this._composers.set(h.CHANGE_USERNAME,Tb),this._composers.set(h.CHECK_USERNAME,pb),this._composers.set(h.REQUEST_CAMERA_CONFIGURATION,Nb),this._composers.set(h.RENDER_ROOM,da),this._composers.set(h.RENDER_ROOM_THUMBNAIL,w_),this._composers.set(h.PURCHASE_PHOTO,Cb),this._composers.set(h.PUBLISH_PHOTO,Mb),this._composers.set(h.PHOTO_COMPETITION,Sb),this._composers.set(h.OPEN_CAMPAIGN_CALENDAR_DOOR,Pb),this._composers.set(h.OPEN_CAMPAIGN_CALENDAR_DOOR_STAFF,Db),this._composers.set(h.BUILDERS_CLUB_PLACE_ROOM_ITEM,yb),this._composers.set(h.BUILDERS_CLUB_PLACE_WALL_ITEM,Lb),this._composers.set(h.BUILDERS_CLUB_QUERY_FURNI_COUNT,Ub),this._composers.set(h.GET_CATALOG_INDEX,Fb),this._composers.set(h.GET_CATALOG_PAGE,xb),this._composers.set(h.CATALOG_PURCHASE,s0),this._composers.set(h.CATALOG_PURCHASE_GIFT,e0),this._composers.set(h.GET_PRODUCT_OFFER,Xb),this._composers.set(h.GET_CLUB_OFFERS,Hb),this._composers.set(h.GET_CLUB_GIFT_INFO,wb),this._composers.set(h.CATALOG_REDEEM_VOUCHER,a0),this._composers.set(h.GROUP_MEMBERSHIPS,GB),this._composers.set(h.GET_GIFT_WRAPPING_CONFIG,jb),this._composers.set(h.CATALOG_SELECT_VIP_GIFT,_0),this._composers.set(h.CATALOG_REQUESET_PET_BREEDS,Jb),this._composers.set(h.GET_BONUS_RARE_INFO,vb),this._composers.set(h.GET_BUNDLE_DISCOUNT_RULESET,bb),this._composers.set(h.GET_CATALOG_PAGE_EXPIRATION,Gb),this._composers.set(h.GET_CATALOG_PAGE_WITH_EARLIEST_EXP,Bb),this._composers.set(h.GET_DIRECT_CLUB_BUY_AVAILABLE,Vb),this._composers.set(h.GET_HABBO_BASIC_MEMBERSHIP_EXTEND_OFFER,zb),this._composers.set(h.GET_HABBO_CLUB_EXTEND_OFFER,Yb),this._composers.set(h.GET_IS_OFFER_GIFTABLE,Wb),this._composers.set(h.GET_LIMITED_OFFER_APPEARING_NEXT,kb),this._composers.set(h.GET_NEXT_TARGETED_OFFER,Kb),this._composers.set(h.GET_ROOM_AD_PURCHASE_INFO,qb),this._composers.set(h.GET_SEASONAL_CALENDAR_DAILY_OFFER,Qb),this._composers.set(h.GET_TARGETED_OFFER,Zb),this._composers.set(h.MARK_CATALOG_NEW_ADDITIONS_PAGE_OPENED,$b),this._composers.set(h.PURCHASE_BASIC_MEMBERSHIP_EXTENSION,t0),this._composers.set(h.PURCHASE_ROOM_AD,i0),this._composers.set(h.PURCHASE_TARGETED_OFFER,r0),this._composers.set(h.PURCHASE_VIP_MEMBERSHIP_EXTENSION,n0),this._composers.set(h.ROOM_AD_PURCHASE_INITIATED,o0),this._composers.set(h.SET_TARGETTED_OFFER_STATE,h0),this._composers.set(h.SHOP_TARGETED_OFFER_VIEWED,u0),this._composers.set(h.FORWARD_TO_A_COMPETITION_ROOM,l0),this._composers.set(h.FORWARD_TO_A_SUBMITTABLE_ROOM,c0),this._composers.set(h.FORWARD_TO_RANDOM_COMPETITION_ROOM,d0),this._composers.set(h.GET_CURRENT_TIMING_CODE,g0),this._composers.set(h.GET_IS_USER_PART_OF_COMPETITION,E0),this._composers.set(h.GET_SECONDS_UNTIL,f0),this._composers.set(h.ROOM_COMPETITION_INIT,m0),this._composers.set(h.SUBMIT_ROOM_TO_COMPETITION,En),this._composers.set(h.VOTE_FOR_ROOM,I0),this._composers.set(h.CRAFT,R0),this._composers.set(h.CRAFT_SECRET,T0),this._composers.set(h.GET_CRAFTABLE_PRODUCTS,O0),this._composers.set(h.GET_CRAFTING_RECIPE,p0),this._composers.set(h.GET_CRAFTING_RECIPES_AVAILABLE,A0),this._composers.set(h.FRIEND_FURNI_CONFIRM_LOCK,M0),this._composers.set(h.ACCEPT_FRIEND,C0),this._composers.set(h.DECLINE_FRIEND,N0),this._composers.set(h.FIND_NEW_FRIENDS,D0),this._composers.set(h.FOLLOW_FRIEND,P0),this._composers.set(h.FRIEND_LIST_UPDATE,y0),this._composers.set(h.GET_FRIEND_REQUESTS,L0),this._composers.set(h.HABBO_SEARCH,U0),this._composers.set(h.MESSENGER_INIT,v0),this._composers.set(h.REMOVE_FRIEND,b0),this._composers.set(h.REQUEST_FRIEND,F0),this._composers.set(h.MESSENGER_CHAT,x0),this._composers.set(h.SEND_ROOM_INVITE,G0),this._composers.set(h.SET_RELATIONSHIP_STATUS,B0),this._composers.set(h.VISIT_USER,w0),this._composers.set(h.ACHIEVEMENT_RESOLUTION_OPEN,eg),this._composers.set(h.ACCEPTGAMEINVITE,K0),this._composers.set(h.GAMEUNLOADEDMESSAGE,X0),this._composers.set(h.GETGAMEACHIEVEMENTSMESSAGE,q0),this._composers.set(h.GAMES_LIST,Q0),this._composers.set(h.GETGAMESTATUSMESSAGE,J0),this._composers.set(h.GETUSERGAMEACHIEVEMENTSMESSAGE,Z0),this._composers.set(h.JOINQUEUEMESSAGE,$0),this._composers.set(h.LEAVEQUEUEMESSAGE,tF),this._composers.set(h.RESETRESOLUTIONACHIEVEMENTMESSAGE,eF),this._composers.set(h.GAMES_INIT,rF),this._composers.set(h.GETWEEKLYGAMEREWARDWINNERS,nF),this._composers.set(h.GAME2GETACCOUNTGAMESTATUSMESSAGE,W0),this._composers.set(h.GAME2CHECKGAMEDIRECTORYSTATUSMESSAGE,Y0),this._composers.set(h.GAME2EXITGAMEMESSAGE,H0),this._composers.set(h.GAME2GAMECHATMESSAGE,V0),this._composers.set(h.GAME2LOADSTAGEREADYMESSAGE,j0),this._composers.set(h.GAME2PLAYAGAINMESSAGE,z0),this._composers.set(h.GAME2REQUESTFULLSTATUSUPDATEMESSAGE,k0),this._composers.set(h.GAME2GETWEEKLYFRIENDSLEADERBOARD,sF),this._composers.set(h.GAME2GETWEEKLYLEADERBOARD,iF),this._composers.set(h.GET_GIFT,sg),this._composers.set(h.RESET_PHONE_NUMBER_STATE,aF),this._composers.set(h.SET_PHONE_NUMBER_VERIFICATION_STATUS,ig),this._composers.set(h.TRY_PHONE_NUMBER,oF),this._composers.set(h.VERIFY_CODE,_F),this._composers.set(h.GET_FORUM_STATS,LF),this._composers.set(h.GET_FORUMS_LIST,yF),this._composers.set(h.GET_FORUM_MESSAGES,UF),this._composers.set(h.GET_FORUM_THREAD,vF),this._composers.set(h.GET_FORUM_THREADS,bF),this._composers.set(h.GET_UNREAD_FORUMS_COUNT,FF),this._composers.set(h.FORUM_MODERATE_MESSAGE,xF),this._composers.set(h.FORUM_MODERATE_THREAD,GF),this._composers.set(h.FORUM_POST_MESSAGE,BF),this._composers.set(h.UPDATE_FORUM_READ_MARKER,wF),this._composers.set(h.UPDATE_FORUM_SETTINGS,HF),this._composers.set(h.FORUM_UPDATE_THREAD,VF),this._composers.set(h.CLIENT_PONG,ag),this._composers.set(h.RELEASE_VERSION,rg),this._composers.set(h.SECURITY_TICKET,og),this._composers.set(h.USER_INFO,ng),this._composers.set(h.DISCONNECT,YF),this._composers.set(h.SECURITY_MACHINE,kF),this._composers.set(h.CLIENT_VARIABLES,KF),this._composers.set(h.HANDSHAKE_INIT_DIFFIE,WF),this._composers.set(h.HANDSHAKE_COMPLETE_DIFFIE,zF),this._composers.set(h.CALL_FOR_HELP_FROM_FORUM_MESSAGE,XF),this._composers.set(h.CALL_FOR_HELP_FROM_FORUM_THREAD,qF),this._composers.set(h.CALL_FOR_HELP_FROM_IM,QF),this._composers.set(h.CALL_FOR_HELP_FROM_PHOTO,JF),this._composers.set(h.CALL_FOR_HELP_FROM_SELFIE,ZF),this._composers.set(h.CALL_FOR_HELP,$F),this._composers.set(h.CHAT_REVIEW_GUIDE_DECIDES,tx),this._composers.set(h.CHAT_REVIEW_GUIDE_DETACHED,ex),this._composers.set(h.CHAT_REVIEW_GUIDE_VOTE,sx),this._composers.set(h.CHAT_REVIEW_SESSION_CREATE,ix),this._composers.set(h.DELETE_PENDING_CALLS_FOR_HELP,rx),this._composers.set(h.GET_CFH_STATUS,nx),this._composers.set(h.GET_FAQ_CATEGORY,ax),this._composers.set(h.GET_FAQ_TEXT,ox),this._composers.set(h.GET_GUIDE_REPORTING_STATUS,_x),this._composers.set(h.GET_PENDING_CALLS_FOR_HELP,hx),this._composers.set(h.GET_QUIZ_QUESTIONS,ux),this._composers.set(h.GUIDE_SESSION_CREATE,lx),this._composers.set(h.GUIDE_SESSION_FEEDBACK,cx),this._composers.set(h.GUIDE_SESSION_GET_REQUESTER_ROOM,dx),this._composers.set(h.GUIDE_SESSION_GUIDE_DECIDES,gx),this._composers.set(h.GUIDE_SESSION_INVITE_REQUESTER,Ex),this._composers.set(h.GUIDE_SESSION_IS_TYPING,fx),this._composers.set(h.GUIDE_SESSION_MESSAGE,mx),this._composers.set(h.GUIDE_SESSION_ON_DUTY_UPDATE,Ix),this._composers.set(h.GUIDE_SESSION_REPORT,Rx),this._composers.set(h.GUIDE_SESSION_REQUESTER_CANCELS,Tx),this._composers.set(h.GUIDE_SESSION_RESOLVED,px),this._composers.set(h.POST_QUIZ_ANSWERS,Ox),this._composers.set(h.SEARCH_FAQS,Ax),this._composers.set(h.DESKTOP_VIEW,S0),this._composers.set(h.GROUP_INFO,IF),this._composers.set(h.GROUP_REQUEST,RF),this._composers.set(h.GROUP_MEMBER_REMOVE_CONFIRM,EF),this._composers.set(h.GROUP_MEMBER_REMOVE,AF),this._composers.set(h.GROUP_MEMBERS,TF),this._composers.set(h.GROUP_ADMIN_ADD,uF),this._composers.set(h.GROUP_ADMIN_REMOVE,lF),this._composers.set(h.GROUP_REQUEST_ACCEPT,pF),this._composers.set(h.GROUP_REQUEST_DECLINE,OF),this._composers.set(h.GROUP_DELETE,fF),this._composers.set(h.GROUP_CREATE_OPTIONS,gF),this._composers.set(h.GROUP_PARTS,cF),this._composers.set(h.GROUP_BUY,dF),this._composers.set(h.GROUP_SETTINGS,DF),this._composers.set(h.GROUP_SAVE_BADGE,SF),this._composers.set(h.GROUP_SAVE_COLORS,MF),this._composers.set(h.GROUP_SAVE_INFORMATION,CF),this._composers.set(h.GROUP_SAVE_PREFERENCES,NF),this._composers.set(h.GROUP_FAVORITE,mF),this._composers.set(h.GROUP_UNFAVORITE,PF),this._composers.set(h.GROUP_BADGES,NE),this._composers.set(h.APPROVE_ALL_MEMBERSHIP_REQUESTS,hF),this._composers.set(h.GROUP_UNBLOCK_MEMBER,JB),this._composers.set(h.ROOM_FAVORITE,A1),this._composers.set(h.CAN_CREATE_ROOM,M1),this._composers.set(h.CANCEL_ROOM_EVENT,S1),this._composers.set(h.CONVERT_GLOBAL_ROOM_ID,N1),this._composers.set(h.COMPETITION_ROOM_SEARCH,C1),this._composers.set(h.ROOM_CREATE,D1),this._composers.set(h.GET_USER_FLAT_CATS,w1),this._composers.set(h.GET_USER_EVENT_CATS,B1),this._composers.set(h.ROOM_FAVORITE_REMOVE,P1),this._composers.set(h.EDIT_ROOM_EVENT,y1),this._composers.set(h.FORWARD_TO_RANDOM_PROMOTED_ROOM,L1),this._composers.set(h.FORWARD_TO_SOME_ROOM,U1),this._composers.set(h.GET_CATEGORIES_WITH_USER_COUNT,v1),this._composers.set(h.GET_GUEST_ROOM,F1),this._composers.set(h.GET_OFFICIAL_ROOMS,x1),this._composers.set(h.GET_POPULAR_ROOM_TAGS,G1),this._composers.set(h.GUILD_BASE_SEARCH,H1),this._composers.set(h.MY_FAVOURITE_ROOMS_SEARCH,V1),this._composers.set(h.MY_FREQUENT_ROOM_HISTORY_SEARCH,j1),this._composers.set(h.MY_FRIENDS_ROOM_SEARCH,z1),this._composers.set(h.MY_GUILD_BASES_SEARCH,Y1),this._composers.set(h.MY_RECOMMENDED_ROOMS,W1),this._composers.set(h.MY_ROOM_HISTORY_SEARCH,k1),this._composers.set(h.MY_ROOM_RIGHTS_SEARCH,K1),this._composers.set(h.MY_ROOMS_SEARCH,X1),this._composers.set(h.POPULAR_ROOMS_SEARCH,iG),this._composers.set(h.ROOM_LIKE,rG),this._composers.set(h.ROOM_RIGHTS_REMOVE_OWN,nG),this._composers.set(h.ROOM_AD_EVENT_TAB_CLICKED,aG),this._composers.set(h.ROOM_AD_EVENT_TAB_VIEWED,oG),this._composers.set(h.ROOM_AD_SEARCH,_G),this._composers.set(h.ROOM_TEXT_SEARCH,lG),this._composers.set(h.ROOMS_WHERE_MY_FRIENDS_ARE,hG),this._composers.set(h.ROOMS_WITH_HIGHEST_SCORE_SEARCH,uG),this._composers.set(h.SET_ROOM_SESSION_TAGS,cG),this._composers.set(h.ROOM_STAFF_PICK,dG),this._composers.set(h.ROOM_FILTER_WORDS,b1),this._composers.set(h.ROOM_FILTER_WORDS_MODIFY,EG),this._composers.set(h.USER_HOME_ROOM,gG),this._composers.set(h.UPDATE_ROOM_THUMBNAIL,fG),this._composers.set(h.NAVIGATOR_INIT,J1),this._composers.set(h.NAVIGATOR_SEARCH_CLOSE,Z1),this._composers.set(h.NAVIGATOR_SEARCH,$1),this._composers.set(h.NAVIGATOR_SEARCH_OPEN,tG),this._composers.set(h.NAVIGATOR_SEARCH_SAVE,eG),this._composers.set(h.NAVIGATOR_SETTINGS_SAVE,sG),this._composers.set(h.NAVIGATOR_CATEGORY_LIST_MODE,q1),this._composers.set(h.NAVIGATOR_DELETE_SAVED_SEARCH,Q1),this._composers.set(h.POLL_ANSWER,Ig),this._composers.set(h.POLL_REJECT,Rg),this._composers.set(h.POLL_START,Tg),this._composers.set(h.USER_EFFECT_ACTIVATE,Sx),this._composers.set(h.USER_EFFECT_ENABLE,Mx),this._composers.set(h.USER_BADGES,Px),this._composers.set(h.USER_BADGES_CURRENT_UPDATE,yx),this._composers.set(h.GET_BADGE_POINTS_LIMITS,Cx),this._composers.set(h.REQUESTABADGE,Dx),this._composers.set(h.GETISBADGEREQUESTFULFILLED,Nx),this._composers.set(h.USER_BOTS,Nu),this._composers.set(h.USER_FURNITURE,Lx),this._composers.set(h.REQUESTFURNIINVENTORYWHENNOTINROOM,Ux),this._composers.set(h.USER_PETS,Du),this._composers.set(h.TRADE_ACCEPT,Fx),this._composers.set(h.TRADE_CANCEL,xx),this._composers.set(h.TRADE_CLOSE,Gx),this._composers.set(h.TRADE_CONFIRM,Bx),this._composers.set(h.TRADE_ITEM,wx),this._composers.set(h.TRADE_ITEMS,Hx),this._composers.set(h.TRADE_ITEM_REMOVE,Vx),this._composers.set(h.TRADE,jx),this._composers.set(h.TRADE_UNACCEPT,zx),this._composers.set(h.UNSEEN_RESET_CATEGORY,Yx),this._composers.set(h.UNSEEN_RESET_ITEMS,Wx),this._composers.set(h.ACHIEVEMENT_LIST,Rb),this._composers.set(h.PET_MOUNT,H_),this._composers.set(h.PET_RESPECT,cg),this._composers.set(h.PET_SUPPLEMENT,IG),this._composers.set(h.REMOVE_PET_SADDLE,dg),this._composers.set(h.PET_INFO,gg),this._composers.set(h.TOGGLE_PET_BREEDING,Eg),this._composers.set(h.TOGGLE_PET_RIDING,fg),this._composers.set(h.USE_PET_PRODUCT,mg),this._composers.set(h.GET_PET_TRAINING_PANEL,lg),this._composers.set(h.PET_OPEN_PACKAGE,eE),this._composers.set(h.PET_SELECTED,IB),this._composers.set(h.PETS_BREED,Ja),this._composers.set(h.PET_CANCEL_BREEDING,vx),this._composers.set(h.PET_CONFIRM_BREEDING,bx),this._composers.set(h.ROOM_ENTER,Og),this._composers.set(h.ROOM_DOORBELL,pg),this._composers.set(h.GO_TO_FLAT,nE),this._composers.set(h.CHANGE_QUEUE,rE),this._composers.set(h.ROOM_AMBASSADOR_ALERT,Ag),this._composers.set(h.ROOM_BAN_GIVE,Sg),this._composers.set(h.ROOM_BAN_REMOVE,wG),this._composers.set(h.ROOM_RIGHTS_GIVE,Mg),this._composers.set(h.ROOM_KICK,Cg),this._composers.set(h.ROOM_MUTE_USER,Ng),this._composers.set(h.ROOM_RIGHTS_REMOVE,Dg),this._composers.set(h.ROOM_RIGHTS_REMOVE_ALL,GG),this._composers.set(h.ROOM_DELETE,BG),this._composers.set(h.ROOM_SETTINGS,jG),this._composers.set(h.ROOM_SETTINGS_SAVE,YG),this._composers.set(h.ROOM_RIGHTS_LIST,zG),this._composers.set(h.ROOM_BAN_LIST,VG),this._composers.set(h.ROOM_SETTINGS_UPDATE_ROOM_CATEGORY_AND_TRADE,CB),this._composers.set(h.BOT_CONFIGURATION,HG),this._composers.set(h.GET_ITEM_DATA,vg),this._composers.set(h.REMOVE_WALL_ITEM,Gg),this._composers.set(h.BOT_PLACE,Pg),this._composers.set(h.BOT_PICKUP,yg),this._composers.set(h.BOT_SKILL_SAVE,WG),this._composers.set(h.PET_PLACE,Fg),this._composers.set(h.PET_MOVE,V_),this._composers.set(h.PET_PICKUP,xg),this._composers.set(h.SET_ITEM_DATA,wg),this._composers.set(h.SET_OBJECT_DATA,Hg),this._composers.set(h.COMPOST_PLANT,Ug),this._composers.set(h.HARVEST_PET,bg),this._composers.set(h.SET_CLOTHING_CHANGE_DATA,Bg),this._composers.set(h.FURNITURE_ALIASES,Yg),this._composers.set(h.FURNITURE_GROUP_INFO,Wg),this._composers.set(h.FURNITURE_PICKUP,kg),this._composers.set(h.FURNITURE_PLACE,Kg),this._composers.set(h.ITEM_PAINT,qG),this._composers.set(h.FURNITURE_POSTIT_PLACE,Xg),this._composers.set(h.FURNITURE_POSTIT_SAVE_STICKY_POLE,kG),this._composers.set(h.CONTROL_YOUTUBE_DISPLAY_PLAYBACK,oB),this._composers.set(h.GET_YOUTUBE_DISPLAY_STATUS,_B),this._composers.set(h.SET_YOUTUBE_DISPLAY_PLAYLIST,hB),this._composers.set(h.FURNITURE_FLOOR_UPDATE,j_),this._composers.set(h.FURNITURE_WALL_UPDATE,iE),this._composers.set(h.ITEM_DIMMER_SETTINGS,Vg),this._composers.set(h.ITEM_DIMMER_SAVE,jg),this._composers.set(h.ITEM_DIMMER_TOGGLE,zg),this._composers.set(h.ROOM_TONER_APPLY,aB),this._composers.set(h.ITEM_COLOR_WHEEL_CLICK,qg),this._composers.set(h.ITEM_DICE_CLICK,Qg),this._composers.set(h.ITEM_DICE_CLOSE,Jg),this._composers.set(h.FURNITURE_MULTISTATE,Lh),this._composers.set(h.FURNITURE_RANDOMSTATE,$g),this._composers.set(h.ITEM_STACK_HELPER,ZG),this._composers.set(h.FURNITURE_WALL_MULTISTATE,tE),this._composers.set(h.ONE_WAY_DOOR_CLICK,Zg),this._composers.set(h.ITEM_EXCHANGE_REDEEM,JG),this._composers.set(h.ITEM_CLOTHING_REDEEM,dB),this._composers.set(h.ROOM_MODEL,z_),this._composers.set(h.GET_OCCUPIED_TILES,uB),this._composers.set(h.GET_ROOM_ENTRY_TILE,lB),this._composers.set(h.ROOM_MODEL_SAVE,cB),this._composers.set(h.UNIT_ACTION,uE),this._composers.set(h.UNIT_DANCE,lE),this._composers.set(h.UNIT_DROP_HAND_ITEM,EB),this._composers.set(h.UNIT_GIVE_HANDITEM,fB),this._composers.set(h.UNIT_GIVE_HANDITEM_PET,mB),this._composers.set(h.UNIT_LOOK,cE),this._composers.set(h.UNIT_SIGN,gE),this._composers.set(h.UNIT_POSTURE,dE),this._composers.set(h.UNIT_WALK,EE),this._composers.set(h.UNIT_CHAT,Uh),this._composers.set(h.UNIT_CHAT_SHOUT,aE),this._composers.set(h.USER_SETTINGS_CHAT_STYLE,gB),this._composers.set(h.UNIT_CHAT_WHISPER,oE),this._composers.set(h.UNIT_TYPING,_E),this._composers.set(h.UNIT_TYPING_STOP,hE),this._composers.set(h.WIRED_APPLY_SNAPSHOT,TB),this._composers.set(h.WIRED_OPEN,pB),this._composers.set(h.WIRED_ACTION_SAVE,AB),this._composers.set(h.WIRED_CONDITION_SAVE,SB),this._composers.set(h.WIRED_TRIGGER_SAVE,MB),this._composers.set(h.ROOM_MUTE,OB),this._composers.set(h.APPROVE_NAME,xB),this._composers.set(h.USER_RESPECT,DE),this._composers.set(h.SCR_GET_KICKBACK_INFO,kB),this._composers.set(h.PEER_USERS_CLASSIFICATION,PE),this._composers.set(h.USER_CLASSIFICATION,yE),this._composers.set(h.USER_IGNORED,TE),this._composers.set(h.USER_IGNORE,OE),this._composers.set(h.USER_IGNORE_ID,AE),this._composers.set(h.USER_UNIGNORE,SE),this._composers.set(h.USER_BADGES_CURRENT,ME),this._composers.set(h.USER_FIGURE,HB),this._composers.set(h.USER_MOTTO,CE),this._composers.set(h.USER_PROFILE,VB),this._composers.set(h.USER_PROFILE_BY_NAME,wB),this._composers.set(h.USER_TAGS,pE),this._composers.set(h.MESSENGER_RELATIONSHIPS,jB),this._composers.set(h.MANNEQUIN_SAVE_NAME,tB),this._composers.set(h.MANNEQUIN_SAVE_LOOK,$G),this._composers.set(h.PRESENT_OPEN_PRESENT,sE),this._composers.set(h.MARKETPLACE_CONFIG,Zx),this._composers.set(h.MARKETPLACE_SELL_ITEM,s1),this._composers.set(h.MARKETPLACE_REQUEST_OWN_ITEMS,e1),this._composers.set(h.MARKETPLACE_TAKE_BACK_ITEM,Qx),this._composers.set(h.MARKETPLACE_REQUEST_OFFERS,t1),this._composers.set(h.MARKETPLACE_BUY_OFFER,Xx),this._composers.set(h.MARKETPLACE_REDEEM_CREDITS,i1),this._composers.set(h.MARKETPLACE_BUY_TOKENS,qx),this._composers.set(h.REQUEST_SELL_ITEM,Jx),this._composers.set(h.REQUEST_MARKETPLACE_ITEM_STATS,$x),this._composers.set(h.USER_BOTS,Nu),this._composers.set(h.USER_PETS,Du),this._composers.set(h.USER_CURRENCY,YB),this._composers.set(h.USER_SUBSCRIPTION,WB),this._composers.set(h.MODTOOL_REQUEST_ROOM_INFO,o1),this._composers.set(h.MODTOOL_CHANGE_ROOM_SETTINGS,d1),this._composers.set(h.MODTOOL_REQUEST_USER_CHATLOG,l1),this._composers.set(h.MODTOOL_REQUEST_ROOM_CHATLOG,h1),this._composers.set(h.MOD_TOOL_USER_INFO,_1),this._composers.set(h.MODTOOL_SANCTION_ALERT,c1),this._composers.set(h.MODTOOL_SANCTION_BAN,Li),this._composers.set(h.MODTOOL_SANCTION_KICK,g1),this._composers.set(h.MODTOOL_SANCTION_TRADELOCK,R1),this._composers.set(h.MODTOOL_ALERTEVENT,E1),this._composers.set(h.MODTOOL_SANCTION_MUTE,f1),this._composers.set(h.MODTOOL_REQUEST_USER_ROOMS,u1),this._composers.set(h.MODTOOL_ROOM_ALERT,fn),this._composers.set(h.CLOSE_ISSUE_DEFAULT_ACTION,r1),this._composers.set(h.CLOSE_ISSUES,Qa),this._composers.set(h.DEFAULT_SANCTION,n1),this._composers.set(h.GET_CFH_CHATLOG,a1),this._composers.set(h.MODTOOL_PREFERENCES,m1),this._composers.set(h.MODTOOL_SANCTION,I1),this._composers.set(h.PICK_ISSUES,T1),this._composers.set(h.RELEASE_ISSUES,p1),this._composers.set(h.MYSTERYBOXWAITINGCANCELEDMESSAGE,O1),this._composers.set(h.MYSTERYBOX_OPEN_TROPHY,eB),this._composers.set(h.USER_SETTINGS_CAMERA,KB),this._composers.set(h.USER_SETTINGS_OLD_CHAT,XB),this._composers.set(h.USER_SETTINGS_INVITES,qB),this._composers.set(h.USER_SETTINGS_VOLUME,QB),this._composers.set(h.COMMUNITY_GOAL_VOTE_COMPOSER,Kx),this._composers.set(h.GET_PROMO_ARTICLES,kx),this._composers.set(h.ACCEPT_QUEST,RG),this._composers.set(h.ACTIVATE_QUEST,TG),this._composers.set(h.CANCEL_QUEST,pG),this._composers.set(h.FRIEND_REQUEST_QUEST_COMPLETE,OG),this._composers.set(h.GET_COMMUNITY_GOAL_EARNED_PRIZES,AG),this._composers.set(h.GET_COMMUNITY_GOAL_HALL_OF_FAME,SG),this._composers.set(h.GET_COMMUNITY_GOAL_PROGRESS,MG),this._composers.set(h.GET_CONCURRENT_USERS_GOAL_PROGRESS,CG),this._composers.set(h.GET_CONCURRENT_USERS_REWARD,NG),this._composers.set(h.GET_DAILY_QUEST,DG),this._composers.set(h.GET_QUESTS,PG),this._composers.set(h.GET_SEASONAL_QUESTS_ONLY,yG),this._composers.set(h.OPEN_QUEST_TRACKER,LG),this._composers.set(h.REDEEM_COMMUNITY_GOAL_PRIZE,UG),this._composers.set(h.REJECT_QUEST,vG),this._composers.set(h.START_CAMPAIGN,bG),this._composers.set(h.GET_SOUND_SETTINGS,yB),this._composers.set(h.ADD_JUKEBOX_DISK,NB),this._composers.set(h.GET_JUKEBOX_PLAYLIST,fE),this._composers.set(h.GET_NOW_PLAYING,mE),this._composers.set(h.GET_OFFICIAL_SONG_ID,DB),this._composers.set(h.GET_SONG_INFO,IE),this._composers.set(h.GET_SOUND_MACHINE_PLAYLIST,PB),this._composers.set(h.GET_USER_SONG_DISKS,RE),this._composers.set(h.REMOVE_JUKEBOX_DISK,LB),this._composers.set(h.HELPER_TALENT_TRACK,vB),this._composers.set(h.TALENT_TRACK_GET_LEVEL,UB),this._composers.set(h.NEW_USER_EXPERIENCE_GET_GIFTS,mG),this._composers.set(h.NEW_USER_EXPERIENCE_SCRIPT_PROCEED,ug),this._composers.set(h.WELCOME_OPEN_GIFT,sB),this._composers.set(h.WELCOME_GIFT_CHANGE_EMAIL,ZB),this._composers.set(h.EMAIL_GET_STATUS,zB),this._composers.set(h.EMAIL_CHANGE,BB),this._composers.set(h.RENTABLE_SPACE_CANCEL_RENT,iB),this._composers.set(h.RENTABLE_SPACE_RENT,rB),this._composers.set(h.RENTABLE_SPACE_STATUS,nB),this._composers.set(h.RECYCLER_STATUS,FG),this._composers.set(h.RECYCLER_ITEMS,xG),this._composers.set(h.TRACKING_PERFORMANCE_LOG,FB),this._composers.set(h.TRACKING_LAG_WARNING_REPORT,bB),this._composers.set(h.ROOM_DIRECTORY_ROOM_NETWORK_OPEN_CONNECTION,RB),this._composers.set(h.RENTABLE_EXTEND_RENT_OR_BUYOUT_STRIP_ITEM,XG),this._composers.set(h.RENTABLE_EXTEND_RENT_OR_BUYOUT_FURNI,KG),this._composers.set(h.RENTABLE_GET_RENT_OR_BUYOUT_OFFER,QG)}get events(){return this._events}get composers(){return this._composers}}class ew extends ns{constructor(t){super(),this._communication=t,this._connection=null,this._messages=new tw,this._demo=new $B(this),this.onConnectionOpenedEvent=this.onConnectionOpenedEvent.bind(this),this.onConnectionClosedEvent=this.onConnectionClosedEvent.bind(this),this.onConnectionErrorEvent=this.onConnectionErrorEvent.bind(this),this.onConnectionAuthenticatedEvent=this.onConnectionAuthenticatedEvent.bind(this)}onInit(){this._connection||(H.instance.events.addEventListener(Qt.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),this._connection=this._communication.createConnection(this),this._connection.registerMessages(this._messages),this._connection.addEventListener(Bt.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.addEventListener(Bt.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.addEventListener(Bt.CONNECTION_ERROR,this.onConnectionErrorEvent),this._demo&&this._demo.init(),this._connection.init(k.getValue("socket.url")))}onDispose(){this._demo&&this._demo.dispose(),this._connection&&(this._connection.removeEventListener(Bt.CONNECTION_OPENED,this.onConnectionOpenedEvent),this._connection.removeEventListener(Bt.CONNECTION_CLOSED,this.onConnectionClosedEvent),this._connection.removeEventListener(Bt.CONNECTION_ERROR,this.onConnectionErrorEvent)),H.instance.events.removeEventListener(Qt.CONNECTION_AUTHENTICATED,this.onConnectionAuthenticatedEvent),super.onDispose()}onConnectionOpenedEvent(t){G.log("Connection Initialized")}onConnectionClosedEvent(t){G.log("Connection Closed")}onConnectionErrorEvent(t){G.log("Connection Error")}onConnectionAuthenticatedEvent(t){G.log("Connection Authenticated"),this._connection&&this._connection.authenticated()}connectionInit(t){G.log("Initializing Connection",t)}registerMessageEvent(t){return this._connection&&this._connection.addMessageEvent(t),t}removeMessageEvent(t){this._connection&&this._connection.removeMessageEvent(t)}get demo(){return this._demo}get connection(){return this._connection}}const vh=class Wn{static get available(){return this._isListeningForPostMessages||(this._isListeningForPostMessages=!0,window.addEventListener("message",t=>{if(typeof t.data=="string"&&t.data.startsWith(Wn.MESSAGE_KEY)){const{method:e,params:s}=JSON.parse(t.data.substr(Wn.MESSAGE_KEY.length)),i=window[e];if(!i)return;i(...s);return}})),!0}static call(t,...e){if(window.top!==window&&window.top.postMessage(Wn.MESSAGE_KEY+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalInterface"in window))return;const s=window.FlashExternalInterface[t];return typeof s<"u"?s(...e):void 0}static callGame(t,...e){if(window.top!==window&&window.top.postMessage("Nitro_LegacyExternalGameInterface"+JSON.stringify({method:t,params:e}),"*"),!("FlashExternalGameInterface"in window))return;const s=window.FlashExternalGameInterface[t];return typeof s<"u"?s(...e):void 0}static addCallback(t,e){window[t]=e}};vh.MESSAGE_KEY="Nitro_LegacyExternalInterface";vh._isListeningForPostMessages=!1;let at=vh;class sw{constructor(t){t.addMessageEvent(new nd(this.onLoadGameUrl.bind(this)))}onLoadGameUrl(t){if(!t)return;const e=t.getParser();e&&at.callGame("showGame",e.url)}}class Ao{constructor(t){this._badgeId="",this._level=1,this._base="",this._badgeId=t,this.parseText()}parseText(){let t=this._badgeId.length-1;for(;t>0&&this.isNumber(this._badgeId.charAt(t));)t--;this._base=this._badgeId.substr(0,t+1);const e=this._badgeId.substr(t+1,this._badgeId.length);e&&e!==""&&(this._level=Number.parseInt(e))}isNumber(t){const e=t.charCodeAt(0);return e>=48&&e<=57}get level(){return this._level}set level(t){this._level=Math.max(1,t)}get getBadgeId(){return this._base+this._level}get base(){return this._base}}class iw extends ns{constructor(t){super(),this._communication=t,this._definitions=new Map,this._parameters=new Map,this._badgePointLimits=new Map,this._romanNumerals=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX","XXI","XXII","XXIII","XXIV","XXV","XXVI","XXVII","XXVIII","XXIX","XXX"],this._pendingUrls=[]}onInit(){this._communication.registerMessageEvent(new ld(this.onBadgePointLimitsEvent.bind(this)));let t=k.getValue("external.texts.url");Array.isArray(t)||(t=[k.getValue("external.texts.url")]);for(let e=0;e<t.length;e++)t[e]=k.interpolate(t[e]);this._pendingUrls=t,this.loadNextLocalization()}loadNextLocalization(){if(!this._pendingUrls.length){this.events&&this.events.dispatchEvent(new Ji(Ji.LOADED));return}this.loadLocalizationFromURL(this._pendingUrls[0])}loadLocalizationFromURL(t){fetch(t).then(e=>e.json()).then(e=>this.onLocalizationLoaded(e,t)).catch(e=>this.onLocalizationFailed(e))}onLocalizationLoaded(t,e){if(!t)return;if(!this.parseLocalization(t))throw new Error(`Invalid json data for file ${e}`);const s=this._pendingUrls.indexOf(e);s>=0&&this._pendingUrls.splice(s,1),this.loadNextLocalization()}onLocalizationFailed(t){this.events&&this.events.dispatchEvent(new Ji(Ji.FAILED))}parseLocalization(t){if(!t)return!1;for(const e in t)this._definitions.set(e,t[e]);return!0}onBadgePointLimitsEvent(t){const e=t.getParser();for(const s of e.data)this.setBadgePointLimit(s.badgeId,s.limit)}getBadgePointLimit(t){return this._badgePointLimits.get(t)||-1}setBadgePointLimit(t,e){this._badgePointLimits.set(t,e)}getRomanNumeral(t){return this._romanNumerals[Math.max(0,t-1)]}getPreviousLevelBadgeId(t){const e=new Ao(t);return e.level--,e.getBadgeId}hasValue(t){return this._definitions.has(t)}getValue(t,e=!0){if(!t||!t.length)return null;const s=t.match(/\$\{.[^}]*\}/g);if(s&&s.length)for(const r of s)t=t.replace(r,this.getValue(r.slice(2,-1),e));let i=this._definitions.get(t)||null;if(!i&&(i=k.definitions.get(t),i))return i;if(i&&e){const r=this._parameters.get(t);if(r)for(const[a,o]of r)i=i.replace("%"+a+"%",o)}return i||t}getValueWithParameter(t,e,s){const i=this.getValue(t,!1),r=i.replace("%"+e+"%",s);if(i.startsWith("%{")){const a=new RegExp("%{"+e.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),o=i.match(a);if(!o)return r;let _=-1;switch(Number.parseInt(s)){case 0:_=1;break;case 1:_=2;break;default:case 2:_=3;break}if(_==-1||typeof o[_]>"u")return r;const c=o[_];if(c)return c.replace("%%",s)}return r}getValueWithParameters(t,e,s){let i=this.getValue(t,!1);if(e)for(let r=0;r<e.length;r++){const a=e[r],o=s[r];if(o!==void 0&&(i=i.replace("%"+a+"%",o),i.startsWith("%{"))){const _=new RegExp("%{"+a.toUpperCase()+"\\|([^|]*)\\|([^|]*)\\|([^|]*)}"),l=i.match(_);if(!l)continue;const c=parseInt(o);let d=-1;switch(c){case 0:d=1;break;case 1:d=2;break;case 2:default:d=3;break}if(d===-1||typeof l[d]>"u")continue;const E=l[d];E&&(i=E.replace("%%",o))}}return i}setValue(t,e){this._definitions.set(t,e)}registerParameter(t,e,s){if(!t||t.length===0||!e||e.length===0)return;let i=this._parameters.get(t);i||(i=new Map,this._parameters.set(t,i)),i.set(e,s)}getBadgeName(t){const e=new Ao(t),s=["badge_name_"+t,"badge_name_"+e.base];let i=this.fixBadLocalization(this.getExistingKey(s));return i=i.replace("%roman%",this.getRomanNumeral(e.level)),i}getBadgeDesc(t){const e=new Ao(t),s=["badge_desc_"+t,"badge_desc_"+e.base];let i=this.fixBadLocalization(this.getExistingKey(s));const r=this.getBadgePointLimit(t);return r>-1&&(i=i.replace("%limit%",r.toString())),i=i.replace("%roman%",this.getRomanNumeral(e.level)),i}getExistingKey(t){for(const e of t){const s=this.getValue(e);if(s!=e)return s}return""}fixBadLocalization(t){return t.replace("${","$").replace("{","$").replace("}","$")}}$f.add(tm,em,sm,im,rm,nm,am);class Pu{constructor(){this.id=0,this.data=null,this.image=null}getImage(){return this.image?this.image:this.data?At.generateImage(this.data):null}}class oe extends bt{constructor(t){super(null,null),this._type=t}get type(){return this._type}}oe.IMAGE_LOADED="ROAUM_IMAGE_LOADED";oe.IMAGE_LOADING_FAILED="ROAUM_IMAGE_FAILED";class Lt extends bt{constructor(){super(null,null)}}class LE extends Lt{constructor(t,e){super(),this._itemType=t,this._itemName=e}get itemType(){return this._itemType}get itemName(){return this._itemName}}class bh extends Lt{constructor(t=0){super(),this._numberOfWords=t}get numberOfWords(){return this._numberOfWords}}class UE extends Lt{constructor(t=0){super(),this._danceStyle=t}get danceStyle(){return this._danceStyle}}class vE extends Lt{constructor(t,e=0){super(),this._effect=t,this._delayMilliseconds=e}get effect(){return this._effect}get delayMilliseconds(){return this._delayMilliseconds}}class bE extends Lt{constructor(t){super(),this._gainedExperience=t}get gainedExperience(){return this._gainedExperience}}class FE extends Lt{constructor(t=0){super(),this._expressionType=t}get expressionType(){return this._expressionType}}class ga extends Lt{constructor(t,e=null,s=null,i=!1){super(),this._figure=t,this._gender=e,this._subType=s,this._isRiding=i}get figure(){return this._figure}get gender(){return this._gender}get subType(){return this._subType}get isRiding(){return this._isRiding}}class xE extends Lt{constructor(t=0){super(),this._level=t}get level(){return this._level}}class GE extends Lt{constructor(t=0){super(),this._gesture=t}get gesture(){return this._gesture}}class rw extends Lt{constructor(t){super(),this._guideStatus=t}get guideStatus(){return this._guideStatus}}class BE extends Lt{constructor(t=!1){super(),this._isMuted=t}get isMuted(){return this._isMuted}}class wE extends Lt{}class HE extends Lt{constructor(t){super(),this._gesture=t}get gesture(){return this._gesture}}class VE extends Lt{constructor(t){super(),this._value=t}get value(){return this._value}}class jE extends Lt{constructor(t){super(),this._isPlayingGame=t}get isPlayingGame(){return this._isPlayingGame}}class Fh extends Lt{constructor(t,e=""){super(),this._postureType=t,this._parameter=e}get postureType(){return this._postureType}get parameter(){return this._parameter}}class Ea extends Lt{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class zE extends Lt{constructor(t=0){super(),this._signType=t}get signType(){return this._signType}}class xh extends Lt{constructor(t=!1){super(),this._isSleeping=t}get isSleeping(){return this._isSleeping}}class YE extends Lt{constructor(t=!1){super(),this._isTyping=t}get isTyping(){return this._isTyping}}class ii extends bt{constructor(t,e,s,i=!1){super(t,s),this._targetLocation=e,this._isSlide=i}get targetLocation(){return this._targetLocation?this._targetLocation:this.location}get isSlide(){return this._isSlide}}class fa extends ii{constructor(t,e,s,i,r,a){super(t,e,s),this._headDirection=i,this._canStandUp=r,this._baseY=a}get headDirection(){return this._headDirection}get canStandUp(){return this._canStandUp}get baseY(){return this._baseY}}class WE extends Lt{constructor(t){super(),this._itemType=t}get itemType(){return this._itemType}}class mt extends bt{constructor(t,e,s=null){super(null,null),this._state=t,this._data=e,this._extra=s}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}}class nr extends bt{constructor(t,e){super(null,null),this._badgeId=t,this._assetName=e}get badgeId(){return this._badgeId}get assetName(){return this._assetName}}nr.BADGE_LOADED="ROGBUM_BADGE_LOADED";class kE extends bt{constructor(t,e,s){super(t,e),this._height=s}get height(){return this._height}}class Gh extends bt{constructor(t){super(null,null),this._data=t}get data(){return this._data}}class KE extends bt{constructor(t,e){super(null,null),this._numberKey=t,this._numberValue=e}get numberKey(){return this._numberKey}get numberValue(){return this._numberValue}}class ma extends bt{constructor(t,e,s,i){super(null,null),this._type=t,this._color=e,this._light=s,this._backgroundOnly=i}get type(){return this._type}get color(){return this._color}get light(){return this._light}get backgroundOnly(){return this._backgroundOnly}}ma.BACKGROUND_COLOR="RORCUM_BACKGROUND_COLOR";class Ps extends bt{constructor(t,e,s=0,i=0,r=0,a=0){super(null,null),this._type=t,this._id=e,this._x=s,this._y=i,this._width=r,this._height=a}get type(){return this._type}get id(){return this._id}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}Ps.ADD="ORPFHUM_ADD";Ps.REMOVE="ORPFHUM_REMOVE";const XE=class qE extends bt{constructor(t){super(null,null),this._type=qE.UPDATE_MAP,this._mapData=t}get type(){return this._type}get mapData(){return this._mapData}};XE.UPDATE_MAP="RORMUM_UPDATE_MAP";let QE=XE;class Vt extends bt{constructor(t,e,s=null,i=null,r="window"){super(null,null),this._type=t,this._maskId=e,this._maskType=s,this._maskLocation=i?new R(i.x,i.y,i.z):null,this._maskCategory=r}get type(){return this._type}get maskId(){return this._maskId}get maskType(){return this._maskType}get maskLocation(){return this._maskLocation}get maskCategory(){return this._maskCategory}}Vt.ADD_MASK="RORMUM_ADD_MASK";Vt.REMOVE_MASK="RORMUM_ADD_MASK";Vt.DOOR="door";Vt.WINDOW="window";Vt.HOLE="hole";class ys extends bt{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}}ys.WALL_THICKNESS="RORPPUM_WALL_THICKNESS";ys.FLOOR_THICKNESS="RORPVUM_FLOOR_THICKNESS";class Ls extends bt{constructor(t,e){super(null,null),this._type=t,this._visible=e}get type(){return this._type}get visible(){return this._visible}}Ls.WALL_VISIBILITY="RORPVUM_WALL_VISIBILITY";Ls.FLOOR_VISIBILITY="RORPVUM_FLOOR_VISIBILITY";class Ht extends bt{constructor(t,e){super(null,null),this._type=t,this._value=e}get type(){return this._type}get value(){return this._value}}Ht.ROOM_WALL_UPDATE="RORUM_ROOM_WALL_UPDATE";Ht.ROOM_FLOOR_UPDATE="RORUM_ROOM_FLOOR_UPDATE";Ht.ROOM_LANDSCAPE_UPDATE="RORUM_ROOM_LANDSCAPE_UPDATE";class Xr extends Lt{constructor(t){super(),this._selected=t}get selected(){return this._selected}}class ji extends bt{constructor(t,e,s,i,r=!1){super(t,null),this._height=e,this._visible=s,this._sourceEventId=i,this._toggleVisibility=r}get height(){return this._height}get visible(){return this._visible}get sourceEventId(){return this._sourceEventId}get toggleVisibility(){return this._toggleVisibility}}class Us extends bt{constructor(t){super(null,null),this._type=t}get type(){return this._type}}Us.ENABLED="ROVUM_ENABLED";Us.DISABLED="ROVUM_DISABLED";const Bh=class Y_ extends va{constructor(){super(),this._liftAmount=0,this._location=new R,this._locationDelta=new R,this._lastUpdateTime=0,this._changeTime=0,this._updateInterval=Y_.DEFAULT_UPDATE_INTERVAL}onDispose(){this._liftAmount=0,super.onDispose()}update(t){super.update(t);const e=this.getLocationOffset(),s=this.object&&this.object.model;if(s&&(e?this._liftAmount!==e.z&&(this._liftAmount=e.z,s.setValue(g.FURNITURE_LIFT_AMOUNT,this._liftAmount)):this._liftAmount!==0&&(this._liftAmount=0,s.setValue(g.FURNITURE_LIFT_AMOUNT,this._liftAmount))),this._locationDelta.length>0||e){const i=Y_.TEMP_VECTOR;let r=this.time-this._changeTime;r===this._updateInterval>>1&&r++,r>this._updateInterval&&(r=this._updateInterval),this._locationDelta.length>0?(i.assign(this._locationDelta),i.multiply(r/this._updateInterval),i.add(this._location)):i.assign(this._location),e&&i.add(e),this.object.setLocation(i),r===this._updateInterval&&(this._locationDelta.x=0,this._locationDelta.y=0,this._locationDelta.z=0)}this._lastUpdateTime=this.time}setObject(t){super.setObject(t),t&&this._location.assign(t.getLocation())}processUpdateMessage(t){if(t&&(super.processUpdateMessage(t),t.location&&this._location.assign(t.location),t instanceof ii))return this.processMoveMessage(t)}processMoveMessage(t){!t||!this.object||!t.location||(this._changeTime=this._lastUpdateTime,this._locationDelta.assign(t.targetLocation),this._locationDelta.subtract(this._location))}getLocationOffset(){return null}get lastUpdateTime(){return this._lastUpdateTime}set updateInterval(t){t<=0&&(t=1),this._updateInterval=t}};Bh.DEFAULT_UPDATE_INTERVAL=500;Bh.TEMP_VECTOR=new R;let sr=Bh;const oi=class ae extends sr{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._effectChangeTimeStamp=0,this._newEffect=0,this._blinkingStartTimestamp=$()+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=0,this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0,this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1,this._animationEndTimestamp=0,this._signEndTimestamp=0,this._gestureEndTimestamp=0,this._numberValueEndTimestamp=0}getEventTypes(){const t=[j.CLICK,j.DOUBLE_CLICK,re.POSITION_CHANGED,j.MOUSE_ENTER,j.MOUSE_LEAVE,y.MOUSE_BUTTON,y.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new re(re.OBJECT_REMOVED,this.object)),super.dispose(),this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const s=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==s.x||this._reportedLocation.y!==s.y||this._reportedLocation.z!==s.z)&&(this._reportedLocation||(this._reportedLocation=new R),this._reportedLocation.assign(s),this.eventDispatcher.dispatchEvent(new re(re.POSITION_CHANGED,this.object)))}const e=this.object&&this.object.model;e&&this.updateModel(this.time,e)}updateModel(t,e){this._talkingEndTimestamp>0&&(t>this._talkingEndTimestamp?(e.setValue(g.FIGURE_TALK,0),this._talkingEndTimestamp=0,this._talkingPauseStartTimestamp=0,this._talkingPauseEndTimestamp=0):!this._talkingPauseEndTimestamp&&!this._talkingPauseStartTimestamp?(this._talkingPauseStartTimestamp=t+this.randomTalkingPauseStartTimestamp(),this._talkingPauseEndTimestamp=this._talkingPauseStartTimestamp+this.randomTalkingPauseEndTimestamp()):this._talkingPauseStartTimestamp>0&&t>this._talkingPauseStartTimestamp?(e.setValue(g.FIGURE_TALK,0),this._talkingPauseStartTimestamp=0):this._talkingPauseEndTimestamp>0&&t>this._talkingPauseEndTimestamp&&(e.setValue(g.FIGURE_TALK,1),this._talkingPauseEndTimestamp=0)),this._animationEndTimestamp>0&&t>this._animationEndTimestamp&&(e.setValue(g.FIGURE_EXPRESSION,0),this._animationEndTimestamp=0),this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(g.FIGURE_GESTURE,0),this._gestureEndTimestamp=0),this._signEndTimestamp>0&&t>this._signEndTimestamp&&(e.setValue(g.FIGURE_SIGN,-1),this._signEndTimestamp=0),this._carryObjectEndTimestamp>0&&t>this._carryObjectEndTimestamp&&(e.setValue(g.FIGURE_CARRY_OBJECT,0),e.setValue(g.FIGURE_USE_OBJECT,0),this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1),this._allowUseCarryObject&&t-this._carryObjectStartTimestamp>5e3&&((t-this._carryObjectStartTimestamp)%1e4<1e3?e.setValue(g.FIGURE_USE_OBJECT,1):e.setValue(g.FIGURE_USE_OBJECT,0)),this._blinkingStartTimestamp>-1&&t>this._blinkingStartTimestamp&&(e.setValue(g.FIGURE_BLINK,1),this._blinkingStartTimestamp=t+this.randomBlinkStartTimestamp(),this._blinkingEndTimestamp=t+this.randomBlinkEndTimestamp()),this._blinkingEndTimestamp>0&&t>this._blinkingEndTimestamp&&(e.setValue(g.FIGURE_BLINK,0),this._blinkingEndTimestamp=0),this._effectChangeTimeStamp>0&&t>this._effectChangeTimeStamp&&(e.setValue(g.FIGURE_EFFECT,this._newEffect),this._effectChangeTimeStamp=0),this._numberValueEndTimestamp>0&&t>this._numberValueEndTimestamp&&(e.setValue(g.FIGURE_NUMBER_VALUE,0),this._numberValueEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof Fh){e.setValue(g.FIGURE_POSTURE,t.postureType),e.setValue(g.FIGURE_POSTURE_PARAMETER,t.parameter);return}if(t instanceof bh){e.setValue(g.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof YE){e.setValue(g.FIGURE_IS_TYPING,t.isTyping?1:0);return}if(t instanceof BE){e.setValue(g.FIGURE_IS_MUTED,t.isMuted?1:0);return}if(t instanceof jE){e.setValue(g.FIGURE_IS_PLAYING_GAME,t.isPlayingGame?1:0);return}if(t instanceof fa){e.setValue(g.HEAD_DIRECTION,t.headDirection),e.setValue(g.FIGURE_CAN_STAND_UP,t.canStandUp),e.setValue(g.FIGURE_VERTICAL_OFFSET,t.baseY);return}if(t instanceof GE){e.setValue(g.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof FE){e.setValue(g.FIGURE_EXPRESSION,t.expressionType),this._animationEndTimestamp=w.getExpressionTimeout(e.getValue(g.FIGURE_EXPRESSION)),this._animationEndTimestamp>-1&&(this._animationEndTimestamp+=this.time);return}if(t instanceof UE){e.setValue(g.FIGURE_DANCE,t.danceStyle);return}if(t instanceof xh){e.setValue(g.FIGURE_SLEEP,t.isSleeping?1:0),t.isSleeping?this._blinkingStartTimestamp=-1:this._blinkingStartTimestamp=this.time+this.randomBlinkStartTimestamp();return}if(t instanceof VE){e.setValue(g.FIGURE_NUMBER_VALUE,t.value),this._numberValueEndTimestamp=this.time+3e3;return}if(t instanceof vE){this.updateAvatarEffect(t.effect,t.delayMilliseconds,e);return}if(t instanceof LE){e.setValue(g.FIGURE_CARRY_OBJECT,t.itemType),e.setValue(g.FIGURE_USE_OBJECT,0),t.itemType===0?(this._carryObjectStartTimestamp=0,this._carryObjectEndTimestamp=0,this._allowUseCarryObject=!1):(this._carryObjectStartTimestamp=this.time,t.itemType<ae.MAX_HAND_ID?(this._carryObjectEndTimestamp=0,this._allowUseCarryObject=t.itemType<=ae.MAX_HAND_USE_ID):(this._carryObjectEndTimestamp=this._carryObjectStartTimestamp+1500,this._allowUseCarryObject=!1));return}if(t instanceof WE){e.setValue(g.FIGURE_USE_OBJECT,t.itemType);return}if(t instanceof zE){e.setValue(g.FIGURE_SIGN,t.signType),this._signEndTimestamp=this.time+5e3;return}if(t instanceof xE){e.setValue(g.FIGURE_FLAT_CONTROL,t.level);return}if(t instanceof ga){e.setValue(g.FIGURE,t.figure),e.setValue(g.GENDER,t.gender);return}if(t instanceof Ea){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof wE){e.setValue(g.OWN_USER,1);return}}}updateAvatarEffect(t,e,s){if(t===ae.EFFECT_TYPE_SPLASH)this._effectChangeTimeStamp=$()+ae.EFFECT_SPLASH_LENGTH,this._newEffect=ae.EFFECT_TYPE_SWIM;else if(t===ae.EFFECT_TYPE_SPLASH_DARK)this._effectChangeTimeStamp=$()+ae.EFFECT_SPLASH_LENGTH,this._newEffect=ae.EFFECT_TYPE_SWIM_DARK;else if(s.getValue(g.FIGURE_EFFECT)===ae.EFFECT_TYPE_SWIM)this._effectChangeTimeStamp=$()+ae.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=ae.EFFECT_TYPE_SPLASH;else if(s.getValue(g.FIGURE_EFFECT)===ae.EFFECT_TYPE_SWIM_DARK)this._effectChangeTimeStamp=$()+ae.EFFECT_SPLASH_LENGTH,this._newEffect=t,t=ae.EFFECT_TYPE_SPLASH_DARK;else if(e===0)this._effectChangeTimeStamp=0;else{this._effectChangeTimeStamp=$()+e,this._newEffect=t;return}s.setValue(g.FIGURE_EFFECT,t)}mouseEvent(t,e){let s=null;switch(t.type){case F.MOUSE_CLICK:s=j.CLICK;break;case F.DOUBLE_CLICK:s=j.DOUBLE_CLICK;break;case F.ROLL_OVER:s=j.MOUSE_ENTER,this.object.model&&this.object.model.setValue(g.FIGURE_HIGHLIGHT,1),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new y(y.MOUSE_BUTTON,this.object));break;case F.ROLL_OUT:s=j.MOUSE_LEAVE,this.object.model&&this.object.model.setValue(g.FIGURE_HIGHLIGHT,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new y(y.MOUSE_ARROW,this.object));break}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new j(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}randomTalkingPauseStartTimestamp(){return 100+Math.random()*200}randomTalkingPauseEndTimestamp(){return 75+Math.random()*75}randomBlinkStartTimestamp(){return 4500+Math.random()*1e3}randomBlinkEndTimestamp(){return 50+Math.random()*200}};oi.MAX_HAND_ID=999999999;oi.MAX_HAND_USE_ID=999;oi.EFFECT_TYPE_SPLASH=28;oi.EFFECT_SPLASH_LENGTH=500;oi.EFFECT_TYPE_SWIM=29;oi.EFFECT_TYPE_SPLASH_DARK=184;oi.EFFECT_TYPE_SWIM_DARK=185;let nw=oi;const wh=class Fe extends sr{constructor(){super(),this._sizeX=0,this._sizeY=0,this._sizeZ=0,this._centerX=0,this._centerY=0,this._centerZ=0,this._directions=[],this._mouseOver=!1,this._locationOffset=new R,this._bouncingStep=0,this._storedRotateMessage=null,this._directionInitialized=!1,Fe.BOUNCING_STEPS===-1&&(Fe.BOUNCING_STEPS=k.getValue("furni.rotation.bounce.steps",8)),Fe.BOUNCING_Z===-1&&(Fe.BOUNCING_Z=k.getValue("furni.rotation.bounce.height",.0625))}getEventTypes(){const t=[it.STATE_CHANGE,j.CLICK,j.MOUSE_DOWN,j.MOUSE_DOWN_LONG,Tt.ROOM_AD_TOOLTIP_SHOW,Tt.ROOM_AD_TOOLTIP_HIDE,Tt.ROOM_AD_FURNI_DOUBLE_CLICK,Tt.ROOM_AD_FURNI_CLICK];return this.widget&&t.push(O.OPEN_WIDGET,O.CLOSE_WIDGET),this.contextMenu&&t.push(O.OPEN_FURNI_CONTEXT_MENU,O.CLOSE_FURNI_CONTEXT_MENU),this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic){if(t.logic.model){const s=t.logic.model.dimensions;s&&(this._sizeX=s.x,this._sizeY=s.y,this._sizeZ=s.z,this._centerX=this._sizeX/2,this._centerY=this._sizeY/2,this._centerZ=this._sizeZ/2);const i=t.logic.model.directions;if(i&&i.length){for(const r of i)this._directions.push(r);this._directions.sort((r,a)=>r-a)}}if(t.logic.customVars){const s=t.logic.customVars.variables;s&&s.length&&e.setValue(g.FURNITURE_CUSTOM_VARIABLES,s)}}e.setValue(g.FURNITURE_SIZE_X,this._sizeX),e.setValue(g.FURNITURE_SIZE_Y,this._sizeY),e.setValue(g.FURNITURE_SIZE_Z,this._sizeZ),e.setValue(g.FURNITURE_CENTER_X,this._centerX),e.setValue(g.FURNITURE_CENTER_Y,this._centerY),e.setValue(g.FURNITURE_CENTER_Z,this._centerZ),e.setValue(g.FURNITURE_ALLOWED_DIRECTIONS,this._directions),e.setValue(g.FURNITURE_ALPHA_MULTIPLIER,1)}}onDispose(){this._storedRotateMessage=null,this._directions=null,super.onDispose()}setObject(t){super.setObject(t),t&&t.getLocation().length&&(this._directionInitialized=!0)}getAdClickUrl(t){return t.getValue(g.FURNITURE_AD_URL)}handleAdClick(t,e,s){this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Tt(Tt.ROOM_AD_FURNI_CLICK,this.object))}update(t){super.update(t),this._bouncingStep>0&&(this._bouncingStep++,this._bouncingStep>Fe.BOUNCING_STEPS&&(this._bouncingStep=0))}processUpdateMessage(t){if(t instanceof mt){this.processDataUpdateMessage(t);return}if(t instanceof kE){this.processObjectHeightUpdateMessage(t);return}if(t instanceof Gh){this.processItemDataUpdateMessage(t);return}if(this._mouseOver=!1,t.location&&t.direction){if(!(t instanceof ii)){const e=this.object.getDirection(),s=this.object.getLocation();e.x!==t.direction.x&&this._directionInitialized&&s.x===t.location.x&&s.y===t.location.y&&s.z===t.location.z&&(this._bouncingStep=1,this._storedRotateMessage=new bt(t.location,t.direction),t=null)}this._directionInitialized=!0}if(t instanceof Xr&&this.contextMenu&&this.eventDispatcher&&this.object){const e=t.selected?O.OPEN_FURNI_CONTEXT_MENU:O.CLOSE_FURNI_CONTEXT_MENU;this.eventDispatcher.dispatchEvent(new O(e,this.object))}super.processUpdateMessage(t)}processDataUpdateMessage(t){t&&(this.object.setState(t.state,0),t.data&&t.data.writeRoomObjectModel(this.object.model),t.extra!==null&&this.object.model.setValue(g.FURNITURE_EXTRAS,t.extra.toString()),this.object.model.setValue(g.FURNITURE_STATE_UPDATE_TIME,this.lastUpdateTime))}processObjectHeightUpdateMessage(t){t&&this.object.model.setValue(g.FURNITURE_SIZE_Z,t.height)}processItemDataUpdateMessage(t){t&&this.object.model.setValue(g.FURNITURE_ITEMDATA,t.data)}mouseEvent(t,e){const s=this.getAdClickUrl(this.object.model);switch(t.type){case F.MOUSE_MOVE:if(this.eventDispatcher){const i=new j(j.MOUSE_MOVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}return;case F.ROLL_OVER:if(!this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Tt(Tt.ROOM_AD_TOOLTIP_SHOW,this.object));const i=new j(j.MOUSE_ENTER,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!0}return;case F.ROLL_OUT:if(this._mouseOver){if(this.eventDispatcher){s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Tt(Tt.ROOM_AD_TOOLTIP_HIDE,this.object));const i=new j(j.MOUSE_LEAVE,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i)}this._mouseOver=!1}return;case F.DOUBLE_CLICK:this.useObject();return;case F.MOUSE_CLICK:if(this.eventDispatcher){const i=new j(j.CLICK,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);i.localX=t.localX,i.localY=t.localY,i.spriteOffsetX=t.spriteOffsetX,i.spriteOffsetY=t.spriteOffsetY,this.eventDispatcher.dispatchEvent(i),s&&s.indexOf("http")===0&&this.eventDispatcher.dispatchEvent(new Tt(Tt.ROOM_AD_TOOLTIP_HIDE,this.object)),s&&s.length&&this.handleAdClick(this.object.id,this.object.type,s)}return;case F.MOUSE_DOWN:if(this.eventDispatcher){const i=new j(j.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(i)}return;case F.MOUSE_DOWN_LONG:if(this.eventDispatcher){const i=new j(j.MOUSE_DOWN_LONG,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);this.eventDispatcher.dispatchEvent(i)}return}}getLocationOffset(){return this._bouncingStep<=0?null:(this._locationOffset.x=0,this._locationOffset.y=0,this._bouncingStep<=Fe.BOUNCING_STEPS/2?this._locationOffset.z=Fe.BOUNCING_Z*this._bouncingStep:this._bouncingStep<=Fe.BOUNCING_STEPS&&(this._storedRotateMessage&&(super.processUpdateMessage(this._storedRotateMessage),this._storedRotateMessage=null),this._locationOffset.z=Fe.BOUNCING_Z*(Fe.BOUNCING_STEPS-this._bouncingStep)),this._locationOffset)}useObject(){if(!this.object||!this.eventDispatcher)return;const t=this.getAdClickUrl(this.object.model);t&&t.length&&this.eventDispatcher.dispatchEvent(new Tt(Tt.ROOM_AD_FURNI_DOUBLE_CLICK,this.object,null,t)),this.widget&&this.eventDispatcher.dispatchEvent(new O(O.OPEN_WIDGET,this.object)),this.eventDispatcher.dispatchEvent(new it(it.STATE_CHANGE,this.object))}tearDown(){this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.widget&&this.eventDispatcher.dispatchEvent(new O(O.CLOSE_WIDGET,this.object)),this.contextMenu&&this.eventDispatcher.dispatchEvent(new O(O.CLOSE_FURNI_CONTEXT_MENU,this.object))),super.tearDown()}};wh.BOUNCING_STEPS=-1;wh.BOUNCING_Z=-1;let ut=wh;class JE extends ut{getEventTypes(){const t=[O.BADGE_DISPLAY_ENGRAVING,rs.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object){if(t instanceof mt){const e=t.data;e instanceof ea&&this.updateBadge(e.getValue(1));return}if(t instanceof nr){t.assetName!=="loading_icon"&&(this.object.model.setValue(g.FURNITURE_BADGE_ASSET_NAME,t.assetName),this.object.model.setValue(g.FURNITURE_BADGE_IMAGE_STATUS,1),this.update($()));return}}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.BADGE_DISPLAY_ENGRAVING,this.object))}updateBadge(t){t!==""&&this.eventDispatcher&&(this.object.model.setValue(g.FURNITURE_BADGE_IMAGE_STATUS,-1),this.eventDispatcher.dispatchEvent(new rs(rs.LOAD_BADGE,this.object,t,!1)))}}const Ui=class di extends JE{getEventTypes(){const t=[O.ACHIEVEMENT_RESOLUTION_OPEN,O.ACHIEVEMENT_RESOLUTION_ENGRAVING,O.ACHIEVEMENT_RESOLUTION_FAILED,rs.LOAD_BADGE];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof nr&&t.assetName!=="loading_icon"&&this.object.model.setValue(g.FURNITURE_BADGE_VISIBLE_IN_STATE,di.BADGE_VISIBLE_IN_STATE),t instanceof Xr){if(!this.eventDispatcher||!this.object)return;this.eventDispatcher.dispatchEvent(new O(O.CLOSE_FURNI_CONTEXT_MENU,this.object))}}useObject(){if(!this.object||!this.eventDispatcher)return;let t=null;switch(this.object.getState(0)){case di.STATE_RESOLUTION_NOT_STARTED:case di.STATE_RESOLUTION_IN_PROGRESS:t=new O(O.ACHIEVEMENT_RESOLUTION_OPEN,this.object);break;case di.STATE_RESOLUTION_ACHIEVED:t=new O(O.ACHIEVEMENT_RESOLUTION_ENGRAVING,this.object);break;case di.STATE_RESOLUTION_FAILED:t=new O(O.ACHIEVEMENT_RESOLUTION_FAILED,this.object);break}t&&this.eventDispatcher.dispatchEvent(t)}updateBadge(t){t!==di.ACH_NOT_SET&&super.updateBadge(t)}};Ui.STATE_RESOLUTION_NOT_STARTED=0;Ui.STATE_RESOLUTION_IN_PROGRESS=1;Ui.STATE_RESOLUTION_ACHIEVED=2;Ui.STATE_RESOLUTION_FAILED=3;Ui.ACH_NOT_SET="ach_0";Ui.BADGE_VISIBLE_IN_STATE=2;let aw=Ui;class ow extends ut{constructor(){super(),this.onRoomToObjectOwnAvatarMoveEvent=this.onRoomToObjectOwnAvatarMoveEvent.bind(this)}initialize(t){super.initialize(t),this.eventDispatcher&&this.eventDispatcher.addEventListener(Wr.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent)}tearDown(){this.eventDispatcher&&this.eventDispatcher.removeEventListener(Wr.ROAME_MOVE_TO,this.onRoomToObjectOwnAvatarMoveEvent),super.tearDown()}onRoomToObjectOwnAvatarMoveEvent(t){if(!t||!this.object)return;const e=this.object.getLocation(),s=t.targetLocation;if(!s)return;let i=this.object.model.getValue(g.FURNITURE_SIZE_X),r=this.object.model.getValue(g.FURNITURE_SIZE_Y);const a=(Math.floor(this.object.getDirection().x)+45)%360/90;(a===1||a===3)&&([i,r]=[r,i]),s.x>=e.x&&s.x<e.x+i&&s.y>=e.y&&s.y<e.y+r?this.object.setState(1,0):this.object.setState(0,0)}}class _w extends ut{getEventTypes(){const t=[O.CLOTHING_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);const e=this.object.model.getValue(g.FURNITURE_DATA);this.updateClothingData(e)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof mt&&t.data&&this.updateClothingData(t.data.getLegacyString())}updateClothingData(t){if(!t||!t.length)return;const[e,s]=t.split(",");e&&e.length&&this.object.model.setValue(g.FURNITURE_CLOTHING_BOY,e),s&&s.length&&this.object.model.setValue(g.FURNITURE_CLOTHING_GIRL,s)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.CLOTHING_CHANGE,this.object))}}class hw extends ut{getEventTypes(){const t=[it.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case F.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new it(it.STATE_CHANGE,this.object,1);break;case"reset":s=new it(it.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new it(it.STATE_CHANGE,this.object,1))}}class uw extends ut{processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(Yt.INFOSTAND_EXTRA_PARAM,Yt.CRACKABLE_FURNI)}}class lw extends ut{get widget(){return z.CRAFTING}}class cw extends ut{getEventTypes(){const t=[O.CREDITFURNI];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t);let e=0;t.logic&&t.logic.credits&&t.logic.credits!==""&&t.logic.credits.length>0&&(e=parseInt(t.logic.credits)),this.object.model.setValue(g.FURNITURE_CREDIT_VALUE,e)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new O(O.CREDITFURNI,this.object)),super.useObject())}}class Pt extends ut{getEventTypes(){const t=[y.MOUSE_BUTTON,y.MOUSE_ARROW];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case F.ROLL_OVER:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new y(y.MOUSE_BUTTON,this.object));break;case F.ROLL_OUT:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new y(y.MOUSE_ARROW,this.object));break}super.mouseEvent(t,e)}}}class dw extends Pt{constructor(){super(...arguments),this._state=1}getEventTypes(){const t=[Ns.PLAY_SOUND_AT_PITCH];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof mt&&(this._state!==-1&&t.state!==this._state&&this.dispatchSoundEvent(this.object.location.z),this._state=t.state)}dispatchSoundEvent(t){const e=Math.pow(2,t-1.2);this.eventDispatcher.dispatchEvent(new Ns(Ns.PLAY_SOUND_AT_PITCH,this.object,"FURNITURE_cuckoo_clock",e))}}class gw extends Pt{getEventTypes(){const t=[O.STACK_HEIGHT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(g.FURNITURE_ALWAYS_STACKABLE,1)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new O(O.STACK_HEIGHT,this.object)),super.useObject())}}class Ew extends ut{constructor(){super(),this._noTags=!1,this._noTagsLastStateActivate=!1}getEventTypes(){const t=[y.DICE_ACTIVATE,y.DICE_OFF];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case F.DOUBLE_CLICK:this._noTags?!this._noTagsLastStateActivate||this.object.getState(0)===0||this.object.getState(0)===100?(s=new y(y.DICE_ACTIVATE,this.object),this._noTagsLastStateActivate=!0):(s=new y(y.DICE_OFF,this.object),this._noTagsLastStateActivate=!1):t.spriteTag==="activate"||this.object.getState(0)===0||this.object.getState(0)===100?s=new y(y.DICE_ACTIVATE,this.object):t.spriteTag==="deactivate"&&(s=new y(y.DICE_OFF,this.object)),s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(t,e)}}class fw extends ut{getEventTypes(){const t=[O.ECOTRONBOX];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.ECOTRONBOX,this.object))}}class mw extends ut{constructor(){super(),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[O.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.startState===1&&(this._showStateOnceRendered=!0)}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount>20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(g.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){!t||!e||(t.type===F.DOUBLE_CLICK&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.INERNAL_LINK,this.object))}}class Iw extends ut{getEventTypes(){const t=[O.ROOM_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&t.logic.action.link&&t.logic.action.link!==""&&t.logic.action.link.length>0&&this.object&&this.object.model&&this.object.model.setValue(g.FURNITURE_INTERNAL_LINK,t.logic.action.link)}onDispose(){this._timer&&(clearTimeout(this._timer),this._timer=null),super.onDispose()}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(g.FURNITURE_AUTOMATIC_STATE_INDEX,t)}useObject(){this.setAutomaticStateIndex(1),this._timer&&(clearTimeout(this._timer),this._timer=null),this._timer=setTimeout(()=>{this.setAutomaticStateIndex(0),this._timer=null},2500),!(!this.object||!this.eventDispatcher)&&this.eventDispatcher.dispatchEvent(new O(O.ROOM_LINK,this.object))}}class Rw extends ut{getEventTypes(){const t=[O.EFFECTBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.EFFECTBOX_OPEN_DIALOG,this.object))}get contextMenu(){return $t.EFFECT_BOX}}class Tw extends Pt{getEventTypes(){const t=[O.EXTERNAL_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(super.initialize(t),!!t&&this.object&&this.object.model){let e="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(g.FURNITURE_USES_PLANE_MASK,0),this.object.model.setValue(g.FURNITURE_PLANE_MASK_TYPE,e)}}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new O(O.EXTERNAL_IMAGE,this.object)),super.useObject())}}class pw extends ut{getEventTypes(){const t=[it.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(g.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case F.DOUBLE_CLICK:switch(t.spriteTag){case"start_stop":s=new it(it.STATE_CHANGE,this.object,1);break;case"reset":s=new it(it.STATE_CHANGE,this.object,2);break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}break}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new it(it.STATE_CHANGE,this.object,0))}}const ZE=class yr extends Pt{constructor(){super(),this._currentState=-1,this._currentLocation=null}getEventTypes(){const t=[ee.ADD_HOLE,ee.REMOVE_HOLE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._currentState===yr.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new ee(ee.REMOVE_HOLE,this.object)),super.onDispose()}update(t){super.update(t),this.handleAutomaticStateUpdate()}processUpdateMessage(t){if(super.processUpdateMessage(t),!this.object)return;t instanceof mt&&this.handleStateUpdate(this.object.getState(0));const e=this.object.getLocation();this._currentLocation?(e.x!==this._currentLocation.x||e.y!==this._currentLocation.y)&&this._currentState===yr.STATE_HOLE&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new ee(ee.ADD_HOLE,this.object)):this._currentLocation=new R,this._currentLocation.assign(e)}handleStateUpdate(t){t!==this._currentState&&(this.eventDispatcher&&(t===yr.STATE_HOLE?this.eventDispatcher.dispatchEvent(new ee(ee.ADD_HOLE,this.object)):this._currentState===yr.STATE_HOLE&&this.eventDispatcher.dispatchEvent(new ee(ee.REMOVE_HOLE,this.object))),this._currentState=t)}handleAutomaticStateUpdate(){if(!this.object)return;const t=this.object.model;if(!t)return;const e=t.getValue(g.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(e)||this.handleStateUpdate(e%2)}};ZE.STATE_HOLE=0;let Ow=ZE;const Za=class W_ extends Pt{constructor(){super(...arguments),this._state=-1}initialize(t){super.initialize(t),this.object&&this.object.model.setValue(g.FURNITURE_FRIENDFURNI_ENGRAVING,this.engravingDialogType)}processUpdateMessage(t){if(t instanceof mt){const e=t.data;e?this._state=e.state:this._state=t.state}super.processUpdateMessage(t)}getEventTypes(){const t=[O.FRIEND_FURNITURE_ENGRAVING];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||(this._state===W_.STATE_LOCKED?this.eventDispatcher.dispatchEvent(new O(O.FRIEND_FURNITURE_ENGRAVING,this.object)):super.useObject())}get engravingDialogType(){return 0}get contextMenu(){return this._state===W_.STATE_UNLOCKED?$t.FRIEND_FURNITURE:$t.DUMMY}};Za.STATE_UNINITIALIZED=-1;Za.STATE_UNLOCKED=0;Za.STATE_LOCKED=1;let $E=Za;const mn=class Lr extends Pt{getEventTypes(){const t=[rs.LOAD_BADGE,O.GUILD_FURNI_CONTEXT_MENU,O.CLOSE_FURNI_CONTEXT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof mt){const e=t.data;e instanceof ea&&(this.updateGroupId(e.getValue(Lr.GROUPID_KEY)),this.updateBadge(e.getValue(Lr.BADGE_KEY)),this.updateColors(e.getValue(Lr.COLOR1_KEY),e.getValue(Lr.COLOR2_KEY)))}else t instanceof nr?t.assetName!=="loading_icon"&&(this.object.model.setValue(g.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME,t.assetName),this.update($())):t instanceof Xr&&(t.selected||this.eventDispatcher.dispatchEvent(new O(O.CLOSE_FURNI_CONTEXT_MENU,this.object)))}updateGroupId(t){this.object.model.setValue(g.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID,parseInt(t))}updateBadge(t){this.eventDispatcher.dispatchEvent(new rs(rs.LOAD_BADGE,this.object,t,!0))}updateColors(t,e){this.object.model.setValue(g.FURNITURE_GUILD_CUSTOMIZED_COLOR_1,parseInt(t,16)),this.object.model.setValue(g.FURNITURE_GUILD_CUSTOMIZED_COLOR_2,parseInt(e,16))}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case F.MOUSE_CLICK:this.openContextMenu()}super.mouseEvent(t,e)}}openContextMenu(){this.eventDispatcher.dispatchEvent(new O(O.GUILD_FURNI_CONTEXT_MENU,this.object))}};mn.GROUPID_KEY=1;mn.BADGE_KEY=2;mn.COLOR1_KEY=3;mn.COLOR2_KEY=4;let tf=mn;class Aw extends tf{getEventTypes(){const t=[O.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}updateGroupId(t){super.updateGroupId(t),this.object.model.setValue(g.FURNITURE_INTERNAL_LINK,`groupforum/${t}`)}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new O(O.INERNAL_LINK,this.object)),super.useObject())}}class Sw extends ut{getEventTypes(){const t=[y.USE_HABBOWHEEL];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new y(y.USE_HABBOWHEEL,this.object))}}const ef=class sf extends ut{constructor(){super(...arguments),this._state=-1}getEventTypes(){return[O.HIGH_SCORE_DISPLAY,O.HIDE_HIGH_SCORE_DISPLAY]}tearDown(){this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new O(O.HIDE_HIGH_SCORE_DISPLAY,this.object)),super.tearDown()}processUpdateMessage(t){super.processUpdateMessage(t),this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&t instanceof mt&&(t.state===sf.SHOW_WIDGET_IN_STATE?this.eventDispatcher.dispatchEvent(new O(O.HIGH_SCORE_DISPLAY,this.object)):this.eventDispatcher.dispatchEvent(new O(O.HIDE_HIGH_SCORE_DISPLAY,this.object)),this._state=t.state)}};ef.SHOW_WIDGET_IN_STATE=1;let Mw=ef;class Cw extends ut{getEventTypes(){const t=[it.STATE_CHANGE];return this.mergeTypes(super.getEventTypes(),t)}mouseEvent(t,e){if(!t||!e||!this.object)return;let s=null;switch(t.type){case F.DOUBLE_CLICK:switch(t.spriteTag){case"off":s=new it(it.STATE_CHANGE,this.object,3);break}break;case F.MOUSE_CLICK:switch(t.spriteTag){case"inc":s=new it(it.STATE_CHANGE,this.object,2);break;case"dec":s=new it(it.STATE_CHANGE,this.object,1);break}break}if(this.eventDispatcher&&s){this.eventDispatcher.dispatchEvent(s);return}super.mouseEvent(t,e)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new it(it.STATE_CHANGE,this.object,3))}}class Nw extends $E{get engravingDialogType(){return Ci.HABBOWEEN}}class Dw extends Pt{constructor(){super(),this._nextState=0,this._nextStateTimestamp=0}update(t){if(this._nextStateTimestamp>0&&t>=this._nextStateTimestamp){this._nextStateTimestamp=0;const e=new Re;e.setString(this._nextState.toString()),super.processUpdateMessage(new mt(this._nextState,e,this._nextStateExtra))}super.update(t)}processUpdateMessage(t){if(t instanceof mt){this.processUpdate(t);return}super.processUpdateMessage(t)}processUpdate(t){if(!t)return;const e=~~(t.state/1e3),s=~~(t.state%1e3);if(s)this._nextState=e,this._nextStateExtra=t.extra,this._nextStateTimestamp=this.time+s;else{this._nextStateTimestamp=0;const i=new Re;i.setString(e.toString()),super.processUpdateMessage(new mt(e,i,t.extra))}}}class Pw extends ut{constructor(){super(...arguments),this._showStateOnceRendered=!1,this._updateCount=0}getEventTypes(){const t=[O.INERNAL_LINK];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.action&&(this.object.model.setValue(g.FURNITURE_INTERNAL_LINK,t.logic.action.link),t.logic.action.startState===1&&(this._showStateOnceRendered=!0))}update(t){super.update(t),this._showStateOnceRendered&&(this._updateCount++,this._showStateOnceRendered&&this._updateCount===20&&(this.setAutomaticStateIndex(1),this._showStateOnceRendered=!1))}setAutomaticStateIndex(t){this.object&&this.object.model&&this.object.model.setValue(g.FURNITURE_AUTOMATIC_STATE_INDEX,t)}mouseEvent(t,e){!t||!e||(t.type===F.DOUBLE_CLICK&&this._showStateOnceRendered&&this.setAutomaticStateIndex(0),super.mouseEvent(t,e))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.INERNAL_LINK,this.object))}}class yw extends Pt{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[y.JUKEBOX_START,y.JUKEBOX_MACHINE_STOP,y.JUKEBOX_DISPOSE,y.JUKEBOX_INIT,O.JUKEBOX_PLAYLIST_EDITOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(Yt.INFOSTAND_EXTRA_PARAM,Yt.JUKEBOX),t instanceof mt)){const e=this.object.getState(0);e!==this._currentState&&(this._currentState=e,e===1?this.requestPlayList():e===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new y(y.JUKEBOX_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new y(y.JUKEBOX_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new y(y.JUKEBOX_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new y(y.JUKEBOX_DISPOSE,this.object))}useObject(){!this.object||!this.eventDispatcher||(this.eventDispatcher.dispatchEvent(new O(O.JUKEBOX_PLAYLIST_EDITOR,this.object)),this.eventDispatcher.dispatchEvent(new it(it.STATE_CHANGE,this.object,-1)))}}class Lw extends $E{get engravingDialogType(){return Ci.LOVE_LOCK}}const $a=class kn extends ut{getEventTypes(){const t=[O.MANNEQUIN];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof mt&&(t.data.writeRoomObjectModel(this.object.model),this.processObjectData())}processObjectData(){if(!this.object||!this.object.model)return;const t=new Yr;t.initializeFromRoomObjectModel(this.object.model),this.object.model.setValue(g.FURNITURE_MANNEQUIN_GENDER,t.getValue(kn.GENDER)),this.object.model.setValue(g.FURNITURE_MANNEQUIN_FIGURE,t.getValue(kn.FIGURE)),this.object.model.setValue(g.FURNITURE_MANNEQUIN_NAME,t.getValue(kn.OUTFIT_NAME))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.MANNEQUIN,this.object))}};$a.GENDER="GENDER";$a.FIGURE="FIGURE";$a.OUTFIT_NAME="OUTFIT_NAME";let Uw=$a;class vw extends Pt{getEventTypes(){const t=[O.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return $t.MONSTERPLANT_SEED}}class bw extends Pt{initialize(t){super.initialize(t),this.object&&this.object.model&&this.object.model.setValue(g.FURNITURE_IS_VARIABLE_HEIGHT,1)}}class Fw extends Pt{getEventTypes(){const t=[O.MYSTERYBOX_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.MYSTERYBOX_OPEN_DIALOG,this.object))}get contextMenu(){return $t.MYSTERY_BOX}}class xw extends Pt{getEventTypes(){const t=[O.MYSTERYTROPHY_OPEN_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.MYSTERYTROPHY_OPEN_DIALOG,this.object))}get contextMenu(){return $t.MYSTERY_TROPHY}}class Gw extends ut{getEventTypes(){const t=[y.ENTER_ONEWAYDOOR];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new y(y.ENTER_ONEWAYDOOR,this.object))}}class Bw extends ut{getEventTypes(){const t=[O.PET_PRODUCT_MENU];return this.mergeTypes(super.getEventTypes(),t)}processUpdateMessage(t){super.processUpdateMessage(t),this.object&&this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&this.object.model.setValue(Yt.INFOSTAND_EXTRA_PARAM,Yt.USABLE_PRODUCT)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.PET_PRODUCT_MENU,this.object))}}class ww extends ut{getEventTypes(){const t=[O.PLACEHOLDER];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.PLACEHOLDER,this.object))}}class Hw extends ut{initialize(t){super.initialize(t),t.logic&&t.logic.planetSystems&&this.object.model.setValue(g.FURNITURE_PLANETSYSTEM_DATA,t.logic.planetSystems)}}const lr=class zi extends ut{getEventTypes(){const t=[O.PRESENT];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.particleSystems&&t.logic.particleSystems.length&&this.object.model.setValue(g.FURNITURE_FIREWORKS_DATA,t.logic.particleSystems)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof mt&&(t.data.writeRoomObjectModel(this.object.model),this.updateStuffData()),t instanceof KE&&t.numberKey===g.FURNITURE_DISABLE_PICKING_ANIMATION&&this.object.model.setValue(g.FURNITURE_DISABLE_PICKING_ANIMATION,t.numberValue)}updateStuffData(){if(!this.object||!this.object.model)return;const t=new Yr;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(zi.MESSAGE),s=this.object.model.getValue(g.FURNITURE_DATA);!e&&typeof s=="string"?this.object.model.setValue(g.FURNITURE_DATA,s.substr(1)):this.object.model.setValue(g.FURNITURE_DATA,t.getValue(zi.MESSAGE)),this.writeToModel(g.FURNITURE_TYPE_ID,t.getValue(zi.PRODUCT_CODE)),this.writeToModel(g.FURNITURE_PURCHASER_NAME,t.getValue(zi.PURCHASER_NAME)),this.writeToModel(g.FURNITURE_PURCHASER_FIGURE,t.getValue(zi.PURCHASER_FIGURE))}writeToModel(t,e){e&&this.object.model.setValue(t,e)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case F.ROLL_OVER:this.eventDispatcher.dispatchEvent(new y(y.MOUSE_BUTTON,this.object));break;case F.ROLL_OUT:this.eventDispatcher.dispatchEvent(new y(y.MOUSE_ARROW,this.object));break}super.mouseEvent(t,e)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.PRESENT,this.object))}};lr.MESSAGE="MESSAGE";lr.PRODUCT_CODE="PRODUCT_CODE";lr.EXTRA_PARAM="EXTRA_PARAM";lr.PURCHASER_NAME="PURCHASER_NAME";lr.PURCHASER_FIGURE="PURCHASER_FIGURE";let Vw=lr;class jw extends Pt{getEventTypes(){const t=[O.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,this.object))}get contextMenu(){return $t.PURCHASABLE_CLOTHING}}const to=class Ur extends Pt{constructor(){super(),this.updateInterval=sr.DEFAULT_UPDATE_INTERVAL,this._oldLocation=new R}processUpdateMessage(t){if(!t)return;const e=t instanceof ii;if(this.object&&!e&&t.location){const s=this.object.getLocation(),i=R.dif(t.location,s);if(i&&Math.abs(i.x)<2&&Math.abs(i.y)<2){let r=s;(Math.abs(i.x)>1||Math.abs(i.y)>1)&&(r=R.sum(s,R.product(i,.5))),super.processUpdateMessage(new ii(r,t.location,t.direction));return}}if(t.location&&!e&&super.processUpdateMessage(new ii(t.location,t.location,t.direction)),t instanceof mt){t.state>0?this.updateInterval=sr.DEFAULT_UPDATE_INTERVAL/this.getUpdateIntervalValue(t.state):this.updateInterval=1,this.handleDataUpdate(t);return}e&&t.isSlide&&(this.updateInterval=sr.DEFAULT_UPDATE_INTERVAL),super.processUpdateMessage(t)}getUpdateIntervalValue(t){return t/Ur.MAX_ANIMATION_COUNT}getAnimationValue(t){return t%Ur.MAX_ANIMATION_COUNT}handleDataUpdate(t){const e=this.getAnimationValue(t.state);if(e!==t.state){const s=new Re;s.setString(e.toString()),t=new mt(e,s,t.extra)}super.processUpdateMessage(t)}update(t){this.object&&(this._oldLocation.assign(this.object.getLocation()),super.update(t),R.dif(this.object.getLocation(),this._oldLocation).length===0&&this.object.getState(0)!==Ur.ANIMATION_NOT_MOVING&&this.object.setState(Ur.ANIMATION_NOT_MOVING,0))}};to.ANIMATION_NOT_MOVING=0;to.ANIMATION_MOVING=1;to.MAX_ANIMATION_COUNT=10;let zw=to;class Yw extends ut{getEventTypes(){const t=[it.STATE_RANDOM];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new it(it.STATE_RANDOM,this.object))}}class Ww extends Pt{get contextMenu(){return $t.RANDOM_TELEPORT}}class kw extends ut{getEventTypes(){const t=[Ce.RODRE_CURRENT_USER_ID];return this.mergeTypes(super.getEventTypes(),t)}update(t){if(super.update(t),this.object&&this.object.model){this.object.model.getValue(g.SESSION_CURRENT_USER_ID)||this.eventDispatcher.dispatchEvent(new Ce(Ce.RODRE_CURRENT_USER_ID,this.object));const e=this.object.model.getValue(g.FURNITURE_DATA).getValue("renterId"),s=this.object.model.getValue(g.SESSION_CURRENT_USER_ID);e?parseInt(e)===s?this.object.setState(2,0):this.object.setState(1,0):this.object.setState(0,0)}}get widget(){return z.RENTABLESPACE}}class Kw extends Pt{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[O.BACKGROUND_COLOR,Qs.ROOM_BACKGROUND_COLOR];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._roomColorUpdated&&(this.eventDispatcher&&this.object&&this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&this.eventDispatcher.dispatchEvent(new Qs(Qs.ROOM_BACKGROUND_COLOR,this.object,!1,0,0,0)),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof mt&&(t.data.writeRoomObjectModel(this.object.model),this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processColorUpdate())}processColorUpdate(){if(!this.object||!this.object.model)return;const t=new xo;t.initializeFromRoomObjectModel(this.object.model);const e=t.getValue(0),s=t.getValue(1),i=t.getValue(2),r=t.getValue(3);e>-1&&s>-1&&i>-1&&r>-1&&(this.object.model.setValue(g.FURNITURE_ROOM_BACKGROUND_COLOR_HUE,s),this.object.model.setValue(g.FURNITURE_ROOM_BACKGROUND_COLOR_SATURATION,i),this.object.model.setValue(g.FURNITURE_ROOM_BACKGROUND_COLOR_LIGHTNESS,r),this.object.setState(e,0),this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Qs(Qs.ROOM_BACKGROUND_COLOR,this.object,e===1,s,i,r)),this._roomColorUpdated=!0)}mouseEvent(t,e){if(!(!t||!e||!this.object)){switch(t.type){case F.DOUBLE_CLICK:this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new O(O.BACKGROUND_COLOR,this.object));return}super.mouseEvent(t,e)}}}const vi=class Ae extends ut{constructor(){super(),this._disableFurnitureSelection=!0,this._hasClickUrl=!1}getEventTypes(){const t=[Tt.ROOM_AD_LOAD_IMAGE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this._disableFurnitureSelection&&this.object.model.setValue(g.FURNITURE_SELECTION_DISABLED,1)}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof mt&&this.processAdDataUpdateMessage(t),t instanceof oe&&this.processAdUpdate(t)}processAdDataUpdateMessage(t){if(!t)return;const e=new Yr;e.initializeFromRoomObjectModel(this.object.model);const s=parseInt(e.getValue(Ae.STATE));!isNaN(s)&&this.object.getState(0)!==s&&this.object.setState(s,0);const i=e.getValue(Ae.IMAGEURL_KEY),r=this.object.model.getValue(g.FURNITURE_BRANDING_IMAGE_URL);(!r||r!==i)&&(this.object.model.setValue(g.FURNITURE_BRANDING_IMAGE_URL,i),this.object.model.setValue(g.FURNITURE_BRANDING_IMAGE_STATUS,0),this.downloadBackground());const a=e.getValue(Ae.CLICKURL_KEY);if(a){const d=this.object.model.getValue(g.FURNITURE_BRANDING_URL);(!d||d!==a)&&this.object.model&&this.object.model.setValue(g.FURNITURE_BRANDING_URL,a)}const o=parseInt(e.getValue(Ae.OFFSETX_KEY)),_=parseInt(e.getValue(Ae.OFFSETY_KEY)),l=parseInt(e.getValue(Ae.OFFSETZ_KEY));isNaN(o)||this.object.model.setValue(g.FURNITURE_BRANDING_OFFSET_X,o),isNaN(_)||this.object.model.setValue(g.FURNITURE_BRANDING_OFFSET_Y,_),isNaN(l)||this.object.model.setValue(g.FURNITURE_BRANDING_OFFSET_Z,l);let c=Ae.IMAGEURL_KEY+"="+(i!==null?i:"")+"	";this._hasClickUrl&&(c=c+(Ae.CLICKURL_KEY+"="+(a!==null?a:"")+"	")),c=c+(Ae.OFFSETX_KEY+"="+o+"	"),c=c+(Ae.OFFSETY_KEY+"="+_+"	"),c=c+(Ae.OFFSETZ_KEY+"="+l+"	"),this.object.model.setValue(Yt.INFOSTAND_EXTRA_PARAM,Yt.BRANDING_OPTIONS+c)}processAdUpdate(t){if(!(!t||!this.object))switch(t.type){case oe.IMAGE_LOADED:this.object.model.setValue(g.FURNITURE_BRANDING_IMAGE_STATUS,1);break;case oe.IMAGE_LOADING_FAILED:this.object.model.setValue(g.FURNITURE_BRANDING_IMAGE_STATUS,-1);break}}mouseEvent(t,e){!t||!e||t.type===F.MOUSE_MOVE||t.type===F.DOUBLE_CLICK||super.mouseEvent(t,e)}async downloadBackground(){const t=this.object&&this.object.model;if(!t)return;const e=t.getValue(g.FURNITURE_BRANDING_IMAGE_URL),s=t.getValue(g.FURNITURE_BRANDING_IMAGE_STATUS);if(!(!e||e===""||s===1))if(e.endsWith(".gif"))this.object.model.setValue(g.FURNITURE_BRANDING_IS_ANIMATED,!0),fetch(e).then(i=>i.arrayBuffer()).then(i=>om(i)).then(i=>{const r=i.lsd.width,a=i.lsd.height,o=r*a,_=_m(i,!1),l=[],c=[];let d=new Uint8Array(o*4);for(let E=0;E<_.length;E++){E>0&&(d=d.slice(0));const I=_[E].pixels,m=_[E].colorTable,T=_[E].transparentIndex,p=_[E].dims;for(let N=0;N<p.height;N++)for(let C=0;C<p.width;C++){const L=I[N*p.width+C],D=(N+p.top)*r+(C+p.left);if(T!==L){const v=m[L];d[4*D]=v[0],d[4*D+1]=v[1],d[4*D+2]=v[2],d[4*D+3]=255}}const A=Sa.fromBuffer(d,r,a);l.push(new Ct(A)),c.push(_[E].delay)}H.instance.roomEngine.roomContentLoader.createGifCollection(e,l,c),this.processUpdateMessage(new oe(oe.IMAGE_LOADED))}).catch(i=>{this.processUpdateMessage(new oe(oe.IMAGE_LOADING_FAILED))});else{const i=Me();if(!i)return;if(!i.getTexture(e)){await i.downloadAsset(e)?this.processUpdateMessage(new oe(oe.IMAGE_LOADED)):this.processUpdateMessage(new oe(oe.IMAGE_LOADING_FAILED));return}this.processUpdateMessage(new oe(oe.IMAGE_LOADED))}}};vi.STATE="state";vi.IMAGEURL_KEY="imageUrl";vi.CLICKURL_KEY="clickUrl";vi.OFFSETX_KEY="offsetX";vi.OFFSETY_KEY="offsetY";vi.OFFSETZ_KEY="offsetZ";let rf=vi;class Xw extends rf{getAdClickUrl(t){return null}}class qw extends rf{constructor(){super(),this._hasClickUrl=!0}getAdClickUrl(t){return t.getValue(g.FURNITURE_BRANDING_URL)}handleAdClick(t,e,s){if(s.indexOf("http")===0){pa.openWebPage(s);return}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new Tt(Tt.ROOM_AD_FURNI_CLICK,this.object,"",s))}}class Qw extends ut{constructor(){super(),this._roomColorUpdated=!1}getEventTypes(){const t=[O.DIMMER,O.WIDGET_REMOVE_DIMMER,zr.DIMMER_STATE];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this._roomColorUpdated&&this.eventDispatcher&&this.object&&(this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&(this.eventDispatcher.dispatchEvent(new zr(this.object,0,1,1,16777215,255)),this.eventDispatcher.dispatchEvent(new O(O.WIDGET_REMOVE_DIMMER,this.object))),this._roomColorUpdated=!1),super.onDispose()}processUpdateMessage(t){if(t instanceof mt){if(t.data){const e=t.data.getLegacyString();this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&this.processDimmerData(e),super.processUpdateMessage(new mt(this.getStateFromDimmerData(e),t.data))}return}super.processUpdateMessage(t)}getStateFromDimmerData(t){if(!t)return 0;const e=t.split(",");return e.length>=5?parseInt(e[0])-1:0}processDimmerData(t){if(!t)return;const e=t.split(",");if(e.length>=5){const s=this.getStateFromDimmerData(t),i=parseInt(e[1]),r=parseInt(e[2]),a=e[3];let o=parseInt(a.substr(1),16),_=parseInt(e[4]);s||(o=16777215,_=255),this.eventDispatcher&&this.object&&(this.eventDispatcher.dispatchEvent(new zr(this.object,s,i,r,o,_)),this._roomColorUpdated=!0)}}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.DIMMER,this.object))}update(t){super.update(t)}}const Hh=class vr extends ut{constructor(){super(),this._score=0,this._scoreIncreaser=50,this._scoreTimer=0}processUpdateMessage(t){if(t instanceof mt)return this.updateScore(t.state);super.processUpdateMessage(t)}updateScore(t){this._score=t;const e=this.object.getState(0);if(this._score!==e){let s=this._score-e;s<0&&(s=-s),s*vr.UPDATE_INTERVAL>vr.MAX_UPDATE_TIME?this._scoreIncreaser=vr.MAX_UPDATE_TIME/s:this._scoreIncreaser=vr.UPDATE_INTERVAL,this._scoreTimer=$()}}update(t){super.update(t);const e=this.object.getState(0);if(e!==this._score&&t>=this._scoreTimer+this._scoreIncreaser){const s=t-this._scoreTimer;let i=s/this._scoreIncreaser,r=1;this._score<e&&(r=-1),i>r*(this._score-e)&&(i=r*(this._score-e)),this.object.setState(e+r*i,0),this._scoreTimer=t-(s-i*this._scoreIncreaser)}}};Hh.UPDATE_INTERVAL=50;Hh.MAX_UPDATE_TIME=3e3;let Jw=Hh;class Zw extends ut{processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1){const e=this.object.model.getValue(g.FURNITURE_EXTRAS),s=parseInt(e);this.object.model.setValue(Yt.INFOSTAND_EXTRA_PARAM,Yt.SONGDISK+s)}}}const eo=class Vs extends Pt{constructor(){super(...arguments),this._state=-1,this._sampleId=-1,this._noPitch=!1,this._lastLocZ=0}getEventTypes(){const t=[Dt.ROOM_OBJECT_INITIALIZED,Dt.ROOM_OBJECT_DISPOSED,Dt.PLAY_SAMPLE,Dt.CHANGE_PITCH];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),t.logic&&t.logic.soundSample&&(this._sampleId=t.logic.soundSample.id,this._noPitch=t.logic.soundSample.noPitch),this.object.model.setValue(g.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,1)}onDispose(){this._state!==Vs.STATE_UNINITIALIZED&&this.eventDispatcher.dispatchEvent(new Dt(Dt.ROOM_OBJECT_DISPOSED,this.object,this._sampleId)),super.onDispose()}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof mt&&this.updateSoundBlockMessage(t)}updateSoundBlockMessage(t){if(!t)return;const e=this.object&&this.object.model,s=this.object&&this.object.location;!e||!s||(this._state===Vs.STATE_UNINITIALIZED&&e.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new Dt(Dt.ROOM_OBJECT_INITIALIZED,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==Vs.STATE_UNINITIALIZED&&e.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&this._lastLocZ!==s.z&&(this._lastLocZ=s.z,this.eventDispatcher.dispatchEvent(new Dt(Dt.CHANGE_PITCH,this.object,this._sampleId,this.getPitchForHeight(s.z)))),this._state!==Vs.STATE_UNINITIALIZED&&t.state!==this._state&&this.playSoundAt(s.z),this._state=t.state)}playSoundAt(t){if(!this.object)return;const e=this.getPitchForHeight(t);this.object.model.setValue(g.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED,e),this.eventDispatcher.dispatchEvent(new Dt(Dt.PLAY_SAMPLE,this.object,this._sampleId,e))}getPitchForHeight(t){if(this._noPitch)return 1;let e=t*2;return e>Vs.HIGHEST_SEMITONE&&(e=Math.min(0,Vs.LOWEST_SEMITONE+(e-Vs.HIGHEST_SEMITONE-1))),Math.pow(2,e/12)}};eo.HIGHEST_SEMITONE=12;eo.LOWEST_SEMITONE=-12;eo.STATE_UNINITIALIZED=-1;let $w=eo;class tH extends Pt{constructor(){super(...arguments),this._disposeEventsAllowed=!1,this._isInitialized=!1,this._currentState=-1}getEventTypes(){const t=[y.SOUND_MACHINE_START,y.SOUND_MACHINE_STOP,y.SOUND_MACHINE_DISPOSE,y.SOUND_MACHINE_INIT];return this.mergeTypes(super.getEventTypes(),t)}onDispose(){this.requestDispose(),super.onDispose()}processUpdateMessage(t){if(super.processUpdateMessage(t),this.object.model.getValue(g.FURNITURE_REAL_ROOM_OBJECT)===1&&(this._isInitialized||this.requestInit(),this.object.model.setValue(Yt.INFOSTAND_EXTRA_PARAM,Yt.JUKEBOX),t instanceof mt)){const e=this.object.getState(0);e!==this._currentState&&(this._currentState=e,e===1?this.requestPlayList():e===0&&this.requestStopPlaying())}}requestInit(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new y(y.SOUND_MACHINE_INIT,this.object)),this._isInitialized=!0)}requestPlayList(){!this.object||!this.eventDispatcher||(this._disposeEventsAllowed=!0,this.eventDispatcher.dispatchEvent(new y(y.SOUND_MACHINE_START,this.object)))}requestStopPlaying(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new y(y.SOUND_MACHINE_STOP,this.object))}requestDispose(){!this._disposeEventsAllowed||!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new y(y.SOUND_MACHINE_DISPOSE,this.object))}}const nf=class af extends ut{getEventTypes(){const t=[O.STICKIE,y.STICKIE];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){super.initialize(t),this.updateColor(),this.object&&this.object.model.setValue(g.FURNITURE_IS_STICKIE,"")}processUpdateMessage(t){super.processUpdateMessage(t),t instanceof Gh&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new O(O.STICKIE,this.object)),this.updateColor()}updateColor(){if(!this.object)return;const t=this.object.model.getValue(g.FURNITURE_DATA);let e=af.STICKIE_COLORS.indexOf(t);e<0&&(e=3),this.object.model.setValue(g.FURNITURE_COLOR,e+1)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new y(y.STICKIE,this.object))}};nf.STICKIE_COLORS=["9CCEFF","FF9CFF","9CFF9C","FFFF33"];let eH=nf;class sH extends ut{getEventTypes(){const t=[O.TROPHY];return this.mergeTypes(super.getEventTypes(),t)}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.TROPHY,this.object))}}const Vh=class br extends Pt{constructor(){super(),this._total=0,this._lastUpdate=0,this._interval=33}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof mt){const e=t.data;if(!e)return;this.updateTotal(e.result)}}updateTotal(t){if(this._total=t,!this._lastUpdate){this.object.model.setValue(g.FURNITURE_VOTE_COUNTER_COUNT,t),this._lastUpdate=$();return}if(this._total!==this.currentTotal){const e=Math.abs(this._total-this.currentTotal);e*br.UPDATE_INTERVAL>br.MAX_UPDATE_TIME?this._interval=br.MAX_UPDATE_TIME/e:this._interval=br.UPDATE_INTERVAL,this._lastUpdate=$()}}update(t){if(super.update(t),this.object&&this.currentTotal!==this._total&&t>=this._lastUpdate+this._interval){const e=t-this._lastUpdate;let s=e/this._interval,i=1;this._total<this.currentTotal&&(i=-1),s>i*(this._total-this.currentTotal)&&(s=i*(this._total-this.currentTotal)),this.object.model.setValue(g.FURNITURE_VOTE_COUNTER_COUNT,this.currentTotal+i*s),this._lastUpdate=t-(e-s*this._interval)}}get currentTotal(){return this.object.model.getValue(g.FURNITURE_VOTE_COUNTER_COUNT)}};Vh.UPDATE_INTERVAL=33;Vh.MAX_UPDATE_TIME=1e3;let iH=Vh;class rH extends Pt{processUpdateMessage(t){if(super.processUpdateMessage(t),!!this.object&&t instanceof mt){const e=t.data;e instanceof Go&&this.object.model.setValue(g.FURNITURE_VOTE_MAJORITY_RESULT,e.result)}}}class nH extends Pt{mouseEvent(t,e){!t||!e||(t.type===F.DOUBLE_CLICK&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new it(it.STATE_CHANGE,this.object)),super.mouseEvent(t,e))}}class aH extends Pt{initialize(t){super.initialize(t);let e="";t.logic&&t.logic.maskType&&t.logic.maskType!==""&&t.logic.maskType.length>0&&(e=t.logic.maskType),this.object.model.setValue(g.FURNITURE_USES_PLANE_MASK,1),this.object.model.setValue(g.FURNITURE_PLANE_MASK_TYPE,e)}}class oH extends ut{getEventTypes(){const t=[O.YOUTUBE,Ce.RODRE_URL_PREFIX];return this.mergeTypes(super.getEventTypes(),t)}update(t){super.update(t),this.object.model.getValue(g.SESSION_URL_PREFIX)||this.eventDispatcher.dispatchEvent(new Ce(Ce.RODRE_URL_PREFIX,this.object))}useObject(){!this.object||!this.eventDispatcher||this.eventDispatcher.dispatchEvent(new O(O.YOUTUBE,this.object))}}class _H extends sr{constructor(){super(),this._selected=!1,this._reportedLocation=null,this._postureIndex=0,this._gestureIndex=0,this._headDirectionDelta=0,this._directions=[],this._talkingEndTimestamp=0,this._gestureEndTimestamp=0,this._expressionEndTimestamp=0}getEventTypes(){const t=[j.CLICK,re.POSITION_CHANGED];return this.mergeTypes(super.getEventTypes(),t)}initialize(t){if(!t)return;const e=this.object&&this.object.model;if(e){if(t.logic&&t.logic.model){const s=t.logic.model.directions;if(s&&s.length){for(const i of s)this._directions.push(i);this._directions.sort()}}e.setValue(g.PET_ALLOWED_DIRECTIONS,this._directions)}}dispose(){this._selected&&this.object&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new re(re.OBJECT_REMOVED,this.object)),this._directions=null,this._reportedLocation=null}update(t){if(super.update(t),this._selected&&this.object&&this.eventDispatcher){const e=this.object.getLocation();(!this._reportedLocation||this._reportedLocation.x!==e.x||this._reportedLocation.y!==e.y||this._reportedLocation.z!==e.z)&&(this._reportedLocation||(this._reportedLocation=new R),this._reportedLocation.assign(e),this.eventDispatcher.dispatchEvent(new re(re.POSITION_CHANGED,this.object)))}this.object&&this.object.model&&this.updateModel(t,this.object.model)}updateModel(t,e){this._gestureEndTimestamp>0&&t>this._gestureEndTimestamp&&(e.setValue(g.FIGURE_GESTURE,null),this._gestureEndTimestamp=0),this._talkingEndTimestamp>0&&t>this._talkingEndTimestamp&&(e.setValue(g.FIGURE_TALK,0),this._talkingEndTimestamp=0),this._expressionEndTimestamp>0&&t>this._expressionEndTimestamp&&(e.setValue(g.FIGURE_EXPRESSION,0),this._expressionEndTimestamp=0)}processUpdateMessage(t){if(!t||!this.object)return;super.processUpdateMessage(t);const e=this.object&&this.object.model;if(e){if(t instanceof fa){e.setValue(g.HEAD_DIRECTION,t.headDirection);return}if(t instanceof ga){const s=new Aa(t.figure);e.setValue(g.FIGURE,t.figure),e.setValue(g.RACE,t.subType),e.setValue(g.PET_PALETTE_INDEX,s.paletteId),e.setValue(g.PET_COLOR,s.color),e.setValue(g.PET_TYPE,s.typeId),e.setValue(g.PET_CUSTOM_LAYER_IDS,s.customLayerIds),e.setValue(g.PET_CUSTOM_PARTS_IDS,s.customPartIds),e.setValue(g.PET_CUSTOM_PALETTE_IDS,s.customPaletteIds),e.setValue(g.PET_IS_RIDING,t.isRiding?1:0);return}if(t instanceof Fh){e.setValue(g.FIGURE_POSTURE,t.postureType);return}if(t instanceof bh){e.setValue(g.FIGURE_TALK,1),this._talkingEndTimestamp=this.time+t.numberOfWords*1e3;return}if(t instanceof xh){e.setValue(g.FIGURE_SLEEP,t.isSleeping?1:0);return}if(t instanceof HE){e.setValue(g.FIGURE_GESTURE,t.gesture),this._gestureEndTimestamp=this.time+3e3;return}if(t instanceof Ea){this._selected=t.selected,this._reportedLocation=null;return}if(t instanceof bE){e.setValue(g.FIGURE_EXPERIENCE_TIMESTAMP,this.time),e.setValue(g.FIGURE_GAINED_EXPERIENCE,t.gainedExperience);return}}}mouseEvent(t,e){let s=null;switch(t.type){case F.MOUSE_CLICK:s=j.CLICK;break;case F.DOUBLE_CLICK:break;case F.MOUSE_DOWN:{this.object.model.getValue(g.PET_TYPE)===nt.MONSTERPLANT&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new j(j.MOUSE_DOWN,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown));break}}s&&this.eventDispatcher&&this.eventDispatcher.dispatchEvent(new j(s,this.object,t.eventId,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown))}}class of{constructor(){this._width=0,this._height=0,this._wallHeight=0,this._fixedWallsHeight=0,this._tileMap=[],this._holeMap=[],this._doors=[],this._dimensions={minX:0,maxX:0,minY:0,maxY:0},this._restrictsDragging=!1,this._restrictedScale=1,this._restrictsScaling=!1}get width(){return this._width}set width(t){this._width=t}get height(){return this._height}set height(t){this._height=t}get wallHeight(){return this._wallHeight}set wallHeight(t){this._wallHeight=t}get fixedWallsHeight(){return this._fixedWallsHeight}set fixedWallsHeight(t){this._fixedWallsHeight=t}get tileMap(){return this._tileMap}get holeMap(){return this._holeMap}get doors(){return this._doors}get dimensions(){return this._dimensions}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}}class Ai{constructor(t,e,s){this.type=t,this.loc=e,this.category=s}get loc(){return this._loc}set loc(t){this._loc||(this._loc=new R),this._loc.assign(t)}get type(){return this._type}set type(t){this._type=t}get category(){return this._category}set category(t){this._category=t}dispose(){this._loc=null}}Ai.WINDOW="window";Ai.HOLE="hole";class hH{constructor(){this._masks=[]}get masks(){return this._masks}}class _f{constructor(){this._masks=new Map}get maskCount(){return this._masks.size}dispose(){this._masks&&(this.reset(),this._masks=null)}initialize(t){if(!t)return!1;if(this._masks.clear(),t.masks.length)for(const e of t.masks){if(!e)continue;const s=e.locations.length?e.locations[0]:null;s&&this._masks.set(e.id,new Ai(e.type,s,e.category))}return!0}reset(){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}addMask(t,e,s,i){const r=new Ai(e,s,i);this._masks.delete(t),this._masks.set(t,r)}removeMask(t){const e=this._masks.get(t);return e?(this._masks.delete(t),e.dispose(),!0):!1}getXML(){const t=new hH;for(const[e,s]of this._masks.entries()){if(!s)continue;const i=this.getMaskType(s),r=this.getMaskCategory(s),a=this.getMaskLocation(s);if(i&&r&&a){const o={id:e,type:i,category:r,locations:[{x:a.x,y:a.y,z:a.z}]};t.masks.push(o)}}return t}getMaskLocation(t){return t?t.loc:null}getMaskType(t){return t?t.type:null}getMaskCategory(t){return t?t.category:null}get masks(){return this._masks}}class uH{constructor(t,e,s,i){this._leftSideLoc=0,this._rightSideLoc=0,this._leftSideLength=0,this._rightSideLength=0,this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}class Ot{constructor(t,e,s,i,r){this._type=0,this._loc=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._normalDirection=null;let a,o,_,l,c,d,E,I;if(this._secondaryNormals=[],this._masks=[],this._loc=new R,this._loc.assign(e),this._leftSide=new R,this._leftSide.assign(s),this._rightSide=new R,this._rightSide.assign(i),this._type=t,s!=null&&i!=null&&(this._normal=R.crossProduct(s,i),a=0,o=0,_=0,l=0,c=0,this.normal.x!=0||this.normal.y!=0?(l=this.normal.x,c=this.normal.y,a=360+Math.atan2(c,l)/Math.PI*180,a>=360&&(a=a-360),l=Math.sqrt(this.normal.x*this.normal.x+this.normal.y*this.normal.y),c=this.normal.z,o=360+Math.atan2(c,l)/Math.PI*180,o>=360&&(o=o-360)):this.normal.z<0?o=90:o=270,this._normalDirection=new R(a,o,_)),r!=null&&r.length>0)for(d=0;d<r.length;)E=r[d],E!=null&&E.length>0&&(I=new R,I.assign(E),I.multiply(1/I.length),this._secondaryNormals.push(I)),d++}get type(){return this._type}get loc(){return this._loc}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get normal(){return this._normal}get normalDirection(){return this._normalDirection}get secondaryNormalCount(){return this._secondaryNormals.length}get maskCount(){return this._masks.length}getSecondaryNormal(t){if(t<0||t>=this.secondaryNormalCount)return null;const e=new R;return e.assign(this._secondaryNormals[t]),e}addMask(t,e,s,i){const r=new uH(t,e,s,i);this._masks.push(r)}getMask(t){return t<0||t>=this.maskCount?null:this._masks[t]}getMaskLeftSideLoc(t){const e=this.getMask(t);return e!=null?e.leftSideLoc:-1}getMaskRightSideLoc(t){const e=this.getMask(t);return e!=null?e.rightSideLoc:-1}getMaskLeftSideLength(t){const e=this.getMask(t);return e!=null?e.leftSideLength:-1}getMaskRightSideLength(t){const e=this.getMask(t);return e!=null?e.rightSideLength:-1}}Ot.PLANE_UNDEFINED=0;Ot.PLANE_FLOOR=1;Ot.PLANE_WALL=2;Ot.PLANE_LANDSCAPE=3;Ot.PLANE_BILLBOARD=4;class lH{constructor(t,e,s,i){this._x=t,this._y=e,this._width=s,this._height=i}get x(){return this._x}get y(){return this._y}get width(){return this._width}get height(){return this._height}}const jh=class k_{constructor(){this._corners=[],this._endPoints=[],this._directions=[],this._lengths=[],this._leftTurns=[],this._borders=[],this._hideWalls=[],this._manuallyLeftCut=[],this._manuallyRightCut=[],this._addDuplicates=!1,this._count=0}addWall(t,e,s,i,r){(this._addDuplicates||this.checkIsNotDuplicate(t,e,s,i,r))&&(this._corners.push(t),this._directions.push(e),this._lengths.push(s),this._borders.push(i),this._leftTurns.push(r),this._hideWalls.push(!1),this._manuallyLeftCut.push(!1),this._manuallyRightCut.push(!1),this._count++)}checkIsNotDuplicate(t,e,s,i,r){let a=0;for(;a<this._count;){if(this._corners[a].x==t.x&&this._corners[a].y==t.y&&this._directions[a]==e&&this._lengths[a]==s&&this._borders[a]==i&&this._leftTurns[a]==r)return!1;a++}return!0}get count(){return this._count}getCorner(t){return this._corners[t]}getEndPoint(t){return this.calculateWallEndPoints(),this._endPoints[t]}getLength(t){return this._lengths[t]}getDirection(t){return this._directions[t]}getBorder(t){return this._borders[t]}getHideWall(t){return this._hideWalls[t]}getLeftTurn(t){return this._leftTurns[t]}getManuallyLeftCut(t){return this._manuallyLeftCut[t]}getManuallyRightCut(t){return this._manuallyRightCut[t]}setHideWall(t,e){this._hideWalls[t]=e}setLength(t,e){e<this._lengths[t]&&(this._lengths[t]=e,this._manuallyRightCut[t]=!0)}moveCorner(t,e){let s;if(e>0&&e<this._lengths[t]){const i=this._corners[t];s=k_.WALL_DIRECTION_VECTORS[this.getDirection(t)],this._corners[t]=new Y(i.x+e*s.x,i.y+e*s.y),this._lengths[t]=this._lengths[t]-e,this._manuallyLeftCut[t]=!0}}calculateWallEndPoints(){let t,e,s,i,r;if(this._endPoints.length!=this.count)for(this._endPoints=[],t=0;t<this.count;)e=this.getCorner(t),s=new Y(e.x,e.y),i=k_.WALL_DIRECTION_VECTORS[this.getDirection(t)],r=this.getLength(t),s.x=s.x+i.x*r,s.y=s.y+i.y*r,this._endPoints.push(s),t++}};jh.WALL_DIRECTION_VECTORS=[new R(1,0,0),new R(0,1,0),new R(-1,0,0),new R(0,-1,0)];jh.WALL_NORMAL_VECTORS=[new R(0,1,0),new R(-1,0,0),new R(0,-1,0),new R(1,0,0)];let Bs=jh;const cr=class ht{constructor(){this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._fixedWallHeight=-1,this._floorHeight=0,this._restrictsScaling=!1,this._restrictedScale=1,this._tileMatrix=[],this._tileMatrixOriginal=[],this._planes=[],this._floorHoleMatrix=[],this._wallHeight=3.6,this._wallThicknessMultiplier=1,this._floorThicknessMultiplier=1,this._floorHoles=new Map}static getFloorHeight(t){const e=t.length;if(!e)return 0;let s=0,i=0;for(;i<e;){const r=t[i];let a=0;for(;a<r.length;){const o=r[a];o>s&&(s=o),a++}i++}return s}static findEntranceTile(t){if(!t)return null;const e=t.length;if(!e)return null;const s=[];let i=0;for(;i<e;){const r=t[i];if(!r||!r.length)return null;let a=0;for(;a<r.length;){if(r[a]>=0){s.push(a);break}a++}s.length<i+1&&s.push(r.length+1),i++}for(i=1;i<s.length-1;){if(Math.trunc(s[i])<=Math.trunc(s[i-1])-1&&Math.trunc(s[i])<=Math.trunc(s[i+1])-1)return new Y(Math.trunc(s[i]|0),i);i++}return null}static expandFloorTiles(t){let e,s,i,r,a,o,_,l,c,d,E,I;const m=t.length,T=t[0].length,p=[];for(s=0;s<m*4;)p[s]=[],s++;let A=0;for(s=0;s<m;){for(a=0,e=0;e<T;){if(o=t[s][e],o<0||o<=255)for(r=0;r<4;){for(i=0;i<4;)p[A+r]===void 0&&(p[A+r]=[]),p[A+r][a+i]=o<0?o:o*4,i++;r++}else{for(_=(o&255)*4,l=_+(o>>11&1)*3,c=_+(o>>10&1)*3,d=_+(o>>9&1)*3,E=_+(o>>8&1)*3,i=0;i<3;)I=i+1,p[A][a+i]=(l*(3-i)+c*i)/3,p[A+3][a+I]=(d*(3-I)+E*I)/3,p[A+I][a]=(l*(3-I)+d*I)/3,p[A+i][a+3]=(c*(3-i)+E*i)/3,i++;p[A+1][a+1]=l>_?_+2:_+1,p[A+1][a+2]=c>_?_+2:_+1,p[A+2][a+1]=d>_?_+2:_+1,p[A+2][a+2]=E>_?_+2:_+1}a=a+4,e++}A=A+4,s++}return p}static addTileTypes(t){let e,s,i,r,a,o,_,l,c,d,E,I,m;const T=t.length-1,p=t[0].length-1;for(s=1;s<T;){for(e=1;e<p;)i=t[s][e],i<0||(r=t[s-1][e-1]&255,a=t[s-1][e]&255,o=t[s-1][e+1]&255,_=t[s][e-1]&255,l=t[s][e+1]&255,c=t[s+1][e-1]&255,d=t[s+1][e]&255,E=t[s+1][e+1]&255,I=i+1,m=(r==I||a==I||_==I?8:0)|(o==I||a==I||l==I?4:0)|(c==I||d==I||_==I?2:0)|(E==I||d==I||l==I?1:0),m==15&&(m=0),t[s][e]=i|m<<8),e++;s++}}static unpadHeightMap(t){t.shift(),t.pop();for(const e of t)e.shift(),e.pop()}static padHeightMap(t){const e=[],s=[];for(const i of t)i.push(ht.TILE_BLOCKED),i.unshift(ht.TILE_BLOCKED);for(const i of t[0])e.push(ht.TILE_BLOCKED),s.push(ht.TILE_BLOCKED);t.push(s),t.unshift(e)}get minX(){return this._minX}get maxX(){return this._maxX}get minY(){return this._minY}get maxY(){return this._maxY}get tileMapWidth(){return this._width}get tileMapHeight(){return this._height}get planeCount(){return this._planes.length}get floorHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight:this._floorHeight}get wallHeight(){return this._fixedWallHeight!=-1?this._fixedWallHeight+3.6:this._wallHeight}set wallHeight(t){t<0&&(t=0),this._wallHeight=t}get wallThicknessMultiplier(){return this._wallThicknessMultiplier}set wallThicknessMultiplier(t){t<0&&(t=0),this._wallThicknessMultiplier=t}get floorThicknessMultiplier(){return this._floorThicknessMultiplier}set floorThicknessMultiplier(t){t<0&&(t=0),this._floorThicknessMultiplier=t}dispose(){this._planes=null,this._tileMatrix=null,this._tileMatrixOriginal=null,this._floorHoleMatrix=null,this._floorHoles!=null&&(this._floorHoles.clear(),this._floorHoles=null)}reset(){this._planes=[],this._tileMatrix=[],this._tileMatrixOriginal=[],this._width=0,this._height=0,this._minX=0,this._maxX=0,this._minY=0,this._maxY=0,this._floorHeight=0,this._floorHoleMatrix=[]}initializeTileMap(t,e){t<0&&(t=0),e<0&&(e=0),this._tileMatrix=[],this._tileMatrixOriginal=[],this._floorHoleMatrix=[];let s=0;for(;s<e;){const i=[],r=[],a=[];let o=0;for(;o<t;)i[o]=ht.TILE_BLOCKED,r[o]=ht.TILE_BLOCKED,a[o]=!1,o++;this._tileMatrix.push(i),this._tileMatrixOriginal.push(r),this._floorHoleMatrix.push(a),s++}return this._width=t,this._height=e,this._minX=this._width,this._maxX=-1,this._minY=this._height,this._maxY=-1,!0}setTileHeight(t,e,s){let i,r,a,o,_;if(t>=0&&t<this._width&&e>=0&&e<this._height){if(i=this._tileMatrix[e],i[t]=s,s>=0)t<this._minX&&(this._minX=t),t>this._maxX&&(this._maxX=t),e<this._minY&&(this._minY=e),e>this._maxY&&(this._maxY=e);else{if(t==this._minX||t==this._maxX){for(r=!1,a=this._minY;a<this._maxY;){if(this.getTileHeightInternal(t,a)>=0){r=!0;break}a++}r||(t==this._minX&&this._minX++,t==this._maxX&&this._maxX--)}if(e==this._minY||e==this._maxY){for(o=!1,_=this._minX;_<this._maxX;){if(this.getTileHeight(_,e)>=0){o=!0;break}_++}o||(e==this._minY&&this._minY++,e==this._maxY&&this._maxY--)}}return!0}return!1}getTileHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return ht.TILE_BLOCKED;const s=this._tileMatrix[e];return s[t]===void 0?0:Math.abs(s[t])}getTileHeightOriginal(t,e){return t<0||t>=this._width||e<0||e>=this._height?ht.TILE_BLOCKED:this._floorHoleMatrix[e][t]?ht.TILE_HOLE:this._tileMatrixOriginal[e][t]}getTileHeightInternal(t,e){return t<0||t>=this._width||e<0||e>=this._height?ht.TILE_BLOCKED:this._tileMatrix[e][t]}initializeFromTileData(t=-1){let e,s;for(this._fixedWallHeight=t,s=0;s<this._height;){for(e=0;e<this._width;)this._tileMatrixOriginal[s]===void 0&&(this._tileMatrixOriginal[s]=[]),this._tileMatrixOriginal[s][e]=this._tileMatrix[s][e],e++;s++}const i=ht.findEntranceTile(this._tileMatrix);for(s=0;s<this._height;){for(e=0;e<this._width;)this._floorHoleMatrix[s]===void 0&&(this._floorHoleMatrix[s]=[]),this._floorHoleMatrix[s][e]&&this.setTileHeight(e,s,ht.TILE_HOLE),e++;s++}return this.initialize(i)}initialize(t){let e=0;t!=null&&(e=this.getTileHeight(t.x,t.y),this.setTileHeight(t.x,t.y,ht.TILE_BLOCKED)),this._floorHeight=ht.getFloorHeight(this._tileMatrix),this.createWallPlanes();const s=[];for(const r of this._tileMatrix)s.push(r.concat());ht.padHeightMap(s),ht.addTileTypes(s),ht.unpadHeightMap(s);const i=ht.expandFloorTiles(s);return this.extractPlanes(i),t!=null&&(this.setTileHeight(t.x,t.y,e),this.addFloor(new R(t.x+.5,t.y+.5,e),new R(-1,0,0),new R(0,-1,0),!1,!1,!1,!1)),!0}generateWallData(t,e){let s,i,r,a,o;const _=new Bs,l=[this.extractTopWall.bind(this),this.extractRightWall.bind(this),this.extractBottomWall.bind(this),this.extractLeftWall.bind(this)];let c=0,d=new Y(t.x,t.y),E=0;for(;E++<1e3;){if(s=!1,i=!1,r=c,(d.x<this.minX||d.x>this.maxX||d.y<this.minY||d.y>this.maxY)&&(s=!0),a=l[c](d,e),a==null)return null;if(o=Math.abs(a.x-d.x)+Math.abs(a.y-d.y),d.x==a.x||d.y==a.y?(c=(c-1+l.length)%l.length,o=o+1,i=!0):(c=(c+1)%l.length,o--),_.addWall(d,r,o,s,i),a.x==t.x&&a.y==t.y&&(a.x!=d.x||a.y!=d.y))break;d=a}return _.count==0?null:_}hidePeninsulaWallChains(t){let e,s,i,r,a=0;const o=t.count;for(;a<o;){const _=a;for(e=a,s=0,i=!1;!t.getBorder(a)&&a<o;)t.getLeftTurn(a)?s++:s>0&&s--,s>1&&(i=!0),e=a,a++;if(i)for(r=_;r<=e;)t.setHideWall(r,!0),r++;a++}}updateWallsNextToHoles(t){let e,s,i,r,a,o,_;const l=t.count;let c=0;for(;c<l;){if(!t.getHideWall(c)){for(e=t.getCorner(c),s=t.getDirection(c),i=t.getLength(c),r=Bs.WALL_DIRECTION_VECTORS[s],a=Bs.WALL_NORMAL_VECTORS[s],o=0,_=0;_<i;){if(this.getTileHeightInternal(e.x+_*r.x-a.x,e.y+_*r.y-a.y)==ht.TILE_HOLE){if(_>0&&o==0){t.setLength(c,_);break}o++}else if(o>0){t.moveCorner(c,o);break}_++}o==i&&t.setHideWall(c,!0)}c++}}resolveOriginalWallIndex(t,e,s){let i,r,a,o,_,l;const c=Math.min(t.y,e.y),d=Math.max(t.y,e.y),E=Math.min(t.x,e.x),I=Math.max(t.x,e.x),m=s.count;let T=0;for(;T<m;){if(i=s.getCorner(T),r=s.getEndPoint(T),t.x==e.x){if(i.x==t.x&&r.x==t.x&&(a=Math.min(i.y,r.y),o=Math.max(i.y,r.y),a<=c&&d<=o))return T}else if(t.y==e.y&&i.y==t.y&&r.y==t.y&&(_=Math.min(i.x,r.x),l=Math.max(i.x,r.x),_<=E&&I<=l))return T;T++}return-1}hideOriginallyHiddenWalls(t,e){let s,i,r,a,o;const _=t.count;let l=0;for(;l<_;)t.getHideWall(l)||(s=t.getCorner(l),i=new Y(s.x,s.y),r=Bs.WALL_DIRECTION_VECTORS[t.getDirection(l)],a=t.getLength(l),i.x=i.x+r.x*a,i.y=i.y+r.y*a,o=this.resolveOriginalWallIndex(s,i,e),o>=0?e.getHideWall(o)&&t.setHideWall(l,!0):t.setHideWall(l,!0)),l++}checkWallHiding(t,e){this.hidePeninsulaWallChains(e),this.updateWallsNextToHoles(t),this.hideOriginallyHiddenWalls(t,e)}addWalls(t,e){const s=t.count,i=e.count;let r=0;for(;r<s;){if(!t.getHideWall(r)){const a=t.getCorner(r),o=t.getDirection(r),_=t.getLength(r),l=Bs.WALL_DIRECTION_VECTORS[o],c=Bs.WALL_NORMAL_VECTORS[o];let d=-1,E=0;for(;E<_;){const ct=this.getTileHeightInternal(a.x+E*l.x+c.x,a.y+E*l.y+c.y);ct>=0&&(ct<d||d<0)&&(d=ct),E++}const I=d;let m=new R(a.x,a.y,I);m=R.sum(m,R.product(c,.5)),m=R.sum(m,R.product(l,-.5));const T=this.wallHeight+Math.min(ht.MAX_WALL_ADDITIONAL_HEIGHT,this.floorHeight)-d,p=R.product(l,-_),A=new R(0,0,T);m=R.dif(m,p);const N=this.resolveOriginalWallIndex(a,t.getEndPoint(r),e);let C=0,L=0;N>=0?(C=e.getDirection((N+1)%i),L=e.getDirection((N-1+i)%i)):(C=t.getDirection((r+1)%s),L=t.getDirection((r-1+s)%s));let D=null;(C-o+4)%4==3?D=Bs.WALL_NORMAL_VECTORS[C]:(o-L+4)%4==3&&(D=Bs.WALL_NORMAL_VECTORS[L]);const v=t.getLeftTurn(r),b=t.getLeftTurn((r-1+s)%s),q=t.getHideWall((r+1)%s),Q=t.getManuallyLeftCut(r),tt=t.getManuallyRightCut(r);this.addWall(m,p,A,D,!b||Q,!v||tt,!q)}r++}}createWallPlanes(){const t=this._tileMatrix;if(t==null)return!1;let e,s,i;const r=t.length;let a=0;if(r==0)return!1;for(e=0;e<r;){if(i=t[e],i==null||i.length==0)return!1;a>0?a=Math.min(a,i.length):a=i.length,e++}const o=Math.min(ht.MAX_WALL_ADDITIONAL_HEIGHT,this._fixedWallHeight!=-1?this._fixedWallHeight:ht.getFloorHeight(t)),_=this.minX;let l=this.minY;for(l=this.minY;l<=this.maxY;){if(this.getTileHeightInternal(_,l)>ht.TILE_HOLE){l--;break}l++}if(l>this.maxY)return!1;const c=new Y(_,l),d=this.generateWallData(c,!0),E=this.generateWallData(c,!1);for(d!=null&&(d.count,E.count,this.checkWallHiding(d,E),this.addWalls(d,E)),s=0;s<this.tileMapHeight;){for(e=0;e<this.tileMapWidth;)this.getTileHeightInternal(e,s)<0&&this.setTileHeight(e,s,-(o+this.wallHeight)),e++;s++}return!0}extractTopWall(t,e){if(t==null)return null;let s=1,i=ht.TILE_HOLE;for(e||(i=ht.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x+s,t.y)>i)return new Y(t.x+s-1,t.y);if(this.getTileHeightInternal(t.x+s,t.y+1)<=i)return new Y(t.x+s,t.y+1);s++}return null}extractRightWall(t,e){if(t==null)return null;let s=1,i=ht.TILE_HOLE;for(e||(i=ht.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y+s)>i)return new Y(t.x,t.y+(s-1));if(this.getTileHeightInternal(t.x-1,t.y+s)<=i)return new Y(t.x-1,t.y+s);s++}return null}extractBottomWall(t,e){if(t==null)return null;let s=1,i=ht.TILE_HOLE;for(e||(i=ht.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x-s,t.y)>i)return new Y(t.x-(s-1),t.y);if(this.getTileHeightInternal(t.x-s,t.y-1)<=i)return new Y(t.x-s,t.y-1);s++}return null}extractLeftWall(t,e){if(t==null)return null;let s=1,i=ht.TILE_HOLE;for(e||(i=ht.TILE_BLOCKED);s<1e3;){if(this.getTileHeightInternal(t.x,t.y-s)>i)return new Y(t.x,t.y-(s-1));if(this.getTileHeightInternal(t.x+1,t.y-s)<=i)return new Y(t.x+1,t.y-s);s++}return null}addWall(t,e,s,i,r,a,o){this.addPlane(Ot.PLANE_WALL,t,e,s,[i]),this.addPlane(Ot.PLANE_LANDSCAPE,t,e,s,[i]);const _=ht.WALL_THICKNESS*this._wallThicknessMultiplier,l=ht.FLOOR_THICKNESS*this._floorThicknessMultiplier,c=R.crossProduct(e,s),d=R.product(c,1/c.length*-_);if(this.addPlane(Ot.PLANE_WALL,R.sum(t,s),e,d,[c,i]),r&&this.addPlane(Ot.PLANE_WALL,R.sum(R.sum(t,e),s),R.product(s,-(s.length+l)/s.length),d,[c,i]),a&&(this.addPlane(Ot.PLANE_WALL,R.sum(t,R.product(s,-l/s.length)),R.product(s,(s.length+l)/s.length),d,[c,i]),o)){const E=R.product(e,_/e.length);this.addPlane(Ot.PLANE_WALL,R.sum(R.sum(t,s),R.product(E,-1)),E,d,[c,e,i])}}addFloor(t,e,s,i,r,a,o){let _,l,c;this.addPlane(Ot.PLANE_FLOOR,t,e,s)!=null&&(_=ht.FLOOR_THICKNESS*this._floorThicknessMultiplier,l=new R(0,0,_),c=R.dif(t,l),a&&this.addPlane(Ot.PLANE_FLOOR,c,e,l),o&&this.addPlane(Ot.PLANE_FLOOR,R.sum(c,R.sum(e,s)),R.product(e,-1),l),i&&this.addPlane(Ot.PLANE_FLOOR,R.sum(c,s),R.product(s,-1),l),r&&this.addPlane(Ot.PLANE_FLOOR,R.sum(c,e),s,l))}initializeFromMapData(t){if(!t)return!1;this.reset(),this.resetFloorHoles();const e=t.width,s=t.height,i=t.wallHeight,r=t.fixedWallsHeight;if(this.initializeTileMap(e,s),t.tileMap){let a=0;for(;a<t.tileMap.length;){const o=t.tileMap[a];if(o){let _=0;for(;_<o.length;){const l=o[_];l&&this.setTileHeight(_,a,l.height),_++}}a++}}if(t.holeMap&&t.holeMap.length){let a=0;for(;a<t.holeMap.length;){const o=t.holeMap[a];o&&(this.addFloorHole(o.id,o.x,o.y,o.width,o.height),a++)}this.initializeHoleMap()}return this.wallHeight=i,this.restrictsDragging=t.restrictsDragging,this.restrictsScaling=t.restrictsScaling,this.restrictedScale=t.restrictedScale,this.initializeFromTileData(r),!0}addPlane(t,e,s,i,r=null){if(s.length==0||i.length==0)return null;const a=new Ot(t,e,s,i,r);return this._planes.push(a),a}getMapData(){const t=new of;t.width=this._width,t.height=this._height,t.wallHeight=this._wallHeight,t.fixedWallsHeight=this._fixedWallHeight,t.dimensions.minX=this.minX,t.dimensions.maxX=this.maxX,t.dimensions.minY=this.minY,t.dimensions.maxY=this.maxY,t.restrictsDragging=this.restrictsDragging,t.restrictsScaling=this.restrictsScaling,t.restrictedScale=this.restrictedScale;let e=0;for(;e<this._height;){const s=[],i=this._tileMatrixOriginal[e];let r=0;for(;r<this._width;){const a=i[r];s.push({height:a}),r++}t.tileMap.push(s),e++}for(const[s,i]of this._floorHoles.entries())i&&t.holeMap.push({id:s,x:i.x,y:i.y,width:i.width,height:i.height});return t}getPlaneLocation(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.loc:null}getPlaneNormal(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normal:null}getPlaneLeftSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.leftSide:null}getPlaneRightSide(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.rightSide:null}getPlaneNormalDirection(t){if(t<0||t>=this.planeCount)return null;const e=this._planes[t];return e?e.normalDirection:null}getPlaneSecondaryNormals(t){let e,s;if(t<0||t>=this.planeCount)return null;const i=this._planes[t];if(i!=null){for(e=[],s=0;s<i.secondaryNormalCount;)e.push(i.getSecondaryNormal(s)),s++;return e}return null}getPlaneType(t){if(t<0||t>=this.planeCount)return Ot.PLANE_UNDEFINED;const e=this._planes[t];return e?e.type:Ot.PLANE_UNDEFINED}getPlaneMaskCount(t){if(t<0||t>=this.planeCount)return 0;const e=this._planes[t];return e?e.maskCount:0}getPlaneMaskLeftSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLoc(e):-1}getPlaneMaskRightSideLoc(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLoc(e):-1}getPlaneMaskLeftSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskLeftSideLength(e):-1}getPlaneMaskRightSideLength(t,e){if(t<0||t>=this.planeCount)return-1;const s=this._planes[t];return s?s.getMaskRightSideLength(e):-1}addFloorHole(t,e,s,i,r){this.removeFloorHole(t),this._floorHoles.set(t,new lH(e,s,i,r))}removeFloorHole(t){this._floorHoles.delete(t)}resetFloorHoles(){this._floorHoles.clear()}initializeHoleMap(){let t,e,s,i,r,a,o,_;for(e=0;e<this._height;){for(s=this._floorHoleMatrix[e],t=0;t<this._width;)s[t]=!1,t++;e++}for(const l of this._floorHoles.values())if(i=l,i!=null)for(r=i.x,a=i.x+i.width-1,o=i.y,_=i.y+i.height-1,r=r<0?0:r,a=a>=this._width?this._width-1:a,o=o<0?0:o,_=_>=this._height?this._height-1:_,e=o;e<=_;){for(s=this._floorHoleMatrix[e],t=r;t<=a;)s[t]=!0,t++;e++}}extractPlanes(t){let e,s,i,r,a,o,_,l,c,d,E,I,m,T,p;const A=t.length,N=t[0].length,C=[];let L=0;for(;L<A;)C[L]=[],L++;let D=0;for(;D<A;){for(e=0;e<N;){if(s=t[D][e],!(s<0||C[D][e])){for(a=e==0||t[D][e-1]!=s,o=D==0||t[D-1][e]!=s,i=e+1;i<N&&!(t[D][i]!=s||C[D][i]||D>0&&t[D-1][i]==s==o);)i++;for(_=i==N||t[D][i]!=s,E=!1,r=D+1;r<A&&!E;){for(l=t[r][e]!=s,E=l||e>0&&t[r][e-1]==s==a||i<N&&t[r][i]==s==_,c=e;c<i;){if(t[r][c]==s==l){E=!0,i=c;break}c++}if(E)break;r++}for(l=l||r==A,_=i==N||t[D][i]!=s,d=D;d<r;){for(c=e;c<i;)C[d][c]=!0,c++;d++}I=e/4-.5,m=D/4-.5,T=(i-e)/4,p=(r-D)/4,this.addFloor(new R(I+T,m+p,s/4),new R(-T,0,0),new R(0,-p,0),_,a,l,o)}e++}D++}}get restrictsDragging(){return this._restrictsDragging}set restrictsDragging(t){this._restrictsDragging=t}get restrictsScaling(){return this._restrictsScaling}set restrictsScaling(t){this._restrictsScaling=t}get restrictedScale(){return this._restrictedScale}set restrictedScale(t){this._restrictedScale=t}};cr.FLOOR_THICKNESS=.25;cr.WALL_THICKNESS=.25;cr.MAX_WALL_ADDITIONAL_HEIGHT=20;cr.TILE_BLOCKED=-110;cr.TILE_HOLE=-100;let jt=cr;class cH extends va{constructor(){super(),this._planeParser=new jt,this._planeBitmapMaskParser=new _f,this._color=16777215,this._light=255,this._originalColor=16777215,this._originalLight=255,this._targetColor=16777215,this._targetLight=255,this._colorChangedTime=0,this._colorTransitionLength=1500,this._lastHoleUpdate=0,this._needsMapUpdate=!1,this._skipColorTransition=!1}getEventTypes(){const t=[j.MOUSE_MOVE,j.CLICK];return this.mergeTypes(super.getEventTypes(),t)}dispose(){super.dispose(),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null),this._planeBitmapMaskParser&&(this._planeBitmapMaskParser.dispose(),this._planeBitmapMaskParser=null)}initialize(t){!t||!this.object||t instanceof of&&this._planeParser.initializeFromMapData(t)&&(this.object.model.setValue(g.ROOM_MAP_DATA,t),this.object.model.setValue(g.ROOM_BACKGROUND_COLOR,16777215),this.object.model.setValue(g.ROOM_FLOOR_VISIBILITY,1),this.object.model.setValue(g.ROOM_WALL_VISIBILITY,1),this.object.model.setValue(g.ROOM_LANDSCAPE_VISIBILITY,1),this._skipColorTransition=k.getValue("room.color.skip.transition")===!0)}update(t){if(super.update(t),this.updateBackgroundColor(t),this._needsMapUpdate){if(this._lastHoleUpdate&&t-this._lastHoleUpdate<5)return;const e=this.object&&this.object.model;if(e){const s=this._planeParser.getMapData();e.setValue(g.ROOM_MAP_DATA,s),e.setValue(g.ROOM_FLOOR_HOLE_UPDATE_TIME,t),this._planeParser.initializeFromMapData(s)}this._lastHoleUpdate=0,this._needsMapUpdate=!1}}updateBackgroundColor(t){if(!this.object||!this._colorChangedTime)return;let e=this._color,s=this._light;if(t-this._colorChangedTime>=this._colorTransitionLength)e=this._targetColor,s=this._targetLight,this._colorChangedTime=0;else{let r=this._originalColor>>16&255,a=this._originalColor>>8&255,o=this._originalColor&255;const _=this._targetColor>>16&255,l=this._targetColor>>8&255,c=this._targetColor&255,d=(t-this._colorChangedTime)/this._colorTransitionLength;r=r+(_-r)*d,a=a+(l-a)*d,o=o+(c-o)*d,e=(r<<16)+(a<<8)+o,s=this._originalLight+(this._targetLight-this._originalLight)*d,this._color=e,this._light=s}let i=qo.rgbToHSL(e);i=(i&16776960)+s,e=qo.hslToRGB(i),this.object.model&&this.object.model.setValue(g.ROOM_BACKGROUND_COLOR,e)}processUpdateMessage(t){if(!t||!this.object)return;const e=this.object.model;if(e){if(t instanceof Ht){this.onObjectRoomUpdateMessage(t,e);return}if(t instanceof Vt){this.onObjectRoomMaskUpdateMessage(t,e);return}if(t instanceof Ls){this.onObjectRoomPlaneVisibilityUpdateMessage(t,e);return}if(t instanceof ys){this.onObjectRoomPlanePropertyUpdateMessage(t,e);return}if(t instanceof Ps){this.onObjectRoomFloorHoleUpdateMessage(t,e);return}if(t instanceof ma){this.onObjectRoomColorUpdateMessage(t,e);return}t instanceof QE&&this.onObjectRoomMapUpdateMessage(t)}}onObjectRoomUpdateMessage(t,e){switch(t.type){case Ht.ROOM_FLOOR_UPDATE:e.setValue(g.ROOM_FLOOR_TYPE,t.value);return;case Ht.ROOM_WALL_UPDATE:e.setValue(g.ROOM_WALL_TYPE,t.value);return;case Ht.ROOM_LANDSCAPE_UPDATE:e.setValue(g.ROOM_LANDSCAPE_TYPE,t.value);return}}onObjectRoomMaskUpdateMessage(t,e){let s=null,i=!1;switch(t.type){case Vt.ADD_MASK:s=Ai.WINDOW,t.maskCategory===Vt.HOLE&&(s=Ai.HOLE),this._planeBitmapMaskParser.addMask(t.maskId,t.maskType,t.maskLocation,s),i=!0;break;case Vt.REMOVE_MASK:i=this._planeBitmapMaskParser.removeMask(t.maskId);break}i&&e.setValue(g.ROOM_PLANE_MASK_XML,this._planeBitmapMaskParser.getXML())}onObjectRoomPlaneVisibilityUpdateMessage(t,e){let s=0;switch(t.visible&&(s=1),t.type){case Ls.FLOOR_VISIBILITY:e.setValue(g.ROOM_FLOOR_VISIBILITY,s);return;case Ls.WALL_VISIBILITY:e.setValue(g.ROOM_WALL_VISIBILITY,s),e.setValue(g.ROOM_LANDSCAPE_VISIBILITY,s);return}}onObjectRoomPlanePropertyUpdateMessage(t,e){switch(t.type){case ys.FLOOR_THICKNESS:e.setValue(g.ROOM_FLOOR_THICKNESS,t.value);return;case ys.WALL_THICKNESS:e.setValue(g.ROOM_WALL_THICKNESS,t.value);return}}onObjectRoomFloorHoleUpdateMessage(t,e){switch(t.type){case Ps.ADD:this._planeParser.addFloorHole(t.id,t.x,t.y,t.width,t.height),this._needsMapUpdate=!0;return;case Ps.REMOVE:this._planeParser.removeFloorHole(t.id),this._needsMapUpdate=!0;return}this._lastHoleUpdate=this.time}onObjectRoomColorUpdateMessage(t,e){!t||!e||(this._originalColor=this._color,this._originalLight=this._light,this._targetColor=t.color,this._targetLight=t.light,this._colorChangedTime=this.time,this._skipColorTransition?this._colorTransitionLength=0:this._colorTransitionLength=1500,e.setValue(g.ROOM_COLORIZE_BG_ONLY,t.backgroundOnly))}onObjectRoomMapUpdateMessage(t){!t||!t.mapData||(this.object.model.setValue(g.ROOM_MAP_DATA,t.mapData),this.object.model.setValue(g.ROOM_FLOOR_HOLE_UPDATE_TIME,this.time),this._planeParser.initializeFromMapData(t.mapData))}mouseEvent(t,e){if(!t||!e||!this.object||!this.object.model)return;const s=t.spriteTag;let i=0;if(s&&s.indexOf("@")>=0&&(i=parseInt(s.substr(s.indexOf("@")+1))),i<1||i>this._planeParser.planeCount){t.type===F.ROLL_OUT&&this.object.model.setValue(g.ROOM_SELECTED_PLANE,0);return}i--;let r=null;const a=this._planeParser.getPlaneLocation(i),o=this._planeParser.getPlaneLeftSide(i),_=this._planeParser.getPlaneRightSide(i),l=this._planeParser.getPlaneNormalDirection(i),c=this._planeParser.getPlaneType(i);if(a==null||o==null||_==null||l==null)return;const d=o.length,E=_.length;if(d==0||E==0)return;const I=t.screenX,m=t.screenY,T=new Y(I,m);if(r=e.getPlanePosition(T,a,o,_),!r){this.object.model.setValue(g.ROOM_SELECTED_PLANE,0);return}const p=R.product(o,r.x/d);p.add(R.product(_,r.y/E)),p.add(a);const A=p.x,N=p.y,C=p.z;if(r.x>=0&&r.x<d&&r.y>=0&&r.y<E)this.object.model.setValue(g.ROOM_SELECTED_X,A),this.object.model.setValue(g.ROOM_SELECTED_Y,N),this.object.model.setValue(g.ROOM_SELECTED_Z,C),this.object.model.setValue(g.ROOM_SELECTED_PLANE,i+1);else{this.object.model.setValue(g.ROOM_SELECTED_PLANE,0);return}let L=null;switch(t.type===F.MOUSE_MOVE||t.type===F.ROLL_OVER?L=j.MOUSE_MOVE:t.type===F.MOUSE_CLICK&&(L=j.CLICK),t.type){case F.MOUSE_MOVE:case F.ROLL_OVER:case F.MOUSE_CLICK:{let D=null;if(c===Ot.PLANE_FLOOR)D=new ls(L,this.object,t.eventId,A,N,C,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown);else if(c===Ot.PLANE_WALL||c===Ot.PLANE_LANDSCAPE){let v=90;l&&(v=l.x+90,v>360&&(v-=360));const b=o.length*r.x/d,q=_.length*r.y/E;D=new Hi(L,this.object,t.eventId,a,o,_,b,q,v,t.altKey,t.ctrlKey,t.shiftKey,t.buttonDown)}this.eventDispatcher&&this.eventDispatcher.dispatchEvent(D);return}}}}class dH extends va{initialize(t){this.object&&(this.object.model.setValue(g.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(1,0))}processUpdateMessage(t){if(super.processUpdateMessage(t),t instanceof Us&&this.object)switch(t.type){case Us.ENABLED:this.object.setState(0,0);return;case Us.DISABLED:this.object.setState(1,0);return}}}const so=class Yi extends va{constructor(){super(),this._lastEventId=null,this._isHidden=!1}initialize(t){this.object&&(this.object.model.setValue(g.FURNITURE_ALPHA_MULTIPLIER,1),this.object.setState(Yi.CURSOR_HIDDEN_STATE,0))}processUpdateMessage(t){t instanceof ji&&(this._lastEventId&&this._lastEventId===t.sourceEventId||(t.toggleVisibility&&(this._isHidden=!this._isHidden),super.processUpdateMessage(t),this.object&&(this._isHidden?this.object.setState(Yi.CURSOR_HIDDEN_STATE,0):t.visible?(this.object.model.setValue(g.TILE_CURSOR_HEIGHT,t.height),this.object.setState(t.height>.8?Yi.CURSOR_HEIGHT_STATE:Yi.CURSOR_VISIBLE_STATE)):this.object.setState(Yi.CURSOR_HIDDEN_STATE,0)),this._lastEventId=t.sourceEventId))}};so.CURSOR_VISIBLE_STATE=0;so.CURSOR_HIDDEN_STATE=1;so.CURSOR_HEIGHT_STATE=6;let gH=so;class hf{constructor(t,e,s){this._id=t,this._type=e,this._visualization=s}dispose(){this._visualization=null}update(t,e){}animate(t){return!1}get id(){return this._id}get type(){return this._type}get visualization(){return this._visualization}}const dr=class js extends hf{constructor(t,e,s){super(t,e,s),this._asset=null,this._startTime=$(),this._delta=0,this._offsetY=0,this._scale=0,this._state=0}update(t,e){if(!t)return;this._scale=e;let s=64,i=0;if(e<48?(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss_small"),this.visualization.angle===90||this.visualization.angle===270?i=0:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=6:i=-6,this._offsetY=-38,s=32):(this._asset=this.visualization.getAvatarRenderAsset("avatar_addition_user_blowkiss"),this.visualization.angle===90||this.visualization.angle===270?i=-3:this.visualization.angle===135||this.visualization.angle===180||this.visualization.angle===225?i=22:i=-30,this._offsetY=-70),this.visualization.posture===w.POSTURE_SIT?this._offsetY+=s/2:this.visualization.posture===w.POSTURE_LAY&&(this._offsetY+=s),this._asset){t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0;const r=this._delta;this.animate(t),this._delta=r}}animate(t){if(!t)return!1;if(this._asset&&(t.texture=this._asset),this._state===js.STATE_DELAY)return $()-this._startTime<js.DELAY_BEFORE_ANIMATION?!1:(this._state=js.STATE_FADE_IN,t.alpha=0,t.visible=!0,this._delta=0,!0);if(this._state===js.STATE_FADE_IN)return this._delta+=.1,t.offsetY=this._offsetY,t.alpha=Math.pow(this._delta,.9)*255,this._delta>=1&&(t.alpha=255,this._delta=0,this._state=js.STATE_FLOAT),!0;if(this._state===js.STATE_FLOAT){const e=Math.pow(this._delta,.9);this._delta+=.05;const s=this._scale<48?-30:-40;return t.offsetY=this._offsetY+(this._delta<1?e:1)*s,t.alpha=(1-e)*255,t.alpha<=0&&(t.visible=!1,this._state=js.STATE_COMPLETE),!0}return!1}};dr.DELAY_BEFORE_ANIMATION=300;dr.STATE_DELAY=0;dr.STATE_FADE_IN=1;dr.STATE_FLOAT=2;dr.STATE_COMPLETE=3;let EH=dr;class gr{static getExpressionAddition(t,e,s){switch(e){case this.BLOW:return new EH(t,this.BLOW,s);default:return new hf(t,e,s)}}}gr.WAVE=1;gr.BLOW=2;gr.LAUGH=3;gr.CRY=4;gr.IDLE=5;const Er=class xe{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._startTime=$(),this._offsetY=0,this._scale=0,this._state=0}dispose(){this._visualization=null,this._asset=null}getSpriteAssetName(t){let e="left";return(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270)&&(e="right"),"avatar_addition_user_idle_"+e+"_"+t+(this._scale<48?"_small":"")}update(t,e){if(!t)return;this._scale=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(this._state===xe.STATE_FRAME_A?1:2));let s=64,i=0;e<48?(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=10:i=-16,this._offsetY=-38,s=32):(this._visualization.angle===135||this._visualization.angle===180||this._visualization.angle===225||this._visualization.angle===270?i=22:i=-30,this._offsetY=-70),this._visualization.posture===w.POSTURE_SIT?this._offsetY+=s/2:this._visualization.posture===w.POSTURE_LAY&&(this._offsetY+=s-.3*s),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=this._offsetY,t.relativeDepth=-.02,t.alpha=0)}animate(t){if(!t)return!1;const e=$();return this._state===xe.STATE_DELAY&&e-this._startTime>=xe.DELAY_BEFORE_ANIMATION&&(this._state=xe.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._state===xe.STATE_FRAME_A&&e-this._startTime>=xe.DELAY_PER_FRAME&&(this._state=xe.STATE_FRAME_B,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(2))),this._state===xe.STATE_FRAME_B&&e-this._startTime>=xe.DELAY_PER_FRAME&&(this._state=xe.STATE_FRAME_A,this._startTime=e,this._asset=this._visualization.getAvatarRenderAsset(this.getSpriteAssetName(1))),this._asset?(t.texture=this._asset,t.alpha=255,t.visible=!0):t.visible=!1,!1}get id(){return this._id}};Er.DELAY_BEFORE_ANIMATION=2e3;Er.DELAY_PER_FRAME=2e3;Er.STATE_DELAY=0;Er.STATE_FRAME_A=1;Er.STATE_FRAME_B=2;let fH=Er;const In=class Fr{constructor(t){this._id=t,this._asset=null,this._disposed=!1}dispose(){this._asset=null}update(t,e){if(t){if(!this._asset){const s=new Mt(Ct.WHITE);s.alpha=0,s.width=Fr.WIDTH,s.height=Fr.HEIGHT,this._asset=At.generateTexture(s)}t.visible=!0,t.texture=this._asset,t.offsetX=Fr.OFFSET_X,t.offsetY=Fr.OFFSET_Y,t.alphaTolerance=Ne.MATCH_ALL_PIXELS}}animate(t){return!1}get id(){return this._id}};In.WIDTH=46;In.HEIGHT=60;In.OFFSET_X=-23;In.OFFSET_Y=-48;let mH=In;class IH{constructor(t,e,s){this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0,this._status=s}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,r=0;this._asset=this._visualization.getAvatarRenderAsset(this._status===we.GUIDE?"avatar_addition_user_guide_bubble":"avatar_addition_user_guide_requester_bubble"),e<48?(i=-19,r=-80,s=32):(i=-19,r=-120),this._visualization.posture===w.POSTURE_SIT?r+=s/2:this._visualization.posture===w.POSTURE_LAY&&(r+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class RH{constructor(t,e){this._id=t,this._visualization=e,this._asset=null}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;let s=64,i=0,r=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted_small"),s=32,i=-12,r=-66):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_muted"),i=-15,r=-110),this._visualization.posture===w.POSTURE_SIT?r+=s/2:this._visualization.posture===w.POSTURE_LAY&&(r+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.02):t.visible=!1}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}}class TH{constructor(t,e,s){this._id=t,this._visualization=s,this._asset=null,this._scale=0,this._number=e,this._numberValueFadeDirection=0,this._numberValueMoving=!1,this._numberValueMoveCounter=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;this._scale=e;let s=64,i=0,r=0;this._number>0?(e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number+"_small"),s=32,i=-6,r=-52):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_number_"+this._number),i=-8,r=-105),this._visualization.posture===w.POSTURE_SIT?r+=s/2:this._visualization.posture===w.POSTURE_LAY&&(r+=e),this._asset?(t.visible=!0,t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.01,t.alpha=0,this._numberValueFadeDirection=1,this._numberValueMoving=!0,this._numberValueMoveCounter=0):t.visible=!1):t.visible&&(this._numberValueFadeDirection=-1)}animate(t){if(!t)return!1;this._asset&&(t.texture=this._asset);let e=t.alpha,s=!1;if(this._numberValueMoving){if(this._numberValueMoveCounter++,this._numberValueMoveCounter<10)return!1;if(this._numberValueFadeDirection<0)this._scale<48?t.offsetY-=2:t.offsetY-=4;else{let i=4;this._scale<48&&(i=8),this._numberValueMoveCounter%i||(t.offsetY--,s=!0)}}return this._numberValueFadeDirection>0?(e<255&&(e+=32),e>=255&&(e=255,this._numberValueFadeDirection=0),t.alpha=e,!0):this._numberValueFadeDirection<0?(e>=0&&(e-=32),e<=0&&(this._numberValueFadeDirection=0,this._numberValueMoving=!1,e=0,t.visible=!1),t.alpha=e,!0):s}get id(){return this._id}}class pH{constructor(t,e){this._id=t,this._visualization=e,this._asset=null,this._relativeDepth=0}dispose(){this._visualization=null,this._asset=null}update(t,e){if(!t)return;t.visible=!0,t.relativeDepth=this._relativeDepth,t.alpha=255;let s=64,i=0,r=0;e<48?(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing_small"),i=3,r=-42,s=32):(this._asset=this._visualization.getAvatarRenderAsset("avatar_addition_user_typing"),i=14,r=-83),this._visualization.posture===w.POSTURE_SIT?r+=s/2:this._visualization.posture===w.POSTURE_LAY&&(r+=e),this._asset&&(t.texture=this._asset,t.offsetX=i,t.offsetY=r,t.relativeDepth=-.02+0)}animate(t){return this._asset&&t&&(t.texture=this._asset),!1}get id(){return this._id}get relativeDepth(){return this._relativeDepth}set relativeDepth(t){this._relativeDepth=t}}class Ia extends ge{constructor(){super()}initialize(t){return!0}onDispose(){this._avatarRenderer=null}createAvatarImage(t,e,s=null,i=null,r=null){let a=null;return e>48?a=this._avatarRenderer.createAvatarImage(t,es.LARGE,s,i,r):a=this._avatarRenderer.createAvatarImage(t,es.SMALL,s,i,r),a}getAvatarRendererAsset(t){return this._avatarRenderer?this._avatarRenderer.assets.getTexture(t):null}get avatarManager(){return this._avatarRenderer}set avatarManager(t){this._avatarRenderer=t}get layerCount(){return 0}}const yt=class W extends ba{constructor(){super(),this._data=null,this._avatarImage=null,this._cachedAvatars=new vt,this._cachedAvatarEffects=new vt,this._shadow=null,this._lastUpdate=-1e3,this._disposed=!1,this._figure=null,this._gender=null,this._direction=-1,this._headDirection=-1,this._posture="",this._postureParameter="",this._canStandUp=!1,this._postureOffset=0,this._verticalOffset=0,this._angle=-1,this._headAngle=-1,this._talk=!1,this._expression=0,this._sleep=!1,this._blink=!1,this._gesture=0,this._sign=-1,this._highlightEnabled=!1,this._highlight=!1,this._dance=0,this._effect=0,this._carryObject=0,this._useObject=0,this._ownUser=!1,this._isLaying=!1,this._layInside=!1,this._isAnimating=!1,this._extraSpritesStartIndex=2,this._forcedAnimFrames=0,this._updatesUntilFrameUpdate=0,this._isAvatarReady=!1,this._needsUpdate=!1,this._geometryUpdateCounter=-1,this._additions=new Map}initialize(t){return t instanceof Ia?(this._data=t,this.createSprites(W.INITIAL_RESERVED_SPRITES),super.initialize(t),!0):!1}dispose(){this._disposed||(super.dispose(),this._avatarImage&&this._avatarImage.dispose(),this._shadow=null,this._disposed=!0)}update(t,e,s,i){if(!this.object||!t||!this._data||e<this._lastUpdate+W.UPDATE_TIME_INCREASER)return;this._lastUpdate+=W.UPDATE_TIME_INCREASER,this._lastUpdate+W.UPDATE_TIME_INCREASER<e&&(this._lastUpdate=e-W.UPDATE_TIME_INCREASER);const r=this.object.model,a=t.scale,o=this._effect;let _=!1,l=!1,c=!1,d=!1;const E=this.updateModel(r,a);if(E||a!==this._scale||!this._avatarImage){if(a!==this._scale&&(_=!0,this.updateScale(a)),o!==this._effect&&(l=!0),_||!this._avatarImage||l){if(this._avatarImage=this.createAvatarImage(a,this._effect),!this._avatarImage)return;c=!0;const T=this.getSprite(W.AVATAR_LAYER_ID);T&&this._avatarImage&&this._avatarImage.isPlaceholder()?T.alpha=150:T&&(T.alpha=255)}if(!this._avatarImage)return;if(l&&this._avatarImage.animationHasResetOnToggle&&this._avatarImage.resetAnimationFrameCounter(),this.updateShadow(a),d=this.updateObject(this.object,t,s,!0),this.processActionsForAvatar(this._avatarImage),this._additions){let T=this._extraSpritesStartIndex;for(const p of this._additions.values())p.update(this.getSprite(T++),a)}this._scale=a}else d=this.updateObject(this.object,t,s);if(this._additions){let T=this._extraSpritesStartIndex;for(const p of this._additions.values())p.animate(this.getSprite(T++))&&this.updateSpriteCounter++}const I=d||E||_,m=(this._isAnimating||this._forcedAnimFrames>0)&&s;if(I&&(this._forcedAnimFrames=W.ANIMATION_FRAME_UPDATE_INTERVAL),I||m){if(this.updateSpriteCounter++,this._forcedAnimFrames--,this._updatesUntilFrameUpdate--,this._updatesUntilFrameUpdate<=0||_||E||c)this._avatarImage.updateAnimationByFrames(1),this._updatesUntilFrameUpdate=W.ANIMATION_FRAME_UPDATE_INTERVAL;else return;let T=this._avatarImage.getCanvasOffsets();(!T||T.length<3)&&(T=W.DEFAULT_CANVAS_OFFSETS);const p=this.getSprite(W.SPRITE_INDEX_AVATAR);if(p){const L=this.object.model.getValue(g.FIGURE_HIGHLIGHT_ENABLE)===1&&this.object.model.getValue(g.FIGURE_HIGHLIGHT)===1,D=this._avatarImage.getImage(ie.FULL,L);D&&(p.texture=D,L||(p.filters=[])),p.texture&&(p.offsetX=-1*a/2+T[0]-(p.texture.width-a)/2,p.offsetY=-p.texture.height+a/4+T[1]+this._postureOffset),this._isLaying?this._layInside?p.relativeDepth=-.5:p.relativeDepth=W.AVATAR_SPRITE_LAYING_DEPTH+T[2]:p.relativeDepth=W.AVATAR_SPRITE_DEFAULT_DEPTH+T[2],this._ownUser?(p.relativeDepth-=W.AVATAR_OWN_DEPTH_ADJUST,p.spriteType=he.AVATAR_OWN):p.spriteType=he.AVATAR}const A=this.getAddition(W.TYPING_BUBBLE_ID);A&&(this._isLaying?A.relativeDepth=W.AVATAR_SPRITE_LAYING_DEPTH-.01+T[2]:A.relativeDepth=W.AVATAR_SPRITE_DEFAULT_DEPTH-.01+T[2]),this._isAnimating=this._avatarImage.isAnimating();let N=W.INITIAL_RESERVED_SPRITES;const C=this._avatarImage.getDirection();for(const L of this._avatarImage.getSprites())if(L.id===W.AVATAR){const D=this.getSprite(W.SPRITE_INDEX_AVATAR);if(D){const v=this._avatarImage.getLayerData(L);let b=L.getDirectionOffsetX(C),q=L.getDirectionOffsetY(C);v&&(b+=v.dx,q+=v.dy),a<48&&(b/=2,q/=2),this._canStandUp||(D.offsetX+=b,D.offsetY+=q)}}else{const D=this.getSprite(N);if(D){D.alphaTolerance=Ne.MATCH_NOTHING,D.visible=!0;const v=this._avatarImage.getLayerData(L);let b=0,q=L.getDirectionOffsetX(C),Q=L.getDirectionOffsetY(C);const tt=L.getDirectionOffsetZ(C);let ct=0;L.hasDirections&&(ct=C),v&&(b=v.animationFrame,q+=v.dx,Q+=v.dy,ct+=v.dd),a<48&&(q/=2,Q/=2),ct<0?ct+=8:ct>7&&(ct-=8);const Kt=this._avatarImage.getScale()+"_"+L.member+"_"+ct+"_"+b,Ut=this._avatarImage.getAsset(Kt);if(!Ut)continue;D.texture=Ut.texture,D.offsetX=Ut.offsetX-a/2+q,D.offsetY=Ut.offsetY+Q,D.flipH=Ut.flipH,L.hasStaticY?D.offsetY+=this._verticalOffset*a/(2*W.BASE_Y_SCALE):D.offsetY+=this._postureOffset,this._isLaying?D.relativeDepth=W.AVATAR_SPRITE_LAYING_DEPTH-.001*this.totalSprites*tt:D.relativeDepth=W.AVATAR_SPRITE_DEFAULT_DEPTH-.001*this.totalSprites*tt,L.ink===33?D.blendMode=Cs.ADD:D.blendMode=Cs.NORMAL}N++}}}createAvatarImage(t,e){let s=null,i="avatarImage"+t.toString();if(e?(i+="-"+e,s=this._cachedAvatarEffects.getValue(i)):s=this._cachedAvatars.getValue(i),!s&&(s=this._data.createAvatarImage(this._figure,t,this._gender,this,this),s))if(!e)this._cachedAvatars.add(i,s);else{if(this._cachedAvatarEffects.length>=W.MAX_EFFECT_CACHE){const r=this._cachedAvatarEffects.remove(this._cachedAvatarEffects.getKey(0));r&&r.dispose()}this._cachedAvatarEffects.add(i,s)}return s}updateObject(t,e,s,i=!1){if(!i&&this.updateObjectCounter===t.updateCounter&&this._geometryUpdateCounter===e.updateId)return!1;let r=t.getDirection().x-e.direction.x,a=this._headDirection-e.direction.x;return this._posture==="float"&&(a=r),r=(r%360+360)%360,a=(a%360+360)%360,this._posture==="sit"&&this._canStandUp&&(r-=r%90-45,a-=a%90-45),(r!==this._angle||i)&&(s=!0,this._angle=r,r=r-(135-22.5),r=(r+360)%360,this._avatarImage.setDirectionAngle(ie.FULL,r)),(a!==this._headAngle||i)&&(s=!0,this._headAngle=a,this._headAngle!==this._angle&&(a=a-(135-22.5),a=(a+360)%360,this._avatarImage.setDirectionAngle(ie.HEAD,a))),this._geometryUpdateCounter=e.updateId,this.updateObjectCounter=this.object.updateCounter,s}updateModel(t,e){if(!t||this.updateModelCounter===t.updateCounter)return!1;let s=!1;const i=t.getValue(g.FIGURE_TALK)>0;i!==this._talk&&(this._talk=i,s=!0);const r=t.getValue(g.FIGURE_EXPRESSION);r!==this._expression&&(this._expression=r,s=!0);const a=t.getValue(g.FIGURE_SLEEP)>0;a!==this._sleep&&(this._sleep=a,s=!0);const o=t.getValue(g.FIGURE_BLINK)>0;o!==this._blink&&(this._blink=o,s=!0);const _=t.getValue(g.FIGURE_GESTURE)||0;_!==this._gesture&&(this._gesture=_,s=!0);const l=t.getValue(g.FIGURE_POSTURE);l!==this._posture&&(this._posture=l,s=!0);const c=t.getValue(g.FIGURE_POSTURE_PARAMETER);c!==this._postureParameter&&(this._postureParameter=c,s=!0);const d=t.getValue(g.FIGURE_CAN_STAND_UP);d!==this._canStandUp&&(this._canStandUp=d,s=!0);const E=t.getValue(g.FIGURE_VERTICAL_OFFSET)*W.BASE_Y_SCALE;E!==this._verticalOffset&&(this._verticalOffset=E,s=!0);const I=t.getValue(g.FIGURE_DANCE)||0;I!==this._dance&&(this._dance=I,s=!0);const m=t.getValue(g.FIGURE_EFFECT)||0;m!==this._effect&&(this._effect=m,s=!0);const T=t.getValue(g.FIGURE_CARRY_OBJECT)||0;T!==this._carryObject&&(this._carryObject=T,s=!0);const p=t.getValue(g.FIGURE_USE_OBJECT)||0;p!==this._useObject&&(this._useObject=p,s=!0);const A=t.getValue(g.HEAD_DIRECTION);A!==this._headDirection&&(this._headDirection=A,s=!0),this._carryObject>0&&p>0?this._useObject!==this._carryObject&&(this._useObject=this._carryObject,s=!0):this._useObject!==0&&(this._useObject=0,s=!0);let N=this.getAddition(W.FLOATING_IDLE_Z_ID);this._sleep?(N||(N=this.addAddition(new fH(W.FLOATING_IDLE_Z_ID,this))),s=!0):N&&this.removeAddition(W.FLOATING_IDLE_Z_ID);const C=t.getValue(g.FIGURE_IS_MUTED)>0;let L=this.getAddition(W.MUTED_BUBBLE_ID);if(C)L||(L=this.addAddition(new RH(W.MUTED_BUBBLE_ID,this))),s=!0;else{L&&(this.removeAddition(W.MUTED_BUBBLE_ID),s=!0);const Ze=t.getValue(g.FIGURE_IS_TYPING)>0;let us=this.getAddition(W.TYPING_BUBBLE_ID);Ze?(us||(us=this.addAddition(new pH(W.TYPING_BUBBLE_ID,this))),s=!0):us&&(this.removeAddition(W.TYPING_BUBBLE_ID),s=!0)}const D=t.getValue(g.FIGURE_GUIDE_STATUS)||0;D!==we.NONE?(this.removeAddition(W.GUIDE_BUBBLE_ID),this.addAddition(new IH(W.GUIDE_BUBBLE_ID,this,D)),s=!0):this.getAddition(W.GUIDE_BUBBLE_ID)&&(this.removeAddition(W.GUIDE_BUBBLE_ID),s=!0);const v=t.getValue(g.FIGURE_IS_PLAYING_GAME)>0;let b=this.getAddition(W.GAME_CLICK_TARGET_ID);v?(b||(b=this.addAddition(new mH(W.GAME_CLICK_TARGET_ID))),s=!0):b&&this.removeAddition(W.GAME_CLICK_TARGET_ID);const q=t.getValue(g.FIGURE_NUMBER_VALUE);let Q=this.getAddition(W.NUMBER_BUBBLE_ID);q>0?(Q||(Q=this.addAddition(new TH(W.NUMBER_BUBBLE_ID,q,this))),s=!0):Q&&this.removeAddition(W.NUMBER_BUBBLE_ID);let tt=this.getAddition(W.EXPRESSION_ID);this._expression>0?tt||(tt=gr.getExpressionAddition(W.EXPRESSION_ID,this._expression,this),tt&&this.addAddition(tt)):tt&&this.removeAddition(W.EXPRESSION_ID),this.updateScale(e);const ct=t.getValue(g.GENDER);ct!==this._gender&&(this._gender=ct,s=!0),this.updateFigure(t.getValue(g.FIGURE))&&(s=!0);let Kt=t.getValue(g.FIGURE_SIGN);Kt===null&&(Kt=-1),this._sign!==Kt&&(this._sign=Kt,s=!0);const Ut=t.getValue(g.FIGURE_HIGHLIGHT_ENABLE)>0;if(Ut!==this._highlightEnabled&&(this._highlightEnabled=Ut,s=!0),this._highlightEnabled){const Ze=t.getValue(g.FIGURE_HIGHLIGHT)>0;Ze!==this._highlight&&(this._highlight=Ze,s=!0)}const be=t.getValue(g.OWN_USER)>0;return be!==this._ownUser&&(this._ownUser=be,s=!0),this.updateModelCounter=t.updateCounter,s}setDirection(t){this._direction!==t&&(this._direction=t,this._needsUpdate=!0)}updateScale(t){t<48&&(this._blink=!1),this._posture==="sit"||this._posture==="lay"?this._postureOffset=t/2:this._postureOffset=0,this._layInside=!1,this._isLaying=!1,this._posture==="lay"&&(this._isLaying=!0,parseInt(this._postureParameter)<0&&(this._layInside=!0))}processActionsForAvatar(t){if(!t)return;if(t.initActionAppends(),t.appendAction(w.POSTURE,this._posture,this._postureParameter),this._gesture>0&&this._avatarImage.appendAction(w.GESTURE,w.getGesture(this._gesture)),this._dance>0&&this._avatarImage.appendAction(w.DANCE,this._dance),this._sign>-1&&this._avatarImage.appendAction(w.SIGN,this._sign),this._carryObject>0&&this._avatarImage.appendAction(w.CARRY_OBJECT,this._carryObject),this._useObject>0&&this._avatarImage.appendAction(w.USE_OBJECT,this._useObject),this._talk&&this._avatarImage.appendAction(w.TALK),(this._sleep||this._blink)&&this._avatarImage.appendAction(w.SLEEP),this._expression>0){const s=w.getExpression(this._expression);if(s!=="")switch(s){case w.DANCE:this._avatarImage.appendAction(w.DANCE,2);break;default:this._avatarImage.appendAction(s);break}}this._effect>0&&this._avatarImage.appendAction(w.EFFECT,this._effect),t.endActionAppends(),this._isAnimating=t.isAnimating();let e=W.INITIAL_RESERVED_SPRITES;for(const s of this._avatarImage.getSprites())s.id!==W.AVATAR&&e++;if(e!==this.totalSprites&&this.createSprites(e),this._extraSpritesStartIndex=e,this._additions)for(const s of this._additions.values())this.createSprite()}updateFigure(t){return this._figure===t?!1:(this._figure=t,this.clearAvatar(),!0)}resetFigure(t){this.clearAvatar()}resetEffect(t){this.clearAvatar()}clearAvatar(){for(const e of this._cachedAvatars.getValues())e&&e.dispose();for(const e of this._cachedAvatarEffects.getValues())e&&e.dispose();this._cachedAvatars.reset(),this._cachedAvatarEffects.reset(),this._avatarImage=null;const t=this.getSprite(W.AVATAR_LAYER_ID);t&&(t.texture=Ct.EMPTY,t.alpha=255)}getAddition(t){if(!this._additions)return null;const e=this._additions.get(t);return e||null}addAddition(t){if(!this.getAddition(t.id))return this._additions.set(t.id,t),t}removeAddition(t){const e=this.getAddition(t);e&&(this._additions.delete(e.id),e.dispose())}updateShadow(t){this._shadow=null;const e=this.getSprite(W.SHADOW_LAYER_ID);if(!e)return;let s=this._posture==="mv"||this._posture==="std"||this._posture==="sit"&&this._canStandUp;if(this._effect===W.SNOWBOARDING_EFFECT&&(s=!1),s){if(e.visible=!0,!this._shadow||t!==this._scale){let i=0,r=0;t<48?(e.libraryAssetName="sh_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),i=-8,r=this._canStandUp?6:-3):(e.libraryAssetName="h_std_sd_1_0_0",this._shadow=this._avatarImage.getAsset(e.libraryAssetName),i=-17,r=this._canStandUp?10:-7),this._shadow?(e.texture=this._shadow.texture,e.offsetX=i,e.offsetY=r,e.alpha=50,e.relativeDepth=1):e.visible=!1}}else this._shadow=null,e.visible=!1}getAvatarRenderAsset(t){return this._data?this._data.getAvatarRendererAsset(t):null}get direction(){return this._direction}get posture(){return this._posture}get angle(){return this._angle}get disposed(){return this._disposed}};yt.AVATAR="avatar";yt.FLOATING_IDLE_Z_ID=1;yt.TYPING_BUBBLE_ID=2;yt.EXPRESSION_ID=3;yt.NUMBER_BUBBLE_ID=4;yt.GAME_CLICK_TARGET_ID=5;yt.MUTED_BUBBLE_ID=6;yt.GUIDE_BUBBLE_ID=7;yt.OWN_USER_ID=4;yt.UPDATE_TIME_INCREASER=41;yt.AVATAR_LAYER_ID=0;yt.SHADOW_LAYER_ID=1;yt.SNOWBOARDING_EFFECT=97;yt.INITIAL_RESERVED_SPRITES=2;yt.ANIMATION_FRAME_UPDATE_INTERVAL=2;yt.DEFAULT_CANVAS_OFFSETS=[0,0,0];yt.MAX_EFFECT_CACHE=2;yt.SPRITE_INDEX_AVATAR=0;yt.BASE_Y_SCALE=1e3;yt.AVATAR_SPRITE_DEFAULT_DEPTH=-.01;yt.AVATAR_OWN_DEPTH_ADJUST=.001;yt.AVATAR_SPRITE_LAYING_DEPTH=-.409;let OH=yt;const Rn=class Es{static allocate(t,e,s,i,r,a,o=-1,_=0){const l=Es.POOL.length?Es.POOL.pop():new Es;return i<1&&(i=1),r<0&&(r=Es.FRAME_REPEAT_FOREVER),l._id=t,l._x=e||0,l._y=s||0,l._repeats=i,l._frameRepeats=r,l._remainingFrameRepeats=r,l._isLastFrame=a,l._isRecycled=!1,o>=0?(l._activeSequence=o,l._activeSequenceOffset=_):(l._activeSequence=-1,l._activeSequenceOffset=0),l}get id(){return this._id>=0?this._id:-this._id*Math.random()}get x(){return this._x}get y(){return this._y}get repeats(){return this._repeats}get frameRepeats(){return this._frameRepeats}get isLastFrame(){return this._isLastFrame}get remainingFrameRepeats(){return this._frameRepeats<0?Es.FRAME_REPEAT_FOREVER:this._remainingFrameRepeats}set remainingFrameRepeats(t){t<0&&(t=0),this._frameRepeats>0&&t>this._frameRepeats&&(t=this._frameRepeats),this._remainingFrameRepeats=t}get activeSequence(){return this._activeSequence}get activeSequenceOffset(){return this._activeSequenceOffset}recycle(){this._isRecycled||(this._isRecycled=!0,Es.POOL.length<Es.POOL_SIZE_LIMIT&&Es.POOL.push(this))}};Rn.FRAME_REPEAT_FOREVER=-1;Rn.SEQUENCE_NOT_DEFINED=-1;Rn.POOL_SIZE_LIMIT=3e3;Rn.POOL=[];let ir=Rn;class uf{constructor(t,e,s,i,r,a){this._id=0,this._x=0,this._y=0,this._randomX=0,this._randomY=0,this._repeats=1,this._id=t,this._x=e,this._y=s,this._randomX=i,this._randomY=r,this._repeats=a}get id(){return this._id}hasDirectionalOffsets(){return!1}getX(t){return this._x}getY(t){return this._y}get x(){return this._x}get y(){return this._x}get randomX(){return this._randomX}get randomY(){return this._randomY}get repeats(){return this._repeats}}class AH extends uf{constructor(t,e,s,i,r,a,o){super(t,e,s,i,r,o),this._directionalOffsets=a}hasDirectionalOffsets(){return this._directionalOffsets!==null}getX(t){return this._directionalOffsets?this._directionalOffsets.getXOffset(t,super.getX(t)):super.getX(t)}getY(t){return this._directionalOffsets?this._directionalOffsets.getYOffset(t,super.getY(t)):super.getY(t)}}class SH{constructor(t,e){this._frames=[],this._frameIndexes=[],this._frameRepeats=[],this._isRandom=e,this._loopCount=t<1?1:t}get isRandom(){return this._isRandom}get frameCount(){return this._frameIndexes.length*this._loopCount}dispose(){this._frames=[]}initialize(){let t=this._frameIndexes.length-1,e=-1,s=1;for(;t>=0;)this._frameIndexes[t]===e?s++:(e=this._frameIndexes[t],s=1),this._frameRepeats[t]=s,t--}addFrame(t,e,s,i,r,a){let o=1;if(this._frames.length>0){const l=this._frames[this._frames.length-1];l.id===t&&!l.hasDirectionalOffsets()&&l.x===e&&l.y===s&&l.randomX===i&&i===0&&l.randomY===r&&r===0&&(o+=l.repeats,this._frames.pop())}const _=a?new AH(t,e,s,i,r,a,o):new uf(t,e,s,i,r,o);this._frames.push(_),this._frameIndexes.push(this._frames.length-1),this._frameRepeats.push(1)}getFrame(t){return!this._frames.length||t<0||t>=this.frameCount?null:this._frames[this._frameIndexes[t%this._frameIndexes.length]]}getFrameIndex(t){return t<0||t>=this.frameCount?-1:(this._isRandom&&(t=Math.round(Math.random()*this._frameIndexes.length),t===this._frameIndexes.length&&t--),t)}getRepeats(t){return t<0||t>=this.frameCount?0:this._frameRepeats[t%this._frameRepeats.length]}}class MH{constructor(t,e,s){this._frameSequences=[],this._frameCount=-1,this._loopCount=t<0?0:t,this._frameRepeat=e<1?1:e,this._isRandom=s}get frameCount(){return this._frameCount<0&&this.calculateLength(),this._frameCount}dispose(){if(!(!this._frameSequences||!this._frameSequences.length)){for(const t of this._frameSequences)t&&t.dispose();this._frameSequences=[]}}addFrameSequence(t,e){const s=new SH(t,e);return this._frameSequences.push(s),s}calculateLength(){this._frameCount=0;for(const t of this._frameSequences)t&&(this._frameCount+=t.frameCount)}getFrame(t,e){if(this._frameCount<1)return null;if(e=e/this._frameRepeat,!this._isRandom){const r=Math.floor(e/this._frameCount);e=Math.floor(e%this._frameCount);let a=!1,o=null;(this._loopCount>0&&r>=this._loopCount||this._loopCount<=0&&this._frameCount===1)&&(e=this._frameCount-1,a=!0);let _=0,l=0;for(;l<this._frameSequences.length;){if(o=this._frameSequences[l],o){if(e<_+o.frameCount)break;_+=o.frameCount}l++}return this.getFrameFromSpecificSequence(t,o,l,e-_,a)}const s=Math.trunc(this._frameSequences.length*Math.random()),i=this._frameSequences[s];return i.frameCount<1?null:this.getFrameFromSpecificSequence(t,i,s,0,!1)}getFrameFromSequence(t,e,s,i){if(e<0||e>=this._frameSequences.length)return null;const r=this._frameSequences[e];return r?s>=r.frameCount?this.getFrame(t,i):this.getFrameFromSpecificSequence(t,r,e,s,!1):null}getFrameFromSpecificSequence(t,e,s,i,r){if(!e)return null;const a=e.getFrameIndex(i),o=e.getFrame(a);if(!o)return null;let _=o.getX(t),l=o.getY(t);const c=o.randomX,d=o.randomY;let E=o.repeats,I=!1;c&&(_=Math.trunc(_+c*Math.random())),d&&(l=Math.trunc(l+d*Math.random())),E>1&&(E=e.getRepeats(a));let m=this._frameRepeat*E;return r&&(m=ir.FRAME_REPEAT_FOREVER),!this._isRandom&&!e.isRandom&&s===this._frameSequences.length-1&&i===e.frameCount-1&&(I=!0),ir.allocate(o.id,_,l,E,m,I,s,i)}}class lf{constructor(){this._offsetX=new Map,this._offsetY=new Map}getXOffset(t,e){const s=this._offsetX.get(t);return s??e}getYOffset(t,e){const s=this._offsetY.get(t);return s??e}setDirection(t,e,s){this._offsetX.set(t,e),this._offsetY.set(t,s)}}const io=class Wi{constructor(){this._layers=new Map,this._frameCount=-1,this._randomStart=!1,this._immediateChanges=null}static getTransitionToAnimationId(t){return Wi.TRANSITION_TO_ANIMATION_OFFSET+t}static getTransitionFromAnimationId(t){return Wi.TRANSITION_FROM_ANIMATION_OFFSET+t}static isTransitionToAnimation(t){return t>=Wi.TRANSITION_TO_ANIMATION_OFFSET&&t<Wi.TRANSITION_FROM_ANIMATION_OFFSET}static isTransitionFromAnimation(t){return t>=Wi.TRANSITION_FROM_ANIMATION_OFFSET}dispose(){for(const t of this._layers.values())t&&t.dispose();this._layers.clear(),this._immediateChanges=null}setImmediateChanges(t){this._immediateChanges=t}isImmediateChange(t){return!(!this._immediateChanges||this._immediateChanges.indexOf(t)===-1)}getStartFrame(t){return this._randomStart?Math.random()*this._frameCount:0}initialize(t){if(t.randomStart&&(this._randomStart=!0),t.layers)for(const e in t.layers){const s=t.layers[e];if(!s)return!1;const i=parseInt(e),r=s.loopCount!==void 0?s.loopCount:1,a=s.frameRepeat!==void 0?s.frameRepeat:1,o=s.random!==void 0&&s.random!==0;if(!this.addLayer(i,r,a,o,s))return!1}return!0}addLayer(t,e,s,i,r){const a=new MH(e,s,i);if(r.frameSequences)for(const _ in r.frameSequences){const l=r.frameSequences[_];if(!l)continue;const c=l.loopCount!==void 0?l.loopCount:1,d=l.random!==void 0&&l.random!==0,E=a.addFrameSequence(c,d);if(l.frames)for(const I in l.frames){const m=l.frames[I];if(!m)return a.dispose(),!1;E.addFrame(m.id,m.x||0,m.y||0,m.randomX||0,m.randomY||0,this.readDirectionalOffsets(m))}E.initialize()}a.calculateLength(),this._layers.set(t,a);const o=a.frameCount;return o>this._frameCount&&(this._frameCount=o),!0}readDirectionalOffsets(t){let e=null;if(t&&t.offsets)for(const s in t.offsets){const i=t.offsets[s];i&&(e||(e=new lf),e.setDirection(i.direction,i.x,i.y))}return e}getFrame(t,e,s){const i=this._layers.get(e);return i?i.getFrame(t,s):null}getFrameFromSequence(t,e,s,i,r){const a=this._layers.get(e);return a?a.getFrameFromSequence(t,s,i,r):null}};io.TRANSITION_TO_ANIMATION_OFFSET=1e6;io.TRANSITION_FROM_ANIMATION_OFFSET=2e6;io.DEFAULT_FRAME_NUMBER=0;let kt=io;const cf=class K_{constructor(t){this._colors=[],this.createColors(t)}createColors(t){if(t)for(let e=0;e<t;e++)this._colors.push(K_.DEFAULT_COLOR)}dispose(){this._colors=[]}getLayerColor(t){const e=this._colors[t];return e||K_.DEFAULT_COLOR}setColorLayer(t,e){this._colors[t]&&(this._colors[t]=e)}};cf.DEFAULT_COLOR=16777215;let qr=cf;const _s=class zs{constructor(){this._tag=zs.DEFAULT_TAG,this._ink=zs.DEFAULT_INK,this._alpha=zs.DEFAULT_ALPHA,this._ignoreMouse=zs.DEFAULT_IGNORE_MOUSE,this._xOffset=zs.DEFAULT_XOFFSET,this._yOffset=zs.DEFAULT_YOFFSET,this._zOffset=zs.DEFAULT_ZOFFSET}setFromLayer(t){t&&(this._tag=t.tag,this._ink=t.ink,this._alpha=t.alpha,this._ignoreMouse=t.ignoreMouse,this._xOffset=t.xOffset,this._yOffset=t.yOffset,this._zOffset=t.zOffset)}get tag(){return this._tag}set tag(t){this._tag=t}get ink(){return this._ink}set ink(t){this._ink=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}get ignoreMouse(){return this._ignoreMouse}set ignoreMouse(t){this._ignoreMouse=t}get xOffset(){return this._xOffset}set xOffset(t){this._xOffset=t}get yOffset(){return this._yOffset}set yOffset(t){this._yOffset=t}get zOffset(){return this._zOffset}set zOffset(t){this._zOffset=t}};_s.DEFAULT_COUNT=0;_s.DEFAULT_DIRECTION=0;_s.DEFAULT_TAG="";_s.DEFAULT_INK=Cs.NORMAL;_s.DEFAULT_ALPHA=255;_s.DEFAULT_IGNORE_MOUSE=!1;_s.DEFAULT_XOFFSET=0;_s.DEFAULT_YOFFSET=0;_s.DEFAULT_ZOFFSET=0;let ft=_s;class Ri{constructor(t){this._layers=[],this.createLayers(t)}createLayers(t){if(t)for(let e=0;e<t;e++)this._layers.push(new ft)}dispose(){this._layers=[]}setFromDirection(t){if(!t)return;const e=this.layerCount;if(e===t.layerCount)for(let s=0;s<e;s++){const i=this.getLayer(s),r=t.getLayer(s);i&&i.setFromLayer(r)}}getLayer(t){const e=this._layers[t];return e||null}getLayerTag(t){const e=this.getLayer(t);return e?e.tag:ft.DEFAULT_TAG}setLayerTag(t,e){const s=this.getLayer(t);s&&(s.tag=e)}getLayerInk(t){const e=this.getLayer(t);return e?e.ink:ft.DEFAULT_INK}setLayerInk(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.ink=e))}getLayerAlpha(t){const e=this.getLayer(t);return e?e.alpha:ft.DEFAULT_ALPHA}setLayerAlpha(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.alpha=e))}getLayerIgnoreMouse(t){const e=this.getLayer(t);return e?e.ignoreMouse:ft.DEFAULT_IGNORE_MOUSE}setLayerIgnoreMouse(t,e){const s=this.getLayer(t);s&&(s.ignoreMouse=e||!1)}getLayerXOffset(t){const e=this.getLayer(t);return e?e.xOffset:ft.DEFAULT_XOFFSET}setLayerXOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.xOffset=e))}getLayerYOffset(t){const e=this.getLayer(t);return e?e.yOffset:ft.DEFAULT_YOFFSET}setLayerYOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.yOffset=e))}getLayerZOffset(t){const e=this.getLayer(t);return e?e.zOffset:ft.DEFAULT_ZOFFSET}setLayerZOffset(t,e){const s=this.getLayer(t);s&&(isNaN(e)||(s.zOffset=e))}get layerCount(){return this._layers.length}}Ri.USE_DEFAULT_DIRECTION=-1;const df=class X_{constructor(t,e){this._layerCount=t<0?0:t>X_.MAX_LAYERS?X_.MAX_LAYERS:t,this._angle=e<1?1:e>360?360:e,this._defaultDirection=new Ri(this._layerCount),this._directions=new Map,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1}dispose(){this._defaultDirection&&this._defaultDirection.dispose();for(const t of this._directions.values())t&&t.dispose();for(const t of this._colors)t&&t.dispose();this.reset()}reset(){this._defaultDirection=null,this._colors=[],this._lastDirectionData=null,this._lastDirection=-1,this._directions.clear()}processLayers(t){return t?this.setDirectionLayers(this._defaultDirection,t):!1}processDirections(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._directions.get(i))return!1;const r=new Ri(this._layerCount);r.setFromDirection(this._defaultDirection),this.setDirectionLayers(r,s.layers),this._directions.set(i,r),this._lastDirectionData=null,this._lastDirection=-1}return!0}processColors(t){if(!t)return!1;for(const e in t){const s=t[e];if(!s)continue;const i=parseInt(e);if(this._colors[i])return!1;const r=new qr(this._layerCount);for(const a in s.layers){const o=s.layers[a];if(!o)continue;const _=parseInt(a),l=o.color;r.setColorLayer(_,l)}this._colors[i]=r}return!0}setDirectionLayers(t,e){if(!t||!e)return!1;for(const s in e){const i=e[s];if(!i)continue;const r=parseInt(s);if(r<0||r>=this._layerCount)return!1;i.ink!==void 0&&t.setLayerInk(r,BI.inkToBlendMode(i.ink)),i.tag!==void 0&&t.setLayerTag(r,i.tag),i.alpha!==void 0&&t.setLayerAlpha(r,i.alpha),i.ignoreMouse!==void 0&&t.setLayerIgnoreMouse(r,i.ignoreMouse),i.x!==void 0&&t.setLayerXOffset(r,i.x),i.y!==void 0&&t.setLayerYOffset(r,i.y),i.z!==void 0&&t.setLayerZOffset(r,i.z/-1e3)}return!0}getValidDirection(t){if(this._directions.get(t))return t;t=(t%360+360)%360;let s=-1,i=-1;for(const r of this._directions.keys()){let a=(r*this._angle-t+360)%360;a>180&&(a=360-a),(a<s||s<0)&&(s=a,i=r)}return i>=0?Math.trunc(i):0}getDirectionData(t){if(t===this._lastDirection&&this._lastDirectionData)return this._lastDirectionData;let e=this._directions.get(t);return e||(e=this._defaultDirection),this._lastDirection=t,this._lastDirectionData=e,this._lastDirectionData}getLayerTag(t,e){const s=this.getDirectionData(t);return s?s.getLayerTag(e):ft.DEFAULT_TAG}getLayerInk(t,e){const s=this.getDirectionData(t);return s?s.getLayerInk(e):ft.DEFAULT_INK}getLayerAlpha(t,e){const s=this.getDirectionData(t);return s?s.getLayerAlpha(e):ft.DEFAULT_ALPHA}getLayerColor(t,e){const s=this._colors[e];return s?s.getLayerColor(t):qr.DEFAULT_COLOR}getLayerIgnoreMouse(t,e){const s=this.getDirectionData(t);return s?s.getLayerIgnoreMouse(e):ft.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerXOffset(e):ft.DEFAULT_XOFFSET}getLayerYOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerYOffset(e):ft.DEFAULT_YOFFSET}getLayerZOffset(t,e){const s=this.getDirectionData(t);return s?s.getLayerZOffset(e):ft.DEFAULT_ZOFFSET}get layerCount(){return this._layerCount}};df.MAX_LAYERS=26;let gf=df;class Ra extends gf{constructor(t,e){super(t,e),this._animations=new Map,this._animationIds=[]}dispose(){super.dispose();for(const t of this._animations.values())t&&t.dispose();this._animations.clear(),this._animationIds=[]}defineAnimations(t){if(!t)return!0;for(const e in t){const s=t[e];if(!s)return!1;let i=parseInt(e.split("_")[0]),r=!1;const a=s.transitionTo,o=s.transitionFrom;a!==void 0&&(i=kt.getTransitionToAnimationId(a),r=!0),o!==void 0&&(i=kt.getTransitionFromAnimationId(o),r=!0);const _=this.createAnimationData();if(!_.initialize(s))return _.dispose(),!1;const l=s.immediateChangeFrom;if(l!==void 0){const c=l.split(","),d=[];for(const E of c){const I=parseInt(E);d.indexOf(I)===-1&&d.push(I)}_.setImmediateChanges(d)}this._animations.set(i,_),r||this._animationIds.push(i)}return!0}createAnimationData(){return new kt}hasAnimation(t){return!!this._animations.get(t)}getAnimationCount(){return this._animationIds.length||0}getAnimationId(t){const e=this.getAnimationCount();return t<0||e<=0?0:this._animationIds[t%e]}isImmediateChange(t,e){const s=this._animations.get(t);return s?s.isImmediateChange(e):!1}getStartFrame(t,e){const s=this._animations.get(t);return s?s.getStartFrame(e):0}getFrame(t,e,s,i){const r=this._animations.get(t);return r?r.getFrame(e,s,i):null}getFrameFromSequence(t,e,s,i,r,a){const o=this._animations.get(t);return o?o.getFrameFromSequence(e,s,i,r,a):null}}class Ef{constructor(){this._animationId=-1,this._animationAfterTransitionId=0,this._animationOver=!1,this._frameCounter=0,this._frames=[],this._lastFramePlayed=[],this._animationPlayed=[],this._layerCount=0}get animationOver(){return this._animationOver}set animationOver(t){this._animationOver=t}get frameCounter(){return this._frameCounter}set frameCounter(t){this._frameCounter=t}get animationId(){return this._animationId}set animationId(t){t!==this._animationId&&(this._animationId=t,this.resetAnimationFrames(!1))}get animationAfterTransitionId(){return this._animationAfterTransitionId}set animationAfterTransitionId(t){this._animationAfterTransitionId=t}dispose(){this.recycleFrames(),this._frames=null,this._lastFramePlayed=null,this._animationPlayed=null}setLayerCount(t){this._layerCount=t,this.resetAnimationFrames()}resetAnimationFrames(t=!0){(t||!this._frames)&&(this.recycleFrames(),this._frames=[]),this._lastFramePlayed=[],this._animationPlayed=[],this._animationOver=!1,this._frameCounter=0;let e=0;for(;e<this._layerCount;){if(t||this._frames.length<=e)this._frames[e]=null;else{const s=this._frames[e];s&&(s.recycle(),this._frames[e]=ir.allocate(s.id,s.x,s.y,s.repeats,0,s.isLastFrame))}this._lastFramePlayed[e]=!1,this._animationPlayed[e]=!1,e++}}recycleFrames(){if(!(!this._frames||!this._frames.length))for(const t of this._frames)t&&t.recycle()}getFrame(t){return t<0||t>=this._layerCount?null:this._frames[t]}setFrame(t,e){if(t<0||t>=this._layerCount)return;const s=this._frames[t];s&&s.recycle(),this._frames[t]=e}getAnimationPlayed(t){return t<0||t>=this._layerCount?!0:this._animationPlayed[t]}setAnimationPlayed(t,e){t<0||t>=this._layerCount||(this._animationPlayed[t]=e)}getLastFramePlayed(t){return t<0||t>=this._layerCount?!0:this._lastFramePlayed[t]}setLastFramePlayed(t,e){t<0||t>=this._layerCount||(this._lastFramePlayed[t]=e)}}const ff=class mf extends Ra{constructor(t,e){super(t,e),this._posturesToAnimations=new Map,this._gesturesToAnimations=new Map,this._defaultPosture=null}processPostures(t){if(!t||(t.defaultPosture&&t.defaultPosture.length&&(this._defaultPosture=t.defaultPosture),!t.postures))return!1;for(const e of t.postures)this._posturesToAnimations.get(e.id)||(this._defaultPosture===null&&(this._defaultPosture=e.id),this._posturesToAnimations.set(e.id,e.animationId));return this._posturesToAnimations.get(this._defaultPosture)!==void 0}processGestures(t){if(!t)return!1;for(const e of t)this._gesturesToAnimations.get(e.id)||this._gesturesToAnimations.set(e.id,e.animationId);return!0}postureToAnimation(t){return this._posturesToAnimations.get(t)||(t=this._defaultPosture),this._posturesToAnimations.get(t)}getGestureDisabled(t){return t==="ded"}gestureToAnimation(t){return this._gesturesToAnimations.get(t)?this._gesturesToAnimations.get(t):mf.DEFAULT}animationToPosture(t,e){if(t>=0&&t<this._posturesToAnimations.size){const s=this._posturesToAnimations.keys();for(;;){const i=s.next();if(i.done)return null;if(t<=0)return i.value;--t}}return e?this._defaultPosture:null}animationToGesture(t){if(t>=0&&t<this._gesturesToAnimations.size){const e=this._gesturesToAnimations.keys();for(;;){const s=e.next();if(s.done)return null;if(t<=0)return s.value;--t}}return null}getGestureForAnimationId(t){for(const e of this._gesturesToAnimations.keys())if(this._gesturesToAnimations.get(e)===t)return e;return null}get totalPostures(){return this._posturesToAnimations.size}get totalGestures(){return this._gesturesToAnimations.size}};ff.DEFAULT=-1;let Sr=ff;class bs{constructor(){this._type="",this._sizes=[],this._sizeDatas=new Map,this._lastSize=-1,this._lastSizeScale=-1,this._lastSizeData=null,this._lastSizeDataScale=-1}initialize(t){return this.reset(),t?(this._type=t.name,this.defineVisualizations(t.visualizations)?!0:(this.reset(),!1)):!1}dispose(){if(this._sizeDatas&&this._sizeDatas.size){for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas=null}this._lastSizeData=null,this._sizes=null}reset(){if(this._type="",this._sizeDatas&&this._sizeDatas.size)for(const t of this._sizeDatas.values())t&&t.dispose();this._sizeDatas.clear(),this._sizes=[],this._lastSizeData=null,this._lastSizeDataScale=-1}createSizeData(t,e,s){return new gf(e,s)}defineVisualizations(t){if(!t)return!1;for(const e in t){const s=t[e],i=s.layerCount,r=s.angle;let a=s.size;if(a<1&&(a=1),this._sizeDatas.get(a))return!1;const o=this.createSizeData(a,i,r);if(!o)return!1;for(const _ in s){const l=s[_];if(!this.processVisualElement(o,_,l))return o.dispose(),!1}this._sizeDatas.set(a,o),this._sizes.push(a)}return this._sizes.sort(),!0}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"layers":if(!t.processLayers(s))return!1;break;case"directions":if(!t.processDirections(s))return!1;break;case"colors":if(!t.processColors(s))return!1;break}return!0}getValidSize(t){if(t===this._lastSizeScale)return this._lastSize;const e=this.getSizeIndex(t);let s=-1;return e<this._sizes.length&&(s=this._sizes[e]),this._lastSizeScale=t,this._lastSize=s,s}getSizeIndex(t){if(t<=0)return 0;let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]/t<t/this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getSizeData(t){if(t===this._lastSizeDataScale)return this._lastSizeData;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastSizeData=this._sizeDatas.get(this._sizes[e]):this._lastSizeData=null,this._lastSizeDataScale=t,this._lastSizeData}getLayerCount(t){const e=this.getSizeData(t);return e?e.layerCount:ft.DEFAULT_COUNT}getValidDirection(t,e){const s=this.getSizeData(t);return s?s.getValidDirection(e):ft.DEFAULT_DIRECTION}getLayerTag(t,e,s){const i=this.getSizeData(t);return i?i.getLayerTag(e,s):ft.DEFAULT_TAG}getLayerInk(t,e,s){const i=this.getSizeData(t);return i?i.getLayerInk(e,s):ft.DEFAULT_INK}getLayerAlpha(t,e,s){const i=this.getSizeData(t);return i?i.getLayerAlpha(e,s):ft.DEFAULT_ALPHA}getLayerColor(t,e,s){const i=this.getSizeData(t);return i?i.getLayerColor(e,s):qr.DEFAULT_COLOR}getLayerIgnoreMouse(t,e,s){const i=this.getSizeData(t);return i?i.getLayerIgnoreMouse(e,s):ft.DEFAULT_IGNORE_MOUSE}getLayerXOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerXOffset(e,s):ft.DEFAULT_XOFFSET}getLayerYOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerYOffset(e,s):ft.DEFAULT_YOFFSET}getLayerZOffset(t,e,s){const i=this.getSizeData(t);return i?i.getLayerZOffset(e,s):ft.DEFAULT_ZOFFSET}get type(){return this._type}}bs.LAYER_LETTERS=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"];class zh extends bs{createSizeData(t,e,s){return new Ra(e,s)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"animations":if(!(t instanceof Ra)||!t.defineAnimations(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1;break}return!0}hasAnimation(t,e){const s=this.getSizeData(t);return s?s.hasAnimation(e):null}getAnimationCount(t){const e=this.getSizeData(t);return e?e.getAnimationCount():null}getAnimationId(t,e){const s=this.getSizeData(t);return s?s.getAnimationId(e):null}isImmediateChange(t,e,s){const i=this.getSizeData(t);return i?i.isImmediateChange(e,s):null}getStartFrame(t,e,s){const i=this.getSizeData(t);return i?i.getStartFrame(e,s):null}getFrame(t,e,s,i,r){const a=this.getSizeData(t);return a?a.getFrame(e,s,i,r):null}getFrameFromSequence(t,e,s,i,r,a,o){const _=this.getSizeData(t);return _?_.getFrameFromSequence(e,s,i,r,a,o):null}}const Yh=class If extends ba{constructor(){super(),this._data=null,this._type=null,this._direction=0,this._lastCameraAngle=NaN,this._selectedColor=0,this._furnitureLift=0,this._alphaMultiplier=1,this._alphaChanged=!1,this._clickUrl=null,this._clickHandling=!1,this._cacheDirection=-1,this._cacheScale=0,this._cacheSize=-1,this._layerCount=0,this._shadowLayerIndex=-1,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._animationNumber=0}initialize(t){return this.reset(),t instanceof bs?(this._type=t.type,this._data=t,!0):!1}dispose(){super.dispose(),this._data=null,this._updatedLayers=null,this._assetNames=null,this._spriteTags=null,this._spriteInks=null,this._spriteAlphas=null,this._spriteColors=null,this._spriteMouseCaptures=null,this._spriteXOffsets=null,this._spriteYOffsets=null,this._spriteZOffsets=null}reset(){super.reset(),this.setDirection(-1),this._data=null,this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this.createSprites(0)}resetLayers(t,e){this._cacheDirection===e&&this._cacheScale===t||(this._updatedLayers=[],this._assetNames=[],this._spriteTags=[],this._spriteInks=[],this._spriteAlphas=[],this._spriteColors=[],this._spriteMouseCaptures=[],this._spriteXOffsets=[],this._spriteYOffsets=[],this._spriteZOffsets=[],this._cacheDirection=e,this._cacheScale=t,this._cacheSize=this.getValidSize(t),this.setLayerCount((this._data&&this._data.getLayerCount(t)||0)+this.getAdditionalLayerCount()))}update(t,e,s,i){if(!t)return;const r=t.scale;let a=!1;this.updateObject(r,t.direction.x)&&(a=!0),this.updateModel(r)&&(a=!0);let o=0;i?this._animationNumber=this._animationNumber|this.updateAnimation(r):(o=this.updateAnimation(r)|this._animationNumber,this._animationNumber=0),(a||o!==0)&&(this.updateSprites(r,a,o),this._scale=r,this.updateSpriteCounter++)}updateObject(t,e){if(!this.object||this.updateObjectCounter===this.object.updateCounter&&t===this._scale&&this._lastCameraAngle===e)return!1;let s=this.object.getDirection().x-(e+135);if(s=(s%360+360)%360,this._data){const i=this._data.getValidDirection(t,s);this.setDirection(i)}return this._lastCameraAngle=e,this._scale=t,this.updateObjectCounter=this.object.updateCounter,this.resetLayers(t,this._direction),!0}updateModel(t){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;this._selectedColor=e.getValue(g.FURNITURE_COLOR),this._clickUrl=e.getValue(g.FURNITURE_AD_URL),this._clickHandling=this._clickUrl&&this._clickUrl!==""&&this._clickUrl.indexOf("http")===0||!1,this._furnitureLift=e.getValue(g.FURNITURE_LIFT_AMOUNT)||0;let s=e.getValue(g.FURNITURE_ALPHA_MULTIPLIER);return isNaN(s)&&(s=1),this._alphaMultiplier!==s&&(this._alphaMultiplier=s,this._alphaChanged=!0),this.updateModelCounter=e.updateCounter,!0}updateSprites(t,e,s){if(this._layerCount!==this.totalSprites&&this.createSprites(this._layerCount),e){let i=this.totalSprites-1;for(;i>=0;)this.updateSprite(t,i),i--}else{let i=0;for(;s>0;)s&&this.updateSprite(t,i),i++,s=s>>1}this._alphaChanged=!1}updateSprite(t,e){const s=this.getSpriteAssetName(t,e),i=this.getSprite(e);if(s&&i){const r=this.getAsset(s,e);if(r&&r.texture){i.visible=!0,i.type=this._type,i.texture=r.texture,i.flipH=r.flipH,i.flipV=r.flipV,i.direction=this._direction;let a=0;e!==this._shadowLayerIndex?(i.tag=this.getLayerTag(t,this._direction,e),i.alpha=this.getLayerAlpha(t,this._direction,e),i.color=this.getLayerColor(t,e,this._selectedColor),i.offsetX=r.offsetX+this.getLayerXOffset(t,this._direction,e),i.offsetY=r.offsetY+this.getLayerYOffset(t,this._direction,e),i.blendMode=this.getLayerInk(t,this._direction,e),i.alphaTolerance=this.getLayerIgnoreMouse(t,this._direction,e)?Ne.MATCH_NOTHING:Ne.MATCH_OPAQUE_PIXELS,a=this.getLayerZOffset(t,this._direction,e),a=a-e*.001):(i.offsetX=r.offsetX,i.offsetY=r.offsetY+this.getLayerYOffset(t,this._direction,e),i.alpha=48*this._alphaMultiplier,i.alphaTolerance=Ne.MATCH_NOTHING,a=1),i.relativeDepth=a*If.DEPTH_MULTIPLIER,i.name=s,i.libraryAssetName=this.getLibraryAssetNameForSprite(r,i),i.posture=this.getPostureForAsset(t,r.source),i.clickHandling=this._clickHandling}else this.resetSprite(i)}else i&&this.resetSprite(i)}getLibraryAssetNameForSprite(t,e){return t.source}getPostureForAssetFile(t,e){return null}resetSprite(t){t&&(t.texture=null,t.libraryAssetName="",t.posture="",t.tag="",t.offsetX=0,t.offsetY=0,t.flipH=!1,t.flipV=!1,t.relativeDepth=0,t.clickHandling=!1)}getSpriteAssetName(t,e){if(!this._data||e>=bs.LAYER_LETTERS.length)return"";let s=this._assetNames[e],i=this._updatedLayers[e];return(!s||!s.length)&&(s=this.cacheSpriteAssetName(t,e,!0),i=this._cacheSize!==1),i&&(s+=this.getFrameNumber(t,e)),s}cacheSpriteAssetName(t,e,s){this._type;const i=s?this._cacheSize:this.getValidSize(t);let r="";const a=i!==1;if(e!==this._shadowLayerIndex?r=bs.LAYER_LETTERS[e]||"":r="sd",r==="")return null;const o=this._type+(a?"_"+i+"_"+r+"_"+this._direction+"_":"_icon_"+r);return s&&(this._assetNames[e]=o,this._updatedLayers[e]=a),o}getLayerTag(t,e,s){const i=this._spriteTags[s];if(i!==void 0)return i;if(!this._data)return ft.DEFAULT_TAG;const r=this._data.getLayerTag(t,e,s);return this._spriteTags[s]=r,r}getLayerInk(t,e,s){const i=this._spriteInks[s];if(i!==void 0)return i;if(!this._data)return ft.DEFAULT_INK;const r=this._data.getLayerInk(t,e,s);return this._spriteInks[s]=r,r}getLayerAlpha(t,e,s){if(!this._alphaChanged){const r=this._spriteAlphas[s];if(r!==void 0)return r}if(!this._data)return ft.DEFAULT_ALPHA;let i=this._data.getLayerAlpha(t,e,s);return this._alphaMultiplier!==null&&(i=i*this._alphaMultiplier),this._spriteAlphas[s]=i,i}getLayerColor(t,e,s){const i=this._spriteColors[e];if(i!==void 0)return i;if(!this._data)return qr.DEFAULT_COLOR;const r=this._data.getLayerColor(t,e,s);return this._spriteColors[e]=r,r}getLayerIgnoreMouse(t,e,s){const i=this._spriteMouseCaptures[s];if(i!==void 0)return i;if(!this._data)return ft.DEFAULT_IGNORE_MOUSE;const r=this._data.getLayerIgnoreMouse(t,e,s);return this._spriteMouseCaptures[s]=r,r}getLayerXOffset(t,e,s){const i=this._spriteXOffsets[s];if(i!==void 0)return i;if(!this._data)return ft.DEFAULT_XOFFSET;const r=this._data.getLayerXOffset(t,e,s);return this._spriteXOffsets[s]=r,r}getLayerYOffset(t,e,s){if(s===this._shadowLayerIndex)return Math.ceil(this._furnitureLift*(t/2));const i=this._spriteYOffsets[s];if(i!==void 0)return i;if(!this._data)return ft.DEFAULT_YOFFSET;const r=this._data.getLayerYOffset(t,e,s);return this._spriteYOffsets[s]=r,r}getLayerZOffset(t,e,s){const i=this._spriteZOffsets[s];if(i!==void 0)return i;if(!this._data)return ft.DEFAULT_ZOFFSET;const r=this._data.getLayerZOffset(t,e,s);return this._spriteZOffsets[s]=r,r}getValidSize(t){return this._data?this._data.getValidSize(t):t}setLayerCount(t){this._layerCount=t,this._shadowLayerIndex=t-this.getAdditionalLayerCount()}setDirection(t){this._direction!==t&&(this._direction=t)}getAdditionalLayerCount(){return 1}updateAnimation(t){return 0}getFrameNumber(t,e){return 0}getPostureForAsset(t,e){return null}getAsset(t,e=-1){return this.asset?this.asset.getAsset(t):null}get direction(){return this._direction}get data(){return this._data}};Yh.DEPTH_MULTIPLIER=Math.sqrt(.5);Yh.TYPE=P.FURNITURE_STATIC;let bi=Yh;const Wh=class q_ extends bi{constructor(){super(),this._state=-1,this._frameIncrease=1,this._animationData=new Ef,this._animationScale=0,this._animationChangeTime=0,this._animatedLayerCount=0,this._directionChanged=!1}initialize(t){return t instanceof zh?super.initialize(t):!1}dispose(){super.dispose(),this._animationData&&(this._animationData.dispose(),this._animationData=null)}get animatedLayerCount(){return this._animatedLayerCount}get animationId(){return this._animationData.animationId}getAnimationId(t){return this.animationId!==q_.DEFAULT_ANIMATION_ID&&this.data.hasAnimation(this._animationScale,this.animationId)?this.animationId:q_.DEFAULT_ANIMATION_ID}updateObject(t,e){if(super.updateObject(t,e)){const s=this.object.getState(0);return s!==this._state&&(this.setAnimation(s),this._state=s,this._animationChangeTime=this.object.model.getValue(g.FURNITURE_STATE_UPDATE_TIME)||0),!0}return!1}updateModel(t){if(super.updateModel(t)){if(this.usesAnimationResetting()){const s=this.object.model.getValue(g.FURNITURE_STATE_UPDATE_TIME);s>this._animationChangeTime&&(this._animationChangeTime=s,this.setAnimation(this._state))}const e=this.object.model.getValue(g.FURNITURE_AUTOMATIC_STATE_INDEX);if(!isNaN(e)){const s=this.data.getAnimationId(this._animationScale,e);this.setAnimation(s)}return!0}return!1}isPlayingTransition(t,e){return!(!kt.isTransitionFromAnimation(t.animationId)&&!kt.isTransitionToAnimation(t.animationId)||e!==t.animationAfterTransitionId||t.animationOver)}getCurrentState(t){const e=t.animationId;return!kt.isTransitionFromAnimation(e)&&!kt.isTransitionToAnimation(e)?e:t.animationAfterTransitionId}setAnimation(t){this.data&&this.setSubAnimation(this._animationData,t,this._state>=0)}setSubAnimation(t,e,s=!0){const i=t.animationId;if(s){if(this.isPlayingTransition(t,e))return!1;const r=this.getCurrentState(t);if(e!==r){if(!this.data.isImmediateChange(this._animationScale,e,r)){let a=kt.getTransitionFromAnimationId(r);this.data.hasAnimation(this._animationScale,a)?(t.animationAfterTransitionId=e,e=a):(a=kt.getTransitionToAnimationId(e),this.data.hasAnimation(this._animationScale,a)&&(t.animationAfterTransitionId=e,e=a))}}else if(kt.isTransitionFromAnimation(t.animationId)){const a=kt.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,a)&&(t.animationAfterTransitionId=e,e=a)}else if(!kt.isTransitionToAnimation(t.animationId)&&this.usesAnimationResetting()){const a=kt.getTransitionFromAnimationId(r);if(this.data.hasAnimation(this._animationScale,a))t.animationAfterTransitionId=e,e=a;else{const o=kt.getTransitionToAnimationId(e);this.data.hasAnimation(this._animationScale,o)&&(t.animationAfterTransitionId=e,e=o)}}}return i!==e?(t.animationId=e,!0):!1}getLastFramePlayed(t){return this._animationData.getLastFramePlayed(t)}resetAllAnimationFrames(){this._animationData&&this._animationData.setLayerCount(this._animatedLayerCount)}updateAnimation(t){if(!this.data)return 0;t!==this._animationScale&&(this._animationScale=t,this._animatedLayerCount=this.data.getLayerCount(t),this.resetAllAnimationFrames());const e=this.updateAnimations(t);return this._directionChanged=!1,e}updateAnimations(t){if(this._animationData.animationOver&&!this._directionChanged)return 0;const e=this.updateFramesForAnimation(this._animationData,t);return this._animationData.animationOver&&(kt.isTransitionFromAnimation(this._animationData.animationId)||kt.isTransitionToAnimation(this._animationData.animationId))&&(this.setAnimation(this._animationData.animationAfterTransitionId),this._animationData.animationOver=!1),e}updateFramesForAnimation(t,e){if(t.animationOver&&!this._directionChanged)return 0;const s=this.getAnimationId(t);let i=t.frameCounter;i||(i=this.data.getStartFrame(e,s,this._direction)),i+=this.frameIncrease,t.frameCounter=i,t.animationOver=!0;let r=!1,a=this._animatedLayerCount-1,o=0,_=1<<this._animatedLayerCount-1;for(;a>=0;){let l=0;if(r=t.getAnimationPlayed(a),!r||this._directionChanged){let c=t.getLastFramePlayed(a),d=t.getFrame(a);d&&d.isLastFrame&&d.remainingFrameRepeats<=this.frameIncrease&&(c=!0),(this._directionChanged||!d||d.remainingFrameRepeats>=0&&(d.remainingFrameRepeats=d.remainingFrameRepeats-this.frameIncrease)<=0)&&(l=ir.SEQUENCE_NOT_DEFINED,d&&(l=d.activeSequence),l===ir.SEQUENCE_NOT_DEFINED?d=this.data.getFrame(e,s,this._direction,a,i):d=this.data.getFrameFromSequence(e,s,this._direction,a,l,d.activeSequenceOffset+d.repeats,i),t.setFrame(a,d),o=o|_),!d||d.remainingFrameRepeats==ir.FRAME_REPEAT_FOREVER?(c=!0,r=!0):t.animationOver=!1,t.setLastFramePlayed(a,c),t.setAnimationPlayed(a,r)}_=_>>1,a--}return o}getFrameNumber(t,e){const s=this._animationData.getFrame(e);return s?s.id:super.getFrameNumber(t,e)}getLayerXOffset(t,e,s){const i=super.getLayerXOffset(t,e,s),r=this._animationData.getFrame(s);return r?i+r.x:i}getLayerYOffset(t,e,s){const i=super.getLayerYOffset(t,e,s),r=this._animationData.getFrame(s);return r?i+r.y:i}usesAnimationResetting(){return!1}setDirection(t){this._direction!==t&&(super.setDirection(t),this._directionChanged=!0)}get frameIncrease(){return this._frameIncrease}get data(){return this._data}};Wh.TYPE=P.FURNITURE_ANIMATED;Wh.DEFAULT_ANIMATION_ID=0;let xt=Wh;const Rf=class Kn extends xt{constructor(){super(),this._badgeId="",this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="",this._badgeVisibleInState=-1}updateModel(t){let e=super.updateModel(t);const s=this.object.model.getValue(g.FURNITURE_BADGE_IMAGE_STATUS),i=this.object.model.getValue(g.FURNITURE_BADGE_ASSET_NAME);if(s===-1)this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale="";else if(s===1&&i!==this._badgeId){this._badgeId=i,this._badgeAssetNameNormalScale=this._badgeId,this._badgeAssetNameSmallScale===""&&(this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32");const r=this.object.model.getValue(g.FURNITURE_BADGE_VISIBLE_IN_STATE);isNaN(r)||(this._badgeVisibleInState=r),e=!0}return e}getSpriteAssetName(t,e){return this.getLayerTag(t,this.direction,e)!==Kn.BADGE||this._badgeVisibleInState!==-1&&this.object.getState(0)!==this._badgeVisibleInState?super.getSpriteAssetName(t,e):t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s);if(this.getLayerTag(t,e,s)===Kn.BADGE){const r=this.getAsset(t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);r&&(t===64?i+=(40-r.width)/2:i+=(20-r.width)/2)}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s);if(this.getLayerTag(t,e,s)===Kn.BADGE){const r=this.getAsset(t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale,s);r&&(t===64?i+=(40-r.height)/2:i+=(20-r.height)/2)}return i}};Rf.BADGE="BADGE";let CH=Rf;const fr=class gi extends bi{constructor(){super(),this._imageUrl=null,this._shortUrl=null,this._imageReady=!1,this._isAnimated=!1,this._gifCollection=null,this._offsetX=0,this._offsetY=0,this._offsetZ=0,this._currentFrame=-1,this._totalFrames=-1}dispose(){super.dispose(),this._imageUrl&&this.asset&&this.asset.disposeAsset(this._imageUrl)}updateObject(t,e){return super.updateObject(t,e)?(this._imageReady&&this.checkAndCreateImageForCurrentState(),!0):!1}updateModel(t){const e=super.updateModel(t);if(e&&(this._offsetX=this.object.model.getValue(g.FURNITURE_BRANDING_OFFSET_X)||0,this._offsetY=this.object.model.getValue(g.FURNITURE_BRANDING_OFFSET_Y)||0,this._offsetZ=this.object.model.getValue(g.FURNITURE_BRANDING_OFFSET_Z)||0,this._isAnimated=this.object.model.getValue(g.FURNITURE_BRANDING_IS_ANIMATED)||!1),this._imageReady){if(this.checkIfImageChanged())return this._imageReady=!1,this._imageUrl=null,!0}else if(this._imageReady=this.checkIfImageReady(),this._imageReady)return this.checkAndCreateImageForCurrentState(),!0;return e}checkIfImageChanged(){const t=this.object.model.getValue(g.FURNITURE_BRANDING_IMAGE_URL);return t&&t===this._imageUrl?!1:(this._gifCollection,this.asset&&this.asset.disposeAsset(this._imageUrl),!0)}checkIfImageReady(){if(!(this.object&&this.object.model))return!1;const e=this.object.model.getValue(g.FURNITURE_BRANDING_IMAGE_URL);if(!e||this._imageUrl&&this._imageUrl===e)return!1;if(this.object.model.getValue(g.FURNITURE_BRANDING_IMAGE_STATUS)===1){let i=null;if(this._isAnimated){const r=H.instance.roomEngine.roomContentLoader.getGifCollection(e);r&&(this._gifCollection=r,i=r.textures[0])}else i=Me().getTexture(e);return i?(this.imageReady(i,e),!0):!1}return!1}imageReady(t,e){if(!t){this._imageUrl=null;return}this._imageUrl=e}checkAndCreateImageForCurrentState(){if(this._isAnimated){this.buildAssetsForGif();return}if(!this._imageUrl)return;const t=Me().getTexture(this._imageUrl);if(!t)return;const e=this.object.getState(0);this.addBackgroundAsset(t,e,0)}buildAssetsForGif(){if(!this._gifCollection)return;const t=this._gifCollection.textures,e=this._gifCollection.durations;if(!t.length||!e.length||t.length!==e.length)return;const s=this.object.getState(0);for(let i=0;i<t.length;i++){const r=t[i];e[i],r&&this.addBackgroundAsset(r,s,i)}this._currentFrame=-1,this._totalFrames=t.length}addBackgroundAsset(t,e,s){let i=0,r=0,a=!1,o=!1;switch(e){case gi.STATE_0:i=0,r=0,a=!1,o=!1;break;case gi.STATE_1:i=-t.width,r=0,a=!0,o=!1;break;case gi.STATE_2:i=-t.width,r=-t.height,a=!0,o=!0;break;case gi.STATE_3:i=0,r=-t.height,a=!1,o=!0;break}this.asset.addAsset(`${this._imageUrl}_${s}`,t,!0,i,r,a,o)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===gi.BRANDED_IMAGE&&this._imageUrl?`${this._imageUrl}_${this.getFrameNumber(t,e)}`:super.getSpriteAssetName(t,e)}updateAnimation(t){return!this._imageReady||!this._isAnimated||this._totalFrames<=0?0:1}getFrameNumber(t,e){if(!this._imageReady||!this._isAnimated||this._totalFrames<=0)return 0;if(this.getLayerTag(t,this._direction,e)===gi.BRANDED_IMAGE&&this._imageUrl){let i=this._currentFrame;return i<0?i=0:i+=1,i===this._totalFrames&&(i=0),this._currentFrame=i,this._currentFrame}return 0}};fr.BRANDED_IMAGE="branded_image";fr.STATE_0=0;fr.STATE_1=1;fr.STATE_2=2;fr.STATE_3=3;let kh=fr;class Tf extends kh{getLayerXOffset(t,e,s){return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+this._offsetZ}}const ro=class Xn extends xt{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(t){if(t===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Xn.ANIMATION_ID_ROLL);return}if(t>=0&&t<=7){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(Xn.ANIMATION_ID_OFFSET_SLOW1),this._stateQueue.push(Xn.ANIMATION_ID_OFFSET_SLOW2+t),this._stateQueue.push(t);return}super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(0)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};ro.ANIMATION_ID_OFFSET_SLOW1=20;ro.ANIMATION_ID_OFFSET_SLOW2=9;ro.ANIMATION_ID_ROLL=-1;let NH=ro;class DH extends bi{}const Tn=class xr extends xt{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),i=this.object.getState(0);switch(s){case xr.SECONDS_SPRITE:return Math.floor(i%60%10);case xr.TEN_SECONDS_SPRITE:return Math.floor(i%60/10);case xr.MINUTES_SPRITE:return Math.floor(i/60%10);case xr.TEN_MINUTES_SPRITE:return Math.floor(i/60/10%10);default:return super.getFrameNumber(t,e)}}get animationId(){return 0}};Tn.SECONDS_SPRITE="seconds_sprite";Tn.TEN_SECONDS_SPRITE="ten_seconds_sprite";Tn.MINUTES_SPRITE="minutes_sprite";Tn.TEN_MINUTES_SPRITE="ten_minutes_sprite";let PH=Tn;class yH extends ba{}const pf=class Q_ extends xt{constructor(){super(),this._thumbnailAssetNameNormal=null,this._thumbnailImageNormal=null,this._thumbnailDirection=-1,this._thumbnailChanged=!1,this._hasOutline=!1}get hasThumbnailImage(){return this._thumbnailImageNormal!=null}setThumbnailImages(t){this._thumbnailImageNormal=t,this._thumbnailChanged=!0}updateModel(t){const e=super.updateModel(t);return!this._thumbnailChanged&&this._thumbnailDirection===this.direction?e:(this.refreshThumbnail(),!0)}refreshThumbnail(){this.asset!=null&&(this._thumbnailImageNormal?this.addThumbnailAsset(this._thumbnailImageNormal,64):this.asset.disposeAsset(this.getThumbnailAssetName(64)),this._thumbnailChanged=!1,this._thumbnailDirection=this.direction)}addThumbnailAsset(t,e){let s=0;for(;s<this.totalSprites;){if(this.getLayerTag(e,this.direction,s)===Q_.THUMBNAIL){const i=this.cacheSpriteAssetName(e,s,!1)+this.getFrameNumber(e,s),r=this.getAsset(i,s);if(r){const a=this.generateTransformedThumbnail(t,r),o=this.getThumbnailAssetName(e);this.asset.disposeAsset(o),this.asset.addAsset(o,a,!0,r.offsetX,r.offsetY,!1,!1)}return}s++}}generateTransformedThumbnail(t,e){if(this._hasOutline){const o=new Nt,_=new Nt(ku.WHITE);_.tint=0,_.width=t.width+40,_.height=t.height+40;const l=new Nt(t),c=(_.width-l.width)/2,d=(_.height-l.height)/2;l.position.set(c,d),o.addChild(_,l),t=At.generateTexture(o)}const s=1.1,i=new ue,r=e.width/t.width;switch(this.direction){case 2:i.a=r,i.b=-.5*r,i.c=0,i.d=r*s,i.tx=0,i.ty=.5*r*t.width;break;case 0:case 4:i.a=r,i.b=.5*r,i.c=0,i.d=r*s,i.tx=0,i.ty=0;break;default:i.a=r,i.b=0,i.c=0,i.d=r,i.tx=0,i.ty=0}const a=new Nt(t);return a.transform.setFromMatrix(i),At.generateTexture(a)}getSpriteAssetName(t,e){return this._thumbnailImageNormal&&this.getLayerTag(t,this.direction,e)===Q_.THUMBNAIL?this.getThumbnailAssetName(t):super.getSpriteAssetName(t,e)}getThumbnailAssetName(t){return this._thumbnailAssetNameNormal=this.getFullThumbnailAssetName(this.object.id,64),this._thumbnailAssetNameNormal}getFullThumbnailAssetName(t,e){return[this._type,t,"thumb",e].join("_")}};pf.THUMBNAIL="THUMBNAIL";let Of=pf;class Af extends Of{constructor(){super(),this._cachedUrl=null,this._hasOutline=!0}updateModel(t){if(this.object){const e=this.getThumbnailURL();if(this._cachedUrl!==e)if(this._cachedUrl=e,this._cachedUrl&&this._cachedUrl!==""){const s=new Image;s.src=e,s.crossOrigin="*",s.onload=()=>{const i=Ct.from(s);i.baseTexture.scaleMode=Uo.LINEAR,this.setThumbnailImages(i)}}else this.setThumbnailImages(null)}return super.updateModel(t)}getThumbnailURL(){throw new Error("This method must be overridden!")}}class LH extends Af{constructor(){super(),this._url=null,this._typePrefix=null}getThumbnailURL(){if(!this.object)return null;if(this._url)return this._url;const t=this.object.model.getValue(g.FURNITURE_DATA);if(!t||t==="")return null;this.object.type.indexOf("")>=0&&(this._typePrefix=this.object.type.indexOf("")>=0?"":"postcards/selfie/");let s=JSON.parse(t).w||"";return s=this.buildThumbnailUrl(s),this._url=s,this._url}buildThumbnailUrl(t){return t=t.replace(".png","_small.png"),t.indexOf(".png")===-1&&(t=t+"_small.png"),t}}class yu{constructor(){this._hasMoved=!1,this._age=0,this._isEmitter=!1,this._fade=!1,this._alphaMultiplier=1}init(t,e,s,i,r,a,o,_=!1,l=null,c=!1){this._x=t,this._y=e,this._z=s,this._particleDirection=new Te(i.x,i.y,i.z),this._particleDirection.scaleBy(r),this._lastX=this._x-this._particleDirection.x*a,this._lastY=this._y-this._particleDirection.y*a,this._lastZ=this._z-this._particleDirection.z*a,this._age=0,this._hasMoved=!1,this._lifeTime=o,this._isEmitter=_,this._frames=l,this._fade=c,this._alphaMultiplier=1,this._fadeTime=.5+Math.random()*.5}dispose(){this._particleDirection=null}update(){this._age++,this._age===this._lifeTime&&this.ignite(),this._fade&&this._age/this._lifeTime>this._fadeTime&&(this._alphaMultiplier=(this._lifeTime-this._age)/(this._lifeTime*(1-this._fadeTime)))}getAsset(){return this._frames&&this._frames.length>0?this._frames[this._age%this._frames.length]:null}ignite(){}get fade(){return this._fade}get alphaMultiplier(){return this._alphaMultiplier}get direction(){return this._particleDirection}get age(){return this._age}get isEmitter(){return this._isEmitter}get isAlive(){return this._age<=this._lifeTime}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}get lastX(){return this._lastX}set lastX(t){this._hasMoved=!0,this._lastX=t}get lastY(){return this._lastY}set lastY(t){this._hasMoved=!0,this._lastY=t}get lastZ(){return this._lastZ}set lastZ(t){this._hasMoved=!0,this._lastZ=t}get hasMoved(){return this._hasMoved}toString(){return[this._x,this._y,this._z].toString()}copy(t,e){this._x=t._x*e,this._y=t._y*e,this._z=t._z*e,this._lastX=t._lastX*e,this._lastY=t._lastY*e,this._lastZ=t._lastZ*e,this._hasMoved=t.hasMoved,this._particleDirection=t._particleDirection,this._age=t._age,this._lifeTime=t._lifeTime,this._isEmitter=t._isEmitter,this._fade=t._fade,this._fadeTime=t._fadeTime,this._alphaMultiplier=t._alphaMultiplier}}const no=class qn extends yu{constructor(t="",e=-1){super(),this._roomObjectSpriteId=-1,this._timeStep=.1,this._fuseTime=10,this._energy=1,this._hasIgnited=!1,this._burstPulse=1,this._particles=[],this._name=t,this._roomObjectSpriteId=e,this._particleConfigurations=[]}dispose(){for(const t of this._particles)t.dispose();this._particles=null,this._particleConfigurations=null,super.dispose()}setup(t,e,s,i,r,a,o,_,l,c){this._maxNumberOfParticles=t,this._particlesPerFrame=e,this._force=s,this._emitterDirection=i,this._emitterDirection.normalize(),this._gravity=r,this._airFriction=a,this._explosionShape=o,this._fuseTime=l,this._energy=_,this._burstPulse=c,this.reset()}reset(){for(const t of this._particles)t.dispose();this._particles=[],this._emittedParticles=0,this._hasIgnited=!1,this.init(0,0,0,this._emitterDirection,this._force,this._timeStep,this._fuseTime,!0)}copyStateFrom(t,e){super.copy(t,e),this._force=t._force,this._emitterDirection=t._emitterDirection,this._gravity=t._gravity,this._airFriction=t._airFriction,this._explosionShape=t._explosionShape,this._fuseTime=t._fuseTime,this._energy=t._energy,this._burstPulse=t._burstPulse,this._timeStep=t._timeStep,this._hasIgnited=t._hasIgnited}configureParticle(t,e,s,i){const r={};r.lifeTime=t,r.isEmitter=e,r.frames=s,r.fade=i,this._particleConfigurations.push(r)}ignite(){this._hasIgnited=!0,this._emittedParticles<this._maxNumberOfParticles&&this.age>1&&this.releaseParticles(this,this.direction)}releaseParticles(t,e=null){e||(e=new Te);const s=new Te,i=this.getRandomParticleConfiguration();let r=0;for(;r<this._particlesPerFrame;){switch(this._explosionShape){case qn.CONE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=-(Math.random()+1),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case qn.PLANE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=0,s.z=this.randomBoolean(.5)?Math.random():-Math.random();break;case qn.SPHERE:s.x=this.randomBoolean(.5)?Math.random():-Math.random(),s.y=this.randomBoolean(.5)?Math.random():-Math.random(),s.z=this.randomBoolean(.5)?Math.random():-Math.random();break}s.normalize();const a=new yu;let o=0,_=!1,l=!1,c=[];i?(o=Math.floor(Math.random()*i.lifeTime+10),_=i.isEmitter,c=i.frames,l=i.fade):(o=Math.trunc(Math.floor(Math.random()*20+10)),_=!1,c=[]),a.init(t.x,t.y,t.z,s,this._energy,this._timeStep,o,_,c,l),this._particles.push(a),this._emittedParticles++,r++}}getRandomParticleConfiguration(){const t=Math.trunc(Math.floor(Math.random()*this._particleConfigurations.length));return this._particleConfigurations[t]}update(){super.update(),this.accumulateForces(),this.verlet(),this.satisfyConstraints(),!this.isAlive&&this._emittedParticles<this._maxNumberOfParticles&&this.age%this._burstPulse===0&&this.releaseParticles(this,this.direction)}verlet(){if(this.isAlive||this._emittedParticles<this._maxNumberOfParticles){const e=this.x,s=this.y,i=this.z;this.x=(2-this._airFriction)*this.x-(1-this._airFriction)*this.lastX,this.y=(2-this._airFriction)*this.y-(1-this._airFriction)*this.lastY+this._gravity*this._timeStep*this._timeStep,this.z=(2-this._airFriction)*this.z-(1-this._airFriction)*this.lastZ,this.lastX=e,this.lastY=s,this.lastZ=i}const t=[];for(const e of this._particles){e.update();const s=e.x,i=e.y,r=e.z;e.x=(2-this._airFriction)*e.x-(1-this._airFriction)*e.lastX,e.y=(2-this._airFriction)*e.y-(1-this._airFriction)*e.lastY+this._gravity*this._timeStep*this._timeStep,e.z=(2-this._airFriction)*e.z-(1-this._airFriction)*e.lastZ,e.lastX=s,e.lastY=i,e.lastZ=r,(e.y>10||!e.isAlive)&&t.push(e)}for(const e of t)e.isEmitter,this._particles.splice(this._particles.indexOf(e),1),e.dispose()}satisfyConstraints(){}accumulateForces(){for(const t of this._particles);}get particles(){return this._particles}get hasIgnited(){return this._hasIgnited}randomBoolean(t){return Math.random()<t}get roomObjectSpriteId(){return this._roomObjectSpriteId}};no.CONE="cone";no.PLANE="plane";no.SPHERE="sphere";let UH=no;class vH{constructor(t){this._canvasId=-1,this._hasIgnited=!1,this._centerX=0,this._centerY=0,this._scaleMultiplier=1,this._blend=1,this._bgColor=4278190080,this._isDone=!1,this._emitters=new vt,this._visualization=t,this._blackOverlayAlphaTransform=new yo,this._blackOverlayAlphaTransform.alpha=1,this._particleColorTransform=new yo,this._identityMatrix=new ue,this._translationMatrix=new ue}dispose(){for(const t of this._emitters.getValues())t.dispose();this._emitters=null,this._canvasTexture&&(this._canvasTexture.destroy(),this._canvasTexture=null),this._blackOverlay&&(this._blackOverlay.destroy(),this._blackOverlay=null),this._emptySprite&&(this._emptySprite.destroy(),this._emptySprite=null),this._blackOverlayAlphaTransform=null,this._particleColorTransform=null,this._identityMatrix=null,this._translationMatrix=null}reset(){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=null,this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}setAnimation(t){this._currentEmitter&&this._currentEmitter.reset(),this._currentEmitter=this._emitters.getValue(t),this._hasIgnited=!1,this._isDone=!1,this.updateCanvas()}updateCanvas(){if(!(!this._currentEmitter||this._canvasId===-1)&&(this._roomSprite=this._visualization.getSprite(this._canvasId),this._roomSprite&&this._roomSprite.texture)){if(this._roomSprite.width<=1||this._roomSprite.height<=1)return;this._canvasTexture&&(this._canvasTexture.width!==this._roomSprite.width||this._canvasTexture.height!==this._roomSprite.height)&&(this._canvasTexture=null),this.clearCanvas(),this._centerX=-this._roomSprite.offsetX,this._centerY=-this._roomSprite.offsetY,this._roomSprite.texture=this._canvasTexture}}getLayerYOffset(t,e,s){return this._currentEmitter&&this._currentEmitter.roomObjectSpriteId===s?this._currentEmitter.y*this._scaleMultiplier:0}controlsSprite(t){return this._currentEmitter?this._currentEmitter.roomObjectSpriteId==t:!1}updateSprites(){!this._currentEmitter||!this._roomSprite||(this._canvasTexture&&this._roomSprite.texture!==this._canvasTexture&&(this._roomSprite.texture=this._canvasTexture),this._hasIgnited&&this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1))}updateAnimation(){if(!this._currentEmitter||!this._roomSprite||this._isDone)return;const t=10;!this._hasIgnited&&this._currentEmitter.hasIgnited&&(this._hasIgnited=!0);const e=this._offsetY*this._scaleMultiplier;if(this._currentEmitter.update(),this._hasIgnited){this._currentEmitter.roomObjectSpriteId>=0&&(this._visualization.getSprite(this._currentEmitter.roomObjectSpriteId).visible=!1),this._canvasTexture||this.updateCanvas(),this.clearCanvas();for(const s of this._currentEmitter.particles){const i=this._centerX+(s.x-s.z)*t/10*this._scaleMultiplier,r=this._centerY-e+(s.y+(s.x+s.z)/2)*t/10*this._scaleMultiplier,a=s.getAsset();if(a&&a.texture)if(s.fade&&s.alphaMultiplier<1){this._translationMatrix.identity(),this._translationMatrix.translate(i+a.offsetX,r+a.offsetY);const o=new Nt(a.texture);this._particleColorTransform.alpha=s.alphaMultiplier,o.filters=[this._particleColorTransform],zt.instance.renderer.render(o,{renderTexture:this._canvasTexture,transform:this._translationMatrix,clear:!1})}else{const o=new ta(i+a.offsetX,r+a.offsetY),_=new Nt(a.texture);_.x=o.x,_.y=o.y,zt.instance.renderer.render(_,{renderTexture:this._canvasTexture,clear:!1})}else{const o=new Nt(Ct.WHITE);o.tint=16777215,o.x=i-1,o.y=r-1,o.width=2,o.height=2,zt.instance.renderer.render(o,{renderTexture:this._canvasTexture,clear:!1})}}if(!this._currentEmitter.particles.length){this._isDone=!0;return}}}parseData(t){this._size=t.size,this._canvasId=t.canvasId!==void 0?t.canvasId:-1,this._offsetY=t.offsetY!==void 0?t.offsetY:10,this._scaleMultiplier=this._size/64,this._blend=t.blend!==void 0?t.blend:1,this._blend=Math.min(this._blend,1),this._blackOverlayAlphaTransform.alpha=this._blend;const e=t.bgColor!==void 0?t.bgColor:"0";if(this._bgColor=parseInt(e,16)||0,!(!t.emitters||!t.emitters.length))for(const s of t.emitters){const i=s.id,r=s.name,a=s.spriteId,o=new UH(r,a);this._emitters.add(i,o);const _=s.maxNumParticles,l=s.particlesPerFrame,c=s.burstPulse!==void 0?s.burstPulse:1,d=s.fuseTime,E=s.simulation.force,I=s.simulation.direction,m=s.simulation.gravity,T=s.simulation.airFriction,p=s.simulation.shape,A=s.simulation.energy;for(const N of s.particles){const C=N.lifeTime,L=N.isEmitter||!1,D=N.fade||!1,v=[];for(const b of N.frames)v.push(this._visualization.asset.getAsset(b));o.configureParticle(C,L,v,D)}o.setup(_,l,E,new Te(0,I,0),m,T,p,A,d,c)}}copyStateFrom(t){let e=0;t._emitters&&t._currentEmitter&&(e=t._emitters.getKey(t._emitters.getValues().indexOf(t._currentEmitter))),this.setAnimation(e),this._currentEmitter&&this._currentEmitter.copyStateFrom(t._currentEmitter,t._size/this._size),this._canvasTexture=null}clearCanvas(){this._emptySprite||(this._emptySprite=new Nt(Ct.EMPTY),this._emptySprite.alpha=0),this._canvasTexture?zt.instance.renderer.render(this._emptySprite,{renderTexture:this._canvasTexture,clear:!0}):this._canvasTexture=ze.create({width:this._roomSprite.width,height:this._roomSprite.height})}}class Sf extends xt{dispose(){if(super.dispose(),this._currentParticleSystem=null,this._particleSystems){for(const t of this._particleSystems.getValues())t.dispose();this._particleSystems=null}}updateObject(t,e){if(super.updateObject(t,e)){if(!this._particleSystems)this.readDefinition(),this._particleSystems?this._currentParticleSystem=this._particleSystems.getValue(t):G.log("ERROR Particle systems could not be read!",this.object.type);else if(t!==this._scale||this._particleSystems.getValue(t)!==this._currentParticleSystem){const s=this._particleSystems.getValue(t);s.copyStateFrom(this._currentParticleSystem),this._currentParticleSystem&&this._currentParticleSystem.reset(),this._currentParticleSystem=s}return!0}return!1}updateSprites(t,e,s){super.updateSprites(t,e,s),this._currentParticleSystem&&this._currentParticleSystem.updateSprites()}updateAnimation(t){return this._currentParticleSystem&&this._currentParticleSystem.updateAnimation(),super.updateAnimation(t)}setAnimation(t){this._currentParticleSystem&&this._currentParticleSystem.setAnimation(t),super.setAnimation(t)}getLayerYOffset(t,e,s){return this._currentParticleSystem&&this._currentParticleSystem.controlsSprite(s)?this._currentParticleSystem.getLayerYOffset(t,e,s):super.getLayerYOffset(t,e,s)}readDefinition(){if(!this.object||!this.object.model)return!1;const t=this.object.model.getValue(g.FURNITURE_FIREWORKS_DATA);if(!t||!t.length)return!1;this._particleSystems=new vt;for(const e of t){const s=e.size,i=new vH(this);i.parseData(e),this._particleSystems.add(s,i)}return!0}}const ao=class Qn extends Sf{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0,this._lastAnimationId=0}update(t,e,s,i){this.updatePresentWrap(),super.update(t,e,s,i)}updatePresentWrap(){if(!this.object)return;const t=1e3,e=this.object.model.getValue(g.FURNITURE_EXTRAS),s=parseInt(e),i=Math.floor(s/t),r=s%t;this._packetType=i>Qn.MAX_PACKET_TYPE_VALUE?0:i,this._ribbonType=r>Qn.MAX_RIBBON_TYPE_VALUE?0:r}getFrameNumber(t,e){if(this._lastAnimationId===Qn.PRESENT_DEFAULT_STATE){if(e<=1)return this._packetType;if(e===2)return this._ribbonType}return super.getFrameNumber(t,e)}getSpriteAssetName(t,e){const s=this.getValidSize(t);let i=this._type,r="";e<this.spriteCount-1?r=String.fromCharCode("a".charCodeAt(0)+e):r="sd";const a=this.getFrameNumber(t,e);return i=i+("_"+s+"_"+r+"_"+this.direction),i=i+("_"+a),i}setAnimation(t){this._lastAnimationId=t,super.setAnimation(t)}};ao.PRESENT_DEFAULT_STATE=0;ao.MAX_PACKET_TYPE_VALUE=9;ao.MAX_RIBBON_TYPE_VALUE=11;let bH=ao;class FH extends bi{constructor(){super(...arguments),this._packetType=0,this._ribbonType=0}update(t,e,s,i){this.updatePresentWrap(),super.update(t,e,s,i)}updatePresentWrap(){if(!this.object)return;const t=this.object.model.getValue(g.FURNITURE_EXTRAS),e=1e3,s=parseInt(t);this._packetType=Math.floor(s/e),this._ribbonType=s%e}getFrameNumber(t,e){return e<=1?this._packetType:this._ribbonType}getSpriteAssetName(t,e){const s=this.getValidSize(t);let i=this._type,r="";e<this.spriteCount-1?r=String.fromCharCode("a".charCodeAt(0)+e):r="sd";const a=this.getFrameNumber(t,e);return i=i+("_"+s+"_"+r+"_"+this.direction),i=i+("_"+a),i}}const mr=class fs extends xt{constructor(){super(),this._color1=fs.DEFAULT_COLOR_1,this._color2=fs.DEFAULT_COLOR_2,this._badgeAssetNameNormalScale="",this._badgeAssetNameSmallScale=""}updateModel(t){const e=super.updateModel(t);if(this._badgeAssetNameNormalScale===""){const r=this.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);r&&(this._badgeAssetNameNormalScale=r,this._badgeAssetNameSmallScale=this._badgeAssetNameNormalScale+"_32")}const s=this.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||fs.DEFAULT_COLOR_1;const i=this.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||fs.DEFAULT_COLOR_2,e}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case fs.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case fs.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===fs.BADGE?t===32?this._badgeAssetNameSmallScale:this._badgeAssetNameNormalScale:super.getSpriteAssetName(t,e)}getLibraryAssetNameForSprite(t,e){return e.tag===fs.BADGE?"%group.badge.url%"+e.libraryAssetName.replace("badge_",""):super.getLibraryAssetNameForSprite(t,e)}};mr.PRIMARY_COLOUR_SPRITE_TAG="COLOR1";mr.SECONDARY_COLOUR_SPRITE_TAG="COLOR2";mr.BADGE="BADGE";mr.DEFAULT_COLOR_1=15658734;mr.DEFAULT_COLOR_2=4934475;let xH=mr;const pn=class ki extends Of{updateModel(t){const e=super.updateModel(t);if(!this.hasThumbnailImage){const r=this.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME);r&&r.length&&this.setThumbnailImages(this.getBitmapAsset(r))}const s=this.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_COLOR_1);this._color1=s||ki.DEFAULT_COLOR_1;const i=this.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_COLOR_2);return this._color2=i||ki.DEFAULT_COLOR_2,e}generateTransformedThumbnail(t,e){const i=new ue,r=e.width/t.width;switch(this.direction){case 2:i.a=r,i.b=-.5*r,i.c=0,i.d=r*1.1,i.tx=0,i.ty=.5*r*t.width;break;case 0:case 4:i.a=r,i.b=.5*r,i.c=0,i.d=r*1.1,i.tx=0,i.ty=0;break;default:i.a=r,i.b=0,i.c=0,i.d=r,i.tx=0,i.ty=0}const a=new Nt(t);return a.transform.setFromMatrix(i),a.position.set(0),At.generateTexture(a)}getLayerColor(t,e,s){switch(this.getLayerTag(t,this._direction,e)){case ki.PRIMARY_COLOUR_SPRITE_TAG:return this._color1;case ki.SECONDARY_COLOUR_SPRITE_TAG:return this._color2}return super.getLayerColor(t,e,s)}getLibraryAssetNameForSprite(t,e){return e.tag===ki.THUMBNAIL&&this.object&&this.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME)?"%group.badge.url%"+this.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_ASSET_NAME):super.getLibraryAssetNameForSprite(t,e)}getBitmapAsset(t){const e=this.asset.getAsset(t);return!e||!e.texture?null:e.texture}};pn.PRIMARY_COLOUR_SPRITE_TAG="COLOR1";pn.SECONDARY_COLOUR_SPRITE_TAG="COLOR2";pn.DEFAULT_COLOR_1=15658734;pn.DEFAULT_COLOR_2=4934475;let GH=pn;const On=class Ki extends xt{constructor(){super(),this._stateQueue=[],this._running=!1}setAnimation(t){if(t===-1&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Ki.ANIMATION_ID_START_ROLL),this._stateQueue.push(Ki.ANIMATION_ID_ROLL);return}if(t>0&&t<=Ki.ANIMATION_ID_OFFSET_SLOW1){if(this._running){this._running=!1,this._stateQueue=[],this._stateQueue.push(Ki.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(Ki.ANIMATION_ID_OFFSET_SLOW2+t),this._stateQueue.push(t);return}super.setAnimation(t)}}updateAnimation(t){return this.getLastFramePlayed(1)&&this.getLastFramePlayed(2)&&this.getLastFramePlayed(3)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};On.ANIMATION_ID_OFFSET_SLOW1=10;On.ANIMATION_ID_OFFSET_SLOW2=20;On.ANIMATION_ID_START_ROLL=31;On.ANIMATION_ID_ROLL=32;let BH=On;class wH extends Tf{constructor(){super(...arguments),this._needsTransform=!0}transformGifTextures(t){if(!this._gifCollection)return;const e=this._gifCollection.textures;if(e.length){for(let s=0;s<e.length;s++){const i=e[s];if(!i||!this.getAsset(`${this._imageUrl}_${s}`))continue;const a=1.1,o=new ue,_=t.width/i.width;switch(this.direction){case 2:o.a=_,o.b=-.5*_,o.c=0,o.d=_*a,o.tx=0,o.ty=.5*_*i.width;break;case 0:case 4:o.a=_,o.b=.5*_,o.c=0,o.d=_*a,o.tx=0,o.ty=0;break;default:o.a=_,o.b=0,o.c=0,o.d=_,o.tx=0,o.ty=0}const l=new Nt(i),c=ze.create({width:t.width+o.tx,height:t.height+o.ty});zt.instance.renderer.render(l,{renderTexture:c,clear:!0,transform:o}),this.asset.disposeAsset(`${this._imageUrl}_${s}`),this.asset.addAsset(`${this._imageUrl}_${s}`,c,!0,t.x,t.y,t.flipH,t.flipV)}this._needsTransform=!1}}generateTransformedImage(t,e){const i=new ue,r=e.width/t.width;switch(this.direction){case 2:i.a=r,i.b=-.5*r,i.c=0,i.d=r*1.1,i.tx=0,i.ty=.5*r*t.width;break;case 0:case 4:i.a=r,i.b=.5*r,i.c=0,i.d=r*1.1,i.tx=0,i.ty=0;break;default:i.a=r,i.b=0,i.c=0,i.d=r,i.tx=0,i.ty=0}const a=new Nt(t),o=ze.create({width:e.width+i.tx,height:e.height+i.ty});zt.instance.renderer.render(a,{renderTexture:o,clear:!0,transform:i}),this.asset.disposeAsset(`${this._imageUrl}_0`),this.asset.addAsset(`${this._imageUrl}_0`,o,!0,a.x,a.y,e.flipH,e.flipV),this._needsTransform=!1}checkAndCreateImageForCurrentState(){super.checkAndCreateImageForCurrentState(),this._needsTransform=!0}getSpriteAssetName(t,e){return this.getLayerTag(t,this._direction,e)===kh.BRANDED_IMAGE&&this._imageUrl?(this._needsTransform&&(this._isAnimated?this.transformGifTextures(this.getAsset(super.getSpriteAssetName(t,e))):this.generateTransformedImage(Me().getTexture(this._imageUrl),this.getAsset(super.getSpriteAssetName(t,e)))),`${this._imageUrl}_${this.getFrameNumber(t,e)}`):super.getSpriteAssetName(t,e)}}class J_ extends bs{constructor(){super(),this._avatarData=new Ia}dispose(){super.dispose(),this._avatarData&&(this._avatarData.dispose(),this._avatarData=null)}createAvatarImage(t,e,s=null,i=null,r=null){return this._avatarData.createAvatarImage(t,e,s,i,r)}set avatarManager(t){this._avatarData.avatarManager=t}}const Mf=class Jn extends bi{constructor(){super(),this._mannequinScale=-1,this._figure=null,this._gender=null,this._dynamicAssetName=null,this._needsUpdate=!1,this._placeHolderFigure="hd-99999-99998",this._disposed=!1}initialize(t){return t instanceof J_?super.initialize(t):!1}dispose(){this._disposed||(this._disposed=!0,this._dynamicAssetName&&this.asset&&(this.asset.disposeAsset(this._dynamicAssetName),this._dynamicAssetName=null),super.dispose())}updateObject(t,e){const s=super.updateObject(t,e);return s&&this._mannequinScale!==t&&(this._mannequinScale=t,this.updateAvatar()),s}updateModel(t){let e=super.updateModel(t);if(e){const s=this.object.model.getValue(g.FURNITURE_MANNEQUIN_FIGURE)||null;s&&(this._figure=s+"."+this._placeHolderFigure,this._gender=this.object.model.getValue(g.FURNITURE_MANNEQUIN_GENDER)||null,this.updateAvatar())}return e=e||this._needsUpdate,this._needsUpdate=!1,e}updateAvatar(t=!1){if(!this.avatarExists()||t){const e=this.data.createAvatarImage(this._figure,this._mannequinScale,this._gender,this);e&&(e.setDirection(ie.FULL,this.direction),this._dynamicAssetName&&this.asset.disposeAsset(this._dynamicAssetName),this.asset.addAsset(this.getAvatarAssetName(),e.getImage(ie.FULL,!1,1,!1),!0),this._dynamicAssetName=this.getAvatarAssetName(),this._needsUpdate=!0,e.dispose())}}avatarExists(){return this._figure&&this.getAsset(this.getAvatarAssetName())!==null}getAvatarAssetName(){return"mannequin_"+this._figure+"_"+this._mannequinScale+"_"+this.direction+"_"+this.object.id}resetFigure(t){t===this._figure&&this.updateAvatar(!0)}getSpriteAssetName(t,e){const s=this.getLayerTag(t,this.direction,e);return this._figure&&s===Jn.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?this.getAvatarAssetName():super.getSpriteAssetName(t,e)}getLayerXOffset(t,e,s){return this.getLayerTag(t,e,s)===Jn.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).width/2:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this.getLayerTag(t,e,s)===Jn.AVATAR_IMAGE_SPRITE_TAG&&this.avatarExists()?-this.getSprite(s).height:super.getLayerYOffset(t,e,s)}get disposed(){return this._disposed}get data(){return this._data}};Mf.AVATAR_IMAGE_SPRITE_TAG="avatar_image";let HH=Mf;const Ir=class Ei extends xt{constructor(){super(),this._animOffsetIndex=[]}updateAnimation(t){this._animSpeedIndex||this.initItems(t);let e=this.getSprite(2);return e&&(this._animOffsetIndex[0]=this.getNewPoint(t,0)),e=this.getSprite(3),e&&(this._animOffsetIndex[1]=this.getNewPoint(t,1)),super.updateAnimation(t)}getNewPoint(t,e){let s=0,i=this._animPhaseIndex[e],r=this._animDirectionIndex[e];const a=this._animSpeedIndex[e],o=this._animFactorIndex[e];let _=1;t==32?(s=Ei.AREA_DIAMETER_SMALL,_=.5):s=Ei.AREA_DIAMETER_LARGE;const l=i+r*a;Math.abs(l)>=s&&(r>0?i=i-(l-s):i=i+(-s-l),r=-r,this._animDirectionIndex[e]=r);const c=(s-Math.abs(i))*o;let d=r*Math.sin(Math.abs(i/4))*c;return r>0?d=d-c:d=d+c,i=i+r*a*_,this._animPhaseIndex[e]=i,Math.trunc(d)==0&&(this._animFactorIndex[e]=this.getRandomAmplitudeFactor()),new ta(i,d)}initItems(t){let e;t===32?e=Ei.AREA_DIAMETER_SMALL:e=Ei.AREA_DIAMETER_LARGE,this._animPhaseIndex=[],this._animPhaseIndex.push(Math.random()*e*1.5),this._animPhaseIndex.push(Math.random()*e*1.5),this._animDirectionIndex=[],this._animDirectionIndex.push(1),this._animDirectionIndex.push(-1),this._animSpeedIndex=[],this._animSpeedIndex.push(Ei.ANIM_SPEED_FAST),this._animSpeedIndex.push(Ei.ANIM_SPEED_SLOW),this._animFactorIndex=[],this._animFactorIndex.push(this.getRandomAmplitudeFactor()),this._animFactorIndex.push(this.getRandomAmplitudeFactor())}getLayerXOffset(t,e,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return(s===2||s===3)&&this._animOffsetIndex.length==2?this._animOffsetIndex[s-2].y:super.getLayerYOffset(t,e,s)}getRandomAmplitudeFactor(){return Math.random()*30/100+.15}};Ir.UPDATE_INTERVAL=2;Ir.AREA_DIAMETER_SMALL=15;Ir.AREA_DIAMETER_LARGE=31;Ir.ANIM_SPEED_FAST=2;Ir.ANIM_SPEED_SLOW=1;let VH=Ir;const Cf=class Nf{constructor(t,e,s,i,r,a){this._name=t,this._index=e,this._radius=s,this._arcSpeed=i*Math.PI*2/360,this._arcOffset=r*Math.PI*2/360,this._height=a,this._position=0,this._positionVector=new R(0,0,0),this._children=[]}dispose(){for(;this._children.length>0;)this._children.shift().dispose()}update(t,e,s){this._position=this._position+this._arcSpeed/Nf.SYSTEM_TEMPO,t[this._index]=this.getPositionVector(e,s);for(const i of this._children)i.update(t,this._positionVector,s)}getPositionVector(t,e){const s=this._radius*Math.cos(this._position+this._arcOffset),i=this._radius*Math.sin(this._position+this._arcOffset);return this._positionVector.x=(s-i)*(e/2),this._positionVector.y=(i+s)*(e/2)*.5-this._height*(e/2),this._positionVector.z=-Math.trunc(4*(s+i)-.7),t&&this._positionVector.add(t),this._positionVector}addChild(t){this._children.indexOf(t)>=0||this._children.push(t)}hasChild(t){return!!this.getChild(t)}getChild(t){for(const e of this._children){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}get name(){return this._name}};Cf.SYSTEM_TEMPO=30;let jH=Cf;class zH extends xt{constructor(){super(),this._offsetArray=[],this._rootPosition=new R}dispose(){if(this._planetIndex)for(;this._planetIndex.length>0;)this._planetIndex.shift().dispose();this._planetIndex=null,this._planetNameIndex=null}updateAnimation(t){if(!this._planetIndex&&this.spriteCount>0&&!this.processPlanets())return 0;if(this._planetIndex){for(const e of this._planetIndex)e.update(this._offsetArray,this._rootPosition,t);return super.updateAnimation(t)}return 0}getLayerXOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].x:super.getLayerXOffset(t,e,s)}getLayerYOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].y:super.getLayerYOffset(t,e,s)}getLayerZOffset(t,e,s){return this._offsetArray[s]?this._offsetArray[s].z:super.getLayerZOffset(t,e,s)}processPlanets(){if(!this.object||!this.object.model)return;const t=this.object.model.getValue(g.FURNITURE_PLANETSYSTEM_DATA);if(!t)return!1;this._planetIndex=[],this._planetNameIndex=[];for(const e of t)this.getSprite(e.id)&&this.addPlanet(e.name,e.id,e.parent,e.radius||0,e.arcSpeed||0,e.arcOffset||0,e.height||0);return!0}addPlanet(t,e,s,i,r,a,o){if(!this._planetIndex)return;const _=new jH(t,e,i,r,a,o),l=this.getPlanet(s);l?l.addChild(_):(this._planetIndex.push(_),this._planetNameIndex.push(t))}getPlanet(t){for(const e of this._planetIndex){if(e.name===t)return e;if(e.hasChild(t))return e.getChild(t)}return null}}class YH extends xt{}const An=class Zn extends xt{constructor(){super(),this._stateQueue=[],this._animationCounter=-1}setAnimation(t){return t===Zn.ANIMATION_ID_ROLL_ONCE&&(this._stateQueue=[],this._stateQueue.push(Zn.ANIMATION_ID_NORMAL),this._animationCounter=Zn.ANIMATION_DURATION),super.setAnimation(t)}updateAnimation(t){return this._animationCounter>0&&this._animationCounter--,this._animationCounter||this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}usesAnimationResetting(){return!0}};An.ANIMATION_ID_ROLL=3;An.ANIMATION_ID_ROLL_ONCE=2;An.ANIMATION_ID_NORMAL=1;An.ANIMATION_DURATION=15;let WH=An;class kH extends xt{usesAnimationResetting(){return!0}}class KH extends kh{imageReady(t,e){super.imageReady(t,e),t&&this.setImageOffset(t.width,t.height)}setImageOffset(t,e){const s=new lf;s.setDirection(1,0,-e),s.setDirection(3,0,0),s.setDirection(5,-t,0),s.setDirection(7,-t,-e),s.setDirection(4,-t/2,-e/2),this._imageOffset=s}getLayerXOffset(t,e,s){if(this._imageOffset){const i=this._imageOffset.getXOffset(e,0);if(i!==void 0)return i+this._offsetX}return super.getLayerXOffset(t,e,s)+this._offsetX}getLayerYOffset(t,e,s){if(this._imageOffset){const i=this._imageOffset.getYOffset(e,0);if(i!==void 0)return i+this._offsetY}return super.getLayerYOffset(t,e,s)+this._offsetY}getLayerZOffset(t,e,s){return super.getLayerZOffset(t,e,s)+-this._offsetZ}getLayerIgnoreMouse(t,e,s){return!0}}const Sn=class Gr extends xt{getFrameNumber(t,e){const s=this.getLayerTag(t,this.direction,e),i=this.object.getState(0);switch(s){case Gr.ONES_SPRITE:return Math.floor(i%10);case Gr.TENS_SPRITE:return Math.floor(i/10%10);case Gr.HUNDREDS_SPRITE:return Math.floor(i/100%10);case Gr.THOUSANDS_SPRITE:return Math.floor(i/1e3%10);default:return super.getFrameNumber(t,e)}}};Sn.ONES_SPRITE="ones_sprite";Sn.TENS_SPRITE="tens_sprite";Sn.HUNDREDS_SPRITE="hundreds_sprite";Sn.THOUSANDS_SPRITE="thousands_sprite";let XH=Sn;class qH extends xt{constructor(){super(...arguments),this._internalFrameIncreaseCounter=0}updateAnimations(t){return this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter+this.object.model.getValue(g.FURNITURE_SOUNDBLOCK_RELATIVE_ANIMATION_SPEED),this._frameIncrease=this._internalFrameIncreaseCounter,this._internalFrameIncreaseCounter=this._internalFrameIncreaseCounter-this._frameIncrease,super.updateAnimations(t)}}class QH extends bi{getLayerColor(t,e,s){return this._data?this._data.getLayerColor(t,e,s):qr.DEFAULT_COLOR}}const Rr=class Ge extends xt{constructor(){super(),this._stateQueue=[],this._running=!1,super.setAnimation(Ge.ANIMATION_ID_OFF)}setAnimation(t){if(t===0&&!this._running){this._running=!0,this._stateQueue=[],this._stateQueue.push(Ge.ANIMATION_ID_START_ROLL),this._stateQueue.push(Ge.ANIMATION_ID_ROLL);return}if(t>0&&t<=Ge.ANIMATION_ID_OFFSET_SLOW2){if(this._running){this._running=!1,this._stateQueue=[],this.direction===2?(this._stateQueue.push(Ge.ANIMATION_ID_OFFSET_SLOW1+5),this._stateQueue.push(Ge.ANIMATION_ID_OFFSET_SLOW2+5)):(this._stateQueue.push(Ge.ANIMATION_ID_OFFSET_SLOW1+t),this._stateQueue.push(Ge.ANIMATION_ID_OFFSET_SLOW2+t)),this._stateQueue.push(Ge.ANIMATION_ID_OFF);return}super.setAnimation(Ge.ANIMATION_ID_OFF)}}updateAnimation(t){return this.getLastFramePlayed(11)&&this._stateQueue.length&&super.setAnimation(this._stateQueue.shift()),super.updateAnimation(t)}};Rr.ANIMATION_ID_OFFSET_SLOW1=20;Rr.ANIMATION_ID_OFFSET_SLOW2=10;Rr.ANIMATION_ID_START_ROLL=31;Rr.ANIMATION_ID_ROLL=32;Rr.ANIMATION_ID_OFF=30;let JH=Rr;const Mn=class Ys extends xt{updateObject(t,e){return super.updateObject(t,e),!0}getFrameNumber(t,e){const s=this.object.model.getValue(g.FURNITURE_VOTE_COUNTER_COUNT);switch(this.getLayerTag(t,this.direction,e)){case Ys.ONES_SPRITE:return s%10;case Ys.TENS_SPRITE:return s/10%10;case Ys.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){if(this.object.model.getValue(g.FURNITURE_VOTE_COUNTER_COUNT)===Ys.HIDE_COUNTER_SCORE)switch(this.getLayerTag(t,e,s)){case Ys.ONES_SPRITE:case Ys.TENS_SPRITE:case Ys.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(t,e,s)}};Mn.ONES_SPRITE="ones_sprite";Mn.TENS_SPRITE="tens_sprite";Mn.HUNDREDS_SPRITE="hundreds_sprite";Mn.HIDE_COUNTER_SCORE=-1;let ZH=Mn;const Tr=class ms extends xt{getFrameNumber(t,e){const s=this.object.model.getValue(g.FURNITURE_VOTE_MAJORITY_RESULT);switch(this.getLayerTag(t,this.direction,e)){case ms.ONES_SPRITE:return s%10;case ms.TENS_SPRITE:return s/10%10;case ms.HUNDREDS_SPRITE:return s/100%10;default:return super.getFrameNumber(t,e)}}getLayerAlpha(t,e,s){const i=this.object.model.getValue(g.FURNITURE_VOTE_MAJORITY_RESULT);if(ms.HIDE_RESULTS_STATES.indexOf(this.object.getState(0))!==-1||i===ms.HIDE_RESULTS_VALUE)switch(this.getLayerTag(t,e,s)){case ms.ONES_SPRITE:case ms.TENS_SPRITE:case ms.HUNDREDS_SPRITE:return 0}return super.getLayerAlpha(t,e,s)}};Tr.ONES_SPRITE="ones_sprite";Tr.TENS_SPRITE="tens_sprite";Tr.HUNDREDS_SPRITE="hundreds_sprite";Tr.HIDE_RESULTS_STATES=[-1,1];Tr.HIDE_RESULTS_VALUE=-1;let $H=Tr;class tV extends xt{}const Df=class Pf extends Af{getThumbnailURL(){if(!this.object)return null;const t=this.object.model.getValue(g.FURNITURE_DATA);return t&&t[Pf.THUMBNAIL_URL]||null}};Df.THUMBNAIL_URL="THUMBNAIL_URL";let eV=Df;class sV{constructor(t){this._sprite=new Nt(t),this._texture=null,this._amount=-1,this._alpha=0}renderBubble(t){if(!this._sprite||this._amount===t)return null;const e=new Ve;e.addChild(this._sprite);const s=new hm("+"+t,{fontFamily:"Arial",fontSize:9,fill:16777215,align:"center"});return s.anchor.x=.5,s.x=this._sprite.width/2,s.y=19,e.addChild(s),this._texture?zt.instance.renderer.render(e,{renderTexture:this._texture,clear:!0}):this._texture=At.generateTexture(e),this._texture}get amount(){return this._amount}set amount(t){this._amount=t}get alpha(){return this._alpha}set alpha(t){this._alpha=t}}class yf extends zh{constructor(){super(),this._isAllowedToTurnHead=!0}createSizeData(t,e,s){return t>1?new Sr(e,s):new Ra(e,s)}defineVisualizations(t){return this._isAllowedToTurnHead=!0,super.defineVisualizations(t)}processVisualElement(t,e,s){if(!t||!e||!s)return!1;switch(e){case"postures":if(!(t instanceof Sr)||!t.processPostures(s))return!1;break;case"gestures":if(!(t instanceof Sr)||!t.processGestures(s))return!1;break;default:if(!super.processVisualElement(t,e,s))return!1;break}return!0}postureToAnimation(t,e){const s=this.getSizeData(t);return s?s.postureToAnimation(e):Sr.DEFAULT}getGestureDisabled(t,e){const s=this.getSizeData(t);return s?s.getGestureDisabled(e):!1}gestureToAnimation(t,e){const s=this.getSizeData(t);return s?s.gestureToAnimation(e):Sr.DEFAULT}animationToPosture(t,e,s){const i=this.getSizeData(t);return i?i.animationToPosture(e,s):null}animationToGesture(t,e){const s=this.getSizeData(t);return s?s.animationToGesture(e):null}getGestureForAnimationId(t,e){const s=this.getSizeData(t);return s?s.getGestureForAnimationId(e):null}totalPostures(t){const e=this.getSizeData(t);return e?e.totalPostures:0}totalGestures(t){const e=this.getSizeData(t);return e?e.totalGestures:0}get isAllowedToTurnHead(){return this._isAllowedToTurnHead}}const Xe=class Xt extends xt{constructor(){for(super(),this._posture="",this._gesture="",this._isSleeping=!1,this._headDirection=-1,this._headOnly=!1,this._nonHeadSprites=[],this._headSprites=[],this._saddleSprites=[],this._animationOver=!1,this._paletteIndex=-1,this._paletteName="",this._customLayerIds=[],this._customPartIds=[],this._customPaletteIds=[],this._isRiding=!1,this._color=16777215,this._experience=0,this._experienceTimestamp=0,this._experienceData=null,this._previousAnimationDirection=-1,this._animationStates=[];this._animationStates.length<Xt.ANIMATION_INDEX_COUNT;)this._animationStates.push(new Ef)}initialize(t){if(!(t instanceof yf))return!1;const e=this.getPetAdditionAsset(Xt.PET_EXPERIENCE_BUBBLE);return e&&(this._experienceData=new sV(e)),super.initialize(t)}dispose(){if(super.dispose(),this._animationStates){for(;this._animationStates.length;){const t=this._animationStates[0];t&&t.dispose(),this._animationStates.pop()}this._animationStates=null}}getAnimationId(t){return t.animationId}update(t,e,s,i){super.update(t,e,s,i),this.updateExperienceBubble(e)}updateExperienceBubble(t){if(this._experienceData&&(this._experienceData.alpha=0,this._experienceTimestamp)){const e=t-this._experienceTimestamp;e<Xt.EXPERIENCE_BUBBLE_VISIBLE_IN_MS?this._experienceData.alpha=Math.sin(e/Xt.EXPERIENCE_BUBBLE_VISIBLE_IN_MS*Math.PI)*255:this._experienceTimestamp=0;const s=this.getSprite(this.totalSprites-1);if(s){if(this._experienceData.alpha>0){const i=this._experienceData.renderBubble(this._experience);if(i){s.texture=i,s.offsetX=-20,s.offsetY=-80,s.alpha=this._experienceData.alpha,s.visible=!0,s.relativeDepth=-.2;return}}s.texture=null,s.visible=!1}}}updateModel(t){const e=this.object&&this.object.model;if(!e||this.updateModelCounter===e.updateCounter)return!1;const s=e.getValue(g.FIGURE_POSTURE),i=e.getValue(g.FIGURE_GESTURE);this.setPostureAndGesture(s,i);let r=e.getValue(g.FURNITURE_ALPHA_MULTIPLIER)||null;(r===null||isNaN(r))&&(r=1),this._alphaMultiplier!==r&&(this._alphaMultiplier=r,this._alphaChanged=!0),this._isSleeping=e.getValue(g.FIGURE_SLEEP)>0;const a=e.getValue(g.HEAD_DIRECTION);!isNaN(a)&&this.data.isAllowedToTurnHead?this._headDirection=a:this._headDirection=this.object.getDirection().x,this._experience=e.getValue(g.FIGURE_GAINED_EXPERIENCE),this._experienceTimestamp=e.getValue(g.FIGURE_EXPERIENCE_TIMESTAMP);const o=e.getValue(g.PET_PALETTE_INDEX),_=e.getValue(g.PET_CUSTOM_LAYER_IDS),l=e.getValue(g.PET_CUSTOM_PARTS_IDS),c=e.getValue(g.PET_CUSTOM_PALETTE_IDS),d=e.getValue(g.PET_IS_RIDING),E=e.getValue(g.PET_HEAD_ONLY),I=e.getValue(g.PET_COLOR);return o!==this._paletteIndex&&(this._paletteIndex=o,this._paletteName=this._paletteIndex.toString()),this._customLayerIds=_||[],this._customPartIds=l||[],this._customPaletteIds=c||[],this._isRiding=!isNaN(d)&&d>0,this._headOnly=!isNaN(E)&&E>0,!isNaN(I)&&this._color!==I&&(this._color=I),this.updateModelCounter=e.updateCounter,!0}updateAnimation(t){if(this.object){const e=this.object.getDirection().x;e!==this._previousAnimationDirection&&(this._previousAnimationDirection=e,this.resetAllAnimationFrames())}return super.updateAnimation(t)}setPostureAndGesture(t,e){this.data&&(t!==this._posture&&(this._posture=t,this.setAnimationForIndex(Xt.POSTURE_ANIMATION_INDEX,this.data.postureToAnimation(this._scale,t))),this.data.getGestureDisabled(this._scale,t)&&(e=null),e!==this._gesture&&(this._gesture=e,this.setAnimationForIndex(Xt.GESTURE_ANIMATION_INDEX,this.data.gestureToAnimation(this._scale,e))))}getAnimationStateData(t){return t>=0&&t<this._animationStates.length?this._animationStates[t]:null}setAnimationForIndex(t,e){const s=this.getAnimationStateData(t);s&&this.setSubAnimation(s,e)&&(this._animationOver=!1)}resetAllAnimationFrames(){this._animationOver=!1;let t=this._animationStates.length-1;for(;t>=0;){const e=this._animationStates[t];e&&e.setLayerCount(this.animatedLayerCount),t--}}updateAnimations(t){if(this._animationOver)return 0;let e=!0,s=0,i=0;for(;i<this._animationStates.length;){const r=this._animationStates[i];if(r&&!r.animationOver){const a=this.updateFramesForAnimation(r,t);s=s|a,r.animationOver?(kt.isTransitionFromAnimation(r.animationId)||kt.isTransitionToAnimation(r.animationId))&&(this.setAnimationForIndex(i,r.animationAfterTransitionId),e=!1):e=!1}i++}return this._animationOver=e,s}getSpriteAssetName(t,e){if(this._headOnly&&this.isNonHeadSprite(e)||this._isRiding&&this._parser3(e))return null;const s=this.totalSprites;if(e<s-Xt.ADDITIONAL_SPRITE_COUNT){const i=this.getValidSize(t);if(e<s-(1+Xt.ADDITIONAL_SPRITE_COUNT)){if(e>=bs.LAYER_LETTERS.length)return null;const r=bs.LAYER_LETTERS[e];return i===1?this._type+"_icon_"+r:this._type+"_"+i+"_"+r+"_"+this.getDirection(t,e)+"_"+this.getFrameNumber(i,e)}return this._type+"_"+i+"_sd_"+this.getDirection(t,e)+"_0"}return null}getLayerColor(t,e,s){return e<this.totalSprites-Xt.ADDITIONAL_SPRITE_COUNT?this._color:16777215}getLayerXOffset(t,e,s){let i=super.getLayerXOffset(t,e,s),r=this._animationStates.length-1;for(;r>=0;){const a=this._animationStates[r];if(a){const o=a.getFrame(s);o&&(i+=o.x)}r--}return i}getLayerYOffset(t,e,s){let i=super.getLayerYOffset(t,e,s),r=this._animationStates.length-1;for(;r>=0;){const a=this._animationStates[r];if(a){const o=a.getFrame(s);o&&(i+=o.y)}r--}return i}getLayerZOffset(t,e,s){return this.data?this.data.getLayerZOffset(t,this.getDirection(t,s),s):ft.DEFAULT_ZOFFSET}getDirection(t,e){return this.isHeadSprite(e)?this.data.getValidDirection(t,this._headDirection):this._direction}getFrameNumber(t,e){let s=this._animationStates.length-1;for(;s>=0;){const i=this._animationStates[s];if(i){const r=i.getFrame(e);if(r)return r.id}s--}return super.getFrameNumber(t,e)}isHeadSprite(t){if(this._headSprites[t]===void 0){const e=this.data.getLayerTag(this._scale,Ri.USE_DEFAULT_DIRECTION,t)===Xt.HEAD,s=this.data.getLayerTag(this._scale,Ri.USE_DEFAULT_DIRECTION,t)===Xt.HAIR;e||s?this._headSprites[t]=!0:this._headSprites[t]=!1}return this._headSprites[t]}isNonHeadSprite(t){if(this._nonHeadSprites[t]===void 0)if(t<this.totalSprites-(1+Xt.ADDITIONAL_SPRITE_COUNT)){const e=this.data.getLayerTag(this._scale,Ri.USE_DEFAULT_DIRECTION,t);e&&e.length>0&&e!==Xt.HEAD&&e!==Xt.HAIR?this._nonHeadSprites[t]=!0:this._nonHeadSprites[t]=!1}else this._nonHeadSprites[t]=!0;return this._nonHeadSprites[t]}_parser3(t){return this._saddleSprites[t]===void 0&&(this.data.getLayerTag(this._scale,Ri.USE_DEFAULT_DIRECTION,t)===Xt.SADDLE?this._saddleSprites[t]=!0:this._saddleSprites[t]=!1),this._saddleSprites[t]}getAsset(t,e=-1){if(!this.asset)return null;const s=this._customLayerIds.indexOf(e);let i=this._paletteName,r=-1,a=-1;return s>-1&&(r=this._customPartIds[s],a=this._customPaletteIds[s],i=a>-1?a.toString():this._paletteName),!isNaN(r)&&r>-1&&(t=t+"_"+r),this.asset.getAssetWithPalette(t,i)}getAdditionalLayerCount(){return super.getAdditionalLayerCount()+Xt.ADDITIONAL_SPRITE_COUNT}setLayerCount(t){super.setLayerCount(t),this._headSprites=[]}getPostureForAsset(t,e){const s=e.split("_");let i=s.length,r=0;for(;r<s.length;){if(s[r]==="64"||s[r]==="32"){i=r+3;break}r++}let a=null;if(i<s.length){let o=s[i];o=o.split("@")[0],a=this.data.animationToPosture(t,parseInt(o)/100,!1),a||(a=this.data.getGestureForAnimationId(t,parseInt(o)/100))}return a}getPetAdditionAsset(t){return Me().getTexture(t)}get data(){return this._data}};Xe.TYPE=P.PET_ANIMATED;Xe.HEAD="head";Xe.SADDLE="saddle";Xe.HAIR="hair";Xe.ADDITIONAL_SPRITE_COUNT=1;Xe.EXPERIENCE_BUBBLE_VISIBLE_IN_MS=1e3;Xe.PET_EXPERIENCE_BUBBLE="avatar_addition_pet_experience_bubble";Xe.POSTURE_ANIMATION_INDEX=0;Xe.GESTURE_ANIMATION_INDEX=1;Xe.ANIMATION_INDEX_COUNT=2;let iV=Xe;class Kh{constructor(t,e=-1,s=1,i=-1,r=1){this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=r,this._asset=t}get asset(){return this._asset}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}dispose(){this._asset=null}}Kh.MIN_NORMAL_COORDINATE_VALUE=-1;Kh.MAX_NORMAL_COORDINATE_VALUE=1;class Ti{constructor(){this._bitmaps=[]}dispose(){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}addBitmap(t,e=-1,s=1,i=-1,r=1){this._bitmaps.push(new Kh(t,e,s,i,r))}getAsset(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e.asset;return null}}Ti.MIN_NORMAL_COORDINATE_VALUE=-1;Ti.MAX_NORMAL_COORDINATE_VALUE=1;class rV{constructor(){this._sizes=[],this._maskVisualizations=new Map,this._assetNames=new Map,this._lastMaskVisualization=null,this._lastSize=-1}dispose(){if(this._maskVisualizations){for(const t of this._maskVisualizations.values())t&&t.dispose();this._maskVisualizations=null}this._lastMaskVisualization=null,this._sizes=null}createMaskVisualization(t){if(this._maskVisualizations.get(t))return null;const s=new Ti;return this._maskVisualizations.set(t,s),this._sizes.push(t),this._sizes.sort(),s}getSizeIndex(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getMaskVisualization(t){if(t===this._lastSize)return this._lastMaskVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastMaskVisualization=this._maskVisualizations.get(this._sizes[e]):this._lastMaskVisualization=null,this._lastSize=t,this._lastMaskVisualization}getGraphicAsset(t,e){const s=this.getMaskVisualization(t);return s?s.getAsset(e):null}getAssetName(t){return this._assetNames&&this._assetNames.get(t)||null}setAssetName(t,e){this._assetNames&&this._assetNames.set(t,e)}}class nV{constructor(){this._assetCollection=null,this._masks=new Map,this._data=null}get data(){return this._data}dispose(){if(this._assetCollection=null,this._data=null,this._masks&&this._masks.size){for(const t of this._masks.values())t&&t.dispose();this._masks.clear()}}initialize(t){this._data=t}initializeAssetCollection(t){this.data&&(this._assetCollection=t,this.parseMasks(this.data,t))}parseMasks(t,e){if(!(!t||!e)&&t.masks&&t.masks.length){let s=0;for(;s<t.masks.length;){const i=t.masks[s];if(i){const r=i.id;if(this._masks.get(r))continue;const o=new rV;if(i.visualizations&&i.visualizations.length){let _=0;for(;_<i.visualizations.length;){const l=i.visualizations[_];if(l){const c=l.size,d=o.createMaskVisualization(c);if(d){const E=this.parseMaskBitmaps(l.bitmaps,d,e);o.setAssetName(c,E)}}_++}}this._masks.set(r,o)}s++}}}parseMaskBitmaps(t,e,s){if(!t||!t.length)return null;let i=null;for(const r of t){if(!r)continue;const a=r.assetName,o=s.getAsset(a);if(!o)continue;let _=Ti.MIN_NORMAL_COORDINATE_VALUE,l=Ti.MAX_NORMAL_COORDINATE_VALUE,c=Ti.MIN_NORMAL_COORDINATE_VALUE,d=Ti.MAX_NORMAL_COORDINATE_VALUE;r.normalMinX!==void 0&&(_=r.normalMinX),r.normalMaxX!==void 0&&(l=r.normalMaxX),r.normalMinY!==void 0&&(c=r.normalMinY),r.normalMaxY!==void 0&&(d=r.normalMaxY),o.flipH||(i=a),e.addBitmap(o,_,l,c,d)}return i}updateMask(t,e,s,i,r,a){const o=this._masks.get(e);if(!o)return!0;const _=o.getGraphicAsset(s,i);if(!_)return!0;const l=_.texture;if(!l)return!0;const c=new Y(r+_.offsetX,a+_.offsetY),d=new ue;let E=1,I=1,m=0,T=0,p=c.x+m,A=c.y+T;return _.flipH&&(E=-1,m=l.width,p=c.x+m-l.width),_.flipV&&(I=-1,T=l.height,A=c.y+T-l.height),d.scale(E,I),d.translate(p,A),zt.instance.renderer.render(new Mt(l),{renderTexture:t,clear:!1,transform:d}),!0}getMask(t){return!this._masks||!this._masks.size?null:this._masks.get(t)||null}}class Br{constructor(t=null,e=0,s=!1){this._assetNames=[],this._maskAssetNames=[],this._maskAssetLocations=[],this._maskAssetFlipHs=[],this._maskAssetFlipVs=[],t!=null&&(this._maskAssetNames=t._maskAssetNames,this._maskAssetLocations=t._maskAssetLocations,this._maskAssetFlipHs=t._maskAssetFlipHs,this._maskAssetFlipVs=t._maskAssetFlipVs),this._color=e,this._alignBottom=s}addMask(t,e,s,i){this._maskAssetNames.push(t),this._maskAssetLocations.push(e),this._maskAssetFlipHs.push(s),this._maskAssetFlipVs.push(i)}addAssetColumn(t){this._assetNames.push(t)}set z(t){this._z=t}get z(){return this._z}set cornerPoints(t){this._points=t}get cornerPoints(){return this._points}get color(){return this._color}get maskAssetNames(){return this._maskAssetNames}get maskAssetLocations(){return this._maskAssetLocations}get maskAssetFlipHs(){return this._maskAssetFlipHs}get maskAssetFlipVs(){return this._maskAssetFlipVs}isBottomAligned(){return this._alignBottom}get assetNameColumns(){return this._assetNames}}class aV{constructor(t,e,s,i,r){this._x=t,this._y=e,this._speedX=s,this._speedY=i,this._asset=r,isNaN(this._x)&&(this._x=0),isNaN(this._y)&&(this._y=0),isNaN(this._speedX)&&(this._speedX=0),isNaN(this._speedY)&&(this._speedY=0)}get bitmapData(){return this._asset}dispose(){this._asset=null}getPosition(t,e,s,i,r){let a=this._x,o=this._y;s>0&&(a=a+this._speedX/s*r/1e3),i>0&&(o=o+this._speedY/i*r/1e3);const _=Math.trunc(a%1*t),l=Math.trunc(o%1*e);return new Y(_,l)}}const ar=class Lf{constructor(t,e,s,i=0){this._material=t,this._offset=i,this._align=s,this._color=e,this._isDisposed=!1}get offset(){return this._offset}get align(){return this._align}get disposed(){return this._isDisposed}dispose(){this._isDisposed=!0,this._material=null,this.clearCache()}clearCache(){}render(t,e,s,i,r,a,o,_,l){const c=this._color>>16,d=this._color>>8&255,E=this._color&255,I=c<255||d<255||E<255;if(this._material){const m=this._material.render(t,e,I?null:s,i,r,a,o,_,l+this.offset,this.align===Lf.ALIGN_TOP);if(m&&I){const T=new Mt(m);I&&(T.tint=this._color),e.writeToRenderTexture(T,s,!1)}}else{const m=e.createAndFillRenderTexture(i,r,t,this._color);e.writeToRenderTexture(new Mt(m),s,!1)}return s}getMaterial(){return this._material}getColor(){return this._color}};ar.DEFAULT_OFFSET=0;ar.ALIGN_TOP=1;ar.ALIGN_BOTTOM=2;ar.ALIGN_DEFAULT=ar.ALIGN_TOP;let is=ar;class oV{constructor(t,e,s){this._layers=[],this._geometry=s,this._cachedBitmapNormal=new R,this._isCached=!1,this._hasAnimationLayers=!1,e<0&&(e=0);let i=0;for(;i<e;)this._layers.push(null),i++}get geometry(){return this._geometry}get hasAnimationLayers(){return this._hasAnimationLayers}dispose(){if(this._layers&&this._layers.length){for(const t of this._layers)t&&t.dispose();this._layers=null}this._geometry=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&this._cachedBitmapNormal.assign(new R),this._layers&&this._layers.length)for(const t of this._layers){if(!t)continue;t.clearCache()}this._isCached=!1}}setLayer(t,e,s,i,r=0){if(t<0||t>this._layers.length)return!1;let a=this._layers[t];return a&&a.dispose(),a=new is(e,s,i,r),this._layers[t]=a,!0}setAnimationLayer(t,e,s){if(t<0||t>this._layers.length)return!1;let i=this._layers[t];return i&&i.dispose(),i=new Lu(e,s),this._layers[t]=i,this._hasAnimationLayers=!0,!0}getLayers(){return this._layers}render(t,e,s,i,r,a,o,_=0,l=0,c=0,d=0,E=0,I=0,m=0){i<1&&(i=1),r<1&&(r=1),(!s||s.width!==i||s.height!==r)&&(s=null),this._isCached=!0;const T=e.createAndFillRenderTexture(i,r,t);if(this._cachedBitmapNormal.assign(a),this._layers&&this._layers.length)for(const p of this._layers)p&&(p instanceof is?p.render(`${t}:${this._layers.indexOf(p)}`,e,T,i,r,a,o,_,l):p instanceof Lu&&p.render(e,T,i,r,a,_,l,c,d,E,I,m));return T}}class Xh{constructor(){this._planeVisualizations=new Map,this._sizes=[],this._lastPlaneVisualization=null,this._lastSize=-1}isStatic(t){return!0}dispose(){for(const t of this._planeVisualizations.values())t&&t.dispose();this._planeVisualizations=null,this._lastPlaneVisualization=null,this._sizes=null,this._lastSize=-1}clearCache(){for(const t of this._planeVisualizations.values())t&&t.clearCache()}createPlaneVisualization(t,e,s){if(this._planeVisualizations.get(t.toString()))return null;const r=new oV(t,e,s);return this._planeVisualizations.set(t.toString(),r),this._sizes.push(t),this._sizes.sort(),r}getSizeIndex(t){let e=0,s=1;for(;s<this._sizes.length;){if(this._sizes[s]>t){this._sizes[s]-t<t-this._sizes[s-1]&&(e=s);break}e=s,s++}return e}getPlaneVisualization(t){if(t===this._lastSize)return this._lastPlaneVisualization;const e=this.getSizeIndex(t);return e<this._sizes.length?this._lastPlaneVisualization=this._planeVisualizations.get(this._sizes[e].toString()):this._lastPlaneVisualization=null,this._lastSize=t,this._lastPlaneVisualization}getLayers(){return this.getPlaneVisualization(this._lastSize).getLayers()}}class Oi extends Xh{render(t,e,s,i,r,a,o,_,l,c){const d=this.getPlaneVisualization(a);if(!d||!d.geometry)return null;const E=d.geometry.getScreenPoint(new R(0,0,0)),I=d.geometry.getScreenPoint(new R(0,r/d.geometry.scale,0)),m=d.geometry.getScreenPoint(new R(i/d.geometry.scale,0,0));let T=0,p=0;if(E&&I&&m){i=Math.round(Math.abs(E.x-m.x)),r=Math.round(Math.abs(E.x-I.x));const A=E.x-d.geometry.getScreenPoint(new R(1,0,0)).x;T=l*Math.trunc(Math.abs(A)),p=c*Math.trunc(Math.abs(A))}return d.render(t,e,s,i,r,o,_,T,p)}}Oi.DEFAULT_COLOR=16777215;Oi.HORIZONTAL_ANGLE_DEFAULT=45;Oi.VERTICAL_ANGLE_DEFAULT=30;class Ta{constructor(t,e){this._texture=t,this._timeStamp=e}dispose(){this._texture=null}get texture(){return this._texture}get timeStamp(){return this._timeStamp}}const oo=class qt{constructor(){this._seed=1,this._modulus=16777216,this._multiplier=69069,this._increment=5}static setSeed(t=1){qt._randomizer||(qt._randomizer=new qt),qt._randomizer.seed=t}static setModulus(t=16777216){qt._randomizer||(qt._randomizer=new qt),qt._randomizer.modulus=t}static getValues(t,e,s){return qt._randomizer||(qt._randomizer=new qt),qt._randomizer.getRandomValues(t,e,s)}static getArray(t,e){return qt._randomizer||(qt._randomizer=new qt),qt._randomizer.getRandomArray(t,e)}set seed(t){this._seed=t}set modulus(t){t<1&&(t=1),this._modulus=t}dispose(){}getRandomValues(t,e,s){const i=[];let r=0;for(;r<t;)i.push(this.iterateScaled(e,s-e)),r++;return i}getRandomArray(t,e){if(t>e||e>1e3)return null;const s=[];let i=0;for(;i<=e;)s.push(i),i++;const r=[];let a=0;for(;a<t;){const o=this.iterateScaled(0,s.length-1);r.push(s[o]),s.splice(o,1),a++}return r}iterate(){let t=kf(Math.trunc(this._multiplier*this._seed)+this._increment);return t<0&&(t=-t),t=t%this._modulus,this._seed=t,t}iterateScaled(t,e){let s=this.iterate();return e<1?t:(s=Math.trunc(t+s/this._modulus*e),s)}};oo.DEFAULT_SEED=1;oo.DEFAULT_MODULUS=16777216;oo._randomizer=null;let or=oo;const Fi=class Ws{constructor(t,e,s=1){if(this._cells=[],this._repeatMode=s,this._width=t<1?1:t,this._cachedBitmapData=null,this._cachedBitmapNormal=null,this._cachedBitmapDataOffsetX=0,this._cachedBitmapDataOffsetY=0,this._isCached=!1,this._isStatic=!0,e&&e.length){let i=0;for(;i<e.length;){const r=e[i];r&&(this._cells.push(r),r.isStatic||(this._isStatic=!1)),i++}}}get isStatic(){return this._isStatic}isRepeated(){return this._repeatMode!==Ws.REPEAT_MODE_NONE}get width(){return this._width}dispose(){if(this._cells&&this._cells.length){for(const t of this._cells)t&&t.dispose();this._cells=null}this._cachedBitmapData=null,this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapData&&(this._cachedBitmapData=null),this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._cells&&this._cells.length)for(const t of this._cells)t&&t.clearCache();this._isCached=!1}}render(t,e,s,i,r,a){if(this._repeatMode===Ws.REPEAT_MODE_NONE&&(s=this.getCellsHeight(this._cells,i)),this._cachedBitmapNormal||(this._cachedBitmapNormal=new R),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.height===s&&R.isEqual(this._cachedBitmapNormal,i)&&this._cachedBitmapDataOffsetX===r&&this._cachedBitmapDataOffsetY===a)return this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapData||(this._cachedBitmapData=e.createRenderTexture(this._width,s,`${t}:column`)),this._cachedBitmapNormal.assign(i),this._cachedBitmapDataOffsetX=r,this._cachedBitmapDataOffsetY=a,!this._cells.length)return this._cachedBitmapData;switch(this._repeatMode){case Ws.REPEAT_MODE_NONE:this.renderRepeatNone(i);break;case Ws.REPEAT_MODE_BORDERS:this.renderRepeatBorders(i);break;case Ws.REPEAT_MODE_CENTER:this.renderRepeatCenter(i);break;case Ws.REPEAT_MODE_FIRST:this.renderRepeatFirst(i);break;case Ws.REPEAT_MODE_LAST:this.renderRepeatLast(i);break;default:this.renderRepeatAll(i,r,a);break}return this._cachedBitmapData}getCellsHeight(t,e){if(!t||!t.length)return 0;let s=0,i=0;for(;i<t.length;){const r=t[i];r&&(s+=r.getHeight(e)),i++}return s}renderCells(t,e,s,i,r=0,a=0){if(!t||!t.length||!this._cachedBitmapData)return e;let o=0;for(;o<t.length;){let _=null;if(s?_=t[o]:_=t[t.length-1-o],_){const l=_.render(i,r,a);if(l&&(s||(e-=l.height),l.y=e,At.writeToRenderTexture(l,this._cachedBitmapData,!1),s&&(e=e+l.height),s&&e>=this._cachedBitmapData.height||!s&&e<=0))return e}o++}return e}renderRepeatNone(t){!this._cells.length||!this._cachedBitmapData||this.renderCells(this._cells,0,!0,t)}renderRepeatAll(t,e,s){if(!this._cells.length||!this._cachedBitmapData)return;let i=0;for(;i<this._cachedBitmapData.height;)if(i=this.renderCells(this._cells,i,!0,t,e,s),!i)return}renderRepeatBorders(t){if(!this._cells.length||!this._cachedBitmapData)return;const e=[];let s=0,i=1;for(;i<this._cells.length-1;){const _=this._cells[i];if(_){const l=_.getHeight(t);l>0&&(s=s+l,e.push(_))}i++}if(this._cells.length==1){const _=this._cells[0];if(_){const l=_.getHeight(t);l>0&&(s=s+l,e.push(_))}}let r=this._cachedBitmapData.height-s>>1,a=this.renderCells(e,r,!0,t),o=this._cells[0];if(o){const _=[o];for(;r>=0;)r=this.renderCells(_,r,!1,t)}if(o=this._cells[this._cells.length-1],o){const _=[o];for(;a<this._cachedBitmapData.height;)a=this.renderCells(_,a,!0,t)}}renderRepeatCenter(t){if(!this._cells.length||!this._cachedBitmapData)return;const e=[],s=[];let i=0,r=0,a=0;for(;a<this._cells.length>>1;){const l=this._cells[a];if(l){const c=l.getHeight(t);c>0&&(i=i+c,e.push(l))}a++}for(a=(this._cells.length>>1)+1;a<this._cells.length;){const l=this._cells[a];if(l){const c=l.getHeight(t);c>0&&(r=r+c,s.push(l))}a++}let o=0,_=this._cachedBitmapData.height;if(i+r>this._cachedBitmapData.height&&(o=i+r-this._cachedBitmapData.height,_=_+(o-(o>>1))),o==0){const l=this._cells[this._cells.length>>1];if(l){const c=l.getHeight(t);if(c>0){const d=this._cachedBitmapData.height-(i+r),E=Math.ceil(d/c)*c;let I=i-(E-d>>1);const m=I+E,T=[l];for(;I<m;)I=this.renderCells(T,I,!0,t)}}}this.renderCells(e,0,!0,t),this.renderCells(s,_,!1,t)}renderRepeatFirst(t){if(!this._cells.length||!this._cachedBitmapData)return;let e=this.renderCells(this._cells,this._cachedBitmapData.height,!1,t);const s=this._cells[0];if(!s)return;const i=[s];for(;e>=0;)e=this.renderCells(i,e,!1,t)}renderRepeatLast(t){if(!this._cells.length||!this._cachedBitmapData)return;let e=this.renderCells(this._cells,0,!0,t);const s=this._cells[this._cells.length-1];if(!s)return;const i=[s];for(;e<this._cachedBitmapData.height;)e=this.renderCells(i,e,!0,t)}getCells(){return this._cells}};Fi.REPEAT_MODE_NONE=0;Fi.REPEAT_MODE_ALL=1;Fi.REPEAT_MODE_BORDERS=2;Fi.REPEAT_MODE_CENTER=3;Fi.REPEAT_MODE_FIRST=4;Fi.REPEAT_MODE_LAST=5;let ks=Fi;const le=class me{constructor(t,e=1,s=1,i=-1,r=1,a=-1,o=1){this._repeatMode=1,this._align=1,this._cachedBitmapNormal=null,this._cachedBitmapHeight=0,this._isCached=!1,this._isStatic=!0,this._normalMinX=-1,this._normalMaxX=1,this._normalMinY=-1,this._normalMaxY=1,this._columns=[],t<1&&(t=1);let _=0;for(;_<t;)this._columns.push(null),_++;this._repeatMode=e,this._align=s,this._normalMinX=i,this._normalMaxX=r,this._normalMinY=a,this._normalMaxY=o,this._repeatMode===me.REPEAT_MODE_RANDOM&&(this._isStatic=!1)}static nextRandomColumnIndex(t){return or.getValues(1,0,t*17631)[0]%t}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}isBottomAligned(){return this._align===me.ALIGN_BOTTOM}get isStatic(){return this._isStatic}dispose(){this._cachedBitmapNormal&&(this._cachedBitmapNormal=null)}clearCache(){if(this._isCached){if(this._cachedBitmapNormal&&(this._cachedBitmapNormal.x=0,this._cachedBitmapNormal.y=0,this._cachedBitmapNormal.z=0),this._columns&&this._columns.length)for(const t of this._columns)t&&t.clearCache();this._isCached=!1}}createColumn(t,e,s,i=1){if(t<0||t>=this._columns.length)return!1;const r=new ks(e,s,i),a=this._columns[t];return a&&a.dispose(),this._columns[t]=r,r&&!r.isStatic&&(this._isStatic=!1),!0}render(t,e,s,i,r,a,o,_,l,c){if(i<1&&(i=1),r<1&&(r=1),this._cachedBitmapNormal||(this._cachedBitmapNormal=new R),this.isStatic){if(this._cachedBitmapData){if(this._cachedBitmapData.baseTexture&&this._cachedBitmapData.width===i&&this._cachedBitmapData.height===r&&R.isEqual(this._cachedBitmapNormal,a))return s?(this.copyCachedBitmapOnCanvas(s,this._cachedBitmapHeight,l,c),s):this._cachedBitmapData;this._cachedBitmapData=null}}else this._cachedBitmapData=null;if(this._isCached=!0,this._cachedBitmapNormal.assign(a),!o)return this._cachedBitmapHeight=r,this._cachedBitmapData?e.clearAndFillRenderTexture(this._cachedBitmapData):this._cachedBitmapData=e.createAndFillRenderTexture(i,r,`${t}:matrix`),this._cachedBitmapData;this._cachedBitmapData||(this._cachedBitmapHeight=r,this._cachedBitmapData=e.createRenderTexture(i,r,`${t}:matrix`),e.clearRenderTexture(this._cachedBitmapData));const d=[];let E=0;for(;E<this._columns.length;){const m=this._columns[E];if(m){const T=m.render(t,e,r,a,_,l);T&&d.push(T)}E++}if(!d.length)return s||this._cachedBitmapData;let I=0;switch(this._repeatMode){case me.REPEAT_MODE_BORDERS:G.log("REPEAT_MODE_BORDERS");break;case me.REPEAT_MODE_CENTER:G.log("REPEAT_MODE_CENTER");break;case me.REPEAT_MODE_FIRST:G.log("REPEAT_MODE_FIRST");break;case me.REPEAT_MODE_LAST:G.log("REPEAT_MODE_LAST");break;case me.REPEAT_MODE_RANDOM:I=this.renderRepeatRandom(this._cachedBitmapData,d);break;default:I=this.renderRepeatAll(this._cachedBitmapData,d);break}return this._cachedBitmapHeight=I,s?(this.copyCachedBitmapOnCanvas(s,I,l,c),s):this._cachedBitmapData}copyCachedBitmapOnCanvas(t,e,s,i){if(!t||!this._cachedBitmapData||t===this._cachedBitmapData)return;i||(s=t.height-e-s);let r=null;this._align===me.ALIGN_TOP?r=new de(0,0,this._cachedBitmapData.width,this._cachedBitmapHeight):r=new de(0,this._cachedBitmapData.height-this._cachedBitmapHeight,this._cachedBitmapData.width,this._cachedBitmapHeight);const a=new ze(this._cachedBitmapData.baseTexture,r),o=new Mt(a);o.position.set(0,s),At.writeToRenderTexture(o,t,!1)}getColumnsWidth(t){if(!t||!t.length)return 0;let e=0;for(const s of t)s&&(e+=s.width);return e}renderColumns(t,e,s,i){if(!t||!e||!e.length)return new Y(s,0);let r=0,a=0;for(;a<e.length;){const o=i?e[a]:e[e.length-1-a];if(o){i||(s=s-o.width);let _=0;this._align==me.ALIGN_BOTTOM&&(_=t.height-o.height);const l=new Mt(o);if(l.position.set(s,_),At.writeToRenderTexture(l,t,!1),o.height>r&&(r=o.height),i&&(s=s+o.width),i&&s>=t.width||!i&&s<=0)return new Y(s,r)}a++}return new Y(s,r)}renderRepeatAll(t,e){if(!t||!e||!e.length)return 0;this.getColumnsWidth(e);let s=0,i=0;for(;s<t.width;){const r=this.renderColumns(t,e,s,!0);if(s=r.x,r.y>i&&(i=r.y),!r.x)return i}return i}renderRepeatRandom(t,e){if(!t||!e||!e.length)return 0;let s=0,i=0;for(;i<t.width;){const r=e[me.nextRandomColumnIndex(e.length)];if(r!=null){const a=this.renderColumns(t,[r],i,!0);i=a.x,a.y>s&&(s=a.y)}else return s}return s}getColumns(t){if(this._repeatMode===me.REPEAT_MODE_RANDOM){const e=[];let s=0;for(;s<t;){const i=this._columns[me.nextRandomColumnIndex(this._columns.length)];if(i)if(e.push(i),i.width>1)s+=i.width;else break;else break}return e}return this._columns}};le.REPEAT_MODE_ALL=1;le.REPEAT_MODE_BORDERS=2;le.REPEAT_MODE_CENTER=3;le.REPEAT_MODE_FIRST=4;le.REPEAT_MODE_LAST=5;le.REPEAT_MODE_RANDOM=6;le.REPEAT_MODE_DEFAULT=le.REPEAT_MODE_ALL;le.MIN_NORMAL_COORDINATE_VALUE=-1;le.MAX_NORMAL_COORDINATE_VALUE=1;le.ALIGN_TOP=1;le.ALIGN_BOTTOM=2;le.ALIGN_DEFAULT=le.ALIGN_TOP;let te=le;class qh{constructor(){this._planeMaterialItems=[],this._isCached=!1}dispose(){if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const t of this._planeMaterialItems)t&&t.dispose();this._planeMaterialItems=null}this._isCached=!1}clearCache(){if(this._isCached){if(this._planeMaterialItems&&this._planeMaterialItems.length)for(const t of this._planeMaterialItems)t&&t.clearCache();this._isCached=!1}}addMaterialCellMatrix(t,e,s,i=-1,r=1,a=-1,o=1){const _=new te(t,e,s,i,r,a,o);return this._planeMaterialItems.push(_),_}getMaterialCellMatrix(t){if(!t)return null;if(this._planeMaterialItems&&this._planeMaterialItems.length){for(const e of this._planeMaterialItems)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e}return null}render(t,e,s,i,r,a,o,_,l,c){i<1&&(i=1),r<1&&(r=1);const d=this.getMaterialCellMatrix(a);return d?(this._isCached=!0,d.render(t,e,s,i,r,a,o,_,l,c)):null}}qh.MIN_NORMAL_COORDINATE_VALUE=-1;qh.MAX_NORMAL_COORDINATE_VALUE=1;class _V{constructor(t,e=null,s=null,i=0){if(this._extraItemCount=0,this._texture=t,this._extraItemOffsets=[],this._extraItemAssets=[],this._extraItemCount=0,e&&e.length&&i>0){let r=0;for(;r<e.length;){const a=e[r];a&&this._extraItemAssets.push(a),r++}if(this._extraItemAssets.length){if(s){let a=0;for(;a<s.length;){const o=s[a];o&&this._extraItemOffsets.push(new Y(o.x,o.y)),a++}}this._extraItemCount=i}}}get isStatic(){return this._extraItemCount===0}dispose(){this._texture&&(this._texture.dispose(),this._texture=null),this._extraItemAssets=null,this._extraItemOffsets=null,this._extraItemCount=0}clearCache(){}getHeight(t){if(this._texture){const e=this._texture.getBitmap(t);if(e)return e.height}return 0}render(t,e,s){if(!this._texture)return null;const i=this._texture.getBitmap(t);if(!i)return null;const r=new um(i,i.width,i.height);if(e!==0||s!==0){for(;e<0;)e+=i.width;for(;s<0;)s+=i.height;r.tilePosition.set(e%i.width,s%i.height),r.uvRespectAnchor=!0,e&&(r.anchor.x=1,r.scale.x=-1),s&&(r.anchor.y=1,r.scale.y=-1)}if(!this.isStatic){const a=Math.min(this._extraItemCount,this._extraItemOffsets.length),o=Math.max(this._extraItemCount,this._extraItemOffsets.length),_=or.getArray(this._extraItemCount,o);let l=0;for(;l<a;){const c=this._extraItemOffsets[_[l]],d=this._extraItemAssets[l%this._extraItemAssets.length];if(c&&d){const E=d.texture;if(E){let I=d.offsetX,m=d.offsetY,T=1,p=1,A=0,N=0;d.flipH&&(T=-1,A=E.width,I=-(d.width+d.x)),d.flipV&&(p=-1,N=E.height,m=-(d.height+d.y));const C=new Y(c.x+I,c.y+m),L=new ue;let D=C.x+A;D=D>>1<<1,L.scale(T,p),L.translate(D,C.y+N);const v=new Mt(E);v.transform.setFromMatrix(L),r.addChild(v)}}l++}}return r}getAssetName(t){return this._texture==null?null:this._texture.getAssetName(t)}}class Qh{constructor(t,e=-1,s=1,i=-1,r=1,a=null){this._bitmap=t,this._normalMinX=e,this._normalMaxX=s,this._normalMinY=i,this._normalMaxY=r,this._assetName=a}get bitmap(){return this._bitmap}get normalMinX(){return this._normalMinX}get normalMaxX(){return this._normalMaxX}get normalMinY(){return this._normalMinY}get normalMaxY(){return this._normalMaxY}get assetName(){return this._assetName}dispose(){this._bitmap=null}}Qh.MIN_NORMAL_COORDINATE_VALUE=-1;Qh.MAX_NORMAL_COORDINATE_VALUE=1;class mi{constructor(){this._bitmaps=[]}dispose(){if(this._bitmaps){for(const t of this._bitmaps)t&&t.dispose();this._bitmaps=null}}addBitmap(t,e=-1,s=1,i=-1,r=1,a=null){this._bitmaps.push(new Qh(t,e,s,i,r,a))}getBitmap(t){const e=this.getPlaneTextureBitmap(t);return e?e.bitmap:null}getPlaneTextureBitmap(t){if(!t)return null;for(const e of this._bitmaps)if(e&&t.x>=e.normalMinX&&t.x<=e.normalMaxX&&t.y>=e.normalMinY&&t.y<=e.normalMaxY)return e;return null}getAssetName(t){const e=this.getPlaneTextureBitmap(t);return e?e.assetName:null}}mi.MIN_NORMAL_COORDINATE_VALUE=-1;mi.MAX_NORMAL_COORDINATE_VALUE=1;const Uf=class vf{constructor(){this._assetCollection=null,this._textures=new Map,this._materials=new Map,this._planes=new Map,this._geometries=new Map,this._data=null}get data(){return this._data}get assetCollection(){return this._assetCollection}initializeDimensions(t,e){return!0}dispose(){if(this._planes){for(const t of this._planes.values())t&&t.dispose();this._planes=null}if(this._materials&&(this.resetMaterials(),this._materials=null),this._textures&&(this.resetTextures(),this._textures=null),this._geometries){for(const t of this._geometries.values())t&&t.dispose();this._geometries=null}this._data=null,this._assetCollection=null}clearCache(){for(const t of this._planes.values())t&&t.clearCache();for(const t of this._materials.values())t&&t.clearCache()}initialize(t){this._data=t}reinitialize(){this.resetTextures(),this.resetMaterials(),this.initializeAll()}resetMaterials(){for(const t of this._materials.values())t&&t.dispose();this._materials.clear()}resetTextures(){for(const t of this._textures.values())t&&t.dispose();this._textures.clear()}getTexture(t){return this._textures.get(t)}getMaterial(t){return this._materials.get(t)}getPlane(t){return this._planes.get(t)}addPlane(t,e){return e?this._planes.get(t)?!1:(this._planes.set(t,e),!0):!1}initializeAssetCollection(t){this._data&&(this._assetCollection=t,this.initializeAll())}initializeAll(){this._data&&(this.initializeTexturesAndMaterials(),this.initializePlanes())}initializeTexturesAndMaterials(){this._data.textures&&this._data.textures.length&&this.parseTextures(this._data.textures,this.assetCollection),this._data.materials&&this._data.materials.length&&this.parsePlaneMaterials(this._data.materials)}initializePlanes(){}parseTextures(t,e){if(!(!t||!e)&&t.length)for(const s of t){if(!s)continue;const i=s.id;if(!this._textures.get(i)){const r=new mi;if(s.bitmaps&&s.bitmaps.length)for(const a of s.bitmaps){if(!a)continue;const o=a.assetName;let _=mi.MIN_NORMAL_COORDINATE_VALUE,l=mi.MAX_NORMAL_COORDINATE_VALUE,c=mi.MIN_NORMAL_COORDINATE_VALUE,d=mi.MAX_NORMAL_COORDINATE_VALUE;a.normalMinX!==void 0&&(_=a.normalMinX),a.normalMaxX!==void 0&&(l=a.normalMaxX),a.normalMinY!==void 0&&(c=a.normalMinY),a.normalMaxY!==void 0&&(d=a.normalMaxY);const E=e.getAsset(o);if(E){const I=E.texture;if(I){let m=I;E.flipH?m=GI.getFlipHBitmapData(I):m=m.clone(),r.addBitmap(m,_,l,c,d,o)}}}this._textures.set(i,r)}}}parsePlaneMaterials(t){if(!(!t||!t.length))for(const e of t){if(!e)continue;const s=e.id,i=new qh;if(e.matrices&&e.matrices.length)for(const r of e.matrices){if(!r)continue;let a=te.REPEAT_MODE_DEFAULT,o=te.ALIGN_DEFAULT,_=te.MIN_NORMAL_COORDINATE_VALUE,l=te.MAX_NORMAL_COORDINATE_VALUE,c=te.MIN_NORMAL_COORDINATE_VALUE,d=te.MAX_NORMAL_COORDINATE_VALUE;switch(r.normalMinX!==void 0&&(_=r.normalMinX),r.normalMaxX!==void 0&&(l=r.normalMaxX),r.normalMinY!==void 0&&(c=r.normalMinY),r.normalMaxY!==void 0&&(d=r.normalMaxY),r.repeatMode){case"borders":a=te.REPEAT_MODE_BORDERS;break;case"center":a=te.REPEAT_MODE_CENTER;break;case"first":a=te.REPEAT_MODE_FIRST;break;case"last":a=te.REPEAT_MODE_LAST;break;case"random":a=te.REPEAT_MODE_RANDOM;break;default:a=te.REPEAT_MODE_DEFAULT;break}switch(r.align){case"top":o=te.ALIGN_TOP;break;case"bottom":o=te.ALIGN_BOTTOM;break;default:o=te.ALIGN_DEFAULT;break}if(r.columns&&r.columns.length){const E=i.addMaterialCellMatrix(r.columns.length,a,o,_,l,c,d);let I=0;for(;I<r.columns.length;){const m=r.columns[I];m&&this.parsePlaneMaterialCellColumn(m,E,I),I++}}}this._materials.set(s,i)}}parsePlaneMaterialCellColumn(t,e,s){if(!t||!e)return;let i=ks.REPEAT_MODE_ALL;const r=t.width,a=this.parsePlaneMaterialCells(t);switch(t.repeatMode){case"borders":i=ks.REPEAT_MODE_BORDERS;break;case"center":i=ks.REPEAT_MODE_CENTER;break;case"first":i=ks.REPEAT_MODE_FIRST;break;case"last":i=ks.REPEAT_MODE_LAST;break;case"none":i=ks.REPEAT_MODE_NONE;break;default:i=ks.REPEAT_MODE_ALL;break}e.createColumn(s,r,a,i)}parsePlaneMaterialCells(t){if(!t||!t.cells||!t.cells.length)return null;const e=[];let s=0;for(;s<t.cells.length;){const i=t.cells[s];if(i){const r=i.textureId;let a=null,o=null,_=null,l=0;if(i.extraData){const E=i.extraData.extraItemTypes,I=i.extraData.offsets;E&&I&&E.length&&I.length&&(a=this.parseExtraItemTypes(E),o=this.parseExtraItemOffsets(I),l=o.length,i.extraData.limitMax!==void 0&&(l=i.extraData.limitMax))}if(a&&a.length){_=[];for(const E of a){if(!E)continue;const I=this._assetCollection.getAsset(E);I&&_.push(I)}}const c=this.getTexture(r),d=new _V(c,_,o,l);e.push(d)}s++}return!e||!e.length?null:e}parseExtraItemTypes(t){const e=[];if(t&&t.length){let s=0;for(;s<t.length;){const i=t[s];i&&e.push(i),s++}}return e}parseExtraItemOffsets(t){const e=[];if(t&&t.length){let s=0;for(;s<t.length;){const[i,r]=t[s];e.push(new Y(i,r)),s++}}return e}getGeometry(t,e,s){e=Math.abs(e),e>90&&(e=90),s=Math.abs(s),s>90&&(s=90);const i=`${t}_${Math.round(e)}_${Math.round(s)}`;let r=this._geometries.get(i);return r||(r=new kr(t,new R(e,s),new R(-10,0,0)),this._geometries.set(i,r),r)}parseVisualizations(t,e){if(!(!t||!e)&&e&&e.length)for(const s of e){if(!s)continue;const i=s.size;let r=Oi.HORIZONTAL_ANGLE_DEFAULT,a=Oi.VERTICAL_ANGLE_DEFAULT;s.horizontalAngle!==void 0&&(r=s.horizontalAngle),s.verticalAngle!==void 0&&(a=s.verticalAngle);const o=s.allLayers,_=t.createPlaneVisualization(i,o&&o.length||0,this.getGeometry(i,r,a));if(_&&o&&o.length){let l=0;for(;l<o.length;){const c=o[l];if(c){let d=null,E=is.ALIGN_DEFAULT,I=Oi.DEFAULT_COLOR,m=is.DEFAULT_OFFSET;c.materialId&&(d=this.getMaterial(c.materialId)),c.color&&(I=c.color),c.offset&&(m=c.offset),c.align&&(c.align==="bottom"?E=is.ALIGN_BOTTOM:c.align=="top"&&(E=is.ALIGN_TOP)),_.setLayer(l,d,I,E,m)}l++}}}}render(t,e,s,i,r,a,o,_,l,c=0,d=0,E=0,I=0,m=0){return null}getTextureIdentifier(t,e){return t.toString()}getLayers(t){let e=this.getPlane(t);return e||(e=this.getPlane(vf.DEFAULT)),e.getLayers()}};Uf.DEFAULT="default";let Qr=Uf;class hV extends Qr{initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseFloors(t)}parseFloors(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,r=s.visualizations,a=new Oi;this.parseVisualizations(a,r),this.addPlane(i,a)||a.dispose()}}render(t,e,s,i,r,a,o,_,l,c=0,d=0,E=0,I=0,m=0){let T=this.getPlane(i);if(T||(T=this.getPlane(Qr.DEFAULT)),!T)return null;s&&e.clearAndFillRenderTexture(s);let p=T.render(t,e,s,r,a,o,_,l,c,d);return p&&p!==s&&(p=new ze(p.baseTexture),!p)?null:new Ta(p,-1)}}class _o extends Xh{render(t,e,s,i,r,a,o,_){const l=this.getPlaneVisualization(a);if(!l||!l.geometry)return null;const c=l.geometry.getScreenPoint(new R(0,0,0)),d=l.geometry.getScreenPoint(new R(0,0,r/l.geometry.scale)),E=l.geometry.getScreenPoint(new R(0,i/l.geometry.scale,0));return c&&d&&E&&(i=Math.round(Math.abs(c.x-E.x)),r=Math.round(Math.abs(c.y-d.y))),l.render(t,e,s,i,r,o,_)}}_o.DEFAULT_COLOR=16777215;_o.HORIZONTAL_ANGLE_DEFAULT=45;_o.VERTICAL_ANGLE_DEFAULT=30;class uV extends Qr{initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseWalls(t)}parseWalls(t){if(t)for(const e in t){const s=t[e];if(!s)continue;const i=s.id,r=s.visualizations,a=new _o;this.parseVisualizations(a,r),this.addPlane(i,a)||a.dispose()}}render(t,e,s,i,r,a,o,_,l,c=0,d=0,E=0,I=0,m=0){let T=this.getPlane(i);if(T||(T=this.getPlane(Qr.DEFAULT)),!T)return null;s&&e.clearAndFillRenderTexture(s);let p=T.render(t,e,s,r,a,o,_,l);return p&&p!==s&&(p=new ze(p.baseTexture),!p)?null:new Ta(p,-1)}getTextureIdentifier(t,e){return e?`${t}_${e.x}_${e.y}_${e.z}`:super.getTextureIdentifier(t,e)}}class pi extends Xh{constructor(){super(...arguments),this._width=0,this._height=0}isStatic(t){const e=this.getPlaneVisualization(t);return e?!e.hasAnimationLayers:super.isStatic(t)}initializeDimensions(t,e){t<0&&(t=0),e<0&&(e=0),(t!==this._width||e!==this._height)&&(this._width=t,this._height=e)}render(t,e,s,i,r,a,o,_,l,c,d,E,I){const m=this.getPlaneVisualization(a);if(!m||!m.geometry)return null;const T=m.geometry.getScreenPoint(new R(0,0,0)),p=m.geometry.getScreenPoint(new R(0,0,1)),A=m.geometry.getScreenPoint(new R(0,1,0));if(T&&p&&A){i=Math.round(Math.abs((T.x-A.x)*i/m.geometry.scale)),r=Math.round(Math.abs((T.y-p.y)*r/m.geometry.scale));const N=Math.trunc(l*Math.abs(T.x-A.x)),C=Math.trunc(c*Math.abs(T.y-p.y)),L=Math.trunc(d*Math.abs(T.x-A.x)),D=Math.trunc(E*Math.abs(T.y-p.y));return m.render(t,e,s,i,r,o,_,N,C,L,D,d,E,I)}return null}}pi.DEFAULT_COLOR=16777215;pi.HORIZONTAL_ANGLE_DEFAULT=45;pi.VERTICAL_ANGLE_DEFAULT=30;const ho=class Xi extends Qr{constructor(){super(...arguments),this._landscapeWidth=0,this._landscapeHeight=0,this._cachedBitmap=null}initializeDimensions(t,e){return t<0&&(t=0),e<0&&(e=0),this._landscapeWidth=t,this._landscapeHeight=e,!0}initializePlanes(){if(!this.data)return;const t=this.data.planes;t&&t.length&&this.parseLandscapes(t)}parseLandscapes(t){if(!t)return;const e=Math.trunc(Math.random()*654321);for(const s in t){const i=t[s];if(!i)continue;const r=i.id,a=i.animatedVisualization,o=new pi;for(const _ of a){if(!_)continue;const l=_.size;let c=pi.HORIZONTAL_ANGLE_DEFAULT,d=pi.VERTICAL_ANGLE_DEFAULT;_.horizontalAngle!==void 0&&(c=_.horizontalAngle),_.verticalAngle!==void 0&&(d=_.verticalAngle);const E=_.allLayers.length??0,I=o.createPlaneVisualization(l,E||0,this.getGeometry(l,c,d));if(I){or.setSeed(e);let m=0;for(;m<E;){const T=_.allLayers[m];if(T){if(T.items===void 0){const p=T;let A=null,N=is.ALIGN_DEFAULT,C=pi.DEFAULT_COLOR,L=is.DEFAULT_OFFSET;p.materialId&&(A=this.getMaterial(p.materialId)),p.color&&(C=p.color),p.offset&&(L=p.offset),p.align&&(p.align==="bottom"?N=is.ALIGN_BOTTOM:p.align==="top"&&(N=is.ALIGN_TOP)),I.setLayer(m,A,C,N,L)}else{const A=T.items,N=[];if(A&&A.length){for(const C of A)if(C){C.id;const L=C.assetId,D=this.getCoordinateValue(C.x||"",C.randomX||""),v=this.getCoordinateValue(C.y||"",C.randomY||""),b=C.speedX,q=C.speedY;N.push({asset:L,x:D,y:v,speedX:b,speedY:q})}}I.setAnimationLayer(m,N,this.assetCollection)}m++}}}}this.addPlane(r,o)||o.dispose()}}getCoordinateValue(t,e){let s=0;if(t.length>0&&t.charAt(t.length-1)==="%"&&(t=t.substr(0,t.length-1),s=parseFloat(t)/100),e.length>0){const a=or.getValues(1,0,1e4)[0]/1e4;e.charAt(e.length-1)==="%"&&(e=e.substr(0,e.length-1),s=s+a*parseFloat(e)/100)}return s}render(t,e,s,i,r,a,o,_,l,c=0,d=0,E=0,I=0,m=0){let T=this.getPlane(i);if(T||(T=this.getPlane(Xi.DEFAULT)),!T)return null;s&&e.clearRenderTexture(s);let p=T.render(t,e,s,r,a,o,_,l,c,d,E,I,m);if(p&&p!==s&&(p=new ze(p.baseTexture),!p))return null;let A=null;return!T.isStatic(o)&&Xi.UPDATE_INTERVAL>0?A=new Ta(p,Math.round(m/Xi.UPDATE_INTERVAL)*Xi.UPDATE_INTERVAL+Xi.UPDATE_INTERVAL):A=new Ta(p,-1),A}getTextureIdentifier(t,e){return e?e.x<0?t+"_0":t+"_1":super.getTextureIdentifier(t,e)}};ho.LANDSCAPES_ENABLED=!0;ho.LANDSCAPE_DEFAULT_COLOR=8828617;ho.UPDATE_INTERVAL=500;let bf=ho;class Lu{constructor(t,e){if(this._color=0,this._isDisposed=!1,this._color=0,this._isDisposed=!1,this._items=[],t&&e)for(const s of t){if(!s)continue;const i=s.asset;if(i){const r=e.getAsset(i);r&&this._items.push(new aV(s.x,s.y,s.speedX,s.speedY,r))}}}get disposed(){return this._isDisposed}dispose(){if(this._isDisposed=!0,this._items){for(const t of this._items)t&&t.dispose();this._items=[]}}clearCache(){}render(t,e,s,i,r,a,o,_,l,c,d,E){if(_>0&&l>0){let I=0;for(;I<this._items.length;){const m=this._items[I];if(m){const T=m.getPosition(_,l,c,d,E);if(T.x=Math.trunc(T.x-a),T.y=Math.trunc(T.y-o),m.bitmapData){if(T.x>-m.bitmapData.width&&T.x<e.width&&T.y>-m.bitmapData.height&&T.y<e.height){const p=new Mt(m.bitmapData.texture);p.position.set(T.x,T.y),t.writeToRenderTexture(p,e,!1)}if(T.x-_>-m.bitmapData.width&&T.x-_<e.width&&T.y>-m.bitmapData.height&&T.y<e.height){const p=new Mt(m.bitmapData.texture);p.position.set(T.x-_,T.y),t.writeToRenderTexture(p,e,!1)}if(T.x>-m.bitmapData.width&&T.x<e.width&&T.y-l>-m.bitmapData.height&&T.y-l<e.height){const p=new Mt(m.bitmapData.texture);p.position.set(T.x,T.y-l),t.writeToRenderTexture(p,e,!1)}if(T.x-_>-m.bitmapData.width&&T.x-_<e.width&&T.y-l>-m.bitmapData.height&&T.y-l<e.height){const p=new Mt(m.bitmapData.texture);p.position.set(T.x-_,T.y-l),t.writeToRenderTexture(p,e,!1)}}}I++}}return e}}class Uu{constructor(t,e,s){this._type=t,this._leftSideLoc=e,this._rightSideLoc=s}get type(){return this._type}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}}class vu{constructor(t,e,s,i){this._leftSideLoc=t,this._rightSideLoc=e,this._leftSideLength=s,this._rightSideLength=i}get leftSideLoc(){return this._leftSideLoc}get rightSideLoc(){return this._rightSideLoc}get leftSideLength(){return this._leftSideLength}get rightSideLength(){return this._rightSideLength}}const xi=class Ks{constructor(t,e,s,i,r,a,o,_,l,c=0,d=0,E=0,I=0){if(this._maskManager=null,this._width=0,this._height=0,this._textureCache=t,this._secondaryNormals=[],this._bitmapMasks=[],this._rectangleMasks=[],this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._randomSeed=l,this._bitmapData=null,this._maskBitmapData=null,this._maskChanged=!1,this._activeTexture=null,this._origin=new R,this._origin.assign(e),this._location=new R,this._location.assign(s),this._leftSide=new R,this._leftSide.assign(i),this._rightSide=new R,this._rightSide.assign(r),this._normal=R.crossProduct(this._leftSide,this._rightSide),this._normal.length>0&&this._normal.multiply(1/this._normal.length),_!=null)for(const m of _){if(!m)continue;const T=new R;T.assign(m),this._secondaryNormals.push(T)}this._disposed=!1,this._isVisible=!1,this._id=null,this._hasTexture=!0,this._geometryUpdateId=-1,this._offset=new Y,this._relativeDepth=0,this._type=a,this._color=0,this._rasterizer=null,this._canBeVisible=!0,this._cornerA=new R,this._cornerB=new R,this._cornerC=new R,this._cornerD=new R,this._width=0,this._height=0,this._textureOffsetX=c,this._textureOffsetY=d,this._textureMaxX=E,this._textureMaxY=I,this._useMask=o,this._uniqueId=++Ks._uniqueIdCounter}static blend(t,e){return qo.colorize(e,t|4278190080)&16777215}set canBeVisible(t){t!==this._canBeVisible&&(this._canBeVisible||this.resetTextureCache(),this._canBeVisible=t)}get canBeVisible(){return this._canBeVisible}get bitmapData(){return!this.visible||!this._bitmapData?null:this._bitmapData}get maskBitmapData(){return!this.visible||!this._maskBitmapData?null:this._maskBitmapData}get visible(){return this._isVisible&&this._canBeVisible}get offset(){return this._offset}get relativeDepth(){return this._relativeDepth}get color(){return this._color}set color(t){this._color=t}get type(){return this._type}get leftSide(){return this._leftSide}get rightSide(){return this._rightSide}get location(){return this._location}get normal(){return this._normal}get hasTexture(){return this._hasTexture}set hasTexture(t){this._hasTexture=t}set rasterizer(t){this._rasterizer=t}set maskManager(t){this._maskManager=t}set id(t){t!==this._id&&(this.resetTextureCache(),this._id=t)}get uniqueId(){return this._uniqueId}dispose(){this._activeTexture=null,this._location=null,this._origin=null,this._leftSide=null,this._rightSide=null,this._normal=null,this._rasterizer=null,this._cornerA=null,this._cornerB=null,this._cornerC=null,this._cornerD=null,this._bitmapMasks=null,this._rectangleMasks=null,this._maskPixels=null,this._maskBitmapData&&(this._maskBitmapData.destroy(!0),this._maskBitmapData=null),this._disposed=!0}copyBitmapData(t){return!this.visible||!this._bitmapData||!t||this._bitmapData.width!==t.width||this._bitmapData.height!==t.height?null:t}resetTextureCache(t=null){this._activeTexture=null}getTextureIdentifier(t){return this._rasterizer?this._rasterizer.getTextureIdentifier(t,this.normal):t.toString()}needsNewTexture(t,e){if(!t)return!1;const s=this._activeTexture;return this.updateMaskChangeStatus(),!!(this._canBeVisible&&(!s||s.timeStamp>=0&&e>s.timeStamp||this._maskChanged))}getTexture(t,e){if(!t)return null;let s=null;if(this.needsNewTexture(t,e)){this.getTextureIdentifier(t.scale);const i=this._leftSide.length*t.scale,r=this._rightSide.length*t.scale,a=t.getCoordinatePosition(this._normal);s=this._rasterizer.render(this._uniqueId.toString(),this._textureCache,null,this._id,i,r,t.scale,a,this._hasTexture,this._textureOffsetX,this._textureOffsetY,this._textureMaxX,this._textureMaxY,e),s&&this.updateMask(s.texture,t)}else this._activeTexture&&(s=this._activeTexture);return s?(this._activeTexture=s,s.texture):null}resolveMasks(t){if(!this._useMask)return null;const e=new Br,s=0;for(;s<this._bitmapMasks.length;){const i=this._bitmapMasks[s];if(i){const r=this._maskManager.getMask(i.type);if(r){const a=r.getAssetName(t.scale);if(a){const o=t.getCoordinatePosition(this._normal),_=r.getGraphicAsset(t.scale,o);if(_){const l=this._maskBitmapData.width*(1-i.leftSideLoc/this._leftSide.length),c=this._maskBitmapData.height*(1-i.rightSideLoc/this._rightSide.length);e.addMask(a,new Y(l+_.offsetX,c+_.offsetY),_.flipH,_.flipV)}}}}}return e}screenWidth(t){const e=t.getScreenPoint(new R(0,0,0)),s=t.getScreenPoint(new R(0,1,0));return Math.round(this._leftSide.length*Math.abs(e.x-s.x))}getDrawingDatas(t){const e=[];if(this._isVisible){const s=this.resolveMasks(t),i=this._rasterizer.getLayers(this._id);for(const r of i)if(this._hasTexture&&r.getMaterial()){const a=t.getCoordinatePosition(this._normal),o=r.getMaterial().getMaterialCellMatrix(a),_=new Br(s,Ks.blend(this._color,r.getColor()),o.isBottomAligned());or.setSeed(this._randomSeed);for(const l of o.getColumns(this.screenWidth(t))){const c=[];for(const d of l.getCells()){const E=d.getAssetName(a);E&&c.push(E)}c.length>0&&(l.isRepeated()||c.push(""),_.addAssetColumn(c))}_.assetNameColumns.length>0&&e.push(_)}else{const a=new Br(s,Ks.blend(this._color,r.getColor()));e.push(a)}e.length||e.push(new Br(s,this._color))}return e}update(t,e){if(!t||this._disposed)return!1;let s=!1;if(this._geometryUpdateId!=t.updateId&&(s=!0),(!s||!this._canBeVisible)&&!this.visible)return!1;if(s){this._activeTexture=null;let i=0;if(i=R.cosAngle(t.directionAxis,this.normal),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;let r=0;for(;r<this._secondaryNormals.length;){if(i=R.cosAngle(t.directionAxis,this._secondaryNormals[r]),i>-.001)return this._isVisible?(this._isVisible=!1,!0):!1;r++}this.updateCorners(t);const o=t.getScreenPosition(this._origin).z;let _=Math.max(this._cornerA.z,this._cornerB.z,this._cornerC.z,this._cornerD.z)-o;this._type===Ks.TYPE_FLOOR&&(_=_-(this._location.z+Math.min(0,this._leftSide.z,this._rightSide.z))*8),this._type===Ks.TYPE_LANDSCAPE&&(_=_+.02),this._relativeDepth=_,this._isVisible=!0,this._geometryUpdateId=t.updateId}if(s||this.needsNewTexture(t,e)){if(!this._bitmapData||this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData)if(this._width!==this._bitmapData.width||this._height!==this._bitmapData.height){if(this._bitmapData.destroy(),this._bitmapData=null,this._width<1||this._height<1)return!0;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}else{if(this._width<1||this._height<1)return this._bitmapData.destroy(),this._bitmapData=null,!0;this._textureCache.clearAndFillRenderTexture(this._bitmapData)}else{if(this._width<1||this._height<1)return!1;this._bitmapData=this._textureCache.createAndFillRenderTexture(this._width,this._height)}if(!this._bitmapData)return!1}else this._textureCache.clearAndFillRenderTexture(this._bitmapData);or.setSeed(this._randomSeed);const i=this.getTexture(t,e);if(i)this.renderTexture(t,i);else return this.dispose(),!1;return i!==null||s}return!1}updateCorners(t){this._cornerA.assign(t.getScreenPosition(this._location)),this._cornerB.assign(t.getScreenPosition(R.sum(this._location,this._rightSide))),this._cornerC.assign(t.getScreenPosition(R.sum(R.sum(this._location,this._leftSide),this._rightSide))),this._cornerD.assign(t.getScreenPosition(R.sum(this._location,this._leftSide))),this._offset=t.getScreenPoint(this._origin),this._cornerA.x=Math.round(this._cornerA.x),this._cornerA.y=Math.round(this._cornerA.y),this._cornerB.x=Math.round(this._cornerB.x),this._cornerB.y=Math.round(this._cornerB.y),this._cornerC.x=Math.round(this._cornerC.x),this._cornerC.y=Math.round(this._cornerC.y),this._cornerD.x=Math.round(this._cornerD.x),this._cornerD.y=Math.round(this._cornerD.y),this._offset.x=Math.round(this._offset.x),this._offset.y=Math.round(this._offset.y);const e=Math.min(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x),s=Math.max(this._cornerA.x,this._cornerB.x,this._cornerC.x,this._cornerD.x)-e,i=Math.min(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y),r=Math.max(this._cornerA.y,this._cornerB.y,this._cornerC.y,this._cornerD.y)-i;this._offset.x=this._offset.x-e,this._cornerA.x=this._cornerA.x-e,this._cornerB.x=this._cornerB.x-e,this._cornerC.x=this._cornerC.x-e,this._cornerD.x=this._cornerD.x-e,this._offset.y=this._offset.y-i,this._cornerA.y=this._cornerA.y-i,this._cornerB.y=this._cornerB.y-i,this._cornerC.y=this._cornerC.y-i,this._cornerD.y=this._cornerD.y-i,this._width=s,this._height=r}getMatrixForDimensions(t,e){let s=this._cornerD.x-this._cornerC.x,i=this._cornerD.y-this._cornerC.y,r=this._cornerB.x-this._cornerC.x,a=this._cornerB.y-this._cornerC.y;(this._type===Ks.TYPE_WALL||this._type===Ks.TYPE_LANDSCAPE)&&(Math.abs(r-t)<=1&&(r=t),Math.abs(a-t)<=1&&(a=t),Math.abs(s-e)<=1&&(s=e),Math.abs(i-e)<=1&&(i=e));const o=r/t,_=a/t,l=s/e,c=i/e,d=new ue(o,_,l,c);return d.translate(this._cornerC.x,this._cornerC.y),d}renderTexture(t,e){this._cornerA==null||this._cornerB==null||this._cornerC==null||this._cornerD==null||e==null||this._bitmapData==null||this.draw(e,this.getMatrixForDimensions(e.width,e.height))}draw(t,e){this._textureCache.writeToRenderTexture(new Mt(t),this._bitmapData,!0,e)}resetBitmapMasks(){this._disposed||!this._useMask||!this._bitmapMasks.length||(this._maskChanged=!0,this._bitmapMasks=[])}addBitmapMask(t,e,s){if(!this._useMask)return!1;for(const r of this._bitmapMasks)if(r&&r.type===t&&r.leftSideLoc===e&&r.rightSideLoc===s)return!1;const i=new Uu(t,e,s);return this._bitmapMasks.push(i),this._maskChanged=!0,!0}resetRectangleMasks(){!this._useMask||!this._rectangleMasks.length||(this._maskChanged=!0,this._rectangleMasks=[])}addRectangleMask(t,e,s,i){if(this._useMask){for(const a of this._rectangleMasks)if(a&&a.leftSideLoc===t&&a.rightSideLoc===e&&a.leftSideLength===s&&a.rightSideLength===i)return!1;const r=new vu(t,e,s,i);return this._rectangleMasks.push(r),this._maskChanged=!0,!0}return!1}updateMaskChangeStatus(){if(!this._maskChanged)return;let t=!0;if(this._bitmapMasks.length===this._bitmapMasksOld.length)for(const e of this._bitmapMasks){if(!e)continue;let s=!1;for(const i of this._bitmapMasksOld)if(i&&i.type===e.type&&i.leftSideLoc===e.leftSideLoc&&i.rightSideLoc===e.rightSideLoc){s=!0;break}if(!s){t=!1;break}}else t=!1;this._rectangleMasks.length>this._rectangleMasksOld.length&&(t=!1),t&&(this._maskChanged=!1)}updateMask(t,e){if(!t||!e||!this._useMask||!this._bitmapMasks.length&&!this._rectangleMasks.length&&!this._maskChanged||!this._maskManager)return;const s=t.width,i=t.height;if(this.updateMaskChangeStatus(),(!this._maskBitmapData||this._maskBitmapData.width!==s||this._maskBitmapData.height!==i)&&(this._maskBitmapData=this._textureCache.createAndFillRenderTexture(s,i,"mask"),this._maskChanged=!0),this._maskChanged){this._bitmapMasksOld=[],this._rectangleMasksOld=[],this._maskBitmapData&&this._textureCache.clearAndFillRenderTexture(this._maskBitmapData),this.resetTextureCache(t);const r=e.getCoordinatePosition(this._normal);let a=null,o=0,_=0,l=0;for(;l<this._bitmapMasks.length;){const c=this._bitmapMasks[l];c&&(a=c.type,o=this._maskBitmapData.width-this._maskBitmapData.width*c.leftSideLoc/this._leftSide.length,_=this._maskBitmapData.height-this._maskBitmapData.height*c.rightSideLoc/this._rightSide.length,this._maskManager.updateMask(this._maskBitmapData,a,e.scale,r,o,_),this._bitmapMasksOld.push(new Uu(a,c.leftSideLoc,c.rightSideLoc))),l++}for(l=0;l<this._rectangleMasks.length;){const c=this._rectangleMasks[l];if(c){o=this._maskBitmapData.width-this._maskBitmapData.width*c.leftSideLoc/this._leftSide.length,_=this._maskBitmapData.height-this._maskBitmapData.height*c.rightSideLoc/this._rightSide.length;const d=this._maskBitmapData.width*c.leftSideLength/this._leftSide.length,E=this._maskBitmapData.height*c.rightSideLength/this._rightSide.length,I=new Mt(Ct.WHITE);I.tint=0,I.width=d,I.height=E,I.position.set(o-d,_-E),this._textureCache.writeToRenderTexture(I,this._maskBitmapData,!1),this._rectangleMasksOld.push(new vu(c.leftSideLength,c.rightSideLoc,c.leftSideLength,c.rightSideLength))}l++}this._maskPixels=this._textureCache.getPixels(this._maskBitmapData),this._maskChanged=!1}this.combineTextureMask(t,this._maskPixels)}combineTextureMask(t,e){var a,o;if(!t||!e)return;const s=this._textureCache.getPixels(t);for(let _=0;_<s.length;_+=4){const l=e[_],c=e[_+1],d=e[_+2];e[_+3],!l&&!c&&!d&&(s[_+3]=0)}const i=(a=t.baseTexture._glTextures[1])==null?void 0:a.texture,r=(o=zt.instance.renderer)==null?void 0:o.gl;!i||!r||(r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,t.width,t.height,0,r.RGBA,r.UNSIGNED_BYTE,s),r.bindTexture(r.TEXTURE_2D,null))}};xi.ZERO_POINT=new Y(0,0);xi.TYPE_UNDEFINED=0;xi.TYPE_WALL=1;xi.TYPE_FLOOR=2;xi.TYPE_LANDSCAPE=3;xi._uniqueIdCounter=1;let gt=xi;class Ff extends ge{constructor(){super(),this._wallRasterizer=new uV,this._floorRasterizer=new hV,this._landscapeRasterizer=new bf,this._maskManager=new nV,this._initialized=!1}initialize(t){if(!t.roomVisualization)return!1;const e=t.roomVisualization.wallData;e&&this._wallRasterizer.initialize(e);const s=t.roomVisualization.floorData;s&&this._floorRasterizer.initialize(s);const i=t.roomVisualization.landscapeData;i&&this._landscapeRasterizer.initialize(i);const r=t.roomVisualization.maskData;return r&&this._maskManager.initialize(r),!0}onDispose(){this._wallRasterizer&&(this._wallRasterizer.dispose(),this._wallRasterizer=null),this._floorRasterizer&&(this._floorRasterizer.dispose(),this._floorRasterizer=null),this._landscapeRasterizer&&(this._landscapeRasterizer.dispose(),this._landscapeRasterizer=null),this._maskManager&&(this._maskManager.dispose(),this._maskManager=null),super.onDispose()}setGraphicAssetCollection(t){this._initialized||(this._wallRasterizer.initializeAssetCollection(t),this._floorRasterizer.initializeAssetCollection(t),this._landscapeRasterizer.initializeAssetCollection(t),this._maskManager.initializeAssetCollection(t),this._initialized=!0)}clearCache(){this._wallRasterizer&&this._wallRasterizer.clearCache(),this._floorRasterizer&&this._floorRasterizer.clearCache(),this._landscapeRasterizer&&this._landscapeRasterizer.clearCache()}get wallRasterizer(){return this._wallRasterizer}get floorRasterizer(){return this._floorRasterizer}get landscapeRasterizer(){return this._landscapeRasterizer}get maskManager(){return this._maskManager}}const ve=class Wt extends ba{constructor(){super(),this._data=null,this._roomPlaneParser=new jt,this._roomPlaneBitmapMaskParser=new _f,this._geometryUpdateId=-1,this._directionX=0,this._directionY=0,this._directionZ=0,this._floorThickness=1,this._wallThickness=1,this._holeUpdateTime=NaN,this._planes=[],this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],this._roomScale=0,this._lastUpdateTime=-1e3,this._updateIntervalTime=250,this._wallType=null,this._floorType=null,this._landscapeType=null,this._colorBackgroundOnly=!0,this._color=16777215,this._redColor=255,this._greenColor=255,this._blueColor=255,this._typeVisibility=[],this._assetUpdateCounter=0,this._maskData=null,this._isPlaneSet=!1,this._textureCache=new Rm,this._typeVisibility[gt.TYPE_UNDEFINED]=!1,this._typeVisibility[gt.TYPE_FLOOR]=!0,this._typeVisibility[gt.TYPE_WALL]=!0,this._typeVisibility[gt.TYPE_LANDSCAPE]=!0}initialize(t){return t instanceof Ff?(this._data=t,super.initialize(t),this._data.setGraphicAssetCollection(this.asset),!0):!1}dispose(){super.dispose(),this.clearPlanes(),this._planes=null,this._visiblePlanes=null,this._visiblePlaneSpriteNumbers=null,this._roomPlaneParser&&(this._roomPlaneParser.dispose(),this._roomPlaneParser=null),this._roomPlaneBitmapMaskParser&&(this._roomPlaneBitmapMaskParser.dispose(),this._roomPlaneBitmapMaskParser=null),this._data&&(this._data.clearCache(),this._data=null),this._textureCache&&this._textureCache.clearCache()}reset(){super.reset(),this._floorType=null,this._wallType=null,this._landscapeType=null,this._maskData=null,this._geometryUpdateId=-1,this._roomScale=0}update(t,e,s,i){if(!this.object||!t)return;const r=this.updateGeometry(t),a=this.object.model;let o=!1;if(this.updateThickness(a)&&(o=!0),this.updateHole(a)&&(o=!0),this.initializeRoomPlanes(),o=this.updateMasks(a),!(e<this._lastUpdateTime+this._updateIntervalTime&&!r&&!o)){if(this.updatePlaneTexturesAndVisibilities(a)&&(o=!0),this.updatePlanes(t,r,e)&&(o=!0),o){let _=0;for(;_<this._visiblePlanes.length;){const l=this._visiblePlaneSpriteNumbers[_],c=this.getSprite(l),d=this._visiblePlanes[_];if(c&&d&&d.type!==gt.TYPE_LANDSCAPE)if(this._colorBackgroundOnly){let E=d.color;const I=(E&255)*this._redColor/255,m=(E>>8&255)*this._greenColor/255,T=(E>>16&255)*this._blueColor/255;E=(E>>24<<24)+(T<<16)+(m<<8)+I,c.color=E}else c.color=d.color;_++}this.updateSpriteCounter++}this.updateModelCounter=a.updateCounter,this._lastUpdateTime=e}}updateGeometry(t){if(!t||this._geometryUpdateId===t.updateId)return!1;this._geometryUpdateId=t.updateId,this._boundingRectangle=null;const e=t.direction;return e&&(e.x!==this._directionX||e.y!==this._directionY||e.z!==this._directionZ||t.scale!==this._roomScale)?(this._directionX=e.x,this._directionY=e.y,this._directionZ=e.z,this._roomScale=t.scale,!0):!1}updateThickness(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(g.ROOM_FLOOR_THICKNESS),s=t.getValue(g.ROOM_WALL_THICKNESS);return!isNaN(e)&&!isNaN(s)&&(e!==this._floorThickness||s!==this._wallThickness)?(this._floorThickness=e,this._wallThickness=s,this.clearPlanes(),!0):!1}updateHole(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(g.ROOM_FLOOR_HOLE_UPDATE_TIME);return!isNaN(e)&&e!==this._holeUpdateTime?(this._holeUpdateTime=e,this.clearPlanes(),!0):!1}updateMasks(t){if(this.updateModelCounter===t.updateCounter)return!1;let e=!1;const s=t.getValue(g.ROOM_PLANE_MASK_XML);s!==this._maskData&&(this.updatePlaneMasks(s),this._maskData=s,e=!0);const i=t.getValue(g.ROOM_BACKGROUND_COLOR);i!==this._color&&(this._color=i,this._redColor=this._color&255,this._greenColor=this._color>>8&255,this._blueColor=this._color>>16&255,e=!0);const r=t.getValue(g.ROOM_COLORIZE_BG_ONLY)||!1;return r!==this._colorBackgroundOnly&&(this._colorBackgroundOnly=r,e=!0),e}updatePlaneTexturesAndVisibilities(t){if(this.updateModelCounter===t.updateCounter)return!1;const e=t.getValue(g.ROOM_FLOOR_TYPE),s=t.getValue(g.ROOM_WALL_TYPE),i=t.getValue(g.ROOM_LANDSCAPE_TYPE),r=t.getValue(g.ROOM_FLOOR_VISIBILITY)===1,a=t.getValue(g.ROOM_WALL_VISIBILITY)===1,o=t.getValue(g.ROOM_LANDSCAPE_VISIBILITY)===1;return this.updatePlaneTypes(e,s,i)||this.updatePlaneVisibility(r,a,o)}clearPlanes(){if(this._planes){for(;this._planes.length;){const t=this._planes[0];t&&t.dispose(),this._planes.pop()}this._planes=[],this._planes=[]}this._isPlaneSet=!1,this._assetUpdateCounter=this._assetUpdateCounter+1,this.reset()}initializeRoomPlanes(){if(!this.object||this._isPlaneSet)return;isNaN(this._floorThickness)||(this._roomPlaneParser.floorThicknessMultiplier=this._floorThickness),isNaN(this._wallThickness)||(this._roomPlaneParser.wallThicknessMultiplier=this._wallThickness);const t=this.object.model.getValue(g.ROOM_MAP_DATA);if(!this._roomPlaneParser.initializeFromMapData(t))return;const e=this.getLandscapeWidth(),s=this.getLandscapeHeight();let i=0,r=this.object.model.getValue(g.ROOM_RANDOM_SEED),a=0;for(;a<this._roomPlaneParser.planeCount;){const o=this._roomPlaneParser.getPlaneLocation(a),_=this._roomPlaneParser.getPlaneLeftSide(a),l=this._roomPlaneParser.getPlaneRightSide(a),c=this._roomPlaneParser.getPlaneSecondaryNormals(a),d=this._roomPlaneParser.getPlaneType(a);let E=null;if(o&&_&&l){const I=R.crossProduct(_,l);if(r=kf(Math.trunc(r*7613+517)>>>0),E=null,d===Ot.PLANE_FLOOR){const m=o.x+_.x+.5,T=o.y+l.y+.5,p=Math.trunc(m)-m,A=Math.trunc(T)-T;E=new gt(this._textureCache,this.object.getLocation(),o,_,l,gt.TYPE_FLOOR,!0,c,r,-p,-A),I.z!==0?E.color=Wt.FLOOR_COLOR:E.color=I.x!==0?Wt.FLOOR_COLOR_RIGHT:Wt.FLOOR_COLOR_LEFT,this._data&&(E.rasterizer=this._data.floorRasterizer)}else d===Ot.PLANE_WALL?(E=new gt(this._textureCache,this.object.getLocation(),o,_,l,gt.TYPE_WALL,!0,c,r),(_.length<1||l.length<1)&&(E.hasTexture=!1),I.x===0&&I.y===0?E.color=Wt.WALL_COLOR_BORDER:I.y>0?E.color=Wt.WALL_COLOR_TOP:I.y===0?E.color=Wt.WALL_COLOR_SIDE:E.color=Wt.WALL_COLOR_BOTTOM,this._data&&(E.rasterizer=this._data.wallRasterizer)):d===Ot.PLANE_LANDSCAPE?(E=new gt(this._textureCache,this.object.getLocation(),o,_,l,gt.TYPE_LANDSCAPE,!0,c,r,i,0,e,s),I.y>0?E.color=Wt.LANDSCAPE_COLOR_TOP:I.y==0?E.color=Wt.LANDSCAPE_COLOR_SIDE:E.color=Wt.LANDSCAPE_COLOR_BOTTOM,this._data&&(E.rasterizer=this._data.landscapeRasterizer),i=i+_.length):d==Ot.PLANE_BILLBOARD&&(E=new gt(this._textureCache,this.object.getLocation(),o,_,l,gt.TYPE_WALL,!0,c,r),(_.length<1||l.length<1)&&(E.hasTexture=!1),I.x==0&&I.y==0?E.color=Wt.WALL_COLOR_BORDER:I.y>0?E.color=Wt.WALL_COLOR_TOP:I.y==0?E.color=Wt.WALL_COLOR_SIDE:E.color=Wt.WALL_COLOR_BOTTOM);if(E){E.maskManager=this._data.maskManager;let m=0;for(;m<this._roomPlaneParser.getPlaneMaskCount(a);){const T=this._roomPlaneParser.getPlaneMaskLeftSideLoc(a,m),p=this._roomPlaneParser.getPlaneMaskRightSideLoc(a,m),A=this._roomPlaneParser.getPlaneMaskLeftSideLength(a,m),N=this._roomPlaneParser.getPlaneMaskRightSideLength(a,m);E.addRectangleMask(T,p,A,N),m++}this._planes.push(E)}}else return;a++}this._isPlaneSet=!0,this.defineSprites()}defineSprites(){this.createSprites(this._planes.length);let t=0;for(;t<this._planes.length;){const e=this._planes[t],s=this.getSprite(t);e&&s&&e.leftSide&&e.rightSide&&(e.type===gt.TYPE_WALL&&(e.leftSide.length<1||e.rightSide.length<1)?s.alphaTolerance=Ne.MATCH_NOTHING:s.alphaTolerance=Ne.MATCH_OPAQUE_PIXELS,e.type===gt.TYPE_WALL?s.tag="plane.wall@"+(t+1):e.type===gt.TYPE_FLOOR?s.tag="plane.floor@"+(t+1):s.tag="plane@"+(t+1),s.spriteType=he.ROOM_PLANE),t++}}getLandscapeWidth(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===Ot.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneLeftSide(e);t+=i.length}e++}return t}getLandscapeHeight(){let t=0,e=0;for(;e<this._roomPlaneParser.planeCount;){if(this._roomPlaneParser.getPlaneType(e)===Ot.PLANE_LANDSCAPE){const i=this._roomPlaneParser.getPlaneRightSide(e);i.length>t&&(t=i.length)}e++}return t>5&&(t=5),t}updatePlaneTypes(t,e,s){if(t!==this._floorType?this._floorType=t:t=null,e!==this._wallType?this._wallType=e:e=null,s!==this._landscapeType?this._landscapeType=s:s=null,!t&&!e&&!s)return!1;let i=0;for(;i<this._planes.length;){const r=this._planes[i];r&&(r.type===gt.TYPE_FLOOR&&t?r.id=t:r.type===gt.TYPE_WALL&&e?r.id=e:r.type===gt.TYPE_LANDSCAPE&&s&&(r.id=s)),i++}return!0}updatePlaneVisibility(t,e,s){return t===this._typeVisibility[gt.TYPE_FLOOR]&&e===this._typeVisibility[gt.TYPE_WALL]&&s===this._typeVisibility[gt.TYPE_LANDSCAPE]?!1:(this._typeVisibility[gt.TYPE_FLOOR]=t,this._typeVisibility[gt.TYPE_WALL]=e,this._typeVisibility[gt.TYPE_LANDSCAPE]=s,this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[],!0)}updatePlanes(t,e,s){if(!t||!this.object)return!1;this._assetUpdateCounter++,e&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[]);const i=this._visiblePlanes.length>0;let r=this._visiblePlanes;this._visiblePlanes.length||(r=this._planes);let a=0,o=!1,_=0;for(;_<r.length;){let l=_;i&&(l=this._visiblePlaneSpriteNumbers[_]);const c=this.getSprite(l);if(c){const d=r[_];d?(c.id=d.uniqueId,d.update(t,s)&&(d.visible&&(a=d.relativeDepth+this.floorRelativeDepth+l/1e3,d.type!==gt.TYPE_FLOOR&&(a=d.relativeDepth+this.wallRelativeDepth+l/1e3,(d.leftSide.length<1||d.rightSide.length<1)&&(a=a+Wt.ROOM_DEPTH_OFFSET*.5)),this.updateSprite(c,t,d,`plane ${l} ${t.scale}`,a)),o=!0),c.visible!=(d.visible&&this._typeVisibility[d.type])&&(c.visible=!c.visible,o=!0),c.visible&&(i||(this._visiblePlanes.push(d),this._visiblePlaneSpriteNumbers.push(_)))):(c.id=0,c.visible&&(c.visible=!1,o=!0))}_++}return o}updatePlaneMasks(t){if(!t)return;this._roomPlaneBitmapMaskParser.initialize(t);const e=[],s=[];let i=!1,r=0;for(;r<this._planes.length;){const a=this._planes[r];a&&(a.resetBitmapMasks(),a.type===gt.TYPE_LANDSCAPE&&e.push(r)),r++}for(const a of this._roomPlaneBitmapMaskParser.masks.values()){const o=this._roomPlaneBitmapMaskParser.getMaskType(a),_=this._roomPlaneBitmapMaskParser.getMaskLocation(a),l=this._roomPlaneBitmapMaskParser.getMaskCategory(a);if(_){let c=0;for(;c<this._planes.length;){const d=this._planes[c];if((d.type===gt.TYPE_WALL||d.type===gt.TYPE_LANDSCAPE)&&d&&d.location&&d.normal){const E=R.dif(_,d.location);if(Math.abs(R.scalarProjection(E,d.normal))<.01&&d.leftSide&&d.rightSide){const m=R.scalarProjection(E,d.leftSide),T=R.scalarProjection(E,d.rightSide);d.type===gt.TYPE_WALL||d.type===gt.TYPE_LANDSCAPE&&l===Ai.HOLE?d.addBitmapMask(o,m,T):d.type===gt.TYPE_LANDSCAPE&&(d.canBeVisible||(i=!0),d.canBeVisible=!0,s.push(c))}}c++}}}for(r=0;r<e.length;){const a=e[r];if(s.indexOf(a)<0){const o=this._planes[a];o.canBeVisible=!1,i=!0}r++}i&&(this._visiblePlanes=[],this._visiblePlaneSpriteNumbers=[])}updateSprite(t,e,s,i,r){const a=s.offset;t.offsetX=-a.x,t.offsetY=-a.y,t.relativeDepth=r,t.color=s.color,t.texture=s.bitmapData,t.name=i+"_"+this._assetUpdateCounter}getBoundingRectangle(){return this._boundingRectangle||(this._boundingRectangle=super.getBoundingRectangle()),new de(this._boundingRectangle.x,this._boundingRectangle.y,this._boundingRectangle.width,this._boundingRectangle.height)}get planes(){const t=[];for(const e of this._visiblePlanes)t.push(e);return t}get floorRelativeDepth(){return Wt.ROOM_DEPTH_OFFSET+.1}get wallRelativeDepth(){return Wt.ROOM_DEPTH_OFFSET+.5}};ve.FLOOR_COLOR=16777215;ve.FLOOR_COLOR_LEFT=14540253;ve.FLOOR_COLOR_RIGHT=12303291;ve.WALL_COLOR_TOP=16777215;ve.WALL_COLOR_SIDE=13421772;ve.WALL_COLOR_BOTTOM=10066329;ve.WALL_COLOR_BORDER=10066329;ve.LANDSCAPE_COLOR_TOP=16777215;ve.LANDSCAPE_COLOR_SIDE=13421772;ve.LANDSCAPE_COLOR_BOTTOM=10066329;ve.ROOM_DEPTH_OFFSET=1e3;let lV=ve;class cV extends xt{constructor(){super(),this._tileHeight=0}getLayerYOffset(t,e,s){return s===1?(this._tileHeight=this.object.model.getValue(g.TILE_CURSOR_HEIGHT),-this._tileHeight*32):super.getLayerYOffset(t,e,s)}}const xf=class Gf{constructor(){this._visualizationDatas=new Map}getVisualization(t){const e=this.getVisualizationType(t);return e?new e:null}getVisualizationType(t){if(!t)return null;let e=null;switch(t){case P.ROOM:e=lV;break;case P.TILE_CURSOR:e=cV;break;case P.USER:case P.BOT:case P.RENTABLE_BOT:e=OH;break;case P.PET_ANIMATED:e=iV;break;case P.FURNITURE_STATIC:e=bi;break;case P.FURNITURE_ANIMATED:e=xt;break;case P.FURNITURE_RESETTING_ANIMATED:e=kH;break;case P.FURNITURE_BADGE_DISPLAY:e=CH;break;case P.FURNITURE_BG:e=KH;break;case P.FURNITURE_BB:e=Tf;break;case P.FURNITURE_ISOMETRIC_BB:e=wH;break;case P.FURNITURE_BOTTLE:e=NH;break;case P.FURNITURE_BUILDER_PLACEHOLDER:e=DH;break;case P.FURNITURE_COUNTER_CLOCK:e=PH;break;case P.FURNITURE_CUBOID:e=yH;break;case P.FURNITURE_EXTERNAL_IMAGE:e=LH;break;case P.FURNITURE_FIREWORKS:e=Sf;break;case P.FURNITURE_GIFT_WRAPPED_FIREWORKS:e=bH;break;case P.FURNITURE_GIFT_WRAPPED:e=FH;break;case P.FURNITURE_GUILD_CUSTOMIZED:e=xH;break;case P.FURNITURE_GUILD_ISOMETRIC_BADGE:e=GH;break;case P.FURNITURE_HABBOWHEEL:e=BH;break;case P.FURNITURE_MANNEQUIN:e=HH;break;case P.FURNITURE_PARTY_BEAMER:e=VH;break;case P.FURNITURE_PLANET_SYSTEM:e=zH;break;case P.FURNITURE_POSTER:e=YH;break;case P.FURNITURE_QUEUE_TILE:e=WH;break;case P.FURNITURE_SCORE_BOARD:e=XH;break;case P.FURNITURE_SOUNDBLOCK:e=qH;break;case P.FURNITURE_STICKIE:e=QH;break;case P.FURNITURE_VAL_RANDOMIZER:e=JH;break;case P.FURNITURE_VOTE_COUNTER:e=ZH;break;case P.FURNITURE_VOTE_MAJORITY:e=$H;break;case P.FURNITURE_WATER_AREA:e=tV;break;case P.FURNITURE_YOUTUBE:e=eV;break}return e||(G.log("Unknown Visualization",t),null)}getVisualizationData(t,e,s){const i=this._visualizationDatas.get(t);if(i)return i;let r=null;switch(e){case P.FURNITURE_STATIC:case P.FURNITURE_GIFT_WRAPPED:case P.FURNITURE_BB:case P.FURNITURE_ISOMETRIC_BB:case P.FURNITURE_BG:case P.FURNITURE_STICKIE:case P.FURNITURE_BUILDER_PLACEHOLDER:r=new bs;break;case P.FURNITURE_ANIMATED:case P.FURNITURE_RESETTING_ANIMATED:case P.FURNITURE_POSTER:case P.FURNITURE_HABBOWHEEL:case P.FURNITURE_VAL_RANDOMIZER:case P.FURNITURE_BOTTLE:case P.FURNITURE_PLANET_SYSTEM:case P.FURNITURE_QUEUE_TILE:case P.FURNITURE_PARTY_BEAMER:case P.FURNITURE_COUNTER_CLOCK:case P.FURNITURE_WATER_AREA:case P.FURNITURE_SCORE_BOARD:case P.FURNITURE_FIREWORKS:case P.FURNITURE_GIFT_WRAPPED_FIREWORKS:case P.FURNITURE_GUILD_CUSTOMIZED:case P.FURNITURE_GUILD_ISOMETRIC_BADGE:case P.FURNITURE_VOTE_COUNTER:case P.FURNITURE_VOTE_MAJORITY:case P.FURNITURE_SOUNDBLOCK:case P.FURNITURE_BADGE_DISPLAY:case P.FURNITURE_EXTERNAL_IMAGE:case P.FURNITURE_YOUTUBE:case P.TILE_CURSOR:r=new zh;break;case P.FURNITURE_MANNEQUIN:r=new J_;break;case P.ROOM:r=new Ff;break;case P.USER:case P.BOT:case P.RENTABLE_BOT:r=new Ia;break;case P.PET_ANIMATED:r=new yf;break}return r?r.initialize(s)?((r instanceof Ia||r instanceof J_)&&(r.avatarManager=H.instance.avatar),Gf.CACHING_ENABLED&&this._visualizationDatas.set(t,r),r):(r.dispose(),null):null}};xf.CACHING_ENABLED=!0;let dV=xf;class Rt{}Rt.ROOM_MIN_X="room_min_x";Rt.ROOM_MAX_X="room_max_x";Rt.ROOM_MIN_Y="room_min_y";Rt.ROOM_MAX_Y="room_max_y";Rt.ROOM_IS_PUBLIC="room_is_public";Rt.ROOM_Z_SCALE="room_z_scale";Rt.AD_DISPLAY_DELAY="ad_display_delay";Rt.IS_PLAYING_GAME="is_playing_game";Rt.RESTRICTS_DRAGGING="restricts_dragging";Rt.RESTRICTS_SCALING="restricts_scaling";Rt.RESTRICTED_SCALE="room_scale";class gV{constructor(t,e){this._width=t,this._height=e,this._heights=[],this._isNotStackable=[],this._isRoomTile=[];let s=t*e;for(;s>0;)this._heights.push(0),this._isNotStackable.push(!1),this._isRoomTile.push(!1),s--}dispose(){this._width=0,this._height=0,this._height=null,this._isNotStackable=null,this._isRoomTile=null}validPosition(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height}getTileHeight(t,e){return this.validPosition(t,e)?this._heights[e*this._width+t]:0}setTileHeight(t,e,s){this.validPosition(t,e)&&(this._heights[e*this._width+t]=s)}setStackingBlocked(t,e,s){this.validPosition(t,e)&&(this._isNotStackable[e*this._width+t]=s)}setIsRoomTile(t,e,s){this.validPosition(t,e)&&(this._isRoomTile[e*this._width+t]=s)}validateLocation(t,e,s,i,r,a,o,_,l,c=-1){let d=0,E=0;if(!this.validPosition(t,e)||!this.validPosition(t+s-1,e+i-1))return!1;(r<0||r>=this._width)&&(r=0),(a<0||a>=this._height)&&(a=0),o=Math.min(o,this._width-r),_=Math.min(_,this._height-a),c===-1&&(c=this.getTileHeight(t,e));let I=e;for(;I<e+i;){for(d=t;d<t+s;){if(d<r||d>=r+o||I<a||I>=a+_){if(E=I*this._width+d,l){if(!this._isRoomTile[E])return!1}else if(this._isNotStackable[E]||!this._isRoomTile[E]||Math.abs(this._heights[E]-c)>.01)return!1}d++}I++}return!0}get width(){return this._width}get height(){return this._height}}const uo=class Is{constructor(){this._isDisposed=!1,this._scale=64,this._heightMap=[],this._width=0,this._height=0,this._floorHeight=0}get disposed(){return this._isDisposed}get scale(){return this._scale}set scale(t){this._scale=t}dispose(){this.reset(),this._isDisposed=!0}initialize(t,e,s){if(t<=this._width&&e<=this._height){this._width=t,this._height=e,this._floorHeight=s;return}this.reset();let i=0;for(;i<e;){const r=[];this._heightMap.push(r);let a=0;for(;a<t;)r.push(0),a++;i++}this._width=t,this._height=e,this._floorHeight=s}reset(){this._heightMap=[]}setHeight(t,e,s){if(t<0||t>=this._width||e<0||e>=this._height)return!1;const i=this._heightMap[e];return i?(i[t]=s,!0):!1}getHeight(t,e){if(t<0||t>=this._width||e<0||e>=this._height)return 0;const s=this._heightMap[e];return s?s[t]:0}getLocation(t,e,s,i,r){if(t==0&&e==0){t=this._width,e=this._height;const c=Math.round(this.scale/10);if(r==Is.R){let d=this._width-1;for(;d>=0;){let E=1;for(;E<this._height;){if(this.getHeight(d,E)<=this._floorHeight){E-1<e&&(t=d,e=E-1);break}E++}d--}i=i+(this.scale/4-c/2),s=s+this.scale/2}else{let d=this._height-1;for(;d>=0;){let E=1;for(;E<this._width;){if(this.getHeight(E,d)<=this._floorHeight){E-1<t&&(t=E-1,e=d);break}E++}d--}i=i+(this.scale/4-c/2),s=s-c}}let a=t,o=e,_=this.getHeight(t,e);return r==Is.R?(a=a+(s/(this._scale/2)-.5),o=o+.5,_=_-(i-s/2)/(this._scale/2)):(o=o+((this._scale/2-s)/(this._scale/2)-.5),a=a+.5,_=_-(i-(this._scale/2-s)/2)/(this._scale/2)),new R(a,o,_)}getLocationOldFormat(t,e,s){let i,r,a=0,o=0;r=Math.ceil(t),a=r-t;let _,l,c,d=0;for(i=0;i<this._width;){if(r>=0&&r<this._height){if(this.getHeight(i,r)<=this._floorHeight){_=i-1,l=r,o=i,s=Is.L;break}if(this.getHeight(i,r+1)<=this._floorHeight){_=i,l=r,o=l-t,s=Is.R;break}}r++,i++}const E=this.scale/2*a;let I=-o*this.scale/2;return I=I+-e*18/32*this.scale/2,d=this.getHeight(_,l),c=d*this.scale/2+I,s==Is.R?c=c+a*this.scale/4:c=c+(1-a)*this.scale/4,this.getLocation(_,l,E,c,s)}getOldLocation(t,e){if(t==null)return null;let s=0,i=0,r=0,a=0,o="",_=0;if(e==90)s=Math.floor(t.x-.5),i=Math.floor(t.y+.5),_=this.getHeight(s,i),r=this._scale/2-(t.y-i+.5)*(this._scale/2),a=(_-t.z)*(this._scale/2)+(this._scale/2-r)/2,o=Is.L;else if(e==180)s=Math.floor(t.x+.5),i=Math.floor(t.y-.5),_=this.getHeight(s,i),r=(t.x+.5-s)*(this._scale/2),a=(_-t.z)*(this._scale/2)+r/2,o=Is.R;else return null;return[s,i,r,a,o]}getOldLocationString(t,e){const s=this.getOldLocation(t,e);if(s==null)return null;const i=Math.trunc(s[0]),r=Math.trunc(s[1]),a=Math.trunc(s[2]),o=Math.trunc(s[3]),_=s[4];return":w="+i+","+r+" l="+a+","+o+" "+_}getDirection(t){return t==Is.R?180:90}getFloorAltitude(t,e){const s=this.getHeight(t,e),i=s+1;return s+(Math.trunc(this.getHeight(t-1,e-1))==i||Math.trunc(this.getHeight(t,e-1))==i||Math.trunc(this.getHeight(t+1,e-1))==i||Math.trunc(this.getHeight(t-1,e))==i||Math.trunc(this.getHeight(t+1,e))==i||Math.trunc(this.getHeight(t-1,e+1))==i||Math.trunc(this.getHeight(t,e+1))==i||Math.trunc(this.getHeight(t+1,e+1))==i?.5:0)}isRoomTile(t,e){return t>=0&&t<this._width&&e>=0&&e<this._height&&this._heightMap[e][t]>=0}};uo.DEFAULT_SCALE=32;uo.L="l";uo.R="r";let Jh=uo;const Bf=class wf{constructor(){this._targetId=-1,this._targetCategory=-2,this._targetLoc=null,this._moveDistance=0,this._previousMoveSpeed=0,this._maintainPreviousMoveSpeed=!1,this._currentLoc=null,this._limitedLocX=!1,this._limitedLocY=!1,this._centeredLocX=!1,this._centeredLocY=!1,this._screenWd=0,this._screenHt=0,this._scale=0,this._roomWd=0,this._roomHt=0,this._geometryUpdateId=-1,this._scaleChanged=!1,this._targetObjectLoc=new R}get location(){return this._currentLoc}get targetId(){return this._targetId}set targetId(t){this._targetId=t}get targetCategory(){return this._targetCategory}set targetCategory(t){this._targetCategory=t}get targetObjectLoc(){return this._targetObjectLoc}set targetObjectLoc(t){this._targetObjectLoc.assign(t)}get limitedLocationX(){return this._limitedLocX}set limitedLocationX(t){this._limitedLocX=t}get limitedLocationY(){return this._limitedLocY}set limitedLocationY(t){this._limitedLocY=t}get centeredLocX(){return this._centeredLocX}set centeredLocX(t){this._centeredLocX=t}get centeredLocY(){return this._centeredLocY}set centeredLocY(t){this._centeredLocY=t}get screenWd(){return this._screenWd}set screenWd(t){this._screenWd=t}get screenHt(){return this._screenHt}set screenHt(t){this._screenHt=t}get scale(){return this._scale}set scale(t){this._scale!=t&&(this._scale=t,this._scaleChanged=!0)}get roomWd(){return this._roomWd}set roomWd(t){this._roomWd=t}get roomHt(){return this._roomHt}set roomHt(t){this._roomHt=t}get geometryUpdateId(){return this._geometryUpdateId}set geometryUpdateId(t){this._geometryUpdateId=t}get isMoving(){return this._targetLoc!=null&&this._currentLoc!=null}set target(t){let e;this._targetLoc==null&&(this._targetLoc=new R),(this._targetLoc.x!=t.x||this._targetLoc.y!=t.y||this._targetLoc.z!=t.z)&&(this._targetLoc.assign(t),e=R.dif(this._targetLoc,this._currentLoc),this._moveDistance=e.length,this._maintainPreviousMoveSpeed=!0)}dispose(){this._targetLoc=null,this._currentLoc=null}initializeLocation(t){this._currentLoc==null&&(this._currentLoc=new R,this._currentLoc.assign(t))}resetLocation(t){this._currentLoc==null&&(this._currentLoc=new R),this._currentLoc.assign(t)}update(t,e){let s,i,r,a,o;if(this._followDuration>0&&this._targetLoc!=null&&this._currentLoc!=null){if(this._scaleChanged){this._scaleChanged=!1,this._currentLoc=this._targetLoc,this._targetLoc=null;return}s=R.dif(this._targetLoc,this._currentLoc),s.length>this._moveDistance&&(this._moveDistance=s.length),s.length<=e?(this._currentLoc=this._targetLoc,this._targetLoc=null,this._previousMoveSpeed=0):(i=Math.sin(Math.PI*s.length/this._moveDistance),r=e*.5,a=this._moveDistance/wf.MOVE_SPEED_DENOMINATOR,o=r+(a-r)*i,this._maintainPreviousMoveSpeed&&(o<this._previousMoveSpeed?(o=this._previousMoveSpeed,o>s.length&&(o=s.length)):this._maintainPreviousMoveSpeed=!1),this._previousMoveSpeed=o,s.divide(s.length),s.multiply(o),this._currentLoc=R.sum(this._currentLoc,s))}}reset(){this._geometryUpdateId=-1}activateFollowing(t){this._followDuration=t}};Bf.MOVE_SPEED_DENOMINATOR=12;let EV=Bf;class bu{constructor(t,e){this._roomId=t,this._data=e,this._floorType=null,this._wallType=null,this._landscapeType=null}get roomId(){return this._roomId}get data(){return this._data}get floorType(){return this._floorType}set floorType(t){this._floorType=t}get wallType(){return this._wallType}set wallType(t){this._wallType=t}get landscapeType(){return this._landscapeType}set landscapeType(t){this._landscapeType=t}}class So{constructor(t,e,s,i,r,a,o,_=NaN,l=-1,c=0,d=0,E="",I=!0,m=!0,T=-1){this._id=t,this._typeId=e,this._type=s,this._state=a,this._data=o,this._extra=_,this._expiryTime=l,this._usagePolicy=c,this._ownerId=d,this._ownerName=E,this._synchronized=I,this._realRoomObject=m,this._sizeZ=T,this._location=new R,this._direction=new R,this._location.assign(i),this._direction.assign(r)}get id(){return this._id}get typeId(){return this._typeId}get type(){return this._type}get location(){return this._location}get direction(){return this._direction}get state(){return this._state}get data(){return this._data}get extra(){return this._extra}get expiryTime(){return this._expiryTime}get usagePolicy(){return this._usagePolicy}get ownerId(){return this._ownerId}get ownerName(){return this._ownerName}get synchronized(){return this._synchronized}get realRoomObject(){return this._realRoomObject}get sizeZ(){return this._sizeZ}}class fV{constructor(t,e){this._tileObjectMap=new Map;let s=0;for(;s<e;)this._tileObjectMap.set(s,new Map),s++;this._width=t,this._height=e}clear(){for(const t of this._tileObjectMap.values())t&&t.clear();this._tileObjectMap.clear()}populate(t){this.clear();for(const e of t)this.addRoomObject(e)}dispose(){this._tileObjectMap=null,this._width=0,this._height=0}getObjectIntTile(t,e){if(t>=0&&t<this._width&&e>=0&&e<this._height){const s=this._tileObjectMap.get(e);if(s)return s.get(t)}return null}setObjectInTile(t,e,s){if(!s.isReady){G.log("Assigning non initialized object to tile object map!");return}if(t>=0&&t<this._width&&e>=0&&e<this._height){const i=this._tileObjectMap.get(e);i&&i.set(t,s)}}addRoomObject(t){if(!t||!t.model||!t.isReady)return;const e=t.getLocation(),s=t.getDirection();if(!e||!s)return;let i=t.model.getValue(g.FURNITURE_SIZE_X),r=t.model.getValue(g.FURNITURE_SIZE_Y);i<1&&(i=1),r<1&&(r=1);const a=Math.trunc(s.x+45)%360/90;(a===1||a===3)&&([i,r]=[r,i]);let o=e.y;for(;o<e.y+r;){let _=e.x;for(;_<e.x+i;){const l=this.getObjectIntTile(_,o);(!l||l!==t&&l.getLocation().z<=e.z)&&this.setObjectInTile(_,o,t),_++}o++}}}class mV{constructor(t){this._roomId=t,this._modelName=null,this._legacyGeometry=new Jh,this._tileObjectMap=null,this._roomCamera=new EV,this._selectedObject=null,this._placedObject=null,this._furnitureStackingHeightMap=null,this._floorStack=new Map,this._wallStack=new Map,this._mouseButtonCursorOwners=[]}dispose(){}setModelName(t){this._modelName=t}setSelectedObject(t){this._selectedObject&&this._selectedObject.dispose(),this._selectedObject=t}setPlacedObject(t){this._placedObject&&this._placedObject.dispose(),this._placedObject=t}setFurnitureStackingHeightMap(t){this._furnitureStackingHeightMap&&this._furnitureStackingHeightMap.dispose(),this._furnitureStackingHeightMap=t,this._tileObjectMap&&this._tileObjectMap.dispose(),this._furnitureStackingHeightMap&&(this._tileObjectMap=new fV(this._furnitureStackingHeightMap.width,this._furnitureStackingHeightMap.height))}addPendingFurnitureFloor(t){t&&(this._floorStack.delete(t.id),this._floorStack.set(t.id,t))}removePendingFunitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getPendingFurnitureFloor(t){const e=this._floorStack.get(t);return e?(this._floorStack.delete(t),e):null}getNextPendingFurnitureFloor(){if(!this._floorStack.size)return null;const t=this._floorStack.keys();return this.getPendingFurnitureFloor(t.next().value)}addPendingFurnitureWall(t){t&&(this._wallStack.delete(t.id),this._wallStack.set(t.id,t))}removePendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getPendingFurnitureWall(t){const e=this._wallStack.get(t);return e?(this._wallStack.delete(t),e):null}getNextPendingFurnitureWall(){if(!this._wallStack.size)return null;const t=this._wallStack.keys();return this.getPendingFurnitureWall(t.next().value)}addButtonMouseCursorOwner(t){return this._mouseButtonCursorOwners.indexOf(t)===-1?(this._mouseButtonCursorOwners.push(t),!0):!1}removeButtonMouseCursorOwner(t){const e=this._mouseButtonCursorOwners.indexOf(t);return e>-1?(this._mouseButtonCursorOwners.splice(e,1),!0):!1}hasButtonMouseCursorOwners(){return this._mouseButtonCursorOwners.length>0}get roomId(){return this._roomId}get modelName(){return this._modelName}get legacyGeometry(){return this._legacyGeometry}get tileObjectMap(){return this._tileObjectMap}get roomCamera(){return this._roomCamera}get selectedObject(){return this._selectedObject}get placedObject(){return this._placedObject}get furnitureStackingHeightMap(){return this._furnitureStackingHeightMap}}class IV{constructor(t,e){this._object=t,this._groupBadge=e}get object(){return this._object}get groupBadge(){return this._groupBadge}}class Mo{constructor(t,e,s,i,r,a=0,o=null,_=null,l=-1,c=-1,d=null){this._id=0,this._category=0,this._operation="",this._loc=null,this._dir=null,this._typeId=0,this._instanceData=null,this._stuffData=null,this._state=-1,this._animFrame=-1,this._posture=null,this._id=t,this._category=e,this._operation=s,this._loc=new R,this._loc.assign(i),this._dir=new R,this._dir.assign(r),this._typeId=a,this._instanceData=o,this._stuffData=_,this._state=l,this._animFrame=c,this._posture=d}get id(){return this._id}get category(){return this._category}get operation(){return this._operation}get loc(){return this._loc}get dir(){return this._dir}get typeId(){return this._typeId}get instanceData(){return this._instanceData}get stuffData(){return this._stuffData}get state(){return this._state}get animFrame(){return this._animFrame}get posture(){return this._posture}dispose(){this._loc=null,this._dir=null}}const Cn=class $e{constructor(){this.spriteCount=0,this.externalImageCount=0}static addMannequinSprites(t,e){const s=[];for(const i of t)if(i)if(i.type==="boutique_mannequin1"&&i.name.indexOf("mannequin_")===0){const r=e.getRoomObject(e.activeRoomId,i.objectId,S.FLOOR);if(r){const a=r.visualization.getSpriteList();if(a)for(const o of a)o.x=o.x+(i.x+i.width/2+$e.MANNEQUIN_MAGIC_X_OFFSET),o.y=o.y+(i.y+i.height+$e.MANNEQUIN_MAGIC_Y_OFFSET),o.z=o.z+i.z,s.push(o)}}else s.push(i);return s}static sortSpriteDataObjects(t,e){return t.z<e.z?1:(t.z>e.z,-1)}static isSpriteInViewPort(t,e,s){return!0}static sortQuadPoints(t,e,s,i){const r=[];if(t.x==e.x?r.push(t,s,e,i):t.x==s.x?r.push(t,e,s,i):e.x<t.x&&e.y>t.y||e.x>t.x&&e.y<t.y?r.push(t,s,e,i):r.push(t,e,s,i),r[0].x<r[1].x){let a=r[0];r[0]=r[1],r[1]=a,a=r[2],r[2]=r[3],r[3]=a}if(r[0].y<r[2].y){let a=r[0];r[0]=r[2],r[2]=a,a=r[1],r[1]=r[3],r[3]=a}return r}getFurniData(t,e,s,i){const r=[];let a=e.getSortableSpriteList();const o=s.getRoomObjects(s.activeRoomId,S.UNIT);for(const _ of o)if(_.id!==i){const l=_.visualization.getSpriteList();if(l){let c=0,d=0;for(const I of a)if(I.name==="avatar_"+_.id){c=I.z,d=I.y+I.height-e.geometry.scale/4;break}const E=s.getRoomObjectScreenLocation(s.activeRoomId,_.id,S.UNIT,e.id);if(E){d===0&&(d=E.y);for(const I of l)I.x=I.x+(E.x-e.screenOffsetX),I.y=I.y+d,I.z=I.z+c,(I.name.indexOf("h_std_fx29_")===0||I.name.indexOf("h_std_fx185_")===0)&&(I.y=I.y+$e.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET),a.push(I)}}}a=$e.addMannequinSprites(a,s),a.sort($e.sortSpriteDataObjects);for(const _ of a)_.name!==null&&_.name.length>0&&_.name.indexOf("tile_cursor_")!==0&&$e.isSpriteInViewPort(_,t,e)&&(i<0||_.objectId!=i)&&(r.push(this.getSpriteDataObject(_,t,e,s)),this.maxZ||(this.maxZ=_.z),this.spriteCount++);return JSON.stringify(r)}getRoomRenderingModifiers(t){return JSON.stringify(new Object)}getSpriteDataObject(t,e,s,i){let r=[];const a={};let o=t.name;return t.name.indexOf("@")!==-1&&(r=t.name.split("@"),o=r[0],r[1]),a.name=o,a.x=t.x-e.x,a.y=t.y-e.y,a.x=a.x+s.screenOffsetX,a.y=a.y+s.screenOffsetY,a.z=t.z,t.alpha&&t.alpha.toString()!=="255"&&(a.alpha=t.alpha),t.flipH&&(a.flipH=t.flipH),t.skew&&(a.skew=t.skew),t.frame&&(a.frame=t.frame),t.color&&t.color.length>0&&(a.color=parseInt(t.color)),t.blendMode&&t.blendMode!=="normal"&&(a.blendMode=t.blendMode),o.indexOf("http")===0&&(a.width=t.width,a.height=t.height,this.externalImageCount++,this.externalImageCount>$e.MAX_EXTERNAL_IMAGE_COUNT&&(a.name="box")),t.posture&&(a.posture=t.posture),a}makeBackgroundPlane(t,e,s){const i=new Y(0,0),r=new Y(t.width,0),a=new Y(0,t.height),o=new Y(t.width,t.height),_=$e.sortQuadPoints(i,r,a,o);let l=0;s.length>0?(l=s[0].z,this.maxZ&&(l=Math.max(this.maxZ,l))):l=this.maxZ?this.maxZ:0,l=l+(this.spriteCount*1.776104+s.length*2.31743);const c=new Br(null,e);return c.cornerPoints=_,c.z=l,c}sortRoomPlanes(t,e,s){const i=new Map;let r=1;this.maxZ&&(r=r+this.maxZ);for(const _ of t){const l={plane:_,z:r};i.set(_.uniqueId,l)}const a=e.getPlaneSortableSprites();a.sort((_,l)=>l.z-_.z),a.reverse();let o=[];for(const _ of a){const l=_.sprite;if(l){const c=i.get(l.id);c&&(i.delete(l.id),c.z=_.z,o.push(c))}}return o=o.concat(Array.from(i.values())),o}getRoomPlanes(t,e,s,i){const r=[],o=s.getRoomObject(s.activeRoomId,Zh.ROOM_OBJECT_ID,S.ROOM).visualization;if(o){const _=e.geometry,l=this.sortRoomPlanes(o.planes,e,s),c=zt.instance.stage;for(const d of l){const E=d.plane,I=[],m=R.sum(E.location,E.leftSide),T=_.getScreenPoint(E.location),p=_.getScreenPoint(m),A=_.getScreenPoint(R.sum(E.location,E.rightSide)),N=_.getScreenPoint(R.sum(m,E.rightSide));I.push(T,p,A,N);let C=0,L=0;for(const D of I)D.x+=c.width/2,D.y+=c.height/2,D.x+=e.screenOffsetX,D.y+=e.screenOffsetY,D.x+=-t.x,D.y+=-t.y,D.x<0?C--:D.x>=t.width&&C++,D.y<0?L--:D.y>=t.height&&L++;if(!(Math.abs(C)===4||Math.abs(L)===4)){const D=$e.sortQuadPoints(T,p,A,N);for(const v of E.getDrawingDatas(_))v.cornerPoints=D,v.z=d.z,r.push(v)}}r.unshift(this.makeBackgroundPlane(t,i,r))}return r}};Cn.MANNEQUIN_MAGIC_X_OFFSET=1;Cn.MANNEQUIN_MAGIC_Y_OFFSET=-16;Cn.AVATAR_WATER_EFFECT_MAGIC_Y_OFFSET=-52;Cn.MAX_EXTERNAL_IMAGE_COUNT=30;let RV=Cn;class TV extends ge{constructor(t){super(),this._connection=null,this._roomCreator=t,this._planeParser=new jt,this._latestEntryTileEvent=null,this._currentRoomId=0,this._ownUserId=0,this._initialConnection=!0,this._guideId=-1,this._requesterId=-1}onDispose(){super.onDispose(),this._connection=null,this._roomCreator=null,this._latestEntryTileEvent=null,this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}setConnection(t){this._connection||!t||(this._connection=t,this._connection.addMessageEvent(new ca(this.onUserInfoEvent.bind(this))),this._connection.addMessageEvent(new rr(this.onRoomReadyMessageEvent.bind(this))),this._connection.addMessageEvent(new y_(this.onRoomPaintEvent.bind(this))),this._connection.addMessageEvent(new C_(this.onRoomModelEvent.bind(this))),this._connection.addMessageEvent(new D_(this.onRoomHeightMapEvent.bind(this))),this._connection.addMessageEvent(new P_(this.onRoomHeightMapUpdateEvent.bind(this))),this._connection.addMessageEvent(new L_(this.onRoomThicknessEvent.bind(this))),this._connection.addMessageEvent(new N_(this.onRoomDoorEvent.bind(this))),this._connection.addMessageEvent(new c_(this.onRoomRollingEvent.bind(this))),this._connection.addMessageEvent(new l_(this.onObjectsDataUpdateEvent.bind(this))),this._connection.addMessageEvent(new I_(this.onFurnitureAliasesEvent.bind(this))),this._connection.addMessageEvent(new g_(this.onFurnitureFloorAddEvent.bind(this))),this._connection.addMessageEvent(new E_(this.onFurnitureFloorEvent.bind(this))),this._connection.addMessageEvent(new f_(this.onFurnitureFloorRemoveEvent.bind(this))),this._connection.addMessageEvent(new m_(this.onFurnitureFloorUpdateEvent.bind(this))),this._connection.addMessageEvent(new O_(this.onFurnitureWallAddEvent.bind(this))),this._connection.addMessageEvent(new A_(this.onFurnitureWallEvent.bind(this))),this._connection.addMessageEvent(new S_(this.onFurnitureWallRemoveEvent.bind(this))),this._connection.addMessageEvent(new M_(this.onFurnitureWallUpdateEvent.bind(this))),this._connection.addMessageEvent(new R_(this.onFurnitureDataEvent.bind(this))),this._connection.addMessageEvent(new T_(this.onItemDataUpdateMessageEvent.bind(this))),this._connection.addMessageEvent(new p_(this.onOneWayDoorStatusMessageEvent.bind(this))),this._connection.addMessageEvent(new _a(this.onRoomUnitDanceEvent.bind(this))),this._connection.addMessageEvent(new v_(this.onRoomUnitEffectEvent.bind(this))),this._connection.addMessageEvent(new ha(this.onRoomUnitEvent.bind(this))),this._connection.addMessageEvent(new b_(this.onRoomUnitExpressionEvent.bind(this))),this._connection.addMessageEvent(new F_(this.onRoomUnitHandItemEvent.bind(this))),this._connection.addMessageEvent(new x_(this.onRoomUnitIdleEvent.bind(this))),this._connection.addMessageEvent(new ua(this.onRoomUnitInfoEvent.bind(this))),this._connection.addMessageEvent(new G_(this.onRoomUnitNumberEvent.bind(this))),this._connection.addMessageEvent(new la(this.onRoomUnitRemoveEvent.bind(this))),this._connection.addMessageEvent(new B_(this.onRoomUnitStatusEvent.bind(this))),this._connection.addMessageEvent(new Nh(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new aa(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new oa(this.onRoomUnitChatEvent.bind(this))),this._connection.addMessageEvent(new U_(this.onRoomUnitTypingEvent.bind(this))),this._connection.addMessageEvent(new na(this.onPetFigureUpdateEvent.bind(this))),this._connection.addMessageEvent(new yd(this.onPetExperienceEvent.bind(this))),this._connection.addMessageEvent(new vd(this.onYouArePlayingGameEvent.bind(this))),this._connection.addMessageEvent(new d_(this.onDiceValueMessageEvent.bind(this))),this._connection.addMessageEvent(new yh(this.onIgnoreResultEvent.bind(this))),this._connection.addMessageEvent(new ud(this.onGuideSessionStartedMessageEvent.bind(this))),this._connection.addMessageEvent(new _d(this.onGuideSessionEndedMessageEvent.bind(this))),this._connection.addMessageEvent(new hd(this.onGuideSessionErrorMessageEvent.bind(this))))}setRoomId(t){this._currentRoomId!==0&&this._roomCreator&&this._roomCreator.destroyRoom(this._currentRoomId),this._currentRoomId=t,this._latestEntryTileEvent=null}clearRoomId(){this._currentRoomId=0,this._latestEntryTileEvent=null}onUserInfoEvent(t){if(!(t instanceof ca)||!t.connection)return;const e=t.getParser();e&&(this._ownUserId=e.userInfo.userId)}onRoomReadyMessageEvent(t){const e=t.getParser();if(this._currentRoomId!==e.roomId&&this.setRoomId(e.roomId),this._roomCreator&&this._roomCreator.setRoomInstanceModelName(e.roomId,e.name),this._initialConnection){t.connection.send(new Yg),this._initialConnection=!1;return}t.connection.send(new z_)}onRoomPaintEvent(t){if(!(t instanceof y_))return;const e=t.getParser();if(!e)return;const s=e.floorType,i=e.wallType,r=e.landscapeType;this._roomCreator&&this._roomCreator.updateRoomInstancePlaneType(this._currentRoomId,s,i,r)}onRoomModelEvent(t){if(!(t instanceof C_)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!s)return;this._planeParser.reset();const i=e.width,r=e.height;this._planeParser.initializeTileMap(i,r);let a=null;this._latestEntryTileEvent&&(a=this._latestEntryTileEvent.getParser());let o=-1,_=-1,l=0,c=0,d=0;for(;d<r;){let m=0;for(;m<i;){const T=e.getHeight(m,d);(d>0&&d<r-1||m>0&&m<i-1)&&T!=jt.TILE_BLOCKED&&(a==null||m==a.x&&d==a.y)&&(e.getHeight(m,d-1)==jt.TILE_BLOCKED&&e.getHeight(m-1,d)==jt.TILE_BLOCKED&&e.getHeight(m,d+1)==jt.TILE_BLOCKED&&(o=m+.5,_=d,l=T,c=90),e.getHeight(m,d-1)==jt.TILE_BLOCKED&&e.getHeight(m-1,d)==jt.TILE_BLOCKED&&e.getHeight(m+1,d)==jt.TILE_BLOCKED&&(o=m,_=d+.5,l=T,c=180)),this._planeParser.setTileHeight(m,d,T),m++}d++}this._planeParser.setTileHeight(Math.floor(o),Math.floor(_),l),this._planeParser.initializeFromTileData(e.wallHeight),this._planeParser.setTileHeight(Math.floor(o),Math.floor(_),l+this._planeParser.wallHeight),e.scale===64?(this._planeParser.restrictsDragging=!0,this._planeParser.restrictsScaling=!0,this._planeParser.restrictedScale=.5):(this._planeParser.restrictsDragging=!1,this._planeParser.restrictsScaling=!1,this._planeParser.restrictedScale=1),s.scale=Jh.DEFAULT_SCALE,s.initialize(i,r,this._planeParser.floorHeight);let E=e.height-1;for(;E>=0;){let m=e.width-1;for(;m>=0;)s.setHeight(m,E,this._planeParser.getTileHeight(m,E)),m--;E--}const I=this._planeParser.getMapData();I.doors.push({x:o,y:_,z:l,dir:c}),this._roomCreator.createRoomInstance(this._currentRoomId,I)}onRoomHeightMapEvent(t){if(!(t instanceof D_)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.width,i=e.height,r=new gV(s,i);let a=0;for(;a<i;){let o=0;for(;o<s;)r.setTileHeight(o,a,e.getTileHeight(o,a)),r.setStackingBlocked(o,a,e.getStackingBlocked(o,a)),r.setIsRoomTile(o,a,e.isRoomTile(o,a)),o++;a++}this._roomCreator.setFurnitureStackingHeightMap(this._currentRoomId,r)}onRoomHeightMapUpdateEvent(t){if(!(t instanceof P_)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.getFurnitureStackingHeightMap(this._currentRoomId);if(s){for(;e.next();)s.setTileHeight(e.x,e.y,e.tileHeight()),s.setStackingBlocked(e.x,e.y,e.isStackingBlocked()),s.setIsRoomTile(e.x,e.y,e.isRoomTile());this._roomCreator.refreshTileObjectMap(this._currentRoomId,"RoomMessageHandler.onRoomHeightMapUpdateEvent()")}}onRoomThicknessEvent(t){if(!(t instanceof L_))return;const e=t.getParser();if(!e)return;const s=!e.hideWalls,i=!0,r=e.thicknessWall,a=e.thicknessFloor;this._roomCreator&&(this._roomCreator.updateRoomInstancePlaneVisibility(this._currentRoomId,s,i),this._roomCreator.updateRoomInstancePlaneThickness(this._currentRoomId,r,a))}onRoomDoorEvent(t){t instanceof N_&&(this._latestEntryTileEvent=t)}onRoomRollingEvent(t){if(!(t instanceof c_)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,1,null),this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.rollerId,null,null,2,null);const s=e.itemsRolling;if(s&&s.length)for(const r of s)r&&this._roomCreator.rollRoomObjectFloor(this._currentRoomId,r.id,r.location,r.targetLocation);const i=e.unitRolling;if(i){this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,i.id,i.location,i.targetLocation);const r=this._roomCreator.getRoomObjectUser(this._currentRoomId,i.id);if(r&&r.type!==lt.MONSTER_PLANT){let a="std";switch(i.movementType){case Ms.MOVE:a="mv";break;case Ms.SLIDE:a="std";break}this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,i.id,a)}}}onObjectsDataUpdateEvent(t){if(!(t instanceof l_)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(e)for(const s of e.objects)this._roomCreator.updateRoomObjectFloor(this._currentRoomId,s.id,null,null,s.state,s.data)}onFurnitureAliasesEvent(t){!(t instanceof I_)||!t.connection||!this._roomCreator||(t.getParser().aliases,this._connection.send(new z_))}onFurnitureFloorAddEvent(t){if(!(t instanceof g_)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureFloor(this._currentRoomId,e)}onFurnitureFloorEvent(t){if(!(t instanceof E_)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const r=e.items[i];r&&this.addRoomObjectFurnitureFloor(this._currentRoomId,r),i++}}onFurnitureFloorRemoveEvent(t){if(!(t instanceof f_)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(e.delay>0?setTimeout(()=>{this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0)},e.delay):this._roomCreator.removeRoomObjectFloor(this._currentRoomId,e.itemId,e.isExpired?-1:e.userId,!0))}onFurnitureFloorUpdateEvent(t){if(!(t instanceof m_)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;if(!e)return;const s=new R(e.x,e.y,e.z),i=new R(e.direction);this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,s,i,e.data.state,e.data,e.extra),this._roomCreator.updateRoomObjectFloorHeight(this._currentRoomId,e.itemId,e.stackHeight),this._roomCreator.updateRoomObjectFloorExpiration(this._currentRoomId,e.itemId,e.expires)}onFurnitureWallAddEvent(t){if(!(t instanceof O_)||!t.connection||!this._roomCreator)return;const e=t.getParser().item;e&&this.addRoomObjectFurnitureWall(this._currentRoomId,e)}onFurnitureWallEvent(t){if(!(t instanceof A_)||!t.connection||!this._roomCreator)return;const e=t.getParser();if(!e)return;const s=e.items.length;let i=0;for(;i<s;){const r=e.items[i];r&&this.addRoomObjectFurnitureWall(this._currentRoomId,r),i++}}onFurnitureWallRemoveEvent(t){if(!(t instanceof S_)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.removeRoomObjectWall(this._currentRoomId,e.itemId,e.userId)}onFurnitureWallUpdateEvent(t){if(!(t instanceof M_)||!t.connection||!this._roomCreator)return;const e=this._roomCreator.getLegacyWallGeometry(this._currentRoomId);if(!e)return;const s=t.getParser().item;if(!s)return;const i=e.getLocation(s.width,s.height,s.localX,s.localY,s.direction),r=new R(e.getDirection(s.direction));this._roomCreator.updateRoomObjectWall(this._currentRoomId,s.itemId,i,r,s.state,s.stuffData),this._roomCreator.updateRoomObjectWallExpiration(this._currentRoomId,s.itemId,s.secondsToExpiration)}onFurnitureDataEvent(t){if(!(t instanceof R_)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.furnitureId,null,null,e.objectData.state,e.objectData)}onItemDataUpdateMessageEvent(t){if(!(t instanceof T_)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectWallItemData(this._currentRoomId,e.furnitureId,e.data)}onOneWayDoorStatusMessageEvent(t){if(!(t instanceof p_)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.state,new Re)}onDiceValueMessageEvent(t){if(!(t instanceof d_)||!t.connection||!this._roomCreator)return;const e=t.getParser();this._roomCreator.updateRoomObjectFloor(this._currentRoomId,e.itemId,null,null,e.value,new Re)}onRoomUnitDanceEvent(t){!(t instanceof _a)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,g.FIGURE_DANCE,t.getParser().danceId)}onRoomUnitEffectEvent(t){!(t instanceof v_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserEffect(this._currentRoomId,t.getParser().unitId,t.getParser().effectId,t.getParser().delay)}onRoomUnitEvent(t){if(!(t instanceof ha)||!t.connection||!this._roomCreator)return;const e=t.getParser().users;if(!(!e||!e.length)){for(const s of e){if(!s)continue;const i=new R(s.x,s.y,s.z),r=new R(s.dir);this._roomCreator.addRoomObjectUser(this._currentRoomId,s.roomIndex,i,r,s.dir,s.userType,s.figure),s.webID===this._ownUserId&&(this._roomCreator.setRoomSessionOwnUser(this._currentRoomId,s.roomIndex),this._roomCreator.updateRoomObjectUserOwn(this._currentRoomId,s.roomIndex)),this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,s.roomIndex,s.figure,s.sex,s.subType,s.isRiding),lt.getTypeString(s.userType)===lt.PET&&this._roomCreator.getPetTypeId(s.figure)===nt.MONSTERPLANT&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,s.roomIndex,s.petPosture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,s.roomIndex,g.FIGURE_IS_MUTED,this._roomCreator.sessionDataManager.isUserIgnored(s.name)?1:0)}this.updateGuideMarker()}}onRoomUnitExpressionEvent(t){!(t instanceof b_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,g.FIGURE_EXPRESSION,t.getParser().expression)}onRoomUnitHandItemEvent(t){!(t instanceof F_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,g.FIGURE_CARRY_OBJECT,t.getParser().handId)}onRoomUnitIdleEvent(t){!(t instanceof x_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,g.FIGURE_SLEEP,t.getParser().isIdle?1:0)}onRoomUnitInfoEvent(t){!(t instanceof ua)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,t.getParser().unitId,t.getParser().figure,t.getParser().gender)}onRoomUnitNumberEvent(t){if(!(t instanceof G_)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.unitId,g.FIGURE_NUMBER_VALUE,e.value)}onRoomUnitRemoveEvent(t){!(t instanceof la)||!t.connection||!this._roomCreator||(this._roomCreator.removeRoomObjectUser(this._currentRoomId,t.getParser().unitId),this.updateGuideMarker())}onRoomUnitStatusEvent(t){if(!(t instanceof B_)||!t.connection||!this._roomCreator)return;const e=t.getParser().statuses;if(!e||!e.length)return;const s=this._roomCreator.getRoomInstance(this._currentRoomId);if(!s)return;const i=s.model.getValue(Rt.ROOM_Z_SCALE)||1;for(const r of e){if(!r)continue;let a=r.height;a&&(a=a/i);const o=new R(r.x,r.y,r.z+a),_=new R(r.direction);let l=null;r.didMove&&(l=new R(r.targetX,r.targetY,r.targetZ)),this._roomCreator.updateRoomObjectUserLocation(this._currentRoomId,r.id,o,l,r.canStandUp,a,_,r.headDirection),this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,r.id,null);let c=!0,d=!1,E=g.STD,I="";if(r.actions&&r.actions.length){for(const m of r.actions)if(m)switch(m.action){case"flatctrl":this._roomCreator.updateRoomObjectUserFlatControl(this._currentRoomId,r.id,m.value);break;case"sign":r.actions.length===1&&(c=!1),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,r.id,g.FIGURE_SIGN,parseInt(m.value));break;case"gst":r.actions.length===1&&(c=!1),this._roomCreator.updateRoomObjectUserPetGesture(this._currentRoomId,r.id,m.value);break;case"wav":case"mv":d=!0,E=m.action,I=m.value;break;case"trd":break;default:d=!0,E=m.action,I=m.value;break}}d?this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.id,E,I):c&&this._roomCreator.updateRoomObjectUserPosture(this._currentRoomId,r.id,g.STD,"")}this.updateGuideMarker()}onRoomUnitChatEvent(t){if(!t.connection||!this._roomCreator)return;const e=t.getParser();e&&(this._roomCreator.updateRoomObjectUserGesture(this._currentRoomId,e.roomIndex,e.gesture),this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,g.FIGURE_TALK,e.message.length/10))}onRoomUnitTypingEvent(t){!(t instanceof U_)||!t.connection||!this._roomCreator||this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,t.getParser().unitId,g.FIGURE_IS_TYPING,t.getParser().isTyping?1:0)}onPetFigureUpdateEvent(t){if(!(t instanceof na)||!t.connection||!this._roomCreator)return;const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserFigure(this._currentRoomId,e.roomIndex,e.figureData.figuredata,"","",e.isRiding)}onPetExperienceEvent(t){const e=t.getParser();e&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,e.roomIndex,g.FIGURE_GAINED_EXPERIENCE,e.gainedExperience)}onYouArePlayingGameEvent(t){if(!t)return;const e=t.getParser();e&&this._roomCreator.setRoomEngineGameMode(this._currentRoomId,e.isPlaying)}addRoomObjectFurnitureFloor(t,e){if(!e||!this._roomCreator)return;const s=new R(e.x,e.y,e.z),i=new R(e.direction);e.spriteName?this._roomCreator.addFurnitureFloorByTypeName(t,e.itemId,e.spriteName,s,i,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight):this._roomCreator.addFurnitureFloor(t,e.itemId,e.spriteId,s,i,e.state,e.data,e.extra,e.expires,e.usagePolicy,e.userId,e.username,!0,!0,e.stackHeight)}addRoomObjectFurnitureWall(t,e){if(!e||!this._roomCreator)return;const s=this._roomCreator.getLegacyWallGeometry(t);if(!s)return;let i=null;e.isOldFormat||(i=s.getLocation(e.width,e.height,e.localX,e.localY,e.direction));const r=new R(s.getDirection(e.direction));this._roomCreator.addFurnitureWall(t,e.itemId,e.spriteId,i,r,e.state,e.stuffData,e.secondsToExpiration,e.usagePolicy,e.userId,e.username)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getUserDataByName(e.name);if(i)switch(e.result){case 1:case 2:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,g.FIGURE_IS_MUTED,1);return;case 3:this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,g.FIGURE_IS_MUTED,0);return}}onGuideSessionStartedMessageEvent(t){const e=t.getParser();this._guideId=e.guideUserId,this._requesterId=e.requesterUserId,this.updateGuideMarker()}onGuideSessionEndedMessageEvent(t){this.removeGuideMarker()}onGuideSessionErrorMessageEvent(t){this.removeGuideMarker()}updateGuideMarker(){const t=this._roomCreator.sessionDataManager.userId;this.setUserGuideStatus(this._guideId,this._requesterId===t?we.GUIDE:we.NONE),this.setUserGuideStatus(this._requesterId,this._guideId===t?we.REQUESTER:we.NONE)}removeGuideMarker(){this.setUserGuideStatus(this._guideId,we.NONE),this.setUserGuideStatus(this._requesterId,we.NONE),this._guideId=-1,this._requesterId=-1}setUserGuideStatus(t,e){if(!this._roomCreator||!this._roomCreator.roomSessionManager)return;const s=this._roomCreator.roomSessionManager.getSession(this._currentRoomId);if(!s)return;const i=s.userDataManager.getDataByType(t,je.USER);i&&this._roomCreator.updateRoomObjectUserAction(this._currentRoomId,i.roomIndex,g.FIGURE_GUIDE_STATUS,e)}get currentRoomId(){return this._currentRoomId}}class pV extends ge{constructor(t){super(),this._roomEngine=t,this._eventIds=new Map,this._selectedAvatarId=-1,this._selectedObjectId=-1,this._selectedObjectCategory=-2,this._whereYouClickIsWhereYouGo=!0,this._objectPlacementSource=null,this.onRoomEngineObjectEvent=this.onRoomEngineObjectEvent.bind(this),this._roomEngine.events.addEventListener(V.ADDED,this.onRoomEngineObjectEvent)}dispose(){this._eventIds&&(this._eventIds=null),this._roomEngine.events.removeEventListener(V.ADDED,this.onRoomEngineObjectEvent),this._roomEngine=null}onRoomEngineObjectEvent(t){let e=this.getSelectedRoomObjectData(t.roomId);if(e&&e.operation===X.OBJECT_PLACE&&e.id===t.objectId){const s=this._roomEngine.getRoomObject(t.roomId,e.id,e.category);if(s&&s.model&&e.category===S.FLOOR){const i=s.model.getValue(g.FURNITURE_ALLOWED_DIRECTIONS);if(i&&i.length){const r=new R(i[0]);if(s.setDirection(r),this.updateSelectedObjectData(t.roomId,e.id,e.category,e.loc,r,e.operation,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture),e=this.getSelectedRoomObjectData(t.roomId),!e)return}}this.setFurnitureAlphaMultiplier(s,.5)}}processRoomCanvasMouseEvent(t,e,s){if(!t||!e||Zs.isRunning())return;const i=e.type;let r=this._roomEngine.getRoomObjectCategoryForType(i);if(r!==S.ROOM&&(!this._roomEngine.isPlayingGame()||r!==S.UNIT)&&(r=S.MINIMUM),this.getMouseEventId(r,t.type)===t.eventId){if(t.type===F.MOUSE_CLICK||t.type===F.DOUBLE_CLICK||t.type===F.MOUSE_DOWN||t.type===F.MOUSE_UP||t.type===F.MOUSE_MOVE)return}else t.eventId&&this.setMouseEventId(r,t.type,t.eventId);e.mouseHandler&&e.mouseHandler.mouseEvent(t,s)}processRoomObjectPlacement(t,e,s,i,r,a=null,o=null,_=-1,l=-1,c=null){this._objectPlacementSource=t;const d=new R(-100,-100),E=new R(0);return this.setSelectedRoomObjectData(e,s,i,d,E,X.OBJECT_PLACE,r,a,o,_,l,c),this._roomEngine&&(this._roomEngine.setObjectMoverIconSprite(r,i,!1,a,o,_,l,c),this._roomEngine.setObjectMoverIconSpriteVisible(!1)),!0}cancelRoomObjectInsert(t){return this.resetSelectedObjectData(t),!0}getMouseEventId(t,e){const s=this._eventIds.get(t);return s&&s.get(e)||null}setMouseEventId(t,e,s){let i=this._eventIds.get(t);i||(i=new Map,this._eventIds.set(t,i)),i.delete(e),i.set(e,s)}handleRoomObjectEvent(t,e){if(t){if(t instanceof j){this.handleRoomObjectMouseEvent(t,e);return}switch(t.type){case it.STATE_CHANGE:case it.STATE_RANDOM:this.onRoomObjectStateChangedEvent(t,e);return;case zr.DIMMER_STATE:this.onRoomObjectDimmerStateUpdateEvent(t,e);return;case re.POSITION_CHANGED:case re.OBJECT_REMOVED:this.handleSelectedObjectRemove(t,e);return;case O.OPEN_WIDGET:case O.CLOSE_WIDGET:case O.OPEN_FURNI_CONTEXT_MENU:case O.CLOSE_FURNI_CONTEXT_MENU:case O.PLACEHOLDER:case O.CREDITFURNI:case O.STACK_HEIGHT:case O.EXTERNAL_IMAGE:case O.STICKIE:case O.PRESENT:case O.TROPHY:case O.TEASER:case O.ECOTRONBOX:case O.DIMMER:case O.WIDGET_REMOVE_DIMMER:case O.CLOTHING_CHANGE:case O.JUKEBOX_PLAYLIST_EDITOR:case O.MANNEQUIN:case O.PET_PRODUCT_MENU:case O.GUILD_FURNI_CONTEXT_MENU:case O.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:case O.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:case O.BACKGROUND_COLOR:case O.MYSTERYBOX_OPEN_DIALOG:case O.EFFECTBOX_OPEN_DIALOG:case O.MYSTERYTROPHY_OPEN_DIALOG:case O.ACHIEVEMENT_RESOLUTION_OPEN:case O.ACHIEVEMENT_RESOLUTION_ENGRAVING:case O.ACHIEVEMENT_RESOLUTION_FAILED:case O.FRIEND_FURNITURE_CONFIRM:case O.FRIEND_FURNITURE_ENGRAVING:case O.BADGE_DISPLAY_ENGRAVING:case O.HIGH_SCORE_DISPLAY:case O.HIDE_HIGH_SCORE_DISPLAY:case O.INERNAL_LINK:case O.ROOM_LINK:case O.YOUTUBE:this.onRoomObjectWidgetRequestEvent(t,e);return;case y.DICE_ACTIVATE:case y.DICE_OFF:case y.USE_HABBOWHEEL:case y.STICKIE:case y.ENTER_ONEWAYDOOR:this.onRoomObjectFurnitureActionEvent(t,e);return;case y.SOUND_MACHINE_INIT:case y.SOUND_MACHINE_START:case y.SOUND_MACHINE_STOP:case y.SOUND_MACHINE_DISPOSE:this.handleObjectSoundMachineEvent(t,e);return;case y.JUKEBOX_INIT:case y.JUKEBOX_START:case y.JUKEBOX_MACHINE_STOP:case y.JUKEBOX_DISPOSE:this.handleObjectJukeboxEvent(t,e);return;case ee.ADD_HOLE:case ee.REMOVE_HOLE:this.onRoomObjectFloorHoleEvent(t,e);return;case Tt.ROOM_AD_FURNI_CLICK:case Tt.ROOM_AD_FURNI_DOUBLE_CLICK:case Tt.ROOM_AD_TOOLTIP_SHOW:case Tt.ROOM_AD_TOOLTIP_HIDE:case Tt.ROOM_AD_LOAD_IMAGE:this.onRoomObjectRoomAdEvent(t,e);return;case rs.LOAD_BADGE:this.onRoomObjectBadgeAssetEvent(t,e);return;case y.MOUSE_ARROW:case y.MOUSE_BUTTON:this.handleMousePointer(t,e);return;case Ns.PLAY_SOUND:case Ns.PLAY_SOUND_AT_PITCH:this.handleRoomObjectPlaySoundEvent(t,e);return;case Dt.ROOM_OBJECT_INITIALIZED:case Dt.ROOM_OBJECT_DISPOSED:case Dt.PLAY_SAMPLE:case Dt.CHANGE_PITCH:this.handleRoomObjectSamplePlaybackEvent(t,e);return;case Qs.ROOM_BACKGROUND_COLOR:this.onHSLColorEnableEvent(t,e);return;case Ce.RODRE_CURRENT_USER_ID:case Ce.RODRE_URL_PREFIX:this.onRoomObjectDataRequestEvent(t,e);return;default:G.warn("Unhandled Event",t.constructor.name,"Object ID",t.object.id);return}}}handleRoomObjectMouseEvent(t,e){if(!(!t||!t.type))switch(t.type){case j.CLICK:this.handleRoomObjectMouseClickEvent(t,e);return;case j.DOUBLE_CLICK:this.handleRoomObjectMouseDoubleClickEvent(t,e);return;case j.MOUSE_MOVE:this.handleRoomObjectMouseMoveEvent(t,e);return;case j.MOUSE_DOWN:this.handleRoomObjectMouseDownEvent(t,e);return;case j.MOUSE_DOWN_LONG:this.handleRoomObjectMouseDownLongEvent(t,e);return;case j.MOUSE_ENTER:this.handleRoomObjectMouseEnterEvent(t,e);return;case j.MOUSE_LEAVE:this.handleRoomObjectMouseLeaveEvent(t,e);return}}handleRoomObjectMouseClickEvent(t,e){if(!t)return;let s=X.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);let r=!1,a=!1;this._whereYouClickIsWhereYouGo&&(!s||s===X.OBJECT_UNDEFINED)&&(r=this.handleMoveTargetFurni(e,t));const o=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case X.OBJECT_MOVE:o===S.ROOM?i&&this.modifyRoomObject(e,i.id,i.category,X.OBJECT_MOVE_TO):o===S.UNIT&&(i&&t.objectType===lt.MONSTER_PLANT&&this.modifyRoomObject(e,i.id,i.category,X.OBJECT_MOVE_TO),t.eventId&&this.setMouseEventId(S.ROOM,F.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,o)),a=!0,t.objectId!==-1&&this.setSelectedObject(e,t.objectId,o);break;case X.OBJECT_PLACE:if(o===S.ROOM)this.placeObject(e,t instanceof ls,t instanceof Hi);else if(o===S.UNIT)switch(t.objectType){case lt.MONSTER_PLANT:case lt.RENTABLE_BOT:this.placeObject(e,t instanceof ls,t instanceof Hi);break;default:t.eventId&&this.setMouseEventId(S.ROOM,F.MOUSE_CLICK,t.eventId),this.placeObjectOnUser(e,t.objectId,o);break}break;case X.OBJECT_UNDEFINED:o===S.ROOM?!r&&t instanceof ls&&this.onRoomObjectTileMouseEvent(e,t):(this.setSelectedObject(e,t.objectId,o),a=!1,o===S.UNIT?(t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===lt.RENTABLE_BOT?this.modifyRoomObject(e,t.objectId,o,X.OBJECT_PICKUP_BOT):t.ctrlKey&&!t.altKey&&!t.shiftKey&&t.objectType===lt.MONSTER_PLANT?this.modifyRoomObject(e,t.objectId,o,X.OBJECT_PICKUP_PET):!t.ctrlKey&&!t.altKey&&t.shiftKey&&t.objectType===lt.MONSTER_PLANT&&this.modifyRoomObject(e,t.objectId,o,X.OBJECT_ROTATE_POSITIVE),this._roomEngine.isPlayingGame()?a=!0:r=!0):(o===S.FLOOR||o===S.WALL)&&(t.altKey||t.ctrlKey||t.shiftKey)&&(!t.ctrlKey&&!t.altKey&&t.shiftKey?o===S.FLOOR&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new V(V.REQUEST_ROTATE,e,t.objectId,o)):t.ctrlKey&&!t.altKey&&!t.shiftKey&&this.modifyRoomObject(e,t.objectId,o,X.OBJECT_PICKUP),this._roomEngine.isPlayingGame()?a=!0:r=!0),t.eventId&&(r&&this.setMouseEventId(S.ROOM,F.MOUSE_CLICK,t.eventId),a&&this.setMouseEventId(S.MINIMUM,F.MOUSE_CLICK,t.eventId)));break}if(o===S.ROOM){const _=this.getMouseEventId(S.MINIMUM,F.MOUSE_CLICK),l=this.getMouseEventId(S.UNIT,F.MOUSE_CLICK);_!==t.eventId&&l!==t.eventId&&!a&&(this.deselectObject(e),this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new V(V.DESELECTED,e,-1,S.MINIMUM)),this.setSelectedAvatar(e,0,!1))}}handleRoomObjectMouseDoubleClickEvent(t,e){const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new V(V.DOUBLE_CLICK,e,s,r))}handleRoomObjectMouseMoveEvent(t,e){if(!t)return;let s=X.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const r=this._roomEngine.getRoomObjectCategoryForType(t.objectType);if(this._roomEngine){const a=this._roomEngine.getRoomObjectCursor(e);if(a&&a.logic){let o=null;t instanceof ls?o=this.handleMouseOverTile(t,e):t.object&&t.object.id!==-1?this._whereYouClickIsWhereYouGo&&(o=this.handleMouseOverObject(r,e,t)):o=new ji(null,0,!1,t.eventId),a.processUpdateMessage(o)}}switch(s){case X.OBJECT_MOVE:r===S.ROOM&&this.handleObjectMove(t,e);return;case X.OBJECT_PLACE:r===S.ROOM&&this.handleObjectPlace(t,e);return}}handleRoomObjectMouseDownEvent(t,e){if(!t)return;let s=X.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const r=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case X.OBJECT_UNDEFINED:(r===S.FLOOR||r===S.WALL||t.objectType===lt.MONSTER_PLANT)&&(t.altKey&&!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new V(V.REQUEST_MOVE,e,t.objectId,r));return}}handleRoomObjectMouseDownLongEvent(t,e){if(!t)return;let s=X.OBJECT_UNDEFINED;const i=this.getSelectedRoomObjectData(e);i&&(s=i.operation);const r=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(s){case X.OBJECT_UNDEFINED:(r===S.FLOOR||r===S.WALL||t.objectType===lt.MONSTER_PLANT)&&(!t.ctrlKey&&!t.shiftKey||this.decorateModeMove(t))&&this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new V(V.REQUEST_MANIPULATION,e,t.objectId,r));return}}handleRoomObjectMouseEnterEvent(t,e){const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new V(V.MOUSE_ENTER,e,s,r))}handleRoomObjectMouseLeaveEvent(t,e){const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i);if(r!==S.ROOM&&r===S.UNIT){const a=this._roomEngine.getRoomObjectCursor(e);a&&a.processUpdateMessage(new mt(0,null))}this._roomEngine.events&&this._roomEngine.events.dispatchEvent(new V(V.MOUSE_LEAVE,e,s,r))}onRoomObjectStateChangedEvent(t,e){if(t)switch(t.type){case it.STATE_CHANGE:this.changeObjectState(e,t.object.id,t.object.type,t.state,!1);return;case it.STATE_RANDOM:this.changeObjectState(e,t.object.id,t.object.type,t.state,!0);return}}onRoomObjectDimmerStateUpdateEvent(t,e){if(t)switch(t.type){case zr.DIMMER_STATE:this._roomEngine.events.dispatchEvent(new Lm(e,t.state,t.presetId,t.effectId,t.color,t.brightness));return}}handleSelectedObjectRemove(t,e){if(!(!t||!this._roomEngine))switch(t.type){case re.POSITION_CHANGED:{const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i),a=this._roomEngine.getRoomObject(e,s,r),o=this._roomEngine.getRoomObjectSelectionArrow(e);if(a&&o&&o.logic){const _=a.getLocation();o.logic.processUpdateMessage(new bt(_,null))}return}case re.OBJECT_REMOVED:this.setSelectedAvatar(e,0,!1);return}}onRoomObjectWidgetRequestEvent(t,e){if(!t||!this._roomEngine)return;const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i),a=this._roomEngine.events;if(a&&!Pc.isRoomPreviewerId(e))switch(t.type){case O.OPEN_WIDGET:a.dispatchEvent(new U(U.OPEN_WIDGET,e,s,r,t.object.logic.widget));return;case O.CLOSE_WIDGET:a.dispatchEvent(new U(U.CLOSE_WIDGET,e,s,r,t.object.logic.widget));return;case O.OPEN_FURNI_CONTEXT_MENU:a.dispatchEvent(new U(U.OPEN_FURNI_CONTEXT_MENU,e,s,r,t.object.logic.contextMenu));return;case O.CLOSE_FURNI_CONTEXT_MENU:a.dispatchEvent(new U(U.CLOSE_FURNI_CONTEXT_MENU,e,s,r));return;case O.PLACEHOLDER:a.dispatchEvent(new U(U.REQUEST_PLACEHOLDER,e,s,r));return;case O.CREDITFURNI:a.dispatchEvent(new U(U.REQUEST_CREDITFURNI,e,s,r));return;case O.STACK_HEIGHT:a.dispatchEvent(new U(U.REQUEST_STACK_HEIGHT,e,s,r));return;case O.EXTERNAL_IMAGE:a.dispatchEvent(new U(U.REQUEST_EXTERNAL_IMAGE,e,s,r));return;case O.STICKIE:a.dispatchEvent(new U(U.REQUEST_STICKIE,e,s,r));return;case O.PRESENT:a.dispatchEvent(new U(U.REQUEST_PRESENT,e,s,r));return;case O.TROPHY:a.dispatchEvent(new U(U.REQUEST_TROPHY,e,s,r));return;case O.TEASER:a.dispatchEvent(new U(U.REQUEST_TEASER,e,s,r));return;case O.ECOTRONBOX:a.dispatchEvent(new U(U.REQUEST_ECOTRONBOX,e,s,r));return;case O.DIMMER:a.dispatchEvent(new U(U.REQUEST_DIMMER,e,s,r));return;case O.WIDGET_REMOVE_DIMMER:a.dispatchEvent(new U(U.REMOVE_DIMMER,e,s,r));return;case O.CLOTHING_CHANGE:a.dispatchEvent(new U(U.REQUEST_CLOTHING_CHANGE,e,s,r));return;case O.JUKEBOX_PLAYLIST_EDITOR:a.dispatchEvent(new U(U.REQUEST_PLAYLIST_EDITOR,e,s,r));return;case O.MANNEQUIN:a.dispatchEvent(new U(U.REQUEST_MANNEQUIN,e,s,r));return;case O.PET_PRODUCT_MENU:a.dispatchEvent(new sa(sa.USE_PRODUCT_FROM_ROOM,e,s,r));return;case O.GUILD_FURNI_CONTEXT_MENU:this._roomEngine.connection.send(new Wg(t.objectId,t.object.model.getValue(g.FURNITURE_GUILD_CUSTOMIZED_GUILD_ID)));return;case O.MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG:a.dispatchEvent(new U(U.REQUEST_MONSTERPLANT_SEED_PLANT_CONFIRMATION_DIALOG,e,s,r));return;case O.PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG:a.dispatchEvent(new U(U.REQUEST_PURCHASABLE_CLOTHING_CONFIRMATION_DIALOG,e,s,r));return;case O.BACKGROUND_COLOR:a.dispatchEvent(new U(U.REQUEST_BACKGROUND_COLOR,e,s,r));return;case O.MYSTERYBOX_OPEN_DIALOG:a.dispatchEvent(new U(U.REQUEST_MYSTERYBOX_OPEN_DIALOG,e,s,r));return;case O.EFFECTBOX_OPEN_DIALOG:a.dispatchEvent(new U(U.REQUEST_EFFECTBOX_OPEN_DIALOG,e,s,r));return;case O.MYSTERYTROPHY_OPEN_DIALOG:a.dispatchEvent(new U(U.REQUEST_MYSTERYTROPHY_OPEN_DIALOG,e,s,r));return;case O.ACHIEVEMENT_RESOLUTION_OPEN:this._roomEngine.connection.send(new eg(t.objectId,0));return;case O.ACHIEVEMENT_RESOLUTION_ENGRAVING:a.dispatchEvent(new U(U.REQUEST_ACHIEVEMENT_RESOLUTION_ENGRAVING,e,s,r));return;case O.ACHIEVEMENT_RESOLUTION_FAILED:a.dispatchEvent(new U(U.REQUEST_ACHIEVEMENT_RESOLUTION_FAILED,e,s,r));return;case O.FRIEND_FURNITURE_CONFIRM:a.dispatchEvent(new U(U.REQUEST_FRIEND_FURNITURE_CONFIRM,e,s,r));return;case O.FRIEND_FURNITURE_ENGRAVING:a.dispatchEvent(new U(U.REQUEST_FRIEND_FURNITURE_ENGRAVING,e,s,r));return;case O.BADGE_DISPLAY_ENGRAVING:a.dispatchEvent(new U(U.REQUEST_BADGE_DISPLAY_ENGRAVING,e,s,r));return;case O.HIGH_SCORE_DISPLAY:a.dispatchEvent(new U(U.REQUEST_HIGH_SCORE_DISPLAY,e,s,r));return;case O.HIDE_HIGH_SCORE_DISPLAY:a.dispatchEvent(new U(U.REQUEST_HIDE_HIGH_SCORE_DISPLAY,e,s,r));return;case O.INERNAL_LINK:a.dispatchEvent(new U(U.REQUEST_INTERNAL_LINK,e,s,r));return;case O.ROOM_LINK:a.dispatchEvent(new U(U.REQUEST_ROOM_LINK,e,s,r));return;case O.YOUTUBE:a.dispatchEvent(new U(U.REQUEST_YOUTUBE,e,s,r));return}}onRoomObjectFurnitureActionEvent(t,e){t&&this.useObject(e,t.object.id,t.object.type,t.type)}handleObjectSoundMachineEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),i=this.getSelectedRoomObjectData(e);if(!(i&&i.category===s&&i.id===t.objectId&&i.operation===X.OBJECT_PLACE))switch(t.type){case y.SOUND_MACHINE_INIT:this._roomEngine.events.dispatchEvent(new Et(Et.SOUND_MACHINE_INIT,e,t.objectId,s));return;case y.SOUND_MACHINE_START:this._roomEngine.events.dispatchEvent(new Et(Et.SOUND_MACHINE_SWITCHED_ON,e,t.objectId,s));return;case y.SOUND_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new Et(Et.SOUND_MACHINE_SWITCHED_OFF,e,t.objectId,s));return;case y.SOUND_MACHINE_DISPOSE:this._roomEngine.events.dispatchEvent(new Et(Et.SOUND_MACHINE_DISPOSE,e,t.objectId,s));return}}handleObjectJukeboxEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType),i=this.getSelectedRoomObjectData(e);if(!(i&&i.category===s&&i.id===t.objectId&&i.operation===X.OBJECT_PLACE))switch(t.type){case y.JUKEBOX_INIT:this._roomEngine.events.dispatchEvent(new Et(Et.JUKEBOX_INIT,e,t.objectId,s));return;case y.JUKEBOX_START:this._roomEngine.events.dispatchEvent(new Et(Et.JUKEBOX_SWITCHED_ON,e,t.objectId,s));return;case y.JUKEBOX_MACHINE_STOP:this._roomEngine.events.dispatchEvent(new Et(Et.JUKEBOX_SWITCHED_OFF,e,t.objectId,s));return;case y.JUKEBOX_DISPOSE:this._roomEngine.events.dispatchEvent(new Et(Et.JUKEBOX_DISPOSE,e,t.objectId,s));return}}onRoomObjectFloorHoleEvent(t,e){if(t)switch(t.type){case ee.ADD_HOLE:this._roomEngine.addRoomInstanceFloorHole(e,t.objectId);return;case ee.REMOVE_HOLE:this._roomEngine.removeRoomInstanceFloorHole(e,t.objectId);return}}onRoomObjectRoomAdEvent(t,e){if(!t)return;let s=null;switch(t.type){case Tt.ROOM_AD_FURNI_CLICK:this._roomEngine.events.dispatchEvent(t),t.clickUrl&&t.clickUrl.length>0&&H.instance.createLinkEvent(t.clickUrl),s=ti.FURNI_CLICK;break;case Tt.ROOM_AD_FURNI_DOUBLE_CLICK:if(t.clickUrl&&t.clickUrl.length>0){const i="CATALOG_PAGE";t.clickUrl.indexOf(i)===0&&H.instance.createLinkEvent(t.clickUrl.substr(i.length))}s=ti.FURNI_DOUBLE_CLICK;break;case Tt.ROOM_AD_TOOLTIP_SHOW:s=ti.TOOLTIP_SHOW;break;case Tt.ROOM_AD_TOOLTIP_HIDE:s=ti.TOOLTIP_HIDE;break}s&&this._roomEngine.events.dispatchEvent(new V(s,e,t.objectId,this._roomEngine.getRoomObjectCategoryForType(t.objectType)))}onRoomObjectBadgeAssetEvent(t,e){if(!(!t||!this._roomEngine))switch(t.type){case rs.LOAD_BADGE:{const s=t.objectId,i=t.objectType,r=this._roomEngine.getRoomObjectCategoryForType(i);this._roomEngine.loadRoomObjectBadgeImage(e,s,r,t.badgeId,t.groupBadge);return}}}handleMousePointer(t,e){t&&this._roomEngine.updateMousePointer(t.type,t.objectId,t.objectType)}handleRoomObjectPlaySoundEvent(t,e){const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case Ns.PLAY_SOUND:this._roomEngine.events.dispatchEvent(new Zi(Zi.PLAY_SOUND,e,t.objectId,s,t.soundId,t.pitch));return;case Ns.PLAY_SOUND_AT_PITCH:this._roomEngine.events.dispatchEvent(new Zi(Zi.PLAY_SOUND_AT_PITCH,e,t.objectId,s,t.soundId,t.pitch));return}}handleRoomObjectSamplePlaybackEvent(t,e){if(!t)return;const s=this._roomEngine.getRoomObjectCategoryForType(t.objectType);switch(t.type){case Dt.ROOM_OBJECT_INITIALIZED:this._roomEngine.events.dispatchEvent(new _e(_e.ROOM_OBJECT_INITIALIZED,e,t.objectId,s,t.sampleId,t.pitch));break;case Dt.ROOM_OBJECT_DISPOSED:this._roomEngine.events.dispatchEvent(new _e(_e.ROOM_OBJECT_DISPOSED,e,t.objectId,s,t.sampleId,t.pitch));break;case Dt.PLAY_SAMPLE:this._roomEngine.events.dispatchEvent(new _e(_e.PLAY_SAMPLE,e,t.objectId,s,t.sampleId,t.pitch));break;case Dt.CHANGE_PITCH:this._roomEngine.events.dispatchEvent(new _e(_e.CHANGE_PITCH,e,t.objectId,s,t.sampleId,t.pitch));break}}onHSLColorEnableEvent(t,e){if(!(!t||!this._roomEngine))switch(t.type){case Qs.ROOM_BACKGROUND_COLOR:this._roomEngine.events.dispatchEvent(new Ho(Ho.ROOM_BACKGROUND_COLOR,e,t.enable,t.hue,t.saturation,t.lightness));return}}onRoomObjectDataRequestEvent(t,e){if(!(!t||!this._roomEngine||!t.object))switch(t.type){case Ce.RODRE_CURRENT_USER_ID:t.object.model.setValue(g.SESSION_CURRENT_USER_ID,this._roomEngine.sessionDataManager.userId);return;case Ce.RODRE_URL_PREFIX:t.object.model.setValue(g.SESSION_URL_PREFIX,k.getValue("url.prefix"));return}}onRoomObjectTileMouseEvent(t,e){if(!this._roomEngine||this._roomEngine.isDecorating||!this._roomEngine.roomSessionManager)return;const s=this._roomEngine.roomSessionManager.getSession(t);!s||s.isSpectator||this.sendWalkUpdate(e.tileXAsInt,e.tileYAsInt)}handleObjectMove(t,e){if(!t||!this._roomEngine||!this._roomEngine.events)return;const i=this.getSelectedRoomObjectData(e);if(!i)return;const r=this._roomEngine.getRoomObject(e,i.id,i.category);if(!r)return;let a=!0;if(i.category===S.FLOOR||i.category===S.UNIT){const o=this._roomEngine.getFurnitureStackingHeightMap(e);t instanceof ls&&this.handleFurnitureMove(r,i,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),o)||(this.handleFurnitureMove(r,i,i.loc.x,i.loc.y,o),a=!1)}else if(i.category===S.WALL){if(a=!1,t instanceof Hi){const o=t.wallLocation,_=t.wallWidth,l=t.wallHeight,c=t.x,d=t.y,E=t.direction;this.handleWallItemMove(r,i,o,_,l,c,d,E)&&(a=!0)}a||(r.setLocation(i.loc),r.setDirection(i.dir)),this._roomEngine.updateRoomObjectMask(e,i.id,a)}a?(this.setFurnitureAlphaMultiplier(r,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!1)):(this.setFurnitureAlphaMultiplier(r,0),this._roomEngine.setObjectMoverIconSpriteVisible(!0))}handleObjectPlace(t,e){if(!t||!this._roomEngine||!this._roomEngine.events)return;let i=this.getSelectedRoomObjectData(e);if(!i)return;let r=this._roomEngine.getRoomObject(e,i.id,i.category);if(!r){if(t instanceof ls){if(i.category===S.FLOOR)this._roomEngine.addFurnitureFloor(e,i.id,i.typeId,i.loc,i.dir,0,i.stuffData,parseFloat(i.instanceData),-1,0,0,"",!1);else if(i.category===S.UNIT){this._roomEngine.addRoomObjectUser(e,i.id,new R,new R(180),180,i.typeId,i.instanceData);const a=this._roomEngine.getRoomObject(e,i.id,i.category);a&&i.posture&&a.model.setValue(g.FIGURE_POSTURE,i.posture)}}else t instanceof Hi&&i.category===S.WALL&&this._roomEngine.addFurnitureWall(e,i.id,i.typeId,i.loc,i.dir,0,i.instanceData,0);if(r=this._roomEngine.getRoomObject(e,i.id,i.category),r&&i.category===S.FLOOR){const a=r.model.getValue(g.FURNITURE_ALLOWED_DIRECTIONS);if(a&&a.length){const o=new R(a[0]);if(r.setDirection(o),this.updateSelectedObjectData(e,i.id,i.category,i.loc,o,i.operation,i.typeId,i.instanceData,i.stuffData,i.state,i.animFrame,i.posture),i=this.getSelectedRoomObjectData(e),!i)return}}this.setFurnitureAlphaMultiplier(r,.5),this._roomEngine.setObjectMoverIconSpriteVisible(!0)}if(r){let a=!0;const o=this._roomEngine.getFurnitureStackingHeightMap(e);if(i.category===S.FLOOR)t instanceof ls&&this.handleFurnitureMove(r,i,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),o)||(this._roomEngine.removeRoomObjectFloor(e,i.id),a=!1);else if(i.category===S.WALL){if(a=!1,t instanceof Hi){const _=t.wallLocation,l=t.wallWidth,c=t.wallHeight,d=t.x,E=t.y,I=t.direction;this.handleWallItemMove(r,i,_,l,c,d,E,I)&&(a=!0)}a||this._roomEngine.removeRoomObjectWall(e,i.id),this._roomEngine.updateRoomObjectMask(e,i.id,a)}else i.category===S.UNIT&&(t instanceof ls&&this.handleUserPlace(r,Math.trunc(t.tileX+.5),Math.trunc(t.tileY+.5),this._roomEngine.getLegacyWallGeometry(e))||(this._roomEngine.removeRoomObjectUser(e,i.id),a=!1));this._roomEngine.setObjectMoverIconSpriteVisible(!a)}}handleFurnitureMove(t,e,s,i,r){if(!t||!e)return!1;const a=new R;a.assign(t.getDirection()),t.setDirection(e.dir);const o=new R(s,i,0),_=new R;_.assign(t.getDirection());let l=this.validateFurnitureLocation(t,o,e.loc,e.dir,r);return l||(_.x=this.getValidRoomObjectDirection(t,!0),t.setDirection(_),l=this.validateFurnitureLocation(t,o,e.loc,e.dir,r)),l?(t.setLocation(l),_&&t.setDirection(_),!0):(t.setDirection(a),!1)}handleWallItemMove(t,e,s,i,r,a,o,_){if(!t||!e)return!1;const l=new R(_),c=this.validateWallItemLocation(t,s,i,r,a,o,e);return c?(t.setLocation(c),t.setDirection(l),!0):!1}validateFurnitureLocation(t,e,s,i,r){if(!t||!t.model||!e)return null;let a=null;const o=t.getDirection();if(!o||!s||!i)return null;if(e.x===s.x&&e.y===s.y&&o.x===i.x)return a=new R,a.assign(s),a;let _=t.model.getValue(g.FURNITURE_SIZE_X),l=t.model.getValue(g.FURNITURE_SIZE_Y);_<1&&(_=1),l<1&&(l=1);const c=s.x,d=s.y;let E=_,I=l,m=0,T=Math.trunc(Math.trunc(o.x+45)%360/90);if((T===1||T===3)&&(m=_,_=l,l=m),T=Math.trunc(Math.trunc(i.x+45)%360/90),(T===1||T===3)&&(m=E,E=I,I=m),r&&e){const p=t.model.getValue(g.FURNITURE_ALWAYS_STACKABLE)===1;return r.validateLocation(e.x,e.y,_,l,c,d,E,I,p)?new R(e.x,e.y,r.getTileHeight(e.x,e.y)):null}return null}validateWallItemLocation(t,e,s,i,r,a,o){if(t==null||t.model==null||e==null||s==null||i==null||o==null)return null;const _=t.model.getValue(g.FURNITURE_SIZE_X),l=t.model.getValue(g.FURNITURE_SIZE_Z),c=t.model.getValue(g.FURNITURE_CENTER_Z);if((r<_/2||r>s.length-_/2||a<c||a>i.length-(l-c))&&(r<_/2&&r<=s.length-_/2?r=_/2:r>=_/2&&r>s.length-_/2&&(r=s.length-_/2),a<c&&a<=i.length-(l-c)?a=c:a>=c&&a>i.length-(l-c)&&(a=i.length-(l-c))),r<_/2||r>s.length-_/2||a<c||a>i.length-(l-c))return null;let d=R.sum(R.product(s,r/s.length),R.product(i,a/i.length));return d=R.sum(e,d),d}changeObjectState(t,e,s,i,r){const a=this._roomEngine.getRoomObjectCategoryForType(s);this.changeRoomObjectState(t,e,a,i,r)}useObject(t,e,s,i){if(!(!this._roomEngine||!this._roomEngine.connection))switch(i){case y.DICE_ACTIVATE:this._roomEngine.connection.send(new Qg(e));return;case y.DICE_OFF:this._roomEngine.connection.send(new Jg(e));return;case y.USE_HABBOWHEEL:this._roomEngine.connection.send(new qg(e));return;case y.STICKIE:this._roomEngine.connection.send(new vg(e));return;case y.ENTER_ONEWAYDOOR:this._roomEngine.connection.send(new Zg(e));return}}changeRoomObjectState(t,e,s,i,r){return!this._roomEngine||!this._roomEngine.connection||(s===S.FLOOR?r?this._roomEngine.connection.send(new $g(e,i)):this._roomEngine.connection.send(new Lh(e,i)):s===S.WALL&&this._roomEngine.connection.send(new tE(e,i))),!0}sendWalkUpdate(t,e){!this._roomEngine||!this._roomEngine.connection||this._roomEngine.connection.send(new EE(t,e))}handleMouseOverObject(t,e,s){if(t!==S.FLOOR)return null;const i=this._roomEngine.getRoomObject(e,s.objectId,S.FLOOR);if(!i)return null;const r=this.getActiveSurfaceLocation(i,s);if(!r||!this._roomEngine.getFurnitureStackingHeightMap(e))return null;const o=r.x,_=r.y,l=r.z;return new ji(new R(o,_,i.getLocation().z),l,!0,s.eventId)}handleMoveTargetFurni(t,e){if(e.objectType===lt.USER||e.objectType===lt.PET||e.objectType===lt.BOT||e.objectType===lt.RENTABLE_BOT||e.objectType===lt.MONSTER_PLANT)return;const s=this._roomEngine.getRoomObject(t,e.objectId,S.FLOOR),i=this.getActiveSurfaceLocation(s,e);return i?(this.sendWalkUpdate(i.x,i.y),!0):!1}getActiveSurfaceLocation(t,e){if(!t||!e)return null;const s=this._roomEngine.sessionDataManager.getFloorItemDataByName(t.type);if(!s||!s.canStandOn&&!s.canSitOn&&!s.canLayOn)return null;const i=t.model;if(!i)return null;const r=t.getLocation(),a=t.getDirection();let o=i.getValue(g.FURNITURE_SIZE_X),_=i.getValue(g.FURNITURE_SIZE_Y);const l=i.getValue(g.FURNITURE_SIZE_Z);(a.x===90||a.x===270)&&([o,_]=[_,o]),o<1&&(o=1),_<1&&(_=1);const c=this._roomEngine.getActiveRoomInstanceRenderingCanvas();if(!c)return null;const d=c.geometry.scale,E=s.canSitOn?.5:0,I=(d/2+e.spriteOffsetX+e.localX)/(d/4),m=(e.spriteOffsetY+e.localY+(l-E)*d/2)/(d/4),T=(I+2*m)/4,p=(I-2*m)/4,A=Math.floor(r.x+T),N=Math.floor(r.y-p+1);let C=!1;(A<r.x||A>=r.x+o||N<r.y||N>=r.y+_)&&(C=!0);const L=s.canSitOn?l-.5:l;return C?null:new R(A,N,L)}handleMouseOverTile(t,e){if(this._whereYouClickIsWhereYouGo)return new ji(new R(t.tileXAsInt,t.tileYAsInt,t.tileZAsInt),0,!0,t.eventId);const s=this._roomEngine.getRoomObjectCursor(e);if(s&&s.visualization){const i=t.tileXAsInt,r=t.tileYAsInt,a=t.tileZAsInt;if(this._roomEngine.getRoomInstance(e)){const _=this._roomEngine.getRoomTileObjectMap(e);if(_){const l=_.getObjectIntTile(i,r),c=this._roomEngine.getFurnitureStackingHeightMap(e);if(c){if(l&&l.model&&l.model.getValue(g.FURNITURE_IS_VARIABLE_HEIGHT)>0){const d=c.getTileHeight(i,r),E=this._roomEngine.getLegacyWallGeometry(e).getHeight(i,r);return new ji(new R(i,r,a),d-E,!0,t.eventId)}return new ji(new R(i,r,a),0,!0,t.eventId)}}}}return null}placeObject(t,e,s){const i=this.getSelectedRoomObjectData(t);if(!i)return;let r=null,a=i.id;const o=i.category;let _=0,l=0,c=0,d=0,E="";if(this._roomEngine&&this._roomEngine.connection&&(r=this._roomEngine.getRoomObject(t,a,o),r)){const I=r.getLocation();if(d=r.getDirection().x,o===S.FLOOR||o===S.UNIT)_=I.x,l=I.y,c=I.z;else if(o===S.WALL){_=I.x,l=I.y,c=I.z;const m=this._roomEngine.getLegacyWallGeometry(t);m&&(E=m.getOldLocationString(I,d))}d=(d/45%8+8)%8,a<0&&o===S.UNIT&&(a=a*-1),this._objectPlacementSource!==rh.CATALOG&&(o===S.UNIT?i.typeId===je.PET?this._roomEngine.connection.send(new Fg(a,Math.trunc(_),Math.trunc(l))):i.typeId===je.RENTABLE_BOT&&this._roomEngine.connection.send(new Pg(a,Math.trunc(_),Math.trunc(l))):r.model.getValue(g.FURNITURE_IS_STICKIE)!==void 0?this._roomEngine.connection.send(new Xg(a,E)):this._roomEngine.connection.send(new Kg(a,o,E,Math.trunc(_),Math.trunc(l),d)))}if(this._roomEngine.setPlacedRoomObjectData(t,new Mo(i.id,i.category,null,i.dir,null)),this.resetSelectedObjectData(t),this._roomEngine&&this._roomEngine.events){const I=r&&r.id===i.id;this._roomEngine.events.dispatchEvent(new Um(V.PLACED,t,a,o,E,_,l,c,d,I,e,s,i.instanceData))}}modifyRoomObject(t,e,s,i){if(!this._roomEngine)return!1;const r=this._roomEngine.getRoomObject(t,e,s);if(!r)return!1;let a=!0;switch(i){case X.OBJECT_ROTATE_POSITIVE:case X.OBJECT_ROTATE_NEGATIVE:if(this._roomEngine.connection){let o=0;i==X.OBJECT_ROTATE_NEGATIVE?o=this.getValidRoomObjectDirection(r,!1):o=this.getValidRoomObjectDirection(r,!0);const _=r.getLocation().x,l=r.getLocation().y;if(this.isValidLocation(r,new R(o),this._roomEngine.getFurnitureStackingHeightMap(t)))if(o=Math.trunc(o/45),r.type===lt.MONSTER_PLANT){const c=this._roomEngine.roomSessionManager.getSession(t);if(c){const d=c.userDataManager.getUserDataByIndex(e);d&&this._roomEngine.connection.send(new V_(d.webID,Math.trunc(_),Math.trunc(l),o))}}else this._roomEngine.connection.send(new j_(e,_,l,o))}break;case X.OBJECT_EJECT:case X.OBJECT_PICKUP:this._roomEngine.connection&&this._roomEngine.connection.send(new kg(s,e));break;case X.OBJECT_PICKUP_PET:if(this._roomEngine.connection){const o=this._roomEngine.roomSessionManager.getSession(t);if(o){const _=o.userDataManager.getUserDataByIndex(e);o.pickupPet(_.webID)}}break;case X.OBJECT_PICKUP_BOT:if(this._roomEngine.connection){const o=this._roomEngine.roomSessionManager.getSession(t);if(o){const _=o.userDataManager.getUserDataByIndex(e);o.pickupBot(_.webID)}}break;case X.OBJECT_MOVE:a=!1,this.setFurnitureAlphaMultiplier(r,.5),this.setSelectedRoomObjectData(t,r.id,s,r.getLocation(),r.getDirection(),i),this._roomEngine.setObjectMoverIconSprite(r.id,s,!0),this._roomEngine.setObjectMoverIconSpriteVisible(!1);break;case X.OBJECT_MOVE_TO:{const o=this.getSelectedRoomObjectData(t);if(this.updateSelectedObjectData(t,o.id,o.category,o.loc,o.dir,X.OBJECT_MOVE_TO,o.typeId,o.instanceData,o.stuffData,o.state,o.animFrame,o.posture),this.setFurnitureAlphaMultiplier(r,1),this._roomEngine.removeObjectMoverIconSprite(),this._roomEngine.connection){if(s===S.FLOOR){const _=r.getDirection().x%360,l=r.getLocation(),c=_/45;this._roomEngine.connection.send(new j_(e,l.x,l.y,c))}else if(s===S.WALL){const _=r.getDirection().x%360,l=this._roomEngine.getLegacyWallGeometry(t);if(l){const c=l.getOldLocationString(r.getLocation(),_);c&&this._roomEngine.connection.send(new iE(e,c))}}else if(s===S.UNIT){const _=r.getDirection().x%360,l=r.getLocation(),c=_/45;parseInt(r.model.getValue(g.RACE));const d=this._roomEngine.roomSessionManager.getSession(t);if(d){const E=d.userDataManager.getUserDataByIndex(e);E&&this._roomEngine.connection.send(new V_(E.webID,l.x,l.y,c))}}}break}}return a&&this.resetSelectedObjectData(t),!0}modifyRoomObjectDataWithMap(t,e,s,i,r){if(!this._roomEngine||!this._roomEngine.getRoomObject(t,e,s))return!1;switch(i){case X.OBJECT_SAVE_STUFF_DATA:this._roomEngine.connection&&this._roomEngine.connection.send(new Hg(e,r));break}return!0}modifyWallItemData(t,e,s,i){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new wg(e,s,i)),!0)}deleteWallItem(t,e){return!this._roomEngine||!this._roomEngine.connection?!1:(this._roomEngine.connection.send(new Gg(e)),!0)}getValidRoomObjectDirection(t,e){if(!t||!t.model)return 0;let s=0,i=0,r=[];t.type===lt.MONSTER_PLANT?r=t.model.getValue(g.PET_ALLOWED_DIRECTIONS):r=t.model.getValue(g.FURNITURE_ALLOWED_DIRECTIONS);let a=t.getDirection().x;if(r&&r.length){if(s=r.indexOf(a),s<0){for(s=0,i=0;i<r.length&&!(a<=r[i]);)s++,i++;s=s%r.length}e?s=(s+1)%r.length:s=(s-1+r.length)%r.length,a=r[s]}return a}isValidLocation(t,e,s){if(!t||!t.model||!e)return!1;const i=t.getDirection(),r=t.getLocation();if(!i||!r)return!1;if(i.x%180===e.x%180)return!0;let a=t.model.getValue(g.FURNITURE_SIZE_X),o=t.model.getValue(g.FURNITURE_SIZE_Y);a<1&&(a=1),o<1&&(o=1);let _=a,l=o,c=Math.trunc(Math.trunc(e.x+45)%360/90);if((c===1||c===3)&&([a,o]=[o,a]),c=Math.trunc(Math.trunc(i.x+45)%360/90),(c===1||c===3)&&([_,l]=[l,_]),s&&r){const d=t.model.getValue(g.FURNITURE_ALWAYS_STACKABLE)===1;if(s.validateLocation(r.x,r.y,a,o,r.x,r.y,_,l,d,r.z))return!0}return!1}placeObjectOnUser(t,e,s){const i=this.getSelectedRoomObjectData(t);!i||!this._roomEngine.getRoomObject(t,e,s)||!this._roomEngine||!this._roomEngine.events||this._roomEngine.events.dispatchEvent(new vm(V.PLACED_ON_USER,t,e,s,i.id,i.category))}setSelectedObject(t,e,s){if(!this._roomEngine)return;const i=this._roomEngine.events;if(i)switch(s){case S.UNIT:case S.FLOOR:case S.WALL:if(s===S.UNIT)this.deselectObject(t),this.setSelectedAvatar(t,e,!0);else if(this.setSelectedAvatar(t,0,!1),e!==this._selectedObjectId){this.deselectObject(t);const r=this._roomEngine.getRoomObject(t,e,s);r&&r.logic&&(r.logic.processUpdateMessage(new Xr(!0)),this._selectedObjectId=e,this._selectedObjectCategory=s)}i.dispatchEvent(new V(V.SELECTED,t,e,s));return}}deselectObject(t){if(this._selectedObjectId===-1)return;const e=this._roomEngine.getRoomObject(t,this._selectedObjectId,this._selectedObjectCategory);e&&e.logic&&(e.logic.processUpdateMessage(new Xr(!1)),this._selectedObjectId=-1,this._selectedObjectCategory=S.MINIMUM)}setSelectedAvatar(t,e,s){if(!this._roomEngine)return;const i=S.UNIT,r=this._roomEngine.getRoomObject(t,this._selectedAvatarId,i);r&&r.logic&&(r.logic.processUpdateMessage(new Ea(!1)),this._selectedAvatarId=-1);let a=!1;if(s){const _=this._roomEngine.getRoomObject(t,e,i);if(_&&_.logic){_.logic.processUpdateMessage(new Ea(!0)),a=!0,this._selectedAvatarId=e;const l=_.getLocation();l&&this._roomEngine.connection.send(new cE(~~l.x,~~l.y))}}const o=this._roomEngine.getRoomObjectSelectionArrow(t);o&&o.logic&&(a&&!this._roomEngine.isPlayingGame()?o.logic.processUpdateMessage(new Us(Us.ENABLED)):o.logic.processUpdateMessage(new Us(Us.DISABLED)))}resetSelectedObjectData(t){if(!this._roomEngine)return;this._roomEngine.removeObjectMoverIconSprite();const e=this.getSelectedRoomObjectData(t);if(e){if(e.operation===X.OBJECT_MOVE||e.operation===X.OBJECT_MOVE_TO){const s=this._roomEngine.getRoomObject(t,e.id,e.category);s&&e.operation!==X.OBJECT_MOVE_TO&&(s.setLocation(e.loc),s.setDirection(e.dir)),this.setFurnitureAlphaMultiplier(s,1),e.category===S.WALL&&this._roomEngine.updateRoomObjectMask(t,e.id,!0),this.updateSelectedObjectData(t,e.id,e.category,e.loc,e.dir,X.OBJECT_MOVE,e.typeId,e.instanceData,e.stuffData,e.state,e.animFrame,e.posture)}else if(e.operation===X.OBJECT_PLACE){const s=e.id;switch(e.category){case S.FLOOR:this._roomEngine.removeRoomObjectFloor(t,s);break;case S.WALL:this._roomEngine.removeRoomObjectWall(t,s);break;case S.UNIT:this._roomEngine.removeRoomObjectUser(t,s);break}}this._roomEngine.setSelectedRoomObjectData(t,null)}}getSelectedRoomObjectData(t){return this._roomEngine?this._roomEngine.getSelectedRoomObjectData(t):null}setFurnitureAlphaMultiplier(t,e){!t||!t.model||t.model.setValue(g.FURNITURE_ALPHA_MULTIPLIER,e)}decorateModeMove(t){return this._roomEngine.isDecorating&&!(t.ctrlKey||t.shiftKey)}cancelRoomObjectPlacement(t){return this.resetSelectedObjectData(t),!0}setSelectedRoomObjectData(t,e,s,i,r,a,o=0,_=null,l=null,c=-1,d=-1,E=null){if(this.resetSelectedObjectData(t),!this._roomEngine)return;const I=new Mo(e,s,a,i,r,o,_,l,c,d,E);this._roomEngine.setSelectedRoomObjectData(t,I)}updateSelectedObjectData(t,e,s,i,r,a,o=0,_=null,l=null,c=-1,d=-1,E=null){if(!this._roomEngine)return null;const I=new Mo(e,s,a,i,r,o,_,l,c,d,E);this._roomEngine.setSelectedRoomObjectData(t,I)}handleUserPlace(t,e,s,i){return i.isRoomTile(e,s)?(t.setLocation(new R(e,s,i.getHeight(e,s))),!0):!1}get engine(){return this._roomEngine}get selectedAvatarId(){return this._selectedAvatarId}}class OV{constructor(){this._events=new pe,this._cachedEvents=new Map,this._registeredEvents=new Map,this._functions=[]}getLogic(t){const e=this.getLogicType(t);if(!e)return null;const s=new e;if(!s)return null;if(s.eventDispatcher=this._events,!this._cachedEvents.get(t)){this._cachedEvents.set(t,!0);const i=s.getEventTypes();for(const r of i)r&&this.registerEventType(r)}return s}registerEventType(t){if(!this._registeredEvents.get(t)){this._registeredEvents.set(t,!0);for(const e of this._functions)e&&this._events.addEventListener(t,e)}}registerEventFunction(t){if(t&&!(this._functions.indexOf(t)>=0)){this._functions.push(t);for(const e of this._registeredEvents.keys())e&&this._events.addEventListener(e,t)}}removeEventFunction(t){if(!t)return;const e=this._functions.indexOf(t);if(e!==-1){this._functions.splice(e,1);for(const s of this._registeredEvents.keys())s&&this._events.removeEventListener(s,t)}}getLogicType(t){if(!t)return null;let e=null;switch(t){case M.ROOM:e=cH;break;case M.TILE_CURSOR:e=gH;break;case M.SELECTION_ARROW:e=dH;break;case M.USER:case M.BOT:case M.RENTABLE_BOT:e=nw;break;case M.PET:e=_H;break;case M.FURNITURE_BASIC:e=ut;break;case M.FURNITURE_BADGE_DISPLAY:e=JE;break;case M.FURNITURE_CHANGE_STATE_WHEN_STEP_ON:e=ow;break;case M.FURNITURE_COUNTER_CLOCK:e=hw;break;case M.FURNITURE_CRACKABLE:e=uw;break;case M.FURNITURE_CREDIT:e=cw;break;case M.FURNITURE_CUSTOM_STACK_HEIGHT:e=gw;break;case M.FURNITURE_DICE:e=Ew;break;case M.FURNITURE_EDITABLE_INTERNAL_LINK:e=mw;break;case M.FURNITURE_EDITABLE_ROOM_LINK:e=Iw;break;case M.FURNITURE_EXTERNAL_IMAGE_WALLITEM:e=Tw;break;case M.FURNITURE_FIREWORKS:e=pw;break;case M.FURNITURE_FLOOR_HOLE:e=Ow;break;case M.FURNITURE_GUILD_CUSTOMIZED:e=tf;break;case M.FURNITURE_HIGH_SCORE:e=Mw;break;case M.FURNITURE_HOCKEY_SCORE:e=Cw;break;case M.FURNITURE_ES:e=Dw;break;case M.FURNITURE_MANNEQUIN:e=Uw;break;case M.FURNITURE_MULTIHEIGHT:e=bw;break;case M.FURNITURE_MULTISTATE:e=Pt;break;case M.FURNITURE_ONE_WAY_DOOR:e=Gw;break;case M.FURNITURE_PET_CUSTOMIZATION:e=Bw;break;case M.FURNITURE_PRESENT:e=Vw;break;case M.FURNITURE_PURCHASABLE_CLOTHING:e=jw;break;case M.FURNITURE_PUSHABLE:e=zw;break;case M.FURNITURE_BACKGROUND_COLOR:e=Kw;break;case M.FURNITURE_BG:e=Xw;break;case M.FURNITURE_BB:e=qw;break;case M.FURNITURE_ROOMDIMMER:e=Qw;break;case M.FURNITURE_SCORE:e=Jw;break;case M.FURNITURE_SOUNDBLOCK:e=$w;break;case M.FURNITURE_STICKIE:e=eH;break;case M.FURNITURE_TROPHY:e=sH;break;case M.FURNITURE_VOTE_COUNTER:e=iH;break;case M.FURNITURE_VOTE_MAJORITY:e=rH;break;case M.FURNITURE_WINDOW:e=aH;break;case M.FURNITURE_LOVELOCK:e=Lw;break;case M.FURNITURE_YOUTUBE:e=oH;break;case M.FURNITURE_CRAFTING_GIZMO:e=lw;break;case M.FURNITURE_RENTABLE_SPACE:e=kw;break;case M.FURNITURE_EFFECTBOX:e=Rw;break;case M.FURNITURE_MONSTERPLANT_SEED:e=vw;break;case M.FURNITURE_MYSTERYBOX:e=Fw;break;case M.FURNITURE_MYSTERYTROPHY:e=xw;break;case M.FURNITURE_RANDOM_TELEPORT:e=Ww;break;case M.FURNITURE_CLOTHING_CHANGE:e=_w;break;case M.FURNITURE_CUCKOO_CLOCK:e=dw;break;case M.FURNITURE_ECOTRON_BOX:e=fw;break;case M.FURNITURE_GROUP_FORUM_TERMINAL:e=Aw;break;case M.FURNITURE_HWEEN_LOVELOCK:e=Nw;break;case M.FURNITURE_INTERNAL_LINK:e=Pw;break;case M.FURNITURE_JUKEBOX:e=yw;break;case M.FURNITURE_PLACEHOLDER:e=ww;break;case M.FURNITURE_PLANET_SYSTEM:e=Hw;break;case M.FURNITURE_RANDOMSTATE:e=Yw;break;case M.FURNITURE_SONG_DISK:e=Zw;break;case M.FURNITURE_SOUND_MACHINE:e=tH;break;case M.FURNITURE_WELCOME_GIFT:e=nH;break;case M.FURNITURE_ACHIEVEMENT_RESOLUTION:e=aw;break;case M.FURNITURE_HABBOWHEEL:e=Sw;break;default:e=ut;break}return e||(G.warn("Unknown Logic",t),null)}get events(){return this._events}}const qe=class It extends ns{constructor(t){super(),this._communication=t,this._sessionDataManager=null,this._roomSessionManager=null,this._roomManager=null,this._roomObjectEventHandler=new pV(this),this._roomMessageHandler=new TV(this),this._roomContentLoader=new zn,this._ready=!1,this._roomContentLoaderReady=!1,this._activeRoomId=-1,this._activeRoomActiveCanvas=-1,this._roomInstanceDatas=new Map,this._roomDatas=new Map,this._roomRendererFactory=new zI,this._visualizationFactory=new dV,this._logicFactory=new OV,this._activeRoomActiveCanvasMouseX=0,this._activeRoomActiveCanvasMouseY=0,this._activeRoomIsDragged=!1,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=0,this._activeRoomDragStartY=0,this._activeRoomDragX=0,this._activeRoomDragY=0,this._skipFurnitureCreationForNextFrame=!1,this._mouseCursorUpdate=!1,this._imageObjectIdBank=null,this._imageCallbacks=new Map,this._thumbnailCallbacks=new Map,this._roomDraggingAlwaysCenters=!1,this._roomAllowsDragging=!0,this._badgeListenerObjects=new Map,this.runVisibilityUpdate=this.runVisibilityUpdate.bind(this),this.processRoomObjectEvent=this.processRoomObjectEvent.bind(this),this.onRoomSessionEvent=this.onRoomSessionEvent.bind(this),this.onRoomContentLoaderReadyEvent=this.onRoomContentLoaderReadyEvent.bind(this),this.onBadgeImageReadyEvent=this.onBadgeImageReadyEvent.bind(this)}onInit(){this._ready||(this._imageObjectIdBank=new Au(1e3),this._thumbnailObjectIdBank=new Au(1e3),this._logicFactory.registerEventFunction(this.processRoomObjectEvent),this._roomManager&&(this._roomManager.setContentLoader(this._roomContentLoader),this._roomManager.addUpdateCategory(S.FLOOR),this._roomManager.addUpdateCategory(S.WALL),this._roomManager.addUpdateCategory(S.UNIT),this._roomManager.addUpdateCategory(S.CURSOR),this._roomManager.addUpdateCategory(S.ROOM)),this._roomMessageHandler.setConnection(this._communication.connection),this._roomContentLoader.initialize(this.events),this._roomContentLoader.setSessionDataManager(this._sessionDataManager),this._roomContentLoader.setIconListener(this),this._roomSessionManager&&(this._roomSessionManager.events.addEventListener(K.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.addEventListener(K.ENDED,this.onRoomSessionEvent)),this.events.addEventListener(zn.LOADER_READY,this.onRoomContentLoaderReadyEvent),Ss().add(this.update,this),document.addEventListener("visibilitychange",this.runVisibilityUpdate))}onDispose(){if(this._ready){for(const[t,e]of this._roomInstanceDatas)this.removeRoomInstance(t);document.removeEventListener("visibilitychange",this.runVisibilityUpdate),Ss().remove(this.update,this),this._roomObjectEventHandler&&this._roomObjectEventHandler.dispose(),this._roomMessageHandler&&this._roomMessageHandler.dispose(),this._roomContentLoader&&this._roomContentLoader.dispose(),this.events.removeEventListener(zn.LOADER_READY,this.onRoomContentLoaderReadyEvent),this._roomSessionManager&&(this._roomSessionManager.events.removeEventListener(K.STARTED,this.onRoomSessionEvent),this._roomSessionManager.events.removeEventListener(K.ENDED,this.onRoomSessionEvent)),super.onDispose()}}onRoomSessionEvent(t){if(t instanceof K)switch(t.type){case K.STARTED:this._roomMessageHandler&&this._roomMessageHandler.setRoomId(t.session.roomId);return;case K.ENDED:this._roomMessageHandler&&(this._roomMessageHandler.clearRoomId(),this.removeRoomInstance(t.session.roomId));return}}onRoomContentLoaderReadyEvent(t){this._roomContentLoaderReady=!0,this._roomManager.init()}setActiveRoomId(t){this._activeRoomId=t}destroyRoom(t){this.removeRoomInstance(t)}getRoomInstance(t){return this._roomManager&&this._roomManager.getRoomInstance(this.getRoomId(t))||null}removeRoomInstance(t){this.getRoomInstance(t)&&this._roomManager&&this._roomManager.removeRoomInstance(this.getRoomId(t));const s=this._roomInstanceDatas.get(t);s&&(this._roomInstanceDatas.delete(s.roomId),s.dispose()),this.events.dispatchEvent(new ot(ot.DISPOSED,t))}createRoomInstance(t,e){let s="111",i="201",r="1";if(!this._ready){let _=this._roomDatas.get(t);_&&(this._roomDatas.delete(t),s=_.floorType,i=_.wallType,r=_.landscapeType),_=new bu(t,e),_.floorType=s,_.wallType=i,_.landscapeType=r,this._roomDatas.set(t,_),G.warn("Room Engine not initilized yet, can not create room. Room data stored for later initialization.");return}if(!e){G.warn("Room property messages");return}const a=this._roomDatas.get(t);a&&(this._roomDatas.delete(t),a.floorType&&(s=a.floorType),a.wallType&&(i=a.wallType),a.landscapeType&&(r=a.landscapeType)),this.setupRoomInstance(t,e,s,i,r,this.getRoomInstanceModelName(t))&&(e.restrictsDragging?this._roomAllowsDragging=!1:this._roomAllowsDragging=!0,this.events.dispatchEvent(new ot(ot.INITIALIZED,t)))}setupRoomInstance(t,e,s,i,r,a){if(!this._ready||!this._roomManager)return;const o=this._roomManager.createRoomInstance(this.getRoomId(t));if(!o)return null;const _=S.ROOM,l=o.createRoomObjectAndInitalize(It.ROOM_OBJECT_ID,It.ROOM_OBJECT_TYPE,_);if(o.model.setValue(Rt.ROOM_IS_PUBLIC,0),o.model.setValue(Rt.ROOM_Z_SCALE,1),e&&(o.model.setValue(Rt.RESTRICTS_DRAGGING,e.restrictsDragging),o.model.setValue(Rt.RESTRICTS_SCALING,e.restrictsScaling),o.model.setValue(Rt.RESTRICTED_SCALE,e.restrictedScale),e.dimensions)){const E=e.dimensions.minX,I=e.dimensions.maxX,m=e.dimensions.minY,T=e.dimensions.maxY;o.model.setValue(Rt.ROOM_MIN_X,E),o.model.setValue(Rt.ROOM_MAX_X,I),o.model.setValue(Rt.ROOM_MIN_Y,m),o.model.setValue(Rt.ROOM_MAX_Y,T);const p=Math.trunc(E*423+I*671+m*913+T*7509);l&&l.model&&l.model.setValue(g.ROOM_RANDOM_SEED,p)}const c=l&&l.logic||null;if(c&&(c.initialize(e),s&&(c.processUpdateMessage(new Ht(Ht.ROOM_FLOOR_UPDATE,s)),o.model.setValue(g.ROOM_FLOOR_TYPE,s)),i&&(c.processUpdateMessage(new Ht(Ht.ROOM_WALL_UPDATE,i)),o.model.setValue(g.ROOM_WALL_TYPE,i)),r&&(c.processUpdateMessage(new Ht(Ht.ROOM_LANDSCAPE_UPDATE,r)),o.model.setValue(g.ROOM_LANDSCAPE_TYPE,r))),e&&e.doors.length){let d=0;for(;d<e.doors.length;){const E=e.doors[d];if(E){const I=E.x,m=E.y,T=E.z,p=E.dir,A=Vt.DOOR,N="door_"+d,C=new R(I,m,T);c.processUpdateMessage(new Vt(Vt.ADD_MASK,N,A,C,Vt.HOLE)),(p===90||p===180)&&(p===90&&(o.model.setValue(g.ROOM_DOOR_X,I-.5),o.model.setValue(g.ROOM_DOOR_Y,m)),p===180&&(o.model.setValue(g.ROOM_DOOR_X,I),o.model.setValue(g.ROOM_DOOR_Y,m-.5)),o.model.setValue(g.ROOM_DOOR_Z,T),o.model.setValue(g.ROOM_DOOR_DIR,p))}d++}}return o.createRoomObjectAndInitalize(It.CURSOR_OBJECT_ID,It.CURSOR_OBJECT_TYPE,S.CURSOR),k.getValue("enable.avatar.arrow",!1)&&o.createRoomObjectAndInitalize(It.ARROW_OBJECT_ID,It.ARROW_OBJECT_TYPE,S.CURSOR),o}getRoomInstanceDisplay(t,e,s,i,r){const a=this.getRoomInstance(t);if(!a)return null;let o=a.renderer;if(!o&&(o=this._roomRendererFactory.createRenderer(),!o))return null;o.roomObjectVariableAccurateZ=g.OBJECT_ACCURATE_Z_VALUE,a.setRenderer(o);const _=o.createCanvas(e,s,i,r);if(!_)return null;if(a.model.getValue(Rt.RESTRICTS_SCALING)){let c=a.model.getValue(Rt.RESTRICTED_SCALE);c||(c=1),_.setScale(c),_.restrictsScaling=!0}else _.restrictsScaling=!1;if(_.setMouseListener(this._roomObjectEventHandler),_.geometry){_.geometry.z_scale=a.model.getValue(Rt.ROOM_Z_SCALE);const c=a.model.getValue(g.ROOM_DOOR_X),d=a.model.getValue(g.ROOM_DOOR_Y),E=a.model.getValue(g.ROOM_DOOR_Z),I=a.model.getValue(g.ROOM_DOOR_DIR),m=new R(c,d,E);let T=null;I===90&&(T=new R(-2e3,0,0)),I===180&&(T=new R(0,-2e3,0)),_.geometry.setDisplacement(m,T);const p=_.master;if(p){const A=new Nt(Ct.EMPTY);A.name=It.OVERLAY,A.interactive=!1,p.addChild(A)}}return _.master}setRoomInstanceRenderingCanvasMask(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);i&&i.setMask(s)}setRoomInstanceRenderingCanvasScale(t,e,s,i=null,r=null,a=!1,o=!1){const _=this.getRoomInstanceRenderingCanvas(t,e);if(_){if(_.restrictsScaling&&!a)return;_.setScale(s,i,r,a,o),this.events.dispatchEvent(new ot(ot.ROOM_ZOOMED,t))}}getRoomInstanceRenderingCanvas(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;e===-1&&(e=this._activeRoomActiveCanvas);const r=i.getCanvas(e);return r||null}getActiveRoomInstanceRenderingCanvas(){return this.getRoomInstanceRenderingCanvas(this._activeRoomId,this._activeRoomActiveCanvas)}getRoomInstanceRenderingCanvasOffset(t,e=-1){e===-1&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new Y(s.screenOffsetX,s.screenOffsetY):null}setRoomInstanceRenderingCanvasOffset(t,e,s){const i=this.getRoomInstanceRenderingCanvas(t,e);if(!i||!s)return!1;const r=~~s.x,a=~~s.y;if(!(i.screenOffsetX===r&&i.screenOffsetY===a))return this.events.dispatchEvent(new ym(t,-(i.screenOffsetX-r),-(i.screenOffsetY-a))),i.screenOffsetX=r,i.screenOffsetY=a,!0}getRoomInstanceRenderingCanvasScale(t=-1e3,e=-1){t===-1e3&&(t=this._activeRoomId),e===-1&&(e=this._activeRoomActiveCanvas);const s=this.getRoomInstanceRenderingCanvas(t,e);return s?s.scale:1}initializeRoomInstanceRenderingCanvas(t,e,s,i){const r=this.getRoomInstanceRenderingCanvas(t,e);r&&r.initialize(s,i)}getRoomInstanceGeometry(t,e=-1){const s=this.getRoomInstance(t);if(!s)return null;const i=s.renderer;if(!i)return null;e===-1&&(e=this._activeRoomActiveCanvas);const r=i.getCanvas(e);return r?r.geometry:null}getRoomInstanceVariable(t,e){const s=this.getRoomInstance(t);return s&&s.model&&s.model.getValue(e)||null}updateRoomInstancePlaneVisibility(t,e,s=!0){const i=this.getRoomOwnObject(t);return i?(i.processUpdateMessage(new Ls(Ls.WALL_VISIBILITY,e)),i.processUpdateMessage(new Ls(Ls.FLOOR_VISIBILITY,s)),!0):!1}updateRoomInstancePlaneThickness(t,e,s){const i=this.getRoomOwnObject(t);return i?(i.processUpdateMessage(new ys(ys.WALL_THICKNESS,e)),i.processUpdateMessage(new ys(ys.FLOOR_THICKNESS,s)),!0):!1}updateRoomInstancePlaneType(t,e=null,s=null,i=null,r=!1){const a=this.getRoomOwnObject(t),o=this.getRoomInstance(t);if(!a){let _=this._roomDatas.get(t);return _||(_=new bu(t,null),this._roomDatas.set(t,_)),e&&(_.floorType=e),s&&(_.wallType=s),i&&(_.landscapeType=i),!0}return e&&(o&&!r&&o.model.setValue(g.ROOM_FLOOR_TYPE,e),a.processUpdateMessage(new Ht(Ht.ROOM_FLOOR_UPDATE,e))),s&&(o&&!r&&o.model.setValue(g.ROOM_WALL_TYPE,s),a.processUpdateMessage(new Ht(Ht.ROOM_WALL_UPDATE,s))),i&&(o&&!r&&o.model.setValue(g.ROOM_LANDSCAPE_TYPE,i),a.processUpdateMessage(new Ht(Ht.ROOM_LANDSCAPE_UPDATE,i))),!0}updateObjectRoomColor(t,e,s,i){const r=this.getRoomOwnObject(t);if(!r||!r.logic)return!1;const a=new ma(ma.BACKGROUND_COLOR,e,s,i);return r.logic.processUpdateMessage(a),this.events.dispatchEvent(new Pm(t,e,s,i)),!0}addRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t),i=this.getRoomObjectFloor(t,e);if(s&&s.logic&&i&&i.model){const r=i.getLocation(),a=i.model.getValue(g.FURNITURE_SIZE_X),o=i.model.getValue(g.FURNITURE_SIZE_Y);s.processUpdateMessage(new Ps(Ps.ADD,e,r.x,r.y,a,o))}}removeRoomInstanceFloorHole(t,e){if(e<0)return;const s=this.getRoomOwnObject(t);s&&s.processUpdateMessage(new Ps(Ps.REMOVE,e))}setRoomEngineGameMode(t,e){const s=this.getRoomInstance(t);if(!s)return;const i=e?1:0;s.model.setValue(Rt.IS_PLAYING_GAME,i),i===0?this.events.dispatchEvent(new ot(ot.NORMAL_MODE,t)):this.events.dispatchEvent(new ot(ot.GAME_MODE,t))}isRoomIdPlayingGame(t){const e=this.getRoomInstance(t);return e?e.model.getValue(Rt.IS_PLAYING_GAME)>0:!1}isPlayingGame(){return this.isRoomIdPlayingGame(this._activeRoomId)}disableUpdate(t){t?Ss().remove(this.update,this):(Ss().remove(this.update,this),Ss().add(this.update,this))}runUpdate(){this.update(1)}runVisibilityUpdate(){document.hidden||this.update(1,!0)}update(t,e=!1){this._roomManager&&(t=$(),Zs.turnVisualizationOn(),this.processPendingFurniture(),this._roomManager.update(t,e),this.updateRoomCameras(t),this._mouseCursorUpdate&&this.setPointer(),Zs.turnVisualizationOff())}setPointer(){this._mouseCursorUpdate=!1;const t=this.getRoomInstanceData(this._activeRoomId);t&&t.hasButtonMouseCursorOwners()?document.body.style.cursor="pointer":document.body.style.cursor="auto"}processPendingFurniture(){if(this._skipFurnitureCreationForNextFrame){this._skipFurnitureCreationForNextFrame=!1;return}const t=new Date().valueOf(),e=5;for(const s of this._roomInstanceDatas.values()){if(!s)continue;let i=null,r=0,a=!1;for(;i=s.getNextPendingFurnitureFloor();)if(a=this.processPendingFurnitureFloor(s.roomId,i.id,i),!(++r%e)&&new Date().valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}for(;!this._skipFurnitureCreationForNextFrame&&(i=s.getNextPendingFurnitureWall());)if(a=this.processPendingFurnitureWall(s.roomId,i.id,i),!(++r%e)&&new Date().valueOf()-t>=40){this._skipFurnitureCreationForNextFrame=!0;break}if(a&&this._roomManager&&(this._roomManager.getRoomInstance(this.getRoomId(s.roomId)).hasUninitializedObjects()||this.objectsInitialized(s.roomId.toString())),this._skipFurnitureCreationForNextFrame)return}}onRoomEngineInitalized(t){if(t){this._ready=!0,this.events.dispatchEvent(new ot(ot.ENGINE_INITIALIZED,0));for(const e of this._roomDatas.values())e&&this.createRoomInstance(e.roomId,e.data)}}processPendingFurnitureFloor(t,e,s){if(!s){const _=this.getRoomInstanceData(t);if(_&&(s=_.getPendingFurnitureFloor(e)),!s)return!1}let i=s.type;i||(i=this.getFurnitureFloorName(s.typeId));const r=this.createRoomObjectFloor(t,e,i);if(!r)return!1;const a=r.model;if(a&&(a.setValue(g.FURNITURE_COLOR,this.getFurnitureFloorColorIndex(s.typeId)),a.setValue(g.FURNITURE_TYPE_ID,s.typeId),a.setValue(g.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),a.setValue(g.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),a.setValue(g.FURNITURE_EXPIRY_TIME,s.expiryTime),a.setValue(g.FURNITURE_EXPIRTY_TIMESTAMP,$()),a.setValue(g.FURNITURE_USAGE_POLICY,s.usagePolicy),a.setValue(g.FURNITURE_OWNER_ID,s.ownerId),a.setValue(g.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectFloor(t,e,s.location,s.direction,s.state,s.data,s.extra)||s.sizeZ>=0&&!this.updateRoomObjectFloorHeight(t,e,s.sizeZ))return!1;this.events&&this.events.dispatchEvent(new V(V.ADDED,t,e,S.FLOOR));const o=this.getPlacedRoomObjectData(t);return o&&o.id===e&&o.category===S.FLOOR&&this.selectRoomObject(t,e,S.FLOOR),r.isReady&&s.synchronized&&this.addObjectToTileMap(t,r),!0}processPendingFurnitureWall(t,e,s){if(!s){const l=this.getRoomInstanceData(t);if(l&&(s=l.getPendingFurnitureWall(e)),!s)return!1}let i="";s.data&&(i=s.data.getLegacyString());let r=this.getFurnitureWallName(s.typeId,i);r||(r="");const a=this.createRoomObjectWall(t,e,r);if(!a)return!1;const o=a.model;if(o&&(o.setValue(g.FURNITURE_COLOR,this.getFurnitureWallColorIndex(s.typeId)),o.setValue(g.FURNITURE_TYPE_ID,s.typeId),o.setValue(g.FURNITURE_AD_URL,this.getRoomObjectAdUrl(s.type)),o.setValue(g.FURNITURE_REAL_ROOM_OBJECT,s.realRoomObject?1:0),o.setValue(g.OBJECT_ACCURATE_Z_VALUE,1),o.setValue(g.FURNITURE_EXPIRY_TIME,s.expiryTime),o.setValue(g.FURNITURE_EXPIRTY_TIMESTAMP,$()),o.setValue(g.FURNITURE_USAGE_POLICY,s.usagePolicy),o.setValue(g.FURNITURE_OWNER_ID,s.ownerId),o.setValue(g.FURNITURE_OWNER_NAME,s.ownerName)),!this.updateRoomObjectWall(t,e,s.location,s.direction,s.state,i))return!1;this.events&&this.events.dispatchEvent(new V(V.ADDED,t,e,S.WALL));const _=this.getPlacedRoomObjectData(t);return _&&Math.abs(_.id)===e&&_.category===S.WALL&&this.selectRoomObject(t,e,S.WALL),!0}setRoomSessionOwnUser(t,e){if(!this._roomSessionManager)return;const s=this._roomSessionManager.getSession(t);s&&s.setOwnRoomIndex(e);const i=this.getRoomCamera(t);i&&(i.targetId=e,i.targetCategory=S.UNIT,i.activateFollowing(this.cameraFollowDuration))}get cameraFollowDuration(){return 1e3}updateRoomCameras(t){for(const e of this._roomInstanceDatas.values()){if(!e)continue;const s=e.roomCamera;if(!s)continue;let i=null;const r=this.getRoomObject(e.roomId,s.targetId,s.targetCategory);r&&(i=r.getLocation()),i&&(e.roomId!==this._activeRoomId||!this._activeRoomIsDragged)&&this.updateRoomCamera(e.roomId,1,i,t)}if(this._activeRoomWasDragged){const e=this.getRoomInstanceRenderingCanvas(this._activeRoomId,1);e&&this.setRoomInstanceRenderingCanvasOffset(this._activeRoomId,1,new Y(e.screenOffsetX+this._activeRoomDragX,e.screenOffsetY+this._activeRoomDragY)),this._activeRoomDragX=0,this._activeRoomDragY=0}}updateRoomCamera(t,e,s,i){const r=this.getRoomInstanceRenderingCanvas(t,e),a=this.getRoomInstanceData(t);if(!r||!a||r.scale!==1)return;const o=r.geometry,_=a.roomCamera,l=this.getRoomInstance(t);if(!o||!_||!l)return;const c=this.getRoomCanvasRectangle(t,e);if(!c)return;let d=Math.floor(s.z)+1;const E=Math.round(c.width),I=Math.round(c.height),m=this.getCanvasBoundingRectangle(e);if(m&&(m.right<0||m.bottom<0||m.left>=E||m.top>=I)&&_.reset(),_.screenWd!==E||_.screenHt!==I||_.scale!==o.scale||_.geometryUpdateId!==o.updateId||!R.isEqual(s,_.targetObjectLoc)||_.isMoving){_.targetObjectLoc=s;const T=new R;T.assign(s),T.x=Math.round(T.x),T.y=Math.round(T.y);const p=l.model.getValue(Rt.ROOM_MIN_X)-.5,A=l.model.getValue(Rt.ROOM_MIN_Y)-.5,N=l.model.getValue(Rt.ROOM_MAX_X)+.5,C=l.model.getValue(Rt.ROOM_MAX_Y)+.5,L=Math.round((p+N)/2),D=Math.round((A+C)/2),v=2;let b=new Y(T.x-L,T.y-D);const q=o.scale/Math.sqrt(2),Q=q/2,tt=new ue;tt.rotate(-(o.direction.x+90)/180*Math.PI),b=tt.apply(b),b.y=b.y*(Q/q);const ct=c.width/2/q-1,Kt=c.height/2/Q-1;let Ut=0,be=0,Ze=0,us=0,Gt=o.getScreenPoint(new R(L,D,v));if(!Gt)return;if(Gt.x=Gt.x+Math.round(c.width/2),Gt.y=Gt.y+Math.round(c.height/2),m)if(m.x+=-r.screenOffsetX,m.y+=-r.screenOffsetY,m.width>1&&m.height>1)Ut=(m.left-Gt.x-o.scale*.25)/q,Ze=(m.right-Gt.x+o.scale*.25)/q,be=(m.top-Gt.y-o.scale*.5)/Q,us=(m.bottom-Gt.y+o.scale*.5)/Q;else{o.adjustLocation(new R(-30,-30),25);return}else{o.adjustLocation(new R(0,0),25);return}let yn=!1,Or=!1,fo=!1,mo=!1;Math.round((Ze-Ut)*q)<c.width?(d=2,b.x=(Ze+Ut)/2,fo=!0):(b.x>Ze-ct&&(b.x=Ze-ct,yn=!0),b.x<Ut+ct&&(b.x=Ut+ct,yn=!0)),Math.round((us-be)*Q)<c.height?(d=2,b.y=(us+be)/2,mo=!0):(b.y>us-Kt&&(b.y=us-Kt,Or=!0),b.y<be+Kt&&(b.y=be+Kt,Or=!0),Or&&(b.y=b.y/(Q/q))),tt.invert(),b=tt.apply(b),b.x=b.x+L,b.y=b.y+D;let Gi=.35,_i=.2,Ln=.2;const au=10,ou=10;if(Ln*E>100&&(Ln=100/E),Gi*I>150&&(Gi=150/I),_i*I>150&&(_i=150/I),_.limitedLocationX&&_.screenWd==E&&_.screenHt==I&&(Ln=0),_.limitedLocationY&&_.screenWd==E&&_.screenHt==I&&(Gi=0,_i=0),c.width=c.width*(1-Ln*2),c.height=c.height*(1-(Gi+_i)),c.width<au&&(c.width=au),c.height<ou&&(c.height=ou),Gi+_i>0?(c.x+=-c.width/2,c.y+=-c.height*(_i/(Gi+_i))):(c.x+=-c.width/2,c.y+=-c.height/2),Gt=o.getScreenPoint(T),!Gt)return;if(Gt){Gt.x=Gt.x+r.screenOffsetX,Gt.y=Gt.y+r.screenOffsetY,T.z=d,T.x=Math.round(b.x*2)/2,T.y=Math.round(b.y*2)/2,_.location||(o.location=T,this.useOffsetScrolling?_.initializeLocation(new R(0,0,0)):_.initializeLocation(T));const Io=o.getScreenPoint(T),Ro=new R(0,0,0);Io&&(Ro.x=Io.x,Ro.y=Io.y),(Gt.x<c.left||Gt.x>c.right)&&!_.centeredLocX||(Gt.y<c.top||Gt.y>c.bottom)&&!_.centeredLocY||fo&&!_.centeredLocX&&_.screenWd!=E||mo&&!_.centeredLocY&&_.screenHt!=I||_.roomWd!=m.width||_.roomHt!=m.height||_.screenWd!=E||_.screenHt!=I?(_.limitedLocationX=yn,_.limitedLocationY=Or,this.useOffsetScrolling?_.target=Ro:_.target=T):(yn||(_.limitedLocationX=!1),Or||(_.limitedLocationY=!1))}_.centeredLocX=fo,_.centeredLocY=mo,_.screenWd=E,_.screenHt=I,_.scale=o.scale,_.geometryUpdateId=o.updateId,_.roomWd=m.width,_.roomHt=m.height,this._sessionDataManager.isCameraFollowDisabled||(this.useOffsetScrolling?_.update(i,8):_.update(i,.5)),this.useOffsetScrolling?this.setRoomInstanceRenderingCanvasOffset(this.activeRoomId,1,new Y(-_.location.x,-_.location.y)):o.adjustLocation(_.location,25)}else _.limitedLocationX=!1,_.limitedLocationY=!1,_.centeredLocX=!1,_.centeredLocY=!1}getRoomCanvasRectangle(t,e){const s=this.getRoomInstanceRenderingCanvas(t,e);return s?new de(0,0,s.width,s.height):null}getRoomObjectBoundingRectangle(t,e,s,i){const r=this.getRoomInstanceGeometry(t,i);if(!r)return null;const a=this.getRoomObject(t,e,s);if(!a)return null;const o=a.visualization;if(!o)return null;const _=o.getBoundingRectangle(),l=this.getRoomInstanceRenderingCanvas(t,i),c=l?l.scale:1,d=r.getScreenPoint(a.getLocation());return!d||(d.x=Math.round(d.x),d.y=Math.round(d.y),_.x=_.x*c,_.y=_.y*c,_.width=_.width*c,_.height=_.height*c,d.x=d.x*c,d.y=d.y*c,_.x+=d.x,_.y+=d.y,!l)?null:(_.x+=Math.round(l.width/2)+l.screenOffsetX,_.y+=Math.round(l.height/2)+l.screenOffsetY,_)}getCanvasBoundingRectangle(t){return this.getRoomObjectBoundingRectangle(this._activeRoomId,It.ROOM_OBJECT_ID,S.ROOM,t)}getFurnitureFloorName(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorNameForTypeId(t):null}getFurnitureWallName(t,e=null){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallNameForTypeId(t,e):null}getFurnitureFloorColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureFloorColorIndex(t):null}getFurnitureWallColorIndex(t){return this._roomContentLoader?this._roomContentLoader.getFurnitureWallColorIndex(t):null}getRoomInstanceData(t){const e=this._roomInstanceDatas.get(t);if(e)return e;const s=new mV(t);return this._roomInstanceDatas.set(s.roomId,s),s}getRoomInstanceModelName(t){const e=this.getRoomInstanceData(t);return e?e.modelName:null}setRoomInstanceModelName(t,e){const s=this.getRoomInstanceData(t);s&&s.setModelName(e)}getRoomTileObjectMap(t){const e=this.getRoomInstanceData(t);return e?e.tileObjectMap:null}getCurrentRoomCamera(){return this.getRoomCamera(this._activeRoomId)}getRoomCamera(t){const e=this.getRoomInstanceData(t);return e?e.roomCamera:null}getSelectedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.selectedObject:null}setSelectedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setSelectedObject(e),e&&s.setPlacedObject(null)}getPlacedRoomObjectData(t){const e=this.getRoomInstanceData(t);return e?e.placedObject:null}setPlacedRoomObjectData(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setPlacedObject(e)}cancelRoomObjectPlacement(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectPlacement(this._activeRoomId)}getFurnitureStackingHeightMap(t){const e=this.getRoomInstanceData(t);return e?e.furnitureStackingHeightMap:null}setFurnitureStackingHeightMap(t,e){const s=this.getRoomInstanceData(t);if(!s)return null;s.setFurnitureStackingHeightMap(e)}getLegacyWallGeometry(t){const e=this.getRoomInstanceData(t);return e?e.legacyGeometry:null}createRoomObjectAndInitialize(t,e,s,i){const r=this.getRoomInstance(t);return r?r.createRoomObjectAndInitalize(e,s,i):null}getTotalObjectsForManager(t,e){const s=this.getRoomInstance(t);return s?s.getTotalObjectsForManager(e):0}getRoomObject(t,e,s){if(!this._ready)return null;let i=this.getRoomId(t);return t===0&&(i=It.TEMPORARY_ROOM),this.getObject(i,e,s)}getObject(t,e,s){let i=null;if(this._roomManager&&(i=this._roomManager.getRoomInstance(t)),!i)return null;let r=i.getRoomObject(e,s);if(!r)switch(s){case S.FLOOR:this.processPendingFurnitureFloor(this.getRoomIdFromString(t),e,null),r=i.getRoomObject(e,s);break;case S.WALL:this.processPendingFurnitureWall(this.getRoomIdFromString(t),e,null),r=i.getRoomObject(e,s);break}return r}getRoomObjectByIndex(t,e,s){const i=this.getRoomInstance(t);return i?i.getRoomObjectByIndex(e,s):null}getRoomObjectCategoryForType(t){return!t||!this._roomContentLoader?S.MINIMUM:this._roomContentLoader.getCategoryForType(t)}getRoomObjectCursor(t){return this.getObject(this.getRoomId(t),It.CURSOR_OBJECT_ID,S.CURSOR)}getRoomObjectSelectionArrow(t){return this.getObject(this.getRoomId(t),It.ARROW_OBJECT_ID,S.CURSOR)}getRoomOwnObject(t){return this.getObject(this.getRoomId(t),It.ROOM_OBJECT_ID,S.ROOM)}getRoomObjectUser(t,e){return this.getObject(this.getRoomId(t),e,S.UNIT)}removeRoomObjectUser(t,e){return this.removeRoomObject(t,e,S.UNIT)}createRoomObjectUser(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,S.UNIT)}getRoomObjectFloor(t,e){return this.getObject(this.getRoomId(t),e,S.FLOOR)}createRoomObjectFloor(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,S.FLOOR)}removeRoomObjectFloor(t,e,s=-1,i=!1){const r=this.getRoomInstanceData(t);if(r&&r.removePendingFunitureFloor(e),this._sessionDataManager&&s===this._sessionDataManager.userId&&!Gu.isBuilderClubId(e)){const a=this.getRoomObject(t,e,S.FLOOR);if(a){const o=this.getRoomObjectScreenLocation(t,e,S.FLOOR,this._activeRoomActiveCanvas);if(o&&!(a.model.getValue(g.FURNITURE_DISABLE_PICKING_ANIMATION)===1)){const l=a.model.getValue(g.FURNITURE_TYPE_ID),c=a.model.getValue(g.FURNITURE_EXTRAS),d=a.model.getValue(g.FURNITURE_DATA_FORMAT),E=$s.getData(d),I=this.getFurnitureFloorIcon(l,null,c,E).data;if(I){const m=At.generateImage(I);if(this.events){const T=new Eu(m,o.x,o.y);T.iconName=Fs.INVENTORY,this.events.dispatchEvent(T)}}}}}this.removeRoomObject(t,e,S.FLOOR),this.setMouseDefault(t,S.FLOOR,e),i&&this.refreshTileObjectMap(t,"RoomEngine.disposeObjectFurniture()")}getRoomObjectWall(t,e){return this.getObject(this.getRoomId(t),e,S.WALL)}removeRoomObjectWall(t,e,s=-1){if(this._sessionDataManager&&s===this._sessionDataManager.userId&&!Gu.isBuilderClubId(e)){const i=this.getRoomObject(t,e,S.WALL);if(i&&i.type.indexOf("post_it")===-1&&i.type.indexOf("external_image_wallitem")===-1){const r=this.getRoomObjectScreenLocation(t,e,S.WALL,this._activeRoomActiveCanvas);if(r){const a=i.model.getValue(g.FURNITURE_TYPE_ID),o=i.model.getValue(g.FURNITURE_DATA),_=this.getFurnitureWallIcon(a,null,o).data;if(_){const l=At.generateImage(_);if(this.events){const c=new Eu(l,r.x,r.y);c.iconName=Fs.INVENTORY,this.events.dispatchEvent(c)}}}}}this.removeRoomObject(t,e,S.WALL),this.updateRoomObjectMask(t,e,!1),this.setMouseDefault(t,S.WALL,e)}createRoomObjectWall(t,e,s){return this.createRoomObjectAndInitialize(t,e,s,S.WALL)}removeRoomObject(t,e,s){const i=this.getRoomInstance(t);if(!i)return null;i.removeRoomObject(e,s),this.events&&this.events.dispatchEvent(new V(V.REMOVED,t,e,s))}addFurnitureFloor(t,e,s,i,r,a,o,_=NaN,l=-1,c=0,d=0,E="",I=!0,m=!0,T=-1){const p=this.getRoomInstanceData(t);if(!p)return!1;const A=new So(e,s,null,i,r,a,o,_,l,c,d,E,I,m,T);return p.addPendingFurnitureFloor(A),!0}addFurnitureFloorByTypeName(t,e,s,i,r,a,o,_=NaN,l=-1,c=0,d=0,E="",I=!0,m=!0,T=-1){const p=this.getRoomInstanceData(t);if(!p)return!1;const A=new So(e,0,s,i,r,a,o,_,l,c,d,E,I,m,T);return p.addPendingFurnitureFloor(A),!0}addFurnitureWall(t,e,s,i,r,a,o,_=-1,l=0,c=0,d="",E=!0){const I=this.getRoomInstanceData(t);if(!I)return!1;const m=new Re;m.setString(o);const T=new So(e,s,null,i,r,a,m,NaN,_,l,c,d,!0,E);return I.addPendingFurnitureWall(T),!0}updateRoomObjectFloor(t,e,s,i,r,a,o=null){const _=this.getRoomObjectFloor(t,e);return _?(_.processUpdateMessage(new bt(s,i)),_.processUpdateMessage(new mt(r,a,o)),!0):!1}updateRoomObjectWall(t,e,s,i,r,a=null){const o=this.getRoomObjectWall(t,e);if(!o||!o.logic)return!1;const _=new bt(s,i),l=new Re,c=new mt(r,l);return l.setString(a),o.logic.processUpdateMessage(_),o.logic.processUpdateMessage(c),this.updateRoomObjectMask(t,e),!0}updateRoomObjectWallItemData(t,e,s){const i=this.getRoomObjectWall(t,e);return!i||!i.logic?!1:(i.logic.processUpdateMessage(new Gh(s)),!0)}updateRoomObjectFloorHeight(t,e,s){const i=this.getRoomObjectFloor(t,e);return i?(i.processUpdateMessage(new kE(null,null,s)),!0):!1}updateRoomObjectFloorExpiration(t,e,s){const i=this.getRoomObjectFloor(t,e);return i?(i.model.setValue(g.FURNITURE_EXPIRY_TIME,s),i.model.setValue(g.FURNITURE_EXPIRTY_TIMESTAMP,$()),!0):!1}updateRoomObjectWallExpiration(t,e,s){const i=this.getRoomObjectWall(t,e);return i?(i.model.setValue(g.FURNITURE_EXPIRY_TIME,s),i.model.setValue(g.FURNITURE_EXPIRTY_TIMESTAMP,$()),!0):!1}updateRoomObjectMask(t,e,s=!0){const i=S.WALL+"_"+e,r=this.getRoomObjectWall(t,e);let a=null;if(r&&r.model){if(r.model.getValue(g.FURNITURE_USES_PLANE_MASK)>0){const _=r.model.getValue(g.FURNITURE_PLANE_MASK_TYPE),l=r.getLocation();s?a=new Vt(Vt.ADD_MASK,i,_,l):a=new Vt(Vt.REMOVE_MASK,i)}}else a=new Vt(Vt.REMOVE_MASK,i);const o=this.getRoomOwnObject(t);o&&o.logic&&a&&o.logic.processUpdateMessage(a)}rollRoomObjectFloor(t,e,s,i){const r=this.getRoomObjectFloor(t,e);r&&r.processUpdateMessage(new ii(s,i,null,!!i))}updateRoomObjectWallLocation(t,e,s){const i=this.getRoomObjectWall(t,e);return i?(i.logic&&i.logic.processUpdateMessage(new ii(s,null,null)),this.updateRoomObjectMask(t,e),!0):!1}addRoomObjectUser(t,e,s,i,r,a,o){if(this.getRoomObjectUser(t,e))return!1;let l=lt.getTypeString(a);l===lt.PET&&(l=this.getPetType(o));const c=this.createRoomObjectUser(t,e,l);return c?(c.processUpdateMessage(new fa(this.fixedUserLocation(t,s),null,i,r,!1,0)),o&&c.processUpdateMessage(new ga(o)),this.events&&this.events.dispatchEvent(new V(V.ADDED,t,e,S.UNIT)),!0):!1}updateRoomObjectUserLocation(t,e,s,i,r=!1,a=0,o=null,_=NaN){const l=this.getRoomObjectUser(t,e);if(!l)return!1;s||(s=l.getLocation()),o||(o=l.getDirection()),isNaN(_)&&(_=l.model.getValue(g.HEAD_DIRECTION)),l.processUpdateMessage(new fa(this.fixedUserLocation(t,s),this.fixedUserLocation(t,i),o,_,r,a));const c=this._roomSessionManager&&this._roomSessionManager.getSession(t)||null;return c&&c.ownRoomIndex===e&&this._logicFactory.events.dispatchEvent(new Wr(Wr.ROAME_MOVE_TO,i)),!0}fixedUserLocation(t,e){if(!e)return null;const s=this.getFurnitureStackingHeightMap(t),i=this.getLegacyWallGeometry(t);if(!s||!i)return e;let r=e.z;const a=s.getTileHeight(e.x,e.y),o=i.getHeight(e.x,e.y);return Math.abs(r-a)<.1&&Math.abs(a-o)<.1&&(r=i.getFloorAltitude(e.x,e.y)),new R(e.x,e.y,r)}updateRoomObjectUserAction(t,e,s,i,r=null){const a=this.getRoomObjectUser(t,e);if(!a)return!1;let o=null;switch(s){case g.FIGURE_TALK:o=new bh(i);break;case g.FIGURE_SLEEP:o=new xh(i===1);break;case g.FIGURE_IS_TYPING:o=new YE(i===1);break;case g.FIGURE_IS_MUTED:o=new BE(i===1);break;case g.FIGURE_CARRY_OBJECT:o=new LE(i,r);break;case g.FIGURE_USE_OBJECT:o=new WE(i);break;case g.FIGURE_DANCE:o=new UE(i);break;case g.FIGURE_GAINED_EXPERIENCE:o=new bE(i);break;case g.FIGURE_NUMBER_VALUE:o=new VE(i);break;case g.FIGURE_SIGN:o=new zE(i);break;case g.FIGURE_EXPRESSION:o=new FE(i);break;case g.FIGURE_IS_PLAYING_GAME:o=new jE(i===1);break;case g.FIGURE_GUIDE_STATUS:o=new rw(i);break}return o?(a.processUpdateMessage(o),!0):!1}updateRoomObjectUserFigure(t,e,s,i=null,r=null,a=!1){const o=this.getRoomObjectUser(t,e);return o?(o.processUpdateMessage(new ga(s,i,r,a)),!0):!1}updateRoomObjectUserFlatControl(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new xE(parseInt(s))),!0):!1}updateRoomObjectUserEffect(t,e,s,i=0){const r=this.getRoomObjectUser(t,e);return r?(r.processUpdateMessage(new vE(s,i)),!0):!1}updateRoomObjectUserGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new GE(s)),!0):!1}updateRoomObjectUserPetGesture(t,e,s){const i=this.getRoomObjectUser(t,e);return i?(i.processUpdateMessage(new HE(s)),!0):!1}updateRoomObjectUserPosture(t,e,s,i=null){const r=this.getRoomObjectUser(t,e);return r?(r.processUpdateMessage(new Fh(s,i)),!0):!1}updateRoomObjectUserOwn(t,e){const s=this.getRoomObjectUser(t,e);s&&s.processUpdateMessage(new wE)}useRoomObject(t,e){const s=this.getRoomObject(this._activeRoomId,t,e);if(s){const i=s.logic;if(i)return i.useObject(),!0}return!1}objectInitialized(t,e,s){const i=this.getRoomIdFromString(t);s===S.WALL&&this.updateRoomObjectMask(i,e);const r=this.getRoomObject(i,e,s);if(r&&r.model&&r.logic){const a=r.model.getValue(g.FURNITURE_DATA_FORMAT);if(!isNaN(a)){const o=$s.getData(a);o.initializeFromRoomObjectModel(r.model),r.processUpdateMessage(new mt(r.getState(0),o))}this.events.dispatchEvent(new V(V.CONTENT_UPDATED,i,e,s))}t!==It.TEMPORARY_ROOM&&this.addObjectToTileMap(i,r)}changeObjectModelData(t,e,s,i,r){const a=this.getObject(this.getRoomId(t),e,s);if(!a||!a.logic)return!1;const o=new KE(i,r);return a.processUpdateMessage(o),!0}changeObjectState(t,e,s){const i=this.getObject(this.getRoomId(t),e,s);if(!i||!i.model)return;let r=i.model.getValue(g.FURNITURE_AUTOMATIC_STATE_INDEX);isNaN(r)?r=1:r=r+1,i.model.setValue(g.FURNITURE_AUTOMATIC_STATE_INDEX,r);const a=i.model.getValue(g.FURNITURE_DATA_FORMAT),o=$s.getData(a);o.initializeFromRoomObjectModel(i.model),i.logic&&i.logic.processUpdateMessage(new mt(r,o))}loadRoomObjectBadgeImage(t,e,s,i,r=!0){if(!this._sessionDataManager)return;let a=null;if(t===0){const _=this._roomManager.getRoomInstance(It.TEMPORARY_ROOM);_&&(a=_.getRoomObject(e,s))}else a=this.getRoomObjectFloor(t,e);if(!a||!a.logic)return;let o=r?this._sessionDataManager.loadGroupBadgeImage(i):this._sessionDataManager.loadBadgeImage(i);if(o)this.putBadgeInObjectAssets(a,i,r);else{o="loading_icon",this._badgeListenerObjects||(this._badgeListenerObjects=new Map),this._badgeListenerObjects.size||this._sessionDataManager.events.addEventListener(ia.IMAGE_READY,this.onBadgeImageReadyEvent);let _=this._badgeListenerObjects.get(i);_||(_=[]),_.push(new IV(a,r)),this._badgeListenerObjects.set(i,_)}a.logic.processUpdateMessage(new nr(i,o))}onBadgeImageReadyEvent(t){if(!this._sessionDataManager)return;const e=this._badgeListenerObjects&&this._badgeListenerObjects.get(t.badgeId);if(e){for(const s of e){if(!s)continue;this.putBadgeInObjectAssets(s.object,t.badgeId,s.groupBadge);const i=s.groupBadge?this._sessionDataManager.loadGroupBadgeImage(t.badgeId):this._sessionDataManager.loadBadgeImage(t.badgeId);s.object&&s.object.logic&&s.object.logic.processUpdateMessage(new nr(t.badgeId,i))}this._badgeListenerObjects.delete(t.badgeId),this._badgeListenerObjects.size||this._sessionDataManager.events.removeEventListener(ia.IMAGE_READY,this.onBadgeImageReadyEvent)}}putBadgeInObjectAssets(t,e,s=!1){if(!this._roomContentLoader||!this._sessionDataManager)return;const i=s?this._sessionDataManager.loadGroupBadgeImage(e):this._sessionDataManager.loadBadgeImage(e),r=s?this._sessionDataManager.getGroupBadgeImage(e):this._sessionDataManager.getBadgeImage(e);r&&this._roomContentLoader.addAssetToCollection(t.type,i,r,!1)}dispatchMouseEvent(t,e,s,i,r,a,o,_){const l=this.getRoomInstanceRenderingCanvas(this._activeRoomId,t);if(!l)return;const c=this.getRenderingCanvasOverlay(l),d=this.getOverlayIconSprite(c,It.OBJECT_ICON_SPRITE);if(d){const E=d.getLocalBounds();d.x=e-E.width/2,d.y=s-E.height/2}if(!this.handleRoomDragging(l,e,s,i,r,a,o)&&!l.handleMouseEvent(e,s,i,r,a,o,_)){let E=null;i===F.MOUSE_CLICK?(this.events&&this.events.dispatchEvent(new V(V.DESELECTED,this._activeRoomId,-1,S.MINIMUM)),E=j.CLICK):i===F.MOUSE_MOVE?E=j.MOUSE_MOVE:i===F.MOUSE_DOWN?E=j.MOUSE_DOWN:i===F.MOUSE_DOWN_LONG?E=j.MOUSE_DOWN_LONG:i===F.MOUSE_UP&&(E=j.MOUSE_UP),this._roomObjectEventHandler.handleRoomObjectEvent(new j(E,this.getRoomObject(this._activeRoomId,It.ROOM_OBJECT_ID,S.ROOM),null,r),this._activeRoomId)}this._activeRoomActiveCanvas=t,this._activeRoomActiveCanvasMouseX=e,this._activeRoomActiveCanvasMouseY=s}handleRoomDragging(t,e,s,i,r,a,o){let _=e-this._activeRoomActiveCanvasMouseX,l=s-this._activeRoomActiveCanvasMouseY;if(i===F.MOUSE_DOWN)!r&&!a&&!o&&!this.isDecorating&&this._roomAllowsDragging&&(this._activeRoomIsDragged=!0,this._activeRoomWasDragged=!1,this._activeRoomDragStartX=this._activeRoomActiveCanvasMouseX,this._activeRoomDragStartY=this._activeRoomActiveCanvasMouseY);else if(i===F.MOUSE_UP){if(this._activeRoomIsDragged&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged)){const c=this.getRoomInstanceData(this._activeRoomId);if(c){const d=c.roomCamera;d&&(this.useOffsetScrolling&&(d.isMoving||(d.centeredLocX=!1,d.centeredLocY=!1),d.resetLocation(new R(-t.screenOffsetX,-t.screenOffsetY))),this._roomDraggingAlwaysCenters&&d.reset())}}}else if(i===F.MOUSE_MOVE)this._activeRoomIsDragged&&(this._activeRoomWasDragged||(_=e-this._activeRoomDragStartX,l=s-this._activeRoomDragStartY,(_<=-It.DRAG_THRESHOLD||_>=It.DRAG_THRESHOLD||l<=-It.DRAG_THRESHOLD||l>=It.DRAG_THRESHOLD)&&(this._activeRoomWasDragged=!0),_=0,l=0),(_!=0||l!=0)&&(this._activeRoomDragX+=_,this._activeRoomDragY+=l,this._activeRoomWasDragged=!0));else if((i===F.MOUSE_CLICK||i===F.DOUBLE_CLICK)&&(this._activeRoomIsDragged=!1,this._activeRoomWasDragged))return this._activeRoomWasDragged=!1,!0;return!1}updateMousePointer(t,e,s){const i=this.getRoomObjectCategoryForType(s);switch(t){case y.MOUSE_BUTTON:this.setMouseButton(this._activeRoomId,i,e);return;default:this.setMouseDefault(this._activeRoomId,i,e);return}}setMouseButton(t,e,s){if(!this._roomSessionManager)return;const i=this._roomSessionManager.getSession(t);if(i&&(e!==S.FLOOR&&e!==S.WALL||i.controllerLevel>=Ie.GUEST)){const r=this.getRoomInstanceData(t);r&&r.addButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}}setMouseDefault(t,e,s){if(!this._roomSessionManager)return;const i=this.getRoomInstanceData(t);i&&i.removeButtonMouseCursorOwner(e+"_"+s)&&(this._mouseCursorUpdate=!0)}processRoomObjectOperation(t,e,s){if(!this._roomObjectEventHandler)return!1;this._roomObjectEventHandler.modifyRoomObject(this._activeRoomId,t,e,s)}modifyRoomObjectDataWithMap(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===S.FLOOR&&this._roomObjectEventHandler.modifyRoomObjectDataWithMap(this._activeRoomId,t,e,s,i)}modifyRoomObjectData(t,e,s,i){if(!this._roomObjectEventHandler)return!1;e===S.WALL&&this._roomObjectEventHandler.modifyWallItemData(this._activeRoomId,t,s,i)}processRoomObjectEvent(t){if(!this._roomObjectEventHandler)return;const e=this.getRoomObjectRoomId(t.object);if(!e)return;const s=this.getRoomIdFromString(e);this._roomObjectEventHandler.handleRoomObjectEvent(t,s)}processRoomObjectPlacement(t,e,s,i,r=null,a=null,o=-1,_=-1,l=null){const c=this.getRoomInstance(this._activeRoomId);return!c||c.model.getValue(Rt.ROOM_IS_PUBLIC)!==0||!this._roomObjectEventHandler?!1:this._roomObjectEventHandler.processRoomObjectPlacement(t,this._activeRoomId,e,s,i,r,a,o,_,l)}getRoomObjectScreenLocation(t,e,s,i=-1){i==-1&&(i=this._activeRoomActiveCanvas);const r=this.getRoomInstanceGeometry(t,i);if(!r)return null;const a=this.getRoomObject(t,e,s);if(!a)return null;const o=r.getScreenPoint(a.getLocation());if(!o)return null;const _=this.getRoomInstanceRenderingCanvas(t,i);return _?(o.x=o.x*_.scale,o.y=o.y*_.scale,o.x+=_.width/2+_.screenOffsetX,o.y+=_.height/2+_.screenOffsetY,o.x=Math.round(o.x),o.y=Math.round(o.y),o):null}selectRoomObject(t,e,s){this._roomObjectEventHandler&&this._roomObjectEventHandler.setSelectedObject(t,e,s)}setSelectedAvatar(t,e){this._roomObjectEventHandler||this._roomObjectEventHandler.setSelectedAvatar(t,e,!0)}cancelRoomObjectInsert(){this._roomObjectEventHandler&&this._roomObjectEventHandler.cancelRoomObjectInsert(this._activeRoomId)}addOverlayIconSprite(t,e,s,i=1){if(!t||!s)return;let r=this.getOverlayIconSprite(t,e);return r?null:(r=new Nt(s),r.name=e,r.scale.set(i),t.addChild(r),r)}onRoomContentLoaded(t,e,s){if(!this._roomContentLoader||t===-1)return;this._thumbnailObjectIdBank.freeNumber(t-1);const i=this._thumbnailCallbacks.get(e);if(i){this._thumbnailCallbacks.delete(e);const r=this._roomContentLoader.getImage(e);if(r)for(const a of i)a&&a.imageReady(t,null,r)}}setObjectMoverIconSprite(t,e,s,i=null,r=null,a=-1,o=-1,_=null){let l=null,c=0,d=null;const E=1;if(s)d=this.getRoomObjectImage(this._activeRoomId,t,e,new R,1,null);else if(this._roomContentLoader)if(e===S.FLOOR?(l=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),c=this._roomContentLoader.getFurnitureFloorColorIndex(t)):e===S.WALL&&(l=this._roomContentLoader.getFurnitureWallNameForTypeId(t,i),c=this._roomContentLoader.getFurnitureWallColorIndex(t)),e===S.UNIT)if(l=lt.getTypeString(t),l==="pet"){l=this.getPetType(i);const p=new Aa(i);d=this.getRoomObjectPetImage(p.typeId,p.paletteId,p.color,new R(180),64,null,!0,0,p.customParts,_)}else d=this.getGenericRoomObjectImage(l,i,new R(180),64,null,0,null,r,a,o,_);else d=this.getGenericRoomObjectImage(l,c.toString(),new R,1,null,0,i,r,a,o,_);if(!d||!d.data)return;const I=this.getActiveRoomInstanceRenderingCanvas();if(!I)return;const m=this.getRenderingCanvasOverlay(I);this.removeOverlayIconSprite(m,It.OBJECT_ICON_SPRITE);const T=this.addOverlayIconSprite(m,It.OBJECT_ICON_SPRITE,d.data,E);T&&(T.x=this._activeRoomActiveCanvasMouseX-d.data.width/2,T.y=this._activeRoomActiveCanvasMouseY-d.data.height/2)}getRoomObjectImage(t,e,s,i,r,a,o=0){if(!this._roomManager)return null;let _=-1,l=null,c=null,d="",E=null;const I=this.getRoomId(t),m=this._roomManager.getRoomInstance(I);if(m){const T=m.getRoomObject(e,s);if(T&&T.model)switch(_=T.id,l=T.type,s){case S.FLOOR:case S.WALL:{d=T.model.getValue(g.FURNITURE_COLOR).toString(),E=T.model.getValue(g.FURNITURE_EXTRAS);const p=T.model.getValue(g.FURNITURE_DATA_FORMAT);p!==Re.FORMAT_KEY&&(c=$s.getData(p),c.initializeFromRoomObjectModel(T.model));break}case S.UNIT:d=T.model.getValue(g.FIGURE);break}}return this.getGenericRoomObjectImage(l,d,i,r,a,o,E,c,-1,-1,null,_)}getFurnitureFloorIconUrl(t){let e=null,s="";return this._roomContentLoader?(e=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),s=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(e,s)):null}getFurnitureFloorIcon(t,e,s=null,i=null){return this.getFurnitureFloorImage(t,new R,1,e,0,s,-1,-1,i)}getFurnitureWallIconUrl(t,e=null){let s=null,i="";return this._roomContentLoader?(s=this._roomContentLoader.getFurnitureWallNameForTypeId(t,e),i=this._roomContentLoader.getFurnitureWallColorIndex(t).toString(),this._roomContentLoader.getAssetIconUrl(s,i)):null}getFurnitureWallIcon(t,e,s=null){return this.getFurnitureWallImage(t,new R,1,e,0,s)}getFurnitureFloorImage(t,e,s,i,r=0,a=null,o=-1,_=-1,l=null){let c=null,d="";return this._roomContentLoader&&(c=this._roomContentLoader.getFurnitureFloorNameForTypeId(t),d=this._roomContentLoader.getFurnitureFloorColorIndex(t).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(c,d,i,a,l):this.getGenericRoomObjectImage(c,d,e,s,i,r,a,l,o,_)}getFurnitureWallImage(t,e,s,i,r=0,a=null,o=-1,_=-1){let l=null,c="";return this._roomContentLoader&&(l=this._roomContentLoader.getFurnitureWallNameForTypeId(t),c=this._roomContentLoader.getFurnitureWallColorIndex(t).toString()),s===1&&i?this.getGenericRoomObjectThumbnail(l,c,i,a,null):this.getGenericRoomObjectImage(l,c,e,s,i,r,a,null,o,_)}getRoomObjectPetImage(t,e,s,i,r,a,o=!1,_=0,l=null,c=null){let d=null,E=t+" "+e+" "+s.toString(16);if(o&&(E=E+" head"),l){E=E+(" "+l.length);for(const I of l)E=E+(" "+I.layerId+" "+I.partId+" "+I.paletteId)}return this._roomContentLoader&&(d=this._roomContentLoader.getPetNameForType(t)),this.getGenericRoomObjectImage(d,E,i,r,a,_,null,null,-1,-1,c)}getGenericRoomObjectImage(t,e,s,i,r,a=0,o=null,_=null,l=-1,c=-1,d=null,E=-1){if(!this._roomManager)return null;const I=new Pu;if(I.id=-1,!this._ready||!t)return I;let m=this._roomManager.getRoomInstance(It.TEMPORARY_ROOM);if(!m&&(m=this._roomManager.createRoomInstance(It.TEMPORARY_ROOM),!m))return I;let T=this._imageObjectIdBank.reserveNumber();const p=this.getRoomObjectCategoryForType(t);if(T<0)return I;T++;const A=m.createRoomObjectAndInitalize(T,t,p);if(!A||!A.model||!A.logic)return I;const N=A.model;switch(p){case S.FLOOR:case S.WALL:N.setValue(g.FURNITURE_COLOR,parseInt(e)),N.setValue(g.FURNITURE_EXTRAS,o);break;case S.UNIT:if(t===lt.USER||t===lt.BOT||t===lt.RENTABLE_BOT||t===lt.PET)N.setValue(g.FIGURE,e);else{const v=new Aa(e);N.setValue(g.PET_PALETTE_INDEX,v.paletteId),N.setValue(g.PET_COLOR,v.color),v.headOnly&&N.setValue(g.PET_HEAD_ONLY,1),v.hasCustomParts&&(N.setValue(g.PET_CUSTOM_LAYER_IDS,v.customLayerIds),N.setValue(g.PET_CUSTOM_PARTS_IDS,v.customPartIds),N.setValue(g.PET_CUSTOM_PALETTE_IDS,v.customPaletteIds)),d&&N.setValue(g.FIGURE_POSTURE,d)}break}A.setDirection(s);const C=A.visualization;if(!C)return m.removeRoomObject(T,p),I;(l>-1||_)&&(_&&_.getLegacyString()!==""?A.logic.processUpdateMessage(new mt(parseInt(_.getLegacyString()),_)):A.logic.processUpdateMessage(new mt(l,_)));const L=new kr(i,new R(-135,30,0),new R(11,11,5));if(C.update(L,0,!0,!1),c>0){let v=0;for(;v<c;)C.update(L,0,!0,!1),v++}const D=C.getImage(a,E);if(I.data=D,I.id=T,!this.isRoomContentTypeLoaded(t)&&r){let v=this._imageCallbacks.get(T.toString());v||(v=[],this._imageCallbacks.set(T.toString(),v)),v.push(r),N.setValue(g.IMAGE_QUERY_SCALE,i)}else m.removeRoomObject(T,p),this._imageObjectIdBank.freeNumber(T-1),I.id=0;return L.dispose(),I}getGenericRoomObjectThumbnail(t,e,s,i=null,r=null){if(!this._roomManager)return null;const a=new Pu;if(a.id=-1,!this._ready||!t)return a;let o=this._roomManager.getRoomInstance(It.TEMPORARY_ROOM);if(!o&&(o=this._roomManager.createRoomInstance(It.TEMPORARY_ROOM),!o))return a;let _=this._thumbnailObjectIdBank.reserveNumber();if(this.getRoomObjectCategoryForType(t),_<0)return a;_++,a.id=_,a.data=null,a.image=null;const l=[t,e].join("_"),c=this._roomContentLoader.getImage(l);if(!c&&s){let d=this._thumbnailCallbacks.get(l);d||(d=[],this._thumbnailCallbacks.set(l,d),this._roomContentLoader.downloadImage(_,t,e,null)),d.push(s)}else c&&(a.image=c),this._thumbnailObjectIdBank.freeNumber(_-1),a.id=0;return a}initalizeTemporaryObjectsByType(t,e){const s=this._roomManager.getRoomInstance(It.TEMPORARY_ROOM);if(!s||!this._roomContentLoader)return;const i=this._roomContentLoader.getCategoryForType(t),r=s.getManager(i);let a=null,o=0;if(r&&r.objects.length){for(const _ of r.objects.getValues())if(_&&_.model&&_.type===t){const l=_.id,c=_.visualization;let d=null;if(c){const I=_.model.getValue(g.IMAGE_QUERY_SCALE);a&&o!==I&&(a.dispose(),a=null),a||(o=I,a=new kr(I,new R(-135,30,0),new R(11,11,5))),c.update(a,0,!0,!1),d=c.image}s.removeRoomObject(l,i),this._imageObjectIdBank.freeNumber(l-1);const E=this._imageCallbacks.get(l.toString());if(E){this._imageCallbacks.delete(l.toString());for(const I of E)I&&(d?I.imageReady(l,d):I.imageFailed(l))}}}a&&a.dispose()}setObjectMoverIconSpriteVisible(t){const e=this.getActiveRoomInstanceRenderingCanvas();if(!e)return;const s=this.getRenderingCanvasOverlay(e),i=this.getOverlayIconSprite(s,It.OBJECT_ICON_SPRITE);i&&(i.visible=t)}removeObjectMoverIconSprite(){const t=this.getActiveRoomInstanceRenderingCanvas();if(!t)return;const e=this.getRenderingCanvasOverlay(t);this.removeOverlayIconSprite(e,It.OBJECT_ICON_SPRITE)}getRenderingCanvasOverlay(t){if(!t)return null;const e=t.master;return e&&e.getChildByName(It.OVERLAY)||null}removeOverlayIconSprite(t,e){if(!t)return!1;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e){if(t.removeChildAt(s),i.children.length){const r=i.getChildAt(0);r.parent.removeChild(r),r.destroy()}return!0}s--}return!1}getOverlayIconSprite(t,e){if(!t)return null;let s=t.children.length-1;for(;s>=0;){const i=t.getChildAt(s);if(i&&i.name===e)return i;s--}return null}getRoomObjects(t,e){if(this._ready){const s=this.getRoomId(t),i=this._roomManager.getRoomInstance(s);if(i)return i.getRoomObjectsForCategory(e)}return[]}addObjectToTileMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.addRoomObject(e)}refreshTileObjectMap(t,e){const s=this.getRoomInstanceData(t).tileObjectMap;s&&s.populate(this.getRoomObjects(t,S.FLOOR))}getRenderRoomMessage(t,e,s=!1,i=!0,r=!1,a=-1){let o=null;if(a>-1?o=this.getRoomInstanceRenderingCanvas(this._activeRoomId,a):o=this.getActiveRoomInstanceRenderingCanvas(),!o)return null;r&&o.skipSpriteVisibilityChecking();let _=-1;!i&&this._roomSessionManager.getSession(this._activeRoomId)!=null&&(_=this._roomSessionManager.getSession(this._activeRoomId).ownRoomIndex);const l=new RV,c=l.getFurniData(t,o,this,_),d=l.getRoomRenderingModifiers(this),E=l.getRoomPlanes(t,o,this,e);return r&&o.resumeSpriteVisibilityChecking(),G.log(c,d,E),null}createTextureFromRoom(t,e=-1,s=null){let i=null;e>-1?i=this.getRoomInstanceRenderingCanvas(this._activeRoomId,e):i=this.getActiveRoomInstanceRenderingCanvas();let r=null;return s?r=At.generateTexture(i.master,s):r=i.getDisplayAsTexture(),r}saveTextureAsScreenshot(t,e=!1){let s=null;e?s=new w_:s=new da,s.assignBitmap(t),this._communication.connection.send(s)}saveBase64AsScreenshot(t,e=!1){let s=null;e?s=new w_:s=new da,s.assignBase64(t),this._communication.connection.send(s)}objectsInitialized(t){const e=this.getRoomIdFromString(t);this.events.dispatchEvent(new ot(ot.OBJECTS_INITIALIZED,e))}getRoomId(t){return t.toString()}getRoomIdFromString(t){if(!t)return-1;const e=t.split("_");return e.length<=0?-1:parseInt(e[0])||0}getRoomObjectRoomId(t){return!t||!t.model?null:t.model.getValue(g.OBJECT_ROOM_ID)}getRoomObjectAdUrl(t){return this._roomContentLoader.getRoomObjectAdUrl(t)}getPetTypeId(t){let e=-1;if(t){const s=t.split(" ");s.length>1&&(e=parseInt(s[0]))}return e}getPetType(t){if(!t)return null;const e=t.split(" ");if(e.length>1){const s=parseInt(e[0]);return this._roomContentLoader?this._roomContentLoader.getPetNameForType(s):"pet"}return null}isRoomContentTypeLoaded(t){return this._roomContentLoader?this._roomContentLoader.getCollection(t)!==null:!1}getPetColorResult(t,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResult(t,e):null}getPetColorResultsForTag(t,e){return this._roomContentLoader?this._roomContentLoader.getPetColorResultsForTag(t,e):null}deleteRoomObject(t,e){return!this._roomObjectEventHandler||e!==S.WALL?!1:this._roomObjectEventHandler.deleteWallItem(this._activeRoomId,t)}get connection(){return this._communication.connection}get sessionDataManager(){return this._sessionDataManager}set sessionDataManager(t){this._sessionDataManager=t}get roomSessionManager(){return this._roomSessionManager}set roomSessionManager(t){this._roomSessionManager=t}get roomManager(){return this._roomManager}set roomManager(t){this._roomManager=t}get objectEventHandler(){return this._roomObjectEventHandler}get roomRendererFactory(){return this._roomRendererFactory}get visualizationFactory(){return this._visualizationFactory}get logicFactory(){return this._logicFactory}get activeRoomId(){return this._activeRoomId}get ready(){return this._ready}get roomContentLoader(){return this._roomContentLoader}get isDecorating(){if(!this._roomSessionManager)return!1;const t=this._roomSessionManager.getSession(this._activeRoomId);return t&&t.isDecorating||!1}get useOffsetScrolling(){return!0}get selectedAvatarId(){return this._roomObjectEventHandler?this._roomObjectEventHandler.selectedAvatarId:-1}getRoomObjectCount(t,e){return this._roomManager==null?0:this._roomManager.getRoomInstance(t.toString()).getRoomObjectsForCategory(e).length}};qe.ROOM_OBJECT_ID=-1;qe.ROOM_OBJECT_TYPE="room";qe.CURSOR_OBJECT_ID=-2;qe.CURSOR_OBJECT_TYPE="tile_cursor";qe.ARROW_OBJECT_ID=-3;qe.ARROW_OBJECT_TYPE="selection_arrow";qe.OVERLAY="overlay";qe.OBJECT_ICON_SPRITE="object_icon_sprite";qe.DRAG_THRESHOLD=15;qe.TEMPORARY_ROOM="temporary_room";let Zh=qe;const Qe=class x{constructor(t,e=1){this._previewRoomId=1,this._currentPreviewObjectType=0,this._currentPreviewObjectCategory=0,this._currentPreviewObjectData="",this._currentPreviewRectangle=null,this._currentPreviewCanvasWidth=0,this._currentPreviewCanvasHeight=0,this._currentPreviewScale=64,this._backgroundColor=305148561,this._backgroundSprite=null,this._disableUpdate=!1,this._roomEngine=t,this._planeParser=new jt,this._previewRoomId=Pc.makeRoomPreviewerId(e),this._addViewOffset=new Y(0,0),this.onRoomObjectAdded=this.onRoomObjectAdded.bind(this),this.onRoomInitializedonRoomInitialized=this.onRoomInitializedonRoomInitialized.bind(this),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.addEventListener(V.ADDED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(V.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.addEventListener(ot.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this.createRoomForPreview()}dispose(){this.reset(!0),this.isRoomEngineReady&&this._roomEngine.events&&(this._roomEngine.events.removeEventListener(V.ADDED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(V.CONTENT_UPDATED,this.onRoomObjectAdded),this._roomEngine.events.removeEventListener(ot.INITIALIZED,this.onRoomInitializedonRoomInitialized)),this._backgroundSprite&&(this._backgroundSprite.destroy(),this._backgroundSprite=null),this._planeParser&&(this._planeParser.dispose(),this._planeParser=null)}createRoomForPreview(){if(this.isRoomEngineReady){const e=new jt;e.initializeTileMap(7+2,7+2);let s=1;for(;s<1+7;){let i=1;for(;i<1+7;)e.setTileHeight(i,s,0),i++;s++}e.initializeFromTileData(),this._roomEngine.createRoomInstance(this._previewRoomId,e.getMapData()),e.dispose()}}reset(t){this.isRoomEngineReady&&(this._roomEngine.removeRoomObjectFloor(this._previewRoomId,x.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectWall(this._previewRoomId,x.PREVIEW_OBJECT_ID),this._roomEngine.removeRoomObjectUser(this._previewRoomId,x.PREVIEW_OBJECT_ID),t||this.updatePreviewRoomView()),this._currentPreviewObjectCategory=S.MINIMUM}updatePreviewModel(t,e,s=!0){const i=new jc;i.flush(),i.parseModel(t,e,s);const r=this._roomEngine.getLegacyWallGeometry(this._previewRoomId);if(!r)return;this._planeParser.reset();const a=i.width,o=i.height;this._planeParser.initializeTileMap(a,o);const _=null;let l=-1,c=-1,d=0,E=0,I=0;for(;I<o;){let A=0;for(;A<a;){const N=i.getHeight(A,I);(I>0&&I<o-1||A>0&&A<a-1)&&N!=jt.TILE_BLOCKED&&_==null&&(i.getHeight(A,I-1)==jt.TILE_BLOCKED&&i.getHeight(A-1,I)==jt.TILE_BLOCKED&&i.getHeight(A,I+1)==jt.TILE_BLOCKED&&(l=A+.5,c=I,d=N,E=90),i.getHeight(A,I-1)==jt.TILE_BLOCKED&&i.getHeight(A-1,I)==jt.TILE_BLOCKED&&i.getHeight(A+1,I)==jt.TILE_BLOCKED&&(l=A,c=I+.5,d=N,E=180)),this._planeParser.setTileHeight(A,I,N),A++}I++}this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),d),this._planeParser.initializeFromTileData(i.wallHeight),this._planeParser.setTileHeight(Math.floor(l),Math.floor(c),d+this._planeParser.wallHeight),r.scale=Jh.DEFAULT_SCALE,r.initialize(a,o,this._planeParser.floorHeight);let m=i.height-1;for(;m>=0;){let A=i.width-1;for(;A>=0;)r.setHeight(A,m,this._planeParser.getTileHeight(A,m)),A--;m--}const T=this._planeParser.getMapData();T.doors.push({x:l,y:c,z:d,dir:E});const p=this.getRoomPreviewOwnRoomObject();p&&p.processUpdateMessage(new QE(T))}addFurnitureIntoRoom(t,e,s=null,i=null){if(s||(s=new Re),this.isRoomEngineReady&&(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=S.FLOOR,this._currentPreviewObjectData="",this._roomEngine.addFurnitureFloor(this._previewRoomId,x.PREVIEW_OBJECT_ID,t,new R(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),e,0,s,NaN,-1,0,-1,"",!0,!1))){this._previousAutomaticStateChangeTime=$(),this._automaticStateChange=!0;const r=this._roomEngine.getRoomObject(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);return r&&i&&r.model.setValue(g.FURNITURE_EXTRAS,i),this.updatePreviewRoomView(),x.PREVIEW_OBJECT_ID}return-1}addWallItemIntoRoom(t,e,s){if(this.isRoomEngineReady){if(this._currentPreviewObjectCategory===S.WALL&&this._currentPreviewObjectType===t&&this._currentPreviewObjectData===s)return x.PREVIEW_OBJECT_ID;if(this.reset(!1),this._currentPreviewObjectType=t,this._currentPreviewObjectCategory=S.WALL,this._currentPreviewObjectData=s,this._roomEngine.addFurnitureWall(this._previewRoomId,x.PREVIEW_OBJECT_ID,t,new R(.5,2.3,1.8),e,0,s,0,0,-1,"",!1))return this._previousAutomaticStateChangeTime=$(),this._automaticStateChange=!0,this.updatePreviewRoomView(),x.PREVIEW_OBJECT_ID}return-1}addAvatarIntoRoom(t,e){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=S.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,x.PREVIEW_OBJECT_ID,new R(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),new R(90,0,0),135,lt.getTypeNumber(lt.USER),t)&&(this._previousAutomaticStateChangeTime=$(),this._automaticStateChange=!0,this.updateUserGesture(1),this.updateUserEffect(e),this.updateUserPosture("std")),this.updatePreviewRoomView(),x.PREVIEW_OBJECT_ID):-1}addPetIntoRoom(t){return this.isRoomEngineReady?(this.reset(!1),this._currentPreviewObjectType=1,this._currentPreviewObjectCategory=S.UNIT,this._currentPreviewObjectData=t,this._roomEngine.addRoomObjectUser(this._previewRoomId,x.PREVIEW_OBJECT_ID,new R(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),new R(90,0,0),90,lt.getTypeNumber(lt.PET),t)&&(this._previousAutomaticStateChangeTime=$(),this._automaticStateChange=!1,this.updateUserGesture(1),this.updateUserPosture("std")),this.updatePreviewRoomView(),x.PREVIEW_OBJECT_ID):-1}updateUserPosture(t,e=""){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserPosture(this._previewRoomId,x.PREVIEW_OBJECT_ID,t,e)}updateUserGesture(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserGesture(this._previewRoomId,x.PREVIEW_OBJECT_ID,t)}updateUserEffect(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserEffect(this._previewRoomId,x.PREVIEW_OBJECT_ID,t)}updateObjectUserFigure(t,e=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomObjectUserFigure(this._previewRoomId,x.PREVIEW_OBJECT_ID,t,e,s,i):!1}updateObjectUserAction(t,e,s=null){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserAction(this._previewRoomId,x.PREVIEW_OBJECT_ID,t,e,s)}updateObjectStuffData(t){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectFloor(this._previewRoomId,x.PREVIEW_OBJECT_ID,null,null,t.state,t)}changeRoomObjectState(){this.isRoomEngineReady&&(this._automaticStateChange=!1,this._currentPreviewObjectCategory!==S.UNIT&&this._roomEngine.changeObjectState(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}changeRoomObjectDirection(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(!t)return;const e=this._roomEngine.objectEventHandler.getValidRoomObjectDirection(t,!0);switch(this._currentPreviewObjectCategory){case S.FLOOR:{const s=new R(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y),i=new R(e,e,e);this._roomEngine.updateRoomObjectFloor(this._previewRoomId,x.PREVIEW_OBJECT_ID,s,i,null,null);return}case S.WALL:return}}}checkAutomaticRoomObjectStateChange(){if(this._automaticStateChange){const t=$();t>this._previousAutomaticStateChangeTime+x.AUTOMATIC_STATE_CHANGE_INTERVAL&&(this._previousAutomaticStateChangeTime=t,this.isRoomEngineReady&&this._roomEngine.changeObjectState(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory))}}getRoomCanvas(t,e){if(this.isRoomEngineReady){const s=this._roomEngine.getRoomInstanceDisplay(this._previewRoomId,x.PREVIEW_CANVAS_ID,t,e,this._currentPreviewScale);if(s&&this._backgroundColor!==null){let r=this._backgroundSprite;r||(r=new Nt(Ct.WHITE),s.addChildAt(r,0)),r.width=t,r.height=e,r.tint=this._backgroundColor}this._roomEngine.setRoomInstanceRenderingCanvasMask(this._previewRoomId,x.PREVIEW_CANVAS_ID,!0);const i=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,x.PREVIEW_CANVAS_ID);return i&&i.adjustLocation(new R(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),30),this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,s}return null}modifyRoomCanvas(t,e){this.isRoomEngineReady&&(this._currentPreviewCanvasWidth=t,this._currentPreviewCanvasHeight=e,this._backgroundSprite&&(this._backgroundSprite.width=t,this._backgroundSprite.height=e),this._roomEngine.initializeRoomInstanceRenderingCanvas(this._previewRoomId,x.PREVIEW_CANVAS_ID,t,e))}set addViewOffset(t){this._addViewOffset=t}get addViewOffset(){return this._addViewOffset}updatePreviewObjectBoundingRectangle(t){const e=this._roomEngine.getRoomObjectBoundingRectangle(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,x.PREVIEW_CANVAS_ID);if(e&&t)if(e.x+=-(this._currentPreviewCanvasWidth>>1),e.y+=-(this._currentPreviewCanvasHeight>>1),e.x+=-t.x,e.y+=-t.y,!this._currentPreviewRectangle)this._currentPreviewRectangle=e;else{const s=this._currentPreviewRectangle.clone().enlarge(e);(s.width-this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth-this._currentPreviewRectangle.width>>1||s.height-this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1||this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)&&(this._currentPreviewRectangle=s)}}validatePreviewSize(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;if(this.isRoomEngineReady){const e=this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,x.PREVIEW_CANVAS_ID);this._currentPreviewRectangle.width>this._currentPreviewCanvasWidth*(1+x.ALLOWED_IMAGE_CUT)||this._currentPreviewRectangle.height>this._currentPreviewCanvasHeight*(1+x.ALLOWED_IMAGE_CUT)?x.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID)!==.5&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID,.5,null,null),this._currentPreviewScale=x.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0,t.x=t.x>>1,t.y=t.y>>1,this._currentPreviewRectangle.x=this._currentPreviewRectangle.x>>2,this._currentPreviewRectangle.y=this._currentPreviewRectangle.y>>2,this._currentPreviewRectangle.width=this._currentPreviewRectangle.width>>2,this._currentPreviewRectangle.height=this._currentPreviewRectangle.height>>2):e.isZoomedIn()&&(e.performZoomOut(),this._currentPreviewScale=x.SCALE_SMALL,this._currentPreviewNeedsZoomOut=!0):this._currentPreviewNeedsZoomOut||(x.ZOOM_ENABLED?this._roomEngine.getRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID)!==1&&(this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID,1,null,null),this._currentPreviewScale=x.SCALE_NORMAL):e.isZoomedIn()||(e.performZoomIn(),this._currentPreviewScale=x.SCALE_NORMAL))}return t}zoomIn(){this.isRoomEngineReady&&(x.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID,1):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,x.PREVIEW_CANVAS_ID).performZoomIn()),this._currentPreviewScale=x.SCALE_NORMAL}zoomOut(){this.isRoomEngineReady&&(x.ZOOM_ENABLED?this._roomEngine.setRoomInstanceRenderingCanvasScale(this._previewRoomId,x.PREVIEW_CANVAS_ID,.5):this._roomEngine.getRoomInstanceGeometry(this._previewRoomId,x.PREVIEW_CANVAS_ID).performZoomOut()),this._currentPreviewScale=x.SCALE_SMALL}updateAvatarDirection(t,e){this.isRoomEngineReady&&this._roomEngine.updateRoomObjectUserLocation(this._previewRoomId,x.PREVIEW_OBJECT_ID,new R(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),new R(x.PREVIEW_OBJECT_LOCATION_X,x.PREVIEW_OBJECT_LOCATION_Y,0),!1,0,new R(t*45,0,0),e*45)}updateObjectRoom(t=null,e=null,s=null,i=!1){return this.isRoomEngineReady?this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,t,e,s,i):!1}updateRoomWallsAndFloorVisibility(t,e=!0){this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneVisibility(this._previewRoomId,t,e)}getCanvasOffset(t){if(this._currentPreviewRectangle.width<1||this._currentPreviewRectangle.height<1)return t;let e=-(this._currentPreviewRectangle.left+this._currentPreviewRectangle.right)>>1,s=-(this._currentPreviewRectangle.top+this._currentPreviewRectangle.bottom)>>1;const i=this._currentPreviewCanvasHeight-this._currentPreviewRectangle.height>>1;i>10?s=s+Math.min(15,i-10):this._currentPreviewObjectCategory!==S.UNIT?s=s+(5-Math.max(0,i/2)):s=s-(5-Math.min(0,i/2)),s=s+this._addViewOffset.y,e=e+this._addViewOffset.x;const r=e-t.x,a=s-t.y;if(r!==0||a!==0){const o=Math.sqrt(r*r+a*a);return o>10&&(e=t.x+r*10/o,s=t.y+a*10/o),new Y(e,s)}return null}updatePreviewRoomView(t=!1){if(!(this._disableUpdate&&!t)&&(this.checkAutomaticRoomObjectStateChange(),this.isRoomEngineReady)){let e=this._roomEngine.getRoomInstanceRenderingCanvasOffset(this._previewRoomId,x.PREVIEW_CANVAS_ID);if(e&&(this.updatePreviewObjectBoundingRectangle(e),this._currentPreviewRectangle)){const s=this._currentPreviewScale;e=this.validatePreviewSize(e);const i=this.getCanvasOffset(e);i&&this._roomEngine.setRoomInstanceRenderingCanvasOffset(this._previewRoomId,x.PREVIEW_CANVAS_ID,i),this._currentPreviewScale!==s&&(this._currentPreviewRectangle=null)}}}set disableUpdate(t){this._disableUpdate=t}set disableRoomEngineUpdate(t){this.isRoomEngineReady&&this._roomEngine.disableUpdate(t)}onRoomInitializedonRoomInitialized(t){if(t)switch(t.type){case ot.INITIALIZED:t.roomId===this._previewRoomId&&this.isRoomEngineReady&&this._roomEngine.updateRoomInstancePlaneType(this._previewRoomId,"110","99999");return}}onRoomObjectAdded(t){if(t.roomId===this._previewRoomId&&t.objectId===x.PREVIEW_OBJECT_ID&&t.category===this._currentPreviewObjectCategory){this._currentPreviewRectangle=null,this._currentPreviewNeedsZoomOut=!1;const e=this._roomEngine.getRoomObject(t.roomId,t.objectId,t.category);if(e&&e.model&&t.category===S.WALL){const s=e.model.getValue(g.FURNITURE_SIZE_Z),i=e.model.getValue(g.FURNITURE_CENTER_Z);(s!==null||i!==null)&&this._roomEngine.updateRoomObjectWallLocation(t.roomId,t.objectId,new R(.5,2.3,(3.6-s)/2+i))}}}updateRoomEngine(){this.isRoomEngineReady&&this._roomEngine.runUpdate()}getRenderingCanvas(){const t=this._roomEngine.getRoomInstanceRenderingCanvas(this._previewRoomId,x.PREVIEW_CANVAS_ID);return t||null}getGenericRoomObjectImage(t,e,s,i,r,a=0,o=null,_=null,l=-1,c=-1,d=null){return this.isRoomEngineReady?this._roomEngine.getGenericRoomObjectImage(t,e,s,i,r,a,o,_,l,c,d):null}getRoomObjectImage(t,e,s,i=0){return this.isRoomEngineReady?this._roomEngine.getRoomObjectImage(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory,t,e,s,i):null}getRoomObjectCurrentImage(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t&&t.visualization)return t.visualization.getImage(16777215,-1)}return null}getRoomPreviewObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,x.PREVIEW_OBJECT_ID,this._currentPreviewObjectCategory);if(t)return t}return null}getRoomPreviewOwnRoomObject(){if(this.isRoomEngineReady){const t=this._roomEngine.getRoomObject(this._previewRoomId,Zh.ROOM_OBJECT_ID,S.ROOM);if(t)return t}return null}get isRoomEngineReady(){return this._roomEngine&&this._roomEngine.ready}get roomId(){return this._previewRoomId}get backgroundColor(){return this._backgroundColor}set backgroundColor(t){this._backgroundColor=t}get width(){return this._currentPreviewCanvasWidth}get height(){return this._currentPreviewCanvasHeight}};Qe.SCALE_NORMAL=64;Qe.SCALE_SMALL=32;Qe.PREVIEW_COUNTER=0;Qe.PREVIEW_CANVAS_ID=1;Qe.PREVIEW_OBJECT_ID=1;Qe.PREVIEW_OBJECT_LOCATION_X=2;Qe.PREVIEW_OBJECT_LOCATION_Y=2;Qe.ALLOWED_IMAGE_CUT=.25;Qe.AUTOMATIC_STATE_CHANGE_INTERVAL=2500;Qe.ZOOM_ENABLED=!0;let Aj=Qe;class Fu{constructor(t,e){this._image=t,this._placeHolder=e}get image(){return this._image}get placeHolder(){return this._placeHolder}}class AV{constructor(t){this._code=t,this._parts=[]}get code(){return this._code}get parts(){return this._parts}}const hs=class ce{constructor(t,e=0,s=0,i=0){this.type=t,this.key=e,this.color=s,this.position=i}get code(){return this.key===0?null:ce.getCode(this.type,this.key,this.color,this.position)}static getCode(t,e,s,i){return(t===ce.BASE?t:e>=100?ce.SYMBOL_ALT:ce.SYMBOL)+(e<10?"0":"")+(t===ce.BASE?e:e>=100?e-100:e)+(s<10?"0":"")+s+i}calculatePosition(t){const e=this.calculateGridPos(this.position);let s=ce.CELL_WIDTH*e.x+ce.CELL_WIDTH/2-t.width/2,i=ce.CELL_HEIGHT*e.y+ce.CELL_HEIGHT/2-t.height/2;return s<0&&(s=0),s+t.width>ce.IMAGE_WIDTH&&(s=ce.IMAGE_WIDTH-t.width),i<0&&(i=0),i+t.height>ce.IMAGE_HEIGHT&&(i=ce.IMAGE_HEIGHT-t.height),new ta(Math.floor(s),Math.floor(i))}calculateGridPos(t){const e=new ta;return e.x=Math.floor(t%3),e.y=Math.floor(t/3),e}};hs.BASE="b";hs.SYMBOL="s";hs.SYMBOL_ALT="t";hs.BASE_PART=0;hs.LAYER_PART=1;hs.IMAGE_WIDTH=39;hs.IMAGE_HEIGHT=39;hs.CELL_WIDTH=13;hs.CELL_HEIGHT=13;let Co=hs;const $h=class Rs{constructor(t,e){this._assets=t,this._sessionDataManager=e,this._groupBases=new Map,this._groupSymbols=new Map,this._groupPartColors=new Map,this._requestedBadges=new Map,this._groupBadgesQueue=new Map,this._readyToGenerateGroupBadges=!1}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new ad(this.onGroupBadgePartsEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}getBadgeImage(t,e=Rs.NORMAL_BADGE,s=!0){let i=this.getBadgeTexture(t,e);return!i&&s&&(i=this.getBadgePlaceholder()),i}getBadgeInfo(t){const e=this.getBadgeTexture(t);return e?new Fu(e,!1):new Fu(this.getBadgePlaceholder(),!0)}loadBadgeImage(t,e=Rs.NORMAL_BADGE){return this._assets.getTexture(this.getBadgeUrl(t,e))?t:(this.getBadgeTexture(t,e),null)}getBadgeTexture(t,e=Rs.NORMAL_BADGE){const s=this.getBadgeUrl(t,e);if(!s||!s.length)return null;const i=this._assets.getTexture(s);if(i)return i.clone();if(e===Rs.NORMAL_BADGE){if(this._requestedBadges.get(t))return null;this._requestedBadges.set(t,!0),this._assets.downloadAsset(s).then(r=>{if(!r)return;this._requestedBadges.delete(t);const a=this._assets.getTexture(s);a&&this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new ia(t,a.clone()))}).catch(r=>{})}else if(e===Rs.GROUP_BADGE){if(this._groupBadgesQueue.get(t))return;this._groupBadgesQueue.set(t,!0),this._readyToGenerateGroupBadges&&this.loadGroupBadge(t)}return null}getBadgePlaceholder(){const t=k.getValue("images.url")+"/loading_icon.png",e=this._assets.getTexture(t);return e?e.clone():null}getBadgeUrl(t,e=Rs.NORMAL_BADGE){let s=null;switch(e){case Rs.NORMAL_BADGE:s=k.getValue("badge.asset.url").replace("%badgename%",t);break;case Rs.GROUP_BADGE:s=t;break}return s}loadGroupBadge(t){const e=new AV(t),s=[...t.matchAll(/[b|s][0-9]{4,6}/g)];for(const i of s){const r=i[0],a=r.length===6,o=r[0],_=parseInt(r.slice(1,a?3:4)),l=parseInt(r.slice(a?3:4,a?5:6)),c=r.length<6?0:parseInt(r.slice(a?5:6,a?6:7)),d=new Co(o,_,l,c);e.parts.push(d)}this.renderGroupBadge(e)}renderGroupBadge(t){const e=new Ve,s=new Nt(ku.EMPTY);s.width=Co.IMAGE_WIDTH,s.height=Co.IMAGE_HEIGHT,e.addChild(s);for(const r of t.parts){let a=!0;const o=r.type==="b"?this._groupBases.get(r.key):this._groupSymbols.get(r.key);if(o)for(const _ of o){if(!_||!_.length)continue;const l=this._assets.getTexture(`badgepart_${_}`);if(!l)continue;const{x:c,y:d}=r.calculatePosition(l),E=new Nt(l);E.position.set(c,d),a&&(E.tint=parseInt(this._groupPartColors.get(r.color),16)),a=!1,e.addChild(E)}}this._requestedBadges.delete(t.code),this._groupBadgesQueue.delete(t.code);const i=At.generateTexture(e);this._assets.setTexture(t.code,i),this._sessionDataManager&&this._sessionDataManager.events.dispatchEvent(new ia(t.code,i))}onGroupBadgePartsEvent(t){if(!t)return;const e=t.getParser();if(e){e.bases.forEach((s,i)=>this._groupBases.set(i,s.map(r=>r.replace(".png","").replace(".gif","")))),e.symbols.forEach((s,i)=>this._groupSymbols.set(i,s.map(r=>r.replace(".png","").replace(".gif","")))),this._groupPartColors=e.partColors,this._readyToGenerateGroupBadges=!0;for(const s of this._groupBadgesQueue.keys())this.loadGroupBadge(s)}}get disposed(){return!!this._sessionDataManager}};$h.GROUP_BADGE="group_badge";$h.NORMAL_BADGE="normal_badge";let Un=$h;class xu{constructor(t,e,s,i,r,a,o,_,l,c,d,E,I,m,T,p,A,N,C,L,D,v,b,q,Q,tt,ct,Kt,Ut){this._type=t,this._id=e,this._fullName=s,this._className=i,this._category=r,this._revision=_,this._tileSizeX=l,this._tileSizeY=c,this._tileSizeZ=d,this._colors=E,this._hasIndexedColor=I,this._colourIndex=m,this._localizedName=a,this._description=o,this._adUrl=T,this._purchaseOfferId=p,this._purchaseCouldBeUsedForBuyout=A,this._rentOfferId=N,this._rentCouldBeUsedForBuyout=C,this._customParams=D,this._specialType=v,this._availableForBuildersClub=L,this._canStandOn=b,this._canSitOn=q,this._canLayOn=Q,this._excludedFromDynamic=tt,this._furniLine=ct,this._environment=Kt,this._rare=Ut}get type(){return this._type}get id(){return this._id}get className(){return this._className}set className(t){this._className=t}get fullName(){return this._fullName}get category(){return this._category}get hasIndexedColor(){return this._hasIndexedColor}get colorIndex(){return this._colourIndex}get revision(){return this._revision}get tileSizeX(){return this._tileSizeX}get tileSizeY(){return this._tileSizeY}get tileSizeZ(){return this._tileSizeZ}get colors(){return this._colors}get name(){return this._localizedName}get description(){return this._description}get adUrl(){return this._adUrl}get purchaseOfferId(){return this._purchaseOfferId}get customParams(){return this._customParams}get specialType(){return this._specialType}get rentOfferId(){return this._rentOfferId}get purchaseCouldBeUsedForBuyout(){return this._purchaseCouldBeUsedForBuyout}get rentCouldBeUsedForBuyout(){return this._rentCouldBeUsedForBuyout}get availableForBuildersClub(){return this._availableForBuildersClub}get canStandOn(){return this._canStandOn}get canSitOn(){return this._canSitOn}get canLayOn(){return this._canLayOn}get isExternalImage(){return this._className.indexOf("external_image")!==-1}get excludeDynamic(){return this._excludedFromDynamic}get furniLine(){return this._furniLine}get environment(){return this._environment}get rare(){return this._rare}}const tu=class Z_ extends pe{constructor(t,e,s){super(),this._floorItems=t,this._wallItems=e,this._localization=s}loadFurnitureData(t){t&&fetch(t).then(e=>e.json()).then(e=>this.onFurnitureDataLoaded(e)).catch(e=>this.onFurnitureDataError(e))}onFurnitureDataLoaded(t){t&&((typeof t.roomitemtypes>"u"||typeof t.wallitemtypes>"u")&&G.warn("Could not find `roomitemtypes` or `wallitemtypes` in furnidata."),t.roomitemtypes&&this.parseFloorItems(t.roomitemtypes),t.wallitemtypes&&this.parseWallItems(t.wallitemtypes),this.dispatchEvent(new rt(Z_.FURNITURE_DATA_READY)))}onFurnitureDataError(t){t&&(G.error(t),this.dispatchEvent(new rt(Z_.FURNITURE_DATA_ERROR)))}parseFloorItems(t){if(!(!t||!t.furnitype))for(const e of t.furnitype){if(!e)continue;const s=[];if(e.partcolors)for(const l of e.partcolors.color){let c=l;c.charAt(0)==="#"&&(c=c.replace("#","")),s.push(parseInt(c,16))}const i=e.classname.split("*"),r=i[0],a=i.length>1?parseInt(i[1]):0,o=i.length>1,_=new xu(Ii.FLOOR,e.id,e.classname,r,e.category,e.name,e.description,e.revision,e.xdim,e.ydim,0,s,o,a,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,e.customparams,e.specialtype,e.canstandon,e.cansiton,e.canlayon,e.excludeddynamic,e.furniline,e.environment,e.rare);this._floorItems.set(_.id,_),this.updateLocalizations(_)}}parseWallItems(t){if(!(!t||!t.furnitype))for(const e of t.furnitype){if(!e)continue;const s=new xu(Ii.WALL,e.id,e.classname,e.classname,e.category,e.name,e.description,e.revision,0,0,0,null,!1,0,e.adurl,e.offerid,e.buyout,e.rentofferid,e.rentbuyout,e.bc,null,e.specialtype,!1,!1,!1,e.excludeddynamic,e.furniline,e.environment,e.rare);this._wallItems.set(s.id,s),this.updateLocalizations(s)}}updateLocalizations(t){if(this._localization)switch(t.type){case Ii.FLOOR:this._localization.setValue("roomItem.name."+t.id,t.name),this._localization.setValue("roomItem.desc."+t.id,t.description);return;case Ii.WALL:this._localization.setValue("wallItem.name."+t.id,t.name),this._localization.setValue("wallItem.desc."+t.id,t.description);return}}};tu.FURNITURE_DATA_READY="FDP_FURNITURE_DATA_READY";tu.FURNITURE_DATA_ERROR="FDP_FURNITURE_DATA_ERROR";let No=tu;class SV{constructor(t){this._sessionDataManager=t,this._groupBadges=new Map}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new rr(this.onRoomReadyMessageEvent.bind(this)),new qd(this.onGroupBadgesEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._groupBadges=null,this._sessionDataManager=null}}onRoomReadyMessageEvent(t){this._sessionDataManager.send(new NE)}onGroupBadgesEvent(t){const e=t.getParser();for(const[s,i]of e.badges.entries())this._groupBadges.set(s,i)}getGroupBadge(t){return this._groupBadges.get(t)}get disposed(){return!!this._sessionDataManager}}class eu{}eu.NO_CLUB=0;eu.CLUB=1;eu.VIP=2;class Je extends ge{constructor(t,e){super(),this._connection=t,this._listener=e,this._roomId=0}onDispose(){this._connection=null,this._listener=null}setRoomId(t){this._roomId=t}get connection(){return this._connection}get listener(){return this._listener}get roomId(){return this._roomId}}class MV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new i_(this.onRoomGenericError.bind(this)))}onRoomGenericError(t){if(!(t instanceof i_))return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case oh.KICKED_OUT_OF_ROOM:i=St.RSEME_KICKED;break;default:return}!i||i.length==0||this.listener.events.dispatchEvent(new St(i,s))}}class CV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new md(this.onOpenPetPackageRequested.bind(this))),t.addMessageEvent(new Id(this.onOpenPetPackageResult.bind(this)))}onOpenPetPackageRequested(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new $i($i.RSOPPE_OPEN_PET_PACKAGE_REQUESTED,s,e.objectId,e.figureData,0,null))}onOpenPetPackageResult(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new $i($i.RSOPPE_OPEN_PET_PACKAGE_RESULT,s,e.objectId,null,e.nameValidationStatus,e.nameValidationInfo))}}class NV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new pd(this.onPollContentsEvent.bind(this))),t.addMessageEvent(new Ad(this.onPollOfferEvent.bind(this))),t.addMessageEvent(new Od(this.onPollErrorEvent.bind(this)))}onPollContentsEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new Os(Os.CONTENT,e,s.id);i.startMessage=s.startMessage,i.endMessage=s.endMessage,i.numQuestions=s.numQuestions,i.questionArray=s.questionArray,i.npsPoll=s.npsPoll,this.listener.events.dispatchEvent(i)}onPollOfferEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new Os(Os.OFFER,e,s.id);i.summary=s.headline,i.summary=s.summary,this.listener.events.dispatchEvent(i)}onPollErrorEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e||!t.getParser())return;const i=new Os(Os.ERROR,e,-1);i.headline="???",i.summary="???",this.listener.events.dispatchEvent(i)}}class DV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new Nh(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new aa(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new oa(this.onRoomUnitChatEvent.bind(this))),t.addMessageEvent(new Gd(this.onRoomUnitHandItemReceivedEvent.bind(this))),t.addMessageEvent(new tg(this.onRespectReceivedEvent.bind(this))),t.addMessageEvent(new Zd(this.onPetRespectNoficationEvent.bind(this))),t.addMessageEvent(new $d(this.onPetSupplementedNotificationEvent.bind(this))),t.addMessageEvent(new Fd(this.onFloodControlEvent.bind(this))),t.addMessageEvent(new xd(this.onRemainingMuteEvent.bind(this)))}onRoomUnitChatEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;let i=st.CHAT_TYPE_SPEAK;t instanceof aa?i=st.CHAT_TYPE_SHOUT:t instanceof oa&&(i=st.CHAT_TYPE_WHISPER);const r=new st(st.CHAT_EVENT,e,s.roomIndex,s.message,i,s.bubble);this.listener.events.dispatchEvent(r)}onRoomUnitHandItemReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&this.listener.events.dispatchEvent(new st(st.CHAT_EVENT,e,s.giverUserId,"",st.CHAT_TYPE_HAND_ITEM_RECEIVED,qs.GENERIC,null,s.handItemType))}onRespectReceivedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getUserData(s.userId);i&&this.listener.events.dispatchEvent(new st(st.CHAT_EVENT,e,i.roomIndex,"",st.CHAT_TYPE_RESPECT,qs.GENERIC))}onPetRespectNoficationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getPetData(s.petData.id);if(!i)return;let r=st.CHAT_TYPE_PETRESPECT;s.isTreat&&(r=st.CHAT_TYPE_PETTREAT),this.listener.events.dispatchEvent(new st(st.CHAT_EVENT,e,i.roomIndex,"",r,qs.GENERIC))}onPetSupplementedNotificationEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=e.userDataManager.getPetData(s.petId);if(!i)return;let r=-1;const a=e.userDataManager.getUserData(s.userId);a&&(r=a.roomIndex);let o=st.CHAT_TYPE_PETREVIVE;switch(s.supplementType){case si.REVIVE:o=st.CHAT_TYPE_PETREVIVE;break;case si.REBREED_FERTILIZER:o=st.CHAT_TYPE_PET_REBREED_FERTILIZE;break;case si.SPEED_FERTILIZER:o=st.CHAT_TYPE_PET_SPEED_FERTILIZE;break}this.listener.events.dispatchEvent(new st(st.CHAT_EVENT,e,i.roomIndex,"",o,qs.GENERIC,null,r))}onFloodControlEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=s.seconds;this.listener.events.dispatchEvent(new st(st.FLOOD_EVENT,e,-1,i.toString(),0,0))}onRemainingMuteEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&this.listener.events.dispatchEvent(new st(st.CHAT_EVENT,e,e.ownRoomIndex,"",st.CHAT_TYPE_MUTE_REMAINING,qs.GENERIC,null,s.seconds))}}class PV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new n_(this.onGetGuestRoomResultEvent.bind(this)))}onGetGuestRoomResultEvent(t){if(!(t instanceof n_))return;const e=t.getParser();if(!e||e.roomForward)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.data;s.tradeMode=i.tradeMode,s.isGuildRoom=i.habboGroupId!==0,s.doorMode=i.doorMode,s.allowPets=i.allowPets,s.moderationSettings=e.moderation,this.listener.events.dispatchEvent(new zo(zo.RSDUE_ALLOW_PETS,s)),this.listener.events.dispatchEvent(new K(K.ROOM_DATA,s))}}class yV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new Dd(this.onRoomDimmerPresets.bind(this)))}onRoomDimmerPresets(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new Vo(Vo.ROOM_DIMMER_PRESETS,s);i.selectedPresetId=e.selectedPresetId;let r=0;for(;r<e.presetCount;){const a=e.getPreset(r);a&&i.storePreset(a.id,a.type,a.color,a.brightness),r++}this.listener&&this.listener.events.dispatchEvent(i)}}class LV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new __(this.onRoomRightsEvent.bind(this))),t.addMessageEvent(new o_(this.onRoomRightsClearEvent.bind(this))),t.addMessageEvent(new h_(this.onRoomRightsOwnerEvent.bind(this)))}onRoomRightsEvent(t){if(!(t instanceof __))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(t.getParser().controllerLevel)}onRoomRightsClearEvent(t){if(!(t instanceof o_))return;const e=this.listener.getSession(this.roomId);e&&e.setControllerLevel(Ie.NONE)}onRoomRightsOwnerEvent(t){if(!(t instanceof h_))return;const e=this.listener.getSession(this.roomId);e&&e.setRoomOwner()}}class UV extends Je{constructor(t,e){super(t,e),t&&t.addMessageEvent(new cd(this.onFurnitureGiftOpenedEvent.bind(this)))}onFurnitureGiftOpenedEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener&&this.listener.events&&this.listener.events.dispatchEvent(new jo(jo.RSPE_PRESENT_OPENED,s,e.classId,e.itemType,e.productCode,e.placedItemId,e.placedItemType,e.placedInRoom,e.petFigureString))}}const lo=class wr extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new u_(this.onRoomEnterEvent.bind(this))),t.addMessageEvent(new rr(this.onRoomReadyMessageEvent.bind(this))),t.addMessageEvent(new s_(this.onDesktopViewEvent.bind(this))),t.addMessageEvent(new a_(this.onRoomDoorbellAcceptedEvent.bind(this))),t.addMessageEvent(new r_(this.onRoomDoorbellRejectedEvent.bind(this))),t.addMessageEvent(new bd(this.onYouAreSpectatorMessageEvent.bind(this)))}onRoomEnterEvent(t){t instanceof u_&&this.listener&&this.listener.sessionUpdate(this.roomId,wr.RS_CONNECTED)}onRoomReadyMessageEvent(t){if(!(t instanceof rr))return;const e=this.roomId,s=t.getParser().roomId;this.listener&&(this.listener.sessionReinitialize(e,s),this.listener.sessionUpdate(this.roomId,wr.RS_READY))}onDesktopViewEvent(t){t instanceof s_&&this.listener&&this.listener.sessionUpdate(this.roomId,wr.RS_DISCONNECTED)}onRoomDoorbellAcceptedEvent(t){if(!(t instanceof a_)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)this.connection.send(new nE(this.roomId));else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new Ds(Ds.RSDE_ACCEPTED,i,s))}}onRoomDoorbellRejectedEvent(t){if(!(t instanceof r_)||!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)this.listener.sessionUpdate(this.roomId,wr.RS_DISCONNECTED);else if(this.listener.events){const i=this.listener.getSession(this.roomId);if(!i)return;this.listener.events.dispatchEvent(new Ds(Ds.RSDE_REJECTED,i,s))}}onYouAreSpectatorMessageEvent(t){if(this.listener){const e=this.listener.getSession(this.roomId);if(!e)return;e.isSpectator=!0,this.listener.events.dispatchEvent(new Yo(Yo.SPECTATOR_MODE,e))}}};lo.RS_CONNECTED="RS_CONNECTED";lo.RS_READY="RS_READY";lo.RS_DISCONNECTED="RS_DISCONNECTED";let vn=lo;class vV{constructor(){this._adultLevel=7}get id(){return this._id}set id(t){this._id=t}get level(){return this._level}set level(t){this._level=t}get maximumLevel(){return this._maximumLevel}set maximumLevel(t){this._maximumLevel=t}get experience(){return this._experience}set experience(t){this._experience=t}get levelExperienceGoal(){return this._levelExperienceGoal}set levelExperienceGoal(t){this._levelExperienceGoal=t}get energy(){return this._energy}set energy(t){this._energy=t}get maximumEnergy(){return this._maximumEnergy}set maximumEnergy(t){this._maximumEnergy=t}get happyness(){return this._happyness}set happyness(t){this._happyness=t}get maximumHappyness(){return this._maximumHappyness}set maximumHappyness(t){this._maximumHappyness=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get respect(){return this._respect}set respect(t){this._respect=t}get age(){return this._age}set age(t){this._age=t}get unknownRarity(){return this._unknownRarity}set unknownRarity(t){this._unknownRarity=t}get saddle(){return this._saddle}set saddle(t){this._saddle=t}get rider(){return this._rider}set rider(t){this._rider=t}get skillTresholds(){return this._skillThresholds}set skillTresholds(t){this._skillThresholds=t}get publiclyRideable(){return this._publiclyRideable}set publiclyRideable(t){this._publiclyRideable=t}get breedable(){return this._breedable}set breedable(t){this._breedable=t}get fullyGrown(){return this._fullyGrown}set fullyGrown(t){this._fullyGrown=t}get dead(){return this._dead}set dead(t){this._dead=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get maximumTimeToLive(){return this._maximumTimeToLive}set maximumTimeToLive(t){this._maximumTimeToLive=t}get remainingTimeToLive(){return this._remainingTimeToLive}set remainingTimeToLive(t){this._remainingTimeToLive=t}get remainingGrowTime(){return this._remainingGrowTime}set remainingGrowTime(t){this._remainingGrowTime=t}get publiclyBreedable(){return this._publiclyBreedable}set publiclyBreedable(t){this._publiclyBreedable=t}get adultLevel(){return this._adultLevel}}class bV{constructor(t){this._roomIndex=-1,this._name="",this._type=0,this._sex="",this._figure="",this._custom="",this._webID=0,this._groupID=0,this._groupStatus=0,this._groupName="",this._ownerId=0,this._ownerName="",this._petLevel=0,this._rarityLevel=0,this._roomIndex=t}get roomIndex(){return this._roomIndex}get activityPoints(){return this._activityPoints}set activityPoints(t){this._activityPoints=t}get name(){return this._name}set name(t){this._name=t}get type(){return this._type}set type(t){this._type=t}get sex(){return this._sex}set sex(t){this._sex=t}get figure(){return this._figure}set figure(t){this._figure=t}get custom(){return this._custom}set custom(t){this._custom=t}get webID(){return this._webID}set webID(t){this._webID=t}get groupId(){return this._groupID}set groupId(t){this._groupID=t}get groupName(){return this._groupName}set groupName(t){this._groupName=t}get groupStatus(){return this._groupStatus}set groupStatus(t){this._groupStatus=t}get ownerId(){return this._ownerId}set ownerId(t){this._ownerId=t}get ownerName(){return this._ownerName}set ownerName(t){this._ownerName=t}get rarityLevel(){return this._rarityLevel}set rarityLevel(t){this._rarityLevel=t}get hasSaddle(){return this._hasSaddle}set hasSaddle(t){this._hasSaddle=t}get isRiding(){return this._isRiding}set isRiding(t){this._isRiding=t}get canBreed(){return this._canBreed}set canBreed(t){this._canBreed=t}get canHarvest(){return this._canHarvest}set canHarvest(t){this._canHarvest=t}get canRevive(){return this._canRevive}set canRevive(t){this._canRevive=t}get hasBreedingPermission(){return this._hasBreedingPermission}set hasBreedingPermission(t){this._hasBreedingPermission=t}get petLevel(){return this._petLevel}set petLevel(t){this._petLevel=t}get botSkills(){return this._botSkills}set botSkills(t){this._botSkills=t}get isModerator(){return this._isModerator}set isModerator(t){this._isModerator=t}}class FV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new ha(this.onRoomUnitEvent.bind(this))),t.addMessageEvent(new ua(this.onRoomUnitInfoEvent.bind(this))),t.addMessageEvent(new la(this.onRoomUnitRemoveEvent.bind(this))),t.addMessageEvent(new _a(this.onRoomUnitDanceEvent.bind(this))),t.addMessageEvent(new kd(this.onUserCurrentBadgesEvent.bind(this))),t.addMessageEvent(new gd(this.onRoomDoorbellEvent.bind(this))),t.addMessageEvent(new Ph(this.onUserNameChangeMessageEvent.bind(this))),t.addMessageEvent(new rd(this.onNewFriendRequestEvent.bind(this))),t.addMessageEvent(new Ld(this.onPetInfoEvent.bind(this))),t.addMessageEvent(new Ud(this.onPetStatusUpdateEvent.bind(this))),t.addMessageEvent(new zU(this.onPetBreedingMessageEvent.bind(this))),t.addMessageEvent(new Rd(this.onPetLevelUpdateMessageEvent.bind(this))),t.addMessageEvent(new oL(this.onConfirmBreedingResultEvent.bind(this))),t.addMessageEvent(new _L(this.onNestBreedingSuccessEvent.bind(this))),t.addMessageEvent(new aL(this.onConfirmBreedingRequestEvent.bind(this))),t.addMessageEvent(new na(this.onPetFigureUpdateEvent.bind(this))),t.addMessageEvent(new Pd(this.onPetBreedingResultEvent.bind(this))),t.addMessageEvent(new fd(this.onPetPlacingError.bind(this))),t.addMessageEvent(new Ed(this.onBotError.bind(this))),t.addMessageEvent(new Nd(this.onFavoriteMembershipUpdateMessageEvent.bind(this)))}onRoomUnitEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser().users,i=[];if(s&&s.length)for(const r of s){if(!r)continue;const a=new bV(r.roomIndex);a.name=r.name,a.custom=r.custom,a.activityPoints=r.activityPoints,a.figure=r.figure,a.type=r.userType,a.webID=r.webID,a.groupId=r.groupID,a.groupName=r.groupName,a.groupStatus=r.groupStatus,a.sex=r.sex,a.ownerId=r.ownerId,a.ownerName=r.ownerName,a.rarityLevel=r.rarityLevel,a.hasSaddle=r.hasSaddle,a.isRiding=r.isRiding,a.canBreed=r.canBreed,a.canHarvest=r.canHarvest,a.canRevive=r.canRevive,a.hasBreedingPermission=r.hasBreedingPermission,a.petLevel=r.petLevel,a.botSkills=r.botSkills,a.isModerator=r.isModerator,e.userDataManager.getUserData(r.roomIndex)||i.push(a),e.userDataManager.updateUserData(a)}this.listener.events.dispatchEvent(new $m(e,i))}onRoomUnitInfoEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();s&&(e.userDataManager.updateFigure(s.unitId,s.figure,s.gender,!1,!1),e.userDataManager.updateMotto(s.unitId,s.motto),e.userDataManager.updateAchievementScore(s.unitId,s.achievementScore),this.listener.events.dispatchEvent(new tI(e,s.unitId,s.figure,s.gender,s.motto,s.achievementScore)))}onRoomUnitRemoveEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);e&&e.userDataManager.removeUserData(t.getParser().unitId)}onRoomUnitDanceEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Hm(s,e.unitId,e.danceId))}onUserCurrentBadgesEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.setUserBadges(e.userId,e.badges),this.listener.events.dispatchEvent(new Zm(s,e.userId,e.badges)))}onRoomDoorbellEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=e.userName;if(!s||!s.length)return;const i=this.listener.getSession(this.roomId);i&&this.listener.events.dispatchEvent(new Ds(Ds.DOORBELL,i,s))}onUserNameChangeMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&s.userDataManager.updateName(e.id,e.newName)}onNewFriendRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.request;this.listener.events.dispatchEvent(new zm(s,i.requestId,i.requesterUserId,i.requesterName))}onPetInfoEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=new vV;i.id=e.id,i.level=e.level,i.maximumLevel=e.maximumLevel,i.experience=e.experience,i.levelExperienceGoal=e.levelExperienceGoal,i.energy=e.energy,i.maximumEnergy=e.maximumEnergy,i.happyness=e.happyness,i.maximumHappyness=e.maximumHappyness,i.ownerId=e.ownerId,i.ownerName=e.ownerName,i.respect=e.respect,i.age=e.age,i.unknownRarity=e.unknownRarity,i.saddle=e.saddle,i.rider=e.rider,i.breedable=e.breedable,i.fullyGrown=e.fullyGrown,i.rarityLevel=e.rarityLevel,i.dead=e.dead,i.skillTresholds=e.skillTresholds,i.publiclyRideable=e.publiclyRideable,i.maximumTimeToLive=e.maximumTimeToLive,i.remainingTimeToLive=e.remainingTimeToLive,i.remainingGrowTime=e.remainingGrowTime,i.publiclyBreedable=e.publiclyBreedable,this.listener.events.dispatchEvent(new qm(s,i))}onPetStatusUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetBreedingStatus(e.roomIndex,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission),this.listener.events.dispatchEvent(new Jm(s,e.petId,e.canBreed,e.canHarvest,e.canRevive,e.hasBreedingPermission)))}onPetBreedingMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Wm(s,e.state,e.ownPetId,e.otherPetId))}onPetLevelUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&(s.userDataManager.updatePetLevel(e.roomIndex,e.level),this.listener.events.dispatchEvent(new Qm(s,e.petId,e.level)))}onConfirmBreedingResultEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new wm(s,e.breedingNestStuffId,e.result))}onNestBreedingSuccessEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Ym(s,e.petId,e.rarityCategory))}onConfirmBreedingRequestEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new Bm(s,e.nestId,e.pet1,e.pet2,e.rarityCategories,e.resultPetType))}onPetFigureUpdateEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;const i=e.figureData.figuredata;s.userDataManager.updateFigure(e.roomIndex,i,"",e.hasSaddle,e.isRiding),this.listener.events.dispatchEvent(new Xm(s,e.petId,i))}onPetBreedingResultEvent(t){if(!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);s&&this.listener.events.dispatchEvent(new km(s,e.resultData,e.otherResultData))}onPetPlacingError(t){if(!t||!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case 0:i=St.RSEME_PETS_FORBIDDEN_IN_HOTEL;break;case 1:i=St.RSEME_PETS_FORBIDDEN_IN_FLAT;break;case 2:i=St.RSEME_MAX_PETS;break;case 3:i=St.RSEME_NO_FREE_TILES_FOR_PET;break;case 4:i=St.RSEME_SELECTED_TILE_NOT_FREE_FOR_PET;break;case 5:i=St.RSEME_MAX_NUMBER_OF_OWN_PETS;break}!i||i.length==0||this.listener.events.dispatchEvent(new St(i,s))}onBotError(t){if(!t||!this.listener)return;const e=t.getParser();if(!e)return;const s=this.listener.getSession(this.roomId);if(!s)return;let i=null;switch(e.errorCode){case 0:i=St.RSEME_BOTS_FORBIDDEN_IN_HOTEL;break;case 1:i=St.RSEME_BOTS_FORBIDDEN_IN_FLAT;break;case 2:i=St.RSEME_BOT_LIMIT_REACHED;break;case 3:i=St.RSEME_SELECTED_TILE_NOT_FREE_FOR_BOT;break;case 4:i=St.RSEME_BOT_NAME_NOT_ACCEPTED;break}!i||i.length==0||this.listener.events.dispatchEvent(new St(i,s))}onFavoriteMembershipUpdateMessageEvent(t){if(!this.listener)return;const e=t.getParser(),s=this.listener.getSession(this.roomId);if(!s)return;const i=s.userDataManager.getUserDataByIndex(e.roomIndex);i&&(i.groupId=e.groupId,i.groupName=e.groupName,this.listener.events.dispatchEvent(new jm(s,e.roomIndex,e.groupId,e.status,e.groupName)))}}class xV extends Je{constructor(t,e){super(t,e),t.addMessageEvent(new Md(this.onQuestionEvent.bind(this))),t.addMessageEvent(new Sd(this.onQuestionAnsweredEvent.bind(this))),t.addMessageEvent(new Cd(this.onQuestionFinishedEvent.bind(this)))}onQuestionEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new As(As.QUESTION,e,s.pollId);i.question=s.question,i.duration=s.duration,i.pollType=s.pollType,i.questionId=s.questionId,i.pollId=s.pollId,this.listener.events.dispatchEvent(i)}onQuestionAnsweredEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new As(As.ANSWERED,e,s.userId);i.value=s.value,i.userId=s.userId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}onQuestionFinishedEvent(t){if(!this.listener)return;const e=this.listener.getSession(this.roomId);if(!e)return;const s=t.getParser();if(!s)return;const i=new As(As.FINISHED,e);i.questionId=s.questionId,i.answerCounts=s.answerCounts,this.listener.events.dispatchEvent(i)}}class GV{constructor(t){this._sessionDataManager=t,this._ignoredUsers=[]}init(){if(this._sessionDataManager&&this._sessionDataManager.communication){this._messages=[new Qd(this.onIgnoredUsersEvent.bind(this)),new yh(this.onIgnoreResultEvent.bind(this))];for(const t of this._messages)this._sessionDataManager.communication.registerMessageEvent(t)}}dispose(){if(!this.disposed){if(this._messages&&this._messages.length){for(const t of this._messages)this._sessionDataManager.communication.removeMessageEvent(t);this._messages=null}this._sessionDataManager=null}}requestIgnoredUsers(){this._sessionDataManager.send(new TE(this._sessionDataManager.userName))}onIgnoredUsersEvent(t){if(!t)return;const e=t.getParser();e&&(this._ignoredUsers=e.ignoredUsers)}onIgnoreResultEvent(t){if(!t)return;const e=t.getParser();if(!e)return;const s=e.name;switch(e.result){case 0:return;case 1:this.addUserToIgnoreList(s);return;case 2:this.addUserToIgnoreList(s),this._ignoredUsers.shift();return;case 3:this.removeUserFromIgnoreList(s);return}}addUserToIgnoreList(t){this._ignoredUsers.indexOf(t)<0&&this._ignoredUsers.push(t)}removeUserFromIgnoreList(t){const e=this._ignoredUsers.indexOf(t);e>=0&&this._ignoredUsers.splice(e,1)}ignoreUserId(t){this._sessionDataManager.send(new AE(t))}ignoreUser(t){this._sessionDataManager.send(new OE(t))}unignoreUser(t){this._sessionDataManager.send(new SE(t))}isIgnored(t){return this._ignoredUsers.indexOf(t)>=0}get disposed(){return!!this._sessionDataManager}}class BV{constructor(t,e,s){this._type=t,this._name=e,this._description=s}get type(){return this._type}get name(){return this._name}get description(){return this._description}}const su=class $_ extends pe{constructor(t){super(),this._products=t}dispose(){this._products=null}loadProductData(t){t&&fetch(t).then(e=>e.json()).then(e=>this.onProductDataLoadedEvent(e)).catch(e=>this.onProductDataError(e))}onProductDataLoadedEvent(t){t&&(this.parseProducts(t.productdata),this.dispatchEvent(new rt($_.PDP_PRODUCT_DATA_READY)))}onProductDataError(t){t&&this.dispatchEvent(new rt($_.PDP_PRODUCT_DATA_FAILED))}parseProducts(t){if(t)for(const e of t.product)e&&this._products.set(e.code,new BV(e.code,e.name,e.description))}};su.PDP_PRODUCT_DATA_READY="PDP_PRODUCT_DATA_READY";su.PDP_PRODUCT_DATA_FAILED="PDP_PRODUCT_DATA_FAILED";let Do=su;const Nn=class Hr extends ge{constructor(){super(),this._connection=null,this._userDataByType=new Map,this._userDataByRoomIndex=new Map,this._userBadges=new Map}onDispose(){this._connection=null}setConnection(t){this._connection=t}getUserData(t){return this.getDataByType(t,Hr.TYPE_USER)}getPetData(t){return this.getDataByType(t,Hr.TYPE_PET)}getBotData(t){return this.getDataByType(t,Hr.TYPE_BOT)}getRentableBotData(t){return this.getDataByType(t,Hr.TYPE_RENTABLE_BOT)}getDataByType(t,e){const s=this._userDataByType.get(e);if(!s)return null;const i=s.get(t);return i||null}getUserDataByIndex(t){const e=this._userDataByRoomIndex.get(t);return e||null}getUserDataByName(t){for(const e of this._userDataByRoomIndex.values())if(!(!e||e.name!==t))return e;return null}updateUserData(t){if(!t)return;this.removeUserData(t.roomIndex);let e=this._userDataByType.get(t.type);e||(e=new Map,this._userDataByType.set(t.type,e)),e.set(t.webID,t),this._userDataByRoomIndex.set(t.roomIndex,t)}removeUserData(t){const e=this.getUserDataByIndex(t);if(!e)return;this._userDataByRoomIndex.delete(t);const s=this._userDataByType.get(e.type);s&&s.delete(e.webID)}getUserBadges(t){this._connection&&this._connection.send(new ME(t));const e=this._userBadges.get(t);return e||[]}setUserBadges(t,e){this._userBadges.set(t,e)}updateFigure(t,e,s,i,r){const a=this.getUserDataByIndex(t);a&&(a.figure=e,a.sex=s,a.hasSaddle=i,a.isRiding=r)}updateName(t,e){const s=this.getUserDataByIndex(t);s&&(s.name=e)}updateMotto(t,e){const s=this.getUserDataByIndex(t);s&&(s.custom=e)}updateAchievementScore(t,e){const s=this.getUserDataByIndex(t);s&&(s.activityPoints=e)}updatePetLevel(t,e){const s=this.getUserDataByIndex(t);s&&(s.petLevel=e)}updatePetBreedingStatus(t,e,s,i,r){const a=this.getUserDataByIndex(t);a&&(a.canBreed=e,a.canHarvest=s,a.canRevive=i,a.hasBreedingPermission=r)}requestPetInfo(t){!this._connection||!this.getPetData(t)||this._connection.send(new gg(t))}get connection(){return this._connection}};Nn.TYPE_USER=1;Nn.TYPE_PET=2;Nn.TYPE_BOT=3;Nn.TYPE_RENTABLE_BOT=4;let wV=Nn;class HV extends ge{constructor(){super(),this._connection=null,this._userData=new wV,this._roomId=0,this._password=null,this._state=K.CREATED,this._tradeMode=Sm.NO_TRADING,this._doorMode=0,this._controllerLevel=Ie.NONE,this._ownRoomIndex=-1,this._isGuildRoom=!1,this._isRoomOwner=!1,this._isDecorating=!1,this._isSpectator=!1,this._moderationSettings=null}onDispose(){this._userData&&(this._userData.dispose(),this._userData=null),this._connection=null}setConnection(t){this._connection||!t||(this._connection=t,this._userData&&this._userData.setConnection(t))}setControllerLevel(t){if(t>=Ie.NONE&&t<=Ie.MODERATOR){this._controllerLevel=t;return}this._controllerLevel=Ie.NONE}setOwnRoomIndex(t){this._ownRoomIndex=t}setRoomOwner(){this._isRoomOwner=!0}start(){return this._state!==K.CREATED||!this._connection?!1:(this._state=K.STARTED,this.enterRoom())}enterRoom(){return this._connection?(this._connection.send(new Og(this._roomId,this._password)),!0):!1}reset(t){t!==this._roomId&&(this._roomId=t)}sendChatMessage(t,e){this._connection.send(new Uh(t,e))}sendShoutMessage(t,e){this._connection.send(new aE(t,e))}sendWhisperMessage(t,e,s){this._connection.send(new oE(t,e,s))}sendChatTypingMessage(t){t?this._connection.send(new _E):this._connection.send(new hE)}sendMottoMessage(t){this._connection.send(new CE(t))}sendDanceMessage(t){this._connection.send(new lE(t))}sendExpressionMessage(t){this._connection.send(new uE(t))}sendSignMessage(t){t<0||t>17||this._connection.send(new gE(t))}sendPostureMessage(t){this._connection.send(new dE(t))}sendDoorbellApprovalMessage(t,e){this._connection.send(new pg(t,e))}sendAmbassadorAlertMessage(t){this._connection.send(new Ag(t))}sendKickMessage(t){this._connection.send(new Cg(t))}sendMuteMessage(t,e){this._connection.send(new Ng(t,e,this._roomId))}sendBanMessage(t,e){this._connection.send(new Sg(t,this._roomId,e))}sendGiveRightsMessage(t){this._connection.send(new Mg(t))}sendTakeRightsMessage(t){this._connection.send(new Dg(t))}sendPollStartMessage(t){this._connection.send(new Tg(t))}sendPollRejectMessage(t){this._connection.send(new Rg(t))}sendPollAnswerMessage(t,e,s){this._connection.send(new Ig(t,e,s))}sendPeerUsersClassificationMessage(t){this._connection.send(new PE(t))}sendOpenPetPackageMessage(t,e){this._connection.send(new eE(t,e))}sendRoomUsersClassificationMessage(t){this._connection.send(new yE(t))}updateMoodlightData(t,e,s,i,r){let a="000000"+s.toString(16).toUpperCase();a="#"+a.substring(a.length-6),this.connection.send(new jg(t,e,a,i,r))}toggleMoodlightState(){this.connection.send(new zg)}pickupPet(t){this._connection&&this._connection.send(new xg(t))}pickupBot(t){this._connection&&this._connection.send(new yg(t))}requestMoodlightSettings(){this._connection&&this._connection.send(new Vg)}openGift(t){this._connection.send(new sE(t))}mountPet(t){this._connection.send(new H_(t,!0))}dismountPet(t){this._connection.send(new H_(t,!1))}usePetProduct(t,e){this._connection.send(new mg(t,e))}removePetSaddle(t){this._connection.send(new dg(t))}togglePetBreeding(t){this._connection.send(new Eg(t))}togglePetRiding(t){this._connection.send(new fg(t))}useMultistateItem(t){this._connection.send(new Lh(t))}harvestPet(t){this._connection.send(new bg(t))}compostPlant(t){this._connection.send(new Ug(t))}requestPetCommands(t){this._connection.send(new lg(t))}sendScriptProceed(){this._connection.send(new ug)}sendUpdateClothingChangeFurniture(t,e,s){this._connection.send(new Bg(t,e,s))}changeQueue(t){this._connection.send(new rE(t))}get connection(){return this._connection}get userDataManager(){return this._userData}get roomId(){return this._roomId}set roomId(t){this._roomId=t}get password(){return this._password}set password(t){this._password=t}get state(){return this._state}get isPrivateRoom(){return!0}get tradeMode(){return this._tradeMode}set tradeMode(t){this._tradeMode=t}get doorMode(){return this._doorMode}set doorMode(t){this._doorMode=t}get allowPets(){return this._allowPets}set allowPets(t){this._allowPets=t}get controllerLevel(){return this._controllerLevel}get ownRoomIndex(){return this._ownRoomIndex}get isGuildRoom(){return this._isGuildRoom}set isGuildRoom(t){this._isGuildRoom=t}get isRoomOwner(){return this._isRoomOwner}get isDecorating(){return this._isDecorating}set isDecorating(t){this._isDecorating=t}get isSpectator(){return this._isSpectator}set isSpectator(t){this._isSpectator=t}get moderationSettings(){return this._moderationSettings}set moderationSettings(t){this._moderationSettings=t}}class VV extends ns{constructor(t,e){super(),this._communication=t,this._roomEngine=e,this._handlers=[],this._sessions=new Map,this._pendingSession=null,this._sessionStarting=!1,this._viewerSession=null,this.onRoomEngineEvent=this.onRoomEngineEvent.bind(this)}onInit(){this.createHandlers(),this.processPendingSession(),this._roomEngine.events.addEventListener(ot.ENGINE_INITIALIZED,this.onRoomEngineEvent)}onDispose(){this._roomEngine.events.removeEventListener(ot.ENGINE_INITIALIZED,this.onRoomEngineEvent),super.onDispose()}createHandlers(){const t=this._communication&&this._communication.connection;t&&this._handlers.push(new DV(t,this),new PV(t,this),new yV(t,this),new LV(t,this),new vn(t,this),new FV(t,this),new UV(t,this),new MV(t,this),new xV(t,this),new NV(t,this),new CV(t,this))}setHandlers(t){if(!(!this._handlers||!this._handlers.length))for(const e of this._handlers)e&&e.setRoomId(t.roomId)}onRoomEngineEvent(t){this.processPendingSession()}processPendingSession(){!this._pendingSession||!this._roomEngine.ready||(this.addSession(this._pendingSession),this._pendingSession=null)}getSession(t){const e=this._sessions.get(this.getRoomId(t));return e||null}createSession(t,e=null){const s=new HV;return s.roomId=t,s.password=e,this.addSession(s)}addSession(t){return this._roomEngine.ready?(this._sessionStarting=!0,this._sessions.get(this.getRoomId(t.roomId))&&this.removeSession(t.roomId,!1),t.setConnection(this._communication.connection),this._sessions.set(this.getRoomId(t.roomId),t),this.events.dispatchEvent(new K(K.CREATED,t)),this._viewerSession=t,this.startSession(this._viewerSession),!0):(this._pendingSession=t,!1)}startSession(t){return t.state===K.STARTED?!1:(this._sessionStarting=!1,t.start()?(this.events.dispatchEvent(new K(K.STARTED,t)),this.setHandlers(t),!0):(this.removeSession(t.roomId),!1))}removeSession(t,e=!0){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),this.events.dispatchEvent(new K(K.ENDED,s,e)),s.dispose())}sessionUpdate(t,e){if(this.getSession(t))switch(e){case vn.RS_CONNECTED:return;case vn.RS_READY:return;case vn.RS_DISCONNECTED:this.removeSession(t);return}}sessionReinitialize(t,e){const s=this.getSession(t);s&&(this._sessions.delete(this.getRoomId(t)),s.reset(e),this._sessions.set(this.getRoomId(e),s),this.setHandlers(s))}getRoomId(t){return"hard_coded_room_id"}get communication(){return this._communication}get roomEngine(){return this._roomEngine}get viewerSession(){return this._viewerSession}}const co=class Hf{static logEventLog(t){try{at.available&&at.call("logEventLog",t)}catch{G.log("External interface not working, failed to log event log.")}}static openPage(t){try{at.available&&at.call("openPage",t)}catch{G.log("Failed to open web page",t)}}static openWebPage(t){window.open(t)}static sendHeartBeat(){try{at.available&&at.call("heartBeat")}catch{G.log("Failed to send heartbeat")}}static openWebPageAndMinimizeClient(t){try{at.available&&Hf.openPage(t)}catch{G.log("Failed to open web page",t)}}static closeWebPageAndRestoreClient(){try{at.available&&at.call("closeWebPageAndRestoreClient")}catch{G.log("Failed to close web page and restore client!")}}static openHabblet(t,e=null){try{at.available&&at.call("openHabblet",t,e)}catch{G.log("Failed to open Habblet",t)}}static closeHabblet(t,e=null){try{at.available&&at.call("closeHabblet",t,e)}catch{G.log("Failed to close Habblet",t)}}static send(t,e){try{at.available&&at.call("disconnect",t,e)}catch{G.log("Failed to close send ")}}static showGame(t){try{at.available&&at.callGame("showGame",t)}catch(e){G.log("Failed to open game",e)}}static hideGame(){try{at.available&&at.callGame("hideGame")}catch{G.log("Failed to hide game")}}static open(t){try{at.available&&at.call("openExternalLink",escape(t))}catch{G.log("External interface not working. Could not request to open: "+t)}}static roomVisited(t){try{at.available&&at.call("roomVisited",t)}catch{G.log("External interface not working. Could not store last room visit.")}}static openMinimail(t){try{at.available&&at.call("openMinimail",t)}catch{G.log("External interface not working. Could not open minimail.")}}static openNews(){try{at.available&&at.call("openNews")}catch{G.log("External interface not working. Could not open news.")}}static closeNews(){try{at.available&&at.call("closeNews")}catch{G.log("External interface not working. Could not close news.")}}static openAvatars(){try{at.available&&at.call("openAvatars")}catch{G.log("External interface not working. Could not open avatars.")}}static openRoomEnterAd(){try{at.available&&at.call("openRoomEnterAd")}catch{G.log("External interface not working. Could not open roomenterad.")}}static updateFigure(t){try{at.available&&at.call("updateFigure",t)}catch{G.log("External interface not working. Could not update figure.")}}};co.ADVERTISEMENT="advertisement";co.OPENLINK="openlink";co.OPENROOM="openroom";let pa=co;class jV extends ns{constructor(t){super(),this._communication=t,this.resetUserInfo(),this._ignoredUsersManager=new GV(this),this._groupInformationManager=new SV(this),this._clubLevel=0,this._securityLevel=0,this._isAmbassador=!1,this._noobnessLevel=-1,this._isEmailVerified=!1,this._systemOpen=!1,this._systemShutdown=!1,this._isAuthenticHabbo=!1,this._isRoomCameraFollowDisabled=!1,this._uiFlags=0,this._floorItems=new Map,this._wallItems=new Map,this._products=new Map,this._furnitureData=null,this._furnitureReady=!1,this._productsReady=!1,this._furnitureListenersNotified=!1,this._pendingFurnitureListeners=[],this._pendingProductListeners=[],this._tags=[],this._badgeImageManager=null,this.onFurnitureDataReadyEvent=this.onFurnitureDataReadyEvent.bind(this),this.onProductDataReadyEvent=this.onProductDataReadyEvent.bind(this),this.onNitroSettingsEvent=this.onNitroSettingsEvent.bind(this)}onInit(){this.loadFurnitureData(),this.loadProductData(),this.loadBadgeImageManager(),this._ignoredUsersManager&&this._ignoredUsersManager.init(),this._groupInformationManager&&this._groupInformationManager.init(),this._communication.registerMessageEvent(new sd(this.onUserFigureEvent.bind(this))),this._communication.registerMessageEvent(new ca(this.onUserInfoEvent.bind(this))),this._communication.registerMessageEvent(new Yd(this.onUserPermissionsEvent.bind(this))),this._communication.registerMessageEvent(new ed(this.onAvailabilityStatusMessageEvent.bind(this))),this._communication.registerMessageEvent(new Td(this.onPetRespectFailed.bind(this))),this._communication.registerMessageEvent(new We(this.onChangeNameUpdateEvent.bind(this))),this._communication.registerMessageEvent(new Ph(this.onUserNameChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new Kd(this.onUserTags.bind(this))),this._communication.registerMessageEvent(new rr(this.onRoomModelNameEvent.bind(this))),this._communication.registerMessageEvent(new Jd(this.onInClientLinkEvent.bind(this))),this._communication.registerMessageEvent(new dd(this.onMysteryBoxKeysEvent.bind(this))),this._communication.registerMessageEvent(new od(this.onNoobnessLevelMessageEvent.bind(this))),this._communication.registerMessageEvent(new Wd(this.onAccountSafetyLockStatusChangeMessageEvent.bind(this))),this._communication.registerMessageEvent(new Xd(this.onEmailStatus.bind(this))),H.instance.events.addEventListener(jr.SETTINGS_UPDATED,this.onNitroSettingsEvent)}onDispose(){this.destroyFurnitureData(),this._ignoredUsersManager&&(this._ignoredUsersManager.dispose(),this._ignoredUsersManager=null),this._groupInformationManager&&(this._groupInformationManager.dispose(),this._groupInformationManager=null),H.instance.events.removeEventListener(jr.SETTINGS_UPDATED,this.onNitroSettingsEvent),super.onDispose()}resetUserInfo(){this._userId=0,this._name=null,this._figure=null,this._gender=null,this._realName=null,this._canChangeName=!1,this._safetyLocked=!1}loadFurnitureData(){this.destroyFurnitureData(),this._furnitureData=new No(this._floorItems,this._wallItems,H.instance.localization),this._furnitureData.addEventListener(No.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureData.loadFurnitureData(k.getValue("furnidata.url"))}loadProductData(){this.destroyProductData(),this._productData=new Do(this._products),this._productData.addEventListener(Do.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productData.loadProductData(k.getValue("productdata.url"))}loadBadgeImageManager(){this._badgeImageManager||(this._badgeImageManager=new Un(Me(),this),this._badgeImageManager.init())}hasProductData(t){return this._productsReady?!0:(t&&this._pendingProductListeners.indexOf(t)===-1&&this._pendingProductListeners.push(t),!1)}getAllFurnitureData(t){if(!this._furnitureReady)return this._pendingFurnitureListeners.indexOf(t)===-1&&this._pendingFurnitureListeners.push(t),null;const e=[];for(const s of this._floorItems.values())s&&e.push(s);for(const s of this._wallItems.values())s&&e.push(s);return e}removePendingFurniDataListener(t){if(!this._pendingFurnitureListeners)return;const e=this._pendingFurnitureListeners.indexOf(t);e!==-1&&this._pendingFurnitureListeners.splice(e,1)}onUserFigureEvent(t){!t||!t.connection||(this._figure=t.getParser().figure,this._gender=t.getParser().gender,pa.updateFigure(this._figure))}onUserInfoEvent(t){if(!t||!t.connection)return;this.resetUserInfo();const e=t.getParser().userInfo;e&&(this._userId=e.userId,this._name=e.username,this._figure=e.figure,this._gender=e.gender,this._realName=e.realName,this._respectsReceived=e.respectsReceived,this._respectsLeft=e.respectsRemaining,this._respectsPetLeft=e.respectsPetRemaining,this._canChangeName=e.canChangeName,this._safetyLocked=e.safetyLocked,this._ignoredUsersManager&&this._ignoredUsersManager.requestIgnoredUsers())}onUserPermissionsEvent(t){!t||!t.connection||(this._clubLevel=t.getParser().clubLevel,this._securityLevel=t.getParser().securityLevel,this._isAmbassador=t.getParser().isAmbassador)}onAvailabilityStatusMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._systemOpen=e.isOpen,this._systemShutdown=e.onShutdown,this._isAuthenticHabbo=e.isAuthenticUser)}onPetRespectFailed(t){!t||!t.connection||this._respectsPetLeft++}onChangeNameUpdateEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.resultCode===We.NAME_OK&&(this._canChangeName=!1,this.events.dispatchEvent(new fu(e.name)))}onUserNameChangeMessageEvent(t){if(!t||!t.connection)return;const e=t.getParser();e&&e.webId===this.userId&&(this._name=e.newName,this._canChangeName=!1,this.events.dispatchEvent(new fu(this._name)))}onUserTags(t){if(!t||!t.connection)return;const e=t.getParser();e&&(this._tags=e.tags)}onRoomModelNameEvent(t){if(!t)return;const e=t.getParser();e&&pa.roomVisited(e.roomId)}onFurnitureDataReadyEvent(t){if(this._furnitureData.removeEventListener(No.FURNITURE_DATA_READY,this.onFurnitureDataReadyEvent),this._furnitureReady=!0,!this._furnitureListenersNotified&&(this._furnitureListenersNotified=!0,this._pendingFurnitureListeners&&this._pendingFurnitureListeners.length))for(const e of this._pendingFurnitureListeners)e&&e.loadFurnitureData();this._pendingProductListeners=[]}onProductDataReadyEvent(t){this._productData.removeEventListener(Do.PDP_PRODUCT_DATA_READY,this.onProductDataReadyEvent),this._productsReady=!0;for(const e of this._pendingProductListeners)e&&e.loadProductData();this._pendingProductListeners=[]}onInClientLinkEvent(t){if(!t)return;const e=t.getParser();e&&H.instance.createLinkEvent(e.link)}onMysteryBoxKeysEvent(t){if(!t)return;const e=t.getParser();e&&this.events.dispatchEvent(new xm(e.boxColor,e.keyColor))}onNoobnessLevelMessageEvent(t){this._noobnessLevel=t.getParser().noobnessLevel,this._noobnessLevel!==er.OLD_IDENTITY&&k.setValue("new.identity",1)}onAccountSafetyLockStatusChangeMessageEvent(t){if(!t)return;const e=t.getParser();e&&(this._safetyLocked=e.status==Ba.SAFETY_LOCK_STATUS_LOCKED)}onEmailStatus(t){if(!t)return;const e=t.getParser();e&&(this._isEmailVerified=e.isVerified)}onNitroSettingsEvent(t){this._isRoomCameraFollowDisabled=t.cameraFollow,this._uiFlags=t.flags,this.events.dispatchEvent(new sI(this._uiFlags))}destroyFurnitureData(){this._furnitureData&&(this._furnitureData.dispose(),this._furnitureData=null)}destroyProductData(){this._productData&&(this._productData.dispose(),this._productData=null)}getFloorItemData(t){const e=this._floorItems.get(t);return e||null}getFloorItemDataByName(t){if(!t||!this._floorItems||!this._floorItems.size)return null;for(const e of this._floorItems.values())if(!(!e||e.className!==t))return e}getWallItemData(t){const e=this._wallItems.get(t);return e||null}getWallItemDataByName(t){if(!t||!this._wallItems||!this._wallItems.size)return null;for(const e of this._wallItems.values())if(!(!e||e.className!==t))return e}getProductData(t){return this._productsReady||this.loadProductData(),this._products.get(t)}getBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t)}getGroupBadgeUrl(t){return this._badgeImageManager.getBadgeUrl(t,Un.GROUP_BADGE)}getBadgeImage(t){return this._badgeImageManager.getBadgeImage(t)}getGroupBadgeImage(t){return this._badgeImageManager.getBadgeImage(t,Un.GROUP_BADGE)}getUserTags(t){t<0||this.send(new pE(t))}loadBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t)}loadGroupBadgeImage(t){return this._badgeImageManager.loadBadgeImage(t,Un.GROUP_BADGE)}hasSecurity(t){return this._securityLevel>=t}giveRespect(t){t<0||this._respectsLeft<=0||(this.send(new DE(t)),this._respectsLeft--)}givePetRespect(t){t<0||this._respectsPetLeft<=0||(this.send(new cg(t)),this._respectsPetLeft--)}sendSpecialCommandMessage(t,e=0){this.send(new Uh(t))}ignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.ignoreUser(t)}unignoreUser(t){this._ignoredUsersManager&&this._ignoredUsersManager.unignoreUser(t)}isUserIgnored(t){return this._ignoredUsersManager&&this._ignoredUsersManager.isIgnored(t)}getGroupBadge(t){return this._groupInformationManager&&this._groupInformationManager.getGroupBadge(t)}send(t){this._communication.connection.send(t)}get communication(){return this._communication}get userId(){return this._userId}get userName(){return this._name}get figure(){return this._figure}get gender(){return this._gender}get realName(){return this._realName}get ignoredUsersManager(){return this._ignoredUsersManager}get groupInformationManager(){return this._groupInformationManager}get respectsReceived(){return this._respectsReceived}get respectsLeft(){return this._respectsLeft}get respectsPetLeft(){return this._respectsPetLeft}get canChangeName(){return this._canChangeName}get clubLevel(){return this._clubLevel}get securityLevel(){return this._securityLevel}get isAmbassador(){return this._isAmbassador}get isEmailVerified(){return this._isEmailVerified}get isNoob(){return this._noobnessLevel!==er.OLD_IDENTITY}get isRealNoob(){return this._noobnessLevel===er.REAL_NOOB}get isSystemOpen(){return this._systemOpen}get isSystemShutdown(){return this._systemShutdown}get isAuthenticHabbo(){return this._isAuthenticHabbo}get isModerator(){return this._securityLevel>=ke.MODERATOR}get isCameraFollowDisabled(){return this._isRoomCameraFollowDisabled}get uiFlags(){return this._uiFlags}get tags(){return this._tags}}class Vf extends Xa{constructor(t,e,s,i,r=""){super(t,e,s,i),this._jukeboxDiskId=-1,this._songData=r}get id(){return this._id}get length(){return this._length}get name(){return this._name}get creator(){return this._creator}get songData(){return this._songData}set songData(t){this._songData=t}get diskId(){return this._jukeboxDiskId}set diskId(t){this._jukeboxDiskId=t}}class zV{constructor(t,e,s,i,r){this._songId=t,this._startPos=e,this._playLength=s,this._fadeInSeconds=i,this._fadeOutSeconds=r,this._playRequestTime=Date.now()}get songId(){return this._songId}get startPos(){return this._startPos<0?0:this._startPos+(Date.now()-this._playRequestTime)/1e3}get playLength(){return this._playLength}get playRequestTime(){return this._playRequestTime}get fadeInSeconds(){return this._fadeInSeconds}get fadeOutSeconds(){return this._fadeOutSeconds}}const jf=class zf extends rt{constructor(t,e){super(zf.NOTIFY_PLAYED_SONG),this._name=t,this._creator=e}get name(){return this._name}get creator(){return this._creator}};jf.NOTIFY_PLAYED_SONG="UIEW_NOTIFY_PLAYED_SONG";let YV=jf;class vs extends rt{constructor(t,e,s,i){super(t),this._id=s,this._position=i,this._priority=e}get id(){return this._id}get position(){return this._position}get priority(){return this._priority}}vs.NPE_USER_PLAY_SONG="NPE_USER_PLAY_SONG";vs.NPW_USER_STOP_SONG="NPW_USER_STOP_SONG";vs.NPE_SONG_CHANGED="NPE_SONG_CHANGED";class Xs extends rt{constructor(t){super(t)}}Xs.PLUE_PLAY_LIST_UPDATED="PLUE_PLAY_LIST_UPDATED";Xs.PLUE_PLAY_LIST_FULL="PLUE_PLAY_LIST_FULL";class Vr extends rt{constructor(t){super(t)}}Vr.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT="SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT";class Jr extends rt{constructor(t,e){super(t),this._id=e}get id(){return this._id}}Jr.SIR_TRAX_SONG_INFO_RECEIVED="SIR_TRAX_SONG_INFO_RECEIVED";class Zr extends rt{constructor(t,e){super(t),this._id=e}get id(){return this._id}}Zr.TRAX_SONG_COMPLETE="SME_TRAX_SONG_COMPLETE";class se{}se.PRIORITY_ROOM_PLAYLIST=0;se.PRIORITY_USER_PLAYLIST=1;se.PRIORITY_SONG_PLAY=2;se.PRIORITY_PURCHASE_PREVIEW=3;se.PRIORITY_COUNT=4;class WV{constructor(){this._isPlaying=!1,this._disposed=!1,this._entries=[],this._missingSongInfo=[],this._messageEvents=[new Vd(this.onNowPlayingMessageEvent.bind(this)),new Hd(this.onJukeboxSongDisksMessageEvent.bind(this)),new wd(this.onJukeboxPlayListFullMessageEvent.bind(this))],this.onSongInfoReceivedEvent=this.onSongInfoReceivedEvent.bind(this)}init(){this._messageEvents.forEach(t=>H.instance.communication.connection.addMessageEvent(t)),H.instance.soundManager.events.addEventListener(Jr.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent)}get priority(){return se.PRIORITY_ROOM_PLAYLIST}onNowPlayingMessageEvent(t){const e=t.getParser();this._isPlaying=e.currentSongId!==-1,e.currentSongId>=0?(H.instance.soundManager.musicController.playSong(e.currentSongId,se.PRIORITY_ROOM_PLAYLIST,e.syncCount/1e3,0,1,1),this._currentEntryId=e.currentSongId):this.stopPlaying(),e.nextSongId>=0&&H.instance.soundManager.musicController.addSongInfoRequest(e.nextSongId),this._playPosition=e.currentPosition,H.instance.soundManager.events.dispatchEvent(new vs(vs.NPE_SONG_CHANGED,se.PRIORITY_ROOM_PLAYLIST,e.currentSongId,e.currentPosition))}onJukeboxSongDisksMessageEvent(t){const e=t.getParser();this._entries=[];for(let s=0;s<e.songDisks.length;s++){const i=e.songDisks.getWithIndex(s),r=e.songDisks.getKey(s);let a=H.instance.soundManager.musicController.getSongInfo(i);a==null&&(a=new Vf(i,-1,null,null,null),this._missingSongInfo.indexOf(i)<0&&(this._missingSongInfo.push(i),H.instance.soundManager.musicController.requestSongInfoWithoutSamples(i))),a.diskId=r,this._entries.push(a)}this._missingSongInfo.length==0&&H.instance.soundManager.events.dispatchEvent(new Xs(Xs.PLUE_PLAY_LIST_UPDATED))}onJukeboxPlayListFullMessageEvent(t){H.instance.soundManager.events.dispatchEvent(new Xs(Xs.PLUE_PLAY_LIST_FULL))}onSongInfoReceivedEvent(t){for(let s=0;s<this.length;s++){const i=this._entries[s];if(i.id===t.id){const r=i.diskId,a=H.instance.soundManager.musicController.getSongInfo(t.id);a!=null&&(a.diskId=r,this._entries[s]=a);break}}const e=this._missingSongInfo.indexOf(t.id);e>=0&&this._missingSongInfo.splice(e,1),this._missingSongInfo.length==0&&H.instance.soundManager.events.dispatchEvent(new Xs(Xs.PLUE_PLAY_LIST_UPDATED))}stopPlaying(){H.instance.soundManager.musicController.stop(this.priority),this._currentEntryId=-1,this._playPosition=-1,this._isPlaying=!1}get length(){return this._entries?this._entries.length:0}get playPosition(){return this._playPosition}get nowPlayingSongId(){return this._currentEntryId}get isPlaying(){return this._isPlaying}get entries(){return this._entries}getEntry(t){return t<0||t>=this._entries.length?null:this._entries[t]}requestPlayList(){H.instance.communication.connection.send(new fE)}dispose(){this._disposed||(this._disposed=!0,this.stopPlaying(),H.instance.soundManager.events&&H.instance.soundManager.events.removeEventListener(Jr.SIR_TRAX_SONG_INFO_RECEIVED,this.onSongInfoReceivedEvent),this._messageEvents.forEach(t=>H.instance.communication.connection.removeMessageEvent(t)),this._messageEvents=null)}}class kV{constructor(t){this._id=t,this._items=[]}addChannelItem(t){this._items.push(t)}get items(){return this._items}}class KV{constructor(t,e){this._id=t,this._length=e}get id(){return this._id}get length(){return this._length}}class th{constructor(t){this._channels=[],this._metaData=new Map;let e=[];const s=t.split(":"),i=s[s.length-1];if(i.indexOf("meta")>-1){const r=i.split(";");for(const a of r){const o=a.split(",");this._metaData.set(o[0],o[1])}e=s.slice(0,s.length-1)}else e=s;for(let r=0;r<e.length/2;r++)if(e[r*2].length>0){const a=parseInt(e[r*2]),o=e[r*2+1].split(";"),_=new kV(a);for(const l of o){const c=l.split(",");if(c.length!==2)return;_.addChannelItem(new KV(parseInt(c[0]),parseInt(c[1])))}this._channels.push(_)}}get channels(){return this._channels}getSampleIds(){const t=[];for(const e of this._channels)for(const s of e.items)t.indexOf(s.id)===-1&&t.push(s.id);return t}get hasMetaData(){return this._metaData.has("meta")}get metaCutMode(){return this._metaData.has("c")}get metaTempo(){const t=this._metaData.get("t");return t?parseInt(t):null}}class XV{constructor(t){this._sampleUrl=t,this._isPlaying=!1,this._startPos=0,this._currentPos=0,this._playLength=0,this._sequence=[],this._cache=new Map}async play(t,e,s=0,i=-1){this.reset(),this._currentSong=new th(t),this._startPos=Math.trunc(s),this._playLength=i,this._currentPos=this._startPos,this._currentSongId=e,await this.preload(),this._isPlaying=!0,this.tick(),this._tickerInterval=window.setInterval(()=>this.tick(),1e3)}reset(){this._isPlaying=!1,window.clearInterval(this._tickerInterval),Bi.Howler.stop(),this._currentSongId=-1,this._currentSong=void 0,this._tickerInterval=void 0,this._startPos=0,this._playLength=0,this._sequence=[],this._currentPos=0}pause(){this._isPlaying=!1,Bi.Howler.stop()}resume(){this._isPlaying=!0}stop(){const t=this._currentSongId;this.reset(),H.instance.soundManager.events.dispatchEvent(new Zr(Zr.TRAX_SONG_COMPLETE,t))}setVolume(t){Bi.Howler.volume(t)}getVolume(){return Bi.Howler.volume()}async getSample(t){let e=this._cache.get(t);return e||(e=await this.loadSong(t)),Promise.resolve(e)}async preload(){if(this._sequence=[],!!this._currentSong){for(const t of this._currentSong.channels){const e=[];for(const s of t.items){const i=await this.getSample(s.id),r=Math.ceil(s.length*2/Math.ceil(i.duration()));for(let a=0;a<r;a++)for(let o=0;o<Math.ceil(i.duration());o++)e.push({sampleId:s.id,offset:o})}this._sequence.push(e)}this._playLength<=0&&(this._playLength=Math.max(...this._sequence.map(t=>t.length)))}}async preloadSamplesForSong(t){const e=new th(t);await Promise.all(e.getSampleIds().map(s=>this.getSample(s)))}async loadSong(t){return new Promise((e,s)=>{const i=new Bi.Howl({src:[this._sampleUrl.replace("%sample%",t.toString())],preload:!0});i.once("load",()=>{this._cache.set(t,i),e(i)}),i.once("loaderror",()=>{G.error("failed to load sample "+t),s("failed to load sample "+t)})})}tick(){this._currentPos>this._playLength-1&&this.stop(),this._isPlaying&&(this._currentSong&&this.playPosition(this._currentPos),this._currentPos++)}playPosition(t){if(!(!this._currentSong||!this._sequence)&&Bi.Howler._audioUnlocked)for(const e of this._sequence){const s=e[t];if(!s||s.sampleId===-1||s.sampleId===0)continue;const i=this._cache.get(s.sampleId);i&&(s.offset===0?i.play():i.playing()||(i.seek(s.offset),i.play()))}}}const iu=class $n{constructor(){this._priorityPlaying=-1,this._requestNumberPlaying=-1,this._previousNotificationTime=-1,this._timerInstance=-1,this._songRequestList=[],this._requestedSongs=new Map,this._availableSongs=new Map,this._songDiskInventory=new vt,this._songRequestsPerPriority=[],this._songRequestCountsPerPriority=[],this._diskInventoryMissingData=[],this._songIdPlaying=-1,this._previousNotifiedSongId=-1,this._messageEvents=[new jd(this.onTraxSongInfoMessageEvent.bind(this)),new zd(this.onSongDiskInventoryMessage.bind(this))],this.onJukeboxInit=this.onJukeboxInit.bind(this),this.onJukeboxDispose=this.onJukeboxDispose.bind(this),this.onSoundMachineInit=this.onSoundMachineInit.bind(this),this.onSoundMachineDispose=this.onSoundMachineDispose.bind(this),this.onTraxSongComplete=this.onTraxSongComplete.bind(this)}init(){this._timerInstance=window.setInterval(this.onTick.bind(this),1e3),this._musicPlayer=new XV(H.instance.getConfiguration("external.samples.url")),this._messageEvents.forEach(t=>H.instance.communication.connection.addMessageEvent(t)),H.instance.roomEngine.events.addEventListener(Et.JUKEBOX_INIT,this.onJukeboxInit),H.instance.roomEngine.events.addEventListener(Et.JUKEBOX_DISPOSE,this.onJukeboxDispose),H.instance.roomEngine.events.addEventListener(Et.SOUND_MACHINE_INIT,this.onSoundMachineInit),H.instance.roomEngine.events.addEventListener(Et.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),H.instance.soundManager.events.addEventListener(Zr.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}getRoomItemPlaylist(t){return this._roomItemPlaylist}get songDiskInventory(){return this._songDiskInventory}getSongDiskInventorySize(){return this._songDiskInventory.length}getSongDiskInventoryDiskId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getKey(t):-1}getSongDiskInventorySongId(t){return t>=0&&t<this._songDiskInventory.length?this._songDiskInventory.getWithIndex(t):-1}getSongInfo(t){const e=this.getSongDataEntry(t);return e||this.requestSongInfoWithoutSamples(t),e}getSongIdPlayingAtPriority(t){return t!==this._priorityPlaying?-1:this._songIdPlaying}stop(t){const e=t===this._priorityPlaying,s=this.getTopRequestPriority()===t;e?(this.resetSongStartRequest(t),this.stopSongAtPriority(t)):(this.resetSongStartRequest(t),s&&this.reRequestSongAtPriority(this._priorityPlaying))}addSongInfoRequest(t){this.requestSong(t,!0)}requestSongInfoWithoutSamples(t){this.requestSong(t,!1)}requestUserSongDisks(){H.instance.communication.connection.send(new RE)}updateVolume(t){this._musicPlayer.setVolume(t)}dispose(){this._timerInstance&&(clearInterval(this._timerInstance),this._timerInstance=void 0),this._messageEvents.forEach(t=>H.instance.communication.connection.removeMessageEvent(t)),H.instance.roomEngine.events.removeEventListener(Et.JUKEBOX_INIT,this.onJukeboxInit),H.instance.roomEngine.events.removeEventListener(Et.JUKEBOX_DISPOSE,this.onJukeboxDispose),H.instance.roomEngine.events.removeEventListener(Et.SOUND_MACHINE_INIT,this.onSoundMachineInit),H.instance.roomEngine.events.removeEventListener(Et.SOUND_MACHINE_DISPOSE,this.onSoundMachineDispose),H.instance.soundManager.events.removeEventListener(Zr.TRAX_SONG_COMPLETE,this.onTraxSongComplete)}get samplesIdsInUse(){let t,e,s=[];for(let i=0;i<this._songRequestsPerPriority.length;i++)if(this._songRequestsPerPriority[i]&&(t=this._songRequestsPerPriority[i],e=this._availableSongs.get(t.songId),e)){const r=e.songData;if(r.length>0){const a=new th(r);s=s.concat(a.getSampleIds())}}return s}onSongLoaded(t){const e=this.getTopRequestPriority();if(e>=0){const s=this.getSongIdRequestedAtPriority(e);t===s&&this.playSongObject(e,t)}}samplesUnloaded(t){throw new Error("Method not implemented.")}onTraxSongComplete(t){if(this.getSongIdPlayingAtPriority(this._priorityPlaying)===t.id){this.getTopRequestPriority()===this._priorityPlaying&&this.getSongRequestCountAtPriority(this._priorityPlaying)==this._requestNumberPlaying&&this.resetSongStartRequest(this._priorityPlaying);const e=this._priorityPlaying;this.playSongWithHighestPriority(),e>=se.PRIORITY_SONG_PLAY&&H.instance.soundManager.events.dispatchEvent(new vs(vs.NPW_USER_STOP_SONG,e,t.id,-1))}}onTraxSongInfoMessageEvent(t){const e=t.getParser();for(const s of e.songs){const i=!!this.getSongDataEntry(s.id);if(this.areSamplesRequested(s.id),!i){const r=new Vf(s.id,s.length,s.name,s.creator,s.data);this._availableSongs.set(s.id,r);const a=this.getTopRequestPriority(),o=this.getSongIdRequestedAtPriority(a);for(s.id===o&&this.playSongObject(a,o),H.instance.soundManager.events.dispatchEvent(new Jr(Jr.SIR_TRAX_SONG_INFO_RECEIVED,s.id));this._diskInventoryMissingData.indexOf(s.id)!=-1;)this._diskInventoryMissingData.splice(this._diskInventoryMissingData.indexOf(s.id),1),this._diskInventoryMissingData.length===0&&H.instance.soundManager.events.dispatchEvent(new Vr(Vr.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}}}onSongDiskInventoryMessage(t){const e=t.getParser();this._songDiskInventory.reset();for(let s=0;s<e.songDiskCount;s++){const i=e.getDiskId(s),r=e.getSongId(s);this._songDiskInventory.add(i,r),this._availableSongs.get(r)||(this._diskInventoryMissingData.push(r),this.requestSongInfoWithoutSamples(r))}this._diskInventoryMissingData.length===0&&H.instance.soundManager.events.dispatchEvent(new Vr(Vr.SDIR_SONG_DISK_INVENTORY_RECEIVENT_EVENT))}onTick(){this._songRequestList.length!==0&&(H.instance.communication.connection.send(new IE(...this._songRequestList)),this._songRequestList=[])}requestSong(t,e){this._requestedSongs.get(t)===void 0&&(this._requestedSongs.set(t,e),this._songRequestList.push(t))}areSamplesRequested(t){return this._requestedSongs.get(t)?this._requestedSongs.get(t):!1}processSongEntryForPlaying(t,e=!0){return this.getSongDataEntry(t)?!0:(this.addSongInfoRequest(t),!1)}playSong(t,e,s=0,i=0,r=.5,a=.5){return!this.addSongStartRequest(e,t,s,i,r,a)||!this.processSongEntryForPlaying(t)?!1:(e>=this._priorityPlaying&&this.playSongObject(e,t),!0)}playSongObject(t,e){if(e===-1||t<0||t>=se.PRIORITY_COUNT)return!1;let s=!1;this.stopSongAtPriority(this._priorityPlaying)&&(s=!0);const i=this.getSongDataEntry(e);if(!i)return!1;if(s)return!0;this._musicPlayer.setVolume(H.instance.soundManager.traxVolume);let r=$n.SKIP_POSITION_SET,a=0;const o=this.getSongStartRequest(t);return o&&(r=o.startPos,a=o.playLength,o.fadeInSeconds,o.fadeOutSeconds),r>=i.length/1e3?!1:(r<=$n.SKIP_POSITION_SET&&(r=0),r=Math.trunc(r),this._priorityPlaying=t,this._requestNumberPlaying=this.getSongRequestCountAtPriority(t),this._songIdPlaying=e,this._priorityPlaying<=$n.MAXIMUM_NOTIFY_PRIORITY&&this.notifySongPlaying(i),this._musicPlayer.preloadSamplesForSong(i.songData).then(()=>this._musicPlayer.play(i.songData,i.id,r,a)),t>se.PRIORITY_ROOM_PLAYLIST&&H.instance.soundManager.events.dispatchEvent(new vs(vs.NPE_USER_PLAY_SONG,t,i.id,-1)),!0)}notifySongPlaying(t){const s=Date.now();t.length>=8e3&&(this._previousNotifiedSongId!=t.id||s>this._previousNotificationTime+8e3)&&(H.instance.soundManager.events.dispatchEvent(new YV(t.name,t.creator)),this._previousNotifiedSongId=t.id,this._previousNotificationTime=s)}addSongStartRequest(t,e,s,i,r,a){if(t<0||t>=se.PRIORITY_COUNT)return!1;const o=new zV(e,s,i,r,a);return this._songRequestsPerPriority[t]=o,this._songRequestCountsPerPriority[t]=this._songRequestCountsPerPriority[t]+1,!0}getSongDataEntry(t){let e;return this._availableSongs&&(e=this._availableSongs.get(t)),e}getSongStartRequest(t){return this._songRequestsPerPriority[t]}getTopRequestPriority(){return this._songRequestsPerPriority.length-1}getSongIdRequestedAtPriority(t){return t<0||t>=se.PRIORITY_COUNT||!this._songRequestsPerPriority[t]?-1:this._songRequestsPerPriority[t].songId}getSongRequestCountAtPriority(t){return t<0||t>=se.PRIORITY_COUNT?-1:this._songRequestCountsPerPriority[t]}playSongWithHighestPriority(){let t;this._priorityPlaying=-1,this._songIdPlaying=-1,this._requestNumberPlaying=-1;let s=this.getTopRequestPriority();for(;s>=0;){if(t=this.getSongIdRequestedAtPriority(s),t>=0&&this.playSongObject(s,t))return;s--}}resetSongStartRequest(t){t>=0&&t<se.PRIORITY_COUNT&&(this._songRequestsPerPriority[t]=void 0)}reRequestSongAtPriority(t){this._songRequestCountsPerPriority[t]=this._songRequestCountsPerPriority[t]+1}stopSongAtPriority(t){if(t===this._priorityPlaying&&this._priorityPlaying>=0){const e=this.getSongIdPlayingAtPriority(t);if(e>=0)return this.getSongDataEntry(e),this._musicPlayer.stop(),!0}return!1}onSoundMachineInit(t){this.disposeRoomPlaylist()}onSoundMachineDispose(t){this.disposeRoomPlaylist()}onJukeboxInit(t){this.disposeRoomPlaylist(),this._roomItemPlaylist=new WV,this._roomItemPlaylist.init(),H.instance.communication.connection.send(new mE)}onJukeboxDispose(t){this.disposeRoomPlaylist()}disposeRoomPlaylist(){this._roomItemPlaylist&&(this._roomItemPlaylist.dispose(),this._roomItemPlaylist=void 0)}};iu.SKIP_POSITION_SET=-1;iu.MAXIMUM_NOTIFY_PRIORITY=se.PRIORITY_ROOM_PLAYLIST;let qV=iu;class QV extends ns{constructor(){super(),this._volumeSystem=.5,this._volumeFurni=.5,this._volumeTrax=.5,this._internalSamples=new vt,this._furniSamples=new vt,this._furnitureBeingPlayed=new vt,this._musicController=new qV,this.onEvent=this.onEvent.bind(this)}onInit(){this._musicController.init(),H.instance.roomEngine.events.addEventListener(_e.PLAY_SAMPLE,this.onEvent),H.instance.roomEngine.events.addEventListener(V.REMOVED,this.onEvent),H.instance.roomEngine.events.addEventListener(ot.DISPOSED,this.onEvent),H.instance.events.addEventListener(jr.SETTINGS_UPDATED,this.onEvent),H.instance.events.addEventListener(Bn.PLAY_SOUND,this.onEvent)}onDispose(){this._musicController&&(this._musicController.dispose(),this._musicController=null),H.instance.roomEngine.events.removeEventListener(_e.PLAY_SAMPLE,this.onEvent),H.instance.roomEngine.events.removeEventListener(V.REMOVED,this.onEvent),H.instance.roomEngine.events.removeEventListener(ot.DISPOSED,this.onEvent),H.instance.events.removeEventListener(jr.SETTINGS_UPDATED,this.onEvent),H.instance.events.removeEventListener(Bn.PLAY_SOUND,this.onEvent)}onEvent(t){var e;switch(t.type){case _e.PLAY_SAMPLE:{const s=t;this.playFurniSample(s.objectId,s.sampleId,s.pitch);return}case V.REMOVED:{const s=t;this.stopFurniSample(s.objectId);return}case ot.DISPOSED:{this._furnitureBeingPlayed.getKeys().forEach(s=>{this.stopFurniSample(s)});return}case jr.SETTINGS_UPDATED:{const s=t,i=s.volumeFurni!==this._volumeFurni,r=s.volumeTrax!==this._volumeTrax;this._volumeSystem=s.volumeSystem/100,this._volumeFurni=s.volumeFurni/100,this._volumeTrax=s.volumeTrax/100,i&&this.updateFurniSamplesVolume(this._volumeFurni),r&&((e=this._musicController)==null||e.updateVolume(this._volumeTrax));return}case Bn.PLAY_SOUND:{const s=t;this.playInternalSample(s.sampleCode);return}}}playSample(t,e,s=1){t.volume=e,t.currentTime=0;try{t.play()}catch(i){G.error(i)}}playInternalSample(t){let e=this._internalSamples.getValue(t);if(!e){const s=k.getValue("sounds.url");e=new Audio(s.replace("%sample%",t)),this._internalSamples.add(t,e)}this.playSample(e,this._volumeSystem)}playFurniSample(t,e,s){let i=this._furniSamples.getValue(e);if(!i){const r=k.getValue("external.samples.url");i=new Audio(r.replace("%sample%",e.toString())),this._furniSamples.add(e,i)}this._furnitureBeingPlayed.hasKey(t)||this._furnitureBeingPlayed.add(t,e),i.onended=r=>{this.stopFurniSample(t)},i.onpause=r=>{this.stopFurniSample(t)},i.onerror=r=>{this.stopFurniSample(t)},this.playSample(i,this._volumeFurni,s)}stopInternalSample(t){const e=this._internalSamples.getValue(t);if(e)try{e.pause()}catch(s){G.error(s)}}stopFurniSample(t){const e=this._furnitureBeingPlayed.getValue(t);if(!e)return;const s=this._furniSamples.getValue(e);if(this._furnitureBeingPlayed.remove(t),!!s)try{s.pause()}catch(i){G.error(i)}}updateInternalSamplesVolume(t){this._internalSamples.getValues().forEach(e=>{e.volume=t})}updateFurniSamplesVolume(t){this._furniSamples.getValues().forEach(e=>{e.volume=t})}get traxVolume(){return this._volumeTrax}get musicController(){return this._musicController}}at.available;Ma.SCALE_MODE=window.devicePixelRatio%1?Uo.LINEAR:Uo.NEAREST;Ma.ROUND_PIXELS=!0;Ma.GC_MAX_IDLE=120;const Dn=class fi{constructor(t,e){fi.INSTANCE||(fi.INSTANCE=this),this._application=new zt(e),this._core=t,this._events=new pe,this._communication=new ew(t.communication),this._localization=new iw(this._communication),this._avatar=new aj,this._roomEngine=new Zh(this._communication),this._sessionDataManager=new jV(this._communication),this._roomSessionManager=new VV(this._communication,this._roomEngine),this._roomManager=new KI(this._roomEngine,this._roomEngine.visualizationFactory,this._roomEngine.logicFactory),this._cameraManager=new qI,this._soundManager=new QV,this._linkTrackers=[],this._isReady=!1,this._isDisposed=!1,this._core.configuration.events.addEventListener(Js.LOADED,this.onConfigurationLoadedEvent.bind(this)),this._roomEngine.events.addEventListener(ot.ENGINE_INITIALIZED,this.onRoomEngineReady.bind(this))}static bootstrap(){fi.INSTANCE&&(fi.INSTANCE.dispose(),fi.INSTANCE=null);const t=document.createElement("canvas"),e=new this(new oI,{autoDensity:!1,width:window.innerWidth,height:window.innerHeight,resolution:window.devicePixelRatio,view:t});t.addEventListener("webglcontextlost",()=>e.events.dispatchEvent(new rt(fi.WEBGL_CONTEXT_LOST)))}init(){if(!(this._isReady||this._isDisposed)){if(this._avatar&&this._avatar.init(),this._soundManager&&this._soundManager.init(),this._roomEngine&&(this._roomEngine.sessionDataManager=this._sessionDataManager,this._roomEngine.roomSessionManager=this._roomSessionManager,this._roomEngine.roomManager=this._roomManager,this._sessionDataManager&&this._sessionDataManager.init(),this._roomSessionManager&&this._roomSessionManager.init(),this._roomEngine.init()),!this._communication.connection)throw new Error("No connection found");new sw(this._communication.connection),this._isReady=!0}}dispose(){this._isDisposed||(this._roomManager&&(this._roomManager.dispose(),this._roomManager=null),this._roomSessionManager&&(this._roomSessionManager.dispose(),this._roomSessionManager=null),this._sessionDataManager&&(this._sessionDataManager.dispose(),this._sessionDataManager=null),this._roomEngine&&(this._roomEngine.dispose(),this._roomEngine=null),this._avatar&&(this._avatar.dispose(),this._avatar=null),this._soundManager&&(this._soundManager.dispose(),this._soundManager=null),this._communication&&(this._communication.dispose(),this._communication=null),this._application&&(this._application.destroy(),this._application=null),this._isDisposed=!0,this._isReady=!1)}onConfigurationLoadedEvent(t){Ss().maxFPS=k.getValue("system.fps.max",24),G.LOG_DEBUG=k.getValue("system.log.debug",!0),G.LOG_WARN=k.getValue("system.log.warn",!1),G.LOG_ERROR=k.getValue("system.log.error",!1),G.LOG_EVENTS=k.getValue("system.log.events",!1),G.LOG_PACKETS=k.getValue("system.log.packets",!1),bf.LANDSCAPES_ENABLED=k.getValue("room.landscapes.enabled",!0)}onRoomEngineReady(t){this.startSendingHeartBeat()}getConfiguration(t,e=null){return k.getValue(t,e)}getLocalization(t){return this._localization.getValue(t)}getLocalizationWithParameter(t,e,s){return this._localization.getValueWithParameter(t,e,s)}getLocalizationWithParameters(t,e,s){return this._localization.getValueWithParameters(t,e,s)}addLinkEventTracker(t){this._linkTrackers.indexOf(t)>=0||this._linkTrackers.push(t)}removeLinkEventTracker(t){const e=this._linkTrackers.indexOf(t);e!==-1&&this._linkTrackers.splice(e,1)}createLinkEvent(t){if(!(!t||t===""))for(const e of this._linkTrackers){if(!e)continue;const s=e.eventUrlPrefix;s.length>0?t.substr(0,s.length)===s&&e.linkReceived(t):e.linkReceived(t)}}startSendingHeartBeat(){this.sendHeartBeat(),setInterval(this.sendHeartBeat,1e4)}sendHeartBeat(){pa.sendHeartBeat()}get application(){return this._application}get core(){return this._core}get events(){return this._events}get localization(){return this._localization}get communication(){return this._communication}get avatar(){return this._avatar}get roomEngine(){return this._roomEngine}get sessionDataManager(){return this._sessionDataManager}get roomSessionManager(){return this._roomSessionManager}get roomManager(){return this._roomManager}get cameraManager(){return this._cameraManager}get soundManager(){return this._soundManager}get width(){return this._application.renderer.width}get height(){return this._application.renderer.height}get isReady(){return this._isReady}get isDisposed(){return this._isDisposed}static get instance(){return this.INSTANCE||null}};Dn.WEBGL_CONTEXT_LOST="NE_WEBGL_CONTEXT_LOST";Dn.WEBGL_UNAVAILABLE="NE_WEBGL_UNAVAILABLE";Dn.READY="NE_READY!";Dn.INSTANCE=null;let H=Dn;const Pe=class dt{static format(t,e="",s=3){return t>s*dt.YEAR?dt.getLocalization("friendlytime.years"+e,Math.round(t/dt.YEAR)):t>s*dt.MONTH?dt.getLocalization("friendlytime.months"+e,Math.round(t/dt.MONTH)):t>s*dt.DAY?dt.getLocalization("friendlytime.days"+e,Math.round(t/dt.DAY)):t>s*dt.HOUR?dt.getLocalization("friendlytime.hours"+e,Math.round(t/dt.HOUR)):t>s*dt.MINUTE?dt.getLocalization("friendlytime.minutes"+e,Math.round(t/dt.MINUTE)):dt.getLocalization("friendlytime.seconds"+e,Math.round(t))}static shortFormat(t,e="",s=3){return t>s*dt.YEAR?dt.getLocalization("friendlytime.years.short"+e,Math.round(t/dt.YEAR)):t>s*dt.MONTH?dt.getLocalization("friendlytime.months.short"+e,Math.round(t/dt.MONTH)):t>s*dt.DAY?dt.getLocalization("friendlytime.days.short"+e,Math.round(t/dt.DAY)):t>s*dt.HOUR?dt.getLocalization("friendlytime.hours.short"+e,Math.round(t/dt.HOUR)):t>s*dt.MINUTE?dt.getLocalization("friendlytime.minutes.short"+e,Math.round(t/dt.MINUTE)):dt.getLocalization("friendlytime.seconds.short"+e,Math.round(t))}static getLocalization(t,e){return H.instance.getLocalizationWithParameter(t,"amount",e.toString())}};Pe.MINUTE=60;Pe.HOUR=60*Pe.MINUTE;Pe.DAY=24*Pe.HOUR;Pe.WEEK=7*Pe.DAY;Pe.MONTH=30*Pe.DAY;Pe.YEAR=365*Pe.DAY;let Sj=Pe;const Yf=class Wf{static isBuilderClubId(t){return t>=Wf.BUILDER_CLUB_FURNI_ID_BASE}};Yf.BUILDER_CLUB_FURNI_ID_BASE=2147418112;let Gu=Yf;const JV=n=>n>>>0,kf=n=>{const t=JV(n);return t>=Math.pow(2,31)?t-Math.pow(2,32):t};class ru{constructor(t){if(this._id=t.id,this._isMain=t.main||!1,this._avatarSets=new Map,this._bodyParts=[],this._allBodyParts=[],t.avatarSets&&t.avatarSets.length>0)for(const s of t.avatarSets){if(!s)continue;const i=new ru(s);this._avatarSets.set(i.id,i)}if(t.bodyParts&&t.bodyParts.length>0)for(const s of t.bodyParts)s&&this._bodyParts.push(s.id);let e=this._bodyParts.concat();for(const s of this._avatarSets.values())s&&(e=e.concat(s.getBodyParts()));this._allBodyParts=e}findAvatarSet(t){if(t===this._id)return this;for(const e of this._avatarSets.values())if(e&&e.findAvatarSet(t))return e;return null}getBodyParts(){return this._allBodyParts.concat()}get id(){return this._id}get isMain(){if(this._isMain)return!0;for(const t of this._avatarSets.values())if(t&&t.isMain)return!0;return!1}}class Te{constructor(t=0,e=0,s=0){this._x=t,this._y=e,this._z=s}static dot(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}static cross(t,e){const s=new Te;return s.x=t.y*e.z-t.z*e.y,s.y=t.z*e.x-t.x*e.z,s.z=t.x*e.y-t.y*e.x,s}static subtract(t,e){return new Te(t.x-e.x,t.y-e.y,t.z-e.z)}dot(t){return this._x*t.x+this._y*t.y+this._z*t.z}cross(t){const e=new Te;return e.x=this._y*t.z-this._z*t.y,e.y=this._z*t.x-this._x*t.z,e.z=this._x*t.y-this._y*t.x,e}subtract(t){this._x=this._x-t.x,this._y=this._y-t.y,this._z=this._z-t.z}add(t){this._x=this._x+t.x,this._y=this._y+t.y,this._z=this._z+t.z}normalize(){const t=1/this.length();this._x=this._x*t,this._y=this._y*t,this._z=this._z*t}scaleBy(t){this._x*=t,this._y*=t,this._z*=t}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z)}toString(){return"Vector3D: ("+this._x+","+this._y+","+this._z+")"}get x(){return this._x}set x(t){this._x=t}get y(){return this._y}set y(t){this._y=t}get z(){return this._z}set z(t){this._z=t}}class Kf{constructor(t,e,s){this._location=new Te(t,e,s),this._transformedLocation=new Te,this._needsTransformation=!1,(t!=0||e!=0||s!=0)&&(this._needsTransformation=!0)}get location(){return this._location}get transformedLocation(){return this._transformedLocation}applyTransform(t){this._needsTransformation&&(this._transformedLocation=t.vectorMultiplication(this._location))}}class Bu extends Kf{constructor(t,e=!1){super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._normal=new Te(parseFloat(t.nx),parseFloat(t.ny),parseFloat(t.nz)),this._isDoubleSided=t.double||!1,this._isDynamic=e}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get normal(){return this._normal}get isDoubleSided(){return this._isDoubleSided}toString(){return this._id+": "+this.location+" - "+this.transformedLocation}get isDynamic(){return this._isDynamic}}class ZV extends Kf{constructor(t){if(super(parseFloat(t.x),parseFloat(t.y),parseFloat(t.z)),this._id=t.id,this._radius=parseFloat(t.radius),this._parts=new Map,this._dynamicParts=new Map,t.items&&t.items.length>0)for(const e of t.items){if(!e)continue;const s=new Bu(e);this._parts.set(s.id,s)}}getDynamicParts(t){const e=this._dynamicParts.get(t),s=[];if(e)for(const i in e){const r=e[i];r&&s.push(r)}return s}getPartIds(t){const e=[];for(const s of this._parts.values())s&&e.push(s.id);if(t){const s=this._dynamicParts.get(t);if(s)for(const i in s){const r=s[i];r&&e.push(r.id)}}return e}removeDynamicParts(t){return this._dynamicParts.delete(t),!0}addPart(t,e){if(this.hasPart(t.id,e))return!1;let s=this._dynamicParts.get(e);return s||(s={},this._dynamicParts.set(e,s)),s[t.id]=new Bu(t,!0),!0}hasPart(t,e){let s=this._parts.get(t)||null;return!s&&this._dynamicParts.get(e)!==void 0&&(s=this._dynamicParts.get(e)[t]||null),s!==null}getParts(t,e,s,i){const r=[];for(const _ of this._parts.values())_&&(_.applyTransform(t),r.push([_.getDistance(e),_]));const a=this._dynamicParts.get(i);if(a)for(const _ in a){const l=a[_];l&&(l.applyTransform(t),r.push([l.getDistance(e),l]))}r.sort((_,l)=>{const c=_[0],d=l[0];return c<d?-1:c>d?1:0});const o=[];for(const _ of r)_&&o.push(_[1].id);return o}getDistance(t){const e=Math.abs(t.z-this.transformedLocation.z-this._radius),s=Math.abs(t.z-this.transformedLocation.z+this._radius);return Math.min(e,s)}get id(){return this._id}get radius(){return this._radius}}const Oa=class Ts{constructor(t=0,e=0,s=0,i=0,r=0,a=0,o=0,_=0,l=0){this._data=[t,e,s,i,r,a,o,_,l]}static getXRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Ts(1,0,0,0,s,-i,0,i,s)}static getYRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Ts(s,0,i,0,1,0,-i,0,s)}static getZRotationMatrix(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Ts(s,-i,0,i,s,0,0,0,1)}identity(){return this._data=[1,0,0,0,1,0,0,0,1],this}vectorMultiplication(t){const e=t.x*this._data[0]+t.y*this._data[3]+t.z*this._data[6],s=t.x*this._data[1]+t.y*this._data[4]+t.z*this._data[7],i=t.x*this._data[2]+t.y*this._data[5]+t.z*this._data[8];return new Te(e,s,i)}multiply(t){const e=this._data[0]*t.data[0]+this._data[1]*t.data[3]+this._data[2]*t.data[6],s=this._data[0]*t.data[1]+this._data[1]*t.data[4]+this._data[2]*t.data[7],i=this._data[0]*t.data[2]+this._data[1]*t.data[5]+this._data[2]*t.data[8],r=this._data[3]*t.data[0]+this._data[4]*t.data[3]+this._data[5]*t.data[6],a=this._data[3]*t.data[1]+this._data[4]*t.data[4]+this._data[5]*t.data[7],o=this._data[3]*t.data[2]+this._data[4]*t.data[5]+this._data[5]*t.data[8],_=this._data[6]*t.data[0]+this._data[7]*t.data[3]+this._data[8]*t.data[6],l=this._data[6]*t.data[1]+this._data[7]*t.data[4]+this._data[8]*t.data[7],c=this._data[6]*t.data[2]+this._data[7]*t.data[5]+this._data[8]*t.data[8];return new Ts(e,s,i,r,a,o,_,l,c)}scalarMultiply(t){let e=0;for(;e<this._data.length;)this._data[e]=this._data[e]*t,e++}rotateX(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Ts(1,0,0,0,s,-i,0,i,s).multiply(this)}rotateY(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Ts(s,0,i,0,1,0,-i,0,s).multiply(this)}rotateZ(t){const e=t*Math.PI/180,s=Math.cos(e),i=Math.sin(e);return new Ts(s,-i,0,i,s,0,0,0,1).multiply(this)}skew(){}transpose(){return new Ts(this._data[0],this._data[3],this._data[6],this._data[1],this._data[4],this._data[7],this._data[2],this._data[5],this._data[8])}equals(t){return!1}get data(){return this._data}};Oa.IDENTITY=new Oa(1,0,0,0,1,0,0,0,1);Oa.TOLERANS=1e-18;let Po=Oa;class $V{constructor(t){this._camera=new Te(0,0,10),this._avatarSet=new ru(t.avatarSets[0]),this._geometryTypes=new Map,this._itemIdToBodyPartMap=new Map,this._transformation=new Po,this._canvases=new Map;const e=t.camera;if(e&&(this._camera.x=parseFloat(e.x),this._camera.y=parseFloat(e.y),this._camera.z=parseFloat(e.z)),t.canvases&&t.canvases.length>0)for(const s of t.canvases){if(!s)continue;const i=s.scale,r=new Map;if(s.geometries&&s.geometries.length>0)for(const a of s.geometries){if(!a)continue;const o=new MI(a,i);r.set(o.id,o)}this._canvases.set(i,r)}if(t.types&&t.types.length>0)for(const s of t.types){if(!s)continue;const i=new Map,r=new Map;if(s.bodyParts&&s.bodyParts.length>0)for(const a of s.bodyParts){if(!a)continue;const o=new ZV(a);i.set(o.id,o);for(const _ of o.getPartIds(null))r.set(_,o)}this._geometryTypes.set(s.id,i),this._itemIdToBodyPartMap.set(s.id,r)}}removeDynamicItems(t){for(const e of this._geometryTypes.values())if(e)for(const s of e.values())s&&s.removeDynamicParts(t)}getBodyPartIdsInAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.getBodyParts():[]}isMainAvatarSet(t){const e=this._avatarSet.findAvatarSet(t);return e?e.isMain:!1}getCanvas(t,e){const s=this._canvases.get(t);return s&&s.get(e)||null}typeExists(t){return!!this._geometryTypes.get(t)}hasBodyPart(t,e){if(this.typeExists(t)){const s=this._geometryTypes.get(t);if(s&&s.get(e))return!0}return!1}getBodyPartIDs(t){const e=this.getBodyPartsOfType(t),s=[];if(e)for(const i of e.values())i&&s.push(i.id);return s}getBodyPartsOfType(t){return this.typeExists(t)?this._geometryTypes.get(t):new Map}getBodyPart(t,e){return this.getBodyPartsOfType(t).get(e)||null}getBodyPartOfItem(t,e,s){const i=this._itemIdToBodyPartMap.get(t);if(i){const r=i.get(e);if(r)return r;const a=this.getBodyPartsOfType(t);if(a){for(const o of a.values())if(o&&o.hasPart(e,s))return o}}return null}getBodyPartsInAvatarSet(t,e){const s=this.getBodyPartIdsInAvatarSet(e),i=[];for(const r of s){if(!r)continue;const a=t.get(r);a&&i.push(a)}return i}getBodyPartsAtAngle(t,e,s){if(!s)return[];const i=this.getBodyPartsOfType(s),r=this.getBodyPartsInAvatarSet(i,t),a=[],o=[];this._transformation=Po.getYRotationMatrix(e);for(const _ of r.values())_&&(_.applyTransform(this._transformation),a.push([_.getDistance(this._camera),_]));a.sort((_,l)=>{const c=_[0],d=l[0];return c<d?-1:c>d?1:0});for(const _ of a)_&&o.push(_[1].id);return o}getParts(t,e,s,i,r){if(this.hasBodyPart(t,e)){const a=this.getBodyPartsOfType(t).get(e);return this._transformation=Po.getYRotationMatrix(s),a.getParts(this._transformation,this._camera,i,r)}return[]}}class tj extends pe{constructor(t){super(),this._renderManager=t,this._geometry=null,this._figureData=new PI,this._partSetsData=new yI,this._animationData=new SI,this._animationManager=new II,this._mandatorySetTypeIds={},this._actionManager=null,this._defaultAction=null}init(){}dispose(){this.disposed||(super.dispose(),this._renderManager=null,this._figureData=null,this._partSetsData=null,this._animationData=null,this._mandatorySetTypeIds=null)}initGeometry(t){t&&(this._geometry=new $V(t))}initActions(t,e){e&&(this._actionManager=new uI(t,e),this._defaultAction=this._actionManager.getDefaultAction())}updateActions(t){this._actionManager.updateActions(t),this._defaultAction=this._actionManager.getDefaultAction()}initPartSets(t){return t&&this._partSetsData.parse(t)?(this._partSetsData.getPartDefinition("ri").appendToFigure=!0,this._partSetsData.getPartDefinition("li").appendToFigure=!0,!0):!1}initAnimation(t){return t?this._animationData.parse(t):!1}initFigureData(t){return t?this._figureData.parse(t):!1}injectFigureData(t){this._figureData.injectJSON(t)}registerAnimations(t,e="fx",s=200){let i=0;for(;i<s;){const r=t.getCollection(e+i);if(r){const a=r.data;this._animationManager.registerAnimation(this,a.animations)}i++}}registerAnimation(t){this._animationManager.registerAnimation(this,t)}getPartColor(t,e,s=0){const i=t.getPartColorIds(e);if(!i||i.length<s)return null;const r=this._figureData.getSetType(e);if(r==null)return null;const a=this._figureData.getPalette(r.paletteID);return a?a.getColor(i[s]):null}getBodyPartData(t,e,s){return this._animationManager.getLayerData(t,e,s)}getAnimation(t){return this._animationManager.getAnimation(t)}getActionDefinition(t){return this._actionManager.getActionDefinition(t)}getActionDefinitionWithState(t){return this._actionManager.getActionDefinitionWithState(t)}isMainAvatarSet(t){return this._geometry.isMainAvatarSet(t)}sortActions(t){return this._actionManager.sortActions(t)}maxFrames(t){let e=0;for(const s of t)e=Math.max(e,this._animationData.getFrameCount(s.definition));return e}getMandatorySetTypeIds(t,e){return this._mandatorySetTypeIds[t]||(this._mandatorySetTypeIds[t]=[]),this._mandatorySetTypeIds[t][e]?this._mandatorySetTypeIds[t][e]:(this._mandatorySetTypeIds[t][e]=this._figureData.getMandatorySetTypeIds(t,e),this._mandatorySetTypeIds[t][e])}getDefaultPartSet(t,e){return this._figureData.getDefaultPartSet(t,e)}getCanvasOffsets(t,e,s){return this._actionManager.getCanvasOffsets(t,e,s)}getCanvas(t,e){return this._geometry.getCanvas(t,e)}removeDynamicItems(t){this._geometry.removeDynamicItems(t)}getActiveBodyPartIds(t,e){let s=[];const i=[],r=t.definition.geometryType;if(t.definition.isAnimation){const a=t.definition.state+"."+t.actionParameter,o=this._animationManager.getAnimation(a);if(o&&(s=o.getAnimatedBodyPartIds(0,t.overridingAction),o.hasAddData())){const _={id:"",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:1},l={setType:""};for(const c of o.addData){const d=this._geometry.getBodyPart(r,c.align);if(d){_.id=c.id,d.addPart(_,e),l.setType=c.id;const E=this._partSetsData.addPartDefinition(l);E.appendToFigure=!0,c.base===""&&(E.staticId=1),i.indexOf(d.id)===-1&&i.push(d.id)}}}for(const _ of s){const l=this._geometry.getBodyPart(r,_);l&&i.indexOf(l.id)===-1&&i.push(l.id)}}else{s=this._partSetsData.getActiveParts(t.definition);for(const a of s){const o=this._geometry.getBodyPartOfItem(r,a,e);o&&i.indexOf(o.id)===-1&&i.push(o.id)}}return i}getBodyPartsUnordered(t){return this._geometry.getBodyPartIdsInAvatarSet(t)}getBodyParts(t,e,s){const i=ts.DIRECTION_TO_ANGLE[s];return this._geometry.getBodyPartsAtAngle(t,i,e)}getFrameBodyPartOffset(t,e,s,i){const r=this._animationData.getAction(t.definition);return r?r.getFrameBodyPartOffset(e,s,i):Ko.DEFAULT_OFFSET}getParts(t,e,s,i,r,a,o,_=null){let l=null,c=[],d=null;if(!s==null)return[];const E=this._partSetsData.getActiveParts(s.definition),I=[];let m=[0];const T=this._animationData.getAction(s.definition);if(s.definition.isAnimation){const C=s.definition.state+"."+s.actionParameter,L=this._animationManager.getAnimation(C);if(L){m=this.getPopulatedArray(L.frameCount(s.overridingAction));for(const D of L.getAnimatedBodyPartIds(0,s.overridingAction))if(D===t){const v=this._geometry.getBodyPart(i,D);if(v)for(const b of v.getDynamicParts(o))E.push(b.id)}}}const p=this._geometry.getParts(i,t,r,E,o),A=e.getPartTypeIds();for(const C of A){if(_&&_.get(C))continue;const L=e.getPartSetId(C),D=e.getPartColorIds(C),v=this._figureData.getSetType(C);if(v){const b=this._figureData.getPalette(v.paletteID);if(b){const q=v.getPartSet(L);if(q){a=a.concat(q.hiddenLayers);for(const Q of q.parts)if(p.indexOf(Q.type)>-1){if(T){const be=T.getPart(Q.type);be?c=be.frames:c=m}else c=m;l=s.definition,E.indexOf(Q.type)===-1&&(l=this._defaultAction);const tt=this._partSetsData.getPartDefinition(Q.type);let ct=tt?tt.flippedSetType:Q.type;(!ct||ct==="")&&(ct=Q.type),D&&D.length>Q.colorLayerIndex-1&&(d=b.getColor(D[Q.colorLayerIndex-1]));const Kt=Q.colorLayerIndex>0,Ut=new Oo(t,Q.type,Q.id.toString(),d,c,l,Kt,Q.paletteMap,ct);I.push(Ut)}}}}}const N=[];for(const C of p){let L=null,D=!1;const v=_&&_.get(C);for(const b of I)b.partType===C&&(v?L=b.color:(D=!0,a.indexOf(C)===-1&&N.push(b)));if(!D){if(v){const b=_.get(C);let q=0,Q=0;for(;Q<b.length;)q=q+b.charCodeAt(Q),Q++;if(T){const ct=T.getPart(C);ct?c=ct.frames:c=m}else c=m;const tt=new Oo(t,C,b,L,c,s.definition,L!=null,-1,C,!1,1);N.push(tt)}else if(E.indexOf(C)>-1){const b=this._geometry.getBodyPartOfItem(i,C,o);if(t===b.id){const q=this._partSetsData.getPartDefinition(C);let Q=!1,tt=1;if(q.appendToFigure){let ct="1";if(s.actionParameter!==""&&(ct=s.actionParameter),q.hasStaticId()&&(ct=q.staticId.toString()),T){const Ut=T.getPart(C);Ut?c=Ut.frames:c=m}else c=m;const Kt=new Oo(t,C,ct,null,c,s.definition,!1,-1,C,Q,tt);N.push(Kt)}}}}}return N}getPopulatedArray(t){const e=[];let s=0;for(;s<t;)e.push(s),s++;return e}getItemIds(){if(this._actionManager){const t=this._actionManager.getActionDefinition("CarryItem").params,e=[];for(const s of t.values())e.push(s);return e}return[]}get renderManager(){return this._renderManager}get figureData(){return this._figureData}get partData(){return this._partSetsData}get animationManager(){return this._animationManager}}const ej={animations:[{id:"Move",parts:[{setType:"bd",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"bds",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ss",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lg",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"sh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rh",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rhs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wlk"},{number:1,assetPartDefinition:"wlk"},{number:2,assetPartDefinition:"wlk"},{number:3,assetPartDefinition:"wlk"}]}]},{id:"Wave",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lhs",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"}]},{setType:"ch",frames:[{number:0,assetPartDefinition:"wav"},{number:1,assetPartDefinition:"wav"},{number:2,assetPartDefinition:"wav"},{number:3,assetPartDefinition:"wav"}]}]},{id:"Talk",parts:[{setType:"hd",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]},{setType:"fa",frames:[{number:0,assetPartDefinition:"spk"},{number:1,assetPartDefinition:"spk"}]}]},{id:"Sign",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"li",frames:[{number:0,assetPartDefinition:"sig"}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav"}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav"}]}]},{id:"Respect",parts:[{setType:"lh",frames:[{number:0,assetPartDefinition:"respect",repeats:15},{number:1,assetPartDefinition:"respect",repeats:15}]},{setType:"ls",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]},{setType:"lc",frames:[{number:0,assetPartDefinition:"wav",repeats:15},{number:1,assetPartDefinition:"wav",repeats:15}]}]},{id:"Blow",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw",repeats:10},{number:1,assetPartDefinition:"blw",repeats:10}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"eyb",repeats:10}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"std",repeats:10},{number:0,assetPartDefinition:"blw",repeats:10}]}]},{id:"Laugh",parts:[{setType:"rh",frames:[{number:0,assetPartDefinition:"blw"}]},{setType:"rs",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"rc",frames:[{number:0,assetPartDefinition:"drk"}]},{setType:"ri",frames:[{number:0,assetPartDefinition:""}]},{setType:"ey",frames:[{number:0,assetPartDefinition:"std",repeats:2}]},{setType:"fc",frames:[{number:0,assetPartDefinition:"sml"}]}],offsets:{frames:[{id:0,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:1}]},{id:1,bodyParts:[{id:"head",dx:0,dy:1}]},{id:2,bodyParts:[{id:"head",dx:0,dy:1}]},{id:3,bodyParts:[{id:"head",dx:0,dy:1}]},{id:4,bodyParts:[{id:"head",dx:0,dy:1}]},{id:5,bodyParts:[{id:"head",dx:0,dy:1}]},{id:6,bodyParts:[{id:"head",dx:0,dy:1}]},{id:7,bodyParts:[{id:"head",dx:0,dy:1}]}]},{id:1,directions:[{id:0,bodyParts:[{id:"head",dx:0,dy:0}]},{id:1,bodyParts:[{id:"head",dx:0,dy:0}]},{id:2,bodyParts:[{id:"head",dx:0,dy:0}]},{id:3,bodyParts:[{id:"head",dx:0,dy:0}]},{id:4,bodyParts:[{id:"head",dx:0,dy:0}]},{id:5,bodyParts:[{id:"head",dx:0,dy:0}]},{id:6,bodyParts:[{id:"head",dx:0,dy:0}]},{id:7,bodyParts:[{id:"head",dx:0,dy:0}]}]}]}}]},sj={geometry:{direction:0,camera:{x:0,y:0,z:10},canvases:[{scale:"h",geometries:[{id:"vertical",width:90,height:130,dx:0,dy:0},{id:"sitting",width:90,height:130,dx:0,dy:0},{id:"horizontal",width:128,height:80,dx:30,dy:0},{id:"swhorizontal",width:192,height:120,dx:0,dy:-40}]},{scale:"sh",geometries:[{id:"vertical",width:45,height:72,dx:0,dy:0},{id:"sitting",width:45,height:72,dx:0,dy:0},{id:"horizontal",width:64,height:50,dx:15,dy:-10},{id:"swhorizontal",width:96,height:70,dx:0,dy:-20},{id:"swim",width:64,height:70,dx:25,dy:10}]}],avatarSets:[{id:"full",avatarSets:[{id:"body",main:!0,bodyParts:[{id:"top"},{id:"bottom"},{id:"behind"},{id:"torso"},{id:"leftitem"},{id:"rightitem"},{id:"leftarm"},{id:"rightarm"}]},{id:"head",bodyParts:[{id:"head"}]}]}],types:[{id:"vertical",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"sitting",bodyParts:[{id:"top",x:0,y:0,z:0,radius:2},{id:"bottom",x:0,y:0,z:0,radius:.001},{id:"behind",x:0,y:0,z:.2,radius:.3},{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.045,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.5,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.5,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"horizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swhorizontal",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ch",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"cp",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1},{id:"sh",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!1},{id:"lg",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"wa",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!1},{id:"cc",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ca",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"li",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightitem",x:0,y:0,z:-.29,radius:.3,items:[{id:"ri",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1}]},{id:"leftarm",x:-1,y:0,z:-.51,radius:.6,items:[{id:"lh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"lhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"ls",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"lc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"rightarm",x:1,y:0,z:-.51,radius:.6,items:[{id:"rh",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rhs",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!1},{id:"rs",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"rc",x:0,y:0,z:0,radius:.025,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]},{id:"swim",bodyParts:[{id:"torso",x:0,y:0,z:0,radius:.4,items:[{id:"bds",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"ss",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1}]},{id:"head",x:0,y:0,z:0,radius:.5,items:[{id:"hd",x:0,y:0,z:0,radius:.01,nx:0,ny:0,nz:-1,double:!0},{id:"fc",x:0,y:0,z:0,radius:.02,nx:0,ny:0,nz:-1,double:!1},{id:"ey",x:0,y:0,z:0,radius:.03,nx:0,ny:0,nz:-1,double:!1},{id:"hr",x:0,y:0,z:0,radius:.04,nx:0,ny:0,nz:-1,double:!0},{id:"hrb",x:0,y:0,z:0,radius:.05,nx:0,ny:0,nz:-1,double:!0},{id:"fa",x:0,y:0,z:0,radius:.06,nx:0,ny:0,nz:-1,double:!1},{id:"ea",x:0,y:0,z:0,radius:.07,nx:0,ny:0,nz:-1,double:!1},{id:"ha",x:0,y:0,z:0,radius:.08,nx:0,ny:0,nz:-1,double:!1},{id:"he",x:0,y:0,z:0,radius:.09,nx:0,ny:0,nz:-1,double:!1}]}]}]}},ij={partSets:{partSet:[{setType:"ri",flippedSetType:"ri"},{setType:"ri",flippedSetType:"ri"},{setType:"rh",flippedSetType:"lh"},{setType:"rhs",flippedSetType:"lhs"},{setType:"rs",swim:"0",flippedSetType:"ls"},{setType:"rc",flippedSetType:"lc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb",removeSetType:"hr"},{setType:"li",flippedSetType:"li"},{setType:"lh",flippedSetType:"rh"},{setType:"lhs",flippedSetType:"rhs"},{setType:"ls",flippedSetType:"rs"},{setType:"lc",flippedSetType:"rc"},{setType:"wa"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}],activePartSets:[{id:"figure",activeParts:[{setType:"rh"},{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"sh"},{setType:"lg"},{setType:"ch"},{setType:"cp"},{setType:"cc"},{setType:"wa"},{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"ea"},{setType:"ca"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"head",activeParts:[{setType:"hd"},{setType:"fc"},{setType:"ey"},{setType:"hr"},{setType:"hrb"},{setType:"ea"},{setType:"fa"},{setType:"ha"},{setType:"he"}]},{id:"speak",activeParts:[{setType:"hd"},{setType:"hr"},{setType:"hrb"},{setType:"fc"},{setType:"fa"},{setType:"ha"}]},{id:"gesture",activeParts:[{setType:"ey"},{setType:"fc"}]},{id:"eye",activeParts:[{setType:"ey"}]},{id:"handRight",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"}]},{id:"handRightAndHead",activeParts:[{setType:"rh"},{setType:"rhs"},{setType:"rs"},{setType:"rc"},{setType:"ri"},{setType:"ey"},{setType:"fc"},{setType:"hd"}]},{id:"handLeft",activeParts:[{setType:"lh"},{setType:"lhs"},{setType:"ls"},{setType:"lc"},{setType:"li"}]},{id:"walk",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"lh"},{setType:"lhs"},{setType:"rh"},{setType:"rhs"},{setType:"ls"},{setType:"lc"},{setType:"rs"},{setType:"rc"},{setType:"sh"}]},{id:"sit",activeParts:[{setType:"bd"},{setType:"bds"},{setType:"ss"},{setType:"lg"},{setType:"sh"},{setType:"cc"}]},{id:"itemRight",activeParts:[{setType:"ri"}]}]}},Pn=class ps extends pe{constructor(t,e,s,i){super(),this._state=ps.NOT_LOADED,this._libraryName=t,this._revision=e,this._downloadUrl=i,this._assets=s,this._animation=null,this._downloadUrl=this._downloadUrl.replace(/%libname%/gi,this._libraryName),this._downloadUrl=this._downloadUrl.replace(/%revision%/gi,this._revision),this._assets.getCollection(this._libraryName)&&(this._state=ps.LOADED)}async downloadAsset(){if(!this._assets||this._state===ps.LOADING||this._state===ps.LOADED)return;if(this._assets.getCollection(this._libraryName)){this._state=ps.LOADED,this.dispatchEvent(new qi(qi.DOWNLOAD_COMPLETE,this));return}if(this._state=ps.LOADING,!await this._assets.downloadAsset(this._downloadUrl))return;this._state=ps.LOADED;const s=this._assets.getCollection(this._libraryName);s&&(this._animation=s.data.animations),this.dispatchEvent(new qi(qi.DOWNLOAD_COMPLETE,this))}get libraryName(){return this._libraryName}get animation(){return this._animation}get isLoaded(){return this._state===ps.LOADED}};Pn.DOWNLOAD_COMPLETE="EADL_DOWNLOAD_COMPLETE";Pn.NOT_LOADED=0;Pn.LOADING=1;Pn.LOADED=2;let rj=Pn;const go=class eh extends pe{constructor(t,e){super(),this._assets=t,this._structure=e,this._missingMandatoryLibs=k.getValue("avatar.mandatory.effect.libraries"),this._effectMap=new Map,this._effectListeners=new Map,this._incompleteEffects=new Map,this._initDownloadBuffer=[],this._pendingDownloadQueue=[],this._currentDownloads=[],this._libraryNames=[],this._isReady=!1,this.onLibraryLoaded=this.onLibraryLoaded.bind(this),this.onAvatarRenderReady=this.onAvatarRenderReady.bind(this),this.loadEffectMap(),this._structure.renderManager.events.addEventListener(La.AVATAR_RENDER_READY,this.onAvatarRenderReady)}loadEffectMap(){const t=new XMLHttpRequest;try{t.open("GET",k.getValue("avatar.effectmap.url")),t.send(),t.onloadend=e=>{if(t.responseText){const s=JSON.parse(t.responseText);this.processEffectMap(s.effects),this.processMissingLibraries(),this._isReady=!0,this.dispatchEvent(new rt(eh.DOWNLOADER_READY))}},t.onerror=e=>{throw new Error("invalid_avatar_effect_map")}}catch(e){G.error(e)}}processEffectMap(t){if(t)for(const e of t){if(!e)continue;const s=e.id,i=e.lib,r=e.revision||"";if(this._libraryNames.indexOf(i)>=0)continue;this._libraryNames.push(i);const a=new rj(i,r,this._assets,k.getValue("avatar.asset.effect.url"));a.addEventListener(qi.DOWNLOAD_COMPLETE,this.onLibraryLoaded);let o=this._effectMap.get(s);o||(o=[]),o.push(a),this._effectMap.set(s,o)}}downloadAvatarEffect(t,e){if(!this._isReady||!this._structure.renderManager.isReady){this._initDownloadBuffer.push([t,e]);return}const s=this.getAvatarEffectPendingLibraries(t);if(s&&s.length){if(e&&!e.disposed){let i=this._effectListeners.get(t.toString());i||(i=[]),i.push(e),this._effectListeners.set(t.toString(),i)}this._incompleteEffects.set(t.toString(),s);for(const i of s)i&&this.downloadLibrary(i)}else e&&!e.disposed&&e.resetEffect(t)}onAvatarRenderReady(t){if(t){for(const[e,s]of this._initDownloadBuffer)this.downloadAvatarEffect(e,s);this._initDownloadBuffer=[]}}onLibraryLoaded(t){if(!t||!t.library)return;const e=[];this._structure.registerAnimation(t.library.animation);for(const[i,r]of this._incompleteEffects.entries()){let a=!0;for(const o of r)if(!(!o||o.isLoaded)){a=!1;break}if(a){e.push(i);const o=this._effectListeners.get(i);for(const _ of o)!_||_.disposed||_.resetEffect(parseInt(i));this._effectListeners.delete(i),this.dispatchEvent(new rt(eh.LIBRARY_LOADED))}}for(const i of e)this._incompleteEffects.delete(i);let s=0;for(;s<this._currentDownloads.length;){const i=this._currentDownloads[s];i&&i.libraryName===t.library.libraryName&&this._currentDownloads.splice(s,1),s++}}processMissingLibraries(){const t=this._missingMandatoryLibs.slice();for(const e of t){if(!e)continue;const s=this._effectMap.get(e);if(s)for(const i of s)i&&this.downloadLibrary(i)}}isAvatarEffectReady(t){return!this._isReady||!this._structure.renderManager.isReady?!1:!this.getAvatarEffectPendingLibraries(t).length}getAvatarEffectPendingLibraries(t){const e=[];if(!this._structure)return e;const s=this._effectMap.get(t.toString());if(s)for(const i of s)!i||i.isLoaded||e.indexOf(i)===-1&&e.push(i);return e}downloadLibrary(t){!t||t.isLoaded||this._pendingDownloadQueue.indexOf(t)>=0||this._currentDownloads.indexOf(t)>=0||(this._pendingDownloadQueue.push(t),this.processDownloadQueue())}processDownloadQueue(){for(;this._pendingDownloadQueue.length;)this._pendingDownloadQueue[0].downloadAsset(),this._currentDownloads.push(this._pendingDownloadQueue.shift())}};go.DOWNLOADER_READY="EADM_DOWNLOADER_READY";go.LIBRARY_LOADED="EADM_LIBRARY_LOADED";go.MAX_DOWNLOADS=2;let Mr=go;class nj extends Ec{constructor(t,e,s,i,r){super(t,e,s,i,r,null)}isPlaceholder(){return!0}}const Xf=class qf extends ns{constructor(){super(),this._structure=null,this._avatarAssetDownloadManager=null,this._placeHolderFigure=null,this._figureMapReady=!1,this._effectMapReady=!1,this._actionsReady=!1,this._geometryReady=!1,this._partSetsReady=!1,this._animationsReady=!1,this._isReady=!1,this.onAvatarAssetDownloaderReady=this.onAvatarAssetDownloaderReady.bind(this),this.onAvatarAssetDownloaded=this.onAvatarAssetDownloaded.bind(this),this.onEffectAssetDownloaderReady=this.onEffectAssetDownloaderReady.bind(this),this.onEffectAssetDownloaded=this.onEffectAssetDownloaded.bind(this),this.onAvatarStructureDownloadDone=this.onAvatarStructureDownloadDone.bind(this)}onInit(){this._structure=new tj(this),this.loadGeometry(),this.loadPartSets(),this.loadActions(),this.loadAnimations(),this.loadFigureData(),this._aliasCollection=new cI(this,Me()),this._aliasCollection.init(),this._avatarAssetDownloadManager||(this._avatarAssetDownloadManager=new Ar(Me(),this._structure),this._avatarAssetDownloadManager.addEventListener(Ar.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.addEventListener(Ar.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager||(this._effectAssetDownloadManager=new Mr(Me(),this._structure),this._effectAssetDownloadManager.addEventListener(Mr.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.addEventListener(Mr.LIBRARY_LOADED,this.onEffectAssetDownloaded)),this.checkReady()}onDispose(){this._avatarAssetDownloadManager&&(this._avatarAssetDownloadManager.removeEventListener(Ar.DOWNLOADER_READY,this.onAvatarAssetDownloaderReady),this._avatarAssetDownloadManager.removeEventListener(Ar.LIBRARY_LOADED,this.onAvatarAssetDownloaded)),this._effectAssetDownloadManager&&(this._effectAssetDownloadManager.removeEventListener(Mr.DOWNLOADER_READY,this.onEffectAssetDownloaderReady),this._effectAssetDownloadManager.removeEventListener(Mr.LIBRARY_LOADED,this.onEffectAssetDownloaded))}loadGeometry(){this._structure&&(this._structure.initGeometry(sj.geometry),this._geometryReady=!0,this.checkReady())}loadPartSets(){this._structure&&(this._structure.initPartSets(ij.partSets),this._partSetsReady=!0,this.checkReady())}loadActions(){const t=k.getValue("avatar.default.actions");t&&this._structure.initActions(Me(),t);const e=new XMLHttpRequest;try{e.open("GET",k.getValue("avatar.actions.url")),e.send(),e.onloadend=s=>{this._structure&&(this._structure.updateActions(JSON.parse(e.responseText)),this._actionsReady=!0,this.checkReady())},e.onerror=s=>{throw new Error("invalid_avatar_actions")}}catch(s){G.error(s)}}loadAnimations(){this._structure&&(this._structure.initAnimation(ej.animations),this._animationsReady=!0,this.checkReady())}loadFigureData(){const t=k.getValue("avatar.default.figuredata");if(!t||typeof t=="string"){G.error("XML figuredata is no longer supported");return}this._structure&&this._structure.initFigureData(t),new Ru(k.getValue("avatar.figuredata.url"),this._structure.figureData).addEventListener(Ru.AVATAR_STRUCTURE_DONE,this.onAvatarStructureDownloadDone)}onAvatarStructureDownloadDone(t){this._structureReady=!0,this._structure.init(),this.checkReady()}onAvatarAssetDownloaderReady(t){t&&(this._figureMapReady=!0,this.checkReady())}onAvatarAssetDownloaded(t){t&&this._aliasCollection.reset()}onEffectAssetDownloaderReady(t){t&&(this._effectMapReady=!0,this.checkReady())}onEffectAssetDownloaded(t){t&&this._aliasCollection.reset()}checkReady(){this._isReady||!this._geometryReady||!this._partSetsReady||!this._actionsReady||!this._animationsReady||!this._figureMapReady||!this._effectMapReady||!this._structureReady||(this._isReady=!0,this.events&&this.events.dispatchEvent(new rt(La.AVATAR_RENDER_READY)))}createFigureContainer(t){return new Hn(t)}isFigureContainerReady(t){return this._avatarAssetDownloadManager?this._avatarAssetDownloadManager.isAvatarFigureContainerReady(t):!1}createAvatarImage(t,e,s,i=null,r=null){if(!this._structure||!this._avatarAssetDownloadManager)return null;const a=new Hn(t);return s&&this.validateAvatarFigure(a,s),this._avatarAssetDownloadManager.isAvatarFigureContainerReady(a)?new Ec(this._structure,this._aliasCollection,a,e,this._effectAssetDownloadManager,r):(this._placeHolderFigure||(this._placeHolderFigure=new Hn(qf.DEFAULT_FIGURE)),this._avatarAssetDownloadManager.downloadAvatarFigure(a,i),new nj(this._structure,this._aliasCollection,this._placeHolderFigure,e,this._effectAssetDownloadManager))}downloadAvatarFigure(t,e){this._avatarAssetDownloadManager&&this._avatarAssetDownloadManager.downloadAvatarFigure(t,e)}validateAvatarFigure(t,e){let s=!1;const i=this._structure.getMandatorySetTypeIds(e,2);if(i){const r=this._structure.figureData;for(const a of i)if(t.hasPartType(a)){const o=r.getSetType(a);if(o&&!o.getPartSet(t.getPartSetId(a))){const l=this._structure.getDefaultPartSet(a,e);l&&(t.updatePart(a,l.id,[0]),s=!0)}}else{const o=this._structure.getDefaultPartSet(a,e);o&&(t.updatePart(a,o.id,[0]),s=!0)}}return!s}getFigureClubLevel(t,e,s=null){if(!this._structure)return 0;const i=this._structure.figureData,r=Array.from(t.getPartTypeIds());let a=0;for(const o of r){const _=i.getSetType(o);if(!_)continue;const l=t.getPartSetId(o),c=_.getPartSet(l);if(c){a=Math.max(c.clubLevel,a);const d=i.getPalette(_.paletteID),E=t.getPartColorIds(o);for(const I of E){const m=d.getColor(I);m&&(a=Math.max(m.clubLevel,a))}}}s||(s=this._structure.getBodyPartsUnordered(ie.FULL));for(const o of s){const _=i.getSetType(o);_&&r.indexOf(o)===-1&&(a=Math.max(_.optionalFromClubLevel(e),a))}return a}isValidFigureSetForGender(t,e){const i=this.structureData.getFigurePartSet(t);return!!(i&&(i.gender.toUpperCase()==="U"||i.gender.toUpperCase()===e.toUpperCase()))}getFigureStringWithFigureIds(t,e,s){const i=new LI;i.loadAvatarData(t,e);const r=this.resolveFigureSets(s);for(const a of r)i.savePartData(a.type,a.id,i.getColourIds(a.type));return i.getFigureString()}resolveFigureSets(t){const e=this.structureData,s=[];for(const i of t){const r=e.getFigurePartSet(i);r&&s.push(r)}return s}getMandatoryAvatarPartSetIds(t,e){return this._structure?this._structure.getMandatorySetTypeIds(t,e):null}getAssetByName(t){return this._aliasCollection.getAsset(t)}get assets(){return Me()}get isReady(){return this._isReady}get structure(){return this._structure}get structureData(){return this._structure?this._structure.figureData:null}get downloadManager(){return this._avatarAssetDownloadManager}};Xf.DEFAULT_FIGURE="hd-99999-99999";let aj=Xf;class oj{constructor(t,e,s){this._layerId=t,this._partId=e,this._paletteId=s}get layerId(){return this._layerId}set layerId(t){this._layerId=t}get partId(){return this._partId}set partId(t){this._partId=t}get paletteId(){return this._paletteId}set paletteId(t){this._paletteId=t}}class Aa{constructor(t){this._typeId=this.getTypeId(t),this._paletteId=this.getPaletteId(t),this._color=this.getColor(t),this._headOnly=this.getHeadOnly(t);const e=this.getCustomData(t);this._customLayerIds=this.getCustomLayerIds(e),this._customPartIds=this.getCustomPartIds(e),this._customPaletteIds=this.getCustomPaletteIds(e),this._customParts=[];let s=0;for(;s<this._customLayerIds.length;)this._customParts.push(new oj(this._customLayerIds[s],this._customPartIds[s],this._customPaletteIds[s])),s++}get typeId(){return this._typeId}get paletteId(){return this._paletteId}get color(){return this._color}get customLayerIds(){return this._customLayerIds}get customPartIds(){return this._customPartIds}get customPaletteIds(){return this._customPaletteIds}get customParts(){return this._customParts}getCustomPart(t){if(this._customParts){for(const e of this._customParts)if(e.layerId===t)return e}return null}get hasCustomParts(){return this._customLayerIds!=null&&this._customLayerIds.length>0}get headOnly(){return this._headOnly}get figureString(){let t=this.typeId+" "+this.paletteId+" "+this.color.toString(16);t=t+(" "+this.customParts.length);for(const e of this.customParts)t=t+(" "+e.layerId+" "+e.partId+" "+e.paletteId);return t}getCustomData(t){let e=[];if(t){const s=t.split(" "),i=this._headOnly?1:0,r=4+i;if(s.length>r){const a=3+i,o=parseInt(s[a]);e=s.slice(r,r+o*3)}}return e}getCustomLayerIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+0])),s=s+3;return e}getCustomPartIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+1])),s=s+3;return e}getCustomPaletteIds(t){const e=[];let s=0;for(;s<t.length;)e.push(parseInt(t[s+2])),s=s+3;return e}getTypeId(t){if(t){const e=t.split(" ");if(e.length>=1)return parseInt(e[0])}return 0}getPaletteId(t){if(t){const e=t.split(" ");if(e.length>=2)return parseInt(e[1])}return 0}getColor(t){if(t){const e=t.split(" ");if(e.length>=3)return parseInt(e[2],16)}return 16777215}getHeadOnly(t){if(t){const e=t.split(" ");if(e.length>=4)return e[3]==="head"}return!1}}class Eo{constructor(t){this._complete=!0,this._target=t}get running(){return this._running&&!!this._target}get complete(){return this._complete}set target(t){this._target=t}get target(){return this._target}set tag(t){this._tag=t}get tag(){return this._tag}start(){this._running=!0}update(t){}stop(){this._target=null,this._running=!1}tick(t){}}class Mj extends Eo{constructor(t){super(t)}tick(t){super.tick(t),this.target&&(this.target.remove(),this.target=null)}}class nu extends Eo{constructor(t,e){super(t),this._complete=!1,this._duration=e}get duration(){return this._duration}start(){super.start(),this._complete=!1,this._startTimeMs=$()}tick(t){super.tick(t);const e=(t-this._startTimeMs)/this._duration;e<1?this.update(e):(this.update(1),this._complete=!0)}}class Cj extends nu{constructor(t,e,s){super(t,e),this._height=s}start(){super.start(),this._offset=0,this.target.style.top=this._offset-this._height+"px"}update(t){super.update(t),this.target.style.top=this._offset-this._height+this.getBounceOffset(t)*this._height+"px"}getBounceOffset(t){return t<.364?7.5625*t*t:t<.727?(t=t-.545,7.5625*t*t+.75):t<.909?(t=t-.9091,7.5625*t*t+.9375):(t=t-.955,7.5625*t*t+.984375)}stop(){this.target.style.top=this._offset+"px",super.stop()}}class _j extends nu{constructor(t){super(t.target,t.duration),this._interval=t}start(){super.start(),this._interval.start()}update(t){super.update(t),this._interval.update(t)}stop(){super.stop(),this._interval.stop()}}class hj extends _j{constructor(t,e){super(t),this._rate=e}}class Nj extends hj{constructor(t,e){super(t,e)}update(t){this._interval.update(Math.pow(t,1/this._rate))}}class Dj extends nu{constructor(t,e,s,i,r,a){super(t,e),this._deltaX=s,this._deltaY=i,this._height=-r,this._numJumps=a}start(){super.start(),this._startX=this.target.offsetLeft,this._startY=this.target.offsetTop}update(t){super.update(t),this.target.style.left=this._startX+this._deltaX*t+"px",this.target.style.top=this._startY+this._height*Math.abs(Math.sin(t*Math.PI*this._numJumps))+this._deltaY*t+"px"}}const pr=class Z{static get TIMER_TIME(){return 1e3/gm()}static runMotion(t){return Z._RUNNING_MOTIONS.indexOf(t)===-1&&Z._QUEUED_MOTIONS.indexOf(t)===-1&&(Z._IS_UPDATING?Z._QUEUED_MOTIONS.push(t):(Z._RUNNING_MOTIONS.push(t),t.start()),Z.startTimer()),t}static removeMotion(t){let e=Z._RUNNING_MOTIONS.indexOf(t);e>-1?Z._IS_UPDATING?(e=Z._REMOVED_MOTIONS.indexOf(t),e==-1&&Z._REMOVED_MOTIONS.push(t)):(Z._RUNNING_MOTIONS.splice(e,1),t.running&&t.stop(),Z._RUNNING_MOTIONS.length||Z.stopTimer()):(e=Z._QUEUED_MOTIONS.indexOf(t),e>-1&&Z._QUEUED_MOTIONS.splice(e,1))}static getMotionByTag(t){for(const e of Z._RUNNING_MOTIONS)if(e.tag==t)return e;for(const e of Z._QUEUED_MOTIONS)if(e.tag==t)return e;return null}static getMotionByTarget(t){for(const e of Z._RUNNING_MOTIONS)if(e.target==t)return e;for(const e of Z._QUEUED_MOTIONS)if(e.target==t)return e;return null}static getMotionByTagAndTarget(t,e){for(const s of Z._RUNNING_MOTIONS)if(s.tag==t&&s.target==e)return s;for(const s of Z._QUEUED_MOTIONS)if(s.tag==t&&s.target==e)return s;return null}static get isRunning(){return!!Z._TIMER}static get isUpdating(){return Z._IS_UPDATING}static onTick(){Z._IS_UPDATING=!0;const t=$();let e=null;for(;e=Z._QUEUED_MOTIONS.pop();)Z._RUNNING_MOTIONS.push(e);for(;e=Z._REMOVED_MOTIONS.pop();)Z._RUNNING_MOTIONS.splice(Z._RUNNING_MOTIONS.indexOf(e),1),e.running&&e.stop();for(e of Z._RUNNING_MOTIONS)e.running?(e.tick(t),e.complete&&Z.removeMotion(e)):Z.removeMotion(e);Z._RUNNING_MOTIONS.length||Z.stopTimer(),Z._IS_UPDATING=!1}static startTimer(){Z._TIMER||(Z._TIMER=setInterval(Z.onTick,Z.TIMER_TIME))}static stopTimer(){Z._TIMER&&(clearInterval(Z._TIMER),Z._TIMER=null)}getNumRunningMotions(t){let e=0;for(const s of Z._RUNNING_MOTIONS)s.target===t&&e++;return e}};pr._QUEUED_MOTIONS=[];pr._RUNNING_MOTIONS=[];pr._REMOVED_MOTIONS=[];pr._TIMER=null;pr._IS_UPDATING=!1;let Pj=pr;class yj extends Eo{constructor(...t){super(t?t[0].target:null),this._queue=[];for(const e of t)this._queue.push(e);this._motion=t[0],this._complete=!this._motion}get running(){return this._running&&this._motion?this._motion.running:!1}start(){super.start(),this._motion.start()}update(t){super.update(t),this._motion.running&&this._motion.update(t)}stop(){super.stop(),this._motion.stop()}tick(t){if(super.tick(t),this._motion.tick(t),this._motion.complete){this._motion.stop();const e=this._queue.indexOf(this._motion);e<this._queue.length-1?(this._motion=this._queue[e+1],this._target=this._motion.target,this._motion.start()):this._complete=!0}}}class Lj extends Eo{constructor(t){super(null),this._waitTimeMs=t}get running(){return this._running}start(){super.start(),this._complete=!1,this._startTimeMs=$()}tick(t){super.tick(t),this._complete=t-this._startTimeMs>=this._waitTimeMs,this._complete&&this.stop()}}export{Rb as $,w as A,Yt as B,qo as C,S0 as D,pe as E,qG as F,Xb as G,pa as H,Sm as I,nt as J,on as K,fm as L,F as M,H as N,$s as O,Aa as P,ia as Q,g as R,ea as S,tn as T,VB as U,R as V,gj as W,Ss as X,zy as Y,Yy as Z,Wy as _,k as a,rd as a$,mD as a0,Nb as a1,Bo as a2,tg as a3,DU as a4,AU as a5,MU as a6,VL as a7,SU as a8,KL as a9,ob as aA,bD as aB,LL as aC,yD as aD,PD as aE,OD as aF,AD as aG,Um as aH,Lb as aI,yb as aJ,Re as aK,s0 as aL,Kg as aM,jb as aN,wb as aO,Fb as aP,Ub as aQ,Aj as aR,K as aS,n_ as aT,pP as aU,AP as aV,L0 as aW,IP as aX,lP as aY,cP as aZ,gP as a_,eD as aa,lL as ab,yU as ac,UU as ad,PU as ae,LD as af,iD as ag,wL as ah,LU as ai,sD as aj,tD as ak,CU as al,vU as am,Zs as an,u_ as ao,G as ap,xb as aq,ND as ar,CD as as,YD as at,jD as au,zD as av,BD as aw,VD as ax,KD as ay,xD as az,Ie as b,HL as b$,v0 as b0,y0 as b1,P0 as b2,B0 as b3,F0 as b4,N0 as b5,C0 as b6,OP as b7,x0 as b8,xP as b9,eL as bA,sL as bB,iL as bC,rL as bD,nL as bE,Lx as bF,uL as bG,hL as bH,cL as bI,Du as bJ,dL as bK,Yc as bL,gL as bM,EL as bN,fL as bO,mL as bP,RL as bQ,TL as bR,pL as bS,OL as bT,AL as bU,Bx as bV,zx as bW,Fx as bX,Vx as bY,xx as bZ,Gx as b_,SP as ba,GP as bb,nd as bc,Q0 as bd,ad as be,cF as bf,hx as bg,Ay as bh,Hy as bi,rx as bj,py as bk,Ty as bl,Oy as bm,Ry as bn,cD as bo,bU as bp,Yx as bq,Wx as br,Zy as bs,Jy as bt,Px as bu,yx as bv,oD as bw,aD as bx,hD as by,Nu as bz,eu as c,JG as c$,xL as c0,zL as c1,GL as c2,FL as c3,BL as c4,lD as c5,uD as c6,RU as c7,$L as c8,w1 as c9,WB as cA,YB as cB,mU as cC,Pc as cD,Ho as cE,Pm as cF,ot as cG,V as cH,kr as cI,ku as cJ,lm as cK,Rt as cL,X as cM,U as cN,aB as cO,$t as cP,dv as cQ,z as cR,p0 as cS,rP as cT,nP as cU,oP as cV,aP as cW,R0 as cX,O0 as cY,Vo as cZ,Lm as c_,B1 as ca,ca as cb,ke as cc,Yd as cd,iv as ce,at as cf,_v as cg,wa as ch,hv as ci,gd as cj,a_ as ck,r_ as cl,i_ as cm,uU as cn,dU as co,OU as cp,pU as cq,nU as cr,_U as cs,an as ct,sv as cu,lU as cv,hb as cw,ub as cx,nn as cy,lb as cz,S as d,HB as d$,fv as d0,gv as d1,Ev as d2,M0 as d3,$G as d4,Lh as d5,tB as d6,NB as d7,LB as d8,vs as d9,qm as dA,Jm as dB,sa as dC,st as dD,jG as dE,Tj as dF,Rj as dG,Ke as dH,Ye as dI,Ee as dJ,ta as dK,bV as dL,ym as dM,ov as dN,qs as dO,Ds as dP,IU as dQ,lt as dR,$i as dS,eE as dT,Os as dU,As as dV,sd as dW,eb as dX,gB as dY,ts as dZ,Ab as d_,YV as da,Vr as db,Xs as dc,jo as dd,Tv as de,kG as df,cv as dg,ZG as dh,_B as di,Mv as dj,Sv as dk,Av as dl,oB as dm,hB as dn,Lv as dp,Nv as dq,Dv as dr,Pv as ds,CN as dt,AB as du,MN as dv,MB as dw,SN as dx,SB as dy,$m as dz,dj as e,CF as e$,tL as e0,gb as e1,Ob as e2,gD as e3,dD as e4,ED as e5,Mb as e6,Cb as e7,Oj as e8,Db as e9,xB as eA,Jv as eB,Jb as eC,_0 as eD,PL as eE,Zx as eF,s1 as eG,zt as eH,Me as eI,Ej as eJ,Cv as eK,N_ as eL,lB as eM,uB as eN,cB as eO,C_ as eP,L_ as eQ,EP as eR,U0 as eS,G0 as eT,b0 as eU,H0 as eV,J0 as eW,W0 as eX,$0 as eY,SF as eZ,MF as e_,Pb as ea,RD as eb,TD as ec,e0 as ed,vD as ee,GB as ef,WD as eg,qb as eh,i0 as ei,Wv as ej,DB as ek,se as el,Hb as em,JD as en,QD as eo,a0 as ep,FR as eq,vL as er,NL as es,i1 as et,e1 as eu,Qx as ev,t1 as ew,Xx as ex,UL as ey,CL as ez,Ve as f,WL as f$,fF as f0,$P as f1,gF as f2,dF as f3,AF as f4,ey as f5,NF as f6,Co as f7,ry as f8,TF as f9,by as fA,vy as fB,_d as fC,hd as fD,Uy as fE,Sj as fF,db as fG,kB as fH,nx as fI,Ph as fJ,Tb as fK,rD as fL,pb as fM,JF as fN,XF as fO,qF as fP,QF as fQ,$F as fR,pD as fS,vb as fT,kU as fU,SG as fV,SL as fW,kx as fX,wx as fY,Hx as fZ,ld as f_,sy as fa,ty as fb,hn as fc,uF as fd,lF as fe,pF as ff,OF as fg,EF as fh,iy as fi,DF as fj,gx as fk,dx as fl,Ex as fm,px as fn,xy as fo,mx as fp,lx as fq,cx as fr,Tx as fs,Ue as ft,Ix as fu,jU as fv,Py as fw,Ly as fx,ud as fy,Fy as fz,Nt as g,Zm as g$,h1 as g0,jL as g1,o1 as g2,fn as g3,d1 as g4,bL as g5,a1 as g6,Qa as g7,p1 as g8,T1 as g9,xv as gA,bv as gB,Fv as gC,zG as gD,Dg as gE,GG as gF,wv as gG,YG as gH,J1 as gI,N1 as gJ,r0 as gK,Zb as gL,XD as gM,s_ as gN,ny as gO,xm as gP,y1 as gQ,YU as gR,WG as gS,oj as gT,pj as gU,_h as gV,Hg as gW,Jr as gX,cg as gY,yg as gZ,Mi as g_,gn as ga,XL as gb,l1 as gc,n1 as gd,E1 as ge,R1 as gf,g1 as gg,Li as gh,f1 as gi,c1 as gj,kL as gk,u1 as gl,YL as gm,_1 as gn,D1 as go,b1 as gp,OB as gq,dG as gr,$1 as gs,gG as gt,fe as gu,jv as gv,BG as gw,vv as gx,VG as gy,wG as gz,At as h,tI as h0,jm as h1,$v as h2,jB as h3,fB as h4,jx as h5,EB as h6,mB as h7,rv as h8,HG as h9,XB as hA,QB as hB,jr as hC,Ji as hD,Qt as hE,Js as hF,Hm as ha,JL as hb,qL as hc,QL as hd,O1 as he,eB as hf,dB as hg,uv as hh,EG as hi,rG as hj,ti as hk,St as hl,Eu as hm,Pj as hn,yj as ho,Lj as hp,Cj as hq,Nj as hr,Dj as hs,Mj as ht,kd as hu,ME as hv,tb as hw,sb as hx,KB as hy,qB as hz,Oe as i,Si as j,es as k,ie as l,Bn as m,$ as n,rh as o,je as p,vt as q,Fa as r,Hn as s,cc as t,IF as u,PF as v,mF as w,RF as x,F1 as y,rt as z};
